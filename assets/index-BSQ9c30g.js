var AL=Object.defineProperty;var SL=(n,e,t)=>e in n?AL(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ge=(n,e,t)=>(SL(n,typeof e!="symbol"?e+"":e,t),t),RL=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var B0=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},U0=(n,e,t,i)=>(RL(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t);function UT(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in n)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var z0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nm(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var zT={exports:{}},qd={},VT={exports:{}},Ct={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lu=Symbol.for("react.element"),xL=Symbol.for("react.portal"),ML=Symbol.for("react.fragment"),IL=Symbol.for("react.strict_mode"),PL=Symbol.for("react.profiler"),wL=Symbol.for("react.provider"),OL=Symbol.for("react.context"),DL=Symbol.for("react.forward_ref"),LL=Symbol.for("react.suspense"),NL=Symbol.for("react.memo"),FL=Symbol.for("react.lazy"),V0=Symbol.iterator;function kL(n){return n===null||typeof n!="object"?null:(n=V0&&n[V0]||n["@@iterator"],typeof n=="function"?n:null)}var GT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},WT=Object.assign,HT={};function Jl(n,e,t){this.props=n,this.context=e,this.refs=HT,this.updater=t||GT}Jl.prototype.isReactComponent={};Jl.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Jl.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function jT(){}jT.prototype=Jl.prototype;function sm(n,e,t){this.props=n,this.context=e,this.refs=HT,this.updater=t||GT}var am=sm.prototype=new jT;am.constructor=sm;WT(am,Jl.prototype);am.isPureReactComponent=!0;var G0=Array.isArray,XT=Object.prototype.hasOwnProperty,om={current:null},YT={key:!0,ref:!0,__self:!0,__source:!0};function KT(n,e,t){var i,r={},s=null,a=null;if(e!=null)for(i in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)XT.call(e,i)&&!YT.hasOwnProperty(i)&&(r[i]=e[i]);var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){for(var o=Array(l),c=0;c<l;c++)o[c]=arguments[c+2];r.children=o}if(n&&n.defaultProps)for(i in l=n.defaultProps,l)r[i]===void 0&&(r[i]=l[i]);return{$$typeof:Lu,type:n,key:s,ref:a,props:r,_owner:om.current}}function BL(n,e){return{$$typeof:Lu,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function lm(n){return typeof n=="object"&&n!==null&&n.$$typeof===Lu}function UL(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var W0=/\/+/g;function R_(n,e){return typeof n=="object"&&n!==null&&n.key!=null?UL(""+n.key):e.toString(36)}function Oh(n,e,t,i,r){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case Lu:case xL:a=!0}}if(a)return a=n,r=r(a),n=i===""?"."+R_(a,0):i,G0(r)?(t="",n!=null&&(t=n.replace(W0,"$&/")+"/"),Oh(r,e,t,"",function(c){return c})):r!=null&&(lm(r)&&(r=BL(r,t+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(W0,"$&/")+"/")+n)),e.push(r)),1;if(a=0,i=i===""?".":i+":",G0(n))for(var l=0;l<n.length;l++){s=n[l];var o=i+R_(s,l);a+=Oh(s,e,t,o,r)}else if(o=kL(n),typeof o=="function")for(n=o.call(n),l=0;!(s=n.next()).done;)s=s.value,o=i+R_(s,l++),a+=Oh(s,e,t,o,r);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function nh(n,e,t){if(n==null)return n;var i=[],r=0;return Oh(n,i,"","",function(s){return e.call(t,s,r++)}),i}function zL(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Or={current:null},Dh={transition:null},VL={ReactCurrentDispatcher:Or,ReactCurrentBatchConfig:Dh,ReactCurrentOwner:om};function qT(){throw Error("act(...) is not supported in production builds of React.")}Ct.Children={map:nh,forEach:function(n,e,t){nh(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return nh(n,function(){e++}),e},toArray:function(n){return nh(n,function(e){return e})||[]},only:function(n){if(!lm(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Ct.Component=Jl;Ct.Fragment=ML;Ct.Profiler=PL;Ct.PureComponent=sm;Ct.StrictMode=IL;Ct.Suspense=LL;Ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VL;Ct.act=qT;Ct.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=WT({},n.props),r=n.key,s=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=om.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(o in e)XT.call(e,o)&&!YT.hasOwnProperty(o)&&(i[o]=e[o]===void 0&&l!==void 0?l[o]:e[o])}var o=arguments.length-2;if(o===1)i.children=t;else if(1<o){l=Array(o);for(var c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}return{$$typeof:Lu,type:n.type,key:r,ref:s,props:i,_owner:a}};Ct.createContext=function(n){return n={$$typeof:OL,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:wL,_context:n},n.Consumer=n};Ct.createElement=KT;Ct.createFactory=function(n){var e=KT.bind(null,n);return e.type=n,e};Ct.createRef=function(){return{current:null}};Ct.forwardRef=function(n){return{$$typeof:DL,render:n}};Ct.isValidElement=lm;Ct.lazy=function(n){return{$$typeof:FL,_payload:{_status:-1,_result:n},_init:zL}};Ct.memo=function(n,e){return{$$typeof:NL,type:n,compare:e===void 0?null:e}};Ct.startTransition=function(n){var e=Dh.transition;Dh.transition={};try{n()}finally{Dh.transition=e}};Ct.unstable_act=qT;Ct.useCallback=function(n,e){return Or.current.useCallback(n,e)};Ct.useContext=function(n){return Or.current.useContext(n)};Ct.useDebugValue=function(){};Ct.useDeferredValue=function(n){return Or.current.useDeferredValue(n)};Ct.useEffect=function(n,e){return Or.current.useEffect(n,e)};Ct.useId=function(){return Or.current.useId()};Ct.useImperativeHandle=function(n,e,t){return Or.current.useImperativeHandle(n,e,t)};Ct.useInsertionEffect=function(n,e){return Or.current.useInsertionEffect(n,e)};Ct.useLayoutEffect=function(n,e){return Or.current.useLayoutEffect(n,e)};Ct.useMemo=function(n,e){return Or.current.useMemo(n,e)};Ct.useReducer=function(n,e,t){return Or.current.useReducer(n,e,t)};Ct.useRef=function(n){return Or.current.useRef(n)};Ct.useState=function(n){return Or.current.useState(n)};Ct.useSyncExternalStore=function(n,e,t){return Or.current.useSyncExternalStore(n,e,t)};Ct.useTransition=function(){return Or.current.useTransition()};Ct.version="18.3.1";VT.exports=Ct;var S=VT.exports;const k=nm(S),GL=UT({__proto__:null,default:k},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WL=S,HL=Symbol.for("react.element"),jL=Symbol.for("react.fragment"),XL=Object.prototype.hasOwnProperty,YL=WL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,KL={key:!0,ref:!0,__self:!0,__source:!0};function $T(n,e,t){var i,r={},s=null,a=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(i in e)XL.call(e,i)&&!KL.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:HL,type:n,key:s,ref:a,props:r,_owner:YL.current}}qd.Fragment=jL;qd.jsx=$T;qd.jsxs=$T;zT.exports=qd;var fe=zT.exports;const qL=1/2.2,Lh=2.2,ut=.001;class Zi{static BuildArray(e,t){const i=[];for(let r=0;r<e;++r)i.push(t());return i}static BuildTuple(e,t){return Zi.BuildArray(e,t)}}function $L(n,e,t){const i=n[e];if(typeof i!="function")return null;const r=function(){const s=n.length,a=r.previous.apply(n,arguments);return t(e,s),a};return i.next=r,r.previous=i,n[e]=r,()=>{const s=r.previous;if(!s)return;const a=r.next;a?(s.next=a,a.previous=s):(s.next=void 0,n[e]=s),r.next=void 0,r.previous=void 0}}const QL=["push","splice","pop","shift","unshift"];function QT(n,e){const t=QL.map(i=>$L(n,i,e));return()=>{t.forEach(i=>{i==null||i()})}}const ZT={};function Ji(n,e){ZT[n]=e}function Bn(n){return ZT[n]}class Pi{static SetMatrixPrecision(e){if(Pi.MatrixTrackPrecisionChange=!1,e&&!Pi.MatrixUse64Bits&&Pi.MatrixTrackedMatrices)for(let t=0;t<Pi.MatrixTrackedMatrices.length;++t){const i=Pi.MatrixTrackedMatrices[t],r=i._m;i._m=new Array(16);for(let s=0;s<16;++s)i._m[s]=r[s]}Pi.MatrixUse64Bits=e,Pi.MatrixCurrentType=Pi.MatrixUse64Bits?Array:Float32Array,Pi.MatrixTrackedMatrices=null}}Pi.MatrixUse64Bits=!1;Pi.MatrixTrackPrecisionChange=!0;Pi.MatrixCurrentType=Float32Array;Pi.MatrixTrackedMatrices=[];class ZL{constructor(e,t=!1,i,r){this.initialize(e,t,i,r)}initialize(e,t=!1,i,r){return this.mask=e,this.skipNextObservers=t,this.target=i,this.currentTarget=r,this}}class JL{constructor(e,t,i=null){this.callback=e,this.mask=t,this.scope=i,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){this._remove&&this._remove()}}class Y{static FromPromise(e,t){const i=new Y;return e.then(r=>{i.notifyObservers(r)}).catch(r=>{if(t)t.notifyObservers(r);else throw r}),i}get observers(){return this._observers}constructor(e,t=!1){this.notifyIfTriggered=t,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new ZL(0),e&&(this._onObserverAdded=e)}add(e,t=-1,i=!1,r=null,s=!1){if(!e)return null;const a=new JL(e,t,r);return a.unregisterOnNextCall=s,i?this._observers.unshift(a):this._observers.push(a),this._onObserverAdded&&this._onObserverAdded(a),this._hasNotified&&this.notifyIfTriggered&&this._lastNotifiedValue!==void 0&&this.notifyObserver(a,this._lastNotifiedValue),a._remove=()=>{this.remove(a)},a}addOnce(e){return this.add(e,void 0,void 0,void 0,!0)}remove(e){return e?(e._remove=null,this._observers.indexOf(e)!==-1?(this._deferUnregister(e),!0):!1):!1}removeCallback(e,t){for(let i=0;i<this._observers.length;i++){const r=this._observers[i];if(!r._willBeUnregistered&&r.callback===e&&(!t||t===r.scope))return this._deferUnregister(r),!0}return!1}_deferUnregister(e){e._willBeUnregistered||(this._numObserversMarkedAsDeleted++,e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout(()=>{this._remove(e)},0))}_remove(e,t=!0){if(!e)return!1;const i=this._observers.indexOf(e);return i!==-1?(t&&this._numObserversMarkedAsDeleted--,this._observers.splice(i,1),!0):!1}makeObserverTopPriority(e){this._remove(e,!1),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e,!1),this._observers.push(e)}notifyObservers(e,t=-1,i,r,s){if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=e),!this._observers.length)return!0;const a=this._eventState;a.mask=t,a.target=i,a.currentTarget=r,a.skipNextObservers=!1,a.lastReturnValue=e,a.userInfo=s;for(const l of this._observers)if(!l._willBeUnregistered&&(l.mask&t&&(l.unregisterOnNextCall&&this._deferUnregister(l),l.scope?a.lastReturnValue=l.callback.apply(l.scope,[e,a]):a.lastReturnValue=l.callback(e,a)),a.skipNextObservers))return!1;return!0}notifyObserver(e,t,i=-1){if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=t),e._willBeUnregistered)return;const r=this._eventState;r.mask=i,r.skipNextObservers=!1,e.unregisterOnNextCall&&this._deferUnregister(e),e.callback(t,r)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const e=this._observers.pop();e&&(e._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const e=new Y;return e._observers=this._observers.slice(0),e}hasSpecificMask(e=-1){for(const t of this._observers)if(t.mask&e||t.mask===e)return!0;return!1}}class He{static get LastCreatedEngine(){return this.Instances.length===0?null:this.Instances[this.Instances.length-1]}static get LastCreatedScene(){return this._LastCreatedScene}}He.Instances=[];He.OnEnginesDisposedObservable=new Y;He._LastCreatedScene=null;He.UseFallbackTexture=!0;He.FallbackTexture="";function $i(n,e,t=1401298e-51){return Math.abs(n-e)<=t}function ei(n,e){return n===e?n:Math.random()*(e-n)+n}function JT(n,e,t){return n+(e-n)*t}function si(n,e=0,t=1){return Math.min(t,Math.max(e,n))}function e1(n){return n-=Math.PI*2*Math.floor((n+Math.PI)/(Math.PI*2)),n}function Mn(n){const e=n.toString(16);return n<=15?("0"+e).toUpperCase():e.toUpperCase()}const Ir=n=>parseInt(n.toString().replace(/\W/g,""));class xe{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){const e=Ir(this.x),t=Ir(this.y);let i=e;return i=i*397^t,i}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return xe.FromArrayToRef(e,t,this),this}asArray(){return[this.x,this.y]}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}setAll(e){return this.copyFromFloats(e,e)}add(e){return new this.constructor(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,t}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}addInPlaceFromFloats(e,t){return this.x+=e,this.y+=t,this}addVector3(e){return new this.constructor(this.x+e.x,this.y+e.y)}subtract(e){return new this.constructor(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,t}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new this.constructor(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,t}multiplyByFloats(e,t){return new this.constructor(this.x*e,this.y*t)}divide(e){return new this.constructor(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,t}divideInPlace(e){return this.x=this.x/e.x,this.y=this.y/e.y,this}minimizeInPlace(e){return this.minimizeInPlaceFromFloats(e.x,e.y)}maximizeInPlace(e){return this.maximizeInPlaceFromFloats(e.x,e.y)}minimizeInPlaceFromFloats(e,t){return this.x=Math.min(e,this.x),this.y=Math.min(t,this.y),this}maximizeInPlaceFromFloats(e,t){return this.x=Math.max(e,this.x),this.y=Math.max(t,this.y),this}subtractFromFloats(e,t){return new this.constructor(this.x-e,this.y-t)}subtractFromFloatsToRef(e,t,i){return i.copyFromFloats(this.x-e,this.y-t)}negate(){return new this.constructor(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(this.x*-1,this.y*-1)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){return new this.constructor(this.x*e,this.y*e)}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,t}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,t}equals(e){return e&&this.x===e.x&&this.y===e.y}equalsWithEpsilon(e,t=ut){return e&&$i(this.x,e.x,t)&&$i(this.y,e.y,t)}equalsToFloats(e,t){return this.x===e&&this.y===t}floor(){return new this.constructor(Math.floor(this.x),Math.floor(this.y))}floorToRef(e){return e.x=Math.floor(this.x),e.y=Math.floor(this.y),e}fract(){return new this.constructor(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}fractToRef(e){return e.x=this.x-Math.floor(this.x),e.y=this.y-Math.floor(this.y),e}rotateToRef(e,t){const i=Math.cos(e),r=Math.sin(e),s=i*this.x-r*this.y,a=r*this.x+i*this.y;return t.x=s,t.y=a,t}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(e){return e===0||e===1?this:this.scaleInPlace(1/e)}normalizeToNew(){const e=new this.constructor;return this.normalizeToRef(e),e}normalizeToRef(e){const t=this.length();return t===0?e.copyFrom(this):this.scaleToRef(1/t,e)}clone(){return new this.constructor(this.x,this.y)}dot(e){return this.x*e.x+this.y*e.y}static Zero(){return new xe(0,0)}static One(){return new xe(1,1)}static Random(e=0,t=1){return new xe(ei(e,t),ei(e,t))}static RandomToRef(e=0,t=1,i){return i.copyFromFloats(ei(e,t),ei(e,t))}static get ZeroReadOnly(){return xe._ZeroReadOnly}static FromArray(e,t=0){return new xe(e[t],e[t+1])}static FromArrayToRef(e,t,i){return i.x=e[t],i.y=e[t+1],i}static FromFloatsToRef(e,t,i){return i.copyFromFloats(e,t),i}static CatmullRom(e,t,i,r,s){const a=s*s,l=s*a,o=.5*(2*t.x+(-e.x+i.x)*s+(2*e.x-5*t.x+4*i.x-r.x)*a+(-e.x+3*t.x-3*i.x+r.x)*l),c=.5*(2*t.y+(-e.y+i.y)*s+(2*e.y-5*t.y+4*i.y-r.y)*a+(-e.y+3*t.y-3*i.y+r.y)*l);return new e.constructor(o,c)}static ClampToRef(e,t,i,r){return r.x=si(e.x,t.x,i.x),r.y=si(e.y,t.y,i.y),r}static Clamp(e,t,i){const r=si(e.x,t.x,i.x),s=si(e.y,t.y,i.y);return new e.constructor(r,s)}static Hermite(e,t,i,r,s){const a=s*s,l=s*a,o=2*l-3*a+1,c=-2*l+3*a,u=l-2*a+s,h=l-a,d=e.x*o+i.x*c+t.x*u+r.x*h,f=e.y*o+i.y*c+t.y*u+r.y*h;return new e.constructor(d,f)}static Hermite1stDerivative(e,t,i,r,s){const a=new e.constructor;return this.Hermite1stDerivativeToRef(e,t,i,r,s,a),a}static Hermite1stDerivativeToRef(e,t,i,r,s,a){const l=s*s;return a.x=(l-s)*6*e.x+(3*l-4*s+1)*t.x+(-l+s)*6*i.x+(3*l-2*s)*r.x,a.y=(l-s)*6*e.y+(3*l-4*s+1)*t.y+(-l+s)*6*i.y+(3*l-2*s)*r.y,a}static Lerp(e,t,i){const r=e.x+(t.x-e.x)*i,s=e.y+(t.y-e.y)*i;return new e.constructor(r,s)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){const t=new e.constructor;return xe.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){return e.normalizeToRef(t),t}static Minimize(e,t){const i=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new e.constructor(i,r)}static Maximize(e,t){const i=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new e.constructor(i,r)}static Transform(e,t){const i=new e.constructor;return xe.TransformToRef(e,t,i),i}static TransformToRef(e,t,i){const r=t.m,s=e.x*r[0]+e.y*r[4]+r[12],a=e.x*r[1]+e.y*r[5]+r[13];return i.x=s,i.y=a,i}static PointInTriangle(e,t,i,r){const s=.5*(-i.y*r.x+t.y*(-i.x+r.x)+t.x*(i.y-r.y)+i.x*r.y),a=s<0?-1:1,l=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*a,o=(t.x*i.y-t.y*i.x+(t.y-i.y)*e.x+(i.x-t.x)*e.y)*a;return l>0&&o>0&&l+o<2*s*a}static Distance(e,t){return Math.sqrt(xe.DistanceSquared(e,t))}static DistanceSquared(e,t){const i=e.x-t.x,r=e.y-t.y;return i*i+r*r}static Center(e,t){const i=new e.constructor;return xe.CenterToRef(e,t,i)}static CenterToRef(e,t,i){return i.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,i){const r=xe.DistanceSquared(t,i);if(r===0)return xe.Distance(e,t);const s=i.subtract(t),a=Math.max(0,Math.min(1,xe.Dot(e.subtract(t),s)/r)),l=t.add(s.multiplyByFloats(a,a));return xe.Distance(e,l)}}xe._ZeroReadOnly=xe.Zero();Object.defineProperties(xe.prototype,{dimension:{value:[2]},rank:{value:1}});class A{get x(){return this._x}set x(e){this._x=e,this._isDirty=!0}get y(){return this._y}set y(e){this._y=e,this._isDirty=!0}get z(){return this._z}set z(e){this._z=e,this._isDirty=!0}constructor(e=0,t=0,i=0){this._isDirty=!0,this._x=e,this._y=t,this._z=i}toString(){return`{X: ${this._x} Y: ${this._y} Z: ${this._z}}`}getClassName(){return"Vector3"}getHashCode(){const e=Ir(this._x),t=Ir(this._y),i=Ir(this._z);let r=e;return r=r*397^t,r=r*397^i,r}asArray(){return[this._x,this._y,this._z]}toArray(e,t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,this}fromArray(e,t=0){return A.FromArrayToRef(e,t,this),this}toQuaternion(){return ue.RotationYawPitchRoll(this._y,this._x,this._z)}addInPlace(e){return this._x+=e._x,this._y+=e._y,this._z+=e._z,this._isDirty=!0,this}addInPlaceFromFloats(e,t,i){return this._x+=e,this._y+=t,this._z+=i,this._isDirty=!0,this}add(e){return new this.constructor(this._x+e._x,this._y+e._y,this._z+e._z)}addToRef(e,t){return t.copyFromFloats(this._x+e._x,this._y+e._y,this._z+e._z)}subtractInPlace(e){return this._x-=e._x,this._y-=e._y,this._z-=e._z,this._isDirty=!0,this}subtract(e){return new this.constructor(this._x-e._x,this._y-e._y,this._z-e._z)}subtractToRef(e,t){return this.subtractFromFloatsToRef(e._x,e._y,e._z,t)}subtractFromFloats(e,t,i){return new this.constructor(this._x-e,this._y-t,this._z-i)}subtractFromFloatsToRef(e,t,i,r){return r.copyFromFloats(this._x-e,this._y-t,this._z-i)}negate(){return new this.constructor(-this._x,-this._y,-this._z)}negateInPlace(){return this._x*=-1,this._y*=-1,this._z*=-1,this._isDirty=!0,this}negateToRef(e){return e.copyFromFloats(this._x*-1,this._y*-1,this._z*-1)}scaleInPlace(e){return this._x*=e,this._y*=e,this._z*=e,this._isDirty=!0,this}scale(e){return new this.constructor(this._x*e,this._y*e,this._z*e)}scaleToRef(e,t){return t.copyFromFloats(this._x*e,this._y*e,this._z*e)}getNormalToRef(e){const t=this.length();let i=Math.acos(this.y/t);const r=Math.atan2(this.z,this.x);i>Math.PI/2?i-=Math.PI/2:i+=Math.PI/2;const s=t*Math.sin(i)*Math.cos(r),a=t*Math.cos(i),l=t*Math.sin(i)*Math.sin(r);return e.set(s,a,l),e}applyRotationQuaternionToRef(e,t){const i=this._x,r=this._y,s=this._z,a=e._x,l=e._y,o=e._z,c=e._w,u=2*(l*s-o*r),h=2*(o*i-a*s),d=2*(a*r-l*i);return t._x=i+c*u+l*d-o*h,t._y=r+c*h+o*u-a*d,t._z=s+c*d+a*h-l*u,t._isDirty=!0,t}applyRotationQuaternionInPlace(e){return this.applyRotationQuaternionToRef(e,this)}applyRotationQuaternion(e){return this.applyRotationQuaternionToRef(e,new this.constructor)}scaleAndAddToRef(e,t){return t.addInPlaceFromFloats(this._x*e,this._y*e,this._z*e)}projectOnPlane(e,t){const i=new this.constructor;return this.projectOnPlaneToRef(e,t,i),i}projectOnPlaneToRef(e,t,i){const r=e.normal,s=e.d,a=ve.Vector3[0];this.subtractToRef(t,a),a.normalize();const l=A.Dot(a,r);if(Math.abs(l)<1e-10)i.setAll(1/0);else{const o=-(A.Dot(t,r)+s)/l,c=a.scaleInPlace(o);t.addToRef(c,i)}return i}equals(e){return e&&this._x===e._x&&this._y===e._y&&this._z===e._z}equalsWithEpsilon(e,t=ut){return e&&$i(this._x,e._x,t)&&$i(this._y,e._y,t)&&$i(this._z,e._z,t)}equalsToFloats(e,t,i){return this._x===e&&this._y===t&&this._z===i}multiplyInPlace(e){return this._x*=e._x,this._y*=e._y,this._z*=e._z,this._isDirty=!0,this}multiply(e){return this.multiplyByFloats(e._x,e._y,e._z)}multiplyToRef(e,t){return t.copyFromFloats(this._x*e._x,this._y*e._y,this._z*e._z)}multiplyByFloats(e,t,i){return new this.constructor(this._x*e,this._y*t,this._z*i)}divide(e){return new this.constructor(this._x/e._x,this._y/e._y,this._z/e._z)}divideToRef(e,t){return t.copyFromFloats(this._x/e._x,this._y/e._y,this._z/e._z)}divideInPlace(e){return this._x=this._x/e._x,this._y=this._y/e._y,this._z=this._z/e._z,this._isDirty=!0,this}minimizeInPlace(e){return this.minimizeInPlaceFromFloats(e._x,e._y,e._z)}maximizeInPlace(e){return this.maximizeInPlaceFromFloats(e._x,e._y,e._z)}minimizeInPlaceFromFloats(e,t,i){return e<this._x&&(this.x=e),t<this._y&&(this.y=t),i<this._z&&(this.z=i),this}maximizeInPlaceFromFloats(e,t,i){return e>this._x&&(this.x=e),t>this._y&&(this.y=t),i>this._z&&(this.z=i),this}isNonUniformWithinEpsilon(e){const t=Math.abs(this._x),i=Math.abs(this._y);if(!$i(t,i,e))return!0;const r=Math.abs(this._z);return!$i(t,r,e)||!$i(i,r,e)}get isNonUniform(){const e=Math.abs(this._x),t=Math.abs(this._y);if(e!==t)return!0;const i=Math.abs(this._z);return e!==i}floorToRef(e){return e._x=Math.floor(this._x),e._y=Math.floor(this._y),e._z=Math.floor(this._z),e._isDirty=!0,e}floor(){return new this.constructor(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}fractToRef(e){return e._x=this.x-Math.floor(this._x),e._y=this.y-Math.floor(this._y),e._z=this.z-Math.floor(this._z),e._isDirty=!0,e}fract(){return new this.constructor(this.x-Math.floor(this._x),this.y-Math.floor(this._y),this.z-Math.floor(this._z))}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return this._x*this._x+this._y*this._y+this._z*this._z}get hasAZeroComponent(){return this._x*this._y*this._z===0}normalize(){return this.normalizeFromLength(this.length())}reorderInPlace(e){if(e=e.toLowerCase(),e==="xyz")return this;const t=ve.Vector3[0].copyFrom(this);return this.x=t[e[0]],this.y=t[e[1]],this.z=t[e[2]],this}rotateByQuaternionToRef(e,t){return e.toRotationMatrix(ve.Matrix[0]),A.TransformCoordinatesToRef(this,ve.Matrix[0],t),t}rotateByQuaternionAroundPointToRef(e,t,i){return this.subtractToRef(t,ve.Vector3[0]),ve.Vector3[0].rotateByQuaternionToRef(e,ve.Vector3[0]),t.addToRef(ve.Vector3[0],i),i}cross(e){const t=new this.constructor;return A.CrossToRef(this,e,t)}normalizeFromLength(e){return e===0||e===1?this:this.scaleInPlace(1/e)}normalizeToNew(){const e=new this.constructor(0,0,0);return this.normalizeToRef(e),e}normalizeToRef(e){const t=this.length();return t===0||t===1?e.copyFrom(this):this.scaleToRef(1/t,e)}clone(){return new this.constructor(this._x,this._y,this._z)}copyFrom(e){return this.copyFromFloats(e._x,e._y,e._z)}copyFromFloats(e,t,i){return this._x=e,this._y=t,this._z=i,this._isDirty=!0,this}set(e,t,i){return this.copyFromFloats(e,t,i)}setAll(e){return this._x=this._y=this._z=e,this._isDirty=!0,this}static GetClipFactor(e,t,i,r){const s=A.Dot(e,i),a=A.Dot(t,i);return(s-r)/(s-a)}static GetAngleBetweenVectors(e,t,i){const r=e.normalizeToRef(ve.Vector3[1]),s=t.normalizeToRef(ve.Vector3[2]);let a=A.Dot(r,s);a=si(a,-1,1);const l=Math.acos(a),o=ve.Vector3[3];return A.CrossToRef(r,s,o),A.Dot(o,i)>0?isNaN(l)?0:l:isNaN(l)?-Math.PI:-Math.acos(a)}static GetAngleBetweenVectorsOnPlane(e,t,i){ve.Vector3[0].copyFrom(e);const r=ve.Vector3[0];ve.Vector3[1].copyFrom(t);const s=ve.Vector3[1];ve.Vector3[2].copyFrom(i);const a=ve.Vector3[2],l=ve.Vector3[3],o=ve.Vector3[4];r.normalize(),s.normalize(),a.normalize(),A.CrossToRef(a,r,l),A.CrossToRef(l,a,o);const c=Math.atan2(A.Dot(s,l),A.Dot(s,o));return e1(c)}static PitchYawRollToMoveBetweenPointsToRef(e,t,i){const r=V.Vector3[0];return t.subtractToRef(e,r),i._y=Math.atan2(r.x,r.z)||0,i._x=Math.atan2(Math.sqrt(r.x**2+r.z**2),r.y)||0,i._z=0,i._isDirty=!0,i}static PitchYawRollToMoveBetweenPoints(e,t){const i=A.Zero();return A.PitchYawRollToMoveBetweenPointsToRef(e,t,i)}static SlerpToRef(e,t,i,r){i=si(i,0,1);const s=ve.Vector3[0],a=ve.Vector3[1];s.copyFrom(e);const l=s.length();s.normalizeFromLength(l),a.copyFrom(t);const o=a.length();a.normalizeFromLength(o);const c=A.Dot(s,a);let u,h;if(c<1-ut){const d=Math.acos(c),f=1/Math.sin(d);u=Math.sin((1-i)*d)*f,h=Math.sin(i*d)*f}else u=1-i,h=i;return s.scaleInPlace(u),a.scaleInPlace(h),r.copyFrom(s).addInPlace(a),r.scaleInPlace(JT(l,o,i)),r}static SmoothToRef(e,t,i,r,s){return A.SlerpToRef(e,t,r===0?1:i/r,s),s}static FromArray(e,t=0){return new A(e[t],e[t+1],e[t+2])}static FromFloatArray(e,t){return A.FromArray(e,t)}static FromArrayToRef(e,t,i){return i._x=e[t],i._y=e[t+1],i._z=e[t+2],i._isDirty=!0,i}static FromFloatArrayToRef(e,t,i){return A.FromArrayToRef(e,t,i)}static FromFloatsToRef(e,t,i,r){return r.copyFromFloats(e,t,i),r}static Zero(){return new A(0,0,0)}static One(){return new A(1,1,1)}static Up(){return new A(0,1,0)}static get UpReadOnly(){return A._UpReadOnly}static get DownReadOnly(){return A._DownReadOnly}static get RightReadOnly(){return A._RightReadOnly}static get LeftReadOnly(){return A._LeftReadOnly}static get LeftHandedForwardReadOnly(){return A._LeftHandedForwardReadOnly}static get RightHandedForwardReadOnly(){return A._RightHandedForwardReadOnly}static get LeftHandedBackwardReadOnly(){return A._LeftHandedBackwardReadOnly}static get RightHandedBackwardReadOnly(){return A._RightHandedBackwardReadOnly}static get ZeroReadOnly(){return A._ZeroReadOnly}static get OneReadOnly(){return A._OneReadOnly}static Down(){return new A(0,-1,0)}static Forward(e=!1){return new A(0,0,e?-1:1)}static Backward(e=!1){return new A(0,0,e?1:-1)}static Right(){return new A(1,0,0)}static Left(){return new A(-1,0,0)}static Random(e=0,t=1){return new A(ei(e,t),ei(e,t),ei(e,t))}static RandomToRef(e=0,t=1,i){return i.copyFromFloats(ei(e,t),ei(e,t),ei(e,t))}static TransformCoordinates(e,t){const i=A.Zero();return A.TransformCoordinatesToRef(e,t,i),i}static TransformCoordinatesToRef(e,t,i){return A.TransformCoordinatesFromFloatsToRef(e._x,e._y,e._z,t,i),i}static TransformCoordinatesFromFloatsToRef(e,t,i,r,s){const a=r.m,l=e*a[0]+t*a[4]+i*a[8]+a[12],o=e*a[1]+t*a[5]+i*a[9]+a[13],c=e*a[2]+t*a[6]+i*a[10]+a[14],u=1/(e*a[3]+t*a[7]+i*a[11]+a[15]);return s._x=l*u,s._y=o*u,s._z=c*u,s._isDirty=!0,s}static TransformNormal(e,t){const i=A.Zero();return A.TransformNormalToRef(e,t,i),i}static TransformNormalToRef(e,t,i){return this.TransformNormalFromFloatsToRef(e._x,e._y,e._z,t,i),i}static TransformNormalFromFloatsToRef(e,t,i,r,s){const a=r.m;return s._x=e*a[0]+t*a[4]+i*a[8],s._y=e*a[1]+t*a[5]+i*a[9],s._z=e*a[2]+t*a[6]+i*a[10],s._isDirty=!0,s}static CatmullRom(e,t,i,r,s){const a=s*s,l=s*a,o=.5*(2*t._x+(-e._x+i._x)*s+(2*e._x-5*t._x+4*i._x-r._x)*a+(-e._x+3*t._x-3*i._x+r._x)*l),c=.5*(2*t._y+(-e._y+i._y)*s+(2*e._y-5*t._y+4*i._y-r._y)*a+(-e._y+3*t._y-3*i._y+r._y)*l),u=.5*(2*t._z+(-e._z+i._z)*s+(2*e._z-5*t._z+4*i._z-r._z)*a+(-e._z+3*t._z-3*i._z+r._z)*l);return new e.constructor(o,c,u)}static Clamp(e,t,i){const r=new e.constructor;return A.ClampToRef(e,t,i,r),r}static ClampToRef(e,t,i,r){let s=e._x;s=s>i._x?i._x:s,s=s<t._x?t._x:s;let a=e._y;a=a>i._y?i._y:a,a=a<t._y?t._y:a;let l=e._z;return l=l>i._z?i._z:l,l=l<t._z?t._z:l,r.copyFromFloats(s,a,l),r}static CheckExtends(e,t,i){t.minimizeInPlace(e),i.maximizeInPlace(e)}static Hermite(e,t,i,r,s){const a=s*s,l=s*a,o=2*l-3*a+1,c=-2*l+3*a,u=l-2*a+s,h=l-a,d=e._x*o+i._x*c+t._x*u+r._x*h,f=e._y*o+i._y*c+t._y*u+r._y*h,_=e._z*o+i._z*c+t._z*u+r._z*h;return new e.constructor(d,f,_)}static Hermite1stDerivative(e,t,i,r,s){const a=new e.constructor;return this.Hermite1stDerivativeToRef(e,t,i,r,s,a),a}static Hermite1stDerivativeToRef(e,t,i,r,s,a){const l=s*s;return a._x=(l-s)*6*e._x+(3*l-4*s+1)*t._x+(-l+s)*6*i._x+(3*l-2*s)*r._x,a._y=(l-s)*6*e._y+(3*l-4*s+1)*t._y+(-l+s)*6*i._y+(3*l-2*s)*r._y,a._z=(l-s)*6*e._z+(3*l-4*s+1)*t._z+(-l+s)*6*i._z+(3*l-2*s)*r._z,a._isDirty=!0,a}static Lerp(e,t,i){const r=new e.constructor(0,0,0);return A.LerpToRef(e,t,i,r),r}static LerpToRef(e,t,i,r){return r._x=e._x+(t._x-e._x)*i,r._y=e._y+(t._y-e._y)*i,r._z=e._z+(t._z-e._z)*i,r._isDirty=!0,r}static Dot(e,t){return e._x*t._x+e._y*t._y+e._z*t._z}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z}static Cross(e,t){const i=new e.constructor;return A.CrossToRef(e,t,i),i}static CrossToRef(e,t,i){const r=e._y*t._z-e._z*t._y,s=e._z*t._x-e._x*t._z,a=e._x*t._y-e._y*t._x;return i.copyFromFloats(r,s,a),i}static Normalize(e){const t=A.Zero();return A.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){return e.normalizeToRef(t),t}static Project(e,t,i,r){const s=new e.constructor;return A.ProjectToRef(e,t,i,r,s),s}static ProjectToRef(e,t,i,r,s){const a=r.width,l=r.height,o=r.x,c=r.y,u=ve.Matrix[1];z.FromValuesToRef(a/2,0,0,0,0,-l/2,0,0,0,0,.5,0,o+a/2,l/2+c,.5,1,u);const h=ve.Matrix[0];return t.multiplyToRef(i,h),h.multiplyToRef(u,h),A.TransformCoordinatesToRef(e,h,s),s}static Reflect(e,t){return this.ReflectToRef(e,t,new A)}static ReflectToRef(e,t,i){const r=V.Vector3[0];return r.copyFrom(t).scaleInPlace(2*A.Dot(e,t)),i.copyFrom(e).subtractInPlace(r)}static _UnprojectFromInvertedMatrixToRef(e,t,i){A.TransformCoordinatesToRef(e,t,i);const r=t.m,s=e._x*r[3]+e._y*r[7]+e._z*r[11]+r[15];return $i(s,1)&&i.scaleInPlace(1/s),i}static UnprojectFromTransform(e,t,i,r,s){return this.Unproject(e,t,i,r,s,z.IdentityReadOnly)}static Unproject(e,t,i,r,s,a){const l=new e.constructor;return A.UnprojectToRef(e,t,i,r,s,a,l),l}static UnprojectToRef(e,t,i,r,s,a,l){return A.UnprojectFloatsToRef(e._x,e._y,e._z,t,i,r,s,a,l),l}static UnprojectFloatsToRef(e,t,i,r,s,a,l,o,c){var d;const u=ve.Matrix[0];a.multiplyToRef(l,u),u.multiplyToRef(o,u),u.invert();const h=ve.Vector3[0];return h.x=e/r*2-1,h.y=-(t/s*2-1),(d=He.LastCreatedEngine)!=null&&d.isNDCHalfZRange?h.z=i:h.z=2*i-1,A._UnprojectFromInvertedMatrixToRef(h,u,c),c}static Minimize(e,t){const i=new e.constructor;return i.copyFrom(e),i.minimizeInPlace(t),i}static Maximize(e,t){const i=new e.constructor;return i.copyFrom(e),i.maximizeInPlace(t),i}static Distance(e,t){return Math.sqrt(A.DistanceSquared(e,t))}static DistanceSquared(e,t){const i=e._x-t._x,r=e._y-t._y,s=e._z-t._z;return i*i+r*r+s*s}static ProjectOnTriangleToRef(e,t,i,r,s){const a=ve.Vector3[0],l=ve.Vector3[1],o=ve.Vector3[2],c=ve.Vector3[3],u=ve.Vector3[4];i.subtractToRef(t,a),r.subtractToRef(t,l),r.subtractToRef(i,o);const h=a.length(),d=l.length(),f=o.length();if(h<ut||d<ut||f<ut)return s.copyFrom(t),A.Distance(e,t);e.subtractToRef(t,u),A.CrossToRef(a,l,c);const _=c.length();if(_<ut)return s.copyFrom(t),A.Distance(e,t);c.normalizeFromLength(_);let p=u.length();if(p<ut)return s.copyFrom(t),0;u.normalizeFromLength(p);const v=A.Dot(c,u),E=ve.Vector3[5],g=ve.Vector3[6];E.copyFrom(c).scaleInPlace(-p*v),g.copyFrom(e).addInPlace(E);const m=ve.Vector3[4],y=ve.Vector3[5],T=ve.Vector3[7],b=ve.Vector3[8];m.copyFrom(a).scaleInPlace(1/h),b.copyFrom(l).scaleInPlace(1/d),m.addInPlace(b).scaleInPlace(-1),y.copyFrom(a).scaleInPlace(-1/h),b.copyFrom(o).scaleInPlace(1/f),y.addInPlace(b).scaleInPlace(-1),T.copyFrom(o).scaleInPlace(-1/f),b.copyFrom(l).scaleInPlace(-1/d),T.addInPlace(b).scaleInPlace(-1);const C=ve.Vector3[9];let M;C.copyFrom(g).subtractInPlace(t),A.CrossToRef(m,C,b),M=A.Dot(b,c);const F=M;C.copyFrom(g).subtractInPlace(i),A.CrossToRef(y,C,b),M=A.Dot(b,c);const P=M;C.copyFrom(g).subtractInPlace(r),A.CrossToRef(T,C,b),M=A.Dot(b,c);const U=M,G=ve.Vector3[10];let K,q;F>0&&P<0?(G.copyFrom(a),K=t,q=i):P>0&&U<0?(G.copyFrom(o),K=i,q=r):(G.copyFrom(l).scaleInPlace(-1),K=r,q=t);const se=ve.Vector3[9],Ee=ve.Vector3[4];if(K.subtractToRef(g,b),q.subtractToRef(g,se),A.CrossToRef(b,se,Ee),!(A.Dot(Ee,c)<0))return s.copyFrom(g),Math.abs(p*v);const $=ve.Vector3[5];A.CrossToRef(G,Ee,$),$.normalize();const _e=ve.Vector3[9];_e.copyFrom(K).subtractInPlace(g);const ae=_e.length();if(ae<ut)return s.copyFrom(K),A.Distance(e,K);_e.normalizeFromLength(ae);const ce=A.Dot($,_e),he=ve.Vector3[7];he.copyFrom(g).addInPlace($.scaleInPlace(ae*ce)),b.copyFrom(he).subtractInPlace(K),p=G.length(),G.normalizeFromLength(p);let je=A.Dot(b,G)/Math.max(p,ut);return je=si(je,0,1),he.copyFrom(K).addInPlace(G.scaleInPlace(je*p)),s.copyFrom(he),A.Distance(e,he)}static Center(e,t){return A.CenterToRef(e,t,A.Zero())}static CenterToRef(e,t,i){return i.copyFromFloats((e._x+t._x)/2,(e._y+t._y)/2,(e._z+t._z)/2)}static RotationFromAxis(e,t,i){const r=new e.constructor;return A.RotationFromAxisToRef(e,t,i,r),r}static RotationFromAxisToRef(e,t,i,r){const s=ve.Quaternion[0];return ue.RotationQuaternionFromAxisToRef(e,t,i,s),s.toEulerAnglesToRef(r),r}}A._UpReadOnly=A.Up();A._DownReadOnly=A.Down();A._LeftHandedForwardReadOnly=A.Forward(!1);A._RightHandedForwardReadOnly=A.Forward(!0);A._LeftHandedBackwardReadOnly=A.Backward(!1);A._RightHandedBackwardReadOnly=A.Backward(!0);A._RightReadOnly=A.Right();A._LeftReadOnly=A.Left();A._ZeroReadOnly=A.Zero();A._OneReadOnly=A.One();Object.defineProperties(A.prototype,{dimension:{value:[3]},rank:{value:1}});class qe{constructor(e=0,t=0,i=0,r=0){this.x=e,this.y=t,this.z=i,this.w=r}toString(){return`{X: ${this.x} Y: ${this.y} Z: ${this.z} W: ${this.w}}`}getClassName(){return"Vector4"}getHashCode(){const e=Ir(this.x),t=Ir(this.y),i=Ir(this.z),r=Ir(this.w);let s=e;return s=s*397^t,s=s*397^i,s=s*397^r,s}asArray(){return[this.x,this.y,this.z,this.w]}toArray(e,t){return t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,this}fromArray(e,t=0){return qe.FromArrayToRef(e,t,this),this}addInPlace(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addInPlaceFromFloats(e,t,i,r){return this.x+=e,this.y+=t,this.z+=i,this.w+=r,this}add(e){return new this.constructor(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,t.z=this.z+e.z,t.w=this.w+e.w,t}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subtract(e){return new this.constructor(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z,t.w=this.w-e.w,t}subtractFromFloats(e,t,i,r){return new this.constructor(this.x-e,this.y-t,this.z-i,this.w-r)}subtractFromFloatsToRef(e,t,i,r,s){return s.x=this.x-e,s.y=this.y-t,s.z=this.z-i,s.w=this.w-r,s}negate(){return new this.constructor(-this.x,-this.y,-this.z,-this.w)}negateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this.w*=-1,this}negateToRef(e){return e.copyFromFloats(this.x*-1,this.y*-1,this.z*-1,this.w*-1)}scaleInPlace(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}scale(e){return new this.constructor(this.x*e,this.y*e,this.z*e,this.w*e)}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,t.z=this.z*e,t.w=this.w*e,t}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,t.z+=this.z*e,t.w+=this.w*e,t}equals(e){return e&&this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w}equalsWithEpsilon(e,t=ut){return e&&$i(this.x,e.x,t)&&$i(this.y,e.y,t)&&$i(this.z,e.z,t)&&$i(this.w,e.w,t)}equalsToFloats(e,t,i,r){return this.x===e&&this.y===t&&this.z===i&&this.w===r}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiply(e){return new this.constructor(this.x*e.x,this.y*e.y,this.z*e.z,this.w*e.w)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,t.z=this.z*e.z,t.w=this.w*e.w,t}multiplyByFloats(e,t,i,r){return new this.constructor(this.x*e,this.y*t,this.z*i,this.w*r)}divide(e){return new this.constructor(this.x/e.x,this.y/e.y,this.z/e.z,this.w/e.w)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,t.z=this.z/e.z,t.w=this.w/e.w,t}divideInPlace(e){return this.divideToRef(e,this)}minimizeInPlace(e){return e.x<this.x&&(this.x=e.x),e.y<this.y&&(this.y=e.y),e.z<this.z&&(this.z=e.z),e.w<this.w&&(this.w=e.w),this}maximizeInPlace(e){return e.x>this.x&&(this.x=e.x),e.y>this.y&&(this.y=e.y),e.z>this.z&&(this.z=e.z),e.w>this.w&&(this.w=e.w),this}minimizeInPlaceFromFloats(e,t,i,r){return this.x=Math.min(e,this.x),this.y=Math.min(t,this.y),this.z=Math.min(i,this.z),this.w=Math.min(r,this.w),this}maximizeInPlaceFromFloats(e,t,i,r){return this.x=Math.max(e,this.x),this.y=Math.max(t,this.y),this.z=Math.max(i,this.z),this.w=Math.max(r,this.w),this}floorToRef(e){return e.x=Math.floor(this.x),e.y=Math.floor(this.y),e.z=Math.floor(this.z),e.w=Math.floor(this.w),e}floor(){return new this.constructor(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fractToRef(e){return e.x=this.x-Math.floor(this.x),e.y=this.y-Math.floor(this.y),e.z=this.z-Math.floor(this.z),e.w=this.w-Math.floor(this.w),e}fract(){return new this.constructor(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(e){return e===0||e===1?this:this.scaleInPlace(1/e)}normalizeToNew(){const e=new this.constructor;return this.normalizeToRef(e),e}normalizeToRef(e){const t=this.length();return t===0||t===1?e.copyFrom(this):this.scaleToRef(1/t,e)}toVector3(){return new A(this.x,this.y,this.z)}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copyFrom(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}copyFromFloats(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}set(e,t,i,r){return this.copyFromFloats(e,t,i,r)}setAll(e){return this.x=this.y=this.z=this.w=e,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}static FromArray(e,t){return t||(t=0),new qe(e[t],e[t+1],e[t+2],e[t+3])}static FromArrayToRef(e,t,i){return i.x=e[t],i.y=e[t+1],i.z=e[t+2],i.w=e[t+3],i}static FromFloatArrayToRef(e,t,i){return qe.FromArrayToRef(e,t,i),i}static FromFloatsToRef(e,t,i,r,s){return s.x=e,s.y=t,s.z=i,s.w=r,s}static Zero(){return new qe(0,0,0,0)}static One(){return new qe(1,1,1,1)}static Random(e=0,t=1){return new qe(ei(e,t),ei(e,t),ei(e,t),ei(e,t))}static RandomToRef(e=0,t=1,i){return i.copyFromFloats(ei(e,t),ei(e,t),ei(e,t),ei(e,t))}static Clamp(e,t,i){const r=new e.constructor;return qe.ClampToRef(e,t,i,r),r}static ClampToRef(e,t,i,r){return r.copyFromFloats(si(e.x,t.x,i.x),si(e.y,t.y,i.y),si(e.z,t.z,i.z),si(e.w,t.w,i.w))}static CheckExtends(e,t,i){t.minimizeInPlace(e),i.maximizeInPlace(e)}static get ZeroReadOnly(){return qe._ZeroReadOnly}static Normalize(e){const t=qe.Zero();return qe.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){return e.normalizeToRef(t),t}static Minimize(e,t){const i=new e.constructor;return i.copyFrom(e),i.minimizeInPlace(t),i}static Maximize(e,t){const i=new e.constructor;return i.copyFrom(e),i.maximizeInPlace(t),i}static Distance(e,t){return Math.sqrt(qe.DistanceSquared(e,t))}static DistanceSquared(e,t){const i=e.x-t.x,r=e.y-t.y,s=e.z-t.z,a=e.w-t.w;return i*i+r*r+s*s+a*a}static Center(e,t){return qe.CenterToRef(e,t,qe.Zero())}static CenterToRef(e,t,i){return i.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2,(e.z+t.z)/2,(e.w+t.w)/2)}static TransformCoordinates(e,t){const i=qe.Zero();return qe.TransformCoordinatesToRef(e,t,i),i}static TransformCoordinatesToRef(e,t,i){return qe.TransformCoordinatesFromFloatsToRef(e._x,e._y,e._z,t,i),i}static TransformCoordinatesFromFloatsToRef(e,t,i,r,s){const a=r.m,l=e*a[0]+t*a[4]+i*a[8]+a[12],o=e*a[1]+t*a[5]+i*a[9]+a[13],c=e*a[2]+t*a[6]+i*a[10]+a[14],u=e*a[3]+t*a[7]+i*a[11]+a[15];return s.x=l,s.y=o,s.z=c,s.w=u,s}static TransformNormal(e,t){const i=new e.constructor;return qe.TransformNormalToRef(e,t,i),i}static TransformNormalToRef(e,t,i){const r=t.m,s=e.x*r[0]+e.y*r[4]+e.z*r[8],a=e.x*r[1]+e.y*r[5]+e.z*r[9],l=e.x*r[2]+e.y*r[6]+e.z*r[10];return i.x=s,i.y=a,i.z=l,i.w=e.w,i}static TransformNormalFromFloatsToRef(e,t,i,r,s,a){const l=s.m;return a.x=e*l[0]+t*l[4]+i*l[8],a.y=e*l[1]+t*l[5]+i*l[9],a.z=e*l[2]+t*l[6]+i*l[10],a.w=r,a}static FromVector3(e,t=0){return new qe(e._x,e._y,e._z,t)}static Dot(e,t){return e.dot(t)}}qe._ZeroReadOnly=qe.Zero();Object.defineProperties(qe.prototype,{dimension:{value:[4]},rank:{value:1}});class ue{get x(){return this._x}set x(e){this._x=e,this._isDirty=!0}get y(){return this._y}set y(e){this._y=e,this._isDirty=!0}get z(){return this._z}set z(e){this._z=e,this._isDirty=!0}get w(){return this._w}set w(e){this._w=e,this._isDirty=!0}constructor(e=0,t=0,i=0,r=1){this._isDirty=!0,this._x=e,this._y=t,this._z=i,this._w=r}toString(){return`{X: ${this._x} Y: ${this._y} Z: ${this._z} W: ${this._w}}`}getClassName(){return"Quaternion"}getHashCode(){const e=Ir(this._x),t=Ir(this._y),i=Ir(this._z),r=Ir(this._w);let s=e;return s=s*397^t,s=s*397^i,s=s*397^r,s}asArray(){return[this._x,this._y,this._z,this._w]}toArray(e,t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,this}fromArray(e,t=0){return ue.FromArrayToRef(e,t,this)}equals(e){return e&&this._x===e._x&&this._y===e._y&&this._z===e._z&&this._w===e._w}equalsWithEpsilon(e,t=ut){return e&&$i(this._x,e._x,t)&&$i(this._y,e._y,t)&&$i(this._z,e._z,t)&&$i(this._w,e._w,t)}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copyFrom(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._w=e._w,this._isDirty=!0,this}copyFromFloats(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._isDirty=!0,this}set(e,t,i,r){return this.copyFromFloats(e,t,i,r)}setAll(e){return this.copyFromFloats(e,e,e,e)}add(e){return new this.constructor(this._x+e._x,this._y+e._y,this._z+e._z,this._w+e._w)}addInPlace(e){return this._x+=e._x,this._y+=e._y,this._z+=e._z,this._w+=e._w,this._isDirty=!0,this}addToRef(e,t){return t._x=this._x+e._x,t._y=this._y+e._y,t._z=this._z+e._z,t._w=this._w+e._w,t._isDirty=!0,t}addInPlaceFromFloats(e,t,i,r){return this._x+=e,this._y+=t,this._z+=i,this._w+=r,this._isDirty=!0,this}subtractToRef(e,t){return t._x=this._x-e._x,t._y=this._y-e._y,t._z=this._z-e._z,t._w=this._w-e._w,t._isDirty=!0,t}subtractFromFloats(e,t,i,r){return this.subtractFromFloatsToRef(e,t,i,r,new this.constructor)}subtractFromFloatsToRef(e,t,i,r,s){return s._x=this._x-e,s._y=this._y-t,s._z=this._z-i,s._w=this._w-r,s._isDirty=!0,s}subtract(e){return new this.constructor(this._x-e._x,this._y-e._y,this._z-e._z,this._w-e._w)}subtractInPlace(e){return this._x-=e._x,this._y-=e._y,this._z-=e._z,this._w-=e._w,this._isDirty=!0,this}scale(e){return new this.constructor(this._x*e,this._y*e,this._z*e,this._w*e)}scaleToRef(e,t){return t._x=this._x*e,t._y=this._y*e,t._z=this._z*e,t._w=this._w*e,t._isDirty=!0,t}scaleInPlace(e){return this._x*=e,this._y*=e,this._z*=e,this._w*=e,this._isDirty=!0,this}scaleAndAddToRef(e,t){return t._x+=this._x*e,t._y+=this._y*e,t._z+=this._z*e,t._w+=this._w*e,t._isDirty=!0,t}multiply(e){const t=new this.constructor(0,0,0,1);return this.multiplyToRef(e,t),t}multiplyToRef(e,t){const i=this._x*e._w+this._y*e._z-this._z*e._y+this._w*e._x,r=-this._x*e._z+this._y*e._w+this._z*e._x+this._w*e._y,s=this._x*e._y-this._y*e._x+this._z*e._w+this._w*e._z,a=-this._x*e._x-this._y*e._y-this._z*e._z+this._w*e._w;return t.copyFromFloats(i,r,s,a),t}multiplyInPlace(e){return this.multiplyToRef(e,this)}multiplyByFloats(e,t,i,r){return this._x*=e,this._y*=t,this._z*=i,this._w*=r,this._isDirty=!0,this}divide(e){throw new ReferenceError("Can not divide a quaternion")}divideToRef(e,t){throw new ReferenceError("Can not divide a quaternion")}divideInPlace(e){throw new ReferenceError("Can not divide a quaternion")}minimizeInPlace(){throw new ReferenceError("Can not minimize a quaternion")}minimizeInPlaceFromFloats(){throw new ReferenceError("Can not minimize a quaternion")}maximizeInPlace(){throw new ReferenceError("Can not maximize a quaternion")}maximizeInPlaceFromFloats(){throw new ReferenceError("Can not maximize a quaternion")}negate(){return this.negateToRef(new this.constructor)}negateInPlace(){return this._x=-this._x,this._y=-this._y,this._z=-this._z,this._w=-this._w,this._isDirty=!0,this}negateToRef(e){return e._x=-this._x,e._y=-this._y,e._z=-this._z,e._w=-this._w,e._isDirty=!0,e}equalsToFloats(e,t,i,r){return this._x===e&&this._y===t&&this._z===i&&this._w===r}floorToRef(e){throw new ReferenceError("Can not floor a quaternion")}floor(){throw new ReferenceError("Can not floor a quaternion")}fractToRef(e){throw new ReferenceError("Can not fract a quaternion")}fract(){throw new ReferenceError("Can not fract a quaternion")}conjugateToRef(e){return e.copyFromFloats(-this._x,-this._y,-this._z,this._w),e}conjugateInPlace(){return this._x*=-1,this._y*=-1,this._z*=-1,this._isDirty=!0,this}conjugate(){return new this.constructor(-this._x,-this._y,-this._z,this._w)}invert(){const e=this.conjugate(),t=this.lengthSquared();return t==0||t==1||e.scaleInPlace(1/t),e}invertInPlace(){this.conjugateInPlace();const e=this.lengthSquared();return e==0||e==1?this:(this.scaleInPlace(1/e),this)}lengthSquared(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this.lengthSquared())}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(e){return e===0||e===1?this:this.scaleInPlace(1/e)}normalizeToNew(){const e=new this.constructor(0,0,0,1);return this.normalizeToRef(e),e}normalizeToRef(e){const t=this.length();return t===0||t===1?e.copyFromFloats(this._x,this._y,this._z,this._w):this.scaleToRef(1/t,e)}toEulerAngles(){const e=A.Zero();return this.toEulerAnglesToRef(e),e}toEulerAnglesToRef(e){const t=this._z,i=this._x,r=this._y,s=this._w,a=r*t-i*s,l=.4999999;if(a<-l)e._y=2*Math.atan2(r,s),e._x=Math.PI/2,e._z=0,e._isDirty=!0;else if(a>l)e._y=2*Math.atan2(r,s),e._x=-Math.PI/2,e._z=0,e._isDirty=!0;else{const o=s*s,c=t*t,u=i*i,h=r*r;e._z=Math.atan2(2*(i*r+t*s),-c-u+h+o),e._x=Math.asin(-2*a),e._y=Math.atan2(2*(t*i+r*s),c-u-h+o),e._isDirty=!0}return e}toRotationMatrix(e){return z.FromQuaternionToRef(this,e),e}fromRotationMatrix(e){return ue.FromRotationMatrixToRef(e,this),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}static FromRotationMatrix(e){const t=new ue;return ue.FromRotationMatrixToRef(e,t),t}static FromRotationMatrixToRef(e,t){const i=e.m,r=i[0],s=i[4],a=i[8],l=i[1],o=i[5],c=i[9],u=i[2],h=i[6],d=i[10],f=r+o+d;let _;return f>0?(_=.5/Math.sqrt(f+1),t._w=.25/_,t._x=(h-c)*_,t._y=(a-u)*_,t._z=(l-s)*_,t._isDirty=!0):r>o&&r>d?(_=2*Math.sqrt(1+r-o-d),t._w=(h-c)/_,t._x=.25*_,t._y=(s+l)/_,t._z=(a+u)/_,t._isDirty=!0):o>d?(_=2*Math.sqrt(1+o-r-d),t._w=(a-u)/_,t._x=(s+l)/_,t._y=.25*_,t._z=(c+h)/_,t._isDirty=!0):(_=2*Math.sqrt(1+d-r-o),t._w=(l-s)/_,t._x=(a+u)/_,t._y=(c+h)/_,t._z=.25*_,t._isDirty=!0),t}static Dot(e,t){return e._x*t._x+e._y*t._y+e._z*t._z+e._w*t._w}static AreClose(e,t,i=.1){const r=ue.Dot(e,t);return 1-r*r<=i}static SmoothToRef(e,t,i,r,s){let a=r===0?1:i/r;return a=si(a,0,1),ue.SlerpToRef(e,t,a,s),s}static Zero(){return new ue(0,0,0,0)}static Inverse(e){return new e.constructor(-e._x,-e._y,-e._z,e._w)}static InverseToRef(e,t){return t.set(-e._x,-e._y,-e._z,e._w),t}static Identity(){return new ue(0,0,0,1)}static IsIdentity(e){return e&&e._x===0&&e._y===0&&e._z===0&&e._w===1}static RotationAxis(e,t){return ue.RotationAxisToRef(e,t,new ue)}static RotationAxisToRef(e,t,i){const r=Math.sin(t/2);return e.normalize(),i._w=Math.cos(t/2),i._x=e._x*r,i._y=e._y*r,i._z=e._z*r,i._isDirty=!0,i}static FromArray(e,t){return t||(t=0),new ue(e[t],e[t+1],e[t+2],e[t+3])}static FromArrayToRef(e,t,i){return i._x=e[t],i._y=e[t+1],i._z=e[t+2],i._w=e[t+3],i._isDirty=!0,i}static FromFloatsToRef(e,t,i,r,s){return s.copyFromFloats(e,t,i,r),s}static FromEulerAngles(e,t,i){const r=new ue;return ue.RotationYawPitchRollToRef(t,e,i,r),r}static FromEulerAnglesToRef(e,t,i,r){return ue.RotationYawPitchRollToRef(t,e,i,r),r}static FromEulerVector(e){const t=new ue;return ue.RotationYawPitchRollToRef(e._y,e._x,e._z,t),t}static FromEulerVectorToRef(e,t){return ue.RotationYawPitchRollToRef(e._y,e._x,e._z,t),t}static FromUnitVectorsToRef(e,t,i,r=ut){const s=A.Dot(e,t)+1;return s<r?Math.abs(e.x)>Math.abs(e.z)?i.set(-e.y,e.x,0,0):i.set(0,-e.z,e.y,0):(A.CrossToRef(e,t,V.Vector3[0]),i.set(V.Vector3[0].x,V.Vector3[0].y,V.Vector3[0].z,s)),i.normalize()}static RotationYawPitchRoll(e,t,i){const r=new ue;return ue.RotationYawPitchRollToRef(e,t,i,r),r}static RotationYawPitchRollToRef(e,t,i,r){const s=i*.5,a=t*.5,l=e*.5,o=Math.sin(s),c=Math.cos(s),u=Math.sin(a),h=Math.cos(a),d=Math.sin(l),f=Math.cos(l);return r._x=f*u*c+d*h*o,r._y=d*h*c-f*u*o,r._z=f*h*o-d*u*c,r._w=f*h*c+d*u*o,r._isDirty=!0,r}static RotationAlphaBetaGamma(e,t,i){const r=new ue;return ue.RotationAlphaBetaGammaToRef(e,t,i,r),r}static RotationAlphaBetaGammaToRef(e,t,i,r){const s=(i+e)*.5,a=(i-e)*.5,l=t*.5;return r._x=Math.cos(a)*Math.sin(l),r._y=Math.sin(a)*Math.sin(l),r._z=Math.sin(s)*Math.cos(l),r._w=Math.cos(s)*Math.cos(l),r._isDirty=!0,r}static RotationQuaternionFromAxis(e,t,i){const r=new ue(0,0,0,0);return ue.RotationQuaternionFromAxisToRef(e,t,i,r),r}static RotationQuaternionFromAxisToRef(e,t,i,r){const s=ve.Matrix[0];return z.FromXYZAxesToRef(e.normalize(),t.normalize(),i.normalize(),s),ue.FromRotationMatrixToRef(s,r),r}static FromLookDirectionLH(e,t){const i=new ue;return ue.FromLookDirectionLHToRef(e,t,i),i}static FromLookDirectionLHToRef(e,t,i){const r=ve.Matrix[0];return z.LookDirectionLHToRef(e,t,r),ue.FromRotationMatrixToRef(r,i),i}static FromLookDirectionRH(e,t){const i=new ue;return ue.FromLookDirectionRHToRef(e,t,i),i}static FromLookDirectionRHToRef(e,t,i){const r=ve.Matrix[0];return z.LookDirectionRHToRef(e,t,r),ue.FromRotationMatrixToRef(r,i)}static Slerp(e,t,i){const r=ue.Identity();return ue.SlerpToRef(e,t,i,r),r}static SlerpToRef(e,t,i,r){let s,a,l=e._x*t._x+e._y*t._y+e._z*t._z+e._w*t._w,o=!1;if(l<0&&(o=!0,l=-l),l>.999999)a=1-i,s=o?-i:i;else{const c=Math.acos(l),u=1/Math.sin(c);a=Math.sin((1-i)*c)*u,s=o?-Math.sin(i*c)*u:Math.sin(i*c)*u}return r._x=a*e._x+s*t._x,r._y=a*e._y+s*t._y,r._z=a*e._z+s*t._z,r._w=a*e._w+s*t._w,r._isDirty=!0,r}static Hermite(e,t,i,r,s){const a=s*s,l=s*a,o=2*l-3*a+1,c=-2*l+3*a,u=l-2*a+s,h=l-a,d=e._x*o+i._x*c+t._x*u+r._x*h,f=e._y*o+i._y*c+t._y*u+r._y*h,_=e._z*o+i._z*c+t._z*u+r._z*h,p=e._w*o+i._w*c+t._w*u+r._w*h;return new e.constructor(d,f,_,p)}static Hermite1stDerivative(e,t,i,r,s){const a=new e.constructor;return this.Hermite1stDerivativeToRef(e,t,i,r,s,a),a}static Hermite1stDerivativeToRef(e,t,i,r,s,a){const l=s*s;return a._x=(l-s)*6*e._x+(3*l-4*s+1)*t._x+(-l+s)*6*i._x+(3*l-2*s)*r._x,a._y=(l-s)*6*e._y+(3*l-4*s+1)*t._y+(-l+s)*6*i._y+(3*l-2*s)*r._y,a._z=(l-s)*6*e._z+(3*l-4*s+1)*t._z+(-l+s)*6*i._z+(3*l-2*s)*r._z,a._w=(l-s)*6*e._w+(3*l-4*s+1)*t._w+(-l+s)*6*i._w+(3*l-2*s)*r._w,a._isDirty=!0,a}static Normalize(e){const t=ue.Zero();return ue.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){return e.normalizeToRef(t),t}static Clamp(e,t,i){const r=new e.constructor;return ue.ClampToRef(e,t,i,r),r}static ClampToRef(e,t,i,r){return r.copyFromFloats(si(e.x,t.x,i.x),si(e.y,t.y,i.y),si(e.z,t.z,i.z),si(e.w,t.w,i.w))}static Random(e=0,t=1){return new ue(ei(e,t),ei(e,t),ei(e,t),ei(e,t))}static RandomToRef(e=0,t=1,i){return i.copyFromFloats(ei(e,t),ei(e,t),ei(e,t),ei(e,t))}static Minimize(){throw new ReferenceError("Quaternion.Minimize does not make sense")}static Maximize(){throw new ReferenceError("Quaternion.Maximize does not make sense")}static Distance(e,t){return Math.sqrt(ue.DistanceSquared(e,t))}static DistanceSquared(e,t){const i=e.x-t.x,r=e.y-t.y,s=e.z-t.z,a=e.w-t.w;return i*i+r*r+s*s+a*a}static Center(e,t){return ue.CenterToRef(e,t,ue.Zero())}static CenterToRef(e,t,i){return i.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2,(e.z+t.z)/2,(e.w+t.w)/2)}}Object.defineProperties(ue.prototype,{dimension:{value:[4]},rank:{value:1}});class z{static get Use64Bits(){return Pi.MatrixUse64Bits}get m(){return this._m}markAsUpdated(){this.updateFlag=z._UpdateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0}_updateIdentityStatus(e,t=!1,i=!1,r=!0){this._isIdentity=e,this._isIdentity3x2=e||i,this._isIdentityDirty=this._isIdentity?!1:t,this._isIdentity3x2Dirty=this._isIdentity3x2?!1:r}constructor(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this.updateFlag=-1,Pi.MatrixTrackPrecisionChange&&Pi.MatrixTrackedMatrices.push(this),this._m=new Pi.MatrixCurrentType(16),this.markAsUpdated()}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;const e=this._m;this._isIdentity=e[0]===1&&e[1]===0&&e[2]===0&&e[3]===0&&e[4]===0&&e[5]===1&&e[6]===0&&e[7]===0&&e[8]===0&&e[9]===0&&e[10]===1&&e[11]===0&&e[12]===0&&e[13]===0&&e[14]===0&&e[15]===1}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,this._m[0]!==1||this._m[5]!==1||this._m[15]!==1?this._isIdentity3x2=!1:this._m[1]!==0||this._m[2]!==0||this._m[3]!==0||this._m[4]!==0||this._m[6]!==0||this._m[7]!==0||this._m[8]!==0||this._m[9]!==0||this._m[10]!==0||this._m[11]!==0||this._m[12]!==0||this._m[13]!==0||this._m[14]!==0?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(this._isIdentity===!0)return 1;const e=this._m,t=e[0],i=e[1],r=e[2],s=e[3],a=e[4],l=e[5],o=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],_=e[12],p=e[13],v=e[14],E=e[15],g=d*E-v*f,m=h*E-p*f,y=h*v-p*d,T=u*E-_*f,b=u*v-d*_,C=u*p-_*h,M=+(l*g-o*m+c*y),F=-(a*g-o*T+c*b),P=+(a*m-l*T+c*C),U=-(a*y-l*b+o*C);return t*M+i*F+r*P+s*U}toString(){return`{${this.m[0]}, ${this.m[1]}, ${this.m[2]}, ${this.m[3]}
${this.m[4]}, ${this.m[5]}, ${this.m[6]}, ${this.m[7]}
${this.m[8]}, ${this.m[9]}, ${this.m[10]}, ${this.m[11]}
${this.m[12]}, ${this.m[13]}, ${this.m[14]}, ${this.m[15]}}`}toArray(e=null,t=0){if(!e)return this._m;const i=this._m;for(let r=0;r<16;r++)e[t+r]=i[r];return this}asArray(){return this._m}fromArray(e,t=0){return z.FromArrayToRef(e,t,this)}copyFromFloats(...e){return z.FromArrayToRef(e,0,this)}set(...e){const t=this._m;for(let i=0;i<16;i++)t[i]=e[i];return this.markAsUpdated(),this}setAll(e){const t=this._m;for(let i=0;i<16;i++)t[i]=e;return this.markAsUpdated(),this}invert(){return this.invertToRef(this),this}reset(){return z.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this}add(e){const t=new this.constructor;return this.addToRef(e,t),t}addToRef(e,t){const i=this._m,r=t._m,s=e.m;for(let a=0;a<16;a++)r[a]=i[a]+s[a];return t.markAsUpdated(),t}addToSelf(e){const t=this._m,i=e.m;for(let r=0;r<16;r++)t[r]+=i[r];return this.markAsUpdated(),this}addInPlace(e){const t=this._m,i=e.m;for(let r=0;r<16;r++)t[r]+=i[r];return this.markAsUpdated(),this}addInPlaceFromFloats(...e){const t=this._m;for(let i=0;i<16;i++)t[i]+=e[i];return this.markAsUpdated(),this}subtract(e){const t=this._m,i=e.m;for(let r=0;r<16;r++)t[r]-=i[r];return this.markAsUpdated(),this}subtractToRef(e,t){const i=this._m,r=e.m,s=t._m;for(let a=0;a<16;a++)s[a]=i[a]-r[a];return t.markAsUpdated(),t}subtractInPlace(e){const t=this._m,i=e.m;for(let r=0;r<16;r++)t[r]-=i[r];return this.markAsUpdated(),this}subtractFromFloats(...e){return this.subtractFromFloatsToRef(...e,new this.constructor)}subtractFromFloatsToRef(...e){const t=e.pop(),i=this._m,r=t._m,s=e;for(let a=0;a<16;a++)r[a]=i[a]-s[a];return t.markAsUpdated(),t}invertToRef(e){if(this._isIdentity===!0)return z.IdentityToRef(e),e;const t=this._m,i=t[0],r=t[1],s=t[2],a=t[3],l=t[4],o=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],_=t[11],p=t[12],v=t[13],E=t[14],g=t[15],m=f*g-E*_,y=d*g-v*_,T=d*E-v*f,b=h*g-p*_,C=h*E-f*p,M=h*v-p*d,F=+(o*m-c*y+u*T),P=-(l*m-c*b+u*C),U=+(l*y-o*b+u*M),G=-(l*T-o*C+c*M),K=i*F+r*P+s*U+a*G;if(K===0)return e.copyFrom(this),e;const q=1/K,se=c*g-E*u,Ee=o*g-v*u,Se=o*E-v*c,$=l*g-p*u,_e=l*E-p*c,ae=l*v-p*o,ce=c*_-f*u,he=o*_-d*u,je=o*f-d*c,Xe=l*_-h*u,Tt=l*f-h*c,Ze=l*d-h*o,W=-(r*m-s*y+a*T),pe=+(i*m-s*b+a*C),De=-(i*y-r*b+a*M),ft=+(i*T-r*C+s*M),st=+(r*se-s*Ee+a*Se),$e=-(i*se-s*$+a*_e),bt=+(i*Ee-r*$+a*ae),Wt=-(i*Se-r*_e+s*ae),rt=-(r*ce-s*he+a*je),Ht=+(i*ce-s*Xe+a*Tt),Ni=-(i*he-r*Xe+a*Ze),Ar=+(i*je-r*Tt+s*Ze);return z.FromValuesToRef(F*q,W*q,st*q,rt*q,P*q,pe*q,$e*q,Ht*q,U*q,De*q,bt*q,Ni*q,G*q,ft*q,Wt*q,Ar*q,e),e}addAtIndex(e,t){return this._m[e]+=t,this.markAsUpdated(),this}multiplyAtIndex(e,t){return this._m[e]*=t,this.markAsUpdated(),this}setTranslationFromFloats(e,t,i){return this._m[12]=e,this._m[13]=t,this._m[14]=i,this.markAsUpdated(),this}addTranslationFromFloats(e,t,i){return this._m[12]+=e,this._m[13]+=t,this._m[14]+=i,this.markAsUpdated(),this}setTranslation(e){return this.setTranslationFromFloats(e._x,e._y,e._z)}getTranslation(){return new A(this._m[12],this._m[13],this._m[14])}getTranslationToRef(e){return e.x=this._m[12],e.y=this._m[13],e.z=this._m[14],e}removeRotationAndScaling(){const e=this.m;return z.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,e[12],e[13],e[14],e[15],this),this._updateIdentityStatus(e[12]===0&&e[13]===0&&e[14]===0&&e[15]===1),this}copyFrom(e){e.copyToArray(this._m);const t=e;return this.updateFlag=t.updateFlag,this._updateIdentityStatus(t._isIdentity,t._isIdentityDirty,t._isIdentity3x2,t._isIdentity3x2Dirty),this}copyToArray(e,t=0){const i=this._m;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],this}multiply(e){const t=new this.constructor;return this.multiplyToRef(e,t),t}multiplyInPlace(e){const t=this._m,i=e.m;for(let r=0;r<16;r++)t[r]*=i[r];return this.markAsUpdated(),this}multiplyByFloats(...e){const t=this._m;for(let i=0;i<16;i++)t[i]=e[i];return this.markAsUpdated(),this}multiplyByFloatsToRef(...e){const t=e.pop(),i=this._m,r=t._m,s=e;for(let a=0;a<16;a++)r[a]=i[a]*s[a];return t.markAsUpdated(),t}multiplyToRef(e,t){return this._isIdentity?(t.copyFrom(e),t):e._isIdentity?(t.copyFrom(this),t):(this.multiplyToArray(e,t._m,0),t.markAsUpdated(),t)}multiplyToArray(e,t,i){const r=this._m,s=e.m,a=r[0],l=r[1],o=r[2],c=r[3],u=r[4],h=r[5],d=r[6],f=r[7],_=r[8],p=r[9],v=r[10],E=r[11],g=r[12],m=r[13],y=r[14],T=r[15],b=s[0],C=s[1],M=s[2],F=s[3],P=s[4],U=s[5],G=s[6],K=s[7],q=s[8],se=s[9],Ee=s[10],Se=s[11],$=s[12],_e=s[13],ae=s[14],ce=s[15];return t[i]=a*b+l*P+o*q+c*$,t[i+1]=a*C+l*U+o*se+c*_e,t[i+2]=a*M+l*G+o*Ee+c*ae,t[i+3]=a*F+l*K+o*Se+c*ce,t[i+4]=u*b+h*P+d*q+f*$,t[i+5]=u*C+h*U+d*se+f*_e,t[i+6]=u*M+h*G+d*Ee+f*ae,t[i+7]=u*F+h*K+d*Se+f*ce,t[i+8]=_*b+p*P+v*q+E*$,t[i+9]=_*C+p*U+v*se+E*_e,t[i+10]=_*M+p*G+v*Ee+E*ae,t[i+11]=_*F+p*K+v*Se+E*ce,t[i+12]=g*b+m*P+y*q+T*$,t[i+13]=g*C+m*U+y*se+T*_e,t[i+14]=g*M+m*G+y*Ee+T*ae,t[i+15]=g*F+m*K+y*Se+T*ce,this}divide(e){return this.divideToRef(e,new this.constructor)}divideToRef(e,t){const i=this._m,r=e.m,s=t._m;for(let a=0;a<16;a++)s[a]=i[a]/r[a];return t.markAsUpdated(),t}divideInPlace(e){const t=this._m,i=e.m;for(let r=0;r<16;r++)t[r]/=i[r];return this.markAsUpdated(),this}minimizeInPlace(e){const t=this._m,i=e.m;for(let r=0;r<16;r++)t[r]=Math.min(t[r],i[r]);return this.markAsUpdated(),this}minimizeInPlaceFromFloats(...e){const t=this._m;for(let i=0;i<16;i++)t[i]=Math.min(t[i],e[i]);return this.markAsUpdated(),this}maximizeInPlace(e){const t=this._m,i=e.m;for(let r=0;r<16;r++)t[r]=Math.min(t[r],i[r]);return this.markAsUpdated(),this}maximizeInPlaceFromFloats(...e){const t=this._m;for(let i=0;i<16;i++)t[i]=Math.min(t[i],e[i]);return this.markAsUpdated(),this}negate(){return this.negateToRef(new this.constructor)}negateInPlace(){const e=this._m;for(let t=0;t<16;t++)e[t]=-e[t];return this.markAsUpdated(),this}negateToRef(e){const t=this._m,i=e._m;for(let r=0;r<16;r++)i[r]=-t[r];return e.markAsUpdated(),e}equals(e){const t=e;if(!t)return!1;if((this._isIdentity||t._isIdentity)&&!this._isIdentityDirty&&!t._isIdentityDirty)return this._isIdentity&&t._isIdentity;const i=this.m,r=t.m;return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]&&i[4]===r[4]&&i[5]===r[5]&&i[6]===r[6]&&i[7]===r[7]&&i[8]===r[8]&&i[9]===r[9]&&i[10]===r[10]&&i[11]===r[11]&&i[12]===r[12]&&i[13]===r[13]&&i[14]===r[14]&&i[15]===r[15]}equalsWithEpsilon(e,t=0){const i=this._m,r=e.m;for(let s=0;s<16;s++)if(!$i(i[s],r[s],t))return!1;return!0}equalsToFloats(...e){const t=this._m;for(let i=0;i<16;i++)if(t[i]!=e[i])return!1;return!0}floor(){return this.floorToRef(new this.constructor)}floorToRef(e){const t=this._m,i=e._m;for(let r=0;r<16;r++)i[r]=Math.floor(t[r]);return e.markAsUpdated(),e}fract(){return this.fractToRef(new this.constructor)}fractToRef(e){const t=this._m,i=e._m;for(let r=0;r<16;r++)i[r]=t[r]-Math.floor(t[r]);return e.markAsUpdated(),e}clone(){const e=new this.constructor;return e.copyFrom(this),e}getClassName(){return"Matrix"}getHashCode(){let e=Ir(this._m[0]);for(let t=1;t<16;t++)e=e*397^Ir(this._m[t]);return e}decomposeToTransformNode(e){return e.rotationQuaternion=e.rotationQuaternion||new ue,this.decompose(e.scaling,e.rotationQuaternion,e.position)}decompose(e,t,i,r,s=!0){if(this._isIdentity)return i&&i.setAll(0),e&&e.setAll(1),t&&t.copyFromFloats(0,0,0,1),!0;const a=this._m;if(i&&i.copyFromFloats(a[12],a[13],a[14]),e=e||ve.Vector3[0],e.x=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]),e.y=Math.sqrt(a[4]*a[4]+a[5]*a[5]+a[6]*a[6]),e.z=Math.sqrt(a[8]*a[8]+a[9]*a[9]+a[10]*a[10]),r){const l=(s?r.absoluteScaling.x:r.scaling.x)<0?-1:1,o=(s?r.absoluteScaling.y:r.scaling.y)<0?-1:1,c=(s?r.absoluteScaling.z:r.scaling.z)<0?-1:1;e.x*=l,e.y*=o,e.z*=c}else this.determinant()<=0&&(e.y*=-1);if(e._x===0||e._y===0||e._z===0)return t&&t.copyFromFloats(0,0,0,1),!1;if(t){const l=1/e._x,o=1/e._y,c=1/e._z;z.FromValuesToRef(a[0]*l,a[1]*l,a[2]*l,0,a[4]*o,a[5]*o,a[6]*o,0,a[8]*c,a[9]*c,a[10]*c,0,0,0,0,1,ve.Matrix[0]),ue.FromRotationMatrixToRef(ve.Matrix[0],t)}return!0}getRow(e){if(e<0||e>3)return null;const t=e*4;return new qe(this._m[t+0],this._m[t+1],this._m[t+2],this._m[t+3])}getRowToRef(e,t){if(e>=0&&e<=3){const i=e*4;t.x=this._m[i+0],t.y=this._m[i+1],t.z=this._m[i+2],t.w=this._m[i+3]}return t}setRow(e,t){return this.setRowFromFloats(e,t.x,t.y,t.z,t.w)}transpose(){const e=new this.constructor;return z.TransposeToRef(this,e),e}transposeToRef(e){return z.TransposeToRef(this,e),e}setRowFromFloats(e,t,i,r,s){if(e<0||e>3)return this;const a=e*4;return this._m[a+0]=t,this._m[a+1]=i,this._m[a+2]=r,this._m[a+3]=s,this.markAsUpdated(),this}scale(e){const t=new this.constructor;return this.scaleToRef(e,t),t}scaleToRef(e,t){for(let i=0;i<16;i++)t._m[i]=this._m[i]*e;return t.markAsUpdated(),t}scaleAndAddToRef(e,t){for(let i=0;i<16;i++)t._m[i]+=this._m[i]*e;return t.markAsUpdated(),t}scaleInPlace(e){const t=this._m;for(let i=0;i<16;i++)t[i]*=e;return this.markAsUpdated(),this}toNormalMatrix(e){const t=ve.Matrix[0];this.invertToRef(t),t.transposeToRef(e);const i=e._m;return z.FromValuesToRef(i[0],i[1],i[2],0,i[4],i[5],i[6],0,i[8],i[9],i[10],0,0,0,0,1,e),e}getRotationMatrix(){const e=new this.constructor;return this.getRotationMatrixToRef(e),e}getRotationMatrixToRef(e){const t=ve.Vector3[0];if(!this.decompose(t))return z.IdentityToRef(e),e;const i=this._m,r=1/t._x,s=1/t._y,a=1/t._z;return z.FromValuesToRef(i[0]*r,i[1]*r,i[2]*r,0,i[4]*s,i[5]*s,i[6]*s,0,i[8]*a,i[9]*a,i[10]*a,0,0,0,0,1,e),e}toggleModelMatrixHandInPlace(){const e=this._m;return e[2]*=-1,e[6]*=-1,e[8]*=-1,e[9]*=-1,e[14]*=-1,this.markAsUpdated(),this}toggleProjectionMatrixHandInPlace(){const e=this._m;return e[8]*=-1,e[9]*=-1,e[10]*=-1,e[11]*=-1,this.markAsUpdated(),this}static FromArray(e,t=0){const i=new z;return z.FromArrayToRef(e,t,i),i}static FromArrayToRef(e,t,i){for(let r=0;r<16;r++)i._m[r]=e[r+t];return i.markAsUpdated(),i}static FromFloat32ArrayToRefScaled(e,t,i,r){for(let s=0;s<16;s++)r._m[s]=e[s+t]*i;return r.markAsUpdated(),r}static get IdentityReadOnly(){return z._IdentityReadOnly}static FromValuesToRef(e,t,i,r,s,a,l,o,c,u,h,d,f,_,p,v,E){const g=E._m;g[0]=e,g[1]=t,g[2]=i,g[3]=r,g[4]=s,g[5]=a,g[6]=l,g[7]=o,g[8]=c,g[9]=u,g[10]=h,g[11]=d,g[12]=f,g[13]=_,g[14]=p,g[15]=v,E.markAsUpdated()}static FromValues(e,t,i,r,s,a,l,o,c,u,h,d,f,_,p,v){const E=new z,g=E._m;return g[0]=e,g[1]=t,g[2]=i,g[3]=r,g[4]=s,g[5]=a,g[6]=l,g[7]=o,g[8]=c,g[9]=u,g[10]=h,g[11]=d,g[12]=f,g[13]=_,g[14]=p,g[15]=v,E.markAsUpdated(),E}static Compose(e,t,i){const r=new z;return z.ComposeToRef(e,t,i,r),r}static ComposeToRef(e,t,i,r){const s=r._m,a=t._x,l=t._y,o=t._z,c=t._w,u=a+a,h=l+l,d=o+o,f=a*u,_=a*h,p=a*d,v=l*h,E=l*d,g=o*d,m=c*u,y=c*h,T=c*d,b=e._x,C=e._y,M=e._z;return s[0]=(1-(v+g))*b,s[1]=(_+T)*b,s[2]=(p-y)*b,s[3]=0,s[4]=(_-T)*C,s[5]=(1-(f+g))*C,s[6]=(E+m)*C,s[7]=0,s[8]=(p+y)*M,s[9]=(E-m)*M,s[10]=(1-(f+v))*M,s[11]=0,s[12]=i._x,s[13]=i._y,s[14]=i._z,s[15]=1,r.markAsUpdated(),r}static Identity(){const e=z.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return e._updateIdentityStatus(!0),e}static IdentityToRef(e){return z.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,e),e._updateIdentityStatus(!0),e}static Zero(){const e=z.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return e._updateIdentityStatus(!1),e}static RotationX(e){const t=new z;return z.RotationXToRef(e,t),t}static Invert(e){const t=new e.constructor;return e.invertToRef(t),t}static RotationXToRef(e,t){const i=Math.sin(e),r=Math.cos(e);return z.FromValuesToRef(1,0,0,0,0,r,i,0,0,-i,r,0,0,0,0,1,t),t._updateIdentityStatus(r===1&&i===0),t}static RotationY(e){const t=new z;return z.RotationYToRef(e,t),t}static RotationYToRef(e,t){const i=Math.sin(e),r=Math.cos(e);return z.FromValuesToRef(r,0,-i,0,0,1,0,0,i,0,r,0,0,0,0,1,t),t._updateIdentityStatus(r===1&&i===0),t}static RotationZ(e){const t=new z;return z.RotationZToRef(e,t),t}static RotationZToRef(e,t){const i=Math.sin(e),r=Math.cos(e);return z.FromValuesToRef(r,i,0,0,-i,r,0,0,0,0,1,0,0,0,0,1,t),t._updateIdentityStatus(r===1&&i===0),t}static RotationAxis(e,t){const i=new z;return z.RotationAxisToRef(e,t,i),i}static RotationAxisToRef(e,t,i){const r=Math.sin(-t),s=Math.cos(-t),a=1-s;e.normalize();const l=i._m;return l[0]=e._x*e._x*a+s,l[1]=e._x*e._y*a-e._z*r,l[2]=e._x*e._z*a+e._y*r,l[3]=0,l[4]=e._y*e._x*a+e._z*r,l[5]=e._y*e._y*a+s,l[6]=e._y*e._z*a-e._x*r,l[7]=0,l[8]=e._z*e._x*a-e._y*r,l[9]=e._z*e._y*a+e._x*r,l[10]=e._z*e._z*a+s,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,i.markAsUpdated(),i}static RotationAlignToRef(e,t,i,r=!1){const s=A.Dot(t,e),a=i._m;if(s<-1+ut)a[0]=-1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=r?1:-1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=r?-1:1,a[11]=0;else{const l=A.Cross(t,e),o=1/(1+s);a[0]=l._x*l._x*o+s,a[1]=l._y*l._x*o-l._z,a[2]=l._z*l._x*o+l._y,a[3]=0,a[4]=l._x*l._y*o+l._z,a[5]=l._y*l._y*o+s,a[6]=l._z*l._y*o-l._x,a[7]=0,a[8]=l._x*l._z*o-l._y,a[9]=l._y*l._z*o+l._x,a[10]=l._z*l._z*o+s,a[11]=0}return a[12]=0,a[13]=0,a[14]=0,a[15]=1,i.markAsUpdated(),i}static RotationYawPitchRoll(e,t,i){const r=new z;return z.RotationYawPitchRollToRef(e,t,i,r),r}static RotationYawPitchRollToRef(e,t,i,r){return ue.RotationYawPitchRollToRef(e,t,i,ve.Quaternion[0]),ve.Quaternion[0].toRotationMatrix(r),r}static Scaling(e,t,i){const r=new z;return z.ScalingToRef(e,t,i,r),r}static ScalingToRef(e,t,i,r){return z.FromValuesToRef(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1,r),r._updateIdentityStatus(e===1&&t===1&&i===1),r}static Translation(e,t,i){const r=new z;return z.TranslationToRef(e,t,i,r),r}static TranslationToRef(e,t,i,r){return z.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,e,t,i,1,r),r._updateIdentityStatus(e===0&&t===0&&i===0),r}static Lerp(e,t,i){const r=new e.constructor;return z.LerpToRef(e,t,i,r),r}static LerpToRef(e,t,i,r){const s=r._m,a=e.m,l=t.m;for(let o=0;o<16;o++)s[o]=a[o]*(1-i)+l[o]*i;return r.markAsUpdated(),r}static DecomposeLerp(e,t,i){const r=new e.constructor;return z.DecomposeLerpToRef(e,t,i,r),r}static DecomposeLerpToRef(e,t,i,r){const s=ve.Vector3[0],a=ve.Quaternion[0],l=ve.Vector3[1];e.decompose(s,a,l);const o=ve.Vector3[2],c=ve.Quaternion[1],u=ve.Vector3[3];t.decompose(o,c,u);const h=ve.Vector3[4];A.LerpToRef(s,o,i,h);const d=ve.Quaternion[2];ue.SlerpToRef(a,c,i,d);const f=ve.Vector3[5];return A.LerpToRef(l,u,i,f),z.ComposeToRef(h,d,f,r),r}static LookAtLH(e,t,i){const r=new z;return z.LookAtLHToRef(e,t,i,r),r}static LookAtLHToRef(e,t,i,r){const s=ve.Vector3[0],a=ve.Vector3[1],l=ve.Vector3[2];t.subtractToRef(e,l),l.normalize(),A.CrossToRef(i,l,s);const o=s.lengthSquared();o===0?s.x=1:s.normalizeFromLength(Math.sqrt(o)),A.CrossToRef(l,s,a),a.normalize();const c=-A.Dot(s,e),u=-A.Dot(a,e),h=-A.Dot(l,e);return z.FromValuesToRef(s._x,a._x,l._x,0,s._y,a._y,l._y,0,s._z,a._z,l._z,0,c,u,h,1,r),r}static LookAtRH(e,t,i){const r=new z;return z.LookAtRHToRef(e,t,i,r),r}static LookAtRHToRef(e,t,i,r){const s=ve.Vector3[0],a=ve.Vector3[1],l=ve.Vector3[2];e.subtractToRef(t,l),l.normalize(),A.CrossToRef(i,l,s);const o=s.lengthSquared();o===0?s.x=1:s.normalizeFromLength(Math.sqrt(o)),A.CrossToRef(l,s,a),a.normalize();const c=-A.Dot(s,e),u=-A.Dot(a,e),h=-A.Dot(l,e);return z.FromValuesToRef(s._x,a._x,l._x,0,s._y,a._y,l._y,0,s._z,a._z,l._z,0,c,u,h,1,r),r}static LookDirectionLH(e,t){const i=new z;return z.LookDirectionLHToRef(e,t,i),i}static LookDirectionLHToRef(e,t,i){const r=ve.Vector3[0];r.copyFrom(e),r.scaleInPlace(-1);const s=ve.Vector3[1];return A.CrossToRef(t,r,s),z.FromValuesToRef(s._x,s._y,s._z,0,t._x,t._y,t._z,0,r._x,r._y,r._z,0,0,0,0,1,i),i}static LookDirectionRH(e,t){const i=new z;return z.LookDirectionRHToRef(e,t,i),i}static LookDirectionRHToRef(e,t,i){const r=ve.Vector3[2];return A.CrossToRef(t,e,r),z.FromValuesToRef(r._x,r._y,r._z,0,t._x,t._y,t._z,0,e._x,e._y,e._z,0,0,0,0,1,i),i}static OrthoLH(e,t,i,r,s){const a=new z;return z.OrthoLHToRef(e,t,i,r,a,s),a}static OrthoLHToRef(e,t,i,r,s,a){const l=i,o=r,c=2/e,u=2/t,h=2/(o-l),d=-(o+l)/(o-l);return z.FromValuesToRef(c,0,0,0,0,u,0,0,0,0,h,0,0,0,d,1,s),a&&s.multiplyToRef(to,s),s._updateIdentityStatus(c===1&&u===1&&h===1&&d===0),s}static OrthoOffCenterLH(e,t,i,r,s,a,l){const o=new z;return z.OrthoOffCenterLHToRef(e,t,i,r,s,a,o,l),o}static OrthoOffCenterLHToRef(e,t,i,r,s,a,l,o){const c=s,u=a,h=2/(t-e),d=2/(r-i),f=2/(u-c),_=-(u+c)/(u-c),p=(e+t)/(e-t),v=(r+i)/(i-r);return z.FromValuesToRef(h,0,0,0,0,d,0,0,0,0,f,0,p,v,_,1,l),o&&l.multiplyToRef(to,l),l.markAsUpdated(),l}static ObliqueOffCenterLHToRef(e,t,i,r,s,a,l,o,c,u,h){const d=-l*Math.cos(o),f=-l*Math.sin(o);return z.TranslationToRef(0,0,-c,ve.Matrix[1]),z.FromValuesToRef(1,0,0,0,0,1,0,0,d,f,1,0,0,0,0,1,ve.Matrix[0]),ve.Matrix[1].multiplyToRef(ve.Matrix[0],ve.Matrix[0]),z.TranslationToRef(0,0,c,ve.Matrix[1]),ve.Matrix[0].multiplyToRef(ve.Matrix[1],ve.Matrix[0]),z.OrthoOffCenterLHToRef(e,t,i,r,s,a,u,h),ve.Matrix[0].multiplyToRef(u,u),u}static OrthoOffCenterRH(e,t,i,r,s,a,l){const o=new z;return z.OrthoOffCenterRHToRef(e,t,i,r,s,a,o,l),o}static OrthoOffCenterRHToRef(e,t,i,r,s,a,l,o){return z.OrthoOffCenterLHToRef(e,t,i,r,s,a,l,o),l._m[10]*=-1,l}static ObliqueOffCenterRHToRef(e,t,i,r,s,a,l,o,c,u,h){const d=l*Math.cos(o),f=l*Math.sin(o);return z.TranslationToRef(0,0,c,ve.Matrix[1]),z.FromValuesToRef(1,0,0,0,0,1,0,0,d,f,1,0,0,0,0,1,ve.Matrix[0]),ve.Matrix[1].multiplyToRef(ve.Matrix[0],ve.Matrix[0]),z.TranslationToRef(0,0,-c,ve.Matrix[1]),ve.Matrix[0].multiplyToRef(ve.Matrix[1],ve.Matrix[0]),z.OrthoOffCenterRHToRef(e,t,i,r,s,a,u,h),ve.Matrix[0].multiplyToRef(u,u),u}static PerspectiveLH(e,t,i,r,s,a=0){const l=new z,o=i,c=r,u=2*o/e,h=2*o/t,d=(c+o)/(c-o),f=-2*c*o/(c-o),_=Math.tan(a);return z.FromValuesToRef(u,0,0,0,0,h,0,_,0,0,d,1,0,0,f,0,l),s&&l.multiplyToRef(to,l),l._updateIdentityStatus(!1),l}static PerspectiveFovLH(e,t,i,r,s,a=0,l=!1){const o=new z;return z.PerspectiveFovLHToRef(e,t,i,r,o,!0,s,a,l),o}static PerspectiveFovLHToRef(e,t,i,r,s,a=!0,l,o=0,c=!1){const u=i,h=r,d=1/Math.tan(e*.5),f=a?d/t:d,_=a?d:d*t,p=c&&u===0?-1:h!==0?(h+u)/(h-u):1,v=c&&u===0?2*h:h!==0?-2*h*u/(h-u):-2*u,E=Math.tan(o);return z.FromValuesToRef(f,0,0,0,0,_,0,E,0,0,p,1,0,0,v,0,s),l&&s.multiplyToRef(to,s),s._updateIdentityStatus(!1),s}static PerspectiveFovReverseLHToRef(e,t,i,r,s,a=!0,l,o=0){const c=1/Math.tan(e*.5),u=a?c/t:c,h=a?c:c*t,d=Math.tan(o);return z.FromValuesToRef(u,0,0,0,0,h,0,d,0,0,-i,1,0,0,1,0,s),l&&s.multiplyToRef(to,s),s._updateIdentityStatus(!1),s}static PerspectiveFovRH(e,t,i,r,s,a=0,l=!1){const o=new z;return z.PerspectiveFovRHToRef(e,t,i,r,o,!0,s,a,l),o}static PerspectiveFovRHToRef(e,t,i,r,s,a=!0,l,o=0,c=!1){const u=i,h=r,d=1/Math.tan(e*.5),f=a?d/t:d,_=a?d:d*t,p=c&&u===0?1:h!==0?-(h+u)/(h-u):-1,v=c&&u===0?2*h:h!==0?-2*h*u/(h-u):-2*u,E=Math.tan(o);return z.FromValuesToRef(f,0,0,0,0,_,0,E,0,0,p,-1,0,0,v,0,s),l&&s.multiplyToRef(to,s),s._updateIdentityStatus(!1),s}static PerspectiveFovReverseRHToRef(e,t,i,r,s,a=!0,l,o=0){const c=1/Math.tan(e*.5),u=a?c/t:c,h=a?c:c*t,d=Math.tan(o);return z.FromValuesToRef(u,0,0,0,0,h,0,d,0,0,-i,-1,0,0,-1,0,s),l&&s.multiplyToRef(to,s),s._updateIdentityStatus(!1),s}static GetFinalMatrix(e,t,i,r,s,a){const l=e.width,o=e.height,c=e.x,u=e.y,h=z.FromValues(l/2,0,0,0,0,-o/2,0,0,0,0,a-s,0,c+l/2,o/2+u,s,1),d=new t.constructor;return t.multiplyToRef(i,d),d.multiplyToRef(r,d),d.multiplyToRef(h,d)}static GetAsMatrix2x2(e){const t=e.m,i=[t[0],t[1],t[4],t[5]];return Pi.MatrixUse64Bits?i:new Float32Array(i)}static GetAsMatrix3x3(e){const t=e.m,i=[t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]];return Pi.MatrixUse64Bits?i:new Float32Array(i)}static Transpose(e){const t=new e.constructor;return z.TransposeToRef(e,t),t}static TransposeToRef(e,t){const i=e.m,r=i[0],s=i[4],a=i[8],l=i[12],o=i[1],c=i[5],u=i[9],h=i[13],d=i[2],f=i[6],_=i[10],p=i[14],v=i[3],E=i[7],g=i[11],m=i[15],y=t._m;return y[0]=r,y[1]=s,y[2]=a,y[3]=l,y[4]=o,y[5]=c,y[6]=u,y[7]=h,y[8]=d,y[9]=f,y[10]=_,y[11]=p,y[12]=v,y[13]=E,y[14]=g,y[15]=m,t.markAsUpdated(),t._updateIdentityStatus(e._isIdentity,e._isIdentityDirty),t}static Reflection(e){const t=new z;return z.ReflectionToRef(e,t),t}static ReflectionToRef(e,t){e.normalize();const i=e.normal.x,r=e.normal.y,s=e.normal.z,a=-2*i,l=-2*r,o=-2*s;return z.FromValuesToRef(a*i+1,l*i,o*i,0,a*r,l*r+1,o*r,0,a*s,l*s,o*s+1,0,a*e.d,l*e.d,o*e.d,1,t),t}static FromXYZAxesToRef(e,t,i,r){return z.FromValuesToRef(e._x,e._y,e._z,0,t._x,t._y,t._z,0,i._x,i._y,i._z,0,0,0,0,1,r),r}static FromQuaternionToRef(e,t){const i=e._x*e._x,r=e._y*e._y,s=e._z*e._z,a=e._x*e._y,l=e._z*e._w,o=e._z*e._x,c=e._y*e._w,u=e._y*e._z,h=e._x*e._w;return t._m[0]=1-2*(r+s),t._m[1]=2*(a+l),t._m[2]=2*(o-c),t._m[3]=0,t._m[4]=2*(a-l),t._m[5]=1-2*(s+i),t._m[6]=2*(u+h),t._m[7]=0,t._m[8]=2*(o+c),t._m[9]=2*(u-h),t._m[10]=1-2*(r+i),t._m[11]=0,t._m[12]=0,t._m[13]=0,t._m[14]=0,t._m[15]=1,t.markAsUpdated(),t}}z._UpdateFlagSeed=0;z._IdentityReadOnly=z.Identity();Object.defineProperties(z.prototype,{dimension:{value:[4,4]},rank:{value:2}});class ve{}ve.Vector3=Zi.BuildTuple(11,A.Zero);ve.Matrix=Zi.BuildTuple(2,z.Identity);ve.Quaternion=Zi.BuildTuple(3,ue.Zero);class V{}V.Vector2=Zi.BuildTuple(3,xe.Zero);V.Vector3=Zi.BuildTuple(13,A.Zero);V.Vector4=Zi.BuildTuple(3,qe.Zero);V.Quaternion=Zi.BuildTuple(2,ue.Zero);V.Matrix=Zi.BuildTuple(8,z.Identity);Ji("BABYLON.Vector2",xe);Ji("BABYLON.Vector3",A);Ji("BABYLON.Vector4",qe);Ji("BABYLON.Matrix",z);const to=z.FromValues(1,0,0,0,0,1,0,0,0,0,.5,0,0,0,.5,1);function Ui(){return typeof window<"u"}function Lc(){return typeof navigator<"u"}function Vc(){return typeof document<"u"}function t1(n){let e="",t=n.firstChild;for(;t;)t.nodeType===3&&(e+=t.textContent),t=t.nextSibling;return e}class ee{static _CheckLimit(e,t){let i=ee._LogLimitOutputs[e];return i?i.current++:(i={limit:t,current:1},ee._LogLimitOutputs[e]=i),i.current<=i.limit}static _GenerateLimitMessage(e,t=1){const i=ee._LogLimitOutputs[e];if(!i||!ee.MessageLimitReached)return;const r=this._Levels[t];i.current===i.limit&&ee[r.name](ee.MessageLimitReached.replace(/%LIMIT%/g,""+i.limit).replace(/%TYPE%/g,r.name??""))}static _AddLogEntry(e){ee._LogCache=e+ee._LogCache,ee.OnNewCacheEntry&&ee.OnNewCacheEntry(e)}static _FormatMessage(e){const t=r=>r<10?"0"+r:""+r,i=new Date;return"["+t(i.getHours())+":"+t(i.getMinutes())+":"+t(i.getSeconds())+"]: "+e}static _LogDisabled(e,t){}static _LogEnabled(e=1,t,i){const r=Array.isArray(t)?t[0]:t;if(i!==void 0&&!ee._CheckLimit(r,i))return;const s=ee._FormatMessage(r),a=this._Levels[e],l=Array.isArray(t)?t.slice(1):[];a.logFunc&&a.logFunc("BJS - "+s,...l);const o=`<div style='color:${a.color}'>${s}</div><br>`;ee._AddLogEntry(o),ee._GenerateLimitMessage(r,e)}static get LogCache(){return ee._LogCache}static ClearLogCache(){ee._LogCache="",ee._LogLimitOutputs={},ee.errorsCount=0}static set LogLevels(e){ee.Log=ee._LogDisabled,ee.Warn=ee._LogDisabled,ee.Error=ee._LogDisabled,[ee.MessageLogLevel,ee.WarningLogLevel,ee.ErrorLogLevel].forEach(t=>{if((e&t)===t){const i=this._Levels[t];ee[i.name]=ee._LogEnabled.bind(ee,t)}})}}ee.NoneLogLevel=0;ee.MessageLogLevel=1;ee.WarningLogLevel=2;ee.ErrorLogLevel=4;ee.AllLogLevel=7;ee.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.";ee._LogCache="";ee._LogLimitOutputs={};ee._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}];ee.errorsCount=0;ee.Log=ee._LogEnabled.bind(ee,ee.MessageLogLevel);ee.Warn=ee._LogEnabled.bind(ee,ee.WarningLogLevel);ee.Error=ee._LogEnabled.bind(ee,ee.ErrorLogLevel);const H0=(n,e,t)=>!n||n.getClassName&&n.getClassName()==="Mesh"?null:n.getClassName&&(n.getClassName()==="SubMesh"||n.getClassName()==="PhysicsBody")?n.clone(e):n.clone?n.clone():Array.isArray(n)?n.slice():t&&typeof n=="object"?{...n}:null;function eN(n){const e=[];do Object.getOwnPropertyNames(n).forEach(function(t){e.indexOf(t)===-1&&e.push(t)});while(n=Object.getPrototypeOf(n));return e}class cm{static DeepCopy(e,t,i,r,s=!1){const a=eN(e);for(const l of a){if(l[0]==="_"&&(!r||r.indexOf(l)===-1)||l.endsWith("Observable")||i&&i.indexOf(l)!==-1)continue;const o=e[l],c=typeof o;if(c!=="function")try{if(c==="object")if(o instanceof Uint8Array)t[l]=Uint8Array.from(o);else if(o instanceof Array){if(t[l]=[],o.length>0)if(typeof o[0]=="object")for(let u=0;u<o.length;u++){const h=H0(o[u],t,s);t[l].indexOf(h)===-1&&t[l].push(h)}else t[l]=o.slice(0)}else t[l]=H0(o,t,s);else t[l]=o}catch(u){ee.Warn(u.message)}}}}class mn{static get Now(){return Ui()&&window.performance&&window.performance.now?window.performance.now():Date.now()}}const j0={};function ke(n,e=!1){if(!(e&&j0[n]))return j0[n]=!0,`${n} needs to be imported before as it contains a side-effect required by your code.`}function tN(){return typeof _native<"u"&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest}class wi{constructor(){this._xhr=tN(),this._requestURL=""}static get IsCustomRequestAvailable(){return Object.keys(wi.CustomRequestHeaders).length>0||wi.CustomRequestModifiers.length>0}_injectCustomRequestHeaders(){if(!this._shouldSkipRequestModifications(this._requestURL))for(const e in wi.CustomRequestHeaders){const t=wi.CustomRequestHeaders[e];t&&this._xhr.setRequestHeader(e,t)}}_shouldSkipRequestModifications(e){return wi.SkipRequestModificationForBabylonCDN&&(e.includes("preview.babylonjs.com")||e.includes("cdn.babylonjs.com"))}get onprogress(){return this._xhr.onprogress}set onprogress(e){this._xhr.onprogress=e}get readyState(){return this._xhr.readyState}get status(){return this._xhr.status}get statusText(){return this._xhr.statusText}get response(){return this._xhr.response}get responseURL(){return this._xhr.responseURL}get responseText(){return this._xhr.responseText}get responseType(){return this._xhr.responseType}set responseType(e){this._xhr.responseType=e}get timeout(){return this._xhr.timeout}set timeout(e){this._xhr.timeout=e}addEventListener(e,t,i){this._xhr.addEventListener(e,t,i)}removeEventListener(e,t,i){this._xhr.removeEventListener(e,t,i)}abort(){this._xhr.abort()}send(e){wi.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(e)}open(e,t){for(const i of wi.CustomRequestModifiers){if(this._shouldSkipRequestModifications(t))return;i(this._xhr,t)}t=t.replace("file:http:","http:"),t=t.replace("file:https:","https:"),this._requestURL=t,this._xhr.open(e,t,!0)}setRequestHeader(e,t){this._xhr.setRequestHeader(e,t)}getResponseHeader(e){return this._xhr.getResponseHeader(e)}}wi.CustomRequestHeaders={};wi.CustomRequestModifiers=new Array;wi.SkipRequestModificationForBabylonCDN=!0;class Gc{}Gc.FilesToLoad={};class iN{static ExponentialBackoff(e=3,t=500){return(i,r,s)=>r.status!==0||s>=e||i.indexOf("file:")!==-1?-1:Math.pow(2,s)*t}}class Bl extends Error{}Bl._setPrototypeOf=Object.setPrototypeOf||((n,e)=>(n.__proto__=e,n));const vo={MeshInvalidPositionsError:0,UnsupportedTextureError:1e3,GLTFLoaderUnexpectedMagicError:2e3,SceneLoaderError:3e3,LoadFileError:4e3,RequestFileError:4001,ReadFileError:4002};class ws extends Bl{constructor(e,t,i){super(e),this.errorCode=t,this.innerError=i,this.name="RuntimeError",Bl._setPrototypeOf(this,ws.prototype)}}const i1=n=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",i,r,s,a,l,o,c,u=0;const h=ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n);for(;u<h.length;)i=h[u++],r=u<h.length?h[u++]:Number.NaN,s=u<h.length?h[u++]:Number.NaN,a=i>>2,l=(i&3)<<4|r>>4,o=(r&15)<<2|s>>6,c=s&63,isNaN(r)?o=c=64:isNaN(s)&&(c=64),t+=e.charAt(a)+e.charAt(l)+e.charAt(o)+e.charAt(c);return t},r1=n=>atob(n),n1=n=>{const e=r1(n),t=e.length,i=new Uint8Array(new ArrayBuffer(t));for(let r=0;r<t;r++)i[r]=e.charCodeAt(r);return i.buffer},rN="attribute",nN="varying";class Wc{constructor(){this.children=[]}isValid(e){return!0}process(e,t){var r,s,a,l,o,c;let i="";if(this.line){let u=this.line;const h=t.processor;if(h){h.lineProcessor&&(u=h.lineProcessor(u,t.isFragment,t.processingContext));const d=((r=t.processor)==null?void 0:r.attributeKeywordName)??rN,f=t.isFragment&&((s=t.processor)!=null&&s.varyingFragmentKeywordName)?(a=t.processor)==null?void 0:a.varyingFragmentKeywordName:!t.isFragment&&((l=t.processor)!=null&&l.varyingVertexKeywordName)?(o=t.processor)==null?void 0:o.varyingVertexKeywordName:nN;!t.isFragment&&h.attributeProcessor&&this.line.startsWith(d)?u=h.attributeProcessor(this.line,e,t.processingContext):h.varyingProcessor&&((c=h.varyingCheck)!=null&&c.call(h,this.line,t.isFragment)||!h.varyingCheck&&this.line.startsWith(f))?u=h.varyingProcessor(this.line,t.isFragment,e,t.processingContext):h.uniformProcessor&&h.uniformRegexp&&h.uniformRegexp.test(this.line)?t.lookForClosingBracketForUniformBuffer||(u=h.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):h.uniformBufferProcessor&&h.uniformBufferRegexp&&h.uniformBufferRegexp.test(this.line)?t.lookForClosingBracketForUniformBuffer||(u=h.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0):h.textureProcessor&&h.textureRegexp&&h.textureRegexp.test(this.line)?u=h.textureProcessor(this.line,t.isFragment,e,t.processingContext):(h.uniformProcessor||h.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!t.lookForClosingBracketForUniformBuffer&&(/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?h.uniformProcessor&&(u=h.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):h.uniformBufferProcessor&&(u=h.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0)),t.lookForClosingBracketForUniformBuffer&&this.line.indexOf("}")!==-1&&(t.lookForClosingBracketForUniformBuffer=!1,h.endOfUniformBufferProcessor&&(u=h.endOfUniformBufferProcessor(this.line,t.isFragment,t.processingContext)))}i+=u+`
`}return this.children.forEach(u=>{i+=u.process(e,t)}),this.additionalDefineKey&&(e[this.additionalDefineKey]=this.additionalDefineValue||"true"),i}}class sN{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(e){this._lines.length=0;for(const t of e){if(!t||t==="\r")continue;if(t[0]==="#"){this._lines.push(t);continue}const i=t.trim();if(!i)continue;if(i.startsWith("//")){this._lines.push(t);continue}const r=i.indexOf(";");if(r===-1)this._lines.push(i);else if(r===i.length-1)i.length>1&&this._lines.push(i);else{const s=t.split(";");for(let a=0;a<s.length;a++){let l=s[a];l&&(l=l.trim(),l&&this._lines.push(l+(a!==s.length-1?";":"")))}}}}}class x_ extends Wc{process(e,t){for(let i=0;i<this.children.length;i++){const r=this.children[i];if(r.isValid(e))return r.process(e,t)}return""}}class aN extends Wc{isValid(e){return this.testExpression.isTrue(e)}}class Jt{isTrue(e){return!0}static postfixToInfix(e){const t=[];for(const i of e)if(Jt._OperatorPriority[i]===void 0)t.push(i);else{const r=t[t.length-1],s=t[t.length-2];t.length-=2,t.push(`(${s}${i}${r})`)}return t[t.length-1]}static infixToPostfix(e){const t=Jt._InfixToPostfixCache.get(e);if(t)return t.accessTime=Date.now(),t.result;if(!e.includes("&&")&&!e.includes("||")&&!e.includes(")")&&!e.includes("("))return[e];const i=[];let r=-1;const s=()=>{u=u.trim(),u!==""&&(i.push(u),u="")},a=h=>{r<Jt._Stack.length-1&&(Jt._Stack[++r]=h)},l=()=>Jt._Stack[r],o=()=>r===-1?"!!INVALID EXPRESSION!!":Jt._Stack[r--];let c=0,u="";for(;c<e.length;){const h=e.charAt(c),d=c<e.length-1?e.substr(c,2):"";if(h==="(")u="",a(h);else if(h===")"){for(s();r!==-1&&l()!=="(";)i.push(o());o()}else if(Jt._OperatorPriority[d]>1){for(s();r!==-1&&Jt._OperatorPriority[l()]>=Jt._OperatorPriority[d];)i.push(o());a(d),c++}else u+=h;c++}for(s();r!==-1;)l()==="("?o():i.push(o());return Jt._InfixToPostfixCache.size>=Jt.InfixToPostfixCacheLimitSize&&Jt.ClearCache(),Jt._InfixToPostfixCache.set(e,{result:i,accessTime:Date.now()}),i}static ClearCache(){const e=Array.from(Jt._InfixToPostfixCache.entries()).sort((t,i)=>t[1].accessTime-i[1].accessTime);for(let t=0;t<Jt.InfixToPostfixCacheCleanupSize;t++)Jt._InfixToPostfixCache.delete(e[t][0])}}Jt.InfixToPostfixCacheLimitSize=5e4;Jt.InfixToPostfixCacheCleanupSize=25e3;Jt._InfixToPostfixCache=new Map;Jt._OperatorPriority={")":0,"(":1,"||":2,"&&":3};Jt._Stack=["","","","","","","","","","","","","","","","","","","",""];class sh extends Jt{constructor(e,t=!1){super(),this.define=e,this.not=t}isTrue(e){let t=e[this.define]!==void 0;return this.not&&(t=!t),t}}class oN extends Jt{isTrue(e){return this.leftOperand.isTrue(e)||this.rightOperand.isTrue(e)}}class lN extends Jt{isTrue(e){return this.leftOperand.isTrue(e)&&this.rightOperand.isTrue(e)}}class cN extends Jt{constructor(e,t,i){super(),this.define=e,this.operand=t,this.testValue=i}isTrue(e){let t=e[this.define];t===void 0&&(t=this.define);let i=!1;const r=parseInt(t),s=parseInt(this.testValue);switch(this.operand){case">":i=r>s;break;case"<":i=r<s;break;case"<=":i=r<=s;break;case">=":i=r>=s;break;case"==":i=r===s;break;case"!=":i=r!==s;break}return i}}var Oi;(function(n){n[n.GLSL=0]="GLSL",n[n.WGSL=1]="WGSL"})(Oi||(Oi={}));const uN=/defined\s*?\((.+?)\)/g,M_=/defined\s*?\[(.+?)\]/g,hN=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,dN=/__decl__/,X0=/light\{X\}.(\w*)/g,Y0=/\{X\}/g,ah=[];class is{static Initialize(e){e.processor&&e.processor.initializeShaders&&e.processor.initializeShaders(e.processingContext)}static Process(e,t,i,r){var s;(s=t.processor)!=null&&s.preProcessShaderCode&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),this._ProcessIncludes(e,t,a=>{t.processCodeAfterIncludes&&(a=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",a));const l=this._ProcessShaderConversion(a,t,r);i(l,a)})}static PreProcess(e,t,i,r){var s;(s=t.processor)!=null&&s.preProcessShaderCode&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),this._ProcessIncludes(e,t,a=>{t.processCodeAfterIncludes&&(a=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",a));const l=this._ApplyPreProcessing(a,t,r);i(l,a)})}static Finalize(e,t,i){return!i.processor||!i.processor.finalizeShaders?{vertexCode:e,fragmentCode:t}:i.processor.finalizeShaders(e,t,i.processingContext)}static _ProcessPrecision(e,t){var r;if((r=t.processor)!=null&&r.noPrecision)return e;const i=t.shouldUseHighPrecisionShader;return e.indexOf("precision highp float")===-1?i?e=`precision highp float;
`+e:e=`precision mediump float;
`+e:i||(e=e.replace("precision highp float","precision mediump float")),e}static _ExtractOperation(e){const i=/defined\((.+)\)/.exec(e);if(i&&i.length)return new sh(i[1].trim(),e[0]==="!");const r=["==","!=",">=","<=","<",">"];let s="",a=0;for(s of r)if(a=e.indexOf(s),a>-1)break;if(a===-1)return new sh(e);const l=e.substring(0,a).trim(),o=e.substring(a+s.length).trim();return new cN(l,s,o)}static _BuildSubExpression(e){e=e.replace(uN,"defined[$1]");const t=Jt.infixToPostfix(e),i=[];for(const s of t)if(s!=="||"&&s!=="&&")i.push(s);else if(i.length>=2){let a=i[i.length-1],l=i[i.length-2];i.length-=2;const o=s=="&&"?new lN:new oN;typeof a=="string"&&(a=a.replace(M_,"defined($1)")),typeof l=="string"&&(l=l.replace(M_,"defined($1)")),o.leftOperand=typeof l=="string"?this._ExtractOperation(l):l,o.rightOperand=typeof a=="string"?this._ExtractOperation(a):a,i.push(o)}let r=i[i.length-1];return typeof r=="string"&&(r=r.replace(M_,"defined($1)")),typeof r=="string"?this._ExtractOperation(r):r}static _BuildExpression(e,t){const i=new aN,r=e.substring(0,t);let s=e.substring(t);return s=s.substring(0,(s.indexOf("//")+1||s.length+1)-1).trim(),r==="#ifdef"?i.testExpression=new sh(s):r==="#ifndef"?i.testExpression=new sh(s,!0):i.testExpression=this._BuildSubExpression(s),i}static _MoveCursorWithinIf(e,t,i){let r=e.currentLine;for(;this._MoveCursor(e,i);){r=e.currentLine;const s=r.substring(0,5).toLowerCase();if(s==="#else"){const a=new Wc;t.children.push(a),this._MoveCursor(e,a);return}else if(s==="#elif"){const a=this._BuildExpression(r,5);t.children.push(a),i=a}}}static _MoveCursor(e,t){for(;e.canRead;){e.lineIndex++;const i=e.currentLine;if(i.indexOf("#")>=0){const s=is._MoveCursorRegex.exec(i);if(s&&s.length){switch(s[0]){case"#ifdef":{const l=new x_;t.children.push(l);const o=this._BuildExpression(i,6);l.children.push(o),this._MoveCursorWithinIf(e,l,o);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const l=new x_;t.children.push(l);const o=this._BuildExpression(i,7);l.children.push(o),this._MoveCursorWithinIf(e,l,o);break}case"#if":{const l=new x_,o=this._BuildExpression(i,3);t.children.push(l),l.children.push(o),this._MoveCursorWithinIf(e,l,o);break}}continue}}const r=new Wc;if(r.line=i,t.children.push(r),i[0]==="#"&&i[1]==="d"){const s=i.replace(";","").split(" ");r.additionalDefineKey=s[1],s.length===3&&(r.additionalDefineValue=s[2])}}return!1}static _EvaluatePreProcessors(e,t,i){const r=new Wc,s=new sN;return s.lineIndex=-1,s.lines=e.split(`
`),this._MoveCursor(s,r),r.process(t,i)}static _PreparePreProcessors(e,t){var s;const i=e.defines,r={};for(const a of i){const o=a.replace("#define","").replace(";","").trim().split(" ");r[o[0]]=o.length>1?o[1]:""}return((s=e.processor)==null?void 0:s.shaderLanguage)===Oi.GLSL&&(r.GL_ES="true"),r.__VERSION__=e.version,r[e.platformName]="true",t._getGlobalDefines(r),r}static _ProcessShaderConversion(e,t,i){let r=this._ProcessPrecision(e,t);if(!t.processor||t.processor.shaderLanguage===Oi.GLSL&&r.indexOf("#version 3")!==-1&&(r=r.replace("#version 300 es",""),!t.processor.parseGLES3))return r;const s=t.defines,a=this._PreparePreProcessors(t,i);return t.processor.preProcessor&&(r=t.processor.preProcessor(r,s,t.isFragment,t.processingContext)),r=this._EvaluatePreProcessors(r,a,t),t.processor.postProcessor&&(r=t.processor.postProcessor(r,s,t.isFragment,t.processingContext,i)),i._features.needShaderCodeInlining&&(r=i.inlineShaderCode(r)),r}static _ApplyPreProcessing(e,t,i){var l,o;let r=e;const s=t.defines,a=this._PreparePreProcessors(t,i);return(l=t.processor)!=null&&l.preProcessor&&(r=t.processor.preProcessor(r,s,t.isFragment,t.processingContext)),r=this._EvaluatePreProcessors(r,a,t),(o=t.processor)!=null&&o.postProcessor&&(r=t.processor.postProcessor(r,s,t.isFragment,t.processingContext,i)),i._features.needShaderCodeInlining&&(r=i.inlineShaderCode(r)),r}static _ProcessIncludes(e,t,i){ah.length=0;let r;for(;(r=hN.exec(e))!==null;)ah.push(r);let s=String(e),a=[e],l=!1;for(const o of ah){let c=o[1];if(c.indexOf("__decl__")!==-1&&(c=c.replace(dN,""),t.supportsUniformBuffers&&(c=c.replace("Vertex","Ubo").replace("Fragment","Ubo")),c=c+"Declaration"),t.includesShadersStore[c]){let u=t.includesShadersStore[c];if(o[2]){const d=o[3].split(",");for(let f=0;f<d.length;f+=2){const _=new RegExp(d[f],"g"),p=d[f+1];u=u.replace(_,p)}}if(o[4]){const d=o[5];if(d.indexOf("..")!==-1){const f=d.split(".."),_=parseInt(f[0]);let p=parseInt(f[1]),v=u.slice(0);u="",isNaN(p)&&(p=t.indexParameters[f[1]]);for(let E=_;E<p;E++)t.supportsUniformBuffers||(v=v.replace(X0,(g,m)=>m+"{X}")),u+=v.replace(Y0,E.toString())+`
`}else t.supportsUniformBuffers||(u=u.replace(X0,(f,_)=>_+"{X}")),u=u.replace(Y0,d)}const h=[];for(const d of a){const f=d.split(o[0]);for(let _=0;_<f.length-1;_++)h.push(f[_]),h.push(u);h.push(f[f.length-1])}a=h,l=l||u.indexOf("#include<")>=0||u.indexOf("#include <")>=0}else{const u=t.shadersRepository+"ShadersInclude/"+c+".fx";is._FileToolsLoadFile(u,h=>{t.includesShadersStore[c]=h,this._ProcessIncludes(a.join(""),t,i)});return}}ah.length=0,s=a.join(""),l?this._ProcessIncludes(s.toString(),t,i):i(s)}static _FileToolsLoadFile(e,t,i,r,s,a){throw ke("FileTools")}}is._MoveCursorRegex=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;class ne{static GetShadersRepository(e=Oi.GLSL){return e===Oi.GLSL?ne.ShadersRepository:ne.ShadersRepositoryWGSL}static GetShadersStore(e=Oi.GLSL){return e===Oi.GLSL?ne.ShadersStore:ne.ShadersStoreWGSL}static GetIncludesShadersStore(e=Oi.GLSL){return e===Oi.GLSL?ne.IncludesShadersStore:ne.IncludesShadersStoreWGSL}}ne.ShadersRepository="src/Shaders/";ne.ShadersStore={};ne.IncludesShadersStore={};ne.ShadersRepositoryWGSL="src/ShadersWGSL/";ne.ShadersStoreWGSL={};ne.IncludesShadersStoreWGSL={};class _r{static get ShadersRepository(){return ne.ShadersRepository}static set ShadersRepository(e){ne.ShadersRepository=e}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new Y),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(e,t,i,r=null,s,a=null,l=null,o=null,c=null,u,h="",d=Oi.GLSL){if(this.name=null,this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new Y,this.onErrorObservable=new Y,this._onBindObservable=null,this._isDisposed=!1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=e,this._key=h,t.attributes){const f=t;if(this._engine=i,this._attributesNames=f.attributes,this._uniformsNames=f.uniformsNames.concat(f.samplers),this._samplerList=f.samplers.slice(),this.defines=f.defines,this.onError=f.onError,this.onCompiled=f.onCompiled,this._fallbacks=f.fallbacks,this._indexParameters=f.indexParameters,this._transformFeedbackVaryings=f.transformFeedbackVaryings||null,this._multiTarget=!!f.multiTarget,this._shaderLanguage=f.shaderLanguage??Oi.GLSL,f.uniformBuffersNames){this._uniformBuffersNamesList=f.uniformBuffersNames.slice();for(let _=0;_<f.uniformBuffersNames.length;_++)this._uniformBuffersNames[f.uniformBuffersNames[_]]=_}this._processFinalCode=f.processFinalCode??null,this._processCodeAfterIncludes=f.processCodeAfterIncludes??void 0}else this._engine=s,this.defines=a??"",this._uniformsNames=i.concat(r),this._samplerList=r?r.slice():[],this._attributesNames=t,this._uniformBuffersNamesList=[],this._shaderLanguage=d,this.onError=c,this.onCompiled=o,this._indexParameters=u,this._fallbacks=l;this._attributeLocationByName={},this.uniqueId=_r._UniqueIdSeed++,this._processShaderCode()}_processShaderCode(e=null,t=!1){let i,r;const s=this.name,a=Ui()?this._engine.getHostDocument():null;s.vertexSource?i="source:"+s.vertexSource:s.vertexElement?(i=a?a.getElementById(s.vertexElement):null,i||(i=s.vertexElement)):i=s.vertex||s,s.fragmentSource?r="source:"+s.fragmentSource:s.fragmentElement?(r=a?a.getElementById(s.fragmentElement):null,r||(r=s.fragmentElement)):r=s.fragment||s,this._processingContext=this._engine._getShaderProcessingContext(this._shaderLanguage);let l={defines:this.defines.split(`
`),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:e??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:ne.GetShadersRepository(this._shaderLanguage),includesShadersStore:ne.GetIncludesShadersStore(this._shaderLanguage),version:(this._engine.version*100).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};const o=[void 0,void 0],c=()=>{if(o[0]&&o[1]){l.isFragment=!0;const[u,h]=o;is.Process(h,l,(d,f)=>{this._fragmentSourceCodeBeforeMigration=f,this._processFinalCode&&(d=this._processFinalCode("fragment",d));const _=is.Finalize(u,d,l);l=null,this._useFinalCode(_.vertexCode,_.fragmentCode,s,t)},this._engine)}};this._loadShader(i,"Vertex","",u=>{is.Initialize(l),is.Process(u,l,(h,d)=>{this._rawVertexSourceCode=u,this._vertexSourceCodeBeforeMigration=d,this._processFinalCode&&(h=this._processFinalCode("vertex",h)),o[0]=h,c()},this._engine)}),this._loadShader(r,"Fragment","Pixel",u=>{this._rawFragmentSourceCode=u,o[1]=u,c()})}_useFinalCode(e,t,i,r=!1){if(i){const s=i.vertexElement||i.vertex||i.spectorName||i,a=i.fragmentElement||i.fragment||i.spectorName||i;this._vertexSourceCode=(this._shaderLanguage===Oi.WGSL?"//":"")+"#define SHADER_NAME vertex:"+s+`
`+e,this._fragmentSourceCode=(this._shaderLanguage===Oi.WGSL?"//":"")+"#define SHADER_NAME fragment:"+a+`
`+t}else this._vertexSourceCode=e,this._fragmentSourceCode=t;this._prepareEffect(r)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return this._isReady?!0:this._pipelineContext?this._pipelineContext.isReady:!1}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(e){return this._attributes[e]}getAttributeLocationByName(e){return this._attributeLocationByName[e]}getAttributesCount(){return this._attributes.length}getUniformIndex(e){return this._uniformsNames.indexOf(e)}getUniform(e){return this._uniforms[e]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}executeWhenCompiled(e){if(this.isReady()){e(this);return}this.onCompileObservable.add(t=>{e(t)}),(!this._pipelineContext||this._pipelineContext.isAsync)&&setTimeout(()=>{this._checkIsReady(null)},16)}_checkIsReady(e){try{if(this._isReadyInternal())return}catch(t){this._processCompilationErrors(t,e);return}this._isDisposed||setTimeout(()=>{this._checkIsReady(e)},16)}_loadShader(e,t,i,r){if(typeof HTMLElement<"u"&&e instanceof HTMLElement){const l=t1(e);r(l);return}if(e.substr(0,7)==="source:"){r(e.substr(7));return}if(e.substr(0,7)==="base64:"){const l=window.atob(e.substr(7));r(l);return}const s=ne.GetShadersStore(this._shaderLanguage);if(s[e+t+"Shader"]){r(s[e+t+"Shader"]);return}if(i&&s[e+i+"Shader"]){r(s[e+i+"Shader"]);return}let a;e[0]==="."||e[0]==="/"||e.indexOf("http")>-1?a=e:a=ne.GetShadersRepository(this._shaderLanguage)+e,this._engine._loadFile(a+"."+t.toLowerCase()+".fx",r)}get vertexSourceCode(){var e;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:((e=this._pipelineContext)==null?void 0:e._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var e;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:((e=this._pipelineContext)==null?void 0:e._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}_rebuildProgram(e,t,i,r){this._isReady=!1,this._vertexSourceCodeOverride=e,this._fragmentSourceCodeOverride=t,this.onError=(s,a)=>{r&&r(a)},this.onCompiled=()=>{var a,l;const s=this.getEngine().scenes;if(s)for(let o=0;o<s.length;o++)s[o].markAllMaterialsAsDirty(63);(l=(a=this._pipelineContext)._handlesSpectorRebuildCallback)==null||l.call(a,i)},this._fallbacks=null,this._prepareEffect()}_prepareEffect(e=!1){const t=this._attributesNames,i=this.defines,r=this._pipelineContext;this._isReady=!1;try{const s=this._engine;this._pipelineContext=(e?r:void 0)??s.createPipelineContext(this._processingContext),this._pipelineContext._name=this._key.replace(/\r/g,"").replace(/\n/g,"|");const a=(l,o,c,u)=>this._rebuildProgram(l,o,c,u);this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?s._preparePipelineContext(this._pipelineContext,this._vertexSourceCodeOverride,this._fragmentSourceCodeOverride,!0,this._rawVertexSourceCode,this._rawFragmentSourceCode,a,null,this._transformFeedbackVaryings,this._key):s._preparePipelineContext(this._pipelineContext,this._vertexSourceCode,this._fragmentSourceCode,!1,this._rawVertexSourceCode,this._rawFragmentSourceCode,a,i,this._transformFeedbackVaryings,this._key),s._executeWhenRenderingStateIsCompiled(this._pipelineContext,()=>{if(this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,t,this._attributes),t)for(let l=0;l<t.length;l++){const o=t[l];this._attributeLocationByName[o]=this._attributes[l]}s.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),r&&!e&&this.getEngine()._deletePipelineContext(r)}),this._pipelineContext.isAsync&&this._checkIsReady(r)}catch(s){this._processCompilationErrors(s,r)}}_getShaderCodeAndErrorLine(e,t,i){const r=i?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let s=null;if(t&&e){const a=t.match(r);if(a&&a.length===2){const l=parseInt(a[1]),o=e.split(`
`,-1);o.length>=l&&(s=`Offending line [${l}] in ${i?"fragment":"vertex"} code: ${o[l-1]}`)}}return[e,s]}_processCompilationErrors(e,t=null){var a,l,o;this._compilationError=e.message;const i=this._attributesNames,r=this._fallbacks;if(ee.Error("Unable to compile effect:"),ee.Error("Uniforms: "+this._uniformsNames.map(function(c){return" "+c})),ee.Error("Attributes: "+i.map(function(c){return" "+c})),ee.Error(`Defines:
`+this.defines),_r.LogShaderCodeOnCompilationError){let c=null,u=null,h=null;(a=this._pipelineContext)!=null&&a._getVertexShaderCode()&&([h,c]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),h&&(ee.Error("Vertex code:"),ee.Error(h))),(l=this._pipelineContext)!=null&&l._getFragmentShaderCode()&&([h,u]=this._getShaderCodeAndErrorLine((o=this._pipelineContext)==null?void 0:o._getFragmentShaderCode(),this._compilationError,!0),h&&(ee.Error("Fragment code:"),ee.Error(h))),c&&ee.Error(c),u&&ee.Error(u)}ee.Error("Error: "+this._compilationError);const s=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this)};t&&(this._pipelineContext=t,this._isReady=!0,s()),r?(this._pipelineContext=null,r.hasMoreFallbacks?(this._allFallbacksProcessed=!1,ee.Error("Trying next fallback."),this.defines=r.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,s(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,t||s())}get isSupported(){return this._compilationError===""}_bindTexture(e,t){this._engine._bindTexture(this._samplers[e],t,e)}setTexture(e,t){this._engine.setTexture(this._samplers[e],this._uniforms[e],t,e)}setDepthStencilTexture(e,t){this._engine.setDepthStencilTexture(this._samplers[e],this._uniforms[e],t,e)}setTextureArray(e,t){const i=e+"Ex";if(this._samplerList.indexOf(i+"0")===-1){const r=this._samplerList.indexOf(e);for(let a=1;a<t.length;a++){const l=i+(a-1).toString();this._samplerList.splice(r+a,0,l)}let s=0;for(const a of this._samplerList)this._samplers[a]=s,s+=1}this._engine.setTextureArray(this._samplers[e],this._uniforms[e],t,e)}setTextureFromPostProcess(e,t){this._engine.setTextureFromPostProcess(this._samplers[e],t,e)}setTextureFromPostProcessOutput(e,t){this._engine.setTextureFromPostProcessOutput(this._samplers[e],t,e)}bindUniformBuffer(e,t){const i=this._uniformBuffersNames[t];i===void 0||_r._BaseCache[i]===e&&this._engine._features.useUBOBindingCache||(_r._BaseCache[i]=e,this._engine.bindUniformBufferBase(e,i,t))}bindUniformBlock(e,t){this._engine.bindUniformBlock(this._pipelineContext,e,t)}setInt(e,t){return this._pipelineContext.setInt(e,t),this}setInt2(e,t,i){return this._pipelineContext.setInt2(e,t,i),this}setInt3(e,t,i,r){return this._pipelineContext.setInt3(e,t,i,r),this}setInt4(e,t,i,r,s){return this._pipelineContext.setInt4(e,t,i,r,s),this}setIntArray(e,t){return this._pipelineContext.setIntArray(e,t),this}setIntArray2(e,t){return this._pipelineContext.setIntArray2(e,t),this}setIntArray3(e,t){return this._pipelineContext.setIntArray3(e,t),this}setIntArray4(e,t){return this._pipelineContext.setIntArray4(e,t),this}setUInt(e,t){return this._pipelineContext.setUInt(e,t),this}setUInt2(e,t,i){return this._pipelineContext.setUInt2(e,t,i),this}setUInt3(e,t,i,r){return this._pipelineContext.setUInt3(e,t,i,r),this}setUInt4(e,t,i,r,s){return this._pipelineContext.setUInt4(e,t,i,r,s),this}setUIntArray(e,t){return this._pipelineContext.setUIntArray(e,t),this}setUIntArray2(e,t){return this._pipelineContext.setUIntArray2(e,t),this}setUIntArray3(e,t){return this._pipelineContext.setUIntArray3(e,t),this}setUIntArray4(e,t){return this._pipelineContext.setUIntArray4(e,t),this}setFloatArray(e,t){return this._pipelineContext.setArray(e,t),this}setFloatArray2(e,t){return this._pipelineContext.setArray2(e,t),this}setFloatArray3(e,t){return this._pipelineContext.setArray3(e,t),this}setFloatArray4(e,t){return this._pipelineContext.setArray4(e,t),this}setArray(e,t){return this._pipelineContext.setArray(e,t),this}setArray2(e,t){return this._pipelineContext.setArray2(e,t),this}setArray3(e,t){return this._pipelineContext.setArray3(e,t),this}setArray4(e,t){return this._pipelineContext.setArray4(e,t),this}setMatrices(e,t){return this._pipelineContext.setMatrices(e,t),this}setMatrix(e,t){return this._pipelineContext.setMatrix(e,t),this}setMatrix3x3(e,t){return this._pipelineContext.setMatrix3x3(e,t),this}setMatrix2x2(e,t){return this._pipelineContext.setMatrix2x2(e,t),this}setFloat(e,t){return this._pipelineContext.setFloat(e,t),this}setBool(e,t){return this._pipelineContext.setInt(e,t?1:0),this}setVector2(e,t){return this._pipelineContext.setVector2(e,t),this}setFloat2(e,t,i){return this._pipelineContext.setFloat2(e,t,i),this}setVector3(e,t){return this._pipelineContext.setVector3(e,t),this}setFloat3(e,t,i,r){return this._pipelineContext.setFloat3(e,t,i,r),this}setVector4(e,t){return this._pipelineContext.setVector4(e,t),this}setQuaternion(e,t){return this._pipelineContext.setQuaternion(e,t),this}setFloat4(e,t,i,r,s){return this._pipelineContext.setFloat4(e,t,i,r,s),this}setColor3(e,t){return this._pipelineContext.setColor3(e,t),this}setColor4(e,t,i){return this._pipelineContext.setColor4(e,t,i),this}setDirectColor4(e,t){return this._pipelineContext.setDirectColor4(e,t),this}dispose(){this._pipelineContext&&this._pipelineContext.dispose(),this._engine._releaseEffect(this),this._isDisposed=!0}static RegisterShader(e,t,i,r=Oi.GLSL){t&&(ne.GetShadersStore(r)[`${e}PixelShader`]=t),i&&(ne.GetShadersStore(r)[`${e}VertexShader`]=i)}static ResetCache(){_r._BaseCache={}}}_r.LogShaderCodeOnCompilationError=!0;_r._UniqueIdSeed=0;_r._BaseCache={};_r.ShadersStore=ne.ShadersStore;_r.IncludesShadersStore=ne.IncludesShadersStore;class fN{constructor(e=!0){this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,e&&this.reset()}get isDirty(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty}get zOffset(){return this._zOffset}set zOffset(e){this._zOffset!==e&&(this._zOffset=e,this._isZOffsetDirty=!0)}get zOffsetUnits(){return this._zOffsetUnits}set zOffsetUnits(e){this._zOffsetUnits!==e&&(this._zOffsetUnits=e,this._isZOffsetDirty=!0)}get cullFace(){return this._cullFace}set cullFace(e){this._cullFace!==e&&(this._cullFace=e,this._isCullFaceDirty=!0)}get cull(){return this._cull}set cull(e){this._cull!==e&&(this._cull=e,this._isCullDirty=!0)}get depthFunc(){return this._depthFunc}set depthFunc(e){this._depthFunc!==e&&(this._depthFunc=e,this._isDepthFuncDirty=!0)}get depthMask(){return this._depthMask}set depthMask(e){this._depthMask!==e&&(this._depthMask=e,this._isDepthMaskDirty=!0)}get depthTest(){return this._depthTest}set depthTest(e){this._depthTest!==e&&(this._depthTest=e,this._isDepthTestDirty=!0)}get frontFace(){return this._frontFace}set frontFace(e){this._frontFace!==e&&(this._frontFace=e,this._isFrontFaceDirty=!0)}reset(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1}apply(e){this.isDirty&&(this._isCullDirty&&(this.cull?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(e.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(e.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(e.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(e.enable(e.POLYGON_OFFSET_FILL),e.polygonOffset(this.zOffset,this.zOffsetUnits)):e.disable(e.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(e.frontFace(this.frontFace),this._isFrontFaceDirty=!1))}}class xs{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=xs.ALWAYS,this.funcRef=1,this.funcMask=255,this.opStencilFail=xs.KEEP,this.opDepthFail=xs.KEEP,this.opStencilDepthPass=xs.REPLACE}get stencilFunc(){return this.func}set stencilFunc(e){this.func=e}get stencilFuncRef(){return this.funcRef}set stencilFuncRef(e){this.funcRef=e}get stencilFuncMask(){return this.funcMask}set stencilFuncMask(e){this.funcMask=e}get stencilOpStencilFail(){return this.opStencilFail}set stencilOpStencilFail(e){this.opStencilFail=e}get stencilOpDepthFail(){return this.opDepthFail}set stencilOpDepthFail(e){this.opDepthFail=e}get stencilOpStencilDepthPass(){return this.opStencilDepthPass}set stencilOpStencilDepthPass(e){this.opStencilDepthPass=e}get stencilMask(){return this.mask}set stencilMask(e){this.mask=e}get stencilTest(){return this.enabled}set stencilTest(e){this.enabled=e}}xs.ALWAYS=519;xs.KEEP=7680;xs.REPLACE=7681;class _N{constructor(){this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this.reset()}get isDirty(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty}get alphaBlend(){return this._alphaBlend}set alphaBlend(e){this._alphaBlend!==e&&(this._alphaBlend=e,this._isAlphaBlendDirty=!0)}setAlphaBlendConstants(e,t,i,r){this._blendConstants[0]===e&&this._blendConstants[1]===t&&this._blendConstants[2]===i&&this._blendConstants[3]===r||(this._blendConstants[0]=e,this._blendConstants[1]=t,this._blendConstants[2]=i,this._blendConstants[3]=r,this._isBlendConstantsDirty=!0)}setAlphaBlendFunctionParameters(e,t,i,r){this._blendFunctionParameters[0]===e&&this._blendFunctionParameters[1]===t&&this._blendFunctionParameters[2]===i&&this._blendFunctionParameters[3]===r||(this._blendFunctionParameters[0]=e,this._blendFunctionParameters[1]=t,this._blendFunctionParameters[2]=i,this._blendFunctionParameters[3]=r,this._isBlendFunctionParametersDirty=!0)}setAlphaEquationParameters(e,t){this._blendEquationParameters[0]===e&&this._blendEquationParameters[1]===t||(this._blendEquationParameters[0]=e,this._blendEquationParameters[1]=t,this._isBlendEquationParametersDirty=!0)}reset(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1}apply(e){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?e.enable(e.BLEND):e.disable(e.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(e.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(e.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(e.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))}}class pN{get wrapU(){return this._cachedWrapU}set wrapU(e){this._cachedWrapU=e}get wrapV(){return this._cachedWrapV}set wrapV(e){this._cachedWrapV=e}get wrapR(){return this._cachedWrapR}set wrapR(e){this._cachedWrapR=e}get anisotropicFilteringLevel(){return this._cachedAnisotropicFilteringLevel}set anisotropicFilteringLevel(e){this._cachedAnisotropicFilteringLevel=e}get comparisonFunction(){return this._comparisonFunction}set comparisonFunction(e){this._comparisonFunction=e}get useMipMaps(){return this._useMipMaps}set useMipMaps(e){this._useMipMaps=e}constructor(){this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}setParameters(e=1,t=1,i=1,r=1,s=2,a=0){return this._cachedWrapU=e,this._cachedWrapV=t,this._cachedWrapR=i,this._cachedAnisotropicFilteringLevel=r,this.samplingMode=s,this._comparisonFunction=a,this}compareSampler(e){return this._cachedWrapU===e._cachedWrapU&&this._cachedWrapV===e._cachedWrapV&&this._cachedWrapR===e._cachedWrapR&&this._cachedAnisotropicFilteringLevel===e._cachedAnisotropicFilteringLevel&&this.samplingMode===e.samplingMode&&this._comparisonFunction===e._comparisonFunction&&this._useMipMaps===e._useMipMaps}}var Xt;(function(n){n[n.Unknown=0]="Unknown",n[n.Url=1]="Url",n[n.Temp=2]="Temp",n[n.Raw=3]="Raw",n[n.Dynamic=4]="Dynamic",n[n.RenderTarget=5]="RenderTarget",n[n.MultiRenderTarget=6]="MultiRenderTarget",n[n.Cube=7]="Cube",n[n.CubeRaw=8]="CubeRaw",n[n.CubePrefiltered=9]="CubePrefiltered",n[n.Raw3D=10]="Raw3D",n[n.Raw2DArray=11]="Raw2DArray",n[n.DepthStencil=12]="DepthStencil",n[n.CubeRawRGBD=13]="CubeRawRGBD",n[n.Depth=14]="Depth"})(Xt||(Xt={}));class Qr extends pN{get useMipMaps(){return this.generateMipMaps}set useMipMaps(e){this.generateMipMaps=e}get uniqueId(){return this._uniqueId}_setUniqueId(e){this._uniqueId=e}getEngine(){return this._engine}get source(){return this._source}constructor(e,t,i=!1){super(),this.isReady=!1,this.isCube=!1,this.is3D=!1,this.is2DArray=!1,this.isMultiview=!1,this.url="",this.generateMipMaps=!1,this.samples=0,this.type=-1,this.format=-1,this.onLoadedObservable=new Y,this.onErrorObservable=new Y,this.onRebuildCallback=null,this.width=0,this.height=0,this.depth=0,this.baseWidth=0,this.baseHeight=0,this.baseDepth=0,this.invertY=!1,this._invertVScale=!1,this._associatedChannel=-1,this._source=Xt.Unknown,this._buffer=null,this._bufferView=null,this._bufferViewArray=null,this._bufferViewArrayArray=null,this._size=0,this._extension="",this._files=null,this._workingCanvas=null,this._workingContext=null,this._cachedCoordinatesMode=null,this._isDisabled=!1,this._compression=null,this._sphericalPolynomial=null,this._sphericalPolynomialPromise=null,this._sphericalPolynomialComputed=!1,this._lodGenerationScale=0,this._lodGenerationOffset=0,this._useSRGBBuffer=!1,this._creationFlags=0,this._lodTextureHigh=null,this._lodTextureMid=null,this._lodTextureLow=null,this._isRGBD=!1,this._linearSpecularLOD=!1,this._irradianceTexture=null,this._hardwareTexture=null,this._maxLodLevel=null,this._references=1,this._gammaSpace=null,this._premulAlpha=!1,this._dynamicTextureSource=null,this._engine=e,this._source=t,this._uniqueId=Qr._Counter++,i||(this._hardwareTexture=e._createHardwareTexture())}incrementReferences(){this._references++}updateSize(e,t,i=1){this._engine.updateTextureDimensions(this,e,t,i),this.width=e,this.height=t,this.depth=i,this.baseWidth=e,this.baseHeight=t,this.baseDepth=i,this._size=e*t*i}_rebuild(){if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){const t=this.onRebuildCallback(this),i=r=>{r._swapAndDie(this,!1),this.isReady=t.isReady};t.isAsync?t.proxy.then(i):i(t.proxy);return}let e;switch(this.source){case Xt.Temp:break;case Xt.Url:e=this._engine.createTexture(this._originalUrl??this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,t=>{t._swapAndDie(this,!1),this.isReady=!0},null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer);return;case Xt.Raw:e=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type,this._creationFlags,this._useSRGBBuffer),e._swapAndDie(this,!1),this.isReady=!0;break;case Xt.Raw3D:e=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),e._swapAndDie(this,!1),this.isReady=!0;break;case Xt.Raw2DArray:e=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),e._swapAndDie(this,!1),this.isReady=!0;break;case Xt.Dynamic:e=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode),e._swapAndDie(this,!1),this._dynamicTextureSource&&this._engine.updateDynamicTexture(this,this._dynamicTextureSource,this.invertY,this._premulAlpha,this.format,!0);break;case Xt.Cube:e=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,()=>{e._swapAndDie(this,!1),this.isReady=!0},null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer);return;case Xt.CubeRaw:e=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this._originalFormat??this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression),e._swapAndDie(this,!1),this.isReady=!0;break;case Xt.CubeRawRGBD:return;case Xt.CubePrefiltered:e=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,t=>{t&&t._swapAndDie(this,!1),this.isReady=!0},null,this.format,this._extension),e._sphericalPolynomial=this._sphericalPolynomial;return;case Xt.DepthStencil:case Xt.Depth:break}}_swapAndDie(e,t=!0){var s;(s=this._hardwareTexture)==null||s.setUsage(e._source,this.generateMipMaps,this.is2DArray,this.isCube,this.is3D,this.width,this.height,this.depth),e._hardwareTexture=this._hardwareTexture,t&&(e._isRGBD=this._isRGBD),this._lodTextureHigh&&(e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(e._lodTextureLow&&e._lodTextureLow.dispose(),e._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(e._irradianceTexture&&e._irradianceTexture.dispose(),e._irradianceTexture=this._irradianceTexture);const i=this._engine.getLoadedTexturesCache();let r=i.indexOf(this);r!==-1&&i.splice(r,1),r=i.indexOf(e),r===-1&&i.push(e)}dispose(){this._references--,this.onLoadedObservable.clear(),this.onErrorObservable.clear(),this._references===0&&(this._engine._releaseTexture(this),this._hardwareTexture=null,this._dynamicTextureSource=null)}}Qr._Counter=0;class gN{constructor(){this.shaderLanguage=Oi.GLSL}postProcessor(e,t,i,r,s){if(!s.getCaps().drawBuffersExtension){const a=/#extension.+GL_EXT_draw_buffers.+(enable|require)/g;e=e.replace(a,"")}return e}}const mN=/(flat\s)?\s*varying\s*.*/;class vN{constructor(){this.shaderLanguage=Oi.GLSL}attributeProcessor(e){return e.replace("attribute","in")}varyingCheck(e,t){return mN.test(e)}varyingProcessor(e,t){return e.replace("varying",t?"in":"out")}postProcessor(e,t,i){const r=e.search(/#extension.+GL_EXT_draw_buffers.+require/)!==-1,s=/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g;if(e=e.replace(s,""),e=e.replace(/texture2D\s*\(/g,"texture("),i){const a=e.search(/layout *\(location *= *0\) *out/g)!==-1;e=e.replace(/texture2DLodEXT\s*\(/g,"textureLod("),e=e.replace(/textureCubeLodEXT\s*\(/g,"textureLod("),e=e.replace(/textureCube\s*\(/g,"texture("),e=e.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),e=e.replace(/gl_FragColor/g,"glFragColor"),e=e.replace(/gl_FragData/g,"glFragData"),e=e.replace(/void\s+?main\s*\(/g,(r||a?"":`layout(location = 0) out vec4 glFragColor;
`)+"void main(")}else if(t.indexOf("#define MULTIVIEW")!==-1)return`#extension GL_OVR_multiview2 : require
layout (num_views = 2) in;
`+e;return e}}class Nu{get underlyingResource(){return null}constructor(){this.references=0,this.capacity=0,this.is32Bits=!1,this.uniqueId=Nu._Counter++}}Nu._Counter=0;class nu extends Nu{constructor(e){super(),this._buffer=e}get underlyingResource(){return this._buffer}}class EN{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return this.program?this.isParallelCompiled?this.engine._isRenderingStateCompiled(this):!0:!1}_handlesSpectorRebuildCallback(e){e&&this.program&&e(this.program)}_fillEffectInformation(e,t,i,r,s,a,l,o){const c=this.engine;if(c.supportsUniformBuffers)for(const d in t)e.bindUniformBlock(d,t[d]);this.engine.getUniforms(this,i).forEach((d,f)=>{r[i[f]]=d}),this._uniforms=r;let h;for(h=0;h<s.length;h++)e.getUniform(s[h])==null&&(s.splice(h,1),h--);s.forEach((d,f)=>{a[d]=f});for(const d of c.getAttributes(this,l))o.push(d)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(e,t){const i=this._valueCache[e],r=t.updateFlag;return i!==void 0&&i===r?!1:(this._valueCache[e]=r,!0)}_cacheFloat2(e,t,i){let r=this._valueCache[e];if(!r||r.length!==2)return r=[t,i],this._valueCache[e]=r,!0;let s=!1;return r[0]!==t&&(r[0]=t,s=!0),r[1]!==i&&(r[1]=i,s=!0),s}_cacheFloat3(e,t,i,r){let s=this._valueCache[e];if(!s||s.length!==3)return s=[t,i,r],this._valueCache[e]=s,!0;let a=!1;return s[0]!==t&&(s[0]=t,a=!0),s[1]!==i&&(s[1]=i,a=!0),s[2]!==r&&(s[2]=r,a=!0),a}_cacheFloat4(e,t,i,r,s){let a=this._valueCache[e];if(!a||a.length!==4)return a=[t,i,r,s],this._valueCache[e]=a,!0;let l=!1;return a[0]!==t&&(a[0]=t,l=!0),a[1]!==i&&(a[1]=i,l=!0),a[2]!==r&&(a[2]=r,l=!0),a[3]!==s&&(a[3]=s,l=!0),l}setInt(e,t){const i=this._valueCache[e];i!==void 0&&i===t||this.engine.setInt(this._uniforms[e],t)&&(this._valueCache[e]=t)}setInt2(e,t,i){this._cacheFloat2(e,t,i)&&(this.engine.setInt2(this._uniforms[e],t,i)||(this._valueCache[e]=null))}setInt3(e,t,i,r){this._cacheFloat3(e,t,i,r)&&(this.engine.setInt3(this._uniforms[e],t,i,r)||(this._valueCache[e]=null))}setInt4(e,t,i,r,s){this._cacheFloat4(e,t,i,r,s)&&(this.engine.setInt4(this._uniforms[e],t,i,r,s)||(this._valueCache[e]=null))}setIntArray(e,t){this._valueCache[e]=null,this.engine.setIntArray(this._uniforms[e],t)}setIntArray2(e,t){this._valueCache[e]=null,this.engine.setIntArray2(this._uniforms[e],t)}setIntArray3(e,t){this._valueCache[e]=null,this.engine.setIntArray3(this._uniforms[e],t)}setIntArray4(e,t){this._valueCache[e]=null,this.engine.setIntArray4(this._uniforms[e],t)}setUInt(e,t){const i=this._valueCache[e];i!==void 0&&i===t||this.engine.setUInt(this._uniforms[e],t)&&(this._valueCache[e]=t)}setUInt2(e,t,i){this._cacheFloat2(e,t,i)&&(this.engine.setUInt2(this._uniforms[e],t,i)||(this._valueCache[e]=null))}setUInt3(e,t,i,r){this._cacheFloat3(e,t,i,r)&&(this.engine.setUInt3(this._uniforms[e],t,i,r)||(this._valueCache[e]=null))}setUInt4(e,t,i,r,s){this._cacheFloat4(e,t,i,r,s)&&(this.engine.setUInt4(this._uniforms[e],t,i,r,s)||(this._valueCache[e]=null))}setUIntArray(e,t){this._valueCache[e]=null,this.engine.setUIntArray(this._uniforms[e],t)}setUIntArray2(e,t){this._valueCache[e]=null,this.engine.setUIntArray2(this._uniforms[e],t)}setUIntArray3(e,t){this._valueCache[e]=null,this.engine.setUIntArray3(this._uniforms[e],t)}setUIntArray4(e,t){this._valueCache[e]=null,this.engine.setUIntArray4(this._uniforms[e],t)}setArray(e,t){this._valueCache[e]=null,this.engine.setArray(this._uniforms[e],t)}setArray2(e,t){this._valueCache[e]=null,this.engine.setArray2(this._uniforms[e],t)}setArray3(e,t){this._valueCache[e]=null,this.engine.setArray3(this._uniforms[e],t)}setArray4(e,t){this._valueCache[e]=null,this.engine.setArray4(this._uniforms[e],t)}setMatrices(e,t){t&&(this._valueCache[e]=null,this.engine.setMatrices(this._uniforms[e],t))}setMatrix(e,t){this._cacheMatrix(e,t)&&(this.engine.setMatrices(this._uniforms[e],t.asArray())||(this._valueCache[e]=null))}setMatrix3x3(e,t){this._valueCache[e]=null,this.engine.setMatrix3x3(this._uniforms[e],t)}setMatrix2x2(e,t){this._valueCache[e]=null,this.engine.setMatrix2x2(this._uniforms[e],t)}setFloat(e,t){const i=this._valueCache[e];i!==void 0&&i===t||this.engine.setFloat(this._uniforms[e],t)&&(this._valueCache[e]=t)}setVector2(e,t){this._cacheFloat2(e,t.x,t.y)&&(this.engine.setFloat2(this._uniforms[e],t.x,t.y)||(this._valueCache[e]=null))}setFloat2(e,t,i){this._cacheFloat2(e,t,i)&&(this.engine.setFloat2(this._uniforms[e],t,i)||(this._valueCache[e]=null))}setVector3(e,t){this._cacheFloat3(e,t.x,t.y,t.z)&&(this.engine.setFloat3(this._uniforms[e],t.x,t.y,t.z)||(this._valueCache[e]=null))}setFloat3(e,t,i,r){this._cacheFloat3(e,t,i,r)&&(this.engine.setFloat3(this._uniforms[e],t,i,r)||(this._valueCache[e]=null))}setVector4(e,t){this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&(this.engine.setFloat4(this._uniforms[e],t.x,t.y,t.z,t.w)||(this._valueCache[e]=null))}setQuaternion(e,t){this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&(this.engine.setFloat4(this._uniforms[e],t.x,t.y,t.z,t.w)||(this._valueCache[e]=null))}setFloat4(e,t,i,r,s){this._cacheFloat4(e,t,i,r,s)&&(this.engine.setFloat4(this._uniforms[e],t,i,r,s)||(this._valueCache[e]=null))}setColor3(e,t){this._cacheFloat3(e,t.r,t.g,t.b)&&(this.engine.setFloat3(this._uniforms[e],t.r,t.g,t.b)||(this._valueCache[e]=null))}setColor4(e,t,i){this._cacheFloat4(e,t.r,t.g,t.b,i)&&(this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,i)||(this._valueCache[e]=null))}setDirectColor4(e,t){this._cacheFloat4(e,t.r,t.g,t.b,t.a)&&(this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,t.a)||(this._valueCache[e]=null))}_getVertexShaderCode(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null}}class s1{get underlyingResource(){return this._webGLTexture}constructor(e=null,t){if(this._MSAARenderBuffers=null,this._context=t,!e&&(e=t.createTexture(),!e))throw new Error("Unable to create webGL texture");this.set(e)}setUsage(){}set(e){this._webGLTexture=e}reset(){this._webGLTexture=null,this._MSAARenderBuffers=null}addMSAARenderBuffer(e){this._MSAARenderBuffers||(this._MSAARenderBuffers=[]),this._MSAARenderBuffers.push(e)}releaseMSAARenderBuffers(){if(this._MSAARenderBuffers){for(const e of this._MSAARenderBuffers)this._context.deleteRenderbuffer(e);this._MSAARenderBuffers=null}}getMSAARenderBuffer(e=0){var t;return((t=this._MSAARenderBuffers)==null?void 0:t[e])??null}release(){this.releaseMSAARenderBuffers(),this._webGLTexture&&this._context.deleteTexture(this._webGLTexture),this.reset()}}class ec{static IsWrapper(e){return e.getPipelineContext===void 0}static GetEffect(e){return e.getPipelineContext===void 0?e.effect:e}constructor(e,t=!0){this._wasPreviouslyReady=!1,this._forceRebindOnNextCall=!0,this._wasPreviouslyUsingInstances=null,this.effect=null,this.defines=null,this.drawContext=e.createDrawContext(),t&&(this.materialContext=e.createMaterialContext())}setEffect(e,t,i=!0){var r;this.effect=e,t!==void 0&&(this.defines=t),i&&((r=this.drawContext)==null||r.reset())}dispose(){var e;(e=this.drawContext)==null||e.dispose()}}class yN{get isDirty(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty}get func(){return this._func}set func(e){this._func!==e&&(this._func=e,this._isStencilFuncDirty=!0)}get funcRef(){return this._funcRef}set funcRef(e){this._funcRef!==e&&(this._funcRef=e,this._isStencilFuncDirty=!0)}get funcMask(){return this._funcMask}set funcMask(e){this._funcMask!==e&&(this._funcMask=e,this._isStencilFuncDirty=!0)}get opStencilFail(){return this._opStencilFail}set opStencilFail(e){this._opStencilFail!==e&&(this._opStencilFail=e,this._isStencilOpDirty=!0)}get opDepthFail(){return this._opDepthFail}set opDepthFail(e){this._opDepthFail!==e&&(this._opDepthFail=e,this._isStencilOpDirty=!0)}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(e){this._opStencilDepthPass!==e&&(this._opStencilDepthPass=e,this._isStencilOpDirty=!0)}get mask(){return this._mask}set mask(e){this._mask!==e&&(this._mask=e,this._isStencilMaskDirty=!0)}get enabled(){return this._enabled}set enabled(e){this._enabled!==e&&(this._enabled=e,this._isStencilTestDirty=!0)}constructor(e=!0){this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.useStencilGlobalOnly=!1,e&&this.reset()}reset(){var e;this.stencilMaterial=void 0,(e=this.stencilGlobal)==null||e.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0}apply(e){var i;if(!e)return;const t=!this.useStencilGlobalOnly&&!!((i=this.stencilMaterial)!=null&&i.enabled);this.enabled=t?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.func=t?this.stencilMaterial.func:this.stencilGlobal.func,this.funcRef=t?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=t?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.opStencilFail=t?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail,this.opDepthFail=t?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail,this.opStencilDepthPass=t?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass,this.mask=t?this.stencilMaterial.mask:this.stencilGlobal.mask,this.isDirty&&(this._isStencilTestDirty&&(this.enabled?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(e.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(e.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(e.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}}class TN{}class we{static get NpmPackage(){return"babylonjs@6.49.0"}static get Version(){return"6.49.0"}get description(){let e=this.name+this.webGLVersion;return this._caps.parallelShaderCompile&&(e+=" - Parallel shader compilation"),e}get name(){return this._name}set name(e){this._name=e}get version(){return this._webGLVersion}get isDisposed(){return this._isDisposed}static get ShadersRepository(){return _r.ShadersRepository}static set ShadersRepository(e){_r.ShadersRepository=e}_getShaderProcessor(e){return this._shaderProcessor}get useReverseDepthBuffer(){return this._useReverseDepthBuffer}set useReverseDepthBuffer(e){e!==this._useReverseDepthBuffer&&(this._useReverseDepthBuffer=e,e?this._depthCullingState.depthFunc=518:this._depthCullingState.depthFunc=515)}get frameId(){return this._frameId}get supportsUniformBuffers(){return this.webGLVersion>1&&!this.disableUniformBuffers}getCreationOptions(){return this._creationOptions}get _shouldUseHighPrecisionShader(){return!!(this._caps.highPrecisionShaderSupported&&this._highPrecisionShadersAllowed)}get needPOTTextures(){return this._webGLVersion<2||this.forcePOTTextures}get activeRenderLoops(){return this._activeRenderLoops}get doNotHandleContextLost(){return this._doNotHandleContextLost}set doNotHandleContextLost(e){this._doNotHandleContextLost=e}get _supportsHardwareTextureRescaling(){return!1}set framebufferDimensionsObject(e){this._framebufferDimensionsObject=e}get currentViewport(){return this._cachedViewport}get emptyTexture(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1)),this._emptyTexture}get emptyTexture3D(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture3D}get emptyTexture2DArray(){return this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture2DArray}get emptyCubeTexture(){if(!this._emptyCubeTexture){const e=new Uint8Array(4),t=[e,e,e,e,e,e];this._emptyCubeTexture=this.createRawCubeTexture(t,1,5,0,!1,!1,1)}return this._emptyCubeTexture}get isWebGPU(){return this._isWebGPU}get shaderPlatformName(){return this._shaderPlatformName}get snapshotRendering(){return!1}set snapshotRendering(e){}get snapshotRenderingMode(){return this._snapshotRenderingMode}set snapshotRenderingMode(e){this._snapshotRenderingMode=e}snapshotRenderingReset(){this.snapshotRendering=!1}static _CreateCanvas(e,t){if(typeof document>"u")return new OffscreenCanvas(e,t);const i=document.createElement("canvas");return i.width=e,i.height=t,i}createCanvas(e,t){return we._CreateCanvas(e,t)}createCanvasImage(){return document.createElement("img")}constructor(e,t,i,r){var c,u;this._name="WebGL",this._isDisposed=!1,this.forcePOTTextures=!1,this.isFullscreen=!1,this.cullBackFaces=null,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this.validateShaderPrograms=!1,this._useReverseDepthBuffer=!1,this.isNDCHalfZRange=!1,this.hasOriginBottomLeft=!0,this.disableUniformBuffers=!1,this.onDisposeObservable=new Y,this._frameId=0,this._uniformBuffers=new Array,this._storageBuffers=new Array,this._webGLVersion=1,this._windowIsBackground=!1,this._highPrecisionShadersAllowed=!0,this._badOS=!1,this._badDesktopOS=!1,this._activeRenderLoops=new Array,this.onContextLostObservable=new Y,this.onContextRestoredObservable=new Y,this._contextWasLost=!1,this._doNotHandleContextLost=!1,this.disableVertexArrayObjects=!1,this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new fN,this._stencilStateComposer=new yN,this._stencilState=new xs,this._alphaState=new _N,this._alphaMode=1,this._alphaEquation=0,this._internalTexturesCache=new Array,this._renderTargetWrapperCache=new Array,this._activeChannel=0,this._currentTextureChannel=-1,this._boundTexturesCache={},this._compiledEffects={},this._vertexAttribArraysEnabled=[],this._currentRenderTarget=null,this._uintIndicesCurrentlySet=!1,this._currentBoundBuffer=new Array,this._currentFramebuffer=null,this._dummyFramebuffer=null,this._currentBufferPointers=new Array,this._currentInstanceLocations=new Array,this._currentInstanceBuffers=new Array,this._boundRenderFunction=()=>this._renderLoop(),this._vaoRecordInProgress=!1,this._mustWipeVertexAttributes=!1,this._frameHandler=0,this._nextFreeTextureSlots=new Array,this._maxSimultaneousTextures=0,this._maxMSAASamplesOverride=null,this._activeRequests=new Array,this.adaptToDeviceRatio=!1,this._lastDevicePixelRatio=1,this._transformTextureUrl=null,this.hostInformation={isMobile:!1},this.premultipliedAlpha=!0,this.onBeforeTextureInitObservable=new Y,this._isWebGPU=!1,this._snapshotRenderingMode=0,this._viewportCached={x:0,y:0,z:0,w:0},this._unpackFlipYCached=null,this.enableUnpackFlipYCached=!0,this._boundUniforms={},this.startTime=mn.Now;let s=null;i=i||{},this._creationOptions=i,this.adaptToDeviceRatio=r??!1,this._stencilStateComposer.stencilGlobal=this._stencilState,Pi.SetMatrixPrecision(!!i.useHighPrecisionMatrix),i.antialias=t??i.antialias,i.deterministicLockstep=i.deterministicLockstep??!1,i.lockstepMaxSteps=i.lockstepMaxSteps??4,i.timeStep=i.timeStep??1/60,i.audioEngine=i.audioEngine??!0,i.stencil=i.stencil??!0,this._audioContext=((c=i.audioEngineOptions)==null?void 0:c.audioContext)??null,this._audioDestination=((u=i.audioEngineOptions)==null?void 0:u.audioDestination)??null,this.premultipliedAlpha=i.premultipliedAlpha??!0,this.useExactSrgbConversions=i.useExactSrgbConversions??!1,this._doNotHandleContextLost=!!i.doNotHandleContextLost,this._isStencilEnable=!!i.stencil,r=r||i.adaptToDeviceRatio||!1;const a=Ui()&&window.devicePixelRatio||1,l=i.limitDeviceRatio||a;if(this._hardwareScalingLevel=r?1/Math.min(l,a):1,this._lastDevicePixelRatio=a,!e)return;if(e.getContext){if(s=e,this._renderingCanvas=s,i.preserveDrawingBuffer===void 0&&(i.preserveDrawingBuffer=!1),i.xrCompatible===void 0&&(i.xrCompatible=!0),navigator&&navigator.userAgent){this._setupMobileChecks();const h=navigator.userAgent;for(const d of we.ExceptionList){const f=d.key,_=d.targets;if(new RegExp(f).test(h)){if(d.capture&&d.captureConstraint){const v=d.capture,E=d.captureConstraint,m=new RegExp(v).exec(h);if(m&&m.length>0&&parseInt(m[m.length-1])>=E)continue}for(const v of _)switch(v){case"uniformBuffer":this.disableUniformBuffers=!0;break;case"vao":this.disableVertexArrayObjects=!0;break;case"antialias":i.antialias=!1;break;case"maxMSAASamples":this._maxMSAASamplesOverride=1;break}}}}if(this._doNotHandleContextLost||(this._onContextLost=h=>{h.preventDefault(),this._contextWasLost=!0,ee.Warn("WebGL context lost."),this.onContextLostObservable.notifyObservers(this)},this._onContextRestored=()=>{this._restoreEngineAfterContextLost(()=>this._initGLContext())},s.addEventListener("webglcontextlost",this._onContextLost,!1),s.addEventListener("webglcontextrestored",this._onContextRestored,!1),i.powerPreference=i.powerPreference||"high-performance"),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this._badDesktopOS&&(i.xrCompatible=!1),!i.disableWebGL2Support)try{this._gl=s.getContext("webgl2",i)||s.getContext("experimental-webgl2",i),this._gl&&(this._webGLVersion=2,this._shaderPlatformName="WEBGL2",this._gl.deleteQuery||(this._webGLVersion=1,this._shaderPlatformName="WEBGL1"))}catch{}if(!this._gl){if(!s)throw new Error("The provided canvas is null or undefined.");try{this._gl=s.getContext("webgl",i)||s.getContext("experimental-webgl",i)}catch{throw new Error("WebGL not supported")}}if(!this._gl)throw new Error("WebGL not supported")}else{this._gl=e,this._renderingCanvas=this._gl.canvas,this._gl.renderbufferStorageMultisample?(this._webGLVersion=2,this._shaderPlatformName="WEBGL2"):this._shaderPlatformName="WEBGL1";const h=this._gl.getContextAttributes();h&&(i.stencil=h.stencil)}this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),i.useHighPrecisionFloats!==void 0&&(this._highPrecisionShadersAllowed=i.useHighPrecisionFloats),this.resize(),this._initGLContext(),this._initFeatures();for(let h=0;h<this._caps.maxVertexAttribs;h++)this._currentBufferPointers[h]=new TN;this._shaderProcessor=this.webGLVersion>1?new vN:new gN,this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent);const o=`Babylon.js v${we.Version}`;ee.Log(o+` - ${this.description}`),this._renderingCanvas&&this._renderingCanvas.setAttribute&&this._renderingCanvas.setAttribute("data-engine",o)}_setupMobileChecks(){navigator&&navigator.userAgent&&(this._checkForMobile=()=>{const e=navigator.userAgent;this.hostInformation.isMobile=e.indexOf("Mobile")!==-1||e.indexOf("Mac")!==-1&&Vc()&&"ontouchend"in document},this._checkForMobile(),Ui()&&window.addEventListener("resize",this._checkForMobile))}_clearEmptyResources(){this._dummyFramebuffer=null,this._emptyTexture=null,this._emptyCubeTexture=null,this._emptyTexture3D=null,this._emptyTexture2DArray=null}_rebuildGraphicsResources(){var e;this.wipeCaches(!0),this._rebuildEffects(),(e=this._rebuildComputeEffects)==null||e.call(this),this._rebuildBuffers(),this._rebuildInternalTextures(),this._rebuildTextures(),this._rebuildRenderTargetWrappers(),this.wipeCaches(!0)}_flagContextRestored(){ee.Warn(this.name+" context successfully restored."),this.onContextRestoredObservable.notifyObservers(this),this._contextWasLost=!1}_restoreEngineAfterContextLost(e){setTimeout(async()=>{this._clearEmptyResources();const t=this._depthCullingState.depthTest,i=this._depthCullingState.depthFunc,r=this._depthCullingState.depthMask,s=this._stencilState.stencilTest;await e(),this._rebuildGraphicsResources(),this._depthCullingState.depthTest=t,this._depthCullingState.depthFunc=i,this._depthCullingState.depthMask=r,this._stencilState.stencilTest=s,this._flagContextRestored()},0)}_sharedInit(e){this._renderingCanvas=e}_getShaderProcessingContext(e){return null}_rebuildInternalTextures(){const e=this._internalTexturesCache.slice();for(const t of e)t._rebuild()}_rebuildRenderTargetWrappers(){const e=this._renderTargetWrapperCache.slice();for(const t of e)t._rebuild()}_rebuildEffects(){for(const e in this._compiledEffects){const t=this._compiledEffects[e];t._pipelineContext=null,t._prepareEffect()}_r.ResetCache()}areAllEffectsReady(){for(const e in this._compiledEffects)if(!this._compiledEffects[e].isReady())return!1;return!0}_rebuildBuffers(){for(const e of this._uniformBuffers)e._rebuildAfterContextLost()}_rebuildTextures(){}_initGLContext(){this._caps={maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension("KHR_parallel_shader_compile")||void 0,standardDerivatives:this._webGLVersion>1||this._gl.getExtension("OES_standard_derivatives")!==null,maxAnisotropy:1,astc:this._gl.getExtension("WEBGL_compressed_texture_astc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"),bptc:this._gl.getExtension("EXT_texture_compression_bptc")||this._gl.getExtension("WEBKIT_EXT_texture_compression_bptc"),s3tc:this._gl.getExtension("WEBGL_compressed_texture_s3tc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),s3tc_srgb:this._gl.getExtension("WEBGL_compressed_texture_s3tc_srgb")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc_srgb"),pvrtc:this._gl.getExtension("WEBGL_compressed_texture_pvrtc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:this._gl.getExtension("WEBGL_compressed_texture_etc1")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),etc2:this._gl.getExtension("WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBGL_compressed_texture_es3_0"),textureAnisotropicFilterExtension:this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),uintIndices:this._webGLVersion>1||this._gl.getExtension("OES_element_index_uint")!==null,fragmentDepthSupported:this._webGLVersion>1||this._gl.getExtension("EXT_frag_depth")!==null,highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension("EXT_disjoint_timer_query_webgl2")||this._gl.getExtension("EXT_disjoint_timer_query"),supportOcclusionQuery:this._webGLVersion>1,canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:!!(this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_float")),supportFloatTexturesResolve:!1,rg11b10ufColorRenderable:!1,colorBufferHalfFloat:!!(this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_half_float")),textureFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_float")),textureHalfFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_half_float")),textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:!!(this._webGLVersion>1||this._gl.getExtension("EXT_shader_texture_lod")),texelFetch:this._webGLVersion!==1,blendMinMax:!1,multiview:this._gl.getExtension("OVR_multiview2"),oculusMultiview:this._gl.getExtension("OCULUS_multiview"),depthTextureExtension:!1,canUseGLInstanceID:this._webGLVersion>1,canUseGLVertexID:this._webGLVersion>1,supportComputeShaders:!1,supportSRGBBuffers:!1,supportTransformFeedbacks:this._webGLVersion>1,textureMaxLevel:this._webGLVersion>1,texture2DArrayMaxLayerCount:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_ARRAY_TEXTURE_LAYERS):128,disableMorphTargetTexture:!1},this._caps.supportFloatTexturesResolve=this._caps.colorBufferFloat,this._caps.rg11b10ufColorRenderable=this._caps.colorBufferFloat,this._glVersion=this._gl.getParameter(this._gl.VERSION);const e=this._gl.getExtension("WEBGL_debug_renderer_info");if(e!=null&&(this._glRenderer=this._gl.getParameter(e.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(e.UNMASKED_VENDOR_WEBGL)),this._glVendor||(this._glVendor=this._gl.getParameter(this._gl.VENDOR)||"Unknown vendor"),this._glRenderer||(this._glRenderer=this._gl.getParameter(this._gl.RENDERER)||"Unknown renderer"),this._gl.HALF_FLOAT_OES!==36193&&(this._gl.HALF_FLOAT_OES=36193),this._gl.RGBA16F!==34842&&(this._gl.RGBA16F=34842),this._gl.RGBA32F!==34836&&(this._gl.RGBA32F=34836),this._gl.DEPTH24_STENCIL8!==35056&&(this._gl.DEPTH24_STENCIL8=35056),this._caps.timerQuery&&(this._webGLVersion===1&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery)),this._caps.canUseTimestampForTimerQuery=(this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT)??0)>0),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.textureFloatLinearFiltering=!!(this._caps.textureFloat&&this._gl.getExtension("OES_texture_float_linear")),this._caps.textureFloatRender=!!(this._caps.textureFloat&&this._canRenderToFloatFramebuffer()),this._caps.textureHalfFloatLinearFiltering=!!(this._webGLVersion>1||this._caps.textureHalfFloat&&this._gl.getExtension("OES_texture_half_float_linear")),this._caps.astc&&(this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR),this._caps.bptc&&(this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT),this._caps.s3tc_srgb&&(this._gl.COMPRESSED_SRGB_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT),this._caps.etc2&&(this._gl.COMPRESSED_SRGB8_ETC2=this._caps.etc2.COMPRESSED_SRGB8_ETC2,this._gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=this._caps.etc2.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC),this._webGLVersion>1&&this._gl.HALF_FLOAT_OES!==5131&&(this._gl.HALF_FLOAT_OES=5131),this._caps.textureHalfFloatRender=this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer(),this._webGLVersion>1)this._caps.drawBuffersExtension=!0,this._caps.maxMSAASamples=this._maxMSAASamplesOverride!==null?this._maxMSAASamplesOverride:this._gl.getParameter(this._gl.MAX_SAMPLES);else{const t=this._gl.getExtension("WEBGL_draw_buffers");if(t!==null){this._caps.drawBuffersExtension=!0,this._gl.drawBuffers=t.drawBuffersWEBGL.bind(t),this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER;for(let i=0;i<16;i++)this._gl["COLOR_ATTACHMENT"+i+"_WEBGL"]=t["COLOR_ATTACHMENT"+i+"_WEBGL"]}}if(this._webGLVersion>1)this._caps.depthTextureExtension=!0;else{const t=this._gl.getExtension("WEBGL_depth_texture");t!=null&&(this._caps.depthTextureExtension=!0,this._gl.UNSIGNED_INT_24_8=t.UNSIGNED_INT_24_8_WEBGL)}if(this.disableVertexArrayObjects)this._caps.vertexArrayObject=!1;else if(this._webGLVersion>1)this._caps.vertexArrayObject=!0;else{const t=this._gl.getExtension("OES_vertex_array_object");t!=null&&(this._caps.vertexArrayObject=!0,this._gl.createVertexArray=t.createVertexArrayOES.bind(t),this._gl.bindVertexArray=t.bindVertexArrayOES.bind(t),this._gl.deleteVertexArray=t.deleteVertexArrayOES.bind(t))}if(this._webGLVersion>1)this._caps.instancedArrays=!0;else{const t=this._gl.getExtension("ANGLE_instanced_arrays");t!=null?(this._caps.instancedArrays=!0,this._gl.drawArraysInstanced=t.drawArraysInstancedANGLE.bind(t),this._gl.drawElementsInstanced=t.drawElementsInstancedANGLE.bind(t),this._gl.vertexAttribDivisor=t.vertexAttribDivisorANGLE.bind(t)):this._caps.instancedArrays=!1}if(this._gl.getShaderPrecisionFormat){const t=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),i=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT);t&&i&&(this._caps.highPrecisionShaderSupported=t.precision!==0&&i.precision!==0)}if(this._webGLVersion>1)this._caps.blendMinMax=!0;else{const t=this._gl.getExtension("EXT_blend_minmax");t!=null&&(this._caps.blendMinMax=!0,this._gl.MAX=t.MAX_EXT,this._gl.MIN=t.MIN_EXT)}if(!this._caps.supportSRGBBuffers){if(this._webGLVersion>1)this._caps.supportSRGBBuffers=!0,this._glSRGBExtensionValues={SRGB:WebGL2RenderingContext.SRGB,SRGB8:WebGL2RenderingContext.SRGB8,SRGB8_ALPHA8:WebGL2RenderingContext.SRGB8_ALPHA8};else{const t=this._gl.getExtension("EXT_sRGB");t!=null&&(this._caps.supportSRGBBuffers=!0,this._glSRGBExtensionValues={SRGB:t.SRGB_EXT,SRGB8:t.SRGB_ALPHA_EXT,SRGB8_ALPHA8:t.SRGB_ALPHA_EXT})}this._caps.supportSRGBBuffers=this._caps.supportSRGBBuffers&&!!(this._creationOptions&&this._creationOptions.forceSRGBBufferSupportState)}this._depthCullingState.depthTest=!0,this._depthCullingState.depthFunc=this._gl.LEQUAL,this._depthCullingState.depthMask=!0,this._maxSimultaneousTextures=this._caps.maxCombinedTexturesImageUnits;for(let t=0;t<this._maxSimultaneousTextures;t++)this._nextFreeTextureSlots.push(t);this._glRenderer==="Mali-G72"&&(this._caps.disableMorphTargetTexture=!0)}_initFeatures(){this._features={forceBitmapOverHTMLImageElement:typeof HTMLImageElement>"u",supportRenderAndCopyToLodForFloatTextures:this._webGLVersion!==1,supportDepthStencilTexture:this._webGLVersion!==1,supportShadowSamplers:this._webGLVersion!==1,uniformBufferHardCheckMatrix:!1,allowTexturePrefiltering:this._webGLVersion!==1,trackUbosInFrame:!1,checkUbosContentBeforeUpload:!1,supportCSM:this._webGLVersion!==1,basisNeedsPOT:this._webGLVersion===1,support3DTextures:this._webGLVersion!==1,needTypeSuffixInShaderConstants:this._webGLVersion!==1,supportMSAA:this._webGLVersion!==1,supportSSAO2:this._webGLVersion!==1,supportExtendedTextureFormats:this._webGLVersion!==1,supportSwitchCaseInShader:this._webGLVersion!==1,supportSyncTextureRead:!0,needsInvertingBitmap:!0,useUBOBindingCache:!0,needShaderCodeInlining:!1,needToAlwaysBindUniformBuffers:!1,supportRenderPasses:!1,supportSpriteInstancing:!0,forceVertexBufferStrideAndOffsetMultiple4Bytes:!1,_collectUbosUpdatedInFrame:!1}}get webGLVersion(){return this._webGLVersion}getClassName(){return"ThinEngine"}get isStencilEnable(){return this._isStencilEnable}_prepareWorkingCanvas(){if(this._workingCanvas)return;this._workingCanvas=this.createCanvas(1,1);const e=this._workingCanvas.getContext("2d");e&&(this._workingContext=e)}resetTextureCache(){for(const e in this._boundTexturesCache)Object.prototype.hasOwnProperty.call(this._boundTexturesCache,e)&&(this._boundTexturesCache[e]=null);this._currentTextureChannel=-1}getInfo(){return this.getGlInfo()}getGlInfo(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}}setHardwareScalingLevel(e){this._hardwareScalingLevel=e,this.resize()}getHardwareScalingLevel(){return this._hardwareScalingLevel}getLoadedTexturesCache(){return this._internalTexturesCache}getCaps(){return this._caps}stopRenderLoop(e){if(!e){this._activeRenderLoops.length=0,this._cancelFrame();return}const t=this._activeRenderLoops.indexOf(e);t>=0&&(this._activeRenderLoops.splice(t,1),this._activeRenderLoops.length==0&&this._cancelFrame())}_cancelFrame(){if(this._frameHandler!==0){const e=this._frameHandler;if(this._frameHandler=0,Ui()){const{cancelAnimationFrame:t}=this.getHostWindow()||window;if(typeof t=="function")return t(e)}else if(typeof cancelAnimationFrame=="function")return cancelAnimationFrame(e);return clearTimeout(e)}}_renderLoop(){if(this._frameHandler=0,!this._contextWasLost){let e=!0;if((this._isDisposed||!this.renderEvenInBackground&&this._windowIsBackground)&&(e=!1),e){this.beginFrame();for(let t=0;t<this._activeRenderLoops.length;t++){const i=this._activeRenderLoops[t];i()}this.endFrame()}}this._frameHandler===0&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()))}getRenderingCanvas(){return this._renderingCanvas}getAudioContext(){return this._audioContext}getAudioDestination(){return this._audioDestination}getHostWindow(){return Ui()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null}getRenderWidth(e=!1){return!e&&this._currentRenderTarget?this._currentRenderTarget.width:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferWidth:this._gl.drawingBufferWidth}getRenderHeight(e=!1){return!e&&this._currentRenderTarget?this._currentRenderTarget.height:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferHeight:this._gl.drawingBufferHeight}_queueNewFrame(e,t){return we.QueueNewFrame(e,t)}runRenderLoop(e){this._activeRenderLoops.indexOf(e)===-1&&(this._activeRenderLoops.push(e),this._activeRenderLoops.length===1&&this._frameHandler===0&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))}clear(e,t,i,r=!1){var l,o;const s=this.stencilStateComposer.useStencilGlobalOnly;this.stencilStateComposer.useStencilGlobalOnly=!0,this.applyStates(),this.stencilStateComposer.useStencilGlobalOnly=s;let a=0;if(t&&e){let c=!0;if(this._currentRenderTarget){const u=(l=this._currentRenderTarget.texture)==null?void 0:l.format;if(u===8||u===9||u===10||u===11){const h=(o=this._currentRenderTarget.texture)==null?void 0:o.type;h===7||h===5?(we._TempClearColorUint32[0]=e.r*255,we._TempClearColorUint32[1]=e.g*255,we._TempClearColorUint32[2]=e.b*255,we._TempClearColorUint32[3]=e.a*255,this._gl.clearBufferuiv(this._gl.COLOR,0,we._TempClearColorUint32),c=!1):(we._TempClearColorInt32[0]=e.r*255,we._TempClearColorInt32[1]=e.g*255,we._TempClearColorInt32[2]=e.b*255,we._TempClearColorInt32[3]=e.a*255,this._gl.clearBufferiv(this._gl.COLOR,0,we._TempClearColorInt32),c=!1)}}c&&(this._gl.clearColor(e.r,e.g,e.b,e.a!==void 0?e.a:1),a|=this._gl.COLOR_BUFFER_BIT)}i&&(this.useReverseDepthBuffer?(this._depthCullingState.depthFunc=this._gl.GEQUAL,this._gl.clearDepth(0)):this._gl.clearDepth(1),a|=this._gl.DEPTH_BUFFER_BIT),r&&(this._gl.clearStencil(0),a|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(a)}_viewport(e,t,i,r){(e!==this._viewportCached.x||t!==this._viewportCached.y||i!==this._viewportCached.z||r!==this._viewportCached.w)&&(this._viewportCached.x=e,this._viewportCached.y=t,this._viewportCached.z=i,this._viewportCached.w=r,this._gl.viewport(e,t,i,r))}setViewport(e,t,i){const r=t||this.getRenderWidth(),s=i||this.getRenderHeight(),a=e.x||0,l=e.y||0;this._cachedViewport=e,this._viewport(a*r,l*s,r*e.width,s*e.height)}beginFrame(){}endFrame(){this._badOS&&this.flushFramebuffer(),this._frameId++}resize(e=!1){let t,i;if(this.adaptToDeviceRatio){const r=Ui()&&window.devicePixelRatio||1,s=this._lastDevicePixelRatio/r;this._lastDevicePixelRatio=r,this._hardwareScalingLevel*=s}if(Ui()&&Vc())if(this._renderingCanvas){const r=this._renderingCanvas.getBoundingClientRect?this._renderingCanvas.getBoundingClientRect():{width:this._renderingCanvas.width*this._hardwareScalingLevel,height:this._renderingCanvas.height*this._hardwareScalingLevel};t=this._renderingCanvas.clientWidth||r.width||this._renderingCanvas.width||100,i=this._renderingCanvas.clientHeight||r.height||this._renderingCanvas.height||100}else t=window.innerWidth,i=window.innerHeight;else t=this._renderingCanvas?this._renderingCanvas.width:100,i=this._renderingCanvas?this._renderingCanvas.height:100;this.setSize(t/this._hardwareScalingLevel,i/this._hardwareScalingLevel,e)}setSize(e,t,i=!1){return!this._renderingCanvas||(e=e|0,t=t|0,!i&&this._renderingCanvas.width===e&&this._renderingCanvas.height===t)?!1:(this._renderingCanvas.width=e,this._renderingCanvas.height=t,!0)}bindFramebuffer(e,t=0,i,r,s,a=0,l=0){var h,d,f,_,p,v;const o=e;this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget),this._currentRenderTarget=e,this._bindUnboundFramebuffer(o._MSAAFramebuffer?o._MSAAFramebuffer:o._framebuffer);const c=this._gl;e.isMulti||(e.is2DArray?c.framebufferTextureLayer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,(h=e.texture._hardwareTexture)==null?void 0:h.underlyingResource,a,l):e.isCube?c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_CUBE_MAP_POSITIVE_X+t,(d=e.texture._hardwareTexture)==null?void 0:d.underlyingResource,a):o._currentLOD!==a&&(c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,(f=e.texture._hardwareTexture)==null?void 0:f.underlyingResource,a),o._currentLOD=a));const u=e._depthStencilTexture;if(u){const E=e._depthStencilTextureWithStencil?c.DEPTH_STENCIL_ATTACHMENT:c.DEPTH_ATTACHMENT;e.is2DArray?c.framebufferTextureLayer(c.FRAMEBUFFER,E,(_=u._hardwareTexture)==null?void 0:_.underlyingResource,a,l):e.isCube?c.framebufferTexture2D(c.FRAMEBUFFER,E,c.TEXTURE_CUBE_MAP_POSITIVE_X+t,(p=u._hardwareTexture)==null?void 0:p.underlyingResource,a):c.framebufferTexture2D(c.FRAMEBUFFER,E,c.TEXTURE_2D,(v=u._hardwareTexture)==null?void 0:v.underlyingResource,a)}this._cachedViewport&&!s?this.setViewport(this._cachedViewport,i,r):(i||(i=e.width,a&&(i=i/Math.pow(2,a))),r||(r=e.height,a&&(r=r/Math.pow(2,a))),this._viewport(0,0,i,r)),this.wipeCaches()}setState(e,t=0,i,r=!1,s,a,l=0){(this._depthCullingState.cull!==e||i)&&(this._depthCullingState.cull=e);const o=this.cullBackFaces??s??!0?this._gl.BACK:this._gl.FRONT;(this._depthCullingState.cullFace!==o||i)&&(this._depthCullingState.cullFace=o),this.setZOffset(t),this.setZOffsetUnits(l);const c=r?this._gl.CW:this._gl.CCW;(this._depthCullingState.frontFace!==c||i)&&(this._depthCullingState.frontFace=c),this._stencilStateComposer.stencilMaterial=a}getDepthBuffer(){return this._depthCullingState.depthTest}setDepthBuffer(e){this._depthCullingState.depthTest=e}setZOffset(e){this._depthCullingState.zOffset=this.useReverseDepthBuffer?-e:e}getZOffset(){const e=this._depthCullingState.zOffset;return this.useReverseDepthBuffer?-e:e}setZOffsetUnits(e){this._depthCullingState.zOffsetUnits=this.useReverseDepthBuffer?-e:e}getZOffsetUnits(){const e=this._depthCullingState.zOffsetUnits;return this.useReverseDepthBuffer?-e:e}_bindUnboundFramebuffer(e){this._currentFramebuffer!==e&&(this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,e),this._currentFramebuffer=e)}_currentFrameBufferIsDefaultFrameBuffer(){return this._currentFramebuffer===null}generateMipmaps(e){this._bindTextureDirectly(this._gl.TEXTURE_2D,e,!0),this._gl.generateMipmap(this._gl.TEXTURE_2D),this._bindTextureDirectly(this._gl.TEXTURE_2D,null)}unBindFramebuffer(e,t=!1,i){var a;const r=e;this._currentRenderTarget=null;const s=this._gl;if(r._MSAAFramebuffer){if(e.isMulti){this.unBindMultiColorAttachmentFramebuffer(e,t,i);return}s.bindFramebuffer(s.READ_FRAMEBUFFER,r._MSAAFramebuffer),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,r._framebuffer),s.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,s.COLOR_BUFFER_BIT,s.NEAREST)}(a=e.texture)!=null&&a.generateMipMaps&&!t&&!e.isCube&&this.generateMipmaps(e.texture),i&&(r._MSAAFramebuffer&&this._bindUnboundFramebuffer(r._framebuffer),i()),this._bindUnboundFramebuffer(null)}flushFramebuffer(){this._gl.flush()}restoreDefaultFramebuffer(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):this._bindUnboundFramebuffer(null),this._cachedViewport&&this.setViewport(this._cachedViewport),this.wipeCaches()}_resetVertexBufferBinding(){this.bindArrayBuffer(null),this._cachedVertexBuffers=null}createVertexBuffer(e,t,i){return this._createVertexBuffer(e,this._gl.STATIC_DRAW)}_createVertexBuffer(e,t){const i=this._gl.createBuffer();if(!i)throw new Error("Unable to create vertex buffer");const r=new nu(i);return this.bindArrayBuffer(r),typeof e!="number"?e instanceof Array?(this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(e),t),r.capacity=e.length*4):(this._gl.bufferData(this._gl.ARRAY_BUFFER,e,t),r.capacity=e.byteLength):(this._gl.bufferData(this._gl.ARRAY_BUFFER,new Uint8Array(e),t),r.capacity=e),this._resetVertexBufferBinding(),r.references=1,r}createDynamicVertexBuffer(e,t){return this._createVertexBuffer(e,this._gl.DYNAMIC_DRAW)}_resetIndexBufferBinding(){this.bindIndexBuffer(null),this._cachedIndexBuffer=null}createIndexBuffer(e,t,i){const r=this._gl.createBuffer(),s=new nu(r);if(!r)throw new Error("Unable to create index buffer");this.bindIndexBuffer(s);const a=this._normalizeIndexData(e);return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,a,t?this._gl.DYNAMIC_DRAW:this._gl.STATIC_DRAW),this._resetIndexBufferBinding(),s.references=1,s.is32Bits=a.BYTES_PER_ELEMENT===4,s}_normalizeIndexData(e){if(e.BYTES_PER_ELEMENT===2)return e;if(this._caps.uintIndices){if(e instanceof Uint32Array)return e;for(let i=0;i<e.length;i++)if(e[i]>=65535)return new Uint32Array(e);return new Uint16Array(e)}return new Uint16Array(e)}bindArrayBuffer(e){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(e,this._gl.ARRAY_BUFFER)}bindUniformBlock(e,t,i){const r=e.program,s=this._gl.getUniformBlockIndex(r,t);this._gl.uniformBlockBinding(r,s,i)}bindIndexBuffer(e){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(e,this._gl.ELEMENT_ARRAY_BUFFER)}_bindBuffer(e,t){(this._vaoRecordInProgress||this._currentBoundBuffer[t]!==e)&&(this._gl.bindBuffer(t,e?e.underlyingResource:null),this._currentBoundBuffer[t]=e)}updateArrayBuffer(e){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e)}_vertexAttribPointer(e,t,i,r,s,a,l){const o=this._currentBufferPointers[t];if(!o)return;let c=!1;o.active?(o.buffer!==e&&(o.buffer=e,c=!0),o.size!==i&&(o.size=i,c=!0),o.type!==r&&(o.type=r,c=!0),o.normalized!==s&&(o.normalized=s,c=!0),o.stride!==a&&(o.stride=a,c=!0),o.offset!==l&&(o.offset=l,c=!0)):(c=!0,o.active=!0,o.index=t,o.size=i,o.type=r,o.normalized=s,o.stride=a,o.offset=l,o.buffer=e),(c||this._vaoRecordInProgress)&&(this.bindArrayBuffer(e),r===this._gl.UNSIGNED_INT||r===this._gl.INT?this._gl.vertexAttribIPointer(t,i,r,a,l):this._gl.vertexAttribPointer(t,i,r,s,a,l))}_bindIndexBufferWithCache(e){e!=null&&this._cachedIndexBuffer!==e&&(this._cachedIndexBuffer=e,this.bindIndexBuffer(e),this._uintIndicesCurrentlySet=e.is32Bits)}_bindVertexBuffersAttributes(e,t,i){const r=t.getAttributesNames();this._vaoRecordInProgress||this._unbindVertexArrayObject(),this.unbindAllAttributes();for(let s=0;s<r.length;s++){const a=t.getAttributeLocation(s);if(a>=0){const l=r[s];let o=null;if(i&&(o=i[l]),o||(o=e[l]),!o)continue;this._gl.enableVertexAttribArray(a),this._vaoRecordInProgress||(this._vertexAttribArraysEnabled[a]=!0);const c=o.getBuffer();c&&(this._vertexAttribPointer(c,a,o.getSize(),o.type,o.normalized,o.byteStride,o.byteOffset),o.getIsInstanced()&&(this._gl.vertexAttribDivisor(a,o.getInstanceDivisor()),this._vaoRecordInProgress||(this._currentInstanceLocations.push(a),this._currentInstanceBuffers.push(c))))}}}recordVertexArrayObject(e,t,i,r){const s=this._gl.createVertexArray();if(!s)throw new Error("Unable to create VAO");return this._vaoRecordInProgress=!0,this._gl.bindVertexArray(s),this._mustWipeVertexAttributes=!0,this._bindVertexBuffersAttributes(e,i,r),this.bindIndexBuffer(t),this._vaoRecordInProgress=!1,this._gl.bindVertexArray(null),s}bindVertexArrayObject(e,t){this._cachedVertexArrayObject!==e&&(this._cachedVertexArrayObject=e,this._gl.bindVertexArray(e),this._cachedVertexBuffers=null,this._cachedIndexBuffer=null,this._uintIndicesCurrentlySet=t!=null&&t.is32Bits,this._mustWipeVertexAttributes=!0)}bindBuffersDirectly(e,t,i,r,s){if(this._cachedVertexBuffers!==e||this._cachedEffectForVertexBuffers!==s){this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=s;const a=s.getAttributesCount();this._unbindVertexArrayObject(),this.unbindAllAttributes();let l=0;for(let o=0;o<a;o++)if(o<i.length){const c=s.getAttributeLocation(o);c>=0&&(this._gl.enableVertexAttribArray(c),this._vertexAttribArraysEnabled[c]=!0,this._vertexAttribPointer(e,c,i[o],this._gl.FLOAT,!1,r,l)),l+=i[o]*4}}this._bindIndexBufferWithCache(t)}_unbindVertexArrayObject(){this._cachedVertexArrayObject&&(this._cachedVertexArrayObject=null,this._gl.bindVertexArray(null))}bindBuffers(e,t,i,r){(this._cachedVertexBuffers!==e||this._cachedEffectForVertexBuffers!==i)&&(this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=i,this._bindVertexBuffersAttributes(e,i,r)),this._bindIndexBufferWithCache(t)}unbindInstanceAttributes(){let e;for(let t=0,i=this._currentInstanceLocations.length;t<i;t++){const r=this._currentInstanceBuffers[t];e!=r&&r.references&&(e=r,this.bindArrayBuffer(r));const s=this._currentInstanceLocations[t];this._gl.vertexAttribDivisor(s,0)}this._currentInstanceBuffers.length=0,this._currentInstanceLocations.length=0}releaseVertexArrayObject(e){this._gl.deleteVertexArray(e)}_releaseBuffer(e){return e.references--,e.references===0?(this._deleteBuffer(e),!0):!1}_deleteBuffer(e){this._gl.deleteBuffer(e.underlyingResource)}updateAndBindInstancesBuffer(e,t,i){if(this.bindArrayBuffer(e),t&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t),i[0].index!==void 0)this.bindInstancesBuffer(e,i,!0);else for(let r=0;r<4;r++){const s=i[r];this._vertexAttribArraysEnabled[s]||(this._gl.enableVertexAttribArray(s),this._vertexAttribArraysEnabled[s]=!0),this._vertexAttribPointer(e,s,4,this._gl.FLOAT,!1,64,r*16),this._gl.vertexAttribDivisor(s,1),this._currentInstanceLocations.push(s),this._currentInstanceBuffers.push(e)}}bindInstancesBuffer(e,t,i=!0){this.bindArrayBuffer(e);let r=0;if(i)for(let s=0;s<t.length;s++){const a=t[s];r+=a.attributeSize*4}for(let s=0;s<t.length;s++){const a=t[s];a.index===void 0&&(a.index=this._currentEffect.getAttributeLocationByName(a.attributeName)),!(a.index<0)&&(this._vertexAttribArraysEnabled[a.index]||(this._gl.enableVertexAttribArray(a.index),this._vertexAttribArraysEnabled[a.index]=!0),this._vertexAttribPointer(e,a.index,a.attributeSize,a.attributeType||this._gl.FLOAT,a.normalized||!1,r,a.offset),this._gl.vertexAttribDivisor(a.index,a.divisor===void 0?1:a.divisor),this._currentInstanceLocations.push(a.index),this._currentInstanceBuffers.push(e))}}disableInstanceAttributeByName(e){if(!this._currentEffect)return;const t=this._currentEffect.getAttributeLocationByName(e);this.disableInstanceAttribute(t)}disableInstanceAttribute(e){let t=!1,i;for(;(i=this._currentInstanceLocations.indexOf(e))!==-1;)this._currentInstanceLocations.splice(i,1),this._currentInstanceBuffers.splice(i,1),t=!0,i=this._currentInstanceLocations.indexOf(e);t&&(this._gl.vertexAttribDivisor(e,0),this.disableAttributeByIndex(e))}disableAttributeByIndex(e){this._gl.disableVertexAttribArray(e),this._vertexAttribArraysEnabled[e]=!1,this._currentBufferPointers[e].active=!1}draw(e,t,i,r){this.drawElementsType(e?0:1,t,i,r)}drawPointClouds(e,t,i){this.drawArraysType(2,e,t,i)}drawUnIndexed(e,t,i,r){this.drawArraysType(e?0:1,t,i,r)}drawElementsType(e,t,i,r){this.applyStates(),this._reportDrawCall();const s=this._drawMode(e),a=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,l=this._uintIndicesCurrentlySet?4:2;r?this._gl.drawElementsInstanced(s,i,a,t*l,r):this._gl.drawElements(s,i,a,t*l)}drawArraysType(e,t,i,r){this.applyStates(),this._reportDrawCall();const s=this._drawMode(e);r?this._gl.drawArraysInstanced(s,t,i,r):this._gl.drawArrays(s,t,i)}_drawMode(e){switch(e){case 0:return this._gl.TRIANGLES;case 2:return this._gl.POINTS;case 1:return this._gl.LINES;case 3:return this._gl.POINTS;case 4:return this._gl.LINES;case 5:return this._gl.LINE_LOOP;case 6:return this._gl.LINE_STRIP;case 7:return this._gl.TRIANGLE_STRIP;case 8:return this._gl.TRIANGLE_FAN;default:return this._gl.TRIANGLES}}_reportDrawCall(){}_releaseEffect(e){this._compiledEffects[e._key]&&delete this._compiledEffects[e._key];const t=e.getPipelineContext();t&&this._deletePipelineContext(t)}_deletePipelineContext(e){const t=e;t&&t.program&&(t.program.__SPECTOR_rebuildProgram=null,this._gl.deleteProgram(t.program))}_getGlobalDefines(e){if(e){this.isNDCHalfZRange?e.IS_NDC_HALF_ZRANGE="":delete e.IS_NDC_HALF_ZRANGE,this.useReverseDepthBuffer?e.USE_REVERSE_DEPTHBUFFER="":delete e.USE_REVERSE_DEPTHBUFFER,this.useExactSrgbConversions?e.USE_EXACT_SRGB_CONVERSIONS="":delete e.USE_EXACT_SRGB_CONVERSIONS;return}else{let t="";return this.isNDCHalfZRange&&(t+="#define IS_NDC_HALF_ZRANGE"),this.useReverseDepthBuffer&&(t&&(t+=`
`),t+="#define USE_REVERSE_DEPTHBUFFER"),this.useExactSrgbConversions&&(t&&(t+=`
`),t+="#define USE_EXACT_SRGB_CONVERSIONS"),t}}createEffect(e,t,i,r,s,a,l,o,c,u=Oi.GLSL){const h=e.vertexElement||e.vertex||e.vertexToken||e.vertexSource||e,d=e.fragmentElement||e.fragment||e.fragmentToken||e.fragmentSource||e,f=this._getGlobalDefines();let _=s??t.defines??"";f&&(_+=f);const p=h+"+"+d+"@"+_;if(this._compiledEffects[p]){const E=this._compiledEffects[p];return l&&E.isReady()&&l(E),E}const v=new _r(e,t,i,r,this,s,a,l,o,c,p,u);return this._compiledEffects[p]=v,v}static _ConcatenateShader(e,t,i=""){return i+(t?t+`
`:"")+e}_compileShader(e,t,i,r){return this._compileRawShader(we._ConcatenateShader(e,i,r),t)}_compileRawShader(e,t){const i=this._gl,r=i.createShader(t==="vertex"?i.VERTEX_SHADER:i.FRAGMENT_SHADER);if(!r){let s=i.NO_ERROR,a=i.NO_ERROR;for(;(a=i.getError())!==i.NO_ERROR;)s=a;throw new Error(`Something went wrong while creating a gl ${t} shader object. gl error=${s}, gl isContextLost=${i.isContextLost()}, _contextWasLost=${this._contextWasLost}`)}return i.shaderSource(r,e),i.compileShader(r),r}_getShaderSource(e){return this._gl.getShaderSource(e)}createRawShaderProgram(e,t,i,r,s=null){r=r||this._gl;const a=this._compileRawShader(t,"vertex"),l=this._compileRawShader(i,"fragment");return this._createShaderProgram(e,a,l,r,s)}createShaderProgram(e,t,i,r,s,a=null){s=s||this._gl;const l=this._webGLVersion>1?`#version 300 es
#define WEBGL2 
`:"",o=this._compileShader(t,"vertex",r,l),c=this._compileShader(i,"fragment",r,l);return this._createShaderProgram(e,o,c,s,a)}inlineShaderCode(e){return e}createPipelineContext(e){const t=new EN;return t.engine=this,this._caps.parallelShaderCompile&&(t.isParallelCompiled=!0),t}createMaterialContext(){}createDrawContext(){}_createShaderProgram(e,t,i,r,s=null){const a=r.createProgram();if(e.program=a,!a)throw new Error("Unable to create program");return r.attachShader(a,t),r.attachShader(a,i),r.linkProgram(a),e.context=r,e.vertexShader=t,e.fragmentShader=i,e.isParallelCompiled||this._finalizePipelineContext(e),a}_finalizePipelineContext(e){const t=e.context,i=e.vertexShader,r=e.fragmentShader,s=e.program;if(!t.getProgramParameter(s,t.LINK_STATUS)){if(!this._gl.getShaderParameter(i,this._gl.COMPILE_STATUS)){const o=this._gl.getShaderInfoLog(i);if(o)throw e.vertexCompilationError=o,new Error("VERTEX SHADER "+o)}if(!this._gl.getShaderParameter(r,this._gl.COMPILE_STATUS)){const o=this._gl.getShaderInfoLog(r);if(o)throw e.fragmentCompilationError=o,new Error("FRAGMENT SHADER "+o)}const l=t.getProgramInfoLog(s);if(l)throw e.programLinkError=l,new Error(l)}if(this.validateShaderPrograms&&(t.validateProgram(s),!t.getProgramParameter(s,t.VALIDATE_STATUS))){const o=t.getProgramInfoLog(s);if(o)throw e.programValidationError=o,new Error(o)}t.deleteShader(i),t.deleteShader(r),e.vertexShader=void 0,e.fragmentShader=void 0,e.onCompiled&&(e.onCompiled(),e.onCompiled=void 0)}_preparePipelineContext(e,t,i,r,s,a,l,o,c,u){const h=e;r?h.program=this.createRawShaderProgram(h,t,i,void 0,c):h.program=this.createShaderProgram(h,t,i,o,void 0,c),h.program.__SPECTOR_rebuildProgram=l}_isRenderingStateCompiled(e){const t=e;return this._isDisposed||t._isDisposed?!1:this._gl.getProgramParameter(t.program,this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)?(this._finalizePipelineContext(t),!0):!1}_executeWhenRenderingStateIsCompiled(e,t){const i=e;if(!i.isParallelCompiled){t();return}const r=i.onCompiled;r?i.onCompiled=()=>{r(),t()}:i.onCompiled=t}getUniforms(e,t){const i=new Array,r=e;for(let s=0;s<t.length;s++)i.push(this._gl.getUniformLocation(r.program,t[s]));return i}getAttributes(e,t){const i=[],r=e;for(let s=0;s<t.length;s++)try{i.push(this._gl.getAttribLocation(r.program,t[s]))}catch{i.push(-1)}return i}enableEffect(e){e=e!==null&&ec.IsWrapper(e)?e.effect:e,!(!e||e===this._currentEffect)&&(this._stencilStateComposer.stencilMaterial=void 0,e=e,this.bindSamplers(e),this._currentEffect=e,e.onBind&&e.onBind(e),e._onBindObservable&&e._onBindObservable.notifyObservers(e))}setInt(e,t){return e?(this._gl.uniform1i(e,t),!0):!1}setInt2(e,t,i){return e?(this._gl.uniform2i(e,t,i),!0):!1}setInt3(e,t,i,r){return e?(this._gl.uniform3i(e,t,i,r),!0):!1}setInt4(e,t,i,r,s){return e?(this._gl.uniform4i(e,t,i,r,s),!0):!1}setIntArray(e,t){return e?(this._gl.uniform1iv(e,t),!0):!1}setIntArray2(e,t){return!e||t.length%2!==0?!1:(this._gl.uniform2iv(e,t),!0)}setIntArray3(e,t){return!e||t.length%3!==0?!1:(this._gl.uniform3iv(e,t),!0)}setIntArray4(e,t){return!e||t.length%4!==0?!1:(this._gl.uniform4iv(e,t),!0)}setUInt(e,t){return e?(this._gl.uniform1ui(e,t),!0):!1}setUInt2(e,t,i){return e?(this._gl.uniform2ui(e,t,i),!0):!1}setUInt3(e,t,i,r){return e?(this._gl.uniform3ui(e,t,i,r),!0):!1}setUInt4(e,t,i,r,s){return e?(this._gl.uniform4ui(e,t,i,r,s),!0):!1}setUIntArray(e,t){return e?(this._gl.uniform1uiv(e,t),!0):!1}setUIntArray2(e,t){return!e||t.length%2!==0?!1:(this._gl.uniform2uiv(e,t),!0)}setUIntArray3(e,t){return!e||t.length%3!==0?!1:(this._gl.uniform3uiv(e,t),!0)}setUIntArray4(e,t){return!e||t.length%4!==0?!1:(this._gl.uniform4uiv(e,t),!0)}setArray(e,t){return!e||t.length<1?!1:(this._gl.uniform1fv(e,t),!0)}setArray2(e,t){return!e||t.length%2!==0?!1:(this._gl.uniform2fv(e,t),!0)}setArray3(e,t){return!e||t.length%3!==0?!1:(this._gl.uniform3fv(e,t),!0)}setArray4(e,t){return!e||t.length%4!==0?!1:(this._gl.uniform4fv(e,t),!0)}setMatrices(e,t){return e?(this._gl.uniformMatrix4fv(e,!1,t),!0):!1}setMatrix3x3(e,t){return e?(this._gl.uniformMatrix3fv(e,!1,t),!0):!1}setMatrix2x2(e,t){return e?(this._gl.uniformMatrix2fv(e,!1,t),!0):!1}setFloat(e,t){return e?(this._gl.uniform1f(e,t),!0):!1}setFloat2(e,t,i){return e?(this._gl.uniform2f(e,t,i),!0):!1}setFloat3(e,t,i,r){return e?(this._gl.uniform3f(e,t,i,r),!0):!1}setFloat4(e,t,i,r,s){return e?(this._gl.uniform4f(e,t,i,r,s),!0):!1}applyStates(){if(this._depthCullingState.apply(this._gl),this._stencilStateComposer.apply(this._gl),this._alphaState.apply(this._gl),this._colorWriteChanged){this._colorWriteChanged=!1;const e=this._colorWrite;this._gl.colorMask(e,e,e,e)}}setColorWrite(e){e!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=e)}getColorWrite(){return this._colorWrite}get depthCullingState(){return this._depthCullingState}get alphaState(){return this._alphaState}get stencilState(){return this._stencilState}get stencilStateComposer(){return this._stencilStateComposer}clearInternalTexturesCache(){this._internalTexturesCache.length=0}wipeCaches(e){this.preventCacheWipeBetweenFrames&&!e||(this._currentEffect=null,this._viewportCached.x=0,this._viewportCached.y=0,this._viewportCached.z=0,this._viewportCached.w=0,this._unbindVertexArrayObject(),e&&(this._currentProgram=null,this.resetTextureCache(),this._stencilStateComposer.reset(),this._depthCullingState.reset(),this._depthCullingState.depthFunc=this._gl.LEQUAL,this._alphaState.reset(),this._alphaMode=1,this._alphaEquation=0,this._colorWrite=!0,this._colorWriteChanged=!0,this._unpackFlipYCached=null,this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),this._mustWipeVertexAttributes=!0,this.unbindAllAttributes()),this._resetVertexBufferBinding(),this._cachedIndexBuffer=null,this._cachedEffectForVertexBuffers=null,this.bindIndexBuffer(null))}_getSamplingParameters(e,t){const i=this._gl;let r=i.NEAREST,s=i.NEAREST;switch(e){case 11:r=i.LINEAR,t?s=i.LINEAR_MIPMAP_NEAREST:s=i.LINEAR;break;case 3:r=i.LINEAR,t?s=i.LINEAR_MIPMAP_LINEAR:s=i.LINEAR;break;case 8:r=i.NEAREST,t?s=i.NEAREST_MIPMAP_LINEAR:s=i.NEAREST;break;case 4:r=i.NEAREST,t?s=i.NEAREST_MIPMAP_NEAREST:s=i.NEAREST;break;case 5:r=i.NEAREST,t?s=i.LINEAR_MIPMAP_NEAREST:s=i.LINEAR;break;case 6:r=i.NEAREST,t?s=i.LINEAR_MIPMAP_LINEAR:s=i.LINEAR;break;case 7:r=i.NEAREST,s=i.LINEAR;break;case 1:r=i.NEAREST,s=i.NEAREST;break;case 9:r=i.LINEAR,t?s=i.NEAREST_MIPMAP_NEAREST:s=i.NEAREST;break;case 10:r=i.LINEAR,t?s=i.NEAREST_MIPMAP_LINEAR:s=i.NEAREST;break;case 2:r=i.LINEAR,s=i.LINEAR;break;case 12:r=i.LINEAR,s=i.NEAREST;break}return{min:s,mag:r}}_createTexture(){const e=this._gl.createTexture();if(!e)throw new Error("Unable to create texture");return e}_createHardwareTexture(){return new s1(this._createTexture(),this._gl)}_createInternalTexture(e,t,i=!0,r=Xt.Unknown){let s=!1,a=0,l=3,o=5,c=!1,u=1,h;t!==void 0&&typeof t=="object"?(s=!!t.generateMipMaps,a=t.type===void 0?0:t.type,l=t.samplingMode===void 0?3:t.samplingMode,o=t.format===void 0?5:t.format,c=t.useSRGBBuffer===void 0?!1:t.useSRGBBuffer,u=t.samples??1,h=t.label):s=!!t,c&&(c=this._caps.supportSRGBBuffers&&(this.webGLVersion>1||this.isWebGPU)),(a===1&&!this._caps.textureFloatLinearFiltering||a===2&&!this._caps.textureHalfFloatLinearFiltering)&&(l=1),a===1&&!this._caps.textureFloat&&(a=0,ee.Warn("Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE"));const d=this._gl,f=new Qr(this,r),_=e.width||e,p=e.height||e,v=e.layers||0,E=this._getSamplingParameters(l,s),g=v!==0?d.TEXTURE_2D_ARRAY:d.TEXTURE_2D,m=this._getRGBABufferInternalSizedFormat(a,o,c),y=this._getInternalFormat(o),T=this._getWebGLTextureType(a);return this._bindTextureDirectly(g,f),v!==0?(f.is2DArray=!0,d.texImage3D(g,0,m,_,p,v,0,y,T,null)):d.texImage2D(g,0,m,_,p,0,y,T,null),d.texParameteri(g,d.TEXTURE_MAG_FILTER,E.mag),d.texParameteri(g,d.TEXTURE_MIN_FILTER,E.min),d.texParameteri(g,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(g,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),s&&this._gl.generateMipmap(g),this._bindTextureDirectly(g,null),f._useSRGBBuffer=c,f.baseWidth=_,f.baseHeight=p,f.width=_,f.height=p,f.depth=v,f.isReady=!0,f.samples=u,f.generateMipMaps=s,f.samplingMode=l,f.type=a,f.format=o,f.label=h,this._internalTexturesCache.push(f),f}_getUseSRGBBuffer(e,t){return e&&this._caps.supportSRGBBuffers&&(this.webGLVersion>1||this.isWebGPU||t)}_createTextureBase(e,t,i,r,s=3,a=null,l=null,o,c,u=null,h=null,d=null,f=null,_,p,v){e=e||"";const E=e.substr(0,5)==="data:",g=e.substr(0,5)==="blob:",m=E&&e.indexOf(";base64,")!==-1,y=h||new Qr(this,Xt.Url);y!==h&&(y.label=e.substring(0,60));const T=e;this._transformTextureUrl&&!m&&!h&&!u&&(e=this._transformTextureUrl(e)),T!==e&&(y._originalUrl=T);const b=e.lastIndexOf(".");let C=f||(b>-1?e.substring(b).toLowerCase():""),M=null;C.indexOf("?")>-1&&(C=C.split("?")[0]);for(const G of we._TextureLoaders)if(G.canLoad(C,_)){M=G;break}r&&r.addPendingData(y),y.url=e,y.generateMipMaps=!t,y.samplingMode=s,y.invertY=i,y._useSRGBBuffer=this._getUseSRGBBuffer(!!v,t),this._doNotHandleContextLost||(y._buffer=u);let P=null;a&&!h&&(P=y.onLoadedObservable.add(a)),h||this._internalTexturesCache.push(y);const U=(G,K)=>{r&&r.removePendingData(y),e===T?(P&&y.onLoadedObservable.remove(P),He.UseFallbackTexture&&e!==He.FallbackTexture&&this._createTextureBase(He.FallbackTexture,t,y.invertY,r,s,null,l,o,c,u,y),G=(G||"Unknown error")+(He.UseFallbackTexture?" - Fallback texture was used":""),y.onErrorObservable.notifyObservers({message:G,exception:K}),l&&l(G,K)):(ee.Warn(`Failed to load ${e}, falling back to ${T}`),this._createTextureBase(T,t,y.invertY,r,s,a,l,o,c,u,y,d,f,_,p,v))};if(M){const G=K=>{M.loadData(K,y,(q,se,Ee,Se,$,_e)=>{_e?U("TextureLoader failed to load data"):o(y,C,r,{width:q,height:se},y.invertY,!Ee,Se,()=>($(),!1),s)},p)};u?u instanceof ArrayBuffer?G(new Uint8Array(u)):ArrayBuffer.isView(u)?G(u):l&&l("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(e,K=>G(new Uint8Array(K)),void 0,r?r.offlineProvider:void 0,!0,(K,q)=>{U("Unable to load "+(K&&K.responseURL,q))})}else{const G=K=>{g&&!this._doNotHandleContextLost&&(y._buffer=K),o(y,C,r,K,y.invertY,t,!1,c,s)};!E||m?u&&(typeof u.decoding=="string"||u.close)?G(u):we._FileToolsLoadImage(e,G,U,r?r.offlineProvider:null,_,y.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):typeof u=="string"||u instanceof ArrayBuffer||ArrayBuffer.isView(u)||u instanceof Blob?we._FileToolsLoadImage(u,G,U,r?r.offlineProvider:null,_,y.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):u&&G(u)}return y}createTexture(e,t,i,r,s=3,a=null,l=null,o=null,c=null,u=null,h=null,d,f,_,p){return this._createTextureBase(e,t,i,r,s,a,l,this._prepareWebGLTexture.bind(this),(v,E,g,m,y,T)=>{const b=this._gl,C=g.width===v&&g.height===E;y._creationFlags=_??0;const M=this._getTexImageParametersForCreateTexture(u,m,y._useSRGBBuffer);if(C)return b.texImage2D(b.TEXTURE_2D,0,M.internalFormat,M.format,M.type,g),!1;const F=this._caps.maxTextureSize;if(g.width>F||g.height>F||!this._supportsHardwareTextureRescaling)return this._prepareWorkingCanvas(),!this._workingCanvas||!this._workingContext||(this._workingCanvas.width=v,this._workingCanvas.height=E,this._workingContext.drawImage(g,0,0,g.width,g.height,0,0,v,E),b.texImage2D(b.TEXTURE_2D,0,M.internalFormat,M.format,M.type,this._workingCanvas),y.width=v,y.height=E),!1;{const P=new Qr(this,Xt.Temp);this._bindTextureDirectly(b.TEXTURE_2D,P,!0),b.texImage2D(b.TEXTURE_2D,0,M.internalFormat,M.format,M.type,g),this._rescaleTexture(P,y,r,M.format,()=>{this._releaseTexture(P),this._bindTextureDirectly(b.TEXTURE_2D,y,!0),T()})}return!0},o,c,u,h,d,f,p)}_getTexImageParametersForCreateTexture(e,t,i){e==null&&(e=t===".jpg"&&!i?4:5);let r,s;return this.webGLVersion===1?(r=this._getInternalFormat(e,i),s=r):(r=this._getInternalFormat(e,!1),s=this._getRGBABufferInternalSizedFormat(0,e,i)),{internalFormat:s,format:r,type:this._gl.UNSIGNED_BYTE}}static _FileToolsLoadImage(e,t,i,r,s,a){throw ke("FileTools")}_rescaleTexture(e,t,i,r,s){}createRawTexture(e,t,i,r,s,a,l,o=null,c=0,u=0,h=!1){throw ke("Engine.RawTexture")}createRawCubeTexture(e,t,i,r,s,a,l,o=null){throw ke("Engine.RawTexture")}createRawTexture3D(e,t,i,r,s,a,l,o,c=null,u=0){throw ke("Engine.RawTexture")}createRawTexture2DArray(e,t,i,r,s,a,l,o,c=null,u=0){throw ke("Engine.RawTexture")}_unpackFlipY(e){this._unpackFlipYCached!==e&&(this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,e?1:0),this.enableUnpackFlipYCached&&(this._unpackFlipYCached=e))}_getUnpackAlignement(){return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT)}_getTextureTarget(e){return e.isCube?this._gl.TEXTURE_CUBE_MAP:e.is3D?this._gl.TEXTURE_3D:e.is2DArray||e.isMultiview?this._gl.TEXTURE_2D_ARRAY:this._gl.TEXTURE_2D}updateTextureSamplingMode(e,t,i=!1){const r=this._getTextureTarget(t),s=this._getSamplingParameters(e,t.useMipMaps||i);this._setTextureParameterInteger(r,this._gl.TEXTURE_MAG_FILTER,s.mag,t),this._setTextureParameterInteger(r,this._gl.TEXTURE_MIN_FILTER,s.min),i&&(t.generateMipMaps=!0,this._gl.generateMipmap(r)),this._bindTextureDirectly(r,null),t.samplingMode=e}updateTextureDimensions(e,t,i,r=1){}updateTextureWrappingMode(e,t,i=null,r=null){const s=this._getTextureTarget(e);t!==null&&(this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t),e),e._cachedWrapU=t),i!==null&&(this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(i),e),e._cachedWrapV=i),(e.is2DArray||e.is3D)&&r!==null&&(this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(r),e),e._cachedWrapR=r),this._bindTextureDirectly(s,null)}_setupDepthStencilTexture(e,t,i,r,s,a=1){const l=t.width||t,o=t.height||t,c=t.layers||0;e.baseWidth=l,e.baseHeight=o,e.width=l,e.height=o,e.is2DArray=c>0,e.depth=c,e.isReady=!0,e.samples=a,e.generateMipMaps=!1,e.samplingMode=r?2:1,e.type=0,e._comparisonFunction=s;const u=this._gl,h=this._getTextureTarget(e),d=this._getSamplingParameters(e.samplingMode,!1);u.texParameteri(h,u.TEXTURE_MAG_FILTER,d.mag),u.texParameteri(h,u.TEXTURE_MIN_FILTER,d.min),u.texParameteri(h,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(h,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),this.webGLVersion>1&&(s===0?(u.texParameteri(h,u.TEXTURE_COMPARE_FUNC,515),u.texParameteri(h,u.TEXTURE_COMPARE_MODE,u.NONE)):(u.texParameteri(h,u.TEXTURE_COMPARE_FUNC,s),u.texParameteri(h,u.TEXTURE_COMPARE_MODE,u.COMPARE_REF_TO_TEXTURE)))}_uploadCompressedDataToTextureDirectly(e,t,i,r,s,a=0,l=0){const o=this._gl;let c=o.TEXTURE_2D;if(e.isCube&&(c=o.TEXTURE_CUBE_MAP_POSITIVE_X+a),e._useSRGBBuffer)switch(t){case 37492:case 36196:this._caps.etc2?t=o.COMPRESSED_SRGB8_ETC2:e._useSRGBBuffer=!1;break;case 37496:this._caps.etc2?t=o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:e._useSRGBBuffer=!1;break;case 36492:t=o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;break;case 37808:t=o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;break;case 33776:this._caps.s3tc_srgb?t=o.COMPRESSED_SRGB_S3TC_DXT1_EXT:e._useSRGBBuffer=!1;break;case 33777:this._caps.s3tc_srgb?t=o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:e._useSRGBBuffer=!1;break;case 33779:this._caps.s3tc_srgb?t=o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:e._useSRGBBuffer=!1;break;default:e._useSRGBBuffer=!1;break}this._gl.compressedTexImage2D(c,l,t,i,r,0,s)}_uploadDataToTextureDirectly(e,t,i=0,r=0,s,a=!1){const l=this._gl,o=this._getWebGLTextureType(e.type),c=this._getInternalFormat(e.format),u=s===void 0?this._getRGBABufferInternalSizedFormat(e.type,e.format,e._useSRGBBuffer):this._getInternalFormat(s,e._useSRGBBuffer);this._unpackFlipY(e.invertY);let h=l.TEXTURE_2D;e.isCube&&(h=l.TEXTURE_CUBE_MAP_POSITIVE_X+i);const d=Math.round(Math.log(e.width)*Math.LOG2E),f=Math.round(Math.log(e.height)*Math.LOG2E),_=a?e.width:Math.pow(2,Math.max(d-r,0)),p=a?e.height:Math.pow(2,Math.max(f-r,0));l.texImage2D(h,r,u,_,p,0,c,o,t)}updateTextureData(e,t,i,r,s,a,l=0,o=0,c=!1){const u=this._gl,h=this._getWebGLTextureType(e.type),d=this._getInternalFormat(e.format);this._unpackFlipY(e.invertY);let f=u.TEXTURE_2D,_=u.TEXTURE_2D;e.isCube&&(_=u.TEXTURE_CUBE_MAP_POSITIVE_X+l,f=u.TEXTURE_CUBE_MAP),this._bindTextureDirectly(f,e,!0),u.texSubImage2D(_,o,i,r,s,a,d,h,t),c&&this._gl.generateMipmap(_),this._bindTextureDirectly(f,null)}_uploadArrayBufferViewToTexture(e,t,i=0,r=0){const s=this._gl,a=e.isCube?s.TEXTURE_CUBE_MAP:s.TEXTURE_2D;this._bindTextureDirectly(a,e,!0),this._uploadDataToTextureDirectly(e,t,i,r),this._bindTextureDirectly(a,null,!0)}_prepareWebGLTextureContinuation(e,t,i,r,s){const a=this._gl;if(!a)return;const l=this._getSamplingParameters(s,!i);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,l.mag),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,l.min),!i&&!r&&a.generateMipmap(a.TEXTURE_2D),this._bindTextureDirectly(a.TEXTURE_2D,null),t&&t.removePendingData(e),e.onLoadedObservable.notifyObservers(e),e.onLoadedObservable.clear()}_prepareWebGLTexture(e,t,i,r,s,a,l,o,c=3){const u=this.getCaps().maxTextureSize,h=Math.min(u,this.needPOTTextures?we.GetExponentOfTwo(r.width,u):r.width),d=Math.min(u,this.needPOTTextures?we.GetExponentOfTwo(r.height,u):r.height),f=this._gl;if(f){if(!e._hardwareTexture){i&&i.removePendingData(e);return}this._bindTextureDirectly(f.TEXTURE_2D,e,!0),this._unpackFlipY(s===void 0?!0:!!s),e.baseWidth=r.width,e.baseHeight=r.height,e.width=h,e.height=d,e.isReady=!0,e.type=e.type!==-1?e.type:0,e.format=e.format!==-1?e.format:t===".jpg"&&!e._useSRGBBuffer?4:5,!o(h,d,r,t,e,()=>{this._prepareWebGLTextureContinuation(e,i,a,l,c)})&&this._prepareWebGLTextureContinuation(e,i,a,l,c)}}_setupFramebufferDepthAttachments(e,t,i,r,s=1){const a=this._gl;if(e&&t)return this._createRenderBuffer(i,r,s,a.DEPTH_STENCIL,a.DEPTH24_STENCIL8,a.DEPTH_STENCIL_ATTACHMENT);if(t){let l=a.DEPTH_COMPONENT16;return this._webGLVersion>1&&(l=a.DEPTH_COMPONENT32F),this._createRenderBuffer(i,r,s,l,l,a.DEPTH_ATTACHMENT)}return e?this._createRenderBuffer(i,r,s,a.STENCIL_INDEX8,a.STENCIL_INDEX8,a.STENCIL_ATTACHMENT):null}_createRenderBuffer(e,t,i,r,s,a,l=!0){const c=this._gl.createRenderbuffer();return this._updateRenderBuffer(c,e,t,i,r,s,a,l)}_updateRenderBuffer(e,t,i,r,s,a,l,o=!0){const c=this._gl;return c.bindRenderbuffer(c.RENDERBUFFER,e),r>1&&c.renderbufferStorageMultisample?c.renderbufferStorageMultisample(c.RENDERBUFFER,r,a,t,i):c.renderbufferStorage(c.RENDERBUFFER,s,t,i),c.framebufferRenderbuffer(c.FRAMEBUFFER,l,c.RENDERBUFFER,e),o&&c.bindRenderbuffer(c.RENDERBUFFER,null),e}_releaseTexture(e){var i;this._deleteTexture((i=e._hardwareTexture)==null?void 0:i.underlyingResource),this.unbindAllTextures();const t=this._internalTexturesCache.indexOf(e);t!==-1&&this._internalTexturesCache.splice(t,1),e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureLow&&e._lodTextureLow.dispose(),e._irradianceTexture&&e._irradianceTexture.dispose()}_releaseRenderTargetWrapper(e){const t=this._renderTargetWrapperCache.indexOf(e);t!==-1&&this._renderTargetWrapperCache.splice(t,1)}_deleteTexture(e){e&&this._gl.deleteTexture(e)}_setProgram(e){this._currentProgram!==e&&(this._gl.useProgram(e),this._currentProgram=e)}bindSamplers(e){const t=e.getPipelineContext();this._setProgram(t.program);const i=e.getSamplers();for(let r=0;r<i.length;r++){const s=e.getUniform(i[r]);s&&(this._boundUniforms[r]=s)}this._currentEffect=null}_activateCurrentTexture(){this._currentTextureChannel!==this._activeChannel&&(this._gl.activeTexture(this._gl.TEXTURE0+this._activeChannel),this._currentTextureChannel=this._activeChannel)}_bindTextureDirectly(e,t,i=!1,r=!1){var o;let s=!1;const a=t&&t._associatedChannel>-1;if(i&&a&&(this._activeChannel=t._associatedChannel),this._boundTexturesCache[this._activeChannel]!==t||r){if(this._activateCurrentTexture(),t&&t.isMultiview)throw ee.Error(["_bindTextureDirectly called with a multiview texture!",e,t]),"_bindTextureDirectly called with a multiview texture!";this._gl.bindTexture(e,((o=t==null?void 0:t._hardwareTexture)==null?void 0:o.underlyingResource)??null),this._boundTexturesCache[this._activeChannel]=t,t&&(t._associatedChannel=this._activeChannel)}else i&&(s=!0,this._activateCurrentTexture());return a&&!i&&this._bindSamplerUniformToChannel(t._associatedChannel,this._activeChannel),s}_bindTexture(e,t,i){if(e===void 0)return;t&&(t._associatedChannel=e),this._activeChannel=e;const r=t?this._getTextureTarget(t):this._gl.TEXTURE_2D;this._bindTextureDirectly(r,t)}unbindAllTextures(){for(let e=0;e<this._maxSimultaneousTextures;e++)this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))}setTexture(e,t,i,r){e!==void 0&&(t&&(this._boundUniforms[e]=t),this._setTexture(e,i))}_bindSamplerUniformToChannel(e,t){const i=this._boundUniforms[e];!i||i._currentState===t||(this._gl.uniform1i(i,t),i._currentState=t)}_getTextureWrapMode(e){switch(e){case 1:return this._gl.REPEAT;case 0:return this._gl.CLAMP_TO_EDGE;case 2:return this._gl.MIRRORED_REPEAT}return this._gl.REPEAT}_setTexture(e,t,i=!1,r=!1,s=""){if(!t)return this._boundTexturesCache[e]!=null&&(this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))),!1;if(t.video){this._activeChannel=e;const c=t.getInternalTexture();c&&(c._associatedChannel=e),t.update()}else if(t.delayLoadState===4)return t.delayLoad(),!1;let a;r?a=t.depthStencilTexture:t.isReady()?a=t.getInternalTexture():t.isCube?a=this.emptyCubeTexture:t.is3D?a=this.emptyTexture3D:t.is2DArray?a=this.emptyTexture2DArray:a=this.emptyTexture,!i&&a&&(a._associatedChannel=e);let l=!0;this._boundTexturesCache[e]===a&&(i||this._bindSamplerUniformToChannel(a._associatedChannel,e),l=!1),this._activeChannel=e;const o=this._getTextureTarget(a);if(l&&this._bindTextureDirectly(o,a,i),a&&!a.isMultiview){if(a.isCube&&a._cachedCoordinatesMode!==t.coordinatesMode){a._cachedCoordinatesMode=t.coordinatesMode;const c=t.coordinatesMode!==3&&t.coordinatesMode!==5?1:0;t.wrapU=c,t.wrapV=c}a._cachedWrapU!==t.wrapU&&(a._cachedWrapU=t.wrapU,this._setTextureParameterInteger(o,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t.wrapU),a)),a._cachedWrapV!==t.wrapV&&(a._cachedWrapV=t.wrapV,this._setTextureParameterInteger(o,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(t.wrapV),a)),a.is3D&&a._cachedWrapR!==t.wrapR&&(a._cachedWrapR=t.wrapR,this._setTextureParameterInteger(o,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(t.wrapR),a)),this._setAnisotropicLevel(o,a,t.anisotropicFilteringLevel)}return!0}setTextureArray(e,t,i,r){if(!(e===void 0||!t)){(!this._textureUnits||this._textureUnits.length!==i.length)&&(this._textureUnits=new Int32Array(i.length));for(let s=0;s<i.length;s++){const a=i[s].getInternalTexture();a?(this._textureUnits[s]=e+s,a._associatedChannel=e+s):this._textureUnits[s]=-1}this._gl.uniform1iv(t,this._textureUnits);for(let s=0;s<i.length;s++)this._setTexture(this._textureUnits[s],i[s],!0)}}_setAnisotropicLevel(e,t,i){const r=this._caps.textureAnisotropicFilterExtension;t.samplingMode!==11&&t.samplingMode!==3&&t.samplingMode!==2&&(i=1),r&&t._cachedAnisotropicFilteringLevel!==i&&(this._setTextureParameterFloat(e,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i,this._caps.maxAnisotropy),t),t._cachedAnisotropicFilteringLevel=i)}_setTextureParameterFloat(e,t,i,r){this._bindTextureDirectly(e,r,!0,!0),this._gl.texParameterf(e,t,i)}_setTextureParameterInteger(e,t,i,r){r&&this._bindTextureDirectly(e,r,!0,!0),this._gl.texParameteri(e,t,i)}unbindAllAttributes(){if(this._mustWipeVertexAttributes){this._mustWipeVertexAttributes=!1;for(let e=0;e<this._caps.maxVertexAttribs;e++)this.disableAttributeByIndex(e);return}for(let e=0,t=this._vertexAttribArraysEnabled.length;e<t;e++)e>=this._caps.maxVertexAttribs||!this._vertexAttribArraysEnabled[e]||this.disableAttributeByIndex(e)}releaseEffects(){for(const e in this._compiledEffects){const t=this._compiledEffects[e].getPipelineContext();this._deletePipelineContext(t)}this._compiledEffects={}}dispose(){var e,t;this._isDisposed=!0,this.stopRenderLoop(),this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._dummyFramebuffer&&this._gl.deleteFramebuffer(this._dummyFramebuffer),this.releaseEffects(),(e=this.releaseComputeEffects)==null||e.call(this),this.unbindAllAttributes(),this._boundUniforms={},Ui()&&this._renderingCanvas&&(this._doNotHandleContextLost||(this._renderingCanvas.removeEventListener("webglcontextlost",this._onContextLost),this._renderingCanvas.removeEventListener("webglcontextrestored",this._onContextRestored)),window.removeEventListener("resize",this._checkForMobile)),this._workingCanvas=null,this._workingContext=null,this._currentBufferPointers.length=0,this._renderingCanvas=null,this._currentProgram=null,this._boundRenderFunction=null,_r.ResetCache();for(const i of this._activeRequests)i.abort();this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this._creationOptions.loseContextOnDispose&&((t=this._gl.getExtension("WEBGL_lose_context"))==null||t.loseContext())}attachContextLostEvent(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextlost",e,!1)}attachContextRestoredEvent(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextrestored",e,!1)}getError(){return this._gl.getError()}_canRenderToFloatFramebuffer(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(1)}_canRenderToHalfFloatFramebuffer(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(2)}_canRenderToFramebuffer(e){const t=this._gl;for(;t.getError()!==t.NO_ERROR;);let i=!0;const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(e),1,1,0,t.RGBA,this._getWebGLTextureType(e),null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER);if(i=i&&a===t.FRAMEBUFFER_COMPLETE,i=i&&t.getError()===t.NO_ERROR,i&&(t.clear(t.COLOR_BUFFER_BIT),i=i&&t.getError()===t.NO_ERROR),i){t.bindFramebuffer(t.FRAMEBUFFER,null);const l=t.RGBA,o=t.UNSIGNED_BYTE,c=new Uint8Array(4);t.readPixels(0,0,1,1,l,o,c),i=i&&t.getError()===t.NO_ERROR}for(t.deleteTexture(r),t.deleteFramebuffer(s),t.bindFramebuffer(t.FRAMEBUFFER,null);!i&&t.getError()!==t.NO_ERROR;);return i}_getWebGLTextureType(e){if(this._webGLVersion===1){switch(e){case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT_OES;case 0:return this._gl.UNSIGNED_BYTE;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5}return this._gl.UNSIGNED_BYTE}switch(e){case 3:return this._gl.BYTE;case 0:return this._gl.UNSIGNED_BYTE;case 4:return this._gl.SHORT;case 5:return this._gl.UNSIGNED_SHORT;case 6:return this._gl.INT;case 7:return this._gl.UNSIGNED_INT;case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5;case 11:return this._gl.UNSIGNED_INT_2_10_10_10_REV;case 12:return this._gl.UNSIGNED_INT_24_8;case 13:return this._gl.UNSIGNED_INT_10F_11F_11F_REV;case 14:return this._gl.UNSIGNED_INT_5_9_9_9_REV;case 15:return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV}return this._gl.UNSIGNED_BYTE}_getInternalFormat(e,t=!1){let i=t?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA;switch(e){case 0:i=this._gl.ALPHA;break;case 1:i=this._gl.LUMINANCE;break;case 2:i=this._gl.LUMINANCE_ALPHA;break;case 6:i=this._gl.RED;break;case 7:i=this._gl.RG;break;case 4:i=t?this._glSRGBExtensionValues.SRGB:this._gl.RGB;break;case 5:i=t?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA;break}if(this._webGLVersion>1)switch(e){case 8:i=this._gl.RED_INTEGER;break;case 9:i=this._gl.RG_INTEGER;break;case 10:i=this._gl.RGB_INTEGER;break;case 11:i=this._gl.RGBA_INTEGER;break}return i}_getRGBABufferInternalSizedFormat(e,t,i=!1){if(this._webGLVersion===1){if(t!==void 0)switch(t){case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;case 4:return i?this._glSRGBExtensionValues.SRGB:this._gl.RGB}return this._gl.RGBA}switch(e){case 3:switch(t){case 6:return this._gl.R8_SNORM;case 7:return this._gl.RG8_SNORM;case 4:return this._gl.RGB8_SNORM;case 8:return this._gl.R8I;case 9:return this._gl.RG8I;case 10:return this._gl.RGB8I;case 11:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case 0:switch(t){case 6:return this._gl.R8;case 7:return this._gl.RG8;case 4:return i?this._glSRGBExtensionValues.SRGB8:this._gl.RGB8;case 5:return i?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA8;case 8:return this._gl.R8UI;case 9:return this._gl.RG8UI;case 10:return this._gl.RGB8UI;case 11:return this._gl.RGBA8UI;case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case 4:switch(t){case 8:return this._gl.R16I;case 9:return this._gl.RG16I;case 10:return this._gl.RGB16I;case 11:return this._gl.RGBA16I;default:return this._gl.RGBA16I}case 5:switch(t){case 8:return this._gl.R16UI;case 9:return this._gl.RG16UI;case 10:return this._gl.RGB16UI;case 11:return this._gl.RGBA16UI;default:return this._gl.RGBA16UI}case 6:switch(t){case 8:return this._gl.R32I;case 9:return this._gl.RG32I;case 10:return this._gl.RGB32I;case 11:return this._gl.RGBA32I;default:return this._gl.RGBA32I}case 7:switch(t){case 8:return this._gl.R32UI;case 9:return this._gl.RG32UI;case 10:return this._gl.RGB32UI;case 11:return this._gl.RGBA32UI;default:return this._gl.RGBA32UI}case 1:switch(t){case 6:return this._gl.R32F;case 7:return this._gl.RG32F;case 4:return this._gl.RGB32F;case 5:return this._gl.RGBA32F;default:return this._gl.RGBA32F}case 2:switch(t){case 6:return this._gl.R16F;case 7:return this._gl.RG16F;case 4:return this._gl.RGB16F;case 5:return this._gl.RGBA16F;default:return this._gl.RGBA16F}case 10:return this._gl.RGB565;case 13:return this._gl.R11F_G11F_B10F;case 14:return this._gl.RGB9_E5;case 8:return this._gl.RGBA4;case 9:return this._gl.RGB5_A1;case 11:switch(t){case 5:return this._gl.RGB10_A2;case 11:return this._gl.RGB10_A2UI;default:return this._gl.RGB10_A2}}return i?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA8}_loadFile(e,t,i,r,s,a){const l=we._FileToolsLoadFile(e,t,i,r,s,a);return this._activeRequests.push(l),l.onCompleteObservable.add(o=>{this._activeRequests.splice(this._activeRequests.indexOf(o),1)}),l}static _FileToolsLoadFile(e,t,i,r,s,a){throw ke("FileTools")}readPixels(e,t,i,r,s=!0,a=!0){const l=s?4:3,o=s?this._gl.RGBA:this._gl.RGB,c=new Uint8Array(r*i*l);return a&&this.flushFramebuffer(),this._gl.readPixels(e,t,i,r,o,this._gl.UNSIGNED_BYTE,c),Promise.resolve(c)}static get IsSupportedAsync(){return Promise.resolve(this.isSupported())}static get IsSupported(){return this.isSupported()}static isSupported(){if(this._HasMajorPerformanceCaveat!==null)return!this._HasMajorPerformanceCaveat;if(this._IsSupported===null)try{const e=this._CreateCanvas(1,1),t=e.getContext("webgl")||e.getContext("experimental-webgl");this._IsSupported=t!=null&&!!window.WebGLRenderingContext}catch{this._IsSupported=!1}return this._IsSupported}static get HasMajorPerformanceCaveat(){if(this._HasMajorPerformanceCaveat===null)try{const e=this._CreateCanvas(1,1),t=e.getContext("webgl",{failIfMajorPerformanceCaveat:!0})||e.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0});this._HasMajorPerformanceCaveat=!t}catch{this._HasMajorPerformanceCaveat=!1}return this._HasMajorPerformanceCaveat}static CeilingPOT(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e}static FloorPOT(e){return e=e|e>>1,e=e|e>>2,e=e|e>>4,e=e|e>>8,e=e|e>>16,e-(e>>1)}static NearestPOT(e){const t=we.CeilingPOT(e),i=we.FloorPOT(e);return t-e>e-i?i:t}static GetExponentOfTwo(e,t,i=2){let r;switch(i){case 1:r=we.FloorPOT(e);break;case 2:r=we.NearestPOT(e);break;case 3:default:r=we.CeilingPOT(e);break}return Math.min(r,t)}static QueueNewFrame(e,t){if(Ui()){const{requestAnimationFrame:i}=t||window;if(typeof i=="function")return i(e)}else if(typeof requestAnimationFrame=="function")return requestAnimationFrame(e);return setTimeout(e,16)}getHostDocument(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:Vc()?document:null}}we._TempClearColorUint32=new Uint32Array(4);we._TempClearColorInt32=new Int32Array(4);we.ExceptionList=[{key:"Chrome/63.0",capture:"63\\.0\\.3239\\.(\\d+)",captureConstraint:108,targets:["uniformBuffer"]},{key:"Firefox/58",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Firefox/59",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/72.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/73.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/74.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/71",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/72",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/12\\d\\..+?Mobile",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:".*AppleWebKit.*(15.4).*Safari",capture:null,captureConstraint:null,targets:["antialias","maxMSAASamples"]},{key:".*(15.4).*AppleWebKit.*Safari",capture:null,captureConstraint:null,targets:["antialias","maxMSAASamples"]}];we._TextureLoaders=[];we.CollisionsEpsilon=.001;we._IsSupported=null;we._HasMajorPerformanceCaveat=null;class $h{static SetImmediate(e){Ui()&&window.setImmediate?window.setImmediate(e):setTimeout(e,1)}}const a1=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i);class Qh extends ws{constructor(e,t){super(e,vo.LoadFileError),this.name="LoadFileError",Bl._setPrototypeOf(this,Qh.prototype),t instanceof wi?this.request=t:this.file=t}}class Zh extends ws{constructor(e,t){super(e,vo.RequestFileError),this.request=t,this.name="RequestFileError",Bl._setPrototypeOf(this,Zh.prototype)}}class um extends ws{constructor(e,t){super(e,vo.ReadFileError),this.file=t,this.name="ReadFileError",Bl._setPrototypeOf(this,um.prototype)}}const vi={DefaultRetryStrategy:iN.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:n=>n,ScriptBaseUrl:"",ScriptPreprocessUrl:n=>n},o1=n=>(n=n.replace(/#/gm,"%23"),n),hm=(n,e)=>{if(!(n&&n.indexOf("data:")===0)&&vi.CorsBehavior)if(typeof vi.CorsBehavior=="string"||vi.CorsBehavior instanceof String)e.crossOrigin=vi.CorsBehavior;else{const t=vi.CorsBehavior(n);t&&(e.crossOrigin=t)}},dm=(n,e,t,i,r="",s)=>{const a=He.LastCreatedEngine;if(typeof HTMLImageElement>"u"&&!(a!=null&&a._features.forceBitmapOverHTMLImageElement))return t("LoadImage is only supported in web or BabylonNative environments."),null;let l,o=!1;n instanceof ArrayBuffer||ArrayBuffer.isView(n)?typeof Blob<"u"&&typeof URL<"u"?(l=URL.createObjectURL(new Blob([n],{type:r})),o=!0):l=`data:${r};base64,`+i1(n):n instanceof Blob?(l=URL.createObjectURL(n),o=!0):(l=o1(n),l=vi.PreprocessUrl(n));const c=T=>{if(t){const b=l||n.toString();t(`Error while trying to load image: ${b.indexOf("http")===0||b.length<=128?b:b.slice(0,128)+"..."}`,T)}};if(a!=null&&a._features.forceBitmapOverHTMLImageElement)return Da(l,T=>{a.createImageBitmap(new Blob([T],{type:r}),{premultiplyAlpha:"none",...s}).then(b=>{e(b),o&&URL.revokeObjectURL(l)}).catch(b=>{t&&t("Error while trying to load image: "+n,b)})},void 0,i||void 0,!0,(T,b)=>{c(b)}),null;const u=new Image;hm(l,u);const h=[],d=()=>{h.forEach(T=>{T.target.addEventListener(T.name,T.handler)})},f=()=>{h.forEach(T=>{T.target.removeEventListener(T.name,T.handler)}),h.length=0},_=()=>{f(),e(u),o&&u.src&&URL.revokeObjectURL(u.src)},p=T=>{f(),c(T),o&&u.src&&URL.revokeObjectURL(u.src)},v=T=>{if(T.blockedURI!==u.src)return;f();const b=new Error(`CSP violation of policy ${T.effectiveDirective} ${T.blockedURI}. Current policy is ${T.originalPolicy}`);He.UseFallbackTexture=!1,c(b),o&&u.src&&URL.revokeObjectURL(u.src),u.src=""};h.push({target:u,name:"load",handler:_}),h.push({target:u,name:"error",handler:p}),h.push({target:document,name:"securitypolicyviolation",handler:v}),d();const E=l.substring(0,5)==="blob:",g=l.substring(0,5)==="data:",m=()=>{E||g||!wi.IsCustomRequestAvailable?u.src=l:Da(l,(T,b,C)=>{const M=!r&&C?C:r,F=new Blob([T],{type:M}),P=URL.createObjectURL(F);o=!0,u.src=P},void 0,i||void 0,!0,(T,b)=>{c(b)})},y=()=>{i&&i.loadImage(l,u)};if(!E&&!g&&i&&i.enableTexturesOffline)i.open(y,m);else{if(l.indexOf("file:")!==-1){const T=decodeURIComponent(l.substring(5).toLowerCase());if(Gc.FilesToLoad[T]&&typeof URL<"u"){try{let b;try{b=URL.createObjectURL(Gc.FilesToLoad[T])}catch{b=URL.createObjectURL(Gc.FilesToLoad[T])}u.src=b,o=!0}catch{u.src=""}return u}}m()}return u},su=(n,e,t,i,r)=>{const s=new FileReader,a={onCompleteObservable:new Y,abort:()=>s.abort()};return s.onloadend=()=>a.onCompleteObservable.notifyObservers(a),r&&(s.onerror=()=>{r(new um(`Unable to read ${n.name}`,n))}),s.onload=l=>{e(l.target.result)},t&&(s.onprogress=t),i?s.readAsArrayBuffer(n):s.readAsText(n),a},Da=(n,e,t,i,r,s,a)=>{if(n.name)return su(n,e,t,r,s?u=>{s(void 0,u)}:void 0);const l=n;if(l.indexOf("file:")!==-1){let u=decodeURIComponent(l.substring(5).toLowerCase());u.indexOf("./")===0&&(u=u.substring(2));const h=Gc.FilesToLoad[u];if(h)return su(h,e,t,r,s?d=>s(void 0,new Qh(d.message,d.file)):void 0)}const{match:o,type:c}=bN(l);if(o){const u={onCompleteObservable:new Y,abort:()=>()=>{}};try{const h=r?pm(l):c1(l);e(h,void 0,c)}catch(h){s?s(void 0,h):ee.Error(h.message||"Failed to parse the Data URL")}return $h.SetImmediate(()=>{u.onCompleteObservable.notifyObservers(u)}),u}return fm(l,(u,h)=>{e(u,h==null?void 0:h.responseURL,h==null?void 0:h.getResponseHeader("content-type"))},t,i,r,s?u=>{s(u.request,new Qh(u.message,u.request))}:void 0,a)},fm=(n,e,t,i,r,s,a)=>{n=o1(n),n=vi.PreprocessUrl(n);const l=vi.BaseUrl+n;let o=!1;const c={onCompleteObservable:new Y,abort:()=>o=!0},u=()=>{let h=new wi,d=null,f;const _=()=>{h&&(t&&h.removeEventListener("progress",t),f&&h.removeEventListener("readystatechange",f),h.removeEventListener("loadend",p))};let p=()=>{_(),c.onCompleteObservable.notifyObservers(c),c.onCompleteObservable.clear(),t=void 0,f=null,p=null,s=void 0,a=void 0,e=void 0};c.abort=()=>{o=!0,p&&p(),h&&h.readyState!==(XMLHttpRequest.DONE||4)&&h.abort(),d!==null&&(clearTimeout(d),d=null),h=null};const v=g=>{const m=g.message||"Unknown error";s&&h?s(new Zh(m,h)):ee.Error(m)},E=g=>{if(h){if(h.open("GET",l),a)try{a(h)}catch(m){v(m);return}r&&(h.responseType="arraybuffer"),t&&h.addEventListener("progress",t),p&&h.addEventListener("loadend",p),f=()=>{if(!(o||!h)&&h.readyState===(XMLHttpRequest.DONE||4)){if(f&&h.removeEventListener("readystatechange",f),h.status>=200&&h.status<300||h.status===0&&(!Ui()||l1())){try{e&&e(r?h.response:h.responseText,h)}catch(T){v(T)}return}const m=vi.DefaultRetryStrategy;if(m){const T=m(l,h,g);if(T!==-1){_(),h=new wi,d=setTimeout(()=>E(g+1),T);return}}const y=new Zh("Error status: "+h.status+" "+h.statusText+" - Unable to load "+l,h);s&&s(y)}},h.addEventListener("readystatechange",f),h.send()}};E(0)};if(i&&i.enableSceneOffline){const h=f=>{f&&f.status>400?s&&s(f):u()},d=()=>{i&&i.loadFile(vi.BaseUrl+n,f=>{!o&&e&&e(f),c.onCompleteObservable.notifyObservers(c)},t?f=>{!o&&t&&t(f)}:void 0,h,r)};i.open(d,h)}else u();return c},l1=()=>typeof location<"u"&&location.protocol==="file:",_m=n=>a1.test(n),bN=n=>{const e=a1.exec(n);return e===null||e.length===0?{match:!1,type:""}:{match:!0,type:e[0].replace("data:","").replace("base64,","")}};function pm(n){return n1(n.split(",")[1])}const c1=n=>r1(n.split(",")[1]),CN=()=>{we._FileToolsLoadImage=dm,we._FileToolsLoadFile=Da,is._FileToolsLoadFile=Da};CN();let pc;const AN=(n,e,t,i,r,s,a,l,o,c)=>{pc={DecodeBase64UrlToBinary:n,DecodeBase64UrlToString:e,DefaultRetryStrategy:t.DefaultRetryStrategy,BaseUrl:t.BaseUrl,CorsBehavior:t.CorsBehavior,PreprocessUrl:t.PreprocessUrl,IsBase64DataUrl:i,IsFileURL:r,LoadFile:s,LoadImage:a,ReadFile:l,RequestFile:o,SetCorsBehavior:c},Object.defineProperty(pc,"DefaultRetryStrategy",{get:function(){return t.DefaultRetryStrategy},set:function(u){t.DefaultRetryStrategy=u}}),Object.defineProperty(pc,"BaseUrl",{get:function(){return t.BaseUrl},set:function(u){t.BaseUrl=u}}),Object.defineProperty(pc,"PreprocessUrl",{get:function(){return t.PreprocessUrl},set:function(u){t.PreprocessUrl=u}}),Object.defineProperty(pc,"CorsBehavior",{get:function(){return t.CorsBehavior},set:function(u){t.CorsBehavior=u}})};AN(pm,c1,vi,_m,l1,Da,dm,su,fm,hm);class Hc{static Instantiate(e){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[e])return this.RegisteredExternalClasses[e];const t=Bn(e);if(t)return t;ee.Warn(e+" not found, you may have missed an import.");const i=e.split(".");let r=window||this;for(let s=0,a=i.length;s<a;s++)r=r[i[s]];return typeof r!="function"?null:r}}Hc.RegisteredExternalClasses={};function $d(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)})}function au(n){let e=1;do e*=2;while(e<n);return e===n}function Rp(n,e,t){return n*(1-t)+e*t}class X{static get BaseUrl(){return vi.BaseUrl}static set BaseUrl(e){vi.BaseUrl=e}static IsAbsoluteUrl(e){return e.indexOf("//")===0?!0:e.indexOf("://")===-1||e.indexOf(".")===-1||e.indexOf("/")===-1||e.indexOf(":")>e.indexOf("/")?!1:e.indexOf("://")<e.indexOf(".")||e.indexOf("data:")===0||e.indexOf("blob:")===0}static set ScriptBaseUrl(e){vi.ScriptBaseUrl=e}static get ScriptBaseUrl(){return vi.ScriptBaseUrl}static set ScriptPreprocessUrl(e){vi.ScriptPreprocessUrl=e}static get ScriptPreprocessUrl(){return vi.ScriptPreprocessUrl}static get DefaultRetryStrategy(){return vi.DefaultRetryStrategy}static set DefaultRetryStrategy(e){vi.DefaultRetryStrategy=e}static get CorsBehavior(){return vi.CorsBehavior}static set CorsBehavior(e){vi.CorsBehavior=e}static get UseFallbackTexture(){return He.UseFallbackTexture}static set UseFallbackTexture(e){He.UseFallbackTexture=e}static get RegisteredExternalClasses(){return Hc.RegisteredExternalClasses}static set RegisteredExternalClasses(e){Hc.RegisteredExternalClasses=e}static get fallbackTexture(){return He.FallbackTexture}static set fallbackTexture(e){He.FallbackTexture=e}static FetchToRef(e,t,i,r,s,a){const l=Math.abs(e)*i%i|0,o=Math.abs(t)*r%r|0,c=(l+o*i)*4;a.r=s[c]/255,a.g=s[c+1]/255,a.b=s[c+2]/255,a.a=s[c+3]/255}static Mix(e,t,i){return 0}static Instantiate(e){return Hc.Instantiate(e)}static SetImmediate(e){$h.SetImmediate(e)}static IsExponentOfTwo(e){return!0}static FloatRound(e){return Math.fround(e)}static GetFilename(e){const t=e.lastIndexOf("/");return t<0?e:e.substring(t+1)}static GetFolderPath(e,t=!1){const i=e.lastIndexOf("/");return i<0?t?e:"":e.substring(0,i+1)}static ToDegrees(e){return e*180/Math.PI}static ToRadians(e){return e*Math.PI/180}static SmoothAngleChange(e,t,i=.9){const r=this.ToRadians(e),s=this.ToRadians(t);return this.ToDegrees(Math.atan2((1-i)*Math.sin(s)+i*Math.sin(r),(1-i)*Math.cos(s)+i*Math.cos(r)))}static MakeArray(e,t){return t!==!0&&(e===void 0||e==null)?null:Array.isArray(e)?e:[e]}static GetPointerPrefix(e){let t="pointer";return Ui()&&!window.PointerEvent&&(t="mouse"),e._badDesktopOS&&!e._badOS&&!(document&&"ontouchend"in document)&&(t="mouse"),t}static SetCorsBehavior(e,t){hm(e,t)}static SetReferrerPolicyBehavior(e,t){t.referrerPolicy=e}static CleanUrl(e){return e=e.replace(/#/gm,"%23"),e}static get PreprocessUrl(){return vi.PreprocessUrl}static set PreprocessUrl(e){vi.PreprocessUrl=e}static LoadImage(e,t,i,r,s,a){return dm(e,t,i,r,s,a)}static LoadFile(e,t,i,r,s,a){return Da(e,t,i,r,s,a)}static LoadFileAsync(e,t=!0){return new Promise((i,r)=>{Da(e,s=>{i(s)},void 0,void 0,t,(s,a)=>{r(a)})})}static GetBabylonScriptURL(e,t){if(!e)return"";if(X.ScriptBaseUrl&&e.startsWith(X._DefaultCdnUrl)){const i=X.ScriptBaseUrl[X.ScriptBaseUrl.length-1]==="/"?X.ScriptBaseUrl.substring(0,X.ScriptBaseUrl.length-1):X.ScriptBaseUrl;e=e.replace(X._DefaultCdnUrl,i)}return e=X.ScriptPreprocessUrl(e),t&&(e=X.GetAbsoluteUrl(e)),e}static LoadBabylonScript(e,t,i,r){e=X.GetBabylonScriptURL(e),X.LoadScript(e,t,i)}static LoadBabylonScriptAsync(e){return e=X.GetBabylonScriptURL(e),X.LoadScriptAsync(e)}static LoadScript(e,t,i,r){if(typeof importScripts=="function"){try{importScripts(e),t()}catch(l){i==null||i(`Unable to load script '${e}' in worker`,l)}return}else if(!Ui()){i==null||i(`Cannot load script '${e}' outside of a window or a worker`);return}const s=document.getElementsByTagName("head")[0],a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("src",e),r&&(a.id=r),a.onload=()=>{t&&t()},a.onerror=l=>{i&&i(`Unable to load script '${e}'`,l)},s.appendChild(a)}static LoadScriptAsync(e,t){return new Promise((i,r)=>{this.LoadScript(e,()=>{i()},(s,a)=>{r(a||new Error(s))},t)})}static ReadFileAsDataURL(e,t,i){const r=new FileReader,s={onCompleteObservable:new Y,abort:()=>r.abort()};return r.onloadend=()=>{s.onCompleteObservable.notifyObservers(s)},r.onload=a=>{t(a.target.result)},r.onprogress=i,r.readAsDataURL(e),s}static ReadFile(e,t,i,r,s){return su(e,t,i,r,s)}static FileAsURL(e){const t=new Blob([e]);return window.URL.createObjectURL(t)}static Format(e,t=2){return e.toFixed(t)}static DeepCopy(e,t,i,r){cm.DeepCopy(e,t,i,r)}static IsEmpty(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}static RegisterTopRootEvents(e,t){for(let i=0;i<t.length;i++){const r=t[i];e.addEventListener(r.name,r.handler,!1);try{window.parent&&window.parent.addEventListener(r.name,r.handler,!1)}catch{}}}static UnregisterTopRootEvents(e,t){for(let i=0;i<t.length;i++){const r=t[i];e.removeEventListener(r.name,r.handler);try{e.parent&&e.parent.removeEventListener(r.name,r.handler)}catch{}}}static async DumpFramebuffer(e,t,i,r,s="image/png",a,l){throw ke("DumpTools")}static DumpData(e,t,i,r,s="image/png",a,l=!1,o=!1,c){throw ke("DumpTools")}static DumpDataAsync(e,t,i,r="image/png",s,a=!1,l=!1,o){throw ke("DumpTools")}static _IsOffScreenCanvas(e){return e.convertToBlob!==void 0}static ToBlob(e,t,i="image/png",r){!X._IsOffScreenCanvas(e)&&!e.toBlob&&(e.toBlob=function(s,a,l){setTimeout(()=>{const o=atob(this.toDataURL(a,l).split(",")[1]),c=o.length,u=new Uint8Array(c);for(let h=0;h<c;h++)u[h]=o.charCodeAt(h);s(new Blob([u]))})}),X._IsOffScreenCanvas(e)?e.convertToBlob({type:i,quality:r}).then(s=>t(s)):e.toBlob(function(s){t(s)},i,r)}static DownloadBlob(e,t){if("download"in document.createElement("a")){if(!t){const i=new Date;t="screenshot_"+((i.getFullYear()+"-"+(i.getMonth()+1)).slice(2)+"-"+i.getDate()+"_"+i.getHours()+"-"+("0"+i.getMinutes()).slice(-2))+".png"}X.Download(e,t)}else if(e&&typeof URL<"u"){const i=URL.createObjectURL(e),r=window.open("");if(!r)return;const s=r.document.createElement("img");s.onload=function(){URL.revokeObjectURL(i)},s.src=i,r.document.body.appendChild(s)}}static EncodeScreenshotCanvasData(e,t,i="image/png",r,s){if(typeof r=="string"||!t)this.ToBlob(e,function(a){a&&X.DownloadBlob(a,r),t&&t("")},i,s);else if(t){if(X._IsOffScreenCanvas(e)){e.convertToBlob({type:i,quality:s}).then(l=>{const o=new FileReader;o.readAsDataURL(l),o.onloadend=()=>{const c=o.result;t(c)}});return}const a=e.toDataURL(i,s);t(a)}}static Download(e,t){if(typeof URL>"u")return;const i=window.URL.createObjectURL(e),r=document.createElement("a");document.body.appendChild(r),r.style.display="none",r.href=i,r.download=t,r.addEventListener("click",()=>{r.parentElement&&r.parentElement.removeChild(r)}),r.click(),window.URL.revokeObjectURL(i)}static BackCompatCameraNoPreventDefault(e){return typeof e[0]=="boolean"?e[0]:typeof e[1]=="boolean"?e[1]:!1}static CreateScreenshot(e,t,i,r,s="image/png",a=!1,l){throw ke("ScreenshotTools")}static CreateScreenshotAsync(e,t,i,r="image/png",s){throw ke("ScreenshotTools")}static CreateScreenshotUsingRenderTarget(e,t,i,r,s="image/png",a=1,l=!1,o,c=!1,u=!1,h=!0,d){throw ke("ScreenshotTools")}static CreateScreenshotUsingRenderTargetAsync(e,t,i,r="image/png",s=1,a=!1,l,o=!1,c=!1,u=!0,h){throw ke("ScreenshotTools")}static RandomId(){return $d()}static IsBase64(e){return _m(e)}static DecodeBase64(e){return pm(e)}static get errorsCount(){return ee.errorsCount}static Log(e){ee.Log(e)}static Warn(e){ee.Warn(e)}static Error(e){ee.Error(e)}static get LogCache(){return ee.LogCache}static ClearLogCache(){ee.ClearLogCache()}static set LogLevels(e){ee.LogLevels=e}static set PerformanceLogLevel(e){if((e&X.PerformanceUserMarkLogLevel)===X.PerformanceUserMarkLogLevel){X.StartPerformanceCounter=X._StartUserMark,X.EndPerformanceCounter=X._EndUserMark;return}if((e&X.PerformanceConsoleLogLevel)===X.PerformanceConsoleLogLevel){X.StartPerformanceCounter=X._StartPerformanceConsole,X.EndPerformanceCounter=X._EndPerformanceConsole;return}X.StartPerformanceCounter=X._StartPerformanceCounterDisabled,X.EndPerformanceCounter=X._EndPerformanceCounterDisabled}static _StartPerformanceCounterDisabled(e,t){}static _EndPerformanceCounterDisabled(e,t){}static _StartUserMark(e,t=!0){if(!X._Performance){if(!Ui())return;X._Performance=window.performance}!t||!X._Performance.mark||X._Performance.mark(e+"-Begin")}static _EndUserMark(e,t=!0){!t||!X._Performance.mark||(X._Performance.mark(e+"-End"),X._Performance.measure(e,e+"-Begin",e+"-End"))}static _StartPerformanceConsole(e,t=!0){t&&(X._StartUserMark(e,t),console.time&&console.time(e))}static _EndPerformanceConsole(e,t=!0){t&&(X._EndUserMark(e,t),console.timeEnd(e))}static get Now(){return mn.Now}static GetClassName(e,t=!1){let i=null;return!t&&e.getClassName?i=e.getClassName():(e instanceof Object&&(i=(t?e:Object.getPrototypeOf(e)).constructor.__bjsclassName__),i||(i=typeof e)),i}static First(e,t){for(const i of e)if(t(i))return i;return null}static getFullClassName(e,t=!1){let i=null,r=null;if(!t&&e.getClassName)i=e.getClassName();else{if(e instanceof Object){const s=t?e:Object.getPrototypeOf(e);i=s.constructor.__bjsclassName__,r=s.constructor.__bjsmoduleName__}i||(i=typeof e)}return i?(r!=null?r+".":"")+i:null}static DelayAsync(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}static IsSafari(){return Lc()?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}}X.UseCustomRequestHeaders=!1;X.CustomRequestHeaders=wi.CustomRequestHeaders;X.GetDOMTextContent=t1;X._DefaultCdnUrl="https://cdn.babylonjs.com";X.GetAbsoluteUrl=typeof document=="object"?n=>{const e=document.createElement("a");return e.href=n,e.href}:typeof URL=="function"&&typeof location=="object"?n=>new URL(n,location.origin).href:()=>{throw new Error("Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.")};X.NoneLogLevel=ee.NoneLogLevel;X.MessageLogLevel=ee.MessageLogLevel;X.WarningLogLevel=ee.WarningLogLevel;X.ErrorLogLevel=ee.ErrorLogLevel;X.AllLogLevel=ee.AllLogLevel;X.IsWindowObjectExist=Ui;X.PerformanceNoneLogLevel=0;X.PerformanceUserMarkLogLevel=1;X.PerformanceConsoleLogLevel=2;X.StartPerformanceCounter=X._StartPerformanceCounterDisabled;X.EndPerformanceCounter=X._EndPerformanceCounterDisabled;class Jh{constructor(e,t,i,r=0){this.iterations=e,this.index=r-1,this._done=!1,this._fn=t,this._successCallback=i}executeNext(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())}breakLoop(){this._done=!0,this._successCallback()}static Run(e,t,i,r=0){const s=new Jh(e,t,i,r);return s.executeNext(),s}static SyncAsyncForLoop(e,t,i,r,s,a=0){return Jh.Run(Math.ceil(e/t),l=>{s&&s()?l.breakLoop():setTimeout(()=>{for(let o=0;o<t;++o){const c=l.index*t+o;if(c>=e)break;if(i(c),s&&s()){l.breakLoop();break}}l.executeNext()},a)},r)}}X.Mix=Rp;X.IsExponentOfTwo=au;He.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z";class or{constructor(e){this.length=0,this.data=new Array(e),this._id=or._GlobalId++}push(e){this.data[this.length++]=e,this.length>this.data.length&&(this.data.length*=2)}forEach(e){for(let t=0;t<this.length;t++)e(this.data[t])}sort(e){this.data.sort(e)}reset(){this.length=0}dispose(){this.reset(),this.data&&(this.data.length=0)}concat(e){if(e.length!==0){this.length+e.length>this.data.length&&(this.data.length=(this.length+e.length)*2);for(let t=0;t<e.length;t++)this.data[this.length++]=(e.data||e)[t]}}indexOf(e){const t=this.data.indexOf(e);return t>=this.length?-1:t}contains(e){return this.indexOf(e)!==-1}}or._GlobalId=0;class no extends or{constructor(){super(...arguments),this._duplicateId=0}push(e){super.push(e),e.__smartArrayFlags||(e.__smartArrayFlags={}),e.__smartArrayFlags[this._id]=this._duplicateId}pushNoDuplicate(e){return e.__smartArrayFlags&&e.__smartArrayFlags[this._id]===this._duplicateId?!1:(this.push(e),!0)}reset(){super.reset(),this._duplicateId++}concatWithNoDuplicate(e){if(e.length!==0){this.length+e.length>this.data.length&&(this.data.length=(this.length+e.length)*2);for(let t=0;t<e.length;t++){const i=(e.data||e)[t];this.pushNoDuplicate(i)}}}}class K0{constructor(){this._count=0,this._data={}}copyFrom(e){this.clear(),e.forEach((t,i)=>this.add(t,i))}get(e){const t=this._data[e];if(t!==void 0)return t}getOrAddWithFactory(e,t){let i=this.get(e);return i!==void 0||(i=t(e),i&&this.add(e,i)),i}getOrAdd(e,t){const i=this.get(e);return i!==void 0?i:(this.add(e,t),t)}contains(e){return this._data[e]!==void 0}add(e,t){return this._data[e]!==void 0?!1:(this._data[e]=t,++this._count,!0)}set(e,t){return this._data[e]===void 0?!1:(this._data[e]=t,!0)}getAndRemove(e){const t=this.get(e);return t!==void 0?(delete this._data[e],--this._count,t):null}remove(e){return this.contains(e)?(delete this._data[e],--this._count,!0):!1}clear(){this._data={},this._count=0}get count(){return this._count}forEach(e){for(const t in this._data){const i=this._data[t];e(t,i)}}first(e){for(const t in this._data){const i=this._data[t],r=e(t,i);if(r)return r}return null}}class co{static Eval(e,t){return e.match(/\([^()]*\)/g)?e=e.replace(/\([^()]*\)/g,i=>(i=i.slice(1,i.length-1),co._HandleParenthesisContent(i,t))):e=co._HandleParenthesisContent(e,t),e==="true"?!0:e==="false"?!1:co.Eval(e,t)}static _HandleParenthesisContent(e,t){t=t||(s=>s==="true");let i;const r=e.split("||");for(const s in r)if(Object.prototype.hasOwnProperty.call(r,s)){let a=co._SimplifyNegation(r[s].trim());const l=a.split("&&");if(l.length>1)for(let o=0;o<l.length;++o){const c=co._SimplifyNegation(l[o].trim());if(c!=="true"&&c!=="false"?c[0]==="!"?i=!t(c.substring(1)):i=t(c):i=c==="true",!i){a="false";break}}if(i||a==="true"){i=!0;break}a!=="true"&&a!=="false"?a[0]==="!"?i=!t(a.substring(1)):i=t(a):i=a==="true"}return i?"true":"false"}static _SimplifyNegation(e){return e=e.replace(/^[\s!]+/,t=>(t=t.replace(/[\s]/g,()=>""),t.length%2?"!":"")),e=e.trim(),e==="!true"?e="false":e==="!false"&&(e="true"),e}}class ct{static EnableFor(e){e._tags=e._tags||{},e.hasTags=()=>ct.HasTags(e),e.addTags=t=>ct.AddTagsTo(e,t),e.removeTags=t=>ct.RemoveTagsFrom(e,t),e.matchesTagsQuery=t=>ct.MatchesQuery(e,t)}static DisableFor(e){delete e._tags,delete e.hasTags,delete e.addTags,delete e.removeTags,delete e.matchesTagsQuery}static HasTags(e){if(!e._tags)return!1;const t=e._tags;for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i))return!0;return!1}static GetTags(e,t=!0){if(!e._tags)return null;if(t){const i=[];for(const r in e._tags)Object.prototype.hasOwnProperty.call(e._tags,r)&&e._tags[r]===!0&&i.push(r);return i.join(" ")}else return e._tags}static AddTagsTo(e,t){if(!t||typeof t!="string")return;t.split(" ").forEach(function(r){ct._AddTagTo(e,r)})}static _AddTagTo(e,t){t=t.trim(),!(t===""||t==="true"||t==="false")&&(t.match(/[\s]/)||t.match(/^([!]|([|]|[&]){2})/)||(ct.EnableFor(e),e._tags[t]=!0))}static RemoveTagsFrom(e,t){if(!ct.HasTags(e))return;const i=t.split(" ");for(const r in i)ct._RemoveTagFrom(e,i[r])}static _RemoveTagFrom(e,t){delete e._tags[t]}static MatchesQuery(e,t){return t===void 0?!0:t===""?ct.HasTags(e):co.Eval(t,i=>ct.HasTags(e)&&e._tags[i])}}class Fu{constructor(){this.rootNodes=[],this.cameras=[],this.lights=[],this.meshes=[],this.skeletons=[],this.particleSystems=[],this.animations=[],this.animationGroups=[],this.multiMaterials=[],this.materials=[],this.morphTargetManagers=[],this.geometries=[],this.transformNodes=[],this.actionManagers=[],this.textures=[],this._environmentTexture=null,this.postProcesses=[]}static AddParser(e,t){this._BabylonFileParsers[e]=t}static GetParser(e){return this._BabylonFileParsers[e]?this._BabylonFileParsers[e]:null}static AddIndividualParser(e,t){this._IndividualBabylonFileParsers[e]=t}static GetIndividualParser(e){return this._IndividualBabylonFileParsers[e]?this._IndividualBabylonFileParsers[e]:null}static Parse(e,t,i,r){for(const s in this._BabylonFileParsers)Object.prototype.hasOwnProperty.call(this._BabylonFileParsers,s)&&this._BabylonFileParsers[s](e,t,i,r)}get environmentTexture(){return this._environmentTexture}set environmentTexture(e){this._environmentTexture=e}getNodes(){let e=[];return e=e.concat(this.meshes),e=e.concat(this.lights),e=e.concat(this.cameras),e=e.concat(this.transformNodes),this.skeletons.forEach(t=>e=e.concat(t.bones)),e}}Fu._BabylonFileParsers={};Fu._IndividualBabylonFileParsers={};function R(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var l=n.length-1;l>=0;l--)(a=n[l])&&(s=(r<3?a(s):r>3?a(e,t,s):a(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}const oh={},Nh={};function SN(n){const e=n.getClassName();return Nh[e]||(Nh[e]={}),Nh[e]}function xp(n){const e=n.getClassName();if(oh[e])return oh[e];oh[e]={};const t=oh[e];let i=n,r=e;for(;r;){const s=Nh[r];for(const o in s)t[o]=s[o];let a,l=!1;do{if(a=Object.getPrototypeOf(i),!a.getClassName){l=!0;break}if(a.getClassName()!==r)break;i=a}while(a);if(l)break;r=a.getClassName(),i=a}return t}function Vn(n,e){return(t,i)=>{const r=SN(t);r[i]||(r[i]={type:n,sourceName:e})}}function RN(n,e=null){return(t,i)=>{const r=e||"_"+i;Object.defineProperty(t,i,{get:function(){return this[r]},set:function(s){typeof this.equals=="function"&&this.equals(s)||this[r]!==s&&(this[r]=s,t[n].apply(this))},enumerable:!0,configurable:!0})}}function ie(n,e=null){return RN(n,e)}function I(n){return Vn(0,n)}function At(n){return Vn(1,n)}function br(n){return Vn(2,n)}function ku(n){return Vn(3,n)}function u1(n){return Vn(4,n)}function Tn(n){return Vn(5,n)}function h1(n){return Vn(6,n)}function xN(n){return Vn(7,n)}function d1(n){return Vn(8,n)}function MN(n){return Vn(9,n)}function IN(n){return Vn(10,n)}function La(n,e,t,i){const r=t.value;t.value=(...s)=>{let a=r;if(typeof _native<"u"&&_native[e]){const l=_native[e];i?a=(...o)=>i(...o)?l(...o):r(...o):a=l}return n[e]=a,a(...s)}}La.filter=function(n){return(e,t,i)=>La(e,t,i,n)};class dt{static Sign(e){return e=+e,e===0||isNaN(e)?e:e>0?1:-1}static Log2(e){return Math.log(e)*Math.LOG2E}static ILog2(e){if(Math.log2)return Math.floor(Math.log2(e));if(e<0)return NaN;if(e===0)return-1/0;let t=0;if(e<1){for(;e<1;)t++,e=e*2;t=-t}else if(e>1)for(;e>1;)t++,e=Math.floor(e/2);return t}static Repeat(e,t){return e-Math.floor(e/t)*t}static Normalize(e,t,i){return(e-t)/(i-t)}static Denormalize(e,t,i){return e*(i-t)+t}static DeltaAngle(e,t){let i=dt.Repeat(t-e,360);return i>180&&(i-=360),i}static PingPong(e,t){const i=dt.Repeat(e,t*2);return t-Math.abs(i-t)}static SmoothStep(e,t,i){let r=dt.Clamp(i);return r=-2*r*r*r+3*r*r,t*r+e*(1-r)}static MoveTowards(e,t,i){let r=0;return Math.abs(t-e)<=i?r=t:r=e+dt.Sign(t-e)*i,r}static MoveTowardsAngle(e,t,i){const r=dt.DeltaAngle(e,t);let s=0;return-i<r&&r<i?s=t:(t=e+r,s=dt.MoveTowards(e,t,i)),s}static LerpAngle(e,t,i){let r=dt.Repeat(t-e,360);return r>180&&(r-=360),e+r*si(i)}static InverseLerp(e,t,i){let r=0;return e!=t?r=si((i-e)/(t-e)):r=0,r}static Hermite(e,t,i,r,s){const a=s*s,l=s*a,o=2*l-3*a+1,c=-2*l+3*a,u=l-2*a+s,h=l-a;return e*o+i*c+t*u+r*h}static Hermite1stDerivative(e,t,i,r,s){const a=s*s;return(a-s)*6*e+(3*a-4*s+1)*t+(-a+s)*6*i+(3*a-2*s)*r}static RangeToPercent(e,t,i){return(e-t)/(i-t)}static PercentToRange(e,t,i){return(i-t)*e+t}static HCF(e,t){const i=e%t;return i===0?t:dt.HCF(t,i)}}dt.TwoPi=Math.PI*2;dt.WithinEpsilon=$i;dt.ToHex=Mn;dt.Clamp=si;dt.Lerp=JT;dt.RandomRange=ei;dt.NormalizeRadians=e1;function Rl(n){return Math.pow(n,Lh)}function xl(n){return n<=.04045?.0773993808*n:Math.pow(.947867299*(n+.055),2.4)}function Ml(n){return Math.pow(n,qL)}function Il(n){return n<=.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let Pe=class hi{constructor(e=0,t=0,i=0){this.r=e,this.g=t,this.b=i}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let e=this.r*255|0;return e=e*397^(this.g*255|0),e=e*397^(this.b*255|0),e}toArray(e,t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,this}fromArray(e,t=0){return hi.FromArrayToRef(e,t,this),this}toColor4(e=1){return new et(this.r,this.g,this.b,e)}asArray(){return[this.r,this.g,this.b]}toLuminance(){return this.r*.3+this.g*.59+this.b*.11}multiply(e){return new this.constructor(this.r*e.r,this.g*e.g,this.b*e.b)}multiplyToRef(e,t){return t.r=this.r*e.r,t.g=this.g*e.g,t.b=this.b*e.b,t}multiplyInPlace(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyByFloats(e,t,i){return new this.constructor(this.r*e,this.g*t,this.b*i)}divide(e){throw new ReferenceError("Can not divide a color")}divideToRef(e,t){throw new ReferenceError("Can not divide a color")}divideInPlace(e){throw new ReferenceError("Can not divide a color")}minimizeInPlace(e){return this.minimizeInPlaceFromFloats(e.r,e.g,e.b)}maximizeInPlace(e){return this.maximizeInPlaceFromFloats(e.r,e.g,e.b)}minimizeInPlaceFromFloats(e,t,i){return this.r=Math.min(e,this.r),this.g=Math.min(t,this.g),this.b=Math.min(i,this.b),this}maximizeInPlaceFromFloats(e,t,i){return this.r=Math.max(e,this.r),this.g=Math.max(t,this.g),this.b=Math.max(i,this.b),this}floorToRef(e){throw new ReferenceError("Can not floor a color")}floor(){throw new ReferenceError("Can not floor a color")}fractToRef(e){throw new ReferenceError("Can not fract a color")}fract(){throw new ReferenceError("Can not fract a color")}equals(e){return e&&this.r===e.r&&this.g===e.g&&this.b===e.b}equalsFloats(e,t,i){return this.equalsToFloats(e,t,i)}equalsToFloats(e,t,i){return this.r===e&&this.g===t&&this.b===i}equalsWithEpsilon(e,t=ut){return dt.WithinEpsilon(this.r,e.r,t)&&dt.WithinEpsilon(this.g,e.g,t)&&dt.WithinEpsilon(this.b,e.b,t)}negate(){throw new ReferenceError("Can not negate a color")}negateInPlace(){throw new ReferenceError("Can not negate a color")}negateToRef(e){throw new ReferenceError("Can not negate a color")}scale(e){return new this.constructor(this.r*e,this.g*e,this.b*e)}scaleInPlace(e){return this.r*=e,this.g*=e,this.b*=e,this}scaleToRef(e,t){return t.r=this.r*e,t.g=this.g*e,t.b=this.b*e,t}scaleAndAddToRef(e,t){return t.r+=this.r*e,t.g+=this.g*e,t.b+=this.b*e,t}clampToRef(e=0,t=1,i){return i.r=si(this.r,e,t),i.g=si(this.g,e,t),i.b=si(this.b,e,t),i}add(e){return new this.constructor(this.r+e.r,this.g+e.g,this.b+e.b)}addInPlace(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addInPlaceFromFloats(e,t,i){return this.r+=e,this.g+=t,this.b+=i,this}addToRef(e,t){return t.r=this.r+e.r,t.g=this.g+e.g,t.b=this.b+e.b,t}subtract(e){return new this.constructor(this.r-e.r,this.g-e.g,this.b-e.b)}subtractToRef(e,t){return t.r=this.r-e.r,t.g=this.g-e.g,t.b=this.b-e.b,t}subtractInPlace(e){return this.r-=e.r,this.g-=e.g,this.b-=e.b,this}subtractFromFloats(e,t,i){return new this.constructor(this.r-e,this.g-t,this.b-i)}subtractFromFloatsToRef(e,t,i,r){return r.copyFromFloats(this.r-e,this.g-t,this.b-i)}clone(){return new this.constructor(this.r,this.g,this.b)}copyFrom(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyFromFloats(e,t,i){return this.r=e,this.g=t,this.b=i,this}set(e,t,i){return this.copyFromFloats(e,t,i)}setAll(e){return this.r=this.g=this.b=e,this}toHexString(){const e=Math.round(this.r*255),t=Math.round(this.g*255),i=Math.round(this.b*255);return"#"+Mn(e)+Mn(t)+Mn(i)}toHSV(){const e=new this.constructor;return this.toHSVToRef(e),e}toHSVToRef(e){const t=this.r,i=this.g,r=this.b,s=Math.max(t,i,r),a=Math.min(t,i,r);let l=0,o=0;const c=s,u=s-a;s!==0&&(o=u/s),s!=a&&(s==t?(l=(i-r)/u,i<r&&(l+=6)):s==i?l=(r-t)/u+2:s==r&&(l=(t-i)/u+4),l*=60),e.r=l,e.g=o,e.b=c}toLinearSpace(e=!1){const t=new this.constructor;return this.toLinearSpaceToRef(t,e),t}toLinearSpaceToRef(e,t=!1){return t?(e.r=xl(this.r),e.g=xl(this.g),e.b=xl(this.b)):(e.r=Rl(this.r),e.g=Rl(this.g),e.b=Rl(this.b)),this}toGammaSpace(e=!1){const t=new this.constructor;return this.toGammaSpaceToRef(t,e),t}toGammaSpaceToRef(e,t=!1){return t?(e.r=Il(this.r),e.g=Il(this.g),e.b=Il(this.b)):(e.r=Ml(this.r),e.g=Ml(this.g),e.b=Ml(this.b)),this}static HSVtoRGBToRef(e,t,i,r){const s=i*t,a=e/60,l=s*(1-Math.abs(a%2-1));let o=0,c=0,u=0;a>=0&&a<=1?(o=s,c=l):a>=1&&a<=2?(o=l,c=s):a>=2&&a<=3?(c=s,u=l):a>=3&&a<=4?(c=l,u=s):a>=4&&a<=5?(o=l,u=s):a>=5&&a<=6&&(o=s,u=l);const h=i-s;r.set(o+h,c+h,u+h)}static FromHSV(e,t,i){const r=new hi(0,0,0);return hi.HSVtoRGBToRef(e,t,i,r),r}static FromHexString(e){if(e.substring(0,1)!=="#"||e.length!==7)return new hi(0,0,0);const t=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16),r=parseInt(e.substring(5,7),16);return hi.FromInts(t,i,r)}static FromArray(e,t=0){return new hi(e[t],e[t+1],e[t+2])}static FromArrayToRef(e,t=0,i){i.r=e[t],i.g=e[t+1],i.b=e[t+2]}static FromInts(e,t,i){return new hi(e/255,t/255,i/255)}static Lerp(e,t,i){const r=new hi(0,0,0);return hi.LerpToRef(e,t,i,r),r}static LerpToRef(e,t,i,r){r.r=e.r+(t.r-e.r)*i,r.g=e.g+(t.g-e.g)*i,r.b=e.b+(t.b-e.b)*i}static Hermite(e,t,i,r,s){const a=s*s,l=s*a,o=2*l-3*a+1,c=-2*l+3*a,u=l-2*a+s,h=l-a,d=e.r*o+i.r*c+t.r*u+r.r*h,f=e.g*o+i.g*c+t.g*u+r.g*h,_=e.b*o+i.b*c+t.b*u+r.b*h;return new hi(d,f,_)}static Hermite1stDerivative(e,t,i,r,s){const a=hi.Black();return this.Hermite1stDerivativeToRef(e,t,i,r,s,a),a}static Hermite1stDerivativeToRef(e,t,i,r,s,a){const l=s*s;a.r=(l-s)*6*e.r+(3*l-4*s+1)*t.r+(-l+s)*6*i.r+(3*l-2*s)*r.r,a.g=(l-s)*6*e.g+(3*l-4*s+1)*t.g+(-l+s)*6*i.g+(3*l-2*s)*r.g,a.b=(l-s)*6*e.b+(3*l-4*s+1)*t.b+(-l+s)*6*i.b+(3*l-2*s)*r.b}static Red(){return new hi(1,0,0)}static Green(){return new hi(0,1,0)}static Blue(){return new hi(0,0,1)}static Black(){return new hi(0,0,0)}static get BlackReadOnly(){return hi._BlackReadOnly}static White(){return new hi(1,1,1)}static Purple(){return new hi(.5,0,.5)}static Magenta(){return new hi(1,0,1)}static Yellow(){return new hi(1,1,0)}static Gray(){return new hi(.5,.5,.5)}static Teal(){return new hi(0,1,1)}static Random(){return new hi(Math.random(),Math.random(),Math.random())}};Pe._BlackReadOnly=Pe.Black();Object.defineProperties(Pe.prototype,{dimension:{value:[3]},rank:{value:1}});class et{constructor(e=0,t=0,i=0,r=1){this.r=e,this.g=t,this.b=i,this.a=r}asArray(){return[this.r,this.g,this.b,this.a]}toArray(e,t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e[t+3]=this.a,this}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this.a=e[t+3],this}equals(e){return e&&this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}add(e){return new this.constructor(this.r+e.r,this.g+e.g,this.b+e.b,this.a+e.a)}addToRef(e,t){return t.r=this.r+e.r,t.g=this.g+e.g,t.b=this.b+e.b,t.a=this.a+e.a,t}addInPlace(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this.a+=e.a,this}addInPlaceFromFloats(e,t,i,r){return this.r+=e,this.g+=t,this.b+=i,this.a+=r,this}subtract(e){return new this.constructor(this.r-e.r,this.g-e.g,this.b-e.b,this.a-e.a)}subtractToRef(e,t){return t.r=this.r-e.r,t.g=this.g-e.g,t.b=this.b-e.b,t.a=this.a-e.a,t}subtractInPlace(e){return this.r-=e.r,this.g-=e.g,this.b-=e.b,this.a-=e.a,this}subtractFromFloats(e,t,i,r){return new this.constructor(this.r-e,this.g-t,this.b-i,this.a-r)}subtractFromFloatsToRef(e,t,i,r,s){return s.r=this.r-e,s.g=this.g-t,s.b=this.b-i,s.a=this.a-r,s}scale(e){return new this.constructor(this.r*e,this.g*e,this.b*e,this.a*e)}scaleInPlace(e){return this.r*=e,this.g*=e,this.b*=e,this.a*=e,this}scaleToRef(e,t){return t.r=this.r*e,t.g=this.g*e,t.b=this.b*e,t.a=this.a*e,t}scaleAndAddToRef(e,t){return t.r+=this.r*e,t.g+=this.g*e,t.b+=this.b*e,t.a+=this.a*e,t}clampToRef(e=0,t=1,i){return i.r=si(this.r,e,t),i.g=si(this.g,e,t),i.b=si(this.b,e,t),i.a=si(this.a,e,t),i}multiply(e){return new this.constructor(this.r*e.r,this.g*e.g,this.b*e.b,this.a*e.a)}multiplyToRef(e,t){return t.r=this.r*e.r,t.g=this.g*e.g,t.b=this.b*e.b,t.a=this.a*e.a,t}multiplyInPlace(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this.a*=e.a,this}multiplyByFloats(e,t,i,r){return new this.constructor(this.r*e,this.g*t,this.b*i,this.a*r)}divide(e){throw new ReferenceError("Can not divide a color")}divideToRef(e,t){throw new ReferenceError("Can not divide a color")}divideInPlace(e){throw new ReferenceError("Can not divide a color")}minimizeInPlace(e){return this.r=Math.min(this.r,e.r),this.g=Math.min(this.g,e.g),this.b=Math.min(this.b,e.b),this.a=Math.min(this.a,e.a),this}maximizeInPlace(e){return this.r=Math.max(this.r,e.r),this.g=Math.max(this.g,e.g),this.b=Math.max(this.b,e.b),this.a=Math.max(this.a,e.a),this}minimizeInPlaceFromFloats(e,t,i,r){return this.r=Math.min(e,this.r),this.g=Math.min(t,this.g),this.b=Math.min(i,this.b),this.a=Math.min(r,this.a),this}maximizeInPlaceFromFloats(e,t,i,r){return this.r=Math.max(e,this.r),this.g=Math.max(t,this.g),this.b=Math.max(i,this.b),this.a=Math.max(r,this.a),this}floorToRef(e){throw new ReferenceError("Can not floor a color")}floor(){throw new ReferenceError("Can not floor a color")}fractToRef(e){throw new ReferenceError("Can not fract a color")}fract(){throw new ReferenceError("Can not fract a color")}negate(){throw new ReferenceError("Can not negate a color")}negateInPlace(){throw new ReferenceError("Can not negate a color")}negateToRef(e){throw new ReferenceError("Can not negate a color")}equalsWithEpsilon(e,t=ut){return dt.WithinEpsilon(this.r,e.r,t)&&dt.WithinEpsilon(this.g,e.g,t)&&dt.WithinEpsilon(this.b,e.b,t)&&dt.WithinEpsilon(this.a,e.a,t)}equalsToFloats(e,t,i,r){return this.r===e&&this.g===t&&this.b===i&&this.a===r}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let e=this.r*255|0;return e=e*397^(this.g*255|0),e=e*397^(this.b*255|0),e=e*397^(this.a*255|0),e}clone(){return new this.constructor().copyFrom(this)}copyFrom(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}copyFromFloats(e,t,i,r){return this.r=e,this.g=t,this.b=i,this.a=r,this}set(e,t,i,r){return this.copyFromFloats(e,t,i,r)}setAll(e){return this.r=this.g=this.b=this.a=e,this}toHexString(e=!1){const t=Math.round(this.r*255),i=Math.round(this.g*255),r=Math.round(this.b*255);if(e)return"#"+Mn(t)+Mn(i)+Mn(r);const s=Math.round(this.a*255);return"#"+Mn(t)+Mn(i)+Mn(r)+Mn(s)}toLinearSpace(e=!1){const t=new et;return this.toLinearSpaceToRef(t,e),t}toLinearSpaceToRef(e,t=!1){return t?(e.r=xl(this.r),e.g=xl(this.g),e.b=xl(this.b)):(e.r=Rl(this.r),e.g=Rl(this.g),e.b=Rl(this.b)),e.a=this.a,this}toGammaSpace(e=!1){const t=new et;return this.toGammaSpaceToRef(t,e),t}toGammaSpaceToRef(e,t=!1){return t?(e.r=Il(this.r),e.g=Il(this.g),e.b=Il(this.b)):(e.r=Ml(this.r),e.g=Ml(this.g),e.b=Ml(this.b)),e.a=this.a,this}static FromHexString(e){if(e.substring(0,1)!=="#"||e.length!==9&&e.length!==7)return new et(0,0,0,0);const t=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16),r=parseInt(e.substring(5,7),16),s=e.length===9?parseInt(e.substring(7,9),16):255;return et.FromInts(t,i,r,s)}static Lerp(e,t,i){const r=new et(0,0,0,0);return et.LerpToRef(e,t,i,r),r}static LerpToRef(e,t,i,r){r.r=e.r+(t.r-e.r)*i,r.g=e.g+(t.g-e.g)*i,r.b=e.b+(t.b-e.b)*i,r.a=e.a+(t.a-e.a)*i}static Hermite(e,t,i,r,s){const a=s*s,l=s*a,o=2*l-3*a+1,c=-2*l+3*a,u=l-2*a+s,h=l-a,d=e.r*o+i.r*c+t.r*u+r.r*h,f=e.g*o+i.g*c+t.g*u+r.g*h,_=e.b*o+i.b*c+t.b*u+r.b*h,p=e.a*o+i.a*c+t.a*u+r.a*h;return new et(d,f,_,p)}static Hermite1stDerivative(e,t,i,r,s){const a=new et;return this.Hermite1stDerivativeToRef(e,t,i,r,s,a),a}static Hermite1stDerivativeToRef(e,t,i,r,s,a){const l=s*s;a.r=(l-s)*6*e.r+(3*l-4*s+1)*t.r+(-l+s)*6*i.r+(3*l-2*s)*r.r,a.g=(l-s)*6*e.g+(3*l-4*s+1)*t.g+(-l+s)*6*i.g+(3*l-2*s)*r.g,a.b=(l-s)*6*e.b+(3*l-4*s+1)*t.b+(-l+s)*6*i.b+(3*l-2*s)*r.b,a.a=(l-s)*6*e.a+(3*l-4*s+1)*t.a+(-l+s)*6*i.a+(3*l-2*s)*r.a}static FromColor3(e,t=1){return new et(e.r,e.g,e.b,t)}static FromArray(e,t=0){return new et(e[t],e[t+1],e[t+2],e[t+3])}static FromArrayToRef(e,t=0,i){i.r=e[t],i.g=e[t+1],i.b=e[t+2],i.a=e[t+3]}static FromInts(e,t,i,r){return new et(e/255,t/255,i/255,r/255)}static CheckColors4(e,t){if(e.length===t*3){const i=[];for(let r=0;r<e.length;r+=3){const s=r/3*4;i[s]=e[r],i[s+1]=e[r+1],i[s+2]=e[r+2],i[s+3]=1}return i}return e}}Object.defineProperties(et.prototype,{dimension:{value:[4]},rank:{value:1}});class Dn{}Dn.Color3=Zi.BuildArray(3,Pe.Black);Dn.Color4=Zi.BuildArray(3,()=>new et(0,0,0,0));Ji("BABYLON.Color3",Pe);Ji("BABYLON.Color4",et);const q0=function(n,e,t,i={}){const r=n();ct&&ct.HasTags(e)&&ct.AddTagsTo(r,ct.GetTags(e,!0));const s=xp(r),a={};for(const l in s){const o=s[l],c=e[l],u=o.type;if(c!=null&&(l!=="uniqueId"||Fe.AllowLoadingUniqueId))switch(u){case 0:case 6:case 11:r[l]=c;break;case 1:i.cloneTexturesOnlyOnce&&a[c.uniqueId]?r[l]=a[c.uniqueId]:(r[l]=t||c.isRenderTarget?c:c.clone(),a[c.uniqueId]=r[l]);break;case 2:case 3:case 4:case 5:case 7:case 10:case 12:r[l]=t?c:c.clone();break}}return r};class Fe{static AppendSerializedAnimations(e,t){if(e.animations){t.animations=[];for(let i=0;i<e.animations.length;i++){const r=e.animations[i];t.animations.push(r.serialize())}}}static Serialize(e,t){t||(t={}),ct&&(t.tags=ct.GetTags(e));const i=xp(e);for(const r in i){const s=i[r],a=s.sourceName||r,l=s.type,o=e[r];if(o!=null&&(r!=="uniqueId"||Fe.AllowLoadingUniqueId))switch(l){case 0:t[a]=o;break;case 1:t[a]=o.serialize();break;case 2:t[a]=o.asArray();break;case 3:t[a]=o.serialize();break;case 4:t[a]=o.asArray();break;case 5:t[a]=o.asArray();break;case 6:t[a]=o.id;break;case 7:t[a]=o.serialize();break;case 8:t[a]=o.asArray();break;case 9:t[a]=o.serialize();break;case 10:t[a]=o.asArray();break;case 11:t[a]=o.id;break;case 12:t[a]=o.asArray();break}}return t}static ParseProperties(e,t,i,r){r||(r="");const s=xp(t);for(const a in s){const l=s[a],o=e[l.sourceName||a],c=l.type;if(o!=null&&(a!=="uniqueId"||Fe.AllowLoadingUniqueId)){const u=t;switch(c){case 0:u[a]=o;break;case 1:i&&(u[a]=Fe._TextureParser(o,i,r));break;case 2:u[a]=Pe.FromArray(o);break;case 3:u[a]=Fe._FresnelParametersParser(o);break;case 4:u[a]=xe.FromArray(o);break;case 5:u[a]=A.FromArray(o);break;case 6:i&&(u[a]=i.getLastMeshById(o));break;case 7:u[a]=Fe._ColorCurvesParser(o);break;case 8:u[a]=et.FromArray(o);break;case 9:u[a]=Fe._ImageProcessingConfigurationParser(o);break;case 10:u[a]=ue.FromArray(o);break;case 11:i&&(u[a]=i.getCameraById(o));break;case 12:u[a]=z.FromArray(o);break}}}}static Parse(e,t,i,r=null){const s=e();return ct&&ct.AddTagsTo(s,t.tags),Fe.ParseProperties(t,s,i,r),s}static Clone(e,t,i={}){return q0(e,t,!1,i)}static Instanciate(e,t){return q0(e,t,!0)}}Fe.AllowLoadingUniqueId=!1;Fe._ImageProcessingConfigurationParser=n=>{throw ke("ImageProcessingConfiguration")};Fe._FresnelParametersParser=n=>{throw ke("FresnelParameters")};Fe._ColorCurvesParser=n=>{throw ke("ColorCurves")};Fe._TextureParser=(n,e,t)=>{throw ke("Texture")};function f1(n){n.push("vCameraColorCurveNeutral","vCameraColorCurvePositive","vCameraColorCurveNegative")}class Yt{constructor(){this._dirty=!0,this._tempColor=new et(0,0,0,0),this._globalCurve=new et(0,0,0,0),this._highlightsCurve=new et(0,0,0,0),this._midtonesCurve=new et(0,0,0,0),this._shadowsCurve=new et(0,0,0,0),this._positiveCurve=new et(0,0,0,0),this._negativeCurve=new et(0,0,0,0),this._globalHue=30,this._globalDensity=0,this._globalSaturation=0,this._globalExposure=0,this._highlightsHue=30,this._highlightsDensity=0,this._highlightsSaturation=0,this._highlightsExposure=0,this._midtonesHue=30,this._midtonesDensity=0,this._midtonesSaturation=0,this._midtonesExposure=0,this._shadowsHue=30,this._shadowsDensity=0,this._shadowsSaturation=0,this._shadowsExposure=0}get globalHue(){return this._globalHue}set globalHue(e){this._globalHue=e,this._dirty=!0}get globalDensity(){return this._globalDensity}set globalDensity(e){this._globalDensity=e,this._dirty=!0}get globalSaturation(){return this._globalSaturation}set globalSaturation(e){this._globalSaturation=e,this._dirty=!0}get globalExposure(){return this._globalExposure}set globalExposure(e){this._globalExposure=e,this._dirty=!0}get highlightsHue(){return this._highlightsHue}set highlightsHue(e){this._highlightsHue=e,this._dirty=!0}get highlightsDensity(){return this._highlightsDensity}set highlightsDensity(e){this._highlightsDensity=e,this._dirty=!0}get highlightsSaturation(){return this._highlightsSaturation}set highlightsSaturation(e){this._highlightsSaturation=e,this._dirty=!0}get highlightsExposure(){return this._highlightsExposure}set highlightsExposure(e){this._highlightsExposure=e,this._dirty=!0}get midtonesHue(){return this._midtonesHue}set midtonesHue(e){this._midtonesHue=e,this._dirty=!0}get midtonesDensity(){return this._midtonesDensity}set midtonesDensity(e){this._midtonesDensity=e,this._dirty=!0}get midtonesSaturation(){return this._midtonesSaturation}set midtonesSaturation(e){this._midtonesSaturation=e,this._dirty=!0}get midtonesExposure(){return this._midtonesExposure}set midtonesExposure(e){this._midtonesExposure=e,this._dirty=!0}get shadowsHue(){return this._shadowsHue}set shadowsHue(e){this._shadowsHue=e,this._dirty=!0}get shadowsDensity(){return this._shadowsDensity}set shadowsDensity(e){this._shadowsDensity=e,this._dirty=!0}get shadowsSaturation(){return this._shadowsSaturation}set shadowsSaturation(e){this._shadowsSaturation=e,this._dirty=!0}get shadowsExposure(){return this._shadowsExposure}set shadowsExposure(e){this._shadowsExposure=e,this._dirty=!0}getClassName(){return"ColorCurves"}static Bind(e,t,i="vCameraColorCurvePositive",r="vCameraColorCurveNeutral",s="vCameraColorCurveNegative"){e._dirty&&(e._dirty=!1,e._getColorGradingDataToRef(e._globalHue,e._globalDensity,e._globalSaturation,e._globalExposure,e._globalCurve),e._getColorGradingDataToRef(e._highlightsHue,e._highlightsDensity,e._highlightsSaturation,e._highlightsExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._highlightsCurve),e._getColorGradingDataToRef(e._midtonesHue,e._midtonesDensity,e._midtonesSaturation,e._midtonesExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._midtonesCurve),e._getColorGradingDataToRef(e._shadowsHue,e._shadowsDensity,e._shadowsSaturation,e._shadowsExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._shadowsCurve),e._highlightsCurve.subtractToRef(e._midtonesCurve,e._positiveCurve),e._midtonesCurve.subtractToRef(e._shadowsCurve,e._negativeCurve)),t&&(t.setFloat4(i,e._positiveCurve.r,e._positiveCurve.g,e._positiveCurve.b,e._positiveCurve.a),t.setFloat4(r,e._midtonesCurve.r,e._midtonesCurve.g,e._midtonesCurve.b,e._midtonesCurve.a),t.setFloat4(s,e._negativeCurve.r,e._negativeCurve.g,e._negativeCurve.b,e._negativeCurve.a))}_getColorGradingDataToRef(e,t,i,r,s){e!=null&&(e=Yt._Clamp(e,0,360),t=Yt._Clamp(t,-100,100),i=Yt._Clamp(i,-100,100),r=Yt._Clamp(r,-100,100),t=Yt._ApplyColorGradingSliderNonlinear(t),t*=.5,r=Yt._ApplyColorGradingSliderNonlinear(r),t<0&&(t*=-1,e=(e+180)%360),Yt._FromHSBToRef(e,t,50+.25*r,s),s.scaleToRef(2,s),s.a=1+.01*i)}static _ApplyColorGradingSliderNonlinear(e){e/=100;let t=Math.abs(e);return t=Math.pow(t,2),e<0&&(t*=-1),t*=100,t}static _FromHSBToRef(e,t,i,r){let s=Yt._Clamp(e,0,360);const a=Yt._Clamp(t/100,0,1),l=Yt._Clamp(i/100,0,1);if(a===0)r.r=l,r.g=l,r.b=l;else{s/=60;const o=Math.floor(s),c=s-o,u=l*(1-a),h=l*(1-a*c),d=l*(1-a*(1-c));switch(o){case 0:r.r=l,r.g=d,r.b=u;break;case 1:r.r=h,r.g=l,r.b=u;break;case 2:r.r=u,r.g=l,r.b=d;break;case 3:r.r=u,r.g=h,r.b=l;break;case 4:r.r=d,r.g=u,r.b=l;break;default:r.r=l,r.g=u,r.b=h;break}}r.a=1}static _Clamp(e,t,i){return Math.min(Math.max(e,t),i)}clone(){return Fe.Clone(()=>new Yt,this)}serialize(){return Fe.Serialize(this)}static Parse(e){return Fe.Parse(()=>new Yt,e,null,null)}}Yt.PrepareUniforms=f1;R([I()],Yt.prototype,"_globalHue",void 0);R([I()],Yt.prototype,"_globalDensity",void 0);R([I()],Yt.prototype,"_globalSaturation",void 0);R([I()],Yt.prototype,"_globalExposure",void 0);R([I()],Yt.prototype,"_highlightsHue",void 0);R([I()],Yt.prototype,"_highlightsDensity",void 0);R([I()],Yt.prototype,"_highlightsSaturation",void 0);R([I()],Yt.prototype,"_highlightsExposure",void 0);R([I()],Yt.prototype,"_midtonesHue",void 0);R([I()],Yt.prototype,"_midtonesDensity",void 0);R([I()],Yt.prototype,"_midtonesSaturation",void 0);R([I()],Yt.prototype,"_midtonesExposure",void 0);Fe._ColorCurvesParser=Yt.Parse;function PN(n,e){e.EXPOSURE&&n.push("exposureLinear"),e.CONTRAST&&n.push("contrast"),e.COLORGRADING&&n.push("colorTransformSettings"),(e.VIGNETTE||e.DITHER)&&n.push("vInverseScreenSize"),e.VIGNETTE&&(n.push("vignetteSettings1"),n.push("vignetteSettings2")),e.COLORCURVES&&f1(n),e.DITHER&&n.push("ditherIntensity")}function wN(n,e){e.COLORGRADING&&n.push("txColorTransform")}class it{constructor(){this.colorCurves=new Yt,this._colorCurvesEnabled=!1,this._colorGradingEnabled=!1,this._colorGradingWithGreenDepth=!0,this._colorGradingBGR=!0,this._exposure=1,this._toneMappingEnabled=!1,this._toneMappingType=it.TONEMAPPING_STANDARD,this._contrast=1,this.vignetteStretch=0,this.vignetteCenterX=0,this.vignetteCenterY=0,this.vignetteWeight=1.5,this.vignetteColor=new et(0,0,0,0),this.vignetteCameraFov=.5,this._vignetteBlendMode=it.VIGNETTEMODE_MULTIPLY,this._vignetteEnabled=!1,this._ditheringEnabled=!1,this._ditheringIntensity=1/255,this._skipFinalColorClamp=!1,this._applyByPostProcess=!1,this._isEnabled=!0,this.onUpdateParameters=new Y}get colorCurvesEnabled(){return this._colorCurvesEnabled}set colorCurvesEnabled(e){this._colorCurvesEnabled!==e&&(this._colorCurvesEnabled=e,this._updateParameters())}get colorGradingTexture(){return this._colorGradingTexture}set colorGradingTexture(e){this._colorGradingTexture!==e&&(this._colorGradingTexture=e,this._updateParameters())}get colorGradingEnabled(){return this._colorGradingEnabled}set colorGradingEnabled(e){this._colorGradingEnabled!==e&&(this._colorGradingEnabled=e,this._updateParameters())}get colorGradingWithGreenDepth(){return this._colorGradingWithGreenDepth}set colorGradingWithGreenDepth(e){this._colorGradingWithGreenDepth!==e&&(this._colorGradingWithGreenDepth=e,this._updateParameters())}get colorGradingBGR(){return this._colorGradingBGR}set colorGradingBGR(e){this._colorGradingBGR!==e&&(this._colorGradingBGR=e,this._updateParameters())}get exposure(){return this._exposure}set exposure(e){this._exposure!==e&&(this._exposure=e,this._updateParameters())}get toneMappingEnabled(){return this._toneMappingEnabled}set toneMappingEnabled(e){this._toneMappingEnabled!==e&&(this._toneMappingEnabled=e,this._updateParameters())}get toneMappingType(){return this._toneMappingType}set toneMappingType(e){this._toneMappingType!==e&&(this._toneMappingType=e,this._updateParameters())}get contrast(){return this._contrast}set contrast(e){this._contrast!==e&&(this._contrast=e,this._updateParameters())}get vignetteCentreY(){return this.vignetteCenterY}set vignetteCentreY(e){this.vignetteCenterY=e}get vignetteCentreX(){return this.vignetteCenterX}set vignetteCentreX(e){this.vignetteCenterX=e}get vignetteBlendMode(){return this._vignetteBlendMode}set vignetteBlendMode(e){this._vignetteBlendMode!==e&&(this._vignetteBlendMode=e,this._updateParameters())}get vignetteEnabled(){return this._vignetteEnabled}set vignetteEnabled(e){this._vignetteEnabled!==e&&(this._vignetteEnabled=e,this._updateParameters())}get ditheringEnabled(){return this._ditheringEnabled}set ditheringEnabled(e){this._ditheringEnabled!==e&&(this._ditheringEnabled=e,this._updateParameters())}get ditheringIntensity(){return this._ditheringIntensity}set ditheringIntensity(e){this._ditheringIntensity!==e&&(this._ditheringIntensity=e,this._updateParameters())}get skipFinalColorClamp(){return this._skipFinalColorClamp}set skipFinalColorClamp(e){this._skipFinalColorClamp!==e&&(this._skipFinalColorClamp=e,this._updateParameters())}get applyByPostProcess(){return this._applyByPostProcess}set applyByPostProcess(e){this._applyByPostProcess!==e&&(this._applyByPostProcess=e,this._updateParameters())}get isEnabled(){return this._isEnabled}set isEnabled(e){this._isEnabled!==e&&(this._isEnabled=e,this._updateParameters())}_updateParameters(){this.onUpdateParameters.notifyObservers(this)}getClassName(){return"ImageProcessingConfiguration"}prepareDefines(e,t=!1){if(t!==this.applyByPostProcess||!this._isEnabled){e.VIGNETTE=!1,e.TONEMAPPING=!1,e.TONEMAPPING_ACES=!1,e.CONTRAST=!1,e.EXPOSURE=!1,e.COLORCURVES=!1,e.COLORGRADING=!1,e.COLORGRADING3D=!1,e.DITHER=!1,e.IMAGEPROCESSING=!1,e.SKIPFINALCOLORCLAMP=this.skipFinalColorClamp,e.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess&&this._isEnabled;return}switch(e.VIGNETTE=this.vignetteEnabled,e.VIGNETTEBLENDMODEMULTIPLY=this.vignetteBlendMode===it._VIGNETTEMODE_MULTIPLY,e.VIGNETTEBLENDMODEOPAQUE=!e.VIGNETTEBLENDMODEMULTIPLY,e.TONEMAPPING=this.toneMappingEnabled,this._toneMappingType){case it.TONEMAPPING_ACES:e.TONEMAPPING_ACES=!0;break;default:e.TONEMAPPING_ACES=!1;break}e.CONTRAST=this.contrast!==1,e.EXPOSURE=this.exposure!==1,e.COLORCURVES=this.colorCurvesEnabled&&!!this.colorCurves,e.COLORGRADING=this.colorGradingEnabled&&!!this.colorGradingTexture,e.COLORGRADING?e.COLORGRADING3D=this.colorGradingTexture.is3D:e.COLORGRADING3D=!1,e.SAMPLER3DGREENDEPTH=this.colorGradingWithGreenDepth,e.SAMPLER3DBGRMAP=this.colorGradingBGR,e.DITHER=this._ditheringEnabled,e.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess,e.SKIPFINALCOLORCLAMP=this.skipFinalColorClamp,e.IMAGEPROCESSING=e.VIGNETTE||e.TONEMAPPING||e.CONTRAST||e.EXPOSURE||e.COLORCURVES||e.COLORGRADING||e.DITHER}isReady(){return!this.colorGradingEnabled||!this.colorGradingTexture||this.colorGradingTexture.isReady()}bind(e,t){if(this._colorCurvesEnabled&&this.colorCurves&&Yt.Bind(this.colorCurves,e),this._vignetteEnabled||this._ditheringEnabled){const i=1/e.getEngine().getRenderWidth(),r=1/e.getEngine().getRenderHeight();if(e.setFloat2("vInverseScreenSize",i,r),this._ditheringEnabled&&e.setFloat("ditherIntensity",.5*this._ditheringIntensity),this._vignetteEnabled){const s=t??r/i;let a=Math.tan(this.vignetteCameraFov*.5),l=a*s;const o=Math.sqrt(l*a);l=Rp(l,o,this.vignetteStretch),a=Rp(a,o,this.vignetteStretch),e.setFloat4("vignetteSettings1",l,a,-l*this.vignetteCenterX,-a*this.vignetteCenterY);const c=-2*this.vignetteWeight;e.setFloat4("vignetteSettings2",this.vignetteColor.r,this.vignetteColor.g,this.vignetteColor.b,c)}}if(e.setFloat("exposureLinear",this.exposure),e.setFloat("contrast",this.contrast),this.colorGradingTexture){e.setTexture("txColorTransform",this.colorGradingTexture);const i=this.colorGradingTexture.getSize().height;e.setFloat4("colorTransformSettings",(i-1)/i,.5/i,i,this.colorGradingTexture.level)}}clone(){return Fe.Clone(()=>new it,this)}serialize(){return Fe.Serialize(this)}static Parse(e){const t=Fe.Parse(()=>new it,e,null,null);return e.vignetteCentreX!==void 0&&(t.vignetteCenterX=e.vignetteCentreX),e.vignetteCentreY!==void 0&&(t.vignetteCenterY=e.vignetteCentreY),t}static get VIGNETTEMODE_MULTIPLY(){return this._VIGNETTEMODE_MULTIPLY}static get VIGNETTEMODE_OPAQUE(){return this._VIGNETTEMODE_OPAQUE}}it.TONEMAPPING_STANDARD=0;it.TONEMAPPING_ACES=1;it.PrepareUniforms=PN;it.PrepareSamplers=wN;it._VIGNETTEMODE_MULTIPLY=0;it._VIGNETTEMODE_OPAQUE=1;R([xN()],it.prototype,"colorCurves",void 0);R([I()],it.prototype,"_colorCurvesEnabled",void 0);R([At("colorGradingTexture")],it.prototype,"_colorGradingTexture",void 0);R([I()],it.prototype,"_colorGradingEnabled",void 0);R([I()],it.prototype,"_colorGradingWithGreenDepth",void 0);R([I()],it.prototype,"_colorGradingBGR",void 0);R([I()],it.prototype,"_exposure",void 0);R([I()],it.prototype,"_toneMappingEnabled",void 0);R([I()],it.prototype,"_toneMappingType",void 0);R([I()],it.prototype,"_contrast",void 0);R([I()],it.prototype,"vignetteStretch",void 0);R([I()],it.prototype,"vignetteCenterX",void 0);R([I()],it.prototype,"vignetteCenterY",void 0);R([I()],it.prototype,"vignetteWeight",void 0);R([d1()],it.prototype,"vignetteColor",void 0);R([I()],it.prototype,"vignetteCameraFov",void 0);R([I()],it.prototype,"_vignetteBlendMode",void 0);R([I()],it.prototype,"_vignetteEnabled",void 0);R([I()],it.prototype,"_ditheringEnabled",void 0);R([I()],it.prototype,"_ditheringIntensity",void 0);R([I()],it.prototype,"_skipFinalColorClamp",void 0);R([I()],it.prototype,"_applyByPostProcess",void 0);R([I()],it.prototype,"_isEnabled",void 0);Fe._ImageProcessingConfigurationParser=it.Parse;we.prototype.createUniformBuffer=function(n,e){const t=this._gl.createBuffer();if(!t)throw new Error("Unable to create uniform buffer");const i=new nu(t);return this.bindUniformBuffer(i),n instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,n,this._gl.STATIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(n),this._gl.STATIC_DRAW),this.bindUniformBuffer(null),i.references=1,i};we.prototype.createDynamicUniformBuffer=function(n,e){const t=this._gl.createBuffer();if(!t)throw new Error("Unable to create dynamic uniform buffer");const i=new nu(t);return this.bindUniformBuffer(i),n instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,n,this._gl.DYNAMIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(n),this._gl.DYNAMIC_DRAW),this.bindUniformBuffer(null),i.references=1,i};we.prototype.updateUniformBuffer=function(n,e,t,i){this.bindUniformBuffer(n),t===void 0&&(t=0),i===void 0?e instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,t,e):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,t,new Float32Array(e)):e instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,e.subarray(t,t+i)):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,new Float32Array(e).subarray(t,t+i)),this.bindUniformBuffer(null)};we.prototype.bindUniformBuffer=function(n){this._gl.bindBuffer(this._gl.UNIFORM_BUFFER,n?n.underlyingResource:null)};we.prototype.bindUniformBufferBase=function(n,e,t){this._gl.bindBufferBase(this._gl.UNIFORM_BUFFER,e,n?n.underlyingResource:null)};we.prototype.bindUniformBlock=function(n,e,t){const i=n.program,r=this._gl.getUniformBlockIndex(i,e);r!==4294967295&&this._gl.uniformBlockBinding(i,r,t)};class me{constructor(e,t,i,r,s=!1){this._valueCache={},this._engine=e,this._noUBO=!e.supportsUniformBuffers||s,this._dynamic=i,this._name=r??"no-name",this._data=t||[],this._uniformLocations={},this._uniformSizes={},this._uniformArraySizes={},this._uniformLocationPointer=0,this._needSync=!1,this._engine._features.trackUbosInFrame&&(this._buffers=[],this._bufferIndex=-1,this._createBufferOnWrite=!1,this._currentFrameId=0),this._noUBO?(this.updateMatrix3x3=this._updateMatrix3x3ForEffect,this.updateMatrix2x2=this._updateMatrix2x2ForEffect,this.updateFloat=this._updateFloatForEffect,this.updateFloat2=this._updateFloat2ForEffect,this.updateFloat3=this._updateFloat3ForEffect,this.updateFloat4=this._updateFloat4ForEffect,this.updateFloatArray=this._updateFloatArrayForEffect,this.updateArray=this._updateArrayForEffect,this.updateIntArray=this._updateIntArrayForEffect,this.updateUIntArray=this._updateUIntArrayForEffect,this.updateMatrix=this._updateMatrixForEffect,this.updateMatrices=this._updateMatricesForEffect,this.updateVector3=this._updateVector3ForEffect,this.updateVector4=this._updateVector4ForEffect,this.updateColor3=this._updateColor3ForEffect,this.updateColor4=this._updateColor4ForEffect,this.updateDirectColor4=this._updateDirectColor4ForEffect,this.updateInt=this._updateIntForEffect,this.updateInt2=this._updateInt2ForEffect,this.updateInt3=this._updateInt3ForEffect,this.updateInt4=this._updateInt4ForEffect,this.updateUInt=this._updateUIntForEffect,this.updateUInt2=this._updateUInt2ForEffect,this.updateUInt3=this._updateUInt3ForEffect,this.updateUInt4=this._updateUInt4ForEffect):(this._engine._uniformBuffers.push(this),this.updateMatrix3x3=this._updateMatrix3x3ForUniform,this.updateMatrix2x2=this._updateMatrix2x2ForUniform,this.updateFloat=this._updateFloatForUniform,this.updateFloat2=this._updateFloat2ForUniform,this.updateFloat3=this._updateFloat3ForUniform,this.updateFloat4=this._updateFloat4ForUniform,this.updateFloatArray=this._updateFloatArrayForUniform,this.updateArray=this._updateArrayForUniform,this.updateIntArray=this._updateIntArrayForUniform,this.updateUIntArray=this._updateUIntArrayForUniform,this.updateMatrix=this._updateMatrixForUniform,this.updateMatrices=this._updateMatricesForUniform,this.updateVector3=this._updateVector3ForUniform,this.updateVector4=this._updateVector4ForUniform,this.updateColor3=this._updateColor3ForUniform,this.updateColor4=this._updateColor4ForUniform,this.updateDirectColor4=this._updateDirectColor4ForUniform,this.updateInt=this._updateIntForUniform,this.updateInt2=this._updateInt2ForUniform,this.updateInt3=this._updateInt3ForUniform,this.updateInt4=this._updateInt4ForUniform,this.updateUInt=this._updateUIntForUniform,this.updateUInt2=this._updateUInt2ForUniform,this.updateUInt3=this._updateUInt3ForUniform,this.updateUInt4=this._updateUInt4ForUniform)}get useUbo(){return!this._noUBO}get isSync(){return!this._needSync}isDynamic(){return this._dynamic!==void 0}getData(){return this._bufferData}getBuffer(){return this._buffer}_fillAlignment(e){let t;if(e<=2?t=e:t=4,this._uniformLocationPointer%t!==0){const i=this._uniformLocationPointer;this._uniformLocationPointer+=t-this._uniformLocationPointer%t;const r=this._uniformLocationPointer-i;for(let s=0;s<r;s++)this._data.push(0)}}addUniform(e,t,i=0){if(this._noUBO||this._uniformLocations[e]!==void 0)return;let r;if(i>0){if(t instanceof Array)throw"addUniform should not be use with Array in UBO: "+e;if(this._fillAlignment(4),this._uniformArraySizes[e]={strideSize:t,arraySize:i},t==16)t=t*i;else{const a=(4-t)*i;t=t*i+a}r=[];for(let s=0;s<t;s++)r.push(0)}else{if(t instanceof Array)r=t,t=r.length;else{t=t,r=[];for(let s=0;s<t;s++)r.push(0)}this._fillAlignment(t)}this._uniformSizes[e]=t,this._uniformLocations[e]=this._uniformLocationPointer,this._uniformLocationPointer+=t;for(let s=0;s<t;s++)this._data.push(r[s]);this._needSync=!0}addMatrix(e,t){this.addUniform(e,Array.prototype.slice.call(t.asArray()))}addFloat2(e,t,i){const r=[t,i];this.addUniform(e,r)}addFloat3(e,t,i,r){const s=[t,i,r];this.addUniform(e,s)}addColor3(e,t){const i=[t.r,t.g,t.b];this.addUniform(e,i)}addColor4(e,t,i){const r=[t.r,t.g,t.b,i];this.addUniform(e,r)}addVector3(e,t){const i=[t.x,t.y,t.z];this.addUniform(e,i)}addMatrix3x3(e){this.addUniform(e,12)}addMatrix2x2(e){this.addUniform(e,8)}create(){this._noUBO||this._buffer||(this._fillAlignment(4),this._bufferData=new Float32Array(this._data),this._rebuild(),this._needSync=!0)}_getNames(){const e=[];let t=0;for(const i in this._uniformLocations)if(e.push(i),++t===10)break;return e.join(",")}_rebuild(){this._noUBO||!this._bufferData||(this._dynamic?this._buffer=this._engine.createDynamicUniformBuffer(this._bufferData,this._name+"_UniformList:"+this._getNames()):this._buffer=this._engine.createUniformBuffer(this._bufferData,this._name+"_UniformList:"+this._getNames()),this._engine._features.trackUbosInFrame&&(this._buffers.push([this._buffer,this._engine._features.checkUbosContentBeforeUpload?this._bufferData.slice():void 0]),this._bufferIndex=this._buffers.length-1,this._createBufferOnWrite=!1))}_rebuildAfterContextLost(){this._engine._features.trackUbosInFrame&&(this._buffers=[],this._currentFrameId=0),this._rebuild()}get _numBuffers(){return this._buffers.length}get _indexBuffer(){return this._bufferIndex}get name(){return this._name}get currentEffect(){return this._currentEffect}_buffersEqual(e,t){for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}_copyBuffer(e,t){for(let i=0;i<e.length;++i)t[i]=e[i]}update(){if(!this._noUBO){if(this.bindUniformBuffer(),!this._buffer){this.create();return}if(!this._dynamic&&!this._needSync){this._createBufferOnWrite=this._engine._features.trackUbosInFrame;return}if(this._buffers&&this._buffers.length>1&&this._buffers[this._bufferIndex][1])if(this._buffersEqual(this._bufferData,this._buffers[this._bufferIndex][1])){this._needSync=!1,this._createBufferOnWrite=this._engine._features.trackUbosInFrame;return}else this._copyBuffer(this._bufferData,this._buffers[this._bufferIndex][1]);this._engine.updateUniformBuffer(this._buffer,this._bufferData),this._engine._features._collectUbosUpdatedInFrame&&(me._UpdatedUbosInFrame[this._name]||(me._UpdatedUbosInFrame[this._name]=0),me._UpdatedUbosInFrame[this._name]++),this._needSync=!1,this._createBufferOnWrite=this._engine._features.trackUbosInFrame}}_createNewBuffer(){this._bufferIndex+1<this._buffers.length?(this._bufferIndex++,this._buffer=this._buffers[this._bufferIndex][0],this._createBufferOnWrite=!1,this._needSync=!0):this._rebuild()}_checkNewFrame(){this._engine._features.trackUbosInFrame&&this._currentFrameId!==this._engine.frameId&&(this._currentFrameId=this._engine.frameId,this._createBufferOnWrite=!1,this._buffers&&this._buffers.length>0?(this._needSync=this._bufferIndex!==0,this._bufferIndex=0,this._buffer=this._buffers[this._bufferIndex][0]):this._bufferIndex=-1)}updateUniform(e,t,i){this._checkNewFrame();let r=this._uniformLocations[e];if(r===void 0){if(this._buffer){ee.Error("Cannot add an uniform after UBO has been created. uniformName="+e);return}this.addUniform(e,i),r=this._uniformLocations[e]}if(this._buffer||this.create(),this._dynamic)for(let s=0;s<i;s++)this._bufferData[r+s]=t[s];else{let s=!1;for(let a=0;a<i;a++)(i===16&&!this._engine._features.uniformBufferHardCheckMatrix||this._bufferData[r+a]!==Math.fround(t[a]))&&(s=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[r+a]=t[a]);this._needSync=this._needSync||s}}updateUniformArray(e,t,i){this._checkNewFrame();const r=this._uniformLocations[e];if(r===void 0){ee.Error("Cannot add an uniform Array dynamically. Please, add it using addUniform and make sure that uniform buffers are supported by the current engine.");return}this._buffer||this.create();const s=this._uniformArraySizes[e];if(this._dynamic)for(let a=0;a<i;a++)this._bufferData[r+a]=t[a];else{let a=!1,l=0,o=0;for(let c=0;c<i;c++)if(this._bufferData[r+o*4+l]!==X.FloatRound(t[c])&&(a=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[r+o*4+l]=t[c]),l++,l===s.strideSize){for(;l<4;l++)this._bufferData[r+o*4+l]=0;l=0,o++}this._needSync=this._needSync||a}}_cacheMatrix(e,t){this._checkNewFrame();const i=this._valueCache[e],r=t.updateFlag;return i!==void 0&&i===r?!1:(this._valueCache[e]=r,!0)}_updateMatrix3x3ForUniform(e,t){for(let i=0;i<3;i++)me._TempBuffer[i*4]=t[i*3],me._TempBuffer[i*4+1]=t[i*3+1],me._TempBuffer[i*4+2]=t[i*3+2],me._TempBuffer[i*4+3]=0;this.updateUniform(e,me._TempBuffer,12)}_updateMatrix3x3ForEffect(e,t){this._currentEffect.setMatrix3x3(e,t)}_updateMatrix2x2ForEffect(e,t){this._currentEffect.setMatrix2x2(e,t)}_updateMatrix2x2ForUniform(e,t){for(let i=0;i<2;i++)me._TempBuffer[i*4]=t[i*2],me._TempBuffer[i*4+1]=t[i*2+1],me._TempBuffer[i*4+2]=0,me._TempBuffer[i*4+3]=0;this.updateUniform(e,me._TempBuffer,8)}_updateFloatForEffect(e,t){this._currentEffect.setFloat(e,t)}_updateFloatForUniform(e,t){me._TempBuffer[0]=t,this.updateUniform(e,me._TempBuffer,1)}_updateFloat2ForEffect(e,t,i,r=""){this._currentEffect.setFloat2(e+r,t,i)}_updateFloat2ForUniform(e,t,i){me._TempBuffer[0]=t,me._TempBuffer[1]=i,this.updateUniform(e,me._TempBuffer,2)}_updateFloat3ForEffect(e,t,i,r,s=""){this._currentEffect.setFloat3(e+s,t,i,r)}_updateFloat3ForUniform(e,t,i,r){me._TempBuffer[0]=t,me._TempBuffer[1]=i,me._TempBuffer[2]=r,this.updateUniform(e,me._TempBuffer,3)}_updateFloat4ForEffect(e,t,i,r,s,a=""){this._currentEffect.setFloat4(e+a,t,i,r,s)}_updateFloat4ForUniform(e,t,i,r,s){me._TempBuffer[0]=t,me._TempBuffer[1]=i,me._TempBuffer[2]=r,me._TempBuffer[3]=s,this.updateUniform(e,me._TempBuffer,4)}_updateFloatArrayForEffect(e,t){this._currentEffect.setFloatArray(e,t)}_updateFloatArrayForUniform(e,t){this.updateUniformArray(e,t,t.length)}_updateArrayForEffect(e,t){this._currentEffect.setArray(e,t)}_updateArrayForUniform(e,t){this.updateUniformArray(e,t,t.length)}_updateIntArrayForEffect(e,t){this._currentEffect.setIntArray(e,t)}_updateIntArrayForUniform(e,t){me._TempBufferInt32View.set(t),this.updateUniformArray(e,me._TempBuffer,t.length)}_updateUIntArrayForEffect(e,t){this._currentEffect.setUIntArray(e,t)}_updateUIntArrayForUniform(e,t){me._TempBufferUInt32View.set(t),this.updateUniformArray(e,me._TempBuffer,t.length)}_updateMatrixForEffect(e,t){this._currentEffect.setMatrix(e,t)}_updateMatrixForUniform(e,t){this._cacheMatrix(e,t)&&this.updateUniform(e,t.asArray(),16)}_updateMatricesForEffect(e,t){this._currentEffect.setMatrices(e,t)}_updateMatricesForUniform(e,t){this.updateUniform(e,t,t.length)}_updateVector3ForEffect(e,t){this._currentEffect.setVector3(e,t)}_updateVector3ForUniform(e,t){me._TempBuffer[0]=t.x,me._TempBuffer[1]=t.y,me._TempBuffer[2]=t.z,this.updateUniform(e,me._TempBuffer,3)}_updateVector4ForEffect(e,t){this._currentEffect.setVector4(e,t)}_updateVector4ForUniform(e,t){me._TempBuffer[0]=t.x,me._TempBuffer[1]=t.y,me._TempBuffer[2]=t.z,me._TempBuffer[3]=t.w,this.updateUniform(e,me._TempBuffer,4)}_updateColor3ForEffect(e,t,i=""){this._currentEffect.setColor3(e+i,t)}_updateColor3ForUniform(e,t){me._TempBuffer[0]=t.r,me._TempBuffer[1]=t.g,me._TempBuffer[2]=t.b,this.updateUniform(e,me._TempBuffer,3)}_updateColor4ForEffect(e,t,i,r=""){this._currentEffect.setColor4(e+r,t,i)}_updateDirectColor4ForEffect(e,t,i=""){this._currentEffect.setDirectColor4(e+i,t)}_updateColor4ForUniform(e,t,i){me._TempBuffer[0]=t.r,me._TempBuffer[1]=t.g,me._TempBuffer[2]=t.b,me._TempBuffer[3]=i,this.updateUniform(e,me._TempBuffer,4)}_updateDirectColor4ForUniform(e,t){me._TempBuffer[0]=t.r,me._TempBuffer[1]=t.g,me._TempBuffer[2]=t.b,me._TempBuffer[3]=t.a,this.updateUniform(e,me._TempBuffer,4)}_updateIntForEffect(e,t,i=""){this._currentEffect.setInt(e+i,t)}_updateIntForUniform(e,t){me._TempBufferInt32View[0]=t,this.updateUniform(e,me._TempBuffer,1)}_updateInt2ForEffect(e,t,i,r=""){this._currentEffect.setInt2(e+r,t,i)}_updateInt2ForUniform(e,t,i){me._TempBufferInt32View[0]=t,me._TempBufferInt32View[1]=i,this.updateUniform(e,me._TempBuffer,2)}_updateInt3ForEffect(e,t,i,r,s=""){this._currentEffect.setInt3(e+s,t,i,r)}_updateInt3ForUniform(e,t,i,r){me._TempBufferInt32View[0]=t,me._TempBufferInt32View[1]=i,me._TempBufferInt32View[2]=r,this.updateUniform(e,me._TempBuffer,3)}_updateInt4ForEffect(e,t,i,r,s,a=""){this._currentEffect.setInt4(e+a,t,i,r,s)}_updateInt4ForUniform(e,t,i,r,s){me._TempBufferInt32View[0]=t,me._TempBufferInt32View[1]=i,me._TempBufferInt32View[2]=r,me._TempBufferInt32View[3]=s,this.updateUniform(e,me._TempBuffer,4)}_updateUIntForEffect(e,t,i=""){this._currentEffect.setUInt(e+i,t)}_updateUIntForUniform(e,t){me._TempBufferUInt32View[0]=t,this.updateUniform(e,me._TempBuffer,1)}_updateUInt2ForEffect(e,t,i,r=""){this._currentEffect.setUInt2(e+r,t,i)}_updateUInt2ForUniform(e,t,i){me._TempBufferUInt32View[0]=t,me._TempBufferUInt32View[1]=i,this.updateUniform(e,me._TempBuffer,2)}_updateUInt3ForEffect(e,t,i,r,s=""){this._currentEffect.setUInt3(e+s,t,i,r)}_updateUInt3ForUniform(e,t,i,r){me._TempBufferUInt32View[0]=t,me._TempBufferUInt32View[1]=i,me._TempBufferUInt32View[2]=r,this.updateUniform(e,me._TempBuffer,3)}_updateUInt4ForEffect(e,t,i,r,s,a=""){this._currentEffect.setUInt4(e+a,t,i,r,s)}_updateUInt4ForUniform(e,t,i,r,s){me._TempBufferUInt32View[0]=t,me._TempBufferUInt32View[1]=i,me._TempBufferUInt32View[2]=r,me._TempBufferUInt32View[3]=s,this.updateUniform(e,me._TempBuffer,4)}setTexture(e,t){this._currentEffect.setTexture(e,t)}bindTexture(e,t){this._currentEffect._bindTexture(e,t)}updateUniformDirectly(e,t){this.updateUniform(e,t,t.length),this.update()}bindToEffect(e,t){this._currentEffect=e,this._currentEffectName=t}bindUniformBuffer(){!this._noUBO&&this._buffer&&this._currentEffect&&this._currentEffect.bindUniformBuffer(this._buffer,this._currentEffectName)}unbindEffect(){this._currentEffect=void 0,this._currentEffectName=void 0}setDataBuffer(e){if(!this._buffers)return this._buffer===e;for(let t=0;t<this._buffers.length;++t)if(this._buffers[t][0]===e)return this._bufferIndex=t,this._buffer=e,this._createBufferOnWrite=!1,this._currentEffect=void 0,!0;return!1}dispose(){if(this._noUBO)return;const e=this._engine._uniformBuffers,t=e.indexOf(this);if(t!==-1&&(e[t]=e[e.length-1],e.pop()),this._engine._features.trackUbosInFrame&&this._buffers)for(let i=0;i<this._buffers.length;++i){const r=this._buffers[i][0];this._engine._releaseBuffer(r)}else this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)}}me._UpdatedUbosInFrame={};me._MAX_UNIFORM_SIZE=256;me._TempBuffer=new Float32Array(me._MAX_UNIFORM_SIZE);me._TempBufferInt32View=new Int32Array(me._TempBuffer.buffer);me._TempBufferUInt32View=new Uint32Array(me._TempBuffer.buffer);class ou{get isDisposed(){return this._isDisposed}constructor(e,t,i,r=0,s=!1,a=!1,l=!1,o,c){this._isAlreadyOwned=!1,this._isDisposed=!1,e&&e.getScene?this._engine=e.getScene().getEngine():this._engine=e,this._updatable=i,this._instanced=a,this._divisor=o||1,this._label=c,t instanceof Nu?(this._data=null,this._buffer=t):(this._data=t,this._buffer=null),this.byteStride=l?r:r*Float32Array.BYTES_PER_ELEMENT,s||this.create()}createVertexBuffer(e,t,i,r,s,a=!1,l){const o=a?t:t*Float32Array.BYTES_PER_ELEMENT,c=r?a?r:r*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new x(this._engine,this,e,this._updatable,!0,c,s===void 0?this._instanced:s,o,i,void 0,void 0,!0,this._divisor||l)}isUpdatable(){return this._updatable}getData(){return this._data}getBuffer(){return this._buffer}getStrideSize(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT}create(e=null){!e&&this._buffer||(e=e||this._data,e&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e),this._data=e):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(e,this._label),this._data=e):this._buffer=this._engine.createVertexBuffer(e,void 0,this._label)))}_rebuild(){if(this._data)this._buffer=null,this.create(this._data);else{if(!this._buffer)return;if(this._buffer.capacity>0){this._updatable?this._buffer=this._engine.createDynamicVertexBuffer(this._buffer.capacity,this._label):this._buffer=this._engine.createVertexBuffer(this._buffer.capacity,void 0,this._label);return}ee.Warn(`Missing data for buffer "${this._label}" ${this._buffer?"(uniqueId: "+this._buffer.uniqueId+")":""}. Buffer reconstruction failed.`),this._buffer=null}}update(e){this.create(e)}updateDirectly(e,t,i,r=!1){this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e,r?t:t*Float32Array.BYTES_PER_ELEMENT,i?i*this.byteStride:void 0),t===0&&i===void 0?this._data=e:this._data=null)}_increaseReferences(){if(this._buffer){if(!this._isAlreadyOwned){this._isAlreadyOwned=!0;return}this._buffer.references++}}dispose(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._isDisposed=!0,this._data=null,this._buffer=null)}}class x{get isDisposed(){return this._isDisposed}get instanceDivisor(){return this._instanceDivisor}set instanceDivisor(e){const t=e!=0;this._instanceDivisor=e,t!==this._instanced&&(this._instanced=t,this._computeHashCode())}get _maxVerticesCount(){const e=this.getData();return e?Array.isArray(e)?e.length/(this.byteStride/4)-this.byteOffset/4:(e.byteLength-this.byteOffset)/this.byteStride:0}constructor(e,t,i,r,s,a,l,o,c,u,h=!1,d=!1,f=1,_=!1){this._isDisposed=!1;let p=!1;if(this.engine=e,typeof r=="object"&&r!==null?(p=r.updatable??!1,s=r.postponeInternalCreation,a=r.stride,l=r.instanced,o=r.offset,c=r.size,u=r.type,h=r.normalized??!1,d=r.useBytes??!1,f=r.divisor??1,_=r.takeBufferOwnership??!1,this._label=r.label):p=!!r,t instanceof ou?(this._buffer=t,this._ownsBuffer=_):(this._buffer=new ou(e,t,p,a,s,l,d,f,this._label),this._ownsBuffer=!0),this.uniqueId=x._Counter++,this._kind=i,u===void 0){const E=this.getData();this.type=E?x.GetDataType(E):x.FLOAT}else this.type=u;const v=x.GetTypeByteLength(this.type);d?(this._size=c||(a?a/v:x.DeduceStride(i)),this.byteStride=a||this._buffer.byteStride||this._size*v,this.byteOffset=o||0):(this._size=c||a||x.DeduceStride(i),this.byteStride=a?a*v:this._buffer.byteStride||this._size*v,this.byteOffset=(o||0)*v),this.normalized=h,this._instanced=l!==void 0?l:!1,this._instanceDivisor=l?f:0,this._alignBuffer(),this._computeHashCode()}_computeHashCode(){this.hashCode=(this.type-5120<<0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)}_rebuild(){var e;(e=this._buffer)==null||e._rebuild()}getKind(){return this._kind}isUpdatable(){return this._buffer.isUpdatable()}getData(){return this._buffer.getData()}getFloatData(e,t){const i=this.getData();return i?x.GetFloatData(i,this._size,this.type,this.byteOffset,this.byteStride,this.normalized,e,t):null}getBuffer(){return this._buffer.getBuffer()}getWrapperBuffer(){return this._buffer}getStrideSize(){return this.byteStride/x.GetTypeByteLength(this.type)}getOffset(){return this.byteOffset/x.GetTypeByteLength(this.type)}getSize(e=!1){return e?this._size*x.GetTypeByteLength(this.type):this._size}getIsInstanced(){return this._instanced}getInstanceDivisor(){return this._instanceDivisor}create(e){this._buffer.create(e),this._alignBuffer()}update(e){this._buffer.update(e),this._alignBuffer()}updateDirectly(e,t,i=!1){this._buffer.updateDirectly(e,t,void 0,i),this._alignBuffer()}dispose(){this._ownsBuffer&&this._buffer.dispose(),this._isDisposed=!0}forEach(e,t){x.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,e,this.normalized,t)}_alignBuffer(){}static DeduceStride(e){switch(e){case x.UVKind:case x.UV2Kind:case x.UV3Kind:case x.UV4Kind:case x.UV5Kind:case x.UV6Kind:return 2;case x.NormalKind:case x.PositionKind:return 3;case x.ColorKind:case x.ColorInstanceKind:case x.MatricesIndicesKind:case x.MatricesIndicesExtraKind:case x.MatricesWeightsKind:case x.MatricesWeightsExtraKind:case x.TangentKind:return 4;default:throw new Error("Invalid kind '"+e+"'")}}static GetDataType(e){return e instanceof Int8Array?x.BYTE:e instanceof Uint8Array?x.UNSIGNED_BYTE:e instanceof Int16Array?x.SHORT:e instanceof Uint16Array?x.UNSIGNED_SHORT:e instanceof Int32Array?x.INT:e instanceof Uint32Array?x.UNSIGNED_INT:x.FLOAT}static GetTypeByteLength(e){switch(e){case x.BYTE:case x.UNSIGNED_BYTE:return 1;case x.SHORT:case x.UNSIGNED_SHORT:return 2;case x.INT:case x.UNSIGNED_INT:case x.FLOAT:return 4;default:throw new Error(`Invalid type '${e}'`)}}static ForEach(e,t,i,r,s,a,l,o){if(e instanceof Array){let c=t/4;const u=i/4;for(let h=0;h<a;h+=r){for(let d=0;d<r;d++)o(e[c+d],h+d);c+=u}}else{const c=e instanceof ArrayBuffer?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),u=x.GetTypeByteLength(s);for(let h=0;h<a;h+=r){let d=t;for(let f=0;f<r;f++){const _=x._GetFloatValue(c,s,d,l);o(_,h+f),d+=u}t+=i}}}static _GetFloatValue(e,t,i,r){switch(t){case x.BYTE:{let s=e.getInt8(i);return r&&(s=Math.max(s/127,-1)),s}case x.UNSIGNED_BYTE:{let s=e.getUint8(i);return r&&(s=s/255),s}case x.SHORT:{let s=e.getInt16(i,!0);return r&&(s=Math.max(s/32767,-1)),s}case x.UNSIGNED_SHORT:{let s=e.getUint16(i,!0);return r&&(s=s/65535),s}case x.INT:return e.getInt32(i,!0);case x.UNSIGNED_INT:return e.getUint32(i,!0);case x.FLOAT:return e.getFloat32(i,!0);default:throw new Error(`Invalid component type ${t}`)}}static GetFloatData(e,t,i,r,s,a,l,o){const c=t*x.GetTypeByteLength(i),u=l*t;if(i!==x.FLOAT||s!==c){const h=new Float32Array(u);return x.ForEach(e,r,s,t,i,u,a,(d,f)=>h[f]=d),h}if(!(e instanceof Array||e instanceof Float32Array)||r!==0||e.length!==u)if(e instanceof Array){const h=r/4;return e.slice(h,h+u)}else{if(e instanceof ArrayBuffer)return new Float32Array(e,r,u);{let h=e.byteOffset+r;if(o){const f=new Float32Array(u),_=new Float32Array(e.buffer,h,u);return f.set(_),f}const d=h%4;return d&&(h=Math.max(0,h-d)),new Float32Array(e.buffer,h,u)}}return o?e.slice():e}}x._Counter=0;x.BYTE=5120;x.UNSIGNED_BYTE=5121;x.SHORT=5122;x.UNSIGNED_SHORT=5123;x.INT=5124;x.UNSIGNED_INT=5125;x.FLOAT=5126;x.PositionKind="position";x.NormalKind="normal";x.TangentKind="tangent";x.UVKind="uv";x.UV2Kind="uv2";x.UV3Kind="uv3";x.UV4Kind="uv4";x.UV5Kind="uv5";x.UV6Kind="uv6";x.ColorKind="color";x.ColorInstanceKind="instanceColor";x.MatricesIndicesKind="matricesIndices";x.MatricesWeightsKind="matricesWeights";x.MatricesIndicesExtraKind="matricesIndicesExtra";x.MatricesWeightsExtraKind="matricesWeightsExtra";class Fs{constructor(){this.hit=!1,this.distance=0,this.pickedPoint=null,this.pickedMesh=null,this.bu=0,this.bv=0,this.faceId=-1,this.subMeshFaceId=-1,this.subMeshId=0,this.pickedSprite=null,this.thinInstanceIndex=-1,this.ray=null,this.originMesh=null,this.aimTransform=null,this.gripTransform=null}getNormal(e=!1,t=!0){if(!this.pickedMesh||t&&!this.pickedMesh.isVerticesDataPresent(x.NormalKind))return null;let i=this.pickedMesh.getIndices();(i==null?void 0:i.length)===0&&(i=null);let r;const s=V.Vector3[0],a=V.Vector3[1],l=V.Vector3[2];if(t){const c=this.pickedMesh.getVerticesData(x.NormalKind);let u=i?A.FromArrayToRef(c,i[this.faceId*3]*3,s):s.copyFromFloats(c[this.faceId*3*3],c[this.faceId*3*3+1],c[this.faceId*3*3+2]),h=i?A.FromArrayToRef(c,i[this.faceId*3+1]*3,a):a.copyFromFloats(c[(this.faceId*3+1)*3],c[(this.faceId*3+1)*3+1],c[(this.faceId*3+1)*3+2]),d=i?A.FromArrayToRef(c,i[this.faceId*3+2]*3,l):l.copyFromFloats(c[(this.faceId*3+2)*3],c[(this.faceId*3+2)*3+1],c[(this.faceId*3+2)*3+2]);u=u.scale(this.bu),h=h.scale(this.bv),d=d.scale(1-this.bu-this.bv),r=new A(u.x+h.x+d.x,u.y+h.y+d.y,u.z+h.z+d.z)}else{const c=this.pickedMesh.getVerticesData(x.PositionKind),u=i?A.FromArrayToRef(c,i[this.faceId*3]*3,s):s.copyFromFloats(c[this.faceId*3*3],c[this.faceId*3*3+1],c[this.faceId*3*3+2]),h=i?A.FromArrayToRef(c,i[this.faceId*3+1]*3,a):a.copyFromFloats(c[(this.faceId*3+1)*3],c[(this.faceId*3+1)*3+1],c[(this.faceId*3+1)*3+2]),d=i?A.FromArrayToRef(c,i[this.faceId*3+2]*3,l):l.copyFromFloats(c[(this.faceId*3+2)*3],c[(this.faceId*3+2)*3+1],c[(this.faceId*3+2)*3+2]),f=u.subtract(h),_=d.subtract(h);r=A.Cross(f,_)}const o=(c,u)=>{let h=c.getWorldMatrix();c.nonUniformScaling&&(V.Matrix[0].copyFrom(h),h=V.Matrix[0],h.setTranslationFromFloats(0,0,0),h.invert(),h.transposeToRef(V.Matrix[1]),h=V.Matrix[1]),A.TransformNormalToRef(u,h,u)};if(e&&o(this.pickedMesh,r),this.ray){const c=V.Vector3[0].copyFrom(r);e||o(this.pickedMesh,c),A.Dot(c,this.ray.direction)>0&&r.negateInPlace()}return r.normalize(),r}getTextureCoordinates(e=x.UVKind){if(!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(e))return null;const t=this.pickedMesh.getIndices();if(!t)return null;const i=this.pickedMesh.getVerticesData(e);if(!i)return null;let r=xe.FromArray(i,t[this.faceId*3]*2),s=xe.FromArray(i,t[this.faceId*3+1]*2),a=xe.FromArray(i,t[this.faceId*3+2]*2);return r=r.scale(this.bu),s=s.scale(this.bv),a=a.scale(1-this.bu-this.bv),new xe(r.x+s.x+a.x,r.y+s.y+a.y)}}class ki{constructor(e,t,i,r,s,a){this.source=e,this.pointerX=t,this.pointerY=i,this.meshUnderPointer=r,this.sourceEvent=s,this.additionalData=a}static CreateNew(e,t,i){const r=e.getScene();return new ki(e,r.pointerX,r.pointerY,r.meshUnderPointer||e,t,i)}static CreateNewFromSprite(e,t,i,r){return new ki(e,t.pointerX,t.pointerY,t.meshUnderPointer,i,r)}static CreateNewFromScene(e,t){return new ki(null,e.pointerX,e.pointerY,e.meshUnderPointer,t)}static CreateNewFromPrimitive(e,t,i,r){return new ki(e,t.x,t.y,null,i,r)}}class Mp{constructor(e){this._vertexBuffers={},this._scene=e}_prepareBuffers(){if(this._vertexBuffers[x.PositionKind])return;const e=[];e.push(1,1),e.push(-1,1),e.push(-1,-1),e.push(1,-1),this._vertexBuffers[x.PositionKind]=new x(this._scene.getEngine(),e,x.PositionKind,!1,!1,2),this._buildIndexBuffer()}_buildIndexBuffer(){const e=[];e.push(0),e.push(1),e.push(2),e.push(0),e.push(2),e.push(3),this._indexBuffer=this._scene.getEngine().createIndexBuffer(e)}_rebuild(){const e=this._vertexBuffers[x.PositionKind];e&&(e._rebuild(),this._buildIndexBuffer())}_prepareFrame(e=null,t=null){const i=this._scene.activeCamera;return!i||(t=t||i._postProcesses.filter(r=>r!=null),!t||t.length===0||!this._scene.postProcessesEnabled)?!1:(t[0].activate(i,e,t!=null),!0)}directRender(e,t=null,i=!1,r=0,s=0,a=!1){var o;const l=this._scene.getEngine();for(let c=0;c<e.length;c++){c<e.length-1?e[c+1].activate(this._scene.activeCamera,t==null?void 0:t.texture):(t?l.bindFramebuffer(t,r,void 0,void 0,i,s):a||l.restoreDefaultFramebuffer(),(o=l._debugInsertMarker)==null||o.call(l,`post process ${e[c].name} output`));const u=e[c],h=u.apply();h&&(u.onBeforeRenderObservable.notifyObservers(h),this._prepareBuffers(),l.bindBuffers(this._vertexBuffers,this._indexBuffer,h),l.drawElementsType(0,0,6),u.onAfterRenderObservable.notifyObservers(h))}l.setDepthBuffer(!0),l.setDepthWrite(!0)}_finalizeFrame(e,t,i,r,s=!1){var o;const a=this._scene.activeCamera;if(!a||(r=r||a._postProcesses.filter(c=>c!=null),r.length===0||!this._scene.postProcessesEnabled))return;const l=this._scene.getEngine();for(let c=0,u=r.length;c<u;c++){const h=r[c];if(c<u-1?h._outputTexture=r[c+1].activate(a,t==null?void 0:t.texture):(t?(l.bindFramebuffer(t,i,void 0,void 0,s),h._outputTexture=t):(l.restoreDefaultFramebuffer(),h._outputTexture=null),(o=l._debugInsertMarker)==null||o.call(l,`post process ${r[c].name} output`)),e)break;const d=h.apply();d&&(h.onBeforeRenderObservable.notifyObservers(d),this._prepareBuffers(),l.bindBuffers(this._vertexBuffers,this._indexBuffer,d),l.drawElementsType(0,0,6),h.onAfterRenderObservable.notifyObservers(d))}l.setDepthBuffer(!0),l.setDepthWrite(!0),l.setAlphaMode(0)}dispose(){const e=this._vertexBuffers[x.PositionKind];e&&(e.dispose(),this._vertexBuffers[x.PositionKind]=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null)}}class Sn{set opaqueSortCompareFn(e){e?this._opaqueSortCompareFn=e:this._opaqueSortCompareFn=Sn.PainterSortCompare,this._renderOpaque=this._renderOpaqueSorted}set alphaTestSortCompareFn(e){e?this._alphaTestSortCompareFn=e:this._alphaTestSortCompareFn=Sn.PainterSortCompare,this._renderAlphaTest=this._renderAlphaTestSorted}set transparentSortCompareFn(e){e?this._transparentSortCompareFn=e:this._transparentSortCompareFn=Sn.defaultTransparentSortCompare,this._renderTransparent=this._renderTransparentSorted}constructor(e,t,i=null,r=null,s=null){this.index=e,this._opaqueSubMeshes=new or(256),this._transparentSubMeshes=new or(256),this._alphaTestSubMeshes=new or(256),this._depthOnlySubMeshes=new or(256),this._particleSystems=new or(256),this._spriteManagers=new or(256),this._empty=!0,this._edgesRenderers=new no(16),this._scene=t,this.opaqueSortCompareFn=i,this.alphaTestSortCompareFn=r,this.transparentSortCompareFn=s}render(e,t,i,r){if(e){e(this._opaqueSubMeshes,this._alphaTestSubMeshes,this._transparentSubMeshes,this._depthOnlySubMeshes);return}const s=this._scene.getEngine();this._depthOnlySubMeshes.length!==0&&(s.setColorWrite(!1),this._renderAlphaTest(this._depthOnlySubMeshes),s.setColorWrite(!0)),this._opaqueSubMeshes.length!==0&&this._renderOpaque(this._opaqueSubMeshes),this._alphaTestSubMeshes.length!==0&&this._renderAlphaTest(this._alphaTestSubMeshes);const a=s.getStencilBuffer();if(s.setStencilBuffer(!1),t&&this._renderSprites(),i&&this._renderParticles(r),this.onBeforeTransparentRendering&&this.onBeforeTransparentRendering(),this._transparentSubMeshes.length!==0||this._scene.useOrderIndependentTransparency){if(s.setStencilBuffer(a),this._scene.useOrderIndependentTransparency){const l=this._scene.depthPeelingRenderer.render(this._transparentSubMeshes);l.length&&this._renderTransparent(l)}else this._renderTransparent(this._transparentSubMeshes);s.setAlphaMode(0)}if(s.setStencilBuffer(!1),this._edgesRenderers.length){for(let l=0;l<this._edgesRenderers.length;l++)this._edgesRenderers.data[l].render();s.setAlphaMode(0)}s.setStencilBuffer(a)}_renderOpaqueSorted(e){Sn._RenderSorted(e,this._opaqueSortCompareFn,this._scene.activeCamera,!1)}_renderAlphaTestSorted(e){Sn._RenderSorted(e,this._alphaTestSortCompareFn,this._scene.activeCamera,!1)}_renderTransparentSorted(e){Sn._RenderSorted(e,this._transparentSortCompareFn,this._scene.activeCamera,!0)}static _RenderSorted(e,t,i,r){let s=0,a;const l=i?i.globalPosition:Sn._ZeroVector;if(r)for(;s<e.length;s++)a=e.data[s],a._alphaIndex=a.getMesh().alphaIndex,a._distanceToCamera=A.Distance(a.getBoundingInfo().boundingSphere.centerWorld,l);const o=e.length===e.data.length?e.data:e.data.slice(0,e.length);t&&o.sort(t);const c=o[0].getMesh().getScene();for(s=0;s<o.length;s++)if(a=o[s],!(c._activeMeshesFrozenButKeepClipping&&!a.isInFrustum(c._frustumPlanes))){if(r){const u=a.getMaterial();if(u&&u.needDepthPrePass){const h=u.getScene().getEngine();h.setColorWrite(!1),h.setAlphaMode(0),a.render(!1),h.setColorWrite(!0)}}a.render(r)}}static defaultTransparentSortCompare(e,t){return e._alphaIndex>t._alphaIndex?1:e._alphaIndex<t._alphaIndex?-1:Sn.backToFrontSortCompare(e,t)}static backToFrontSortCompare(e,t){return e._distanceToCamera<t._distanceToCamera?1:e._distanceToCamera>t._distanceToCamera?-1:0}static frontToBackSortCompare(e,t){return e._distanceToCamera<t._distanceToCamera?-1:e._distanceToCamera>t._distanceToCamera?1:0}static PainterSortCompare(e,t){const i=e.getMesh(),r=t.getMesh();return i.material&&r.material?i.material.uniqueId-r.material.uniqueId:i.uniqueId-r.uniqueId}prepare(){this._opaqueSubMeshes.reset(),this._transparentSubMeshes.reset(),this._alphaTestSubMeshes.reset(),this._depthOnlySubMeshes.reset(),this._particleSystems.reset(),this.prepareSprites(),this._edgesRenderers.reset(),this._empty=!0}prepareSprites(){this._spriteManagers.reset()}dispose(){this._opaqueSubMeshes.dispose(),this._transparentSubMeshes.dispose(),this._alphaTestSubMeshes.dispose(),this._depthOnlySubMeshes.dispose(),this._particleSystems.dispose(),this._spriteManagers.dispose(),this._edgesRenderers.dispose()}dispatch(e,t,i){t===void 0&&(t=e.getMesh()),i===void 0&&(i=e.getMaterial()),i!=null&&(i.needAlphaBlendingForMesh(t)?this._transparentSubMeshes.push(e):i.needAlphaTesting()?(i.needDepthPrePass&&this._depthOnlySubMeshes.push(e),this._alphaTestSubMeshes.push(e)):(i.needDepthPrePass&&this._depthOnlySubMeshes.push(e),this._opaqueSubMeshes.push(e)),t._renderingGroup=this,t._edgesRenderer&&t._edgesRenderer.isEnabled&&this._edgesRenderers.pushNoDuplicate(t._edgesRenderer),this._empty=!1)}dispatchSprites(e){this._spriteManagers.push(e),this._empty=!1}dispatchParticles(e){this._particleSystems.push(e),this._empty=!1}_renderParticles(e){if(this._particleSystems.length===0)return;const t=this._scene.activeCamera;this._scene.onBeforeParticlesRenderingObservable.notifyObservers(this._scene);for(let i=0;i<this._particleSystems.length;i++){const r=this._particleSystems.data[i];if((t&&t.layerMask&r.layerMask)===0)continue;const s=r.emitter;(!s.position||!e||e.indexOf(s)!==-1)&&this._scene._activeParticles.addCount(r.render(),!1)}this._scene.onAfterParticlesRenderingObservable.notifyObservers(this._scene)}_renderSprites(){if(!this._scene.spritesEnabled||this._spriteManagers.length===0)return;const e=this._scene.activeCamera;this._scene.onBeforeSpritesRenderingObservable.notifyObservers(this._scene);for(let t=0;t<this._spriteManagers.length;t++){const i=this._spriteManagers.data[t];(e&&e.layerMask&i.layerMask)!==0&&i.render()}this._scene.onAfterSpritesRenderingObservable.notifyObservers(this._scene)}}Sn._ZeroVector=A.Zero();class ON{}class ir{get maintainStateBetweenFrames(){return this._maintainStateBetweenFrames}set maintainStateBetweenFrames(e){e!==this._maintainStateBetweenFrames&&(this._maintainStateBetweenFrames=e,this._maintainStateBetweenFrames||this.restoreDispachedFlags())}restoreDispachedFlags(){for(const e of this._scene.meshes)if(e.subMeshes)for(const t of e.subMeshes)t._wasDispatched=!1;if(this._scene.spriteManagers)for(const e of this._scene.spriteManagers)e._wasDispatched=!1;for(const e of this._scene.particleSystems)e._wasDispatched=!1}constructor(e){this._useSceneAutoClearSetup=!1,this._renderingGroups=new Array,this._autoClearDepthStencil={},this._customOpaqueSortCompareFn={},this._customAlphaTestSortCompareFn={},this._customTransparentSortCompareFn={},this._renderingGroupInfo=new ON,this._maintainStateBetweenFrames=!1,this._scene=e;for(let t=ir.MIN_RENDERINGGROUPS;t<ir.MAX_RENDERINGGROUPS;t++)this._autoClearDepthStencil[t]={autoClear:!0,depth:!0,stencil:!0}}getRenderingGroup(e){const t=e||0;return this._prepareRenderingGroup(t),this._renderingGroups[t]}_clearDepthStencilBuffer(e=!0,t=!0){this._depthStencilBufferAlreadyCleaned||(this._scene.getEngine().clear(null,!1,e,t),this._depthStencilBufferAlreadyCleaned=!0)}render(e,t,i,r){const s=this._renderingGroupInfo;if(s.scene=this._scene,s.camera=this._scene.activeCamera,this._scene.spriteManagers&&r)for(let a=0;a<this._scene.spriteManagers.length;a++){const l=this._scene.spriteManagers[a];this.dispatchSprites(l)}for(let a=ir.MIN_RENDERINGGROUPS;a<ir.MAX_RENDERINGGROUPS;a++){this._depthStencilBufferAlreadyCleaned=a===ir.MIN_RENDERINGGROUPS;const l=this._renderingGroups[a];if(!l||l._empty)continue;const o=1<<a;if(s.renderingGroupId=a,this._scene.onBeforeRenderingGroupObservable.notifyObservers(s,o),ir.AUTOCLEAR){const c=this._useSceneAutoClearSetup?this._scene.getAutoClearDepthStencilSetup(a):this._autoClearDepthStencil[a];c&&c.autoClear&&this._clearDepthStencilBuffer(c.depth,c.stencil)}for(const c of this._scene._beforeRenderingGroupDrawStage)c.action(a);l.render(e,r,i,t);for(const c of this._scene._afterRenderingGroupDrawStage)c.action(a);this._scene.onAfterRenderingGroupObservable.notifyObservers(s,o)}}reset(){if(!this.maintainStateBetweenFrames)for(let e=ir.MIN_RENDERINGGROUPS;e<ir.MAX_RENDERINGGROUPS;e++){const t=this._renderingGroups[e];t&&t.prepare()}}resetSprites(){if(!this.maintainStateBetweenFrames)for(let e=ir.MIN_RENDERINGGROUPS;e<ir.MAX_RENDERINGGROUPS;e++){const t=this._renderingGroups[e];t&&t.prepareSprites()}}dispose(){this.freeRenderingGroups(),this._renderingGroups.length=0,this._renderingGroupInfo=null}freeRenderingGroups(){for(let e=ir.MIN_RENDERINGGROUPS;e<ir.MAX_RENDERINGGROUPS;e++){const t=this._renderingGroups[e];t&&t.dispose()}}_prepareRenderingGroup(e){this._renderingGroups[e]===void 0&&(this._renderingGroups[e]=new Sn(e,this._scene,this._customOpaqueSortCompareFn[e],this._customAlphaTestSortCompareFn[e],this._customTransparentSortCompareFn[e]))}dispatchSprites(e){this.maintainStateBetweenFrames&&e._wasDispatched||(e._wasDispatched=!0,this.getRenderingGroup(e.renderingGroupId).dispatchSprites(e))}dispatchParticles(e){this.maintainStateBetweenFrames&&e._wasDispatched||(e._wasDispatched=!0,this.getRenderingGroup(e.renderingGroupId).dispatchParticles(e))}dispatch(e,t,i){t===void 0&&(t=e.getMesh()),!(this.maintainStateBetweenFrames&&e._wasDispatched)&&(e._wasDispatched=!0,this.getRenderingGroup(t.renderingGroupId).dispatch(e,t,i))}setRenderingOrder(e,t=null,i=null,r=null){if(this._customOpaqueSortCompareFn[e]=t,this._customAlphaTestSortCompareFn[e]=i,this._customTransparentSortCompareFn[e]=r,this._renderingGroups[e]){const s=this._renderingGroups[e];s.opaqueSortCompareFn=this._customOpaqueSortCompareFn[e],s.alphaTestSortCompareFn=this._customAlphaTestSortCompareFn[e],s.transparentSortCompareFn=this._customTransparentSortCompareFn[e]}}setRenderingAutoClearDepthStencil(e,t,i=!0,r=!0){this._autoClearDepthStencil[e]={autoClear:t,depth:i,stencil:r}}getAutoClearDepthStencilSetup(e){return this._autoClearDepthStencil[e]}}ir.MAX_RENDERINGGROUPS=4;ir.MIN_RENDERINGGROUPS=0;ir.AUTOCLEAR=!0;class Oe{}Oe.NAME_EFFECTLAYER="EffectLayer";Oe.NAME_LAYER="Layer";Oe.NAME_LENSFLARESYSTEM="LensFlareSystem";Oe.NAME_BOUNDINGBOXRENDERER="BoundingBoxRenderer";Oe.NAME_PARTICLESYSTEM="ParticleSystem";Oe.NAME_GAMEPAD="Gamepad";Oe.NAME_SIMPLIFICATIONQUEUE="SimplificationQueue";Oe.NAME_GEOMETRYBUFFERRENDERER="GeometryBufferRenderer";Oe.NAME_PREPASSRENDERER="PrePassRenderer";Oe.NAME_DEPTHRENDERER="DepthRenderer";Oe.NAME_DEPTHPEELINGRENDERER="DepthPeelingRenderer";Oe.NAME_POSTPROCESSRENDERPIPELINEMANAGER="PostProcessRenderPipelineManager";Oe.NAME_SPRITE="Sprite";Oe.NAME_SUBSURFACE="SubSurface";Oe.NAME_OUTLINERENDERER="Outline";Oe.NAME_PROCEDURALTEXTURE="ProceduralTexture";Oe.NAME_SHADOWGENERATOR="ShadowGenerator";Oe.NAME_OCTREE="Octree";Oe.NAME_PHYSICSENGINE="PhysicsEngine";Oe.NAME_AUDIO="Audio";Oe.NAME_FLUIDRENDERER="FluidRenderer";Oe.STEP_ISREADYFORMESH_EFFECTLAYER=0;Oe.STEP_BEFOREEVALUATEACTIVEMESH_BOUNDINGBOXRENDERER=0;Oe.STEP_EVALUATESUBMESH_BOUNDINGBOXRENDERER=0;Oe.STEP_PREACTIVEMESH_BOUNDINGBOXRENDERER=0;Oe.STEP_CAMERADRAWRENDERTARGET_EFFECTLAYER=1;Oe.STEP_BEFORECAMERADRAW_PREPASS=0;Oe.STEP_BEFORECAMERADRAW_EFFECTLAYER=1;Oe.STEP_BEFORECAMERADRAW_LAYER=2;Oe.STEP_BEFORERENDERTARGETDRAW_PREPASS=0;Oe.STEP_BEFORERENDERTARGETDRAW_LAYER=1;Oe.STEP_BEFORERENDERINGMESH_PREPASS=0;Oe.STEP_BEFORERENDERINGMESH_OUTLINE=1;Oe.STEP_AFTERRENDERINGMESH_PREPASS=0;Oe.STEP_AFTERRENDERINGMESH_OUTLINE=1;Oe.STEP_AFTERRENDERINGGROUPDRAW_EFFECTLAYER_DRAW=0;Oe.STEP_AFTERRENDERINGGROUPDRAW_BOUNDINGBOXRENDERER=1;Oe.STEP_BEFORECAMERAUPDATE_SIMPLIFICATIONQUEUE=0;Oe.STEP_BEFORECAMERAUPDATE_GAMEPAD=1;Oe.STEP_BEFORECLEAR_PROCEDURALTEXTURE=0;Oe.STEP_BEFORECLEAR_PREPASS=1;Oe.STEP_BEFORERENDERTARGETCLEAR_PREPASS=0;Oe.STEP_AFTERRENDERTARGETDRAW_PREPASS=0;Oe.STEP_AFTERRENDERTARGETDRAW_LAYER=1;Oe.STEP_AFTERCAMERADRAW_PREPASS=0;Oe.STEP_AFTERCAMERADRAW_EFFECTLAYER=1;Oe.STEP_AFTERCAMERADRAW_LENSFLARESYSTEM=2;Oe.STEP_AFTERCAMERADRAW_EFFECTLAYER_DRAW=3;Oe.STEP_AFTERCAMERADRAW_LAYER=4;Oe.STEP_AFTERCAMERADRAW_FLUIDRENDERER=5;Oe.STEP_AFTERCAMERAPOSTPROCESS_LAYER=0;Oe.STEP_AFTERRENDERTARGETPOSTPROCESS_LAYER=0;Oe.STEP_AFTERRENDER_AUDIO=0;Oe.STEP_GATHERRENDERTARGETS_DEPTHRENDERER=0;Oe.STEP_GATHERRENDERTARGETS_GEOMETRYBUFFERRENDERER=1;Oe.STEP_GATHERRENDERTARGETS_SHADOWGENERATOR=2;Oe.STEP_GATHERRENDERTARGETS_POSTPROCESSRENDERPIPELINEMANAGER=3;Oe.STEP_GATHERACTIVECAMERARENDERTARGETS_DEPTHRENDERER=0;Oe.STEP_GATHERACTIVECAMERARENDERTARGETS_FLUIDRENDERER=1;Oe.STEP_POINTERMOVE_SPRITE=0;Oe.STEP_POINTERDOWN_SPRITE=0;Oe.STEP_POINTERUP_SPRITE=0;let ui=class _1 extends Array{constructor(e){super(...e)}static Create(){return Object.create(_1.prototype)}registerStep(e,t,i){let r=0,s=Number.MAX_VALUE;for(;r<this.length&&(s=this[r].index,!(e<s));r++);this.splice(r,0,{index:e,component:t,action:i.bind(t)})}clear(){this.length=0}};class be{}be.POINTERDOWN=1;be.POINTERUP=2;be.POINTERMOVE=4;be.POINTERWHEEL=8;be.POINTERPICK=16;be.POINTERTAP=32;be.POINTERDOUBLETAP=64;class p1{constructor(e,t){this.type=e,this.event=t}}class DN extends p1{constructor(e,t,i,r){super(e,t),this.ray=null,this.originalPickingInfo=null,this.skipOnPointerObservable=!1,this.localPosition=new xe(i,r)}}class ps extends p1{get pickInfo(){return this._pickInfo||this._generatePickInfo(),this._pickInfo}constructor(e,t,i,r=null){super(e,t),this._pickInfo=i,this._inputManager=r}_generatePickInfo(){this._inputManager&&(this._pickInfo=this._inputManager._pickMove(this.event),this._inputManager._setRayOnPointerInfo(this._pickInfo,this.event),this._inputManager=null)}}class Kr{constructor(){this.hoverCursor="",this.actions=[],this.isRecursive=!1}static get HasTriggers(){for(const e in Kr.Triggers)if(Object.prototype.hasOwnProperty.call(Kr.Triggers,e))return!0;return!1}static get HasPickTriggers(){for(const e in Kr.Triggers)if(Object.prototype.hasOwnProperty.call(Kr.Triggers,e)){const t=parseInt(e);if(t>=1&&t<=7)return!0}return!1}static HasSpecificTrigger(e){for(const t in Kr.Triggers)if(Object.prototype.hasOwnProperty.call(Kr.Triggers,t)&&parseInt(t)===e)return!0;return!1}}Kr.Triggers={};class So{}So.KEYDOWN=1;So.KEYUP=2;class Ip{constructor(e,t){this.type=e,this.event=t}}class $0 extends Ip{get skipOnPointerObservable(){return this.skipOnKeyboardObservable}set skipOnPointerObservable(e){this.skipOnKeyboardObservable=e}constructor(e,t){super(e,t),this.type=e,this.event=t,this.skipOnKeyboardObservable=!1}}var Re;(function(n){n[n.Generic=0]="Generic",n[n.Keyboard=1]="Keyboard",n[n.Mouse=2]="Mouse",n[n.Touch=3]="Touch",n[n.DualShock=4]="DualShock",n[n.Xbox=5]="Xbox",n[n.Switch=6]="Switch",n[n.DualSense=7]="DualSense"})(Re||(Re={}));var Le;(function(n){n[n.Horizontal=0]="Horizontal",n[n.Vertical=1]="Vertical",n[n.LeftClick=2]="LeftClick",n[n.MiddleClick=3]="MiddleClick",n[n.RightClick=4]="RightClick",n[n.BrowserBack=5]="BrowserBack",n[n.BrowserForward=6]="BrowserForward",n[n.MouseWheelX=7]="MouseWheelX",n[n.MouseWheelY=8]="MouseWheelY",n[n.MouseWheelZ=9]="MouseWheelZ",n[n.Move=12]="Move"})(Le||(Le={}));var ed;(function(n){n[n.Horizontal=0]="Horizontal",n[n.Vertical=1]="Vertical",n[n.LeftClick=2]="LeftClick",n[n.MiddleClick=3]="MiddleClick",n[n.RightClick=4]="RightClick",n[n.BrowserBack=5]="BrowserBack",n[n.BrowserForward=6]="BrowserForward",n[n.MouseWheelX=7]="MouseWheelX",n[n.MouseWheelY=8]="MouseWheelY",n[n.MouseWheelZ=9]="MouseWheelZ",n[n.DeltaHorizontal=10]="DeltaHorizontal",n[n.DeltaVertical=11]="DeltaVertical"})(ed||(ed={}));var Q0;(function(n){n[n.Cross=0]="Cross",n[n.Circle=1]="Circle",n[n.Square=2]="Square",n[n.Triangle=3]="Triangle",n[n.L1=4]="L1",n[n.R1=5]="R1",n[n.L2=6]="L2",n[n.R2=7]="R2",n[n.Share=8]="Share",n[n.Options=9]="Options",n[n.L3=10]="L3",n[n.R3=11]="R3",n[n.DPadUp=12]="DPadUp",n[n.DPadDown=13]="DPadDown",n[n.DPadLeft=14]="DPadLeft",n[n.DPadRight=15]="DPadRight",n[n.Home=16]="Home",n[n.TouchPad=17]="TouchPad",n[n.LStickXAxis=18]="LStickXAxis",n[n.LStickYAxis=19]="LStickYAxis",n[n.RStickXAxis=20]="RStickXAxis",n[n.RStickYAxis=21]="RStickYAxis"})(Q0||(Q0={}));var Z0;(function(n){n[n.Cross=0]="Cross",n[n.Circle=1]="Circle",n[n.Square=2]="Square",n[n.Triangle=3]="Triangle",n[n.L1=4]="L1",n[n.R1=5]="R1",n[n.L2=6]="L2",n[n.R2=7]="R2",n[n.Create=8]="Create",n[n.Options=9]="Options",n[n.L3=10]="L3",n[n.R3=11]="R3",n[n.DPadUp=12]="DPadUp",n[n.DPadDown=13]="DPadDown",n[n.DPadLeft=14]="DPadLeft",n[n.DPadRight=15]="DPadRight",n[n.Home=16]="Home",n[n.TouchPad=17]="TouchPad",n[n.LStickXAxis=18]="LStickXAxis",n[n.LStickYAxis=19]="LStickYAxis",n[n.RStickXAxis=20]="RStickXAxis",n[n.RStickYAxis=21]="RStickYAxis"})(Z0||(Z0={}));var J0;(function(n){n[n.A=0]="A",n[n.B=1]="B",n[n.X=2]="X",n[n.Y=3]="Y",n[n.LB=4]="LB",n[n.RB=5]="RB",n[n.LT=6]="LT",n[n.RT=7]="RT",n[n.Back=8]="Back",n[n.Start=9]="Start",n[n.LS=10]="LS",n[n.RS=11]="RS",n[n.DPadUp=12]="DPadUp",n[n.DPadDown=13]="DPadDown",n[n.DPadLeft=14]="DPadLeft",n[n.DPadRight=15]="DPadRight",n[n.Home=16]="Home",n[n.LStickXAxis=17]="LStickXAxis",n[n.LStickYAxis=18]="LStickYAxis",n[n.RStickXAxis=19]="RStickXAxis",n[n.RStickYAxis=20]="RStickYAxis"})(J0||(J0={}));var eE;(function(n){n[n.B=0]="B",n[n.A=1]="A",n[n.Y=2]="Y",n[n.X=3]="X",n[n.L=4]="L",n[n.R=5]="R",n[n.ZL=6]="ZL",n[n.ZR=7]="ZR",n[n.Minus=8]="Minus",n[n.Plus=9]="Plus",n[n.LS=10]="LS",n[n.RS=11]="RS",n[n.DPadUp=12]="DPadUp",n[n.DPadDown=13]="DPadDown",n[n.DPadLeft=14]="DPadLeft",n[n.DPadRight=15]="DPadRight",n[n.Home=16]="Home",n[n.Capture=17]="Capture",n[n.LStickXAxis=18]="LStickXAxis",n[n.LStickYAxis=19]="LStickYAxis",n[n.RStickXAxis=20]="RStickXAxis",n[n.RStickYAxis=21]="RStickYAxis"})(eE||(eE={}));var tE;(function(n){n[n.PointerMove=0]="PointerMove",n[n.PointerDown=1]="PointerDown",n[n.PointerUp=2]="PointerUp"})(tE||(tE={}));class tc{}tc.DOM_DELTA_PIXEL=0;tc.DOM_DELTA_LINE=1;tc.DOM_DELTA_PAGE=2;class so{static CreateDeviceEvent(e,t,i,r,s,a,l){switch(e){case Re.Keyboard:return this._CreateKeyboardEvent(i,r,s,a);case Re.Mouse:if(i===Le.MouseWheelX||i===Le.MouseWheelY||i===Le.MouseWheelZ)return this._CreateWheelEvent(e,t,i,r,s,a);case Re.Touch:return this._CreatePointerEvent(e,t,i,r,s,a,l);default:throw`Unable to generate event for device ${Re[e]}`}}static _CreatePointerEvent(e,t,i,r,s,a,l){const o=this._CreateMouseEvent(e,t,i,r,s,a);e===Re.Mouse?(o.deviceType=Re.Mouse,o.pointerId=1,o.pointerType="mouse"):(o.deviceType=Re.Touch,o.pointerId=l??t,o.pointerType="touch");let c=0;return c+=s.pollInput(e,t,Le.LeftClick),c+=s.pollInput(e,t,Le.RightClick)*2,c+=s.pollInput(e,t,Le.MiddleClick)*4,o.buttons=c,i===Le.Move?o.type="pointermove":i>=Le.LeftClick&&i<=Le.RightClick&&(o.type=r===1?"pointerdown":"pointerup",o.button=i-2),o}static _CreateWheelEvent(e,t,i,r,s,a){const l=this._CreateMouseEvent(e,t,i,r,s,a);switch(l.pointerId=1,l.type="wheel",l.deltaMode=tc.DOM_DELTA_PIXEL,l.deltaX=0,l.deltaY=0,l.deltaZ=0,i){case Le.MouseWheelX:l.deltaX=r;break;case Le.MouseWheelY:l.deltaY=r;break;case Le.MouseWheelZ:l.deltaZ=r;break}return l}static _CreateMouseEvent(e,t,i,r,s,a){const l=this._CreateEvent(a),o=s.pollInput(e,t,Le.Horizontal),c=s.pollInput(e,t,Le.Vertical);return a?(l.movementX=0,l.movementY=0,l.offsetX=l.movementX-a.getBoundingClientRect().x,l.offsetY=l.movementY-a.getBoundingClientRect().y):(l.movementX=s.pollInput(e,t,ed.DeltaHorizontal),l.movementY=s.pollInput(e,t,ed.DeltaVertical),l.offsetX=0,l.offsetY=0),this._CheckNonCharacterKeys(l,s),l.clientX=o,l.clientY=c,l.x=o,l.y=c,l.deviceType=e,l.deviceSlot=t,l.inputIndex=i,l}static _CreateKeyboardEvent(e,t,i,r){const s=this._CreateEvent(r);return this._CheckNonCharacterKeys(s,i),s.deviceType=Re.Keyboard,s.deviceSlot=0,s.inputIndex=e,s.type=t===1?"keydown":"keyup",s.key=String.fromCharCode(e),s.keyCode=e,s}static _CheckNonCharacterKeys(e,t){const i=t.isDeviceAvailable(Re.Keyboard),r=i&&t.pollInput(Re.Keyboard,0,18)===1,s=i&&t.pollInput(Re.Keyboard,0,17)===1,a=i&&(t.pollInput(Re.Keyboard,0,91)===1||t.pollInput(Re.Keyboard,0,92)===1||t.pollInput(Re.Keyboard,0,93)===1),l=i&&t.pollInput(Re.Keyboard,0,16)===1;e.altKey=r,e.ctrlKey=s,e.metaKey=a,e.shiftKey=l}static _CreateEvent(e){const t={};return t.preventDefault=()=>{},t.target=e,t}}class LN{constructor(e,t,i){this._nativeInput=_native.DeviceInputSystem?new _native.DeviceInputSystem(e,t,(r,s,a,l)=>{const o=so.CreateDeviceEvent(r,s,a,l,this);i(r,s,o)}):this._createDummyNativeInput()}pollInput(e,t,i){return this._nativeInput.pollInput(e,t,i)}isDeviceAvailable(e){return e===Re.Mouse||e===Re.Touch}dispose(){this._nativeInput.dispose()}_createDummyNativeInput(){return{pollInput:()=>0,isDeviceAvailable:()=>!1,dispose:()=>{}}}}const iE=255,rE=Object.keys(Le).length/2;class NN{constructor(e,t,i,r){this._inputs=[],this._keyboardActive=!1,this._pointerActive=!1,this._usingSafari=X.IsSafari(),this._usingMacOS=Lc()&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),this._keyboardDownEvent=s=>{},this._keyboardUpEvent=s=>{},this._keyboardBlurEvent=s=>{},this._pointerMoveEvent=s=>{},this._pointerDownEvent=s=>{},this._pointerUpEvent=s=>{},this._pointerCancelEvent=s=>{},this._pointerWheelEvent=s=>{},this._pointerBlurEvent=s=>{},this._pointerMacOSChromeOutEvent=s=>{},this._eventsAttached=!1,this._mouseId=-1,this._isUsingFirefox=Lc()&&navigator.userAgent&&navigator.userAgent.indexOf("Firefox")!==-1,this._isUsingChromium=Lc()&&navigator.userAgent&&navigator.userAgent.indexOf("Chrome")!==-1,this._maxTouchPoints=0,this._pointerInputClearObserver=null,this._gamepadConnectedEvent=s=>{},this._gamepadDisconnectedEvent=s=>{},this._eventPrefix=X.GetPointerPrefix(e),this._engine=e,this._onDeviceConnected=t,this._onDeviceDisconnected=i,this._onInputChanged=r,this._mouseId=this._isUsingFirefox?0:1,this._enableEvents(),this._usingMacOS&&(this._metaKeys=[]),this._engine._onEngineViewChanged||(this._engine._onEngineViewChanged=()=>{this._enableEvents()})}pollInput(e,t,i){const r=this._inputs[e][t];if(!r)throw`Unable to find device ${Re[e]}`;e>=Re.DualShock&&e<=Re.DualSense&&this._updateDevice(e,t,i);const s=r[i];if(s===void 0)throw`Unable to find input ${i} for device ${Re[e]} in slot ${t}`;return i===Le.Move&&X.Warn("Unable to provide information for PointerInput.Move.  Try using PointerInput.Horizontal or PointerInput.Vertical for move data."),s}isDeviceAvailable(e){return this._inputs[e]!==void 0}dispose(){this._onDeviceConnected=()=>{},this._onDeviceDisconnected=()=>{},this._onInputChanged=()=>{},delete this._engine._onEngineViewChanged,this._elementToAttachTo&&this._disableEvents()}_enableEvents(){const e=this==null?void 0:this._engine.getInputElement();if(e&&(!this._eventsAttached||this._elementToAttachTo!==e)){if(this._disableEvents(),this._inputs){for(const t of this._inputs)if(t)for(const i in t){const r=+i,s=t[r];if(s)for(let a=0;a<s.length;a++)s[a]=0}}this._elementToAttachTo=e,this._elementToAttachTo.tabIndex=this._elementToAttachTo.tabIndex!==-1?this._elementToAttachTo.tabIndex:this._engine.canvasTabIndex,this._handleKeyActions(),this._handlePointerActions(),this._handleGamepadActions(),this._eventsAttached=!0,this._checkForConnectedDevices()}}_disableEvents(){this._elementToAttachTo&&(this._elementToAttachTo.removeEventListener("blur",this._keyboardBlurEvent),this._elementToAttachTo.removeEventListener("blur",this._pointerBlurEvent),this._elementToAttachTo.removeEventListener("keydown",this._keyboardDownEvent),this._elementToAttachTo.removeEventListener("keyup",this._keyboardUpEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"move",this._pointerMoveEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"down",this._pointerDownEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"up",this._pointerUpEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"cancel",this._pointerCancelEvent),this._elementToAttachTo.removeEventListener(this._wheelEventName,this._pointerWheelEvent),this._usingMacOS&&this._isUsingChromium&&this._elementToAttachTo.removeEventListener("lostpointercapture",this._pointerMacOSChromeOutEvent),window.removeEventListener("gamepadconnected",this._gamepadConnectedEvent),window.removeEventListener("gamepaddisconnected",this._gamepadDisconnectedEvent)),this._pointerInputClearObserver&&this._engine.onEndFrameObservable.remove(this._pointerInputClearObserver),this._eventsAttached=!1}_checkForConnectedDevices(){if(navigator.getGamepads){const e=navigator.getGamepads();for(const t of e)t&&this._addGamePad(t)}typeof matchMedia=="function"&&matchMedia("(pointer:fine)").matches&&this._addPointerDevice(Re.Mouse,0,0,0)}_addGamePad(e){const t=this._getGamepadDeviceType(e.id),i=e.index;this._gamepads=this._gamepads||new Array(e.index+1),this._registerDevice(t,i,e.buttons.length+e.axes.length),this._gamepads[i]=t}_addPointerDevice(e,t,i,r){this._pointerActive||(this._pointerActive=!0),this._registerDevice(e,t,rE);const s=this._inputs[e][t];s[0]=i,s[1]=r}_registerDevice(e,t,i){if(t===void 0)throw`Unable to register device ${Re[e]} to undefined slot.`;if(this._inputs[e]||(this._inputs[e]={}),!this._inputs[e][t]){const r=new Array(i);r.fill(0),this._inputs[e][t]=r,this._onDeviceConnected(e,t)}}_unregisterDevice(e,t){this._inputs[e][t]&&(delete this._inputs[e][t],this._onDeviceDisconnected(e,t))}_handleKeyActions(){this._keyboardDownEvent=e=>{this._keyboardActive||(this._keyboardActive=!0,this._registerDevice(Re.Keyboard,0,iE));const t=this._inputs[Re.Keyboard][0];if(t){t[e.keyCode]=1;const i=e;i.inputIndex=e.keyCode,this._usingMacOS&&e.metaKey&&e.key!=="Meta"&&(this._metaKeys.includes(e.keyCode)||this._metaKeys.push(e.keyCode)),this._onInputChanged(Re.Keyboard,0,i)}},this._keyboardUpEvent=e=>{this._keyboardActive||(this._keyboardActive=!0,this._registerDevice(Re.Keyboard,0,iE));const t=this._inputs[Re.Keyboard][0];if(t){t[e.keyCode]=0;const i=e;if(i.inputIndex=e.keyCode,this._usingMacOS&&e.key==="Meta"&&this._metaKeys.length>0){for(const r of this._metaKeys){const s=so.CreateDeviceEvent(Re.Keyboard,0,r,0,this,this._elementToAttachTo);t[r]=0,this._onInputChanged(Re.Keyboard,0,s)}this._metaKeys.splice(0,this._metaKeys.length)}this._onInputChanged(Re.Keyboard,0,i)}},this._keyboardBlurEvent=()=>{if(this._keyboardActive){const e=this._inputs[Re.Keyboard][0];for(let t=0;t<e.length;t++)if(e[t]!==0){e[t]=0;const i=so.CreateDeviceEvent(Re.Keyboard,0,t,0,this,this._elementToAttachTo);this._onInputChanged(Re.Keyboard,0,i)}this._usingMacOS&&this._metaKeys.splice(0,this._metaKeys.length)}},this._elementToAttachTo.addEventListener("keydown",this._keyboardDownEvent),this._elementToAttachTo.addEventListener("keyup",this._keyboardUpEvent),this._elementToAttachTo.addEventListener("blur",this._keyboardBlurEvent)}_handlePointerActions(){this._maxTouchPoints=Lc()&&navigator.maxTouchPoints||2,this._activeTouchIds||(this._activeTouchIds=new Array(this._maxTouchPoints));for(let i=0;i<this._maxTouchPoints;i++)this._activeTouchIds[i]=-1;this._pointerMoveEvent=i=>{const r=this._getPointerType(i);let s=r===Re.Mouse?0:this._activeTouchIds.indexOf(i.pointerId);if(r===Re.Touch&&s===-1){const l=this._activeTouchIds.indexOf(-1);if(l>=0)s=l,this._activeTouchIds[l]=i.pointerId,this._onDeviceConnected(r,s);else{X.Warn(`Max number of touches exceeded.  Ignoring touches in excess of ${this._maxTouchPoints}`);return}}this._inputs[r]||(this._inputs[r]={}),this._inputs[r][s]||this._addPointerDevice(r,s,i.clientX,i.clientY);const a=this._inputs[r][s];if(a){const l=i;l.inputIndex=Le.Move,a[Le.Horizontal]=i.clientX,a[Le.Vertical]=i.clientY,r===Re.Touch&&a[Le.LeftClick]===0&&(a[Le.LeftClick]=1),i.pointerId===void 0&&(i.pointerId=this._mouseId),this._onInputChanged(r,s,l),!this._usingSafari&&i.button!==-1&&(l.inputIndex=i.button+2,a[i.button+2]=a[i.button+2]?0:1,this._onInputChanged(r,s,l))}},this._pointerDownEvent=i=>{const r=this._getPointerType(i);let s=r===Re.Mouse?0:i.pointerId;if(r===Re.Touch){const l=this._activeTouchIds.indexOf(-1);if(l>=0)s=l,this._activeTouchIds[l]=i.pointerId;else{X.Warn(`Max number of touches exceeded.  Ignoring touches in excess of ${this._maxTouchPoints}`);return}}this._inputs[r]||(this._inputs[r]={}),this._inputs[r][s]?r===Re.Touch&&this._onDeviceConnected(r,s):this._addPointerDevice(r,s,i.clientX,i.clientY);const a=this._inputs[r][s];if(a){const l=a[Le.Horizontal],o=a[Le.Vertical];if(r===Re.Mouse){if(i.pointerId===void 0&&(i.pointerId=this._mouseId),!document.pointerLockElement)try{this._elementToAttachTo.setPointerCapture(this._mouseId)}catch{}}else if(i.pointerId&&!document.pointerLockElement)try{this._elementToAttachTo.setPointerCapture(i.pointerId)}catch{}a[Le.Horizontal]=i.clientX,a[Le.Vertical]=i.clientY,a[i.button+2]=1;const c=i;c.inputIndex=i.button+2,this._onInputChanged(r,s,c),(l!==i.clientX||o!==i.clientY)&&(c.inputIndex=Le.Move,this._onInputChanged(r,s,c))}},this._pointerUpEvent=i=>{var l,o,c,u,h;const r=this._getPointerType(i),s=r===Re.Mouse?0:this._activeTouchIds.indexOf(i.pointerId);if(r===Re.Touch){if(s===-1)return;this._activeTouchIds[s]=-1}const a=(l=this._inputs[r])==null?void 0:l[s];if(a&&a[i.button+2]!==0){const d=a[Le.Horizontal],f=a[Le.Vertical];a[Le.Horizontal]=i.clientX,a[Le.Vertical]=i.clientY,a[i.button+2]=0;const _=i;i.pointerId===void 0&&(i.pointerId=this._mouseId),(d!==i.clientX||f!==i.clientY)&&(_.inputIndex=Le.Move,this._onInputChanged(r,s,_)),_.inputIndex=i.button+2,r===Re.Mouse&&this._mouseId>=0&&((c=(o=this._elementToAttachTo).hasPointerCapture)!=null&&c.call(o,this._mouseId))?this._elementToAttachTo.releasePointerCapture(this._mouseId):i.pointerId&&((h=(u=this._elementToAttachTo).hasPointerCapture)!=null&&h.call(u,i.pointerId))&&this._elementToAttachTo.releasePointerCapture(i.pointerId),this._onInputChanged(r,s,_),r===Re.Touch&&this._onDeviceDisconnected(r,s)}},this._pointerCancelEvent=i=>{var r,s,a,l;if(i.pointerType==="mouse"){const o=this._inputs[Re.Mouse][0];this._mouseId>=0&&((s=(r=this._elementToAttachTo).hasPointerCapture)!=null&&s.call(r,this._mouseId))&&this._elementToAttachTo.releasePointerCapture(this._mouseId);for(let c=Le.LeftClick;c<=Le.BrowserForward;c++)if(o[c]===1){o[c]=0;const u=so.CreateDeviceEvent(Re.Mouse,0,c,0,this,this._elementToAttachTo);this._onInputChanged(Re.Mouse,0,u)}}else{const o=this._activeTouchIds.indexOf(i.pointerId);if(o===-1)return;(l=(a=this._elementToAttachTo).hasPointerCapture)!=null&&l.call(a,i.pointerId)&&this._elementToAttachTo.releasePointerCapture(i.pointerId),this._inputs[Re.Touch][o][Le.LeftClick]=0;const c=so.CreateDeviceEvent(Re.Touch,o,Le.LeftClick,0,this,this._elementToAttachTo,i.pointerId);this._onInputChanged(Re.Touch,o,c),this._activeTouchIds[o]=-1,this._onDeviceDisconnected(Re.Touch,o)}},this._wheelEventName="onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll";let e=!1;const t=function(){};try{const i=Object.defineProperty({},"passive",{get:function(){e=!0}});this._elementToAttachTo.addEventListener("test",t,i),this._elementToAttachTo.removeEventListener("test",t,i)}catch{}this._pointerBlurEvent=()=>{var i,r,s,a,l;if(this.isDeviceAvailable(Re.Mouse)){const o=this._inputs[Re.Mouse][0];this._mouseId>=0&&((r=(i=this._elementToAttachTo).hasPointerCapture)!=null&&r.call(i,this._mouseId))&&this._elementToAttachTo.releasePointerCapture(this._mouseId);for(let c=Le.LeftClick;c<=Le.BrowserForward;c++)if(o[c]===1){o[c]=0;const u=so.CreateDeviceEvent(Re.Mouse,0,c,0,this,this._elementToAttachTo);this._onInputChanged(Re.Mouse,0,u)}}if(this.isDeviceAvailable(Re.Touch)){const o=this._inputs[Re.Touch];for(let c=0;c<this._activeTouchIds.length;c++){const u=this._activeTouchIds[c];if((a=(s=this._elementToAttachTo).hasPointerCapture)!=null&&a.call(s,u)&&this._elementToAttachTo.releasePointerCapture(u),u!==-1&&((l=o[c])==null?void 0:l[Le.LeftClick])===1){o[c][Le.LeftClick]=0;const h=so.CreateDeviceEvent(Re.Touch,c,Le.LeftClick,0,this,this._elementToAttachTo,u);this._onInputChanged(Re.Touch,c,h),this._activeTouchIds[c]=-1,this._onDeviceDisconnected(Re.Touch,c)}}}},this._pointerWheelEvent=i=>{const r=Re.Mouse,s=0;this._inputs[r]||(this._inputs[r]=[]),this._inputs[r][s]||(this._pointerActive=!0,this._registerDevice(r,s,rE));const a=this._inputs[r][s];if(a){a[Le.MouseWheelX]=i.deltaX||0,a[Le.MouseWheelY]=i.deltaY||i.wheelDelta||0,a[Le.MouseWheelZ]=i.deltaZ||0;const l=i;i.pointerId===void 0&&(i.pointerId=this._mouseId),a[Le.MouseWheelX]!==0&&(l.inputIndex=Le.MouseWheelX,this._onInputChanged(r,s,l)),a[Le.MouseWheelY]!==0&&(l.inputIndex=Le.MouseWheelY,this._onInputChanged(r,s,l)),a[Le.MouseWheelZ]!==0&&(l.inputIndex=Le.MouseWheelZ,this._onInputChanged(r,s,l))}},this._usingMacOS&&this._isUsingChromium&&(this._pointerMacOSChromeOutEvent=i=>{i.buttons>1&&this._pointerCancelEvent(i)},this._elementToAttachTo.addEventListener("lostpointercapture",this._pointerMacOSChromeOutEvent)),this._elementToAttachTo.addEventListener(this._eventPrefix+"move",this._pointerMoveEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"down",this._pointerDownEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"up",this._pointerUpEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"cancel",this._pointerCancelEvent),this._elementToAttachTo.addEventListener("blur",this._pointerBlurEvent),this._elementToAttachTo.addEventListener(this._wheelEventName,this._pointerWheelEvent,e?{passive:!1}:!1),this._pointerInputClearObserver=this._engine.onEndFrameObservable.add(()=>{if(this.isDeviceAvailable(Re.Mouse)){const i=this._inputs[Re.Mouse][0];i[Le.MouseWheelX]=0,i[Le.MouseWheelY]=0,i[Le.MouseWheelZ]=0}})}_handleGamepadActions(){this._gamepadConnectedEvent=e=>{this._addGamePad(e.gamepad)},this._gamepadDisconnectedEvent=e=>{if(this._gamepads){const t=this._getGamepadDeviceType(e.gamepad.id),i=e.gamepad.index;this._unregisterDevice(t,i),delete this._gamepads[i]}},window.addEventListener("gamepadconnected",this._gamepadConnectedEvent),window.addEventListener("gamepaddisconnected",this._gamepadDisconnectedEvent)}_updateDevice(e,t,i){const r=navigator.getGamepads()[t];if(r&&e===this._gamepads[t]){const s=this._inputs[e][t];i>=r.buttons.length?s[i]=r.axes[i-r.buttons.length].valueOf():s[i]=r.buttons[i].value}}_getGamepadDeviceType(e){return e.indexOf("054c")!==-1?e.indexOf("0ce6")!==-1?Re.DualSense:Re.DualShock:e.indexOf("Xbox One")!==-1||e.search("Xbox 360")!==-1||e.search("xinput")!==-1?Re.Xbox:e.indexOf("057e")!==-1?Re.Switch:Re.Generic}_getPointerType(e){let t=Re.Mouse;return(e.pointerType==="touch"||e.pointerType==="pen"||e.touches)&&(t=Re.Touch),t}}class nE{constructor(e,t,i=0){this.deviceType=t,this.deviceSlot=i,this.onInputChangedObservable=new Y,this._deviceInputSystem=e}getInput(e){return this._deviceInputSystem.pollInput(this.deviceType,this.deviceSlot,e)}}class FN{constructor(e){this._registeredManagers=new Array,this._refCount=0,this.registerManager=a=>{for(let l=0;l<this._devices.length;l++){const o=this._devices[l];for(const c in o){const u=+c;a._addDevice(new nE(this._deviceInputSystem,l,u))}}this._registeredManagers.push(a)},this.unregisterManager=a=>{const l=this._registeredManagers.indexOf(a);l>-1&&this._registeredManagers.splice(l,1)};const t=Object.keys(Re).length/2;this._devices=new Array(t);const i=(a,l)=>{this._devices[a]||(this._devices[a]=new Array),this._devices[a][l]||(this._devices[a][l]=l);for(const o of this._registeredManagers){const c=new nE(this._deviceInputSystem,a,l);o._addDevice(c)}},r=(a,l)=>{var o;(o=this._devices[a])!=null&&o[l]&&delete this._devices[a][l];for(const c of this._registeredManagers)c._removeDevice(a,l)},s=(a,l,o)=>{if(o)for(const c of this._registeredManagers)c._onInputChanged(a,l,o)};typeof _native<"u"?this._deviceInputSystem=new LN(i,r,s):this._deviceInputSystem=new NN(e,i,r,s)}dispose(){this._deviceInputSystem.dispose()}}class kN{getDeviceSource(e,t){if(t===void 0){if(this._firstDevice[e]===void 0)return null;t=this._firstDevice[e]}return!this._devices[e]||this._devices[e][t]===void 0?null:this._devices[e][t]}getDeviceSources(e){return this._devices[e]?this._devices[e].filter(t=>!!t):[]}constructor(e){const t=Object.keys(Re).length/2;this._devices=new Array(t),this._firstDevice=new Array(t),this._engine=e,this._engine._deviceSourceManager||(this._engine._deviceSourceManager=new FN(e)),this._engine._deviceSourceManager._refCount++,this.onDeviceConnectedObservable=new Y(i=>{for(const r of this._devices)if(r)for(const s of r)s&&this.onDeviceConnectedObservable.notifyObserver(i,s)}),this.onDeviceDisconnectedObservable=new Y,this._engine._deviceSourceManager.registerManager(this),this._onDisposeObserver=e.onDisposeObservable.add(()=>{this.dispose()})}dispose(){this.onDeviceConnectedObservable.clear(),this.onDeviceDisconnectedObservable.clear(),this._engine._deviceSourceManager&&(this._engine._deviceSourceManager.unregisterManager(this),--this._engine._deviceSourceManager._refCount<1&&(this._engine._deviceSourceManager.dispose(),delete this._engine._deviceSourceManager)),this._engine.onDisposeObservable.remove(this._onDisposeObserver)}_addDevice(e){this._devices[e.deviceType]||(this._devices[e.deviceType]=new Array),this._devices[e.deviceType][e.deviceSlot]||(this._devices[e.deviceType][e.deviceSlot]=e,this._updateFirstDevices(e.deviceType)),this.onDeviceConnectedObservable.notifyObservers(e)}_removeDevice(e,t){var r,s;const i=(r=this._devices[e])==null?void 0:r[t];this.onDeviceDisconnectedObservable.notifyObservers(i),(s=this._devices[e])!=null&&s[t]&&delete this._devices[e][t],this._updateFirstDevices(e)}_onInputChanged(e,t,i){var r,s;(s=(r=this._devices[e])==null?void 0:r[t])==null||s.onInputChangedObservable.notifyObservers(i)}_updateFirstDevices(e){switch(e){case Re.Keyboard:case Re.Mouse:this._firstDevice[e]=0;break;case Re.Touch:case Re.DualSense:case Re.DualShock:case Re.Xbox:case Re.Switch:case Re.Generic:{delete this._firstDevice[e];const t=this._devices[e];if(t){for(let i=0;i<t.length;i++)if(t[i]){this._firstDevice[e]=i;break}}break}}}}class sE{constructor(){this._singleClick=!1,this._doubleClick=!1,this._hasSwiped=!1,this._ignore=!1}get singleClick(){return this._singleClick}get doubleClick(){return this._doubleClick}get hasSwiped(){return this._hasSwiped}get ignore(){return this._ignore}set singleClick(e){this._singleClick=e}set doubleClick(e){this._doubleClick=e}set hasSwiped(e){this._hasSwiped=e}set ignore(e){this._ignore=e}}class ni{constructor(e){this._alreadyAttached=!1,this._meshPickProceed=!1,this._currentPickResult=null,this._previousPickResult=null,this._totalPointersPressed=0,this._doubleClickOccured=!1,this._isSwiping=!1,this._swipeButtonPressed=-1,this._skipPointerTap=!1,this._isMultiTouchGesture=!1,this._pointerX=0,this._pointerY=0,this._startingPointerPosition=new xe(0,0),this._previousStartingPointerPosition=new xe(0,0),this._startingPointerTime=0,this._previousStartingPointerTime=0,this._pointerCaptures={},this._meshUnderPointerId={},this._movePointerInfo=null,this._cameraObserverCount=0,this._delayedClicks=[null,null,null,null,null],this._deviceSourceManager=null,this._scene=e||He.LastCreatedScene,this._scene}get meshUnderPointer(){return this._movePointerInfo&&(this._movePointerInfo._generatePickInfo(),this._movePointerInfo=null),this._pointerOverMesh}getMeshUnderPointerByPointerId(e){return this._meshUnderPointerId[e]||null}get unTranslatedPointer(){return new xe(this._unTranslatedPointerX,this._unTranslatedPointerY)}get pointerX(){return this._pointerX}set pointerX(e){this._pointerX=e}get pointerY(){return this._pointerY}set pointerY(e){this._pointerY=e}_updatePointerPosition(e){const t=this._scene.getEngine().getInputElementClientRect();t&&(this._pointerX=e.clientX-t.left,this._pointerY=e.clientY-t.top,this._unTranslatedPointerX=this._pointerX,this._unTranslatedPointerY=this._pointerY)}_processPointerMove(e,t){const i=this._scene,r=i.getEngine(),s=r.getInputElement();s&&(s.tabIndex=r.canvasTabIndex,i.doNotHandleCursors||(s.style.cursor=i.defaultCursor)),this._setCursorAndPointerOverMesh(e,t,i);for(const o of i._pointerMoveStage){e=e||this._pickMove(t);const c=!!(e!=null&&e.pickedMesh);e=o.action(this._unTranslatedPointerX,this._unTranslatedPointerY,e,c,s)}const a=t.inputIndex>=Le.MouseWheelX&&t.inputIndex<=Le.MouseWheelZ?be.POINTERWHEEL:be.POINTERMOVE;i.onPointerMove&&(e=e||this._pickMove(t),i.onPointerMove(t,e,a));let l;e?(l=new ps(a,t,e),this._setRayOnPointerInfo(e,t)):(l=new ps(a,t,null,this),this._movePointerInfo=l),i.onPointerObservable.hasObservers()&&i.onPointerObservable.notifyObservers(l,a)}_setRayOnPointerInfo(e,t){const i=this._scene;e&&i._pickingAvailable&&(e.ray||(e.ray=i.createPickingRay(t.offsetX,t.offsetY,z.Identity(),i.activeCamera)))}_addCameraPointerObserver(e,t){return this._cameraObserverCount++,this._scene.onPointerObservable.add(e,t)}_removeCameraPointerObserver(e){return this._cameraObserverCount--,this._scene.onPointerObservable.remove(e)}_checkForPicking(){return!!(this._scene.onPointerObservable.observers.length>this._cameraObserverCount||this._scene.onPointerPick)}_checkPrePointerObservable(e,t,i){const r=this._scene,s=new DN(i,t,this._unTranslatedPointerX,this._unTranslatedPointerY);return e&&(s.originalPickingInfo=e,s.ray=e.ray,t.pointerType==="xr-near"&&e.originMesh&&(s.nearInteractionPickingInfo=e)),r.onPrePointerObservable.notifyObservers(s,i),!!s.skipOnPointerObservable}_pickMove(e){const t=this._scene,i=t.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,t.pointerMovePredicate,t.pointerMoveFastCheck,t.cameraToUseForPointers,t.pointerMoveTrianglePredicate);return this._setCursorAndPointerOverMesh(i,e,t),i}_setCursorAndPointerOverMesh(e,t,i){const s=i.getEngine().getInputElement();if(e!=null&&e.pickedMesh){if(this.setPointerOverMesh(e.pickedMesh,t.pointerId,e,t),!i.doNotHandleCursors&&s&&this._pointerOverMesh){const a=this._pointerOverMesh._getActionManagerForTrigger();a&&a.hasPointerTriggers&&(s.style.cursor=a.hoverCursor||i.hoverCursor)}}else this.setPointerOverMesh(null,t.pointerId,e,t)}simulatePointerMove(e,t){const i=new PointerEvent("pointermove",t);i.inputIndex=Le.Move,!this._checkPrePointerObservable(e,i,be.POINTERMOVE)&&this._processPointerMove(e,i)}simulatePointerDown(e,t){const i=new PointerEvent("pointerdown",t);i.inputIndex=i.button+2,!this._checkPrePointerObservable(e,i,be.POINTERDOWN)&&this._processPointerDown(e,i)}_processPointerDown(e,t){const i=this._scene;if(e!=null&&e.pickedMesh){this._pickedDownMesh=e.pickedMesh;const a=e.pickedMesh._getActionManagerForTrigger();if(a){if(a.hasPickTriggers)switch(a.processTrigger(5,ki.CreateNew(e.pickedMesh,t,e)),t.button){case 0:a.processTrigger(2,ki.CreateNew(e.pickedMesh,t,e));break;case 1:a.processTrigger(4,ki.CreateNew(e.pickedMesh,t,e));break;case 2:a.processTrigger(3,ki.CreateNew(e.pickedMesh,t,e));break}a.hasSpecificTrigger(8)&&window.setTimeout(()=>{const l=i.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,o=>o.isPickable&&o.isVisible&&o.isReady()&&o.actionManager&&o.actionManager.hasSpecificTrigger(8)&&o===this._pickedDownMesh,!1,i.cameraToUseForPointers);l!=null&&l.pickedMesh&&a&&this._totalPointersPressed!==0&&Date.now()-this._startingPointerTime>ni.LongPressDelay&&!this._isPointerSwiping()&&(this._startingPointerTime=0,a.processTrigger(8,ki.CreateNew(l.pickedMesh,t)))},ni.LongPressDelay)}}else for(const a of i._pointerDownStage)e=a.action(this._unTranslatedPointerX,this._unTranslatedPointerY,e,t,!1);let r;const s=be.POINTERDOWN;e?(i.onPointerDown&&i.onPointerDown(t,e,s),r=new ps(s,t,e),this._setRayOnPointerInfo(e,t)):r=new ps(s,t,null,this),i.onPointerObservable.hasObservers()&&i.onPointerObservable.notifyObservers(r,s)}_isPointerSwiping(){return this._isSwiping}simulatePointerUp(e,t,i){const r=new PointerEvent("pointerup",t);r.inputIndex=Le.Move;const s=new sE;i?s.doubleClick=!0:s.singleClick=!0,!this._checkPrePointerObservable(e,r,be.POINTERUP)&&this._processPointerUp(e,r,s)}_processPointerUp(e,t,i){const r=this._scene;if(e!=null&&e.pickedMesh){if(this._pickedUpMesh=e.pickedMesh,this._pickedDownMesh===this._pickedUpMesh&&(r.onPointerPick&&r.onPointerPick(t,e),i.singleClick&&!i.ignore&&r.onPointerObservable.observers.length>this._cameraObserverCount)){const a=be.POINTERPICK,l=new ps(a,t,e);this._setRayOnPointerInfo(e,t),r.onPointerObservable.notifyObservers(l,a)}const s=e.pickedMesh._getActionManagerForTrigger();if(s&&!i.ignore){s.processTrigger(7,ki.CreateNew(e.pickedMesh,t,e)),!i.hasSwiped&&i.singleClick&&s.processTrigger(1,ki.CreateNew(e.pickedMesh,t,e));const a=e.pickedMesh._getActionManagerForTrigger(6);i.doubleClick&&a&&a.processTrigger(6,ki.CreateNew(e.pickedMesh,t,e))}}else if(!i.ignore)for(const s of r._pointerUpStage)e=s.action(this._unTranslatedPointerX,this._unTranslatedPointerY,e,t,i.doubleClick);if(this._pickedDownMesh&&this._pickedDownMesh!==this._pickedUpMesh){const s=this._pickedDownMesh._getActionManagerForTrigger(16);s&&s.processTrigger(16,ki.CreateNew(this._pickedDownMesh,t))}if(!i.ignore){const s=new ps(be.POINTERUP,t,e);if(this._setRayOnPointerInfo(e,t),r.onPointerObservable.notifyObservers(s,be.POINTERUP),r.onPointerUp&&r.onPointerUp(t,e,be.POINTERUP),!i.hasSwiped&&!this._skipPointerTap&&!this._isMultiTouchGesture){let a=0;if(i.singleClick?a=be.POINTERTAP:i.doubleClick&&(a=be.POINTERDOUBLETAP),a){const l=new ps(a,t,e);r.onPointerObservable.hasObservers()&&r.onPointerObservable.hasSpecificMask(a)&&r.onPointerObservable.notifyObservers(l,a)}}}}isPointerCaptured(e=0){return this._pointerCaptures[e]}attachControl(e=!0,t=!0,i=!0,r=null){const s=this._scene,a=s.getEngine();r||(r=a.getInputElement()),this._alreadyAttached&&this.detachControl(),r&&(this._alreadyAttachedTo=r),this._deviceSourceManager=new kN(a),this._initActionManager=l=>{if(!this._meshPickProceed){const o=s.skipPointerUpPicking||s._registeredActions===0&&!this._checkForPicking()&&!s.onPointerUp?null:s.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,s.pointerUpPredicate,s.pointerUpFastCheck,s.cameraToUseForPointers,s.pointerUpTrianglePredicate);this._currentPickResult=o,o&&(l=o.hit&&o.pickedMesh?o.pickedMesh._getActionManagerForTrigger():null),this._meshPickProceed=!0}return l},this._delayedSimpleClick=(l,o,c)=>{if((Date.now()-this._previousStartingPointerTime>ni.DoubleClickDelay&&!this._doubleClickOccured||l!==this._previousButtonPressed)&&(this._doubleClickOccured=!1,o.singleClick=!0,o.ignore=!1,this._delayedClicks[l])){const u=this._delayedClicks[l].evt,h=be.POINTERTAP,d=new ps(h,u,this._currentPickResult);s.onPointerObservable.hasObservers()&&s.onPointerObservable.hasSpecificMask(h)&&s.onPointerObservable.notifyObservers(d,h),this._delayedClicks[l]=null}},this._initClickEvent=(l,o,c,u)=>{var p,v;const h=new sE;this._currentPickResult=null;let d=null,f=l.hasSpecificMask(be.POINTERPICK)||o.hasSpecificMask(be.POINTERPICK)||l.hasSpecificMask(be.POINTERTAP)||o.hasSpecificMask(be.POINTERTAP)||l.hasSpecificMask(be.POINTERDOUBLETAP)||o.hasSpecificMask(be.POINTERDOUBLETAP);!f&&Kr&&(d=this._initActionManager(d,h),d&&(f=d.hasPickTriggers));let _=!1;if(f){const E=c.button;if(h.hasSwiped=this._isPointerSwiping(),!h.hasSwiped){let g=!ni.ExclusiveDoubleClickMode;if(g||(g=!l.hasSpecificMask(be.POINTERDOUBLETAP)&&!o.hasSpecificMask(be.POINTERDOUBLETAP),g&&!Kr.HasSpecificTrigger(6)&&(d=this._initActionManager(d,h),d&&(g=!d.hasSpecificTrigger(6)))),g)(Date.now()-this._previousStartingPointerTime>ni.DoubleClickDelay||E!==this._previousButtonPressed)&&(h.singleClick=!0,u(h,this._currentPickResult),_=!0);else{const y={evt:c,clickInfo:h,timeoutId:window.setTimeout(this._delayedSimpleClick.bind(this,E,h,u),ni.DoubleClickDelay)};this._delayedClicks[E]=y}let m=l.hasSpecificMask(be.POINTERDOUBLETAP)||o.hasSpecificMask(be.POINTERDOUBLETAP);!m&&Kr.HasSpecificTrigger(6)&&(d=this._initActionManager(d,h),d&&(m=d.hasSpecificTrigger(6))),m&&(E===this._previousButtonPressed&&Date.now()-this._previousStartingPointerTime<ni.DoubleClickDelay&&!this._doubleClickOccured?(!h.hasSwiped&&!this._isPointerSwiping()?(this._previousStartingPointerTime=0,this._doubleClickOccured=!0,h.doubleClick=!0,h.ignore=!1,ni.ExclusiveDoubleClickMode&&this._delayedClicks[E]&&(clearTimeout((p=this._delayedClicks[E])==null?void 0:p.timeoutId),this._delayedClicks[E]=null),u(h,this._currentPickResult)):(this._doubleClickOccured=!1,this._previousStartingPointerTime=this._startingPointerTime,this._previousStartingPointerPosition.x=this._startingPointerPosition.x,this._previousStartingPointerPosition.y=this._startingPointerPosition.y,this._previousButtonPressed=E,ni.ExclusiveDoubleClickMode?(this._delayedClicks[E]&&(clearTimeout((v=this._delayedClicks[E])==null?void 0:v.timeoutId),this._delayedClicks[E]=null),u(h,this._previousPickResult)):u(h,this._currentPickResult)),_=!0):(this._doubleClickOccured=!1,this._previousStartingPointerTime=this._startingPointerTime,this._previousStartingPointerPosition.x=this._startingPointerPosition.x,this._previousStartingPointerPosition.y=this._startingPointerPosition.y,this._previousButtonPressed=E))}}_||u(h,this._currentPickResult)},this._onPointerMove=l=>{if(this._updatePointerPosition(l),!this._isSwiping&&this._swipeButtonPressed!==-1&&(this._isSwiping=Math.abs(this._startingPointerPosition.x-this._pointerX)>ni.DragMovementThreshold||Math.abs(this._startingPointerPosition.y-this._pointerY)>ni.DragMovementThreshold),a.isPointerLock&&a._verifyPointerLock(),this._checkPrePointerObservable(null,l,l.inputIndex>=Le.MouseWheelX&&l.inputIndex<=Le.MouseWheelZ?be.POINTERWHEEL:be.POINTERMOVE)||!s.cameraToUseForPointers&&!s.activeCamera)return;if(s.skipPointerMovePicking){this._processPointerMove(new Fs,l);return}s.pointerMovePredicate||(s.pointerMovePredicate=c=>c.isPickable&&c.isVisible&&c.isReady()&&c.isEnabled()&&(c.enablePointerMoveEvents||s.constantlyUpdateMeshUnderPointer||c._getActionManagerForTrigger()!==null)&&(!s.cameraToUseForPointers||(s.cameraToUseForPointers.layerMask&c.layerMask)!==0));const o=s._registeredActions>0||s.constantlyUpdateMeshUnderPointer?this._pickMove(l):null;this._processPointerMove(o,l)},this._onPointerDown=l=>{var c;if(this._totalPointersPressed++,this._pickedDownMesh=null,this._meshPickProceed=!1,ni.ExclusiveDoubleClickMode){for(let u=0;u<this._delayedClicks.length;u++)if(this._delayedClicks[u])if(l.button===u)clearTimeout((c=this._delayedClicks[u])==null?void 0:c.timeoutId);else{const h=this._delayedClicks[u].clickInfo;this._doubleClickOccured=!1,h.singleClick=!0,h.ignore=!1;const d=this._delayedClicks[u].evt,f=be.POINTERTAP,_=new ps(f,d,this._currentPickResult);s.onPointerObservable.hasObservers()&&s.onPointerObservable.hasSpecificMask(f)&&s.onPointerObservable.notifyObservers(_,f),this._delayedClicks[u]=null}}if(this._updatePointerPosition(l),this._swipeButtonPressed===-1&&(this._swipeButtonPressed=l.button),s.preventDefaultOnPointerDown&&r&&(l.preventDefault(),r.focus()),this._startingPointerPosition.x=this._pointerX,this._startingPointerPosition.y=this._pointerY,this._startingPointerTime=Date.now(),this._checkPrePointerObservable(null,l,be.POINTERDOWN)||!s.cameraToUseForPointers&&!s.activeCamera)return;this._pointerCaptures[l.pointerId]=!0,s.pointerDownPredicate||(s.pointerDownPredicate=u=>u.isPickable&&u.isVisible&&u.isReady()&&u.isEnabled()&&(!s.cameraToUseForPointers||(s.cameraToUseForPointers.layerMask&u.layerMask)!==0)),this._pickedDownMesh=null;let o;s.skipPointerDownPicking||s._registeredActions===0&&!this._checkForPicking()&&!s.onPointerDown?o=new Fs:o=s.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,s.pointerDownPredicate,s.pointerDownFastCheck,s.cameraToUseForPointers,s.pointerDownTrianglePredicate),this._processPointerDown(o,l)},this._onPointerUp=l=>{this._totalPointersPressed!==0&&(this._totalPointersPressed--,this._pickedUpMesh=null,this._meshPickProceed=!1,this._updatePointerPosition(l),s.preventDefaultOnPointerUp&&r&&(l.preventDefault(),r.focus()),this._initClickEvent(s.onPrePointerObservable,s.onPointerObservable,l,(o,c)=>{if(s.onPrePointerObservable.hasObservers()&&(this._skipPointerTap=!1,!o.ignore)){if(this._checkPrePointerObservable(null,l,be.POINTERUP)){this._swipeButtonPressed===l.button&&(this._isSwiping=!1,this._swipeButtonPressed=-1),l.buttons===0&&(this._pointerCaptures[l.pointerId]=!1);return}o.hasSwiped||(o.singleClick&&s.onPrePointerObservable.hasSpecificMask(be.POINTERTAP)&&this._checkPrePointerObservable(null,l,be.POINTERTAP)&&(this._skipPointerTap=!0),o.doubleClick&&s.onPrePointerObservable.hasSpecificMask(be.POINTERDOUBLETAP)&&this._checkPrePointerObservable(null,l,be.POINTERDOUBLETAP)&&(this._skipPointerTap=!0))}if(!this._pointerCaptures[l.pointerId]){this._swipeButtonPressed===l.button&&(this._isSwiping=!1,this._swipeButtonPressed=-1);return}l.buttons===0&&(this._pointerCaptures[l.pointerId]=!1),!(!s.cameraToUseForPointers&&!s.activeCamera)&&(s.pointerUpPredicate||(s.pointerUpPredicate=u=>u.isPickable&&u.isVisible&&u.isReady()&&u.isEnabled()&&(!s.cameraToUseForPointers||(s.cameraToUseForPointers.layerMask&u.layerMask)!==0)),!this._meshPickProceed&&(Kr&&Kr.HasTriggers||this._checkForPicking()||s.onPointerUp)&&this._initActionManager(null,o),c||(c=this._currentPickResult),this._processPointerUp(c,l,o),this._previousPickResult=this._currentPickResult,this._swipeButtonPressed===l.button&&(this._isSwiping=!1,this._swipeButtonPressed=-1))}))},this._onKeyDown=l=>{const o=So.KEYDOWN;if(s.onPreKeyboardObservable.hasObservers()){const c=new $0(o,l);if(s.onPreKeyboardObservable.notifyObservers(c,o),c.skipOnKeyboardObservable)return}if(s.onKeyboardObservable.hasObservers()){const c=new Ip(o,l);s.onKeyboardObservable.notifyObservers(c,o)}s.actionManager&&s.actionManager.processTrigger(14,ki.CreateNewFromScene(s,l))},this._onKeyUp=l=>{const o=So.KEYUP;if(s.onPreKeyboardObservable.hasObservers()){const c=new $0(o,l);if(s.onPreKeyboardObservable.notifyObservers(c,o),c.skipOnKeyboardObservable)return}if(s.onKeyboardObservable.hasObservers()){const c=new Ip(o,l);s.onKeyboardObservable.notifyObservers(c,o)}s.actionManager&&s.actionManager.processTrigger(15,ki.CreateNewFromScene(s,l))},this._deviceSourceManager.onDeviceConnectedObservable.add(l=>{l.deviceType===Re.Mouse?l.onInputChangedObservable.add(o=>{o.inputIndex===Le.LeftClick||o.inputIndex===Le.MiddleClick||o.inputIndex===Le.RightClick||o.inputIndex===Le.BrowserBack||o.inputIndex===Le.BrowserForward?t&&l.getInput(o.inputIndex)===1?this._onPointerDown(o):e&&l.getInput(o.inputIndex)===0&&this._onPointerUp(o):i&&(o.inputIndex===Le.Move?this._onPointerMove(o):(o.inputIndex===Le.MouseWheelX||o.inputIndex===Le.MouseWheelY||o.inputIndex===Le.MouseWheelZ)&&this._onPointerMove(o))}):l.deviceType===Re.Touch?l.onInputChangedObservable.add(o=>{o.inputIndex===Le.LeftClick&&(t&&l.getInput(o.inputIndex)===1?(this._onPointerDown(o),this._totalPointersPressed>1&&(this._isMultiTouchGesture=!0)):e&&l.getInput(o.inputIndex)===0&&(this._onPointerUp(o),this._totalPointersPressed===0&&(this._isMultiTouchGesture=!1))),i&&o.inputIndex===Le.Move&&this._onPointerMove(o)}):l.deviceType===Re.Keyboard&&l.onInputChangedObservable.add(o=>{o.type==="keydown"?this._onKeyDown(o):o.type==="keyup"&&this._onKeyUp(o)})}),this._alreadyAttached=!0}detachControl(){this._alreadyAttached&&(this._deviceSourceManager.dispose(),this._deviceSourceManager=null,this._alreadyAttachedTo&&!this._scene.doNotHandleCursors&&(this._alreadyAttachedTo.style.cursor=this._scene.defaultCursor),this._alreadyAttached=!1,this._alreadyAttachedTo=null)}setPointerOverMesh(e,t=0,i,r){if(this._meshUnderPointerId[t]===e&&(!e||!e._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting))return;const s=this._meshUnderPointerId[t];let a;s&&(a=s._getActionManagerForTrigger(10),a&&a.processTrigger(10,ki.CreateNew(s,r,{pointerId:t}))),e?(this._meshUnderPointerId[t]=e,this._pointerOverMesh=e,a=e._getActionManagerForTrigger(9),a&&a.processTrigger(9,ki.CreateNew(e,r,{pointerId:t,pickResult:i}))):(delete this._meshUnderPointerId[t],this._pointerOverMesh=null)}getPointerOverMesh(){return this.meshUnderPointer}_invalidateMesh(e){this._pointerOverMesh===e&&(this._pointerOverMesh=null),this._pickedDownMesh===e&&(this._pickedDownMesh=null),this._pickedUpMesh===e&&(this._pickedUpMesh=null);for(const t in this._meshUnderPointerId)this._meshUnderPointerId[t]===e&&delete this._meshUnderPointerId[t]}}ni.DragMovementThreshold=10;ni.LongPressDelay=500;ni.DoubleClickDelay=300;ni.ExclusiveDoubleClickMode=!1;class rs{get min(){return this._min}get max(){return this._max}get average(){return this._average}get lastSecAverage(){return this._lastSecAverage}get current(){return this._current}get total(){return this._totalAccumulated}get count(){return this._totalValueCount}constructor(){this._startMonitoringTime=0,this._min=0,this._max=0,this._average=0,this._lastSecAverage=0,this._current=0,this._totalValueCount=0,this._totalAccumulated=0,this._lastSecAccumulated=0,this._lastSecTime=0,this._lastSecValueCount=0}fetchNewFrame(){this._totalValueCount++,this._current=0,this._lastSecValueCount++}addCount(e,t){rs.Enabled&&(this._current+=e,t&&this._fetchResult())}beginMonitoring(){rs.Enabled&&(this._startMonitoringTime=mn.Now)}endMonitoring(e=!0){if(!rs.Enabled)return;e&&this.fetchNewFrame();const t=mn.Now;this._current=t-this._startMonitoringTime,e&&this._fetchResult()}endFrame(){this._fetchResult()}_fetchResult(){this._totalAccumulated+=this._current,this._lastSecAccumulated+=this._current,this._min=Math.min(this._min,this._current),this._max=Math.max(this._max,this._current),this._average=this._totalAccumulated/this._totalValueCount;const e=mn.Now;e-this._lastSecTime>1e3&&(this._lastSecAverage=this._lastSecAccumulated/this._lastSecValueCount,this._lastSecTime=e,this._lastSecAccumulated=0,this._lastSecValueCount=0)}}rs.Enabled=!0;class hn{constructor(e,t,i,r){this.normal=new A(e,t,i),this.d=r}asArray(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}clone(){return new hn(this.normal.x,this.normal.y,this.normal.z,this.d)}getClassName(){return"Plane"}getHashCode(){let e=this.normal.getHashCode();return e=e*397^(this.d|0),e}normalize(){const e=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z);let t=0;return e!==0&&(t=1/e),this.normal.x*=t,this.normal.y*=t,this.normal.z*=t,this.d*=t,this}transform(e){const t=hn._TmpMatrix;e.invertToRef(t);const i=t.m,r=this.normal.x,s=this.normal.y,a=this.normal.z,l=this.d,o=r*i[0]+s*i[1]+a*i[2]+l*i[3],c=r*i[4]+s*i[5]+a*i[6]+l*i[7],u=r*i[8]+s*i[9]+a*i[10]+l*i[11],h=r*i[12]+s*i[13]+a*i[14]+l*i[15];return new hn(o,c,u,h)}dotCoordinate(e){return this.normal.x*e.x+this.normal.y*e.y+this.normal.z*e.z+this.d}copyFromPoints(e,t,i){const r=t.x-e.x,s=t.y-e.y,a=t.z-e.z,l=i.x-e.x,o=i.y-e.y,c=i.z-e.z,u=s*c-a*o,h=a*l-r*c,d=r*o-s*l,f=Math.sqrt(u*u+h*h+d*d);let _;return f!==0?_=1/f:_=0,this.normal.x=u*_,this.normal.y=h*_,this.normal.z=d*_,this.d=-(this.normal.x*e.x+this.normal.y*e.y+this.normal.z*e.z),this}isFrontFacingTo(e,t){return A.Dot(this.normal,e)<=t}signedDistanceTo(e){return A.Dot(e,this.normal)+this.d}static FromArray(e){return new hn(e[0],e[1],e[2],e[3])}static FromPoints(e,t,i){const r=new hn(0,0,0,0);return r.copyFromPoints(e,t,i),r}static FromPositionAndNormal(e,t){const i=new hn(0,0,0,0);return this.FromPositionAndNormalToRef(e,t,i)}static FromPositionAndNormalToRef(e,t,i){return i.normal.copyFrom(t),i.normal.normalize(),i.d=-e.dot(i.normal),i}static SignedDistanceToPlaneFromPositionAndNormal(e,t,i){const r=-(t.x*e.x+t.y*e.y+t.z*e.z);return A.Dot(i,t)+r}}hn._TmpMatrix=z.Identity();class un{static GetPlanes(e){const t=[];for(let i=0;i<6;i++)t.push(new hn(0,0,0,0));return un.GetPlanesToRef(e,t),t}static GetNearPlaneToRef(e,t){const i=e.m;t.normal.x=i[3]+i[2],t.normal.y=i[7]+i[6],t.normal.z=i[11]+i[10],t.d=i[15]+i[14],t.normalize()}static GetFarPlaneToRef(e,t){const i=e.m;t.normal.x=i[3]-i[2],t.normal.y=i[7]-i[6],t.normal.z=i[11]-i[10],t.d=i[15]-i[14],t.normalize()}static GetLeftPlaneToRef(e,t){const i=e.m;t.normal.x=i[3]+i[0],t.normal.y=i[7]+i[4],t.normal.z=i[11]+i[8],t.d=i[15]+i[12],t.normalize()}static GetRightPlaneToRef(e,t){const i=e.m;t.normal.x=i[3]-i[0],t.normal.y=i[7]-i[4],t.normal.z=i[11]-i[8],t.d=i[15]-i[12],t.normalize()}static GetTopPlaneToRef(e,t){const i=e.m;t.normal.x=i[3]-i[1],t.normal.y=i[7]-i[5],t.normal.z=i[11]-i[9],t.d=i[15]-i[13],t.normalize()}static GetBottomPlaneToRef(e,t){const i=e.m;t.normal.x=i[3]+i[1],t.normal.y=i[7]+i[5],t.normal.z=i[11]+i[9],t.d=i[15]+i[13],t.normalize()}static GetPlanesToRef(e,t){un.GetNearPlaneToRef(e,t[0]),un.GetFarPlaneToRef(e,t[1]),un.GetLeftPlaneToRef(e,t[2]),un.GetRightPlaneToRef(e,t[3]),un.GetTopPlaneToRef(e,t[4]),un.GetBottomPlaneToRef(e,t[5])}static IsPointInFrustum(e,t){for(let i=0;i<6;i++)if(t[i].dotCoordinate(e)<0)return!1;return!0}}class g1{static get UniqueId(){const e=this._UniqueIdCounter;return this._UniqueIdCounter++,e}}g1._UniqueIdCounter=1;class Et{static CompareLightsPriority(e,t){return e.shadowEnabled!==t.shadowEnabled?(t.shadowEnabled?1:0)-(e.shadowEnabled?1:0):t.renderPriority-e.renderPriority}}Et.FALLOFF_DEFAULT=0;Et.FALLOFF_PHYSICAL=1;Et.FALLOFF_GLTF=2;Et.FALLOFF_STANDARD=3;Et.LIGHTMAP_DEFAULT=0;Et.LIGHTMAP_SPECULAR=1;Et.LIGHTMAP_SHADOWSONLY=2;Et.INTENSITYMODE_AUTOMATIC=0;Et.INTENSITYMODE_LUMINOUSPOWER=1;Et.INTENSITYMODE_LUMINOUSINTENSITY=2;Et.INTENSITYMODE_ILLUMINANCE=3;Et.INTENSITYMODE_LUMINANCE=4;Et.LIGHTTYPEID_POINTLIGHT=0;Et.LIGHTTYPEID_DIRECTIONALLIGHT=1;Et.LIGHTTYPEID_SPOTLIGHT=2;Et.LIGHTTYPEID_HEMISPHERICLIGHT=3;class BN{constructor(){this.pointerDownFastCheck=!1,this.pointerUpFastCheck=!1,this.pointerMoveFastCheck=!1,this.skipPointerMovePicking=!1,this.skipPointerDownPicking=!1,this.skipPointerUpPicking=!1}}var ns;(function(n){n[n.BackwardCompatible=0]="BackwardCompatible",n[n.Intermediate=1]="Intermediate",n[n.Aggressive=2]="Aggressive"})(ns||(ns={}));class Pt extends Fu{static DefaultMaterialFactory(e){throw ke("StandardMaterial")}static CollisionCoordinatorFactory(){throw ke("DefaultCollisionCoordinator")}get environmentTexture(){return this._environmentTexture}set environmentTexture(e){this._environmentTexture!==e&&(this._environmentTexture=e,this.markAllMaterialsAsDirty(1))}get imageProcessingConfiguration(){return this._imageProcessingConfiguration}get performancePriority(){return this._performancePriority}set performancePriority(e){if(e!==this._performancePriority){switch(this._performancePriority=e,e){case ns.BackwardCompatible:this.skipFrustumClipping=!1,this._renderingManager.maintainStateBetweenFrames=!1,this.skipPointerMovePicking=!1,this.autoClear=!0;break;case ns.Intermediate:this.skipFrustumClipping=!1,this._renderingManager.maintainStateBetweenFrames=!1,this.skipPointerMovePicking=!0,this.autoClear=!1;break;case ns.Aggressive:this.skipFrustumClipping=!0,this._renderingManager.maintainStateBetweenFrames=!0,this.skipPointerMovePicking=!0,this.autoClear=!1;break}this.onScenePerformancePriorityChangedObservable.notifyObservers(e)}}set forceWireframe(e){this._forceWireframe!==e&&(this._forceWireframe=e,this.markAllMaterialsAsDirty(16))}get forceWireframe(){return this._forceWireframe}set skipFrustumClipping(e){this._skipFrustumClipping!==e&&(this._skipFrustumClipping=e)}get skipFrustumClipping(){return this._skipFrustumClipping}set forcePointsCloud(e){this._forcePointsCloud!==e&&(this._forcePointsCloud=e,this.markAllMaterialsAsDirty(16))}get forcePointsCloud(){return this._forcePointsCloud}get animationPropertiesOverride(){return this._animationPropertiesOverride}set animationPropertiesOverride(e){this._animationPropertiesOverride=e}set onDispose(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)}set beforeRender(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),e&&(this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e))}set afterRender(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),e&&(this._onAfterRenderObserver=this.onAfterRenderObservable.add(e))}set beforeCameraRender(e){this._onBeforeCameraRenderObserver&&this.onBeforeCameraRenderObservable.remove(this._onBeforeCameraRenderObserver),this._onBeforeCameraRenderObserver=this.onBeforeCameraRenderObservable.add(e)}set afterCameraRender(e){this._onAfterCameraRenderObserver&&this.onAfterCameraRenderObservable.remove(this._onAfterCameraRenderObserver),this._onAfterCameraRenderObserver=this.onAfterCameraRenderObservable.add(e)}get pointerDownPredicate(){return this._pointerPickingConfiguration.pointerDownPredicate}set pointerDownPredicate(e){this._pointerPickingConfiguration.pointerDownPredicate=e}get pointerUpPredicate(){return this._pointerPickingConfiguration.pointerUpPredicate}set pointerUpPredicate(e){this._pointerPickingConfiguration.pointerUpPredicate=e}get pointerMovePredicate(){return this._pointerPickingConfiguration.pointerMovePredicate}set pointerMovePredicate(e){this._pointerPickingConfiguration.pointerMovePredicate=e}get pointerDownFastCheck(){return this._pointerPickingConfiguration.pointerDownFastCheck}set pointerDownFastCheck(e){this._pointerPickingConfiguration.pointerDownFastCheck=e}get pointerUpFastCheck(){return this._pointerPickingConfiguration.pointerUpFastCheck}set pointerUpFastCheck(e){this._pointerPickingConfiguration.pointerUpFastCheck=e}get pointerMoveFastCheck(){return this._pointerPickingConfiguration.pointerMoveFastCheck}set pointerMoveFastCheck(e){this._pointerPickingConfiguration.pointerMoveFastCheck=e}get skipPointerMovePicking(){return this._pointerPickingConfiguration.skipPointerMovePicking}set skipPointerMovePicking(e){this._pointerPickingConfiguration.skipPointerMovePicking=e}get skipPointerDownPicking(){return this._pointerPickingConfiguration.skipPointerDownPicking}set skipPointerDownPicking(e){this._pointerPickingConfiguration.skipPointerDownPicking=e}get skipPointerUpPicking(){return this._pointerPickingConfiguration.skipPointerUpPicking}set skipPointerUpPicking(e){this._pointerPickingConfiguration.skipPointerUpPicking=e}get unTranslatedPointer(){return this._inputManager.unTranslatedPointer}static get DragMovementThreshold(){return ni.DragMovementThreshold}static set DragMovementThreshold(e){ni.DragMovementThreshold=e}static get LongPressDelay(){return ni.LongPressDelay}static set LongPressDelay(e){ni.LongPressDelay=e}static get DoubleClickDelay(){return ni.DoubleClickDelay}static set DoubleClickDelay(e){ni.DoubleClickDelay=e}static get ExclusiveDoubleClickMode(){return ni.ExclusiveDoubleClickMode}static set ExclusiveDoubleClickMode(e){ni.ExclusiveDoubleClickMode=e}bindEyePosition(e,t="vEyePosition",i=!1){const r=this._forcedViewPosition?this._forcedViewPosition:this._mirroredCameraPosition?this._mirroredCameraPosition:this.activeCamera.globalPosition,s=this.useRightHandedSystem===(this._mirroredCameraPosition!=null);return V.Vector4[0].set(r.x,r.y,r.z,s?-1:1),e&&(i?e.setFloat3(t,V.Vector4[0].x,V.Vector4[0].y,V.Vector4[0].z):e.setVector4(t,V.Vector4[0])),V.Vector4[0]}finalizeSceneUbo(){const e=this.getSceneUniformBuffer(),t=this.bindEyePosition(null);return e.updateFloat4("vEyePosition",t.x,t.y,t.z,t.w),e.update(),e}set useRightHandedSystem(e){this._useRightHandedSystem!==e&&(this._useRightHandedSystem=e,this.markAllMaterialsAsDirty(16))}get useRightHandedSystem(){return this._useRightHandedSystem}setStepId(e){this._currentStepId=e}getStepId(){return this._currentStepId}getInternalStep(){return this._currentInternalStep}set fogEnabled(e){this._fogEnabled!==e&&(this._fogEnabled=e,this.markAllMaterialsAsDirty(16))}get fogEnabled(){return this._fogEnabled}set fogMode(e){this._fogMode!==e&&(this._fogMode=e,this.markAllMaterialsAsDirty(16))}get fogMode(){return this._fogMode}get prePass(){return!!this.prePassRenderer&&this.prePassRenderer.defaultRT.enabled}set shadowsEnabled(e){this._shadowsEnabled!==e&&(this._shadowsEnabled=e,this.markAllMaterialsAsDirty(2))}get shadowsEnabled(){return this._shadowsEnabled}set lightsEnabled(e){this._lightsEnabled!==e&&(this._lightsEnabled=e,this.markAllMaterialsAsDirty(2))}get lightsEnabled(){return this._lightsEnabled}get activeCameras(){return this._activeCameras}set activeCameras(e){this._unObserveActiveCameras&&(this._unObserveActiveCameras(),this._unObserveActiveCameras=null),e&&(this._unObserveActiveCameras=QT(e,()=>{this.onActiveCamerasChanged.notifyObservers(this)})),this._activeCameras=e}get activeCamera(){return this._activeCamera}set activeCamera(e){e!==this._activeCamera&&(this._activeCamera=e,this.onActiveCameraChanged.notifyObservers(this))}get defaultMaterial(){return this._defaultMaterial||(this._defaultMaterial=Pt.DefaultMaterialFactory(this)),this._defaultMaterial}set defaultMaterial(e){this._defaultMaterial=e}set texturesEnabled(e){this._texturesEnabled!==e&&(this._texturesEnabled=e,this.markAllMaterialsAsDirty(1))}get texturesEnabled(){return this._texturesEnabled}set skeletonsEnabled(e){this._skeletonsEnabled!==e&&(this._skeletonsEnabled=e,this.markAllMaterialsAsDirty(8))}get skeletonsEnabled(){return this._skeletonsEnabled}get collisionCoordinator(){return this._collisionCoordinator||(this._collisionCoordinator=Pt.CollisionCoordinatorFactory(),this._collisionCoordinator.init(this)),this._collisionCoordinator}get renderingManager(){return this._renderingManager}get frustumPlanes(){return this._frustumPlanes}_registerTransientComponents(){if(this._transientComponents.length>0){for(const e of this._transientComponents)e.register();this._transientComponents.length=0}}_addComponent(e){this._components.push(e),this._transientComponents.push(e);const t=e;t.addFromContainer&&t.serialize&&this._serializableComponents.push(t)}_getComponent(e){for(const t of this._components)if(t.name===e)return t;return null}constructor(e,t){super(),this._inputManager=new ni(this),this.cameraToUseForPointers=null,this._isScene=!0,this._blockEntityCollection=!1,this.autoClear=!0,this.autoClearDepthAndStencil=!0,this.clearColor=new et(.2,.2,.3,1),this.ambientColor=new Pe(0,0,0),this.environmentIntensity=1,this._performancePriority=ns.BackwardCompatible,this.onScenePerformancePriorityChangedObservable=new Y,this._forceWireframe=!1,this._skipFrustumClipping=!1,this._forcePointsCloud=!1,this.animationsEnabled=!0,this._animationPropertiesOverride=null,this.useConstantAnimationDeltaTime=!1,this.constantlyUpdateMeshUnderPointer=!1,this.hoverCursor="pointer",this.defaultCursor="",this.doNotHandleCursors=!1,this.preventDefaultOnPointerDown=!0,this.preventDefaultOnPointerUp=!0,this.metadata=null,this.reservedDataStore=null,this.disableOfflineSupportExceptionRules=[],this.onDisposeObservable=new Y,this._onDisposeObserver=null,this.onBeforeRenderObservable=new Y,this._onBeforeRenderObserver=null,this.onAfterRenderObservable=new Y,this.onAfterRenderCameraObservable=new Y,this._onAfterRenderObserver=null,this.onBeforeAnimationsObservable=new Y,this.onAfterAnimationsObservable=new Y,this.onBeforeDrawPhaseObservable=new Y,this.onAfterDrawPhaseObservable=new Y,this.onReadyObservable=new Y,this.onBeforeCameraRenderObservable=new Y,this._onBeforeCameraRenderObserver=null,this.onAfterCameraRenderObservable=new Y,this._onAfterCameraRenderObserver=null,this.onBeforeActiveMeshesEvaluationObservable=new Y,this.onAfterActiveMeshesEvaluationObservable=new Y,this.onBeforeParticlesRenderingObservable=new Y,this.onAfterParticlesRenderingObservable=new Y,this.onDataLoadedObservable=new Y,this.onNewCameraAddedObservable=new Y,this.onCameraRemovedObservable=new Y,this.onNewLightAddedObservable=new Y,this.onLightRemovedObservable=new Y,this.onNewGeometryAddedObservable=new Y,this.onGeometryRemovedObservable=new Y,this.onNewTransformNodeAddedObservable=new Y,this.onTransformNodeRemovedObservable=new Y,this.onNewMeshAddedObservable=new Y,this.onMeshRemovedObservable=new Y,this.onNewSkeletonAddedObservable=new Y,this.onSkeletonRemovedObservable=new Y,this.onNewMaterialAddedObservable=new Y,this.onNewMultiMaterialAddedObservable=new Y,this.onMaterialRemovedObservable=new Y,this.onMultiMaterialRemovedObservable=new Y,this.onNewTextureAddedObservable=new Y,this.onTextureRemovedObservable=new Y,this.onBeforeRenderTargetsRenderObservable=new Y,this.onAfterRenderTargetsRenderObservable=new Y,this.onBeforeStepObservable=new Y,this.onAfterStepObservable=new Y,this.onActiveCameraChanged=new Y,this.onActiveCamerasChanged=new Y,this.onBeforeRenderingGroupObservable=new Y,this.onAfterRenderingGroupObservable=new Y,this.onMeshImportedObservable=new Y,this.onAnimationFileImportedObservable=new Y,this._registeredForLateAnimationBindings=new no(256),this._pointerPickingConfiguration=new BN,this.onPrePointerObservable=new Y,this.onPointerObservable=new Y,this.onPreKeyboardObservable=new Y,this.onKeyboardObservable=new Y,this._useRightHandedSystem=!1,this._timeAccumulator=0,this._currentStepId=0,this._currentInternalStep=0,this._fogEnabled=!0,this._fogMode=Pt.FOGMODE_NONE,this.fogColor=new Pe(.2,.2,.3),this.fogDensity=.1,this.fogStart=0,this.fogEnd=1e3,this.needsPreviousWorldMatrices=!1,this._shadowsEnabled=!0,this._lightsEnabled=!0,this._unObserveActiveCameras=null,this._texturesEnabled=!0,this.physicsEnabled=!0,this.particlesEnabled=!0,this.spritesEnabled=!0,this._skeletonsEnabled=!0,this.lensFlaresEnabled=!0,this.collisionsEnabled=!0,this.gravity=new A(0,-9.807,0),this.postProcessesEnabled=!0,this.renderTargetsEnabled=!0,this.dumpNextRenderTargets=!1,this.customRenderTargets=[],this.importedMeshesFiles=[],this.probesEnabled=!0,this._meshesForIntersections=new no(256),this.proceduralTexturesEnabled=!0,this._totalVertices=new rs,this._activeIndices=new rs,this._activeParticles=new rs,this._activeBones=new rs,this._animationTime=0,this.animationTimeScale=1,this._renderId=0,this._frameId=0,this._executeWhenReadyTimeoutId=null,this._intermediateRendering=!1,this._defaultFrameBufferCleared=!1,this._viewUpdateFlag=-1,this._projectionUpdateFlag=-1,this._toBeDisposed=new Array(256),this._activeRequests=new Array,this._pendingData=new Array,this._isDisposed=!1,this.dispatchAllSubMeshesOfActiveMeshes=!1,this._activeMeshes=new or(256),this._processedMaterials=new or(256),this._renderTargets=new no(256),this._materialsRenderTargets=new no(256),this._activeParticleSystems=new or(256),this._activeSkeletons=new no(32),this._softwareSkinnedMeshes=new no(32),this._activeAnimatables=new Array,this._transformMatrix=z.Zero(),this.requireLightSorting=!1,this._components=[],this._serializableComponents=[],this._transientComponents=[],this._beforeCameraUpdateStage=ui.Create(),this._beforeClearStage=ui.Create(),this._beforeRenderTargetClearStage=ui.Create(),this._gatherRenderTargetsStage=ui.Create(),this._gatherActiveCameraRenderTargetsStage=ui.Create(),this._isReadyForMeshStage=ui.Create(),this._beforeEvaluateActiveMeshStage=ui.Create(),this._evaluateSubMeshStage=ui.Create(),this._preActiveMeshStage=ui.Create(),this._cameraDrawRenderTargetStage=ui.Create(),this._beforeCameraDrawStage=ui.Create(),this._beforeRenderTargetDrawStage=ui.Create(),this._beforeRenderingGroupDrawStage=ui.Create(),this._beforeRenderingMeshStage=ui.Create(),this._afterRenderingMeshStage=ui.Create(),this._afterRenderingGroupDrawStage=ui.Create(),this._afterCameraDrawStage=ui.Create(),this._afterCameraPostProcessStage=ui.Create(),this._afterRenderTargetDrawStage=ui.Create(),this._afterRenderTargetPostProcessStage=ui.Create(),this._afterRenderStage=ui.Create(),this._pointerMoveStage=ui.Create(),this._pointerDownStage=ui.Create(),this._pointerUpStage=ui.Create(),this._geometriesByUniqueId=null,this._defaultMeshCandidates={data:[],length:0},this._defaultSubMeshCandidates={data:[],length:0},this._preventFreeActiveMeshesAndRenderingGroups=!1,this._activeMeshesFrozen=!1,this._activeMeshesFrozenButKeepClipping=!1,this._skipEvaluateActiveMeshesCompletely=!1,this._allowPostProcessClearColor=!0,this.getDeterministicFrameTime=()=>this._engine.getTimeStep(),this._registeredActions=0,this._blockMaterialDirtyMechanism=!1,this._perfCollector=null,this.activeCameras=[];const i={useGeometryUniqueIdsMap:!0,useMaterialMeshMap:!0,useClonedMeshMap:!0,virtual:!1,...t};e=this._engine=e||He.LastCreatedEngine,i.virtual?e._virtualScenes.push(this):(He._LastCreatedScene=this,e.scenes.push(this)),this._uid=null,this._renderingManager=new ir(this),Mp&&(this.postProcessManager=new Mp(this)),Ui()&&this.attachControl(),this._createUbo(),it&&(this._imageProcessingConfiguration=new it),this.setDefaultCandidateProviders(),i.useGeometryUniqueIdsMap&&(this._geometriesByUniqueId={}),this.useMaterialMeshMap=i.useMaterialMeshMap,this.useClonedMeshMap=i.useClonedMeshMap,(!t||!t.virtual)&&e.onNewSceneAddedObservable.notifyObservers(this)}getClassName(){return"Scene"}_getDefaultMeshCandidates(){return this._defaultMeshCandidates.data=this.meshes,this._defaultMeshCandidates.length=this.meshes.length,this._defaultMeshCandidates}_getDefaultSubMeshCandidates(e){return this._defaultSubMeshCandidates.data=e.subMeshes,this._defaultSubMeshCandidates.length=e.subMeshes.length,this._defaultSubMeshCandidates}setDefaultCandidateProviders(){this.getActiveMeshCandidates=()=>this._getDefaultMeshCandidates(),this.getActiveSubMeshCandidates=e=>this._getDefaultSubMeshCandidates(e),this.getIntersectingSubMeshCandidates=(e,t)=>this._getDefaultSubMeshCandidates(e),this.getCollidingSubMeshCandidates=(e,t)=>this._getDefaultSubMeshCandidates(e)}get meshUnderPointer(){return this._inputManager.meshUnderPointer}get pointerX(){return this._inputManager.pointerX}set pointerX(e){this._inputManager.pointerX=e}get pointerY(){return this._inputManager.pointerY}set pointerY(e){this._inputManager.pointerY=e}getCachedMaterial(){return this._cachedMaterial}getCachedEffect(){return this._cachedEffect}getCachedVisibility(){return this._cachedVisibility}isCachedMaterialInvalid(e,t,i=1){return this._cachedEffect!==t||this._cachedMaterial!==e||this._cachedVisibility!==i}getEngine(){return this._engine}getTotalVertices(){return this._totalVertices.current}get totalVerticesPerfCounter(){return this._totalVertices}getActiveIndices(){return this._activeIndices.current}get totalActiveIndicesPerfCounter(){return this._activeIndices}getActiveParticles(){return this._activeParticles.current}get activeParticlesPerfCounter(){return this._activeParticles}getActiveBones(){return this._activeBones.current}get activeBonesPerfCounter(){return this._activeBones}getActiveMeshes(){return this._activeMeshes}getAnimationRatio(){return this._animationRatio!==void 0?this._animationRatio:1}getRenderId(){return this._renderId}getFrameId(){return this._frameId}incrementRenderId(){this._renderId++}_createUbo(){this.setSceneUniformBuffer(this.createSceneUniformBuffer())}simulatePointerMove(e,t){return this._inputManager.simulatePointerMove(e,t),this}simulatePointerDown(e,t){return this._inputManager.simulatePointerDown(e,t),this}simulatePointerUp(e,t,i){return this._inputManager.simulatePointerUp(e,t,i),this}isPointerCaptured(e=0){return this._inputManager.isPointerCaptured(e)}attachControl(e=!0,t=!0,i=!0){this._inputManager.attachControl(e,t,i)}detachControl(){this._inputManager.detachControl()}isReady(e=!0){var a,l;if(this._isDisposed)return!1;let t;const i=this.getEngine(),r=i.currentRenderPassId;i.currentRenderPassId=((a=this.activeCamera)==null?void 0:a.renderPassId)??r;let s=!0;for(this._pendingData.length>0&&(s=!1),(l=this.prePassRenderer)==null||l.update(),this.useOrderIndependentTransparency&&this.depthPeelingRenderer&&s&&(s=this.depthPeelingRenderer.isReady()),e&&(this._processedMaterials.reset(),this._materialsRenderTargets.reset()),t=0;t<this.meshes.length;t++){const o=this.meshes[t];if(!o.subMeshes||o.subMeshes.length===0)continue;if(!o.isReady(!0)){s=!1;continue}const c=o.hasThinInstances||o.getClassName()==="InstancedMesh"||o.getClassName()==="InstancedLinesMesh"||i.getCaps().instancedArrays&&o.instances.length>0;for(const h of this._isReadyForMeshStage)h.action(o,c)||(s=!1);if(!e)continue;const u=o.material||this.defaultMaterial;if(u)if(u._storeEffectOnSubMeshes)for(const h of o.subMeshes){const d=h.getMaterial();d&&d.hasRenderTargetTextures&&d.getRenderTargetTextures!=null&&this._processedMaterials.indexOf(d)===-1&&(this._processedMaterials.push(d),this._materialsRenderTargets.concatWithNoDuplicate(d.getRenderTargetTextures()))}else u.hasRenderTargetTextures&&u.getRenderTargetTextures!=null&&this._processedMaterials.indexOf(u)===-1&&(this._processedMaterials.push(u),this._materialsRenderTargets.concatWithNoDuplicate(u.getRenderTargetTextures()))}if(e)for(t=0;t<this._materialsRenderTargets.length;++t)this._materialsRenderTargets.data[t].isReadyForRendering()||(s=!1);for(t=0;t<this.geometries.length;t++)this.geometries[t].delayLoadState===2&&(s=!1);if(this.activeCameras&&this.activeCameras.length>0)for(const o of this.activeCameras)o.isReady(!0)||(s=!1);else this.activeCamera&&(this.activeCamera.isReady(!0)||(s=!1));for(const o of this.particleSystems)o.isReady()||(s=!1);if(this.layers)for(const o of this.layers)o.isReady()||(s=!1);return i.areAllEffectsReady()||(s=!1),i.currentRenderPassId=r,s}resetCachedMaterial(){this._cachedMaterial=null,this._cachedEffect=null,this._cachedVisibility=null}registerBeforeRender(e){this.onBeforeRenderObservable.add(e)}unregisterBeforeRender(e){this.onBeforeRenderObservable.removeCallback(e)}registerAfterRender(e){this.onAfterRenderObservable.add(e)}unregisterAfterRender(e){this.onAfterRenderObservable.removeCallback(e)}_executeOnceBeforeRender(e){const t=()=>{e(),setTimeout(()=>{this.unregisterBeforeRender(t)})};this.registerBeforeRender(t)}executeOnceBeforeRender(e,t){t!==void 0?setTimeout(()=>{this._executeOnceBeforeRender(e)},t):this._executeOnceBeforeRender(e)}addPendingData(e){this._pendingData.push(e)}removePendingData(e){const t=this.isLoading,i=this._pendingData.indexOf(e);i!==-1&&this._pendingData.splice(i,1),t&&!this.isLoading&&this.onDataLoadedObservable.notifyObservers(this)}getWaitingItemsCount(){return this._pendingData.length}get isLoading(){return this._pendingData.length>0}executeWhenReady(e,t=!1){this.onReadyObservable.addOnce(e),this._executeWhenReadyTimeoutId===null&&this._checkIsReady(t)}whenReadyAsync(e=!1){return new Promise(t=>{this.executeWhenReady(()=>{t()},e)})}_checkIsReady(e=!1){if(this._registerTransientComponents(),this.isReady(e)){this.onReadyObservable.notifyObservers(this),this.onReadyObservable.clear(),this._executeWhenReadyTimeoutId=null;return}if(this._isDisposed){this.onReadyObservable.clear(),this._executeWhenReadyTimeoutId=null;return}this._executeWhenReadyTimeoutId=setTimeout(()=>{this.incrementRenderId(),this._checkIsReady(e)},100)}get animatables(){return this._activeAnimatables}resetLastAnimationTimeFrame(){this._animationTimeLast=mn.Now}getViewMatrix(){return this._viewMatrix}getProjectionMatrix(){return this._projectionMatrix}getTransformMatrix(){return this._transformMatrix}setTransformMatrix(e,t,i,r){!i&&!r&&this._multiviewSceneUbo&&(this._multiviewSceneUbo.dispose(),this._multiviewSceneUbo=null),!(this._viewUpdateFlag===e.updateFlag&&this._projectionUpdateFlag===t.updateFlag)&&(this._viewUpdateFlag=e.updateFlag,this._projectionUpdateFlag=t.updateFlag,this._viewMatrix=e,this._projectionMatrix=t,this._viewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),this._frustumPlanes?un.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=un.GetPlanes(this._transformMatrix),this._multiviewSceneUbo&&this._multiviewSceneUbo.useUbo?this._updateMultiviewUbo(i,r):this._sceneUbo.useUbo&&(this._sceneUbo.updateMatrix("viewProjection",this._transformMatrix),this._sceneUbo.updateMatrix("view",this._viewMatrix),this._sceneUbo.updateMatrix("projection",this._projectionMatrix)))}getSceneUniformBuffer(){return this._multiviewSceneUbo?this._multiviewSceneUbo:this._sceneUbo}createSceneUniformBuffer(e){const t=new me(this._engine,void 0,!1,e??"scene");return t.addUniform("viewProjection",16),t.addUniform("view",16),t.addUniform("projection",16),t.addUniform("vEyePosition",4),t}setSceneUniformBuffer(e){this._sceneUbo=e,this._viewUpdateFlag=-1,this._projectionUpdateFlag=-1}getUniqueId(){return g1.UniqueId}addMesh(e,t=!1){this._blockEntityCollection||(this.meshes.push(e),e._resyncLightSources(),e.parent||e._addToSceneRootNodes(),this.onNewMeshAddedObservable.notifyObservers(e),t&&e.getChildMeshes().forEach(i=>{this.addMesh(i)}))}removeMesh(e,t=!1){const i=this.meshes.indexOf(e);return i!==-1&&(this.meshes[i]=this.meshes[this.meshes.length-1],this.meshes.pop(),e.parent||e._removeFromSceneRootNodes()),this._inputManager._invalidateMesh(e),this.onMeshRemovedObservable.notifyObservers(e),t&&e.getChildMeshes().forEach(r=>{this.removeMesh(r)}),i}addTransformNode(e){this._blockEntityCollection||e.getScene()===this&&e._indexInSceneTransformNodesArray!==-1||(e._indexInSceneTransformNodesArray=this.transformNodes.length,this.transformNodes.push(e),e.parent||e._addToSceneRootNodes(),this.onNewTransformNodeAddedObservable.notifyObservers(e))}removeTransformNode(e){const t=e._indexInSceneTransformNodesArray;if(t!==-1){if(t!==this.transformNodes.length-1){const i=this.transformNodes[this.transformNodes.length-1];this.transformNodes[t]=i,i._indexInSceneTransformNodesArray=t}e._indexInSceneTransformNodesArray=-1,this.transformNodes.pop(),e.parent||e._removeFromSceneRootNodes()}return this.onTransformNodeRemovedObservable.notifyObservers(e),t}removeSkeleton(e){const t=this.skeletons.indexOf(e);return t!==-1&&(this.skeletons.splice(t,1),this.onSkeletonRemovedObservable.notifyObservers(e),this._executeActiveContainerCleanup(this._activeSkeletons)),t}removeMorphTargetManager(e){const t=this.morphTargetManagers.indexOf(e);return t!==-1&&this.morphTargetManagers.splice(t,1),t}removeLight(e){const t=this.lights.indexOf(e);if(t!==-1){for(const i of this.meshes)i._removeLightSource(e,!1);this.lights.splice(t,1),this.sortLightsByPriority(),e.parent||e._removeFromSceneRootNodes()}return this.onLightRemovedObservable.notifyObservers(e),t}removeCamera(e){const t=this.cameras.indexOf(e);if(t!==-1&&(this.cameras.splice(t,1),e.parent||e._removeFromSceneRootNodes()),this.activeCameras){const i=this.activeCameras.indexOf(e);i!==-1&&this.activeCameras.splice(i,1)}return this.activeCamera===e&&(this.cameras.length>0?this.activeCamera=this.cameras[0]:this.activeCamera=null),this.onCameraRemovedObservable.notifyObservers(e),t}removeParticleSystem(e){const t=this.particleSystems.indexOf(e);return t!==-1&&(this.particleSystems.splice(t,1),this._executeActiveContainerCleanup(this._activeParticleSystems)),t}removeAnimation(e){const t=this.animations.indexOf(e);return t!==-1&&this.animations.splice(t,1),t}stopAnimation(e,t,i){}removeAnimationGroup(e){const t=this.animationGroups.indexOf(e);return t!==-1&&this.animationGroups.splice(t,1),t}removeMultiMaterial(e){const t=this.multiMaterials.indexOf(e);return t!==-1&&this.multiMaterials.splice(t,1),this.onMultiMaterialRemovedObservable.notifyObservers(e),t}removeMaterial(e){const t=e._indexInSceneMaterialArray;if(t!==-1&&t<this.materials.length){if(t!==this.materials.length-1){const i=this.materials[this.materials.length-1];this.materials[t]=i,i._indexInSceneMaterialArray=t}e._indexInSceneMaterialArray=-1,this.materials.pop()}return this.onMaterialRemovedObservable.notifyObservers(e),t}removeActionManager(e){const t=this.actionManagers.indexOf(e);return t!==-1&&this.actionManagers.splice(t,1),t}removeTexture(e){const t=this.textures.indexOf(e);return t!==-1&&this.textures.splice(t,1),this.onTextureRemovedObservable.notifyObservers(e),t}addLight(e){if(!this._blockEntityCollection){this.lights.push(e),this.sortLightsByPriority(),e.parent||e._addToSceneRootNodes();for(const t of this.meshes)t.lightSources.indexOf(e)===-1&&(t.lightSources.push(e),t._resyncLightSources());this.onNewLightAddedObservable.notifyObservers(e)}}sortLightsByPriority(){this.requireLightSorting&&this.lights.sort(Et.CompareLightsPriority)}addCamera(e){this._blockEntityCollection||(this.cameras.push(e),this.onNewCameraAddedObservable.notifyObservers(e),e.parent||e._addToSceneRootNodes())}addSkeleton(e){this._blockEntityCollection||(this.skeletons.push(e),this.onNewSkeletonAddedObservable.notifyObservers(e))}addParticleSystem(e){this._blockEntityCollection||this.particleSystems.push(e)}addAnimation(e){this._blockEntityCollection||this.animations.push(e)}addAnimationGroup(e){this._blockEntityCollection||this.animationGroups.push(e)}addMultiMaterial(e){this._blockEntityCollection||(this.multiMaterials.push(e),this.onNewMultiMaterialAddedObservable.notifyObservers(e))}addMaterial(e){this._blockEntityCollection||e.getScene()===this&&e._indexInSceneMaterialArray!==-1||(e._indexInSceneMaterialArray=this.materials.length,this.materials.push(e),this.onNewMaterialAddedObservable.notifyObservers(e))}addMorphTargetManager(e){this._blockEntityCollection||this.morphTargetManagers.push(e)}addGeometry(e){this._blockEntityCollection||(this._geometriesByUniqueId&&(this._geometriesByUniqueId[e.uniqueId]=this.geometries.length),this.geometries.push(e))}addActionManager(e){this.actionManagers.push(e)}addTexture(e){this._blockEntityCollection||(this.textures.push(e),this.onNewTextureAddedObservable.notifyObservers(e))}switchActiveCamera(e,t=!0){this._engine.getInputElement()&&(this.activeCamera&&this.activeCamera.detachControl(),this.activeCamera=e,t&&e.attachControl())}setActiveCameraById(e){const t=this.getCameraById(e);return t?(this.activeCamera=t,t):null}setActiveCameraByName(e){const t=this.getCameraByName(e);return t?(this.activeCamera=t,t):null}getAnimationGroupByName(e){for(let t=0;t<this.animationGroups.length;t++)if(this.animationGroups[t].name===e)return this.animationGroups[t];return null}_getMaterial(e,t){for(let i=0;i<this.materials.length;i++){const r=this.materials[i];if(t(r))return r}if(e)for(let i=0;i<this.multiMaterials.length;i++){const r=this.multiMaterials[i];if(t(r))return r}return null}getMaterialByUniqueID(e,t=!1){return this._getMaterial(t,i=>i.uniqueId===e)}getMaterialById(e,t=!1){return this._getMaterial(t,i=>i.id===e)}getMaterialByName(e,t=!1){return this._getMaterial(t,i=>i.name===e)}getLastMaterialById(e,t=!1){for(let i=this.materials.length-1;i>=0;i--)if(this.materials[i].id===e)return this.materials[i];if(t){for(let i=this.multiMaterials.length-1;i>=0;i--)if(this.multiMaterials[i].id===e)return this.multiMaterials[i]}return null}getTextureByUniqueId(e){for(let t=0;t<this.textures.length;t++)if(this.textures[t].uniqueId===e)return this.textures[t];return null}getTextureByName(e){for(let t=0;t<this.textures.length;t++)if(this.textures[t].name===e)return this.textures[t];return null}getCameraById(e){for(let t=0;t<this.cameras.length;t++)if(this.cameras[t].id===e)return this.cameras[t];return null}getCameraByUniqueId(e){for(let t=0;t<this.cameras.length;t++)if(this.cameras[t].uniqueId===e)return this.cameras[t];return null}getCameraByName(e){for(let t=0;t<this.cameras.length;t++)if(this.cameras[t].name===e)return this.cameras[t];return null}getBoneById(e){for(let t=0;t<this.skeletons.length;t++){const i=this.skeletons[t];for(let r=0;r<i.bones.length;r++)if(i.bones[r].id===e)return i.bones[r]}return null}getBoneByName(e){for(let t=0;t<this.skeletons.length;t++){const i=this.skeletons[t];for(let r=0;r<i.bones.length;r++)if(i.bones[r].name===e)return i.bones[r]}return null}getLightByName(e){for(let t=0;t<this.lights.length;t++)if(this.lights[t].name===e)return this.lights[t];return null}getLightById(e){for(let t=0;t<this.lights.length;t++)if(this.lights[t].id===e)return this.lights[t];return null}getLightByUniqueId(e){for(let t=0;t<this.lights.length;t++)if(this.lights[t].uniqueId===e)return this.lights[t];return null}getParticleSystemById(e){for(let t=0;t<this.particleSystems.length;t++)if(this.particleSystems[t].id===e)return this.particleSystems[t];return null}getGeometryById(e){for(let t=0;t<this.geometries.length;t++)if(this.geometries[t].id===e)return this.geometries[t];return null}_getGeometryByUniqueId(e){if(this._geometriesByUniqueId){const t=this._geometriesByUniqueId[e];if(t!==void 0)return this.geometries[t]}else for(let t=0;t<this.geometries.length;t++)if(this.geometries[t].uniqueId===e)return this.geometries[t];return null}pushGeometry(e,t){return!t&&this._getGeometryByUniqueId(e.uniqueId)?!1:(this.addGeometry(e),this.onNewGeometryAddedObservable.notifyObservers(e),!0)}removeGeometry(e){let t;if(this._geometriesByUniqueId){if(t=this._geometriesByUniqueId[e.uniqueId],t===void 0)return!1}else if(t=this.geometries.indexOf(e),t<0)return!1;if(t!==this.geometries.length-1){const i=this.geometries[this.geometries.length-1];i&&(this.geometries[t]=i,this._geometriesByUniqueId&&(this._geometriesByUniqueId[i.uniqueId]=t))}return this._geometriesByUniqueId&&(this._geometriesByUniqueId[e.uniqueId]=void 0),this.geometries.pop(),this.onGeometryRemovedObservable.notifyObservers(e),!0}getGeometries(){return this.geometries}getMeshById(e){for(let t=0;t<this.meshes.length;t++)if(this.meshes[t].id===e)return this.meshes[t];return null}getMeshesById(e){return this.meshes.filter(function(t){return t.id===e})}getTransformNodeById(e){for(let t=0;t<this.transformNodes.length;t++)if(this.transformNodes[t].id===e)return this.transformNodes[t];return null}getTransformNodeByUniqueId(e){for(let t=0;t<this.transformNodes.length;t++)if(this.transformNodes[t].uniqueId===e)return this.transformNodes[t];return null}getTransformNodesById(e){return this.transformNodes.filter(function(t){return t.id===e})}getMeshByUniqueId(e){for(let t=0;t<this.meshes.length;t++)if(this.meshes[t].uniqueId===e)return this.meshes[t];return null}getLastMeshById(e){for(let t=this.meshes.length-1;t>=0;t--)if(this.meshes[t].id===e)return this.meshes[t];return null}getLastTransformNodeById(e){for(let t=this.transformNodes.length-1;t>=0;t--)if(this.transformNodes[t].id===e)return this.transformNodes[t];return null}getLastEntryById(e){let t;for(t=this.meshes.length-1;t>=0;t--)if(this.meshes[t].id===e)return this.meshes[t];for(t=this.transformNodes.length-1;t>=0;t--)if(this.transformNodes[t].id===e)return this.transformNodes[t];for(t=this.cameras.length-1;t>=0;t--)if(this.cameras[t].id===e)return this.cameras[t];for(t=this.lights.length-1;t>=0;t--)if(this.lights[t].id===e)return this.lights[t];return null}getNodeById(e){const t=this.getMeshById(e);if(t)return t;const i=this.getTransformNodeById(e);if(i)return i;const r=this.getLightById(e);if(r)return r;const s=this.getCameraById(e);if(s)return s;const a=this.getBoneById(e);return a||null}getNodeByName(e){const t=this.getMeshByName(e);if(t)return t;const i=this.getTransformNodeByName(e);if(i)return i;const r=this.getLightByName(e);if(r)return r;const s=this.getCameraByName(e);if(s)return s;const a=this.getBoneByName(e);return a||null}getMeshByName(e){for(let t=0;t<this.meshes.length;t++)if(this.meshes[t].name===e)return this.meshes[t];return null}getTransformNodeByName(e){for(let t=0;t<this.transformNodes.length;t++)if(this.transformNodes[t].name===e)return this.transformNodes[t];return null}getLastSkeletonById(e){for(let t=this.skeletons.length-1;t>=0;t--)if(this.skeletons[t].id===e)return this.skeletons[t];return null}getSkeletonByUniqueId(e){for(let t=0;t<this.skeletons.length;t++)if(this.skeletons[t].uniqueId===e)return this.skeletons[t];return null}getSkeletonById(e){for(let t=0;t<this.skeletons.length;t++)if(this.skeletons[t].id===e)return this.skeletons[t];return null}getSkeletonByName(e){for(let t=0;t<this.skeletons.length;t++)if(this.skeletons[t].name===e)return this.skeletons[t];return null}getMorphTargetManagerById(e){for(let t=0;t<this.morphTargetManagers.length;t++)if(this.morphTargetManagers[t].uniqueId===e)return this.morphTargetManagers[t];return null}getMorphTargetById(e){for(let t=0;t<this.morphTargetManagers.length;++t){const i=this.morphTargetManagers[t];for(let r=0;r<i.numTargets;++r){const s=i.getTarget(r);if(s.id===e)return s}}return null}getMorphTargetByName(e){for(let t=0;t<this.morphTargetManagers.length;++t){const i=this.morphTargetManagers[t];for(let r=0;r<i.numTargets;++r){const s=i.getTarget(r);if(s.name===e)return s}}return null}getPostProcessByName(e){for(let t=0;t<this.postProcesses.length;++t){const i=this.postProcesses[t];if(i.name===e)return i}return null}isActiveMesh(e){return this._activeMeshes.indexOf(e)!==-1}get uid(){return this._uid||(this._uid=X.RandomId()),this._uid}addExternalData(e,t){return this._externalData||(this._externalData=new K0),this._externalData.add(e,t)}getExternalData(e){return this._externalData?this._externalData.get(e):null}getOrAddExternalDataWithFactory(e,t){return this._externalData||(this._externalData=new K0),this._externalData.getOrAddWithFactory(e,t)}removeExternalData(e){return this._externalData.remove(e)}_evaluateSubMesh(e,t,i,r){if(r||e.isInFrustum(this._frustumPlanes)){for(const a of this._evaluateSubMeshStage)a.action(t,e);const s=e.getMaterial();s!=null&&(s.hasRenderTargetTextures&&s.getRenderTargetTextures!=null&&this._processedMaterials.indexOf(s)===-1&&(this._processedMaterials.push(s),this._materialsRenderTargets.concatWithNoDuplicate(s.getRenderTargetTextures())),this._renderingManager.dispatch(e,t,s))}}freeProcessedMaterials(){this._processedMaterials.dispose()}get blockfreeActiveMeshesAndRenderingGroups(){return this._preventFreeActiveMeshesAndRenderingGroups}set blockfreeActiveMeshesAndRenderingGroups(e){this._preventFreeActiveMeshesAndRenderingGroups!==e&&(e&&(this.freeActiveMeshes(),this.freeRenderingGroups()),this._preventFreeActiveMeshesAndRenderingGroups=e)}freeActiveMeshes(){if(!this.blockfreeActiveMeshesAndRenderingGroups&&(this._activeMeshes.dispose(),this.activeCamera&&this.activeCamera._activeMeshes&&this.activeCamera._activeMeshes.dispose(),this.activeCameras))for(let e=0;e<this.activeCameras.length;e++){const t=this.activeCameras[e];t&&t._activeMeshes&&t._activeMeshes.dispose()}}freeRenderingGroups(){if(!this.blockfreeActiveMeshesAndRenderingGroups&&(this._renderingManager&&this._renderingManager.freeRenderingGroups(),this.textures))for(let e=0;e<this.textures.length;e++){const t=this.textures[e];t&&t.renderList&&t.freeRenderingGroups()}}_isInIntermediateRendering(){return this._intermediateRendering}freezeActiveMeshes(e=!1,t,i,r=!0,s=!1){return this.executeWhenReady(()=>{if(!this.activeCamera){i&&i("No active camera found");return}if(this._frustumPlanes||this.updateTransformMatrix(),this._evaluateActiveMeshes(),this._activeMeshesFrozen=!0,this._activeMeshesFrozenButKeepClipping=s,this._skipEvaluateActiveMeshesCompletely=e,r)for(let a=0;a<this._activeMeshes.length;a++)this._activeMeshes.data[a]._freeze();t&&t()}),this}unfreezeActiveMeshes(){for(let e=0;e<this.meshes.length;e++){const t=this.meshes[e];t._internalAbstractMeshDataInfo&&(t._internalAbstractMeshDataInfo._isActive=!1)}for(let e=0;e<this._activeMeshes.length;e++)this._activeMeshes.data[e]._unFreeze();return this._activeMeshesFrozen=!1,this}_executeActiveContainerCleanup(e){!(this._engine.snapshotRendering&&this._engine.snapshotRenderingMode===1)&&this._activeMeshesFrozen&&this._activeMeshes.length||this.onBeforeRenderObservable.addOnce(()=>e.dispose())}_evaluateActiveMeshes(){var i;if(this._engine.snapshotRendering&&this._engine.snapshotRenderingMode===1){this._activeMeshes.length>0&&((i=this.activeCamera)==null||i._activeMeshes.reset(),this._activeMeshes.reset(),this._renderingManager.reset(),this._processedMaterials.reset(),this._activeParticleSystems.reset(),this._activeSkeletons.reset(),this._softwareSkinnedMeshes.reset());return}if(this._activeMeshesFrozen&&this._activeMeshes.length){if(!this._skipEvaluateActiveMeshesCompletely){const r=this._activeMeshes.length;for(let s=0;s<r;s++)this._activeMeshes.data[s].computeWorldMatrix()}if(this._activeParticleSystems){const r=this._activeParticleSystems.length;for(let s=0;s<r;s++)this._activeParticleSystems.data[s].animate()}this._renderingManager.resetSprites();return}if(!this.activeCamera)return;this.onBeforeActiveMeshesEvaluationObservable.notifyObservers(this),this.activeCamera._activeMeshes.reset(),this._activeMeshes.reset(),this._renderingManager.reset(),this._processedMaterials.reset(),this._activeParticleSystems.reset(),this._activeSkeletons.reset(),this._softwareSkinnedMeshes.reset(),this._materialsRenderTargets.reset();for(const r of this._beforeEvaluateActiveMeshStage)r.action();const e=this.getActiveMeshCandidates(),t=e.length;for(let r=0;r<t;r++){const s=e.data[r];if(s._internalAbstractMeshDataInfo._currentLODIsUpToDate=!1,s.isBlocked||(this._totalVertices.addCount(s.getTotalVertices(),!1),!s.isReady()||!s.isEnabled()||s.scaling.hasAZeroComponent))continue;s.computeWorldMatrix(),s.actionManager&&s.actionManager.hasSpecificTriggers2(12,13)&&this._meshesForIntersections.pushNoDuplicate(s);let a=this.customLODSelector?this.customLODSelector(s,this.activeCamera):s.getLOD(this.activeCamera);if(s._internalAbstractMeshDataInfo._currentLOD=a,s._internalAbstractMeshDataInfo._currentLODIsUpToDate=!0,a!=null&&(a!==s&&a.billboardMode!==0&&a.computeWorldMatrix(),s._preActivate(),s.isVisible&&s.visibility>0&&s.layerMask&this.activeCamera.layerMask&&(this._skipFrustumClipping||s.alwaysSelectAsActiveMesh||s.isInFrustum(this._frustumPlanes)))){this._activeMeshes.push(s),this.activeCamera._activeMeshes.push(s),a!==s&&a._activate(this._renderId,!1);for(const l of this._preActiveMeshStage)l.action(s);s._activate(this._renderId,!1)&&(s.isAnInstance?s._internalAbstractMeshDataInfo._actAsRegularMesh&&(a=s):a._internalAbstractMeshDataInfo._onlyForInstances=!1,a._internalAbstractMeshDataInfo._isActive=!0,this._activeMesh(s,a)),s._postActivate()}}if(this.onAfterActiveMeshesEvaluationObservable.notifyObservers(this),this.particlesEnabled){this.onBeforeParticlesRenderingObservable.notifyObservers(this);for(let r=0;r<this.particleSystems.length;r++){const s=this.particleSystems[r];if(!s.isStarted()||!s.emitter)continue;const a=s.emitter;(!a.position||a.isEnabled())&&(this._activeParticleSystems.push(s),s.animate(),this._renderingManager.dispatchParticles(s))}this.onAfterParticlesRenderingObservable.notifyObservers(this)}}_activeMesh(e,t){this._skeletonsEnabled&&t.skeleton!==null&&t.skeleton!==void 0&&(this._activeSkeletons.pushNoDuplicate(t.skeleton)&&(t.skeleton.prepare(),this._activeBones.addCount(t.skeleton.bones.length,!1)),t.computeBonesUsingShaders||this._softwareSkinnedMeshes.pushNoDuplicate(t));let i=e.hasInstances||e.isAnInstance||this.dispatchAllSubMeshesOfActiveMeshes||this._skipFrustumClipping||t.alwaysSelectAsActiveMesh;if(t&&t.subMeshes&&t.subMeshes.length>0){const r=this.getActiveSubMeshCandidates(t),s=r.length;i=i||s===1;for(let a=0;a<s;a++){const l=r.data[a];this._evaluateSubMesh(l,t,e,i)}}}updateTransformMatrix(e){const t=this.activeCamera;if(t)if(t._renderingMultiview){const i=t._rigCameras[0],r=t._rigCameras[1];this.setTransformMatrix(i.getViewMatrix(),i.getProjectionMatrix(e),r.getViewMatrix(),r.getProjectionMatrix(e))}else this.setTransformMatrix(t.getViewMatrix(),t.getProjectionMatrix(e))}_bindFrameBuffer(e,t=!0){e&&e._multiviewTexture?e._multiviewTexture._bindFrameBuffer():e&&e.outputRenderTarget?e.outputRenderTarget._bindFrameBuffer():this._engine._currentFrameBufferIsDefaultFrameBuffer()||this._engine.restoreDefaultFramebuffer(),t&&this._clearFrameBuffer(e)}_clearFrameBuffer(e){if(!(e&&e._multiviewTexture))if(e&&e.outputRenderTarget&&!e._renderingMultiview){const t=e.outputRenderTarget;t.onClearObservable.hasObservers()?t.onClearObservable.notifyObservers(this._engine):!t.skipInitialClear&&!e.isRightCamera&&(this.autoClear&&this._engine.clear(t.clearColor||this.clearColor,!t._cleared,!0,!0),t._cleared=!0)}else this._defaultFrameBufferCleared?this._engine.clear(null,!1,!0,!0):(this._defaultFrameBufferCleared=!0,this._clear())}_renderForCamera(e,t,i=!0){var a;if(e&&e._skipRendering)return;const r=this._engine;if(this._activeCamera=e,!this.activeCamera)throw new Error("Active camera not set");if(r.setViewport(this.activeCamera.viewport),this.resetCachedMaterial(),this._renderId++,!this.prePass&&i){let l=!0;e._renderingMultiview&&e.outputRenderTarget&&(l=e.outputRenderTarget.skipInitialClear,this.autoClear&&(this._defaultFrameBufferCleared=!1,e.outputRenderTarget.skipInitialClear=!1)),this._bindFrameBuffer(this._activeCamera),e._renderingMultiview&&e.outputRenderTarget&&(e.outputRenderTarget.skipInitialClear=l)}this.updateTransformMatrix(),this.onBeforeCameraRenderObservable.notifyObservers(this.activeCamera),this._evaluateActiveMeshes();for(let l=0;l<this._softwareSkinnedMeshes.length;l++){const o=this._softwareSkinnedMeshes.data[l];o.applySkeleton(o.skeleton)}this.onBeforeRenderTargetsRenderObservable.notifyObservers(this),this._renderTargets.concatWithNoDuplicate(this._materialsRenderTargets),e.customRenderTargets&&e.customRenderTargets.length>0&&this._renderTargets.concatWithNoDuplicate(e.customRenderTargets),t&&t.customRenderTargets&&t.customRenderTargets.length>0&&this._renderTargets.concatWithNoDuplicate(t.customRenderTargets),this.environmentTexture&&this.environmentTexture.isRenderTarget&&this._renderTargets.pushNoDuplicate(this.environmentTexture);for(const l of this._gatherActiveCameraRenderTargetsStage)l.action(this._renderTargets);let s=!1;if(this.renderTargetsEnabled){if(this._intermediateRendering=!0,this._renderTargets.length>0){X.StartPerformanceCounter("Render targets",this._renderTargets.length>0);for(let l=0;l<this._renderTargets.length;l++){const o=this._renderTargets.data[l];if(o._shouldRender()){this._renderId++;const c=o.activeCamera&&o.activeCamera!==this.activeCamera;o.render(c,this.dumpNextRenderTargets),s=!0}}X.EndPerformanceCounter("Render targets",this._renderTargets.length>0),this._renderId++}for(const l of this._cameraDrawRenderTargetStage)s=l.action(this.activeCamera)||s;this._intermediateRendering=!1}this._engine.currentRenderPassId=((a=e.outputRenderTarget)==null?void 0:a.renderPassId)??e.renderPassId??0,s&&!this.prePass&&(this._bindFrameBuffer(this._activeCamera,!1),this.updateTransformMatrix()),this.onAfterRenderTargetsRenderObservable.notifyObservers(this),this.postProcessManager&&!e._multiviewTexture&&!this.prePass&&this.postProcessManager._prepareFrame();for(const l of this._beforeCameraDrawStage)l.action(this.activeCamera);this.onBeforeDrawPhaseObservable.notifyObservers(this),r.snapshotRendering&&r.snapshotRenderingMode===1&&this.finalizeSceneUbo(),this._renderingManager.render(null,null,!0,!0),this.onAfterDrawPhaseObservable.notifyObservers(this);for(const l of this._afterCameraDrawStage)l.action(this.activeCamera);if(this.postProcessManager&&!e._multiviewTexture){const l=e.outputRenderTarget?e.outputRenderTarget.renderTarget:void 0;this.postProcessManager._finalizeFrame(e.isIntermediate,l)}for(const l of this._afterCameraPostProcessStage)l.action(this.activeCamera);this._renderTargets.reset(),this.onAfterCameraRenderObservable.notifyObservers(this.activeCamera)}_processSubCameras(e,t=!0){if(e.cameraRigMode===0||e._renderingMultiview){e._renderingMultiview&&!this._multiviewSceneUbo&&this._createMultiviewUbo(),this._renderForCamera(e,void 0,t),this.onAfterRenderCameraObservable.notifyObservers(e);return}if(e._useMultiviewToSingleView)this._renderMultiviewToSingleView(e);else{this.onBeforeCameraRenderObservable.notifyObservers(e);for(let i=0;i<e._rigCameras.length;i++)this._renderForCamera(e._rigCameras[i],e)}this._activeCamera=e,this.updateTransformMatrix(),this.onAfterRenderCameraObservable.notifyObservers(e)}_checkIntersections(){for(let e=0;e<this._meshesForIntersections.length;e++){const t=this._meshesForIntersections.data[e];if(t.actionManager)for(let i=0;t.actionManager&&i<t.actionManager.actions.length;i++){const r=t.actionManager.actions[i];if(r.trigger===12||r.trigger===13){const s=r.getTriggerParameter(),a=s.mesh?s.mesh:s,l=a.intersectsMesh(t,s.usePreciseIntersection),o=t._intersectionsInProgress.indexOf(a);l&&o===-1?r.trigger===12?(r._executeCurrent(ki.CreateNew(t,void 0,a)),t._intersectionsInProgress.push(a)):r.trigger===13&&t._intersectionsInProgress.push(a):!l&&o>-1&&(r.trigger===13&&r._executeCurrent(ki.CreateNew(t,void 0,a)),(!t.actionManager.hasSpecificTrigger(13,c=>{const u=c.mesh?c.mesh:c;return a===u})||r.trigger===13)&&t._intersectionsInProgress.splice(o,1))}}}}_advancePhysicsEngineStep(e){}_animate(e){}animate(){if(this._engine.isDeterministicLockStep()){let e=Math.max(Pt.MinDeltaTime,Math.min(this._engine.getDeltaTime(),Pt.MaxDeltaTime))+this._timeAccumulator;const t=this._engine.getTimeStep(),i=1e3/t/1e3;let r=0;const s=this._engine.getLockstepMaxSteps();let a=Math.floor(e/t);for(a=Math.min(a,s);e>0&&r<a;)this.onBeforeStepObservable.notifyObservers(this),this._animationRatio=t*i,this._animate(t),this.onAfterAnimationsObservable.notifyObservers(this),this.physicsEnabled&&this._advancePhysicsEngineStep(t),this.onAfterStepObservable.notifyObservers(this),this._currentStepId++,r++,e-=t;this._timeAccumulator=e<0?0:e}else{const e=this.useConstantAnimationDeltaTime?16:Math.max(Pt.MinDeltaTime,Math.min(this._engine.getDeltaTime(),Pt.MaxDeltaTime));this._animationRatio=e*(60/1e3),this._animate(),this.onAfterAnimationsObservable.notifyObservers(this),this.physicsEnabled&&this._advancePhysicsEngineStep(e)}}_clear(){(this.autoClearDepthAndStencil||this.autoClear)&&this._engine.clear(this.clearColor,this.autoClear||this.forceWireframe||this.forcePointsCloud,this.autoClearDepthAndStencil,this.autoClearDepthAndStencil)}_checkCameraRenderTarget(e){var t;if(e!=null&&e.outputRenderTarget&&!(e!=null&&e.isRigCamera)&&(e.outputRenderTarget._cleared=!1),(t=e==null?void 0:e.rigCameras)!=null&&t.length)for(let i=0;i<e.rigCameras.length;++i){const r=e.rigCameras[i].outputRenderTarget;r&&(r._cleared=!1)}}resetDrawCache(e){if(this.meshes)for(const t of this.meshes)t.resetDrawCache(e)}render(e=!0,t=!1){var s,a;if(this.isDisposed)return;this.onReadyObservable.hasObservers()&&this._executeWhenReadyTimeoutId===null&&this._checkIsReady(),this._frameId++,this._defaultFrameBufferCleared=!1,this._checkCameraRenderTarget(this.activeCamera),(s=this.activeCameras)!=null&&s.length&&this.activeCameras.forEach(this._checkCameraRenderTarget),this._registerTransientComponents(),this._activeParticles.fetchNewFrame(),this._totalVertices.fetchNewFrame(),this._activeIndices.fetchNewFrame(),this._activeBones.fetchNewFrame(),this._meshesForIntersections.reset(),this.resetCachedMaterial(),this.onBeforeAnimationsObservable.notifyObservers(this),this.actionManager&&this.actionManager.processTrigger(11),t||this.animate();for(const l of this._beforeCameraUpdateStage)l.action();if(e){if(this.activeCameras&&this.activeCameras.length>0)for(let l=0;l<this.activeCameras.length;l++){const o=this.activeCameras[l];if(o.update(),o.cameraRigMode!==0)for(let c=0;c<o._rigCameras.length;c++)o._rigCameras[c].update()}else if(this.activeCamera&&(this.activeCamera.update(),this.activeCamera.cameraRigMode!==0))for(let l=0;l<this.activeCamera._rigCameras.length;l++)this.activeCamera._rigCameras[l].update()}this.onBeforeRenderObservable.notifyObservers(this);const i=this.getEngine();this.onBeforeRenderTargetsRenderObservable.notifyObservers(this);const r=(a=this.activeCameras)!=null&&a.length?this.activeCameras[0]:this.activeCamera;if(this.renderTargetsEnabled){X.StartPerformanceCounter("Custom render targets",this.customRenderTargets.length>0),this._intermediateRendering=!0;for(let l=0;l<this.customRenderTargets.length;l++){const o=this.customRenderTargets[l];if(o._shouldRender()){if(this._renderId++,this.activeCamera=o.activeCamera||this.activeCamera,!this.activeCamera)throw new Error("Active camera not set");i.setViewport(this.activeCamera.viewport),this.updateTransformMatrix(),o.render(r!==this.activeCamera,this.dumpNextRenderTargets)}}X.EndPerformanceCounter("Custom render targets",this.customRenderTargets.length>0),this._intermediateRendering=!1,this._renderId++}this._engine.currentRenderPassId=(r==null?void 0:r.renderPassId)??0,this.activeCamera=r,this._activeCamera&&this._activeCamera.cameraRigMode!==22&&!this.prePass&&this._bindFrameBuffer(this._activeCamera,!1),this.onAfterRenderTargetsRenderObservable.notifyObservers(this);for(const l of this._beforeClearStage)l.action();this._clearFrameBuffer(this.activeCamera);for(const l of this._gatherRenderTargetsStage)l.action(this._renderTargets);if(this.activeCameras&&this.activeCameras.length>0)for(let l=0;l<this.activeCameras.length;l++)this._processSubCameras(this.activeCameras[l],l>0);else{if(!this.activeCamera)throw new Error("No camera defined");this._processSubCameras(this.activeCamera,!!this.activeCamera.outputRenderTarget)}this._checkIntersections();for(const l of this._afterRenderStage)l.action();if(this.afterRender&&this.afterRender(),this.onAfterRenderObservable.notifyObservers(this),this._toBeDisposed.length){for(let l=0;l<this._toBeDisposed.length;l++){const o=this._toBeDisposed[l];o&&o.dispose()}this._toBeDisposed.length=0}this.dumpNextRenderTargets&&(this.dumpNextRenderTargets=!1),this._activeBones.addCount(0,!0),this._activeIndices.addCount(0,!0),this._activeParticles.addCount(0,!0),this._engine.restoreDefaultFramebuffer()}freezeMaterials(){for(let e=0;e<this.materials.length;e++)this.materials[e].freeze()}unfreezeMaterials(){for(let e=0;e<this.materials.length;e++)this.materials[e].unfreeze()}dispose(){if(this.isDisposed)return;this.beforeRender=null,this.afterRender=null,this.metadata=null,this.skeletons.length=0,this.morphTargetManagers.length=0,this._transientComponents.length=0,this._isReadyForMeshStage.clear(),this._beforeEvaluateActiveMeshStage.clear(),this._evaluateSubMeshStage.clear(),this._preActiveMeshStage.clear(),this._cameraDrawRenderTargetStage.clear(),this._beforeCameraDrawStage.clear(),this._beforeRenderTargetDrawStage.clear(),this._beforeRenderingGroupDrawStage.clear(),this._beforeRenderingMeshStage.clear(),this._afterRenderingMeshStage.clear(),this._afterRenderingGroupDrawStage.clear(),this._afterCameraDrawStage.clear(),this._afterRenderTargetDrawStage.clear(),this._afterRenderStage.clear(),this._beforeCameraUpdateStage.clear(),this._beforeClearStage.clear(),this._gatherRenderTargetsStage.clear(),this._gatherActiveCameraRenderTargetsStage.clear(),this._pointerMoveStage.clear(),this._pointerDownStage.clear(),this._pointerUpStage.clear(),this.importedMeshesFiles=[],this.stopAllAnimations&&(this._activeAnimatables.forEach(s=>{s.onAnimationEndObservable.clear(),s.onAnimationEnd=null}),this.stopAllAnimations()),this.resetCachedMaterial(),this.activeCamera&&(this.activeCamera._activeMeshes.dispose(),this.activeCamera=null),this.activeCameras=null,this._activeMeshes.dispose(),this._renderingManager.dispose(),this._processedMaterials.dispose(),this._activeParticleSystems.dispose(),this._activeSkeletons.dispose(),this._softwareSkinnedMeshes.dispose(),this._renderTargets.dispose(),this._materialsRenderTargets.dispose(),this._registeredForLateAnimationBindings.dispose(),this._meshesForIntersections.dispose(),this._toBeDisposed.length=0;const e=this._activeRequests.slice();for(const s of e)s.abort();this._activeRequests.length=0;try{this.onDisposeObservable.notifyObservers(this)}catch(s){ee.Error("An error occurred while calling onDisposeObservable!",s)}if(this.detachControl(),this._engine.getInputElement())for(let s=0;s<this.cameras.length;s++)this.cameras[s].detachControl();this._disposeList(this.animationGroups),this._disposeList(this.lights),this._disposeList(this.meshes,s=>s.dispose(!0)),this._disposeList(this.transformNodes,s=>s.dispose(!0));const i=this.cameras;this._disposeList(i),this._defaultMaterial&&this._defaultMaterial.dispose(),this._disposeList(this.multiMaterials),this._disposeList(this.materials),this._disposeList(this.particleSystems),this._disposeList(this.postProcesses),this._disposeList(this.textures),this._disposeList(this.morphTargetManagers),this._sceneUbo.dispose(),this._multiviewSceneUbo&&this._multiviewSceneUbo.dispose(),this.postProcessManager.dispose(),this._disposeList(this._components);let r=this._engine.scenes.indexOf(this);r>-1&&this._engine.scenes.splice(r,1),He._LastCreatedScene===this&&(this._engine.scenes.length>0?He._LastCreatedScene=this._engine.scenes[this._engine.scenes.length-1]:He._LastCreatedScene=null),r=this._engine._virtualScenes.indexOf(this),r>-1&&this._engine._virtualScenes.splice(r,1),this._engine.wipeCaches(!0),this.onDisposeObservable.clear(),this.onBeforeRenderObservable.clear(),this.onAfterRenderObservable.clear(),this.onBeforeRenderTargetsRenderObservable.clear(),this.onAfterRenderTargetsRenderObservable.clear(),this.onAfterStepObservable.clear(),this.onBeforeStepObservable.clear(),this.onBeforeActiveMeshesEvaluationObservable.clear(),this.onAfterActiveMeshesEvaluationObservable.clear(),this.onBeforeParticlesRenderingObservable.clear(),this.onAfterParticlesRenderingObservable.clear(),this.onBeforeDrawPhaseObservable.clear(),this.onAfterDrawPhaseObservable.clear(),this.onBeforeAnimationsObservable.clear(),this.onAfterAnimationsObservable.clear(),this.onDataLoadedObservable.clear(),this.onBeforeRenderingGroupObservable.clear(),this.onAfterRenderingGroupObservable.clear(),this.onMeshImportedObservable.clear(),this.onBeforeCameraRenderObservable.clear(),this.onAfterCameraRenderObservable.clear(),this.onAfterRenderCameraObservable.clear(),this.onReadyObservable.clear(),this.onNewCameraAddedObservable.clear(),this.onCameraRemovedObservable.clear(),this.onNewLightAddedObservable.clear(),this.onLightRemovedObservable.clear(),this.onNewGeometryAddedObservable.clear(),this.onGeometryRemovedObservable.clear(),this.onNewTransformNodeAddedObservable.clear(),this.onTransformNodeRemovedObservable.clear(),this.onNewMeshAddedObservable.clear(),this.onMeshRemovedObservable.clear(),this.onNewSkeletonAddedObservable.clear(),this.onSkeletonRemovedObservable.clear(),this.onNewMaterialAddedObservable.clear(),this.onNewMultiMaterialAddedObservable.clear(),this.onMaterialRemovedObservable.clear(),this.onMultiMaterialRemovedObservable.clear(),this.onNewTextureAddedObservable.clear(),this.onTextureRemovedObservable.clear(),this.onPrePointerObservable.clear(),this.onPointerObservable.clear(),this.onPreKeyboardObservable.clear(),this.onKeyboardObservable.clear(),this.onActiveCameraChanged.clear(),this.onScenePerformancePriorityChangedObservable.clear(),this._isDisposed=!0}_disposeList(e,t){const i=e.slice(0);t=t??(r=>r.dispose());for(const r of i)t(r);e.length=0}get isDisposed(){return this._isDisposed}clearCachedVertexData(){for(let e=0;e<this.meshes.length;e++){const i=this.meshes[e].geometry;i&&i.clearCachedData()}}cleanCachedTextureBuffer(){for(const e of this.textures)e._buffer&&(e._buffer=null)}getWorldExtends(e){const t=new A(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),i=new A(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return e=e||(()=>!0),this.meshes.filter(e).forEach(r=>{if(r.computeWorldMatrix(!0),!r.subMeshes||r.subMeshes.length===0||r.infiniteDistance)return;const s=r.getBoundingInfo(),a=s.boundingBox.minimumWorld,l=s.boundingBox.maximumWorld;A.CheckExtends(a,t,i),A.CheckExtends(l,t,i)}),{min:t,max:i}}createPickingRay(e,t,i,r,s=!1){throw ke("Ray")}createPickingRayToRef(e,t,i,r,s,a=!1,l=!1){throw ke("Ray")}createPickingRayInCameraSpace(e,t,i){throw ke("Ray")}createPickingRayInCameraSpaceToRef(e,t,i,r){throw ke("Ray")}get _pickingAvailable(){return!1}pick(e,t,i,r,s,a){const l=ke("Ray",!0);return l&&ee.Warn(l),new Fs}pickWithBoundingInfo(e,t,i,r,s){const a=ke("Ray",!0);return a&&ee.Warn(a),new Fs}pickWithRay(e,t,i,r){throw ke("Ray")}multiPick(e,t,i,r,s){throw ke("Ray")}multiPickWithRay(e,t,i){throw ke("Ray")}setPointerOverMesh(e,t,i){this._inputManager.setPointerOverMesh(e,t,i)}getPointerOverMesh(){return this._inputManager.getPointerOverMesh()}_rebuildGeometries(){for(const e of this.geometries)e._rebuild();for(const e of this.meshes)e._rebuild();this.postProcessManager&&this.postProcessManager._rebuild();for(const e of this._components)e.rebuild();for(const e of this.particleSystems)e.rebuild();if(this.spriteManagers)for(const e of this.spriteManagers)e.rebuild()}_rebuildTextures(){for(const e of this.textures)e._rebuild(!0);this.markAllMaterialsAsDirty(1)}_getByTags(e,t,i){if(t===void 0)return e;const r=[];for(const s in e){const a=e[s];ct&&ct.MatchesQuery(a,t)&&(!i||i(a))&&r.push(a)}return r}getMeshesByTags(e,t){return this._getByTags(this.meshes,e,t)}getCamerasByTags(e,t){return this._getByTags(this.cameras,e,t)}getLightsByTags(e,t){return this._getByTags(this.lights,e,t)}getMaterialByTags(e,t){return this._getByTags(this.materials,e,t).concat(this._getByTags(this.multiMaterials,e,t))}getTransformNodesByTags(e,t){return this._getByTags(this.transformNodes,e,t)}setRenderingOrder(e,t=null,i=null,r=null){this._renderingManager.setRenderingOrder(e,t,i,r)}setRenderingAutoClearDepthStencil(e,t,i=!0,r=!0){this._renderingManager.setRenderingAutoClearDepthStencil(e,t,i,r)}getAutoClearDepthStencilSetup(e){return this._renderingManager.getAutoClearDepthStencilSetup(e)}_forceBlockMaterialDirtyMechanism(e){this._blockMaterialDirtyMechanism=e}get blockMaterialDirtyMechanism(){return this._blockMaterialDirtyMechanism}set blockMaterialDirtyMechanism(e){this._blockMaterialDirtyMechanism!==e&&(this._blockMaterialDirtyMechanism=e,e||this.markAllMaterialsAsDirty(63))}markAllMaterialsAsDirty(e,t){if(!this._blockMaterialDirtyMechanism)for(const i of this.materials)t&&!t(i)||i.markAsDirty(e)}_loadFile(e,t,i,r,s,a,l){const o=Da(e,t,i,r?this.offlineProvider:void 0,s,a,l);return this._activeRequests.push(o),o.onCompleteObservable.add(c=>{this._activeRequests.splice(this._activeRequests.indexOf(c),1)}),o}_loadFileAsync(e,t,i,r,s){return new Promise((a,l)=>{this._loadFile(e,o=>{a(o)},t,i,r,(o,c)=>{l(c)},s)})}_requestFile(e,t,i,r,s,a,l){const o=fm(e,t,i,r?this.offlineProvider:void 0,s,a,l);return this._activeRequests.push(o),o.onCompleteObservable.add(c=>{this._activeRequests.splice(this._activeRequests.indexOf(c),1)}),o}_requestFileAsync(e,t,i,r,s){return new Promise((a,l)=>{this._requestFile(e,o=>{a(o)},t,i,r,o=>{l(o)},s)})}_readFile(e,t,i,r,s){const a=su(e,t,i,r,s);return this._activeRequests.push(a),a.onCompleteObservable.add(l=>{this._activeRequests.splice(this._activeRequests.indexOf(l),1)}),a}_readFileAsync(e,t,i){return new Promise((r,s)=>{this._readFile(e,a=>{r(a)},t,i,a=>{s(a)})})}getPerfCollector(){throw ke("performanceViewerSceneExtension")}setActiveCameraByID(e){return this.setActiveCameraById(e)}getMaterialByID(e){return this.getMaterialById(e)}getLastMaterialByID(e){return this.getLastMaterialById(e)}getTextureByUniqueID(e){return this.getTextureByUniqueId(e)}getCameraByID(e){return this.getCameraById(e)}getCameraByUniqueID(e){return this.getCameraByUniqueId(e)}getBoneByID(e){return this.getBoneById(e)}getLightByID(e){return this.getLightById(e)}getLightByUniqueID(e){return this.getLightByUniqueId(e)}getParticleSystemByID(e){return this.getParticleSystemById(e)}getGeometryByID(e){return this.getGeometryById(e)}getMeshByID(e){return this.getMeshById(e)}getMeshByUniqueID(e){return this.getMeshByUniqueId(e)}getLastMeshByID(e){return this.getLastMeshById(e)}getMeshesByID(e){return this.getMeshesById(e)}getTransformNodeByID(e){return this.getTransformNodeById(e)}getTransformNodeByUniqueID(e){return this.getTransformNodeByUniqueId(e)}getTransformNodesByID(e){return this.getTransformNodesById(e)}getNodeByID(e){return this.getNodeById(e)}getLastEntryByID(e){return this.getLastEntryById(e)}getLastSkeletonByID(e){return this.getLastSkeletonById(e)}}Pt.FOGMODE_NONE=0;Pt.FOGMODE_EXP=1;Pt.FOGMODE_EXP2=2;Pt.FOGMODE_LINEAR=3;Pt.MinDeltaTime=1;Pt.MaxDeltaTime=1e3;class UN{constructor(e=30){this._enabled=!0,this._rollingFrameTime=new zN(e)}sampleFrame(e=mn.Now){if(this._enabled){if(this._lastFrameTimeMs!=null){const t=e-this._lastFrameTimeMs;this._rollingFrameTime.add(t)}this._lastFrameTimeMs=e}}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){const e=this._rollingFrameTime.history(0);return e===0?0:1e3/e}get isSaturated(){return this._rollingFrameTime.isSaturated()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}get isEnabled(){return this._enabled}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}class zN{constructor(e){this._samples=new Array(e),this.reset()}add(e){let t;if(this.isSaturated()){const i=this._samples[this._pos];t=i-this.average,this.average-=t/(this._sampleCount-1),this._m2-=t*(i-this.average)}else this._sampleCount++;t=e-this.average,this.average+=t/this._sampleCount,this._m2+=t*(e-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=e,this._pos++,this._pos%=this._samples.length}history(e){if(e>=this._sampleCount||e>=this._samples.length)return 0;const t=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(t-e)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(e){const t=this._samples.length;return(e%t+t)%t}}we.prototype.setAlphaConstants=function(n,e,t,i){this._alphaState.setAlphaBlendConstants(n,e,t,i)};we.prototype.setAlphaMode=function(n,e=!1){if(this._alphaMode===n){if(!e){const t=n===0;this.depthCullingState.depthMask!==t&&(this.depthCullingState.depthMask=t)}return}switch(n){case 0:this._alphaState.alphaBlend=!1;break;case 7:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 8:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 2:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 6:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 1:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 3:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ZERO,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 4:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_COLOR,this._gl.ZERO,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 5:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 9:this._alphaState.setAlphaBlendFunctionParameters(this._gl.CONSTANT_COLOR,this._gl.ONE_MINUS_CONSTANT_COLOR,this._gl.CONSTANT_ALPHA,this._gl.ONE_MINUS_CONSTANT_ALPHA),this._alphaState.alphaBlend=!0;break;case 10:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 11:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 12:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 13:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE_MINUS_DST_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 14:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 15:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 16:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 17:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break}e||(this.depthCullingState.depthMask=n===0),this._alphaMode=n};we.prototype.getAlphaMode=function(){return this._alphaMode};we.prototype.setAlphaEquation=function(n){if(this._alphaEquation!==n){switch(n){case 0:this._alphaState.setAlphaEquationParameters(32774,32774);break;case 1:this._alphaState.setAlphaEquationParameters(32778,32778);break;case 2:this._alphaState.setAlphaEquationParameters(32779,32779);break;case 3:this._alphaState.setAlphaEquationParameters(32776,32776);break;case 4:this._alphaState.setAlphaEquationParameters(32775,32775);break;case 5:this._alphaState.setAlphaEquationParameters(32775,32774);break}this._alphaEquation=n}};we.prototype.getAlphaEquation=function(){return this._alphaEquation};function VN(n,e,t=!1,i){switch(n){case 3:return e instanceof ArrayBuffer?new Int8Array(e):new Int8Array(e);case 0:return e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e);case 4:return e instanceof ArrayBuffer?new Int16Array(e):new Int16Array(t?e/2:e);case 5:case 8:case 9:case 10:case 2:return e instanceof ArrayBuffer?new Uint16Array(e):new Uint16Array(t?e/2:e);case 6:return e instanceof ArrayBuffer?new Int32Array(e):new Int32Array(t?e/4:e);case 7:case 11:case 12:case 13:case 14:case 15:return e instanceof ArrayBuffer?new Uint32Array(e):new Uint32Array(t?e/4:e);case 1:return e instanceof ArrayBuffer?new Float32Array(e):new Float32Array(t?e/4:e)}return e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e)}we.prototype._readTexturePixelsSync=function(n,e,t,i=-1,r=0,s=null,a=!0,l=!1,o=0,c=0){var d,f;const u=this._gl;if(!u)throw new Error("Engine does not have gl rendering context.");if(!this._dummyFramebuffer){const _=u.createFramebuffer();if(!_)throw new Error("Unable to create dummy framebuffer");this._dummyFramebuffer=_}u.bindFramebuffer(u.FRAMEBUFFER,this._dummyFramebuffer),i>-1?u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_CUBE_MAP_POSITIVE_X+i,(d=n._hardwareTexture)==null?void 0:d.underlyingResource,r):u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,(f=n._hardwareTexture)==null?void 0:f.underlyingResource,r);let h=n.type!==void 0?this._getWebGLTextureType(n.type):u.UNSIGNED_BYTE;if(l)s||(s=VN(n.type,4*e*t));else switch(h){case u.UNSIGNED_BYTE:s||(s=new Uint8Array(4*e*t)),h=u.UNSIGNED_BYTE;break;default:s||(s=new Float32Array(4*e*t)),h=u.FLOAT;break}return a&&this.flushFramebuffer(),u.readPixels(o,c,e,t,u.RGBA,h,s),u.bindFramebuffer(u.FRAMEBUFFER,this._currentFramebuffer),s};we.prototype._readTexturePixels=function(n,e,t,i=-1,r=0,s=null,a=!0,l=!1,o=0,c=0){return Promise.resolve(this._readTexturePixelsSync(n,e,t,i,r,s,a,l,o,c))};we.prototype.updateDynamicIndexBuffer=function(n,e,t=0){this._currentBoundBuffer[this._gl.ELEMENT_ARRAY_BUFFER]=null,this.bindIndexBuffer(n);let i;n.is32Bits?i=e instanceof Uint32Array?e:new Uint32Array(e):i=e instanceof Uint16Array?e:new Uint16Array(e),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,i,this._gl.DYNAMIC_DRAW),this._resetIndexBufferBinding()};we.prototype.updateDynamicVertexBuffer=function(n,e,t,i){this.bindArrayBuffer(n),t===void 0&&(t=0);const r=e.byteLength||e.length;i===void 0||i>=r&&t===0?e instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,t,new Float32Array(e)):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,t,e):e instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,new Float32Array(e).subarray(t,t+i)):(e instanceof ArrayBuffer?e=new Uint8Array(e,t,i):e=new Uint8Array(e.buffer,e.byteOffset+t,i),this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e)),this._resetVertexBufferBinding()};class Z extends we{static get NpmPackage(){return we.NpmPackage}static get Version(){return we.Version}static get Instances(){return He.Instances}static get LastCreatedEngine(){return He.LastCreatedEngine}static get LastCreatedScene(){return He.LastCreatedScene}_createImageBitmapFromSource(e,t){return new Promise((r,s)=>{const a=new Image;a.onload=()=>{a.decode().then(()=>{this.createImageBitmap(a,t).then(l=>{r(l)})})},a.onerror=()=>{s(`Error loading image ${a.src}`)},a.src=e})}createImageBitmap(e,t){return createImageBitmap(e,t)}resizeImageBitmap(e,t,i){const s=this.createCanvas(t,i).getContext("2d");if(!s)throw new Error("Unable to get 2d context for resizeImageBitmap");return s.drawImage(e,0,0),s.getImageData(0,0,t,i).data}static MarkAllMaterialsAsDirty(e,t){for(let i=0;i<Z.Instances.length;i++){const r=Z.Instances[i];for(let s=0;s<r.scenes.length;s++)r.scenes[s].markAllMaterialsAsDirty(e,t)}}static DefaultLoadingScreenFactory(e){throw ke("LoadingScreen")}get _supportsHardwareTextureRescaling(){return!!Z._RescalePostProcessFactory}get performanceMonitor(){return this._performanceMonitor}get compatibilityMode(){return this._compatibilityMode}set compatibilityMode(e){this._compatibilityMode=!0}getInputElement(){return this._renderingCanvas}constructor(e,t,i,r=!1){if(super(e,t,i,r),this.enableOfflineSupport=!1,this.disableManifestCheck=!1,this.disableContextMenu=!0,this.scenes=[],this._virtualScenes=new Array,this.onNewSceneAddedObservable=new Y,this.postProcesses=[],this.isPointerLock=!1,this.onResizeObservable=new Y,this.onCanvasBlurObservable=new Y,this.onCanvasFocusObservable=new Y,this.onCanvasPointerOutObservable=new Y,this.onBeginFrameObservable=new Y,this.customAnimationFrameRequester=null,this.onEndFrameObservable=new Y,this.onBeforeShaderCompilationObservable=new Y,this.onAfterShaderCompilationObservable=new Y,this._deterministicLockstep=!1,this._lockstepMaxSteps=4,this._timeStep=1/60,this._fps=60,this._deltaTime=0,this._drawCalls=new rs,this.canvasTabIndex=1,this.disablePerformanceMonitorInBackground=!1,this._performanceMonitor=new UN,this._compatibilityMode=!0,this.currentRenderPassId=0,this._renderPassNames=["main"],Z.Instances.push(this),!!e&&(this._features.supportRenderPasses=!0,i=this._creationOptions,e.getContext)){const s=e;this._sharedInit(s)}}_initGLContext(){super._initGLContext(),this._rescalePostProcess=null}_sharedInit(e){super._sharedInit(e),this._onCanvasFocus=()=>{this.onCanvasFocusObservable.notifyObservers(this)},this._onCanvasBlur=()=>{this.onCanvasBlurObservable.notifyObservers(this)},this._onCanvasContextMenu=i=>{this.disableContextMenu&&i.preventDefault()},e.addEventListener("focus",this._onCanvasFocus),e.addEventListener("blur",this._onCanvasBlur),e.addEventListener("contextmenu",this._onCanvasContextMenu),this._onBlur=()=>{this.disablePerformanceMonitorInBackground&&this._performanceMonitor.disable(),this._windowIsBackground=!0},this._onFocus=()=>{this.disablePerformanceMonitorInBackground&&this._performanceMonitor.enable(),this._windowIsBackground=!1},this._onCanvasPointerOut=i=>{document.elementFromPoint(i.clientX,i.clientY)!==e&&this.onCanvasPointerOutObservable.notifyObservers(i)};const t=this.getHostWindow();t&&typeof t.addEventListener=="function"&&(t.addEventListener("blur",this._onBlur),t.addEventListener("focus",this._onFocus)),e.addEventListener("pointerout",this._onCanvasPointerOut),this._creationOptions.doNotHandleTouchAction||this._disableTouchAction(),!Z.audioEngine&&this._creationOptions.audioEngine&&Z.AudioEngineFactory&&(Z.audioEngine=Z.AudioEngineFactory(this.getRenderingCanvas(),this.getAudioContext(),this.getAudioDestination())),Vc()&&(this._onFullscreenChange=()=>{this.isFullscreen=!!document.fullscreenElement,this.isFullscreen&&this._pointerLockRequested&&e&&Z._RequestPointerlock(e)},document.addEventListener("fullscreenchange",this._onFullscreenChange,!1),document.addEventListener("webkitfullscreenchange",this._onFullscreenChange,!1),this._onPointerLockChange=()=>{this.isPointerLock=document.pointerLockElement===e},document.addEventListener("pointerlockchange",this._onPointerLockChange,!1),document.addEventListener("webkitpointerlockchange",this._onPointerLockChange,!1)),this.enableOfflineSupport=Z.OfflineProviderFactory!==void 0,this._deterministicLockstep=!!this._creationOptions.deterministicLockstep,this._lockstepMaxSteps=this._creationOptions.lockstepMaxSteps||0,this._timeStep=this._creationOptions.timeStep||1/60}_verifyPointerLock(){var e;(e=this._onPointerLockChange)==null||e.call(this)}getAspectRatio(e,t=!1){const i=e.viewport;return this.getRenderWidth(t)*i.width/(this.getRenderHeight(t)*i.height)}getScreenAspectRatio(){return this.getRenderWidth(!0)/this.getRenderHeight(!0)}getRenderingCanvasClientRect(){return this._renderingCanvas?this._renderingCanvas.getBoundingClientRect():null}getInputElementClientRect(){return this._renderingCanvas?this.getInputElement().getBoundingClientRect():null}isDeterministicLockStep(){return this._deterministicLockstep}getLockstepMaxSteps(){return this._lockstepMaxSteps}getTimeStep(){return this._timeStep*1e3}generateMipMapsForCubemap(e,t=!0){if(e.generateMipMaps){const i=this._gl;this._bindTextureDirectly(i.TEXTURE_CUBE_MAP,e,!0),i.generateMipmap(i.TEXTURE_CUBE_MAP),t&&this._bindTextureDirectly(i.TEXTURE_CUBE_MAP,null)}}getDepthWrite(){return this._depthCullingState.depthMask}setDepthWrite(e){this._depthCullingState.depthMask=e}getStencilBuffer(){return this._stencilState.stencilTest}setStencilBuffer(e){this._stencilState.stencilTest=e}getStencilMask(){return this._stencilState.stencilMask}setStencilMask(e){this._stencilState.stencilMask=e}getStencilFunction(){return this._stencilState.stencilFunc}getStencilFunctionReference(){return this._stencilState.stencilFuncRef}getStencilFunctionMask(){return this._stencilState.stencilFuncMask}setStencilFunction(e){this._stencilState.stencilFunc=e}setStencilFunctionReference(e){this._stencilState.stencilFuncRef=e}setStencilFunctionMask(e){this._stencilState.stencilFuncMask=e}getStencilOperationFail(){return this._stencilState.stencilOpStencilFail}getStencilOperationDepthFail(){return this._stencilState.stencilOpDepthFail}getStencilOperationPass(){return this._stencilState.stencilOpStencilDepthPass}setStencilOperationFail(e){this._stencilState.stencilOpStencilFail=e}setStencilOperationDepthFail(e){this._stencilState.stencilOpDepthFail=e}setStencilOperationPass(e){this._stencilState.stencilOpStencilDepthPass=e}setDitheringState(e){e?this._gl.enable(this._gl.DITHER):this._gl.disable(this._gl.DITHER)}setRasterizerState(e){e?this._gl.disable(this._gl.RASTERIZER_DISCARD):this._gl.enable(this._gl.RASTERIZER_DISCARD)}getDepthFunction(){return this._depthCullingState.depthFunc}setDepthFunction(e){this._depthCullingState.depthFunc=e}setDepthFunctionToGreater(){this.setDepthFunction(516)}setDepthFunctionToGreaterOrEqual(){this.setDepthFunction(518)}setDepthFunctionToLess(){this.setDepthFunction(513)}setDepthFunctionToLessOrEqual(){this.setDepthFunction(515)}cacheStencilState(){this._cachedStencilBuffer=this.getStencilBuffer(),this._cachedStencilFunction=this.getStencilFunction(),this._cachedStencilMask=this.getStencilMask(),this._cachedStencilOperationPass=this.getStencilOperationPass(),this._cachedStencilOperationFail=this.getStencilOperationFail(),this._cachedStencilOperationDepthFail=this.getStencilOperationDepthFail(),this._cachedStencilReference=this.getStencilFunctionReference()}restoreStencilState(){this.setStencilFunction(this._cachedStencilFunction),this.setStencilMask(this._cachedStencilMask),this.setStencilBuffer(this._cachedStencilBuffer),this.setStencilOperationPass(this._cachedStencilOperationPass),this.setStencilOperationFail(this._cachedStencilOperationFail),this.setStencilOperationDepthFail(this._cachedStencilOperationDepthFail),this.setStencilFunctionReference(this._cachedStencilReference)}setDirectViewport(e,t,i,r){const s=this._cachedViewport;return this._cachedViewport=null,this._viewport(e,t,i,r),s}scissorClear(e,t,i,r,s){this.enableScissor(e,t,i,r),this.clear(s,!0,!0,!0),this.disableScissor()}enableScissor(e,t,i,r){const s=this._gl;s.enable(s.SCISSOR_TEST),s.scissor(e,t,i,r)}disableScissor(){const e=this._gl;e.disable(e.SCISSOR_TEST)}_reportDrawCall(e=1){this._drawCalls.addCount(e,!1)}_loadFileAsync(e,t,i){return new Promise((r,s)=>{this._loadFile(e,a=>{r(a)},void 0,t,i,(a,l)=>{s(l)})})}getVertexShaderSource(e){const t=this._gl.getAttachedShaders(e);return t?this._gl.getShaderSource(t[0]):null}getFragmentShaderSource(e){const t=this._gl.getAttachedShaders(e);return t?this._gl.getShaderSource(t[1]):null}setDepthStencilTexture(e,t,i,r){e!==void 0&&(t&&(this._boundUniforms[e]=t),!i||!i.depthStencilTexture?this._setTexture(e,null,void 0,void 0,r):this._setTexture(e,i,!1,!0,r))}setTextureFromPostProcess(e,t,i){let r=null;t&&(t._forcedOutputTexture?r=t._forcedOutputTexture:t._textures.data[t._currentRenderTextureInd]&&(r=t._textures.data[t._currentRenderTextureInd])),this._bindTexture(e,(r==null?void 0:r.texture)??null,i)}setTextureFromPostProcessOutput(e,t,i){var r;this._bindTexture(e,((r=t==null?void 0:t._outputTexture)==null?void 0:r.texture)??null,i)}set framebufferDimensionsObject(e){this._framebufferDimensionsObject=e,this._framebufferDimensionsObject&&this.onResizeObservable.notifyObservers(this)}_rebuildBuffers(){for(const e of this.scenes)e.resetCachedMaterial(),e._rebuildGeometries();for(const e of this._virtualScenes)e.resetCachedMaterial(),e._rebuildGeometries();super._rebuildBuffers()}_rebuildTextures(){for(const e of this.scenes)e._rebuildTextures();for(const e of this._virtualScenes)e._rebuildTextures();super._rebuildTextures()}_renderFrame(){for(let e=0;e<this._activeRenderLoops.length;e++){const t=this._activeRenderLoops[e];t()}}_cancelFrame(){if(this.customAnimationFrameRequester){if(this._frameHandler!==0){this._frameHandler=0;const{cancelAnimationFrame:e}=this.customAnimationFrameRequester;e&&e(this.customAnimationFrameRequester.requestID)}}else super._cancelFrame()}_renderLoop(){if(this._frameHandler=0,!this._contextWasLost){let e=!0;(this.isDisposed||!this.renderEvenInBackground&&this._windowIsBackground)&&(e=!1),e&&(this.beginFrame(),this._renderViews()||this._renderFrame(),this.endFrame())}this._frameHandler===0&&(this.customAnimationFrameRequester?(this.customAnimationFrameRequester.requestID=this._queueNewFrame(this.customAnimationFrameRequester.renderFunction||this._boundRenderFunction,this.customAnimationFrameRequester),this._frameHandler=this.customAnimationFrameRequester.requestID):this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()))}_renderViews(){return!1}switchFullscreen(e){this.isFullscreen?this.exitFullscreen():this.enterFullscreen(e)}enterFullscreen(e){this.isFullscreen||(this._pointerLockRequested=e,this._renderingCanvas&&Z._RequestFullscreen(this._renderingCanvas))}exitFullscreen(){this.isFullscreen&&Z._ExitFullscreen()}enterPointerlock(){this._renderingCanvas&&Z._RequestPointerlock(this._renderingCanvas)}exitPointerlock(){Z._ExitPointerlock()}beginFrame(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this),super.beginFrame()}endFrame(){super.endFrame(),this.onEndFrameObservable.notifyObservers(this)}setSize(e,t,i=!1){if(!this._renderingCanvas||!super.setSize(e,t,i))return!1;if(this.scenes){for(let r=0;r<this.scenes.length;r++){const s=this.scenes[r];for(let a=0;a<s.cameras.length;a++){const l=s.cameras[a];l._currentRenderId=0}}this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0}_deletePipelineContext(e){const t=e;t&&t.program&&t.transformFeedback&&(this.deleteTransformFeedback(t.transformFeedback),t.transformFeedback=null),super._deletePipelineContext(e)}createShaderProgram(e,t,i,r,s,a=null){s=s||this._gl,this.onBeforeShaderCompilationObservable.notifyObservers(this);const l=super.createShaderProgram(e,t,i,r,s,a);return this.onAfterShaderCompilationObservable.notifyObservers(this),l}_createShaderProgram(e,t,i,r,s=null){const a=r.createProgram();if(e.program=a,!a)throw new Error("Unable to create program");if(r.attachShader(a,t),r.attachShader(a,i),this.webGLVersion>1&&s){const l=this.createTransformFeedback();this.bindTransformFeedback(l),this.setTranformFeedbackVaryings(a,s),e.transformFeedback=l}return r.linkProgram(a),this.webGLVersion>1&&s&&this.bindTransformFeedback(null),e.context=r,e.vertexShader=t,e.fragmentShader=i,e.isParallelCompiled||this._finalizePipelineContext(e),a}_releaseTexture(e){super._releaseTexture(e)}_releaseRenderTargetWrapper(e){super._releaseRenderTargetWrapper(e),this.scenes.forEach(t=>{t.postProcesses.forEach(i=>{i._outputTexture===e&&(i._outputTexture=null)}),t.cameras.forEach(i=>{i._postProcesses.forEach(r=>{r&&r._outputTexture===e&&(r._outputTexture=null)})})})}getRenderPassNames(){return this._renderPassNames}getCurrentRenderPassName(){return this._renderPassNames[this.currentRenderPassId]}createRenderPassId(e){const t=++Z._RenderPassIdCounter;return this._renderPassNames[t]=e??"NONAME",t}releaseRenderPassId(e){this._renderPassNames[e]=void 0;for(let t=0;t<this.scenes.length;++t){const i=this.scenes[t];for(let r=0;r<i.meshes.length;++r){const s=i.meshes[r];if(s.subMeshes)for(let a=0;a<s.subMeshes.length;++a)s.subMeshes[a]._removeDrawWrapper(e)}}}_rescaleTexture(e,t,i,r,s){this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE);const a=this.createRenderTargetTexture({width:t.width,height:t.height},{generateMipMaps:!1,type:0,samplingMode:2,generateDepthBuffer:!1,generateStencilBuffer:!1});!this._rescalePostProcess&&Z._RescalePostProcessFactory&&(this._rescalePostProcess=Z._RescalePostProcessFactory(this)),this._rescalePostProcess&&(this._rescalePostProcess.externalTextureSamplerBinding=!0,this._rescalePostProcess.getEffect().executeWhenCompiled(()=>{this._rescalePostProcess.onApply=function(o){o._bindTexture("textureSampler",e)};let l=i;l||(l=this.scenes[this.scenes.length-1]),l.postProcessManager.directRender([this._rescalePostProcess],a,!0),this._bindTextureDirectly(this._gl.TEXTURE_2D,t,!0),this._gl.copyTexImage2D(this._gl.TEXTURE_2D,0,r,0,0,t.width,t.height,0),this.unBindFramebuffer(a),a.dispose(),s&&s()}))}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}wrapWebGLTexture(e,t=!1,i=3,r=0,s=0){const a=new s1(e,this._gl),l=new Qr(this,Xt.Unknown,!0);return l._hardwareTexture=a,l.baseWidth=r,l.baseHeight=s,l.width=r,l.height=s,l.isReady=!0,l.useMipMaps=t,this.updateTextureSamplingMode(i,l),l}_uploadImageToTexture(e,t,i=0,r=0){const s=this._gl,a=this._getWebGLTextureType(e.type),l=this._getInternalFormat(e.format),o=this._getRGBABufferInternalSizedFormat(e.type,l),c=e.isCube?s.TEXTURE_CUBE_MAP:s.TEXTURE_2D;this._bindTextureDirectly(c,e,!0),this._unpackFlipY(e.invertY);let u=s.TEXTURE_2D;e.isCube&&(u=s.TEXTURE_CUBE_MAP_POSITIVE_X+i),s.texImage2D(u,r,o,l,a,t),this._bindTextureDirectly(c,null,!0)}updateTextureComparisonFunction(e,t){if(this.webGLVersion===1){ee.Error("WebGL 1 does not support texture comparison.");return}const i=this._gl;e.isCube?(this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,e,!0),t===0?(i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_COMPARE_FUNC,515),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_COMPARE_MODE,i.NONE)):(i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_COMPARE_FUNC,t),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null)):(this._bindTextureDirectly(this._gl.TEXTURE_2D,e,!0),t===0?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_COMPARE_FUNC,515),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_COMPARE_MODE,i.NONE)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_COMPARE_FUNC,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_2D,null)),e._comparisonFunction=t}createInstancesBuffer(e){const t=this._gl.createBuffer();if(!t)throw new Error("Unable to create instance buffer");const i=new nu(t);return i.capacity=e,this.bindArrayBuffer(i),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.DYNAMIC_DRAW),i.references=1,i}deleteInstancesBuffer(e){this._gl.deleteBuffer(e)}_clientWaitAsync(e,t=0,i=10){const r=this._gl;return new Promise((s,a)=>{const l=()=>{const o=r.clientWaitSync(e,t,0);if(o==r.WAIT_FAILED){a();return}if(o==r.TIMEOUT_EXPIRED){setTimeout(l,i);return}s()};l()})}_readPixelsAsync(e,t,i,r,s,a,l){if(this._webGLVersion<2)throw new Error("_readPixelsAsync only work on WebGL2+");const o=this._gl,c=o.createBuffer();o.bindBuffer(o.PIXEL_PACK_BUFFER,c),o.bufferData(o.PIXEL_PACK_BUFFER,l.byteLength,o.STREAM_READ),o.readPixels(e,t,i,r,s,a,0),o.bindBuffer(o.PIXEL_PACK_BUFFER,null);const u=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);return u?(o.flush(),this._clientWaitAsync(u,0,10).then(()=>(o.deleteSync(u),o.bindBuffer(o.PIXEL_PACK_BUFFER,c),o.getBufferSubData(o.PIXEL_PACK_BUFFER,0,l),o.bindBuffer(o.PIXEL_PACK_BUFFER,null),o.deleteBuffer(c),l))):null}dispose(){for(this.hideLoadingUI(),this.onNewSceneAddedObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(this._rescalePostProcess&&this._rescalePostProcess.dispose();this.scenes.length;)this.scenes[0].dispose();for(;this._virtualScenes.length;)this._virtualScenes[0].dispose();He.Instances.length===1&&Z.audioEngine&&(Z.audioEngine.dispose(),Z.audioEngine=null);const e=this.getHostWindow();e&&typeof e.removeEventListener=="function"&&(e.removeEventListener("blur",this._onBlur),e.removeEventListener("focus",this._onFocus)),this._renderingCanvas&&(this._renderingCanvas.removeEventListener("focus",this._onCanvasFocus),this._renderingCanvas.removeEventListener("blur",this._onCanvasBlur),this._renderingCanvas.removeEventListener("pointerout",this._onCanvasPointerOut),this._renderingCanvas.removeEventListener("contextmenu",this._onCanvasContextMenu)),Vc()&&(document.removeEventListener("fullscreenchange",this._onFullscreenChange),document.removeEventListener("mozfullscreenchange",this._onFullscreenChange),document.removeEventListener("webkitfullscreenchange",this._onFullscreenChange),document.removeEventListener("msfullscreenchange",this._onFullscreenChange),document.removeEventListener("pointerlockchange",this._onPointerLockChange),document.removeEventListener("mspointerlockchange",this._onPointerLockChange),document.removeEventListener("mozpointerlockchange",this._onPointerLockChange),document.removeEventListener("webkitpointerlockchange",this._onPointerLockChange)),super.dispose();const t=He.Instances.indexOf(this);t>=0&&He.Instances.splice(t,1),Z.Instances.length||He.OnEnginesDisposedObservable.notifyObservers(this),this.onResizeObservable.clear(),this.onCanvasBlurObservable.clear(),this.onCanvasFocusObservable.clear(),this.onCanvasPointerOutObservable.clear(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear()}_disableTouchAction(){!this._renderingCanvas||!this._renderingCanvas.setAttribute||(this._renderingCanvas.setAttribute("touch-action","none"),this._renderingCanvas.style.touchAction="none",this._renderingCanvas.style.webkitTapHighlightColor="transparent")}displayLoadingUI(){if(!Ui())return;const e=this.loadingScreen;e&&e.displayLoadingUI()}hideLoadingUI(){if(!Ui())return;const e=this._loadingScreen;e&&e.hideLoadingUI()}get loadingScreen(){return!this._loadingScreen&&this._renderingCanvas&&(this._loadingScreen=Z.DefaultLoadingScreenFactory(this._renderingCanvas)),this._loadingScreen}set loadingScreen(e){this._loadingScreen=e}set loadingUIText(e){this.loadingScreen.loadingUIText=e}set loadingUIBackgroundColor(e){this.loadingScreen.loadingUIBackgroundColor=e}createVideoElement(e){return document.createElement("video")}static _RequestPointerlock(e){if(e.requestPointerLock){const t=e.requestPointerLock();t instanceof Promise?t.then(()=>{e.focus()}).catch(()=>{}):e.focus()}}static _ExitPointerlock(){document.exitPointerLock&&document.exitPointerLock()}static _RequestFullscreen(e){const t=e.requestFullscreen||e.webkitRequestFullscreen;t&&t.call(e)}static _ExitFullscreen(){const e=document;document.exitFullscreen?document.exitFullscreen():e.webkitCancelFullScreen&&e.webkitCancelFullScreen()}getFontOffset(e){const t=document.createElement("span");t.innerHTML="Hg",t.setAttribute("style",`font: ${e} !important`);const i=document.createElement("div");i.style.display="inline-block",i.style.width="1px",i.style.height="0px",i.style.verticalAlign="bottom";const r=document.createElement("div");r.style.whiteSpace="nowrap",r.appendChild(t),r.appendChild(i),document.body.appendChild(r);let s=0,a=0;try{a=i.getBoundingClientRect().top-t.getBoundingClientRect().top,i.style.verticalAlign="baseline",s=i.getBoundingClientRect().top-t.getBoundingClientRect().top}finally{document.body.removeChild(r)}return{ascent:s,height:a,descent:a-s}}}Z.ALPHA_DISABLE=0;Z.ALPHA_ADD=1;Z.ALPHA_COMBINE=2;Z.ALPHA_SUBTRACT=3;Z.ALPHA_MULTIPLY=4;Z.ALPHA_MAXIMIZED=5;Z.ALPHA_ONEONE=6;Z.ALPHA_PREMULTIPLIED=7;Z.ALPHA_PREMULTIPLIED_PORTERDUFF=8;Z.ALPHA_INTERPOLATE=9;Z.ALPHA_SCREENMODE=10;Z.DELAYLOADSTATE_NONE=0;Z.DELAYLOADSTATE_LOADED=1;Z.DELAYLOADSTATE_LOADING=2;Z.DELAYLOADSTATE_NOTLOADED=4;Z.NEVER=512;Z.ALWAYS=519;Z.LESS=513;Z.EQUAL=514;Z.LEQUAL=515;Z.GREATER=516;Z.GEQUAL=518;Z.NOTEQUAL=517;Z.KEEP=7680;Z.REPLACE=7681;Z.INCR=7682;Z.DECR=7683;Z.INVERT=5386;Z.INCR_WRAP=34055;Z.DECR_WRAP=34056;Z.TEXTURE_CLAMP_ADDRESSMODE=0;Z.TEXTURE_WRAP_ADDRESSMODE=1;Z.TEXTURE_MIRROR_ADDRESSMODE=2;Z.TEXTUREFORMAT_ALPHA=0;Z.TEXTUREFORMAT_LUMINANCE=1;Z.TEXTUREFORMAT_LUMINANCE_ALPHA=2;Z.TEXTUREFORMAT_RGB=4;Z.TEXTUREFORMAT_RGBA=5;Z.TEXTUREFORMAT_RED=6;Z.TEXTUREFORMAT_R=6;Z.TEXTUREFORMAT_RG=7;Z.TEXTUREFORMAT_RED_INTEGER=8;Z.TEXTUREFORMAT_R_INTEGER=8;Z.TEXTUREFORMAT_RG_INTEGER=9;Z.TEXTUREFORMAT_RGB_INTEGER=10;Z.TEXTUREFORMAT_RGBA_INTEGER=11;Z.TEXTURETYPE_UNSIGNED_BYTE=0;Z.TEXTURETYPE_UNSIGNED_INT=0;Z.TEXTURETYPE_FLOAT=1;Z.TEXTURETYPE_HALF_FLOAT=2;Z.TEXTURETYPE_BYTE=3;Z.TEXTURETYPE_SHORT=4;Z.TEXTURETYPE_UNSIGNED_SHORT=5;Z.TEXTURETYPE_INT=6;Z.TEXTURETYPE_UNSIGNED_INTEGER=7;Z.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8;Z.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9;Z.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10;Z.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11;Z.TEXTURETYPE_UNSIGNED_INT_24_8=12;Z.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13;Z.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14;Z.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15;Z.TEXTURE_NEAREST_SAMPLINGMODE=1;Z.TEXTURE_BILINEAR_SAMPLINGMODE=2;Z.TEXTURE_TRILINEAR_SAMPLINGMODE=3;Z.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8;Z.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11;Z.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3;Z.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4;Z.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5;Z.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6;Z.TEXTURE_NEAREST_LINEAR=7;Z.TEXTURE_NEAREST_NEAREST=1;Z.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9;Z.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10;Z.TEXTURE_LINEAR_LINEAR=2;Z.TEXTURE_LINEAR_NEAREST=12;Z.TEXTURE_EXPLICIT_MODE=0;Z.TEXTURE_SPHERICAL_MODE=1;Z.TEXTURE_PLANAR_MODE=2;Z.TEXTURE_CUBIC_MODE=3;Z.TEXTURE_PROJECTION_MODE=4;Z.TEXTURE_SKYBOX_MODE=5;Z.TEXTURE_INVCUBIC_MODE=6;Z.TEXTURE_EQUIRECTANGULAR_MODE=7;Z.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8;Z.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9;Z.SCALEMODE_FLOOR=1;Z.SCALEMODE_NEAREST=2;Z.SCALEMODE_CEILING=3;Z._RescalePostProcessFactory=null;Z._RenderPassIdCounter=0;class Ei{static get ForceFullSceneLoadingForIncremental(){return Ei._ForceFullSceneLoadingForIncremental}static set ForceFullSceneLoadingForIncremental(e){Ei._ForceFullSceneLoadingForIncremental=e}static get ShowLoadingScreen(){return Ei._ShowLoadingScreen}static set ShowLoadingScreen(e){Ei._ShowLoadingScreen=e}static get loggingLevel(){return Ei._LoggingLevel}static set loggingLevel(e){Ei._LoggingLevel=e}static get CleanBoneMatrixWeights(){return Ei._CleanBoneMatrixWeights}static set CleanBoneMatrixWeights(e){Ei._CleanBoneMatrixWeights=e}}Ei._ForceFullSceneLoadingForIncremental=!1;Ei._ShowLoadingScreen=!0;Ei._CleanBoneMatrixWeights=!1;Ei._LoggingLevel=0;var ha;(function(n){n[n.Clean=0]="Clean",n[n.Stop=1]="Stop",n[n.Sync=2]="Sync",n[n.NoSync=3]="NoSync"})(ha||(ha={}));class ot{static get ForceFullSceneLoadingForIncremental(){return Ei.ForceFullSceneLoadingForIncremental}static set ForceFullSceneLoadingForIncremental(e){Ei.ForceFullSceneLoadingForIncremental=e}static get ShowLoadingScreen(){return Ei.ShowLoadingScreen}static set ShowLoadingScreen(e){Ei.ShowLoadingScreen=e}static get loggingLevel(){return Ei.loggingLevel}static set loggingLevel(e){Ei.loggingLevel=e}static get CleanBoneMatrixWeights(){return Ei.CleanBoneMatrixWeights}static set CleanBoneMatrixWeights(e){Ei.CleanBoneMatrixWeights=e}static GetDefaultPlugin(){return ot._RegisteredPlugins[".babylon"]}static _GetPluginForExtension(e){const t=ot._RegisteredPlugins[e];return t||(ee.Warn("Unable to find a plugin to load "+e+" files. Trying to use .babylon default plugin. To load from a specific filetype (eg. gltf) see: https://doc.babylonjs.com/features/featuresDeepDive/importers/loadingFileTypes"),ot.GetDefaultPlugin())}static _GetPluginForDirectLoad(e){for(const t in ot._RegisteredPlugins){const i=ot._RegisteredPlugins[t].plugin;if(i.canDirectLoad&&i.canDirectLoad(e))return ot._RegisteredPlugins[t]}return ot.GetDefaultPlugin()}static _GetPluginForFilename(e){const t=e.indexOf("?");t!==-1&&(e=e.substring(0,t));const i=e.lastIndexOf("."),r=e.substring(i,e.length).toLowerCase();return ot._GetPluginForExtension(r)}static _GetDirectLoad(e){return e.substr(0,5)==="data:"?e.substr(5):null}static _FormatErrorMessage(e,t,i){let s="Unable to load from "+(e.rawData?"binary data":e.url);return t?s+=`: ${t}`:i&&(s+=`: ${i}`),s}static _LoadData(e,t,i,r,s,a,l,o){const c=ot._GetDirectLoad(e.url);if(e.rawData&&!l)throw"When using ArrayBufferView to load data the file extension must be provided.";const u=l?ot._GetPluginForExtension(l):c?ot._GetPluginForDirectLoad(e.url):ot._GetPluginForFilename(e.url);if(e.rawData&&!u.isBinary)throw"Loading from ArrayBufferView can not be used with plugins that don't support binary loading.";let h;if(u.plugin.createPlugin!==void 0?h=u.plugin.createPlugin():h=u.plugin,!h)throw"The loader plugin corresponding to the file type you are trying to load has not been found. If using es6, please import the plugin you wish to use before.";if(ot.OnPluginActivatedObservable.notifyObservers(h),c&&(h.canDirectLoad&&h.canDirectLoad(e.url)||!_m(e.url))){if(h.directLoad){const y=h.directLoad(t,c);y.then?y.then(T=>{i(h,T)}).catch(T=>{s("Error in directLoad of _loadData: "+T,T)}):i(h,y)}else i(h,c);return h}const d=u.isBinary,f=(y,T)=>{if(t.isDisposed){s("Scene has been disposed");return}i(h,y,T)};let _=null,p=!1;const v=h.onDisposeObservable;v&&v.add(()=>{p=!0,_&&(_.abort(),_=null),a()});const E=()=>{if(p)return;const y=(T,b)=>{s(T==null?void 0:T.statusText,b)};if(!h.loadFile&&e.rawData)throw"Plugin does not support loading ArrayBufferView.";_=h.loadFile?h.loadFile(t,e.rawData||e.file||e.url,e.rootUrl,f,r,d,y,o):t._loadFile(e.file||e.url,f,r,!0,d,y)},g=t.getEngine();let m=g.enableOfflineSupport;if(m){let y=!1;for(const T of t.disableOfflineSupportExceptionRules)if(T.test(e.url)){y=!0;break}m=!y}return m&&Z.OfflineProviderFactory?t.offlineProvider=Z.OfflineProviderFactory(e.url,E,g.disableManifestCheck):E(),h}static _GetFileInfo(e,t){let i,r,s=null,a=null;if(!t)i=e,r=X.GetFilename(e),e=X.GetFolderPath(e);else if(t.name){const l=t;i=`file:${l.name}`,r=l.name,s=l}else if(ArrayBuffer.isView(t))i="",r=$d(),a=t;else if(typeof t=="string"&&t.startsWith("data:"))i=t,r="";else{const l=t;if(l.substr(0,1)==="/")return X.Error("Wrong sceneFilename parameter"),null;i=e+l,r=l}return{url:i,rootUrl:e,name:r,file:s,rawData:a}}static GetPluginForExtension(e){return ot._GetPluginForExtension(e).plugin}static IsPluginForExtensionAvailable(e){return!!ot._RegisteredPlugins[e]}static RegisterPlugin(e){if(typeof e.extensions=="string"){const t=e.extensions;ot._RegisteredPlugins[t.toLowerCase()]={plugin:e,isBinary:!1}}else{const t=e.extensions;Object.keys(t).forEach(i=>{ot._RegisteredPlugins[i.toLowerCase()]={plugin:e,isBinary:t[i].isBinary}})}}static ImportMesh(e,t,i="",r=He.LastCreatedScene,s=null,a=null,l=null,o=null,c=""){if(!r)return ee.Error("No scene available to import mesh to"),null;const u=ot._GetFileInfo(t,i);if(!u)return null;const h={};r.addPendingData(h);const d=()=>{r.removePendingData(h)},f=(v,E)=>{const g=ot._FormatErrorMessage(u,v,E);l?l(r,g,new ws(g,vo.SceneLoaderError,E)):ee.Error(g),d()},_=a?v=>{try{a(v)}catch(E){f("Error in onProgress callback: "+E,E)}}:void 0,p=(v,E,g,m,y,T,b,C)=>{if(r.importedMeshesFiles.push(u.url),s)try{s(v,E,g,m,y,T,b,C)}catch(M){f("Error in onSuccess callback: "+M,M)}r.removePendingData(h)};return ot._LoadData(u,r,(v,E,g)=>{if(v.rewriteRootURL&&(u.rootUrl=v.rewriteRootURL(u.rootUrl,g)),v.importMesh){const m=v,y=[],T=[],b=[];if(!m.importMesh(e,r,E,u.rootUrl,y,T,b,f))return;r.loadingPluginName=v.name,p(y,T,b,[],[],[],[],[])}else v.importMeshAsync(e,r,E,u.rootUrl,_,u.name).then(y=>{r.loadingPluginName=v.name,p(y.meshes,y.particleSystems,y.skeletons,y.animationGroups,y.transformNodes,y.geometries,y.lights,y.spriteManagers)}).catch(y=>{f(y.message,y)})},_,f,d,o,c)}static ImportMeshAsync(e,t,i="",r=He.LastCreatedScene,s=null,a=null,l=""){return new Promise((o,c)=>{ot.ImportMesh(e,t,i,r,(u,h,d,f,_,p,v,E)=>{o({meshes:u,particleSystems:h,skeletons:d,animationGroups:f,transformNodes:_,geometries:p,lights:v,spriteManagers:E})},s,(u,h,d)=>{c(d||new Error(h))},a,l)})}static Load(e,t="",i=He.LastCreatedEngine,r=null,s=null,a=null,l=null,o=""){return i?ot.Append(e,t,new Pt(i),r,s,a,l,o):(X.Error("No engine available"),null)}static LoadAsync(e,t="",i=He.LastCreatedEngine,r=null,s=null,a=""){return new Promise((l,o)=>{ot.Load(e,t,i,c=>{l(c)},r,(c,u,h)=>{o(h||new Error(u))},s,a)})}static Append(e,t="",i=He.LastCreatedScene,r=null,s=null,a=null,l=null,o=""){if(!i)return ee.Error("No scene available to append to"),null;const c=ot._GetFileInfo(e,t);if(!c)return null;const u={};i.addPendingData(u);const h=()=>{i.removePendingData(u)};ot.ShowLoadingScreen&&!this._ShowingLoadingScreen&&(this._ShowingLoadingScreen=!0,i.getEngine().displayLoadingUI(),i.executeWhenReady(()=>{i.getEngine().hideLoadingUI(),this._ShowingLoadingScreen=!1}));const d=(p,v)=>{const E=ot._FormatErrorMessage(c,p,v);a?a(i,E,new ws(E,vo.SceneLoaderError,v)):ee.Error(E),h()},f=s?p=>{try{s(p)}catch(v){d("Error in onProgress callback",v)}}:void 0,_=()=>{if(r)try{r(i)}catch(p){d("Error in onSuccess callback",p)}i.removePendingData(u)};return ot._LoadData(c,i,(p,v)=>{if(p.load){if(!p.load(i,v,c.rootUrl,d))return;i.loadingPluginName=p.name,_()}else p.loadAsync(i,v,c.rootUrl,f,c.name).then(()=>{i.loadingPluginName=p.name,_()}).catch(g=>{d(g.message,g)})},f,d,h,l,o)}static AppendAsync(e,t="",i=He.LastCreatedScene,r=null,s=null,a=""){return new Promise((l,o)=>{ot.Append(e,t,i,c=>{l(c)},r,(c,u,h)=>{o(h||new Error(u))},s,a)})}static LoadAssetContainer(e,t="",i=He.LastCreatedScene,r=null,s=null,a=null,l=null,o=""){if(!i)return ee.Error("No scene available to load asset container to"),null;const c=ot._GetFileInfo(e,t);if(!c)return null;const u={};i.addPendingData(u);const h=()=>{i.removePendingData(u)},d=(p,v)=>{const E=ot._FormatErrorMessage(c,p,v);a?a(i,E,new ws(E,vo.SceneLoaderError,v)):ee.Error(E),h()},f=s?p=>{try{s(p)}catch(v){d("Error in onProgress callback",v)}}:void 0,_=p=>{if(r)try{r(p)}catch(v){d("Error in onSuccess callback",v)}i.removePendingData(u)};return ot._LoadData(c,i,(p,v)=>{if(p.loadAssetContainer){const g=p.loadAssetContainer(i,v,c.rootUrl,d);if(!g)return;g.populateRootNodes(),i.loadingPluginName=p.name,_(g)}else p.loadAssetContainerAsync?p.loadAssetContainerAsync(i,v,c.rootUrl,f,c.name).then(g=>{g.populateRootNodes(),i.loadingPluginName=p.name,_(g)}).catch(g=>{d(g.message,g)}):d("LoadAssetContainer is not supported by this plugin. Plugin did not provide a loadAssetContainer or loadAssetContainerAsync method.")},f,d,h,l,o)}static LoadAssetContainerAsync(e,t="",i=He.LastCreatedScene,r=null,s=null){return new Promise((a,l)=>{ot.LoadAssetContainer(e,t,i,o=>{a(o)},r,(o,c,u)=>{l(u||new Error(c))},s)})}static ImportAnimations(e,t="",i=He.LastCreatedScene,r=!0,s=ha.Clean,a=null,l=null,o=null,c=null,u=null){if(!i){ee.Error("No scene available to load animations to");return}if(r){for(const _ of i.animatables)_.reset();i.stopAllAnimations(),i.animationGroups.slice().forEach(_=>{_.dispose()}),i.getNodes().forEach(_=>{_.animations&&(_.animations=[])})}else switch(s){case ha.Clean:i.animationGroups.slice().forEach(f=>{f.dispose()});break;case ha.Stop:i.animationGroups.forEach(f=>{f.stop()});break;case ha.Sync:i.animationGroups.forEach(f=>{f.reset(),f.restart()});break;case ha.NoSync:break;default:ee.Error("Unknown animation group loading mode value '"+s+"'");return}const h=i.animatables.length,d=f=>{f.mergeAnimationsTo(i,i.animatables.slice(h),a),f.dispose(),i.onAnimationFileImportedObservable.notifyObservers(i),l&&l(i)};this.LoadAssetContainer(e,t,i,d,o,c,u)}static ImportAnimationsAsync(e,t="",i=He.LastCreatedScene,r=!0,s=ha.Clean,a=null,l=null,o=null,c=null,u=null){return new Promise((h,d)=>{ot.ImportAnimations(e,t,i,r,s,a,f=>{h(f)},o,(f,_,p)=>{d(p||new Error(_))},u)})}}ot.NO_LOGGING=0;ot.MINIMAL_LOGGING=1;ot.SUMMARY_LOGGING=2;ot.DETAILED_LOGGING=3;ot.OnPluginActivatedObservable=new Y;ot._RegisteredPlugins={};ot._ShowingLoadingScreen=!1;function Pp(n,e,t){try{const i=n.next();i.done?e(i):i.value?i.value.then(()=>{i.value=void 0,e(i)},t):e(i)}catch(i){t(i)}}function GN(n=25){let e;return(t,i,r)=>{const s=performance.now();e===void 0||s-e>n?(e=s,setTimeout(()=>{Pp(t,i,r)},0)):Pp(t,i,r)}}function m1(n,e,t,i,r){const s=()=>{let a;const l=o=>{o.done?t(o.value):a===void 0?a=!0:s()};do a=void 0,e(n,l,i),a===void 0&&(a=!1);while(a)};s()}function gm(n,e){let t;return m1(n,Pp,i=>t=i,i=>{throw i}),t}function WN(n,e,t){return new Promise((i,r)=>{m1(n,e,i,r)})}function HN(n,e){return(...t)=>gm(n(...t))}class jN{constructor(){this._doNotSerialize=!1,this._isDisposed=!1,this._sceneRootNodesIndex=-1,this._isEnabled=!0,this._isParentEnabled=!0,this._isReady=!0,this._onEnabledStateChangedObservable=new Y,this._onClonedObservable=new Y}}let Mi=class wp{static AddNodeConstructor(e,t){this._NodeConstructors[e]=t}static Construct(e,t,i,r){const s=this._NodeConstructors[e];return s?s(t,i,r):null}set accessibilityTag(e){this._accessibilityTag=e,this.onAccessibilityTagChangedObservable.notifyObservers(e)}get accessibilityTag(){return this._accessibilityTag}get doNotSerialize(){return this._nodeDataStorage._doNotSerialize?!0:this._parentNode?this._parentNode.doNotSerialize:!1}set doNotSerialize(e){this._nodeDataStorage._doNotSerialize=e}isDisposed(){return this._nodeDataStorage._isDisposed}set parent(e){if(this._parentNode===e)return;const t=this._parentNode;if(this._parentNode&&this._parentNode._children!==void 0&&this._parentNode._children!==null){const i=this._parentNode._children.indexOf(this);i!==-1&&this._parentNode._children.splice(i,1),!e&&!this._nodeDataStorage._isDisposed&&this._addToSceneRootNodes()}this._parentNode=e,this._parentNode&&((this._parentNode._children===void 0||this._parentNode._children===null)&&(this._parentNode._children=new Array),this._parentNode._children.push(this),t||this._removeFromSceneRootNodes()),this._syncParentEnabledState()}get parent(){return this._parentNode}_serializeAsParent(e){e.parentId=this.uniqueId}_addToSceneRootNodes(){this._nodeDataStorage._sceneRootNodesIndex===-1&&(this._nodeDataStorage._sceneRootNodesIndex=this._scene.rootNodes.length,this._scene.rootNodes.push(this))}_removeFromSceneRootNodes(){if(this._nodeDataStorage._sceneRootNodesIndex!==-1){const e=this._scene.rootNodes,t=e.length-1;e[this._nodeDataStorage._sceneRootNodesIndex]=e[t],e[this._nodeDataStorage._sceneRootNodesIndex]._nodeDataStorage._sceneRootNodesIndex=this._nodeDataStorage._sceneRootNodesIndex,this._scene.rootNodes.pop(),this._nodeDataStorage._sceneRootNodesIndex=-1}}get animationPropertiesOverride(){return this._animationPropertiesOverride?this._animationPropertiesOverride:this._scene.animationPropertiesOverride}set animationPropertiesOverride(e){this._animationPropertiesOverride=e}getClassName(){return"Node"}set onDispose(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)}get onEnabledStateChangedObservable(){return this._nodeDataStorage._onEnabledStateChangedObservable}get onClonedObservable(){return this._nodeDataStorage._onClonedObservable}constructor(e,t=null){this._isDirty=!1,this._nodeDataStorage=new jN,this.state="",this.metadata=null,this.reservedDataStore=null,this._accessibilityTag=null,this.onAccessibilityTagChangedObservable=new Y,this._parentContainer=null,this.animations=[],this._ranges={},this.onReady=null,this._currentRenderId=-1,this._parentUpdateId=-1,this._childUpdateId=-1,this._waitingParentId=null,this._waitingParentInstanceIndex=null,this._waitingParsedUniqueId=null,this._cache={},this._parentNode=null,this._children=null,this._worldMatrix=z.Identity(),this._worldMatrixDeterminant=0,this._worldMatrixDeterminantIsDirty=!0,this._animationPropertiesOverride=null,this._isNode=!0,this.onDisposeObservable=new Y,this._onDisposeObserver=null,this._behaviors=new Array,this.name=e,this.id=e,this._scene=t||He.LastCreatedScene,this.uniqueId=this._scene.getUniqueId(),this._initCache()}getScene(){return this._scene}getEngine(){return this._scene.getEngine()}addBehavior(e,t=!1){return this._behaviors.indexOf(e)!==-1?this:(e.init(),this._scene.isLoading&&!t?this._scene.onDataLoadedObservable.addOnce(()=>{e.attach(this)}):e.attach(this),this._behaviors.push(e),this)}removeBehavior(e){const t=this._behaviors.indexOf(e);return t===-1?this:(this._behaviors[t].detach(),this._behaviors.splice(t,1),this)}get behaviors(){return this._behaviors}getBehaviorByName(e){for(const t of this._behaviors)if(t.name===e)return t;return null}getWorldMatrix(){return this._currentRenderId!==this._scene.getRenderId()&&this.computeWorldMatrix(),this._worldMatrix}_getWorldMatrixDeterminant(){return this._worldMatrixDeterminantIsDirty&&(this._worldMatrixDeterminantIsDirty=!1,this._worldMatrixDeterminant=this._worldMatrix.determinant()),this._worldMatrixDeterminant}get worldMatrixFromCache(){return this._worldMatrix}_initCache(){this._cache={},this._cache.parent=void 0}updateCache(e){!e&&this.isSynchronized()||(this._cache.parent=this.parent,this._updateCache())}_getActionManagerForTrigger(e,t=!0){return this.parent?this.parent._getActionManagerForTrigger(e,!1):null}_updateCache(e){}_isSynchronized(){return!0}_markSyncedWithParent(){this._parentNode&&(this._parentUpdateId=this._parentNode._childUpdateId)}isSynchronizedWithParent(){return this._parentNode?this._parentNode._isDirty||this._parentUpdateId!==this._parentNode._childUpdateId?!1:this._parentNode.isSynchronized():!0}isSynchronized(){return this._cache.parent!==this._parentNode?(this._cache.parent=this._parentNode,!1):this._parentNode&&!this.isSynchronizedWithParent()?!1:this._isSynchronized()}isReady(e=!1){return this._nodeDataStorage._isReady}markAsDirty(e){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this}isEnabled(e=!0){return e===!1?this._nodeDataStorage._isEnabled:this._nodeDataStorage._isEnabled?this._nodeDataStorage._isParentEnabled:!1}_syncParentEnabledState(){this._nodeDataStorage._isParentEnabled=this._parentNode?this._parentNode.isEnabled():!0,this._children&&this._children.forEach(e=>{e._syncParentEnabledState()})}setEnabled(e){this._nodeDataStorage._isEnabled!==e&&(this._nodeDataStorage._isEnabled=e,this._syncParentEnabledState(),this._nodeDataStorage._onEnabledStateChangedObservable.notifyObservers(e))}isDescendantOf(e){return this.parent?this.parent===e?!0:this.parent.isDescendantOf(e):!1}_getDescendants(e,t=!1,i){if(this._children)for(let r=0;r<this._children.length;r++){const s=this._children[r];(!i||i(s))&&e.push(s),t||s._getDescendants(e,!1,i)}}getDescendants(e,t){const i=[];return this._getDescendants(i,e,t),i}getChildMeshes(e,t){const i=[];return this._getDescendants(i,e,r=>(!t||t(r))&&r.cullingStrategy!==void 0),i}getChildren(e,t=!0){return this.getDescendants(t,e)}_setReady(e){if(e!==this._nodeDataStorage._isReady){if(!e){this._nodeDataStorage._isReady=!1;return}this.onReady&&this.onReady(this),this._nodeDataStorage._isReady=!0}}getAnimationByName(e){for(let t=0;t<this.animations.length;t++){const i=this.animations[t];if(i.name===e)return i}return null}createAnimationRange(e,t,i){if(!this._ranges[e]){this._ranges[e]=wp._AnimationRangeFactory(e,t,i);for(let r=0,s=this.animations.length;r<s;r++)this.animations[r]&&this.animations[r].createRange(e,t,i)}}deleteAnimationRange(e,t=!0){for(let i=0,r=this.animations.length;i<r;i++)this.animations[i]&&this.animations[i].deleteRange(e,t);this._ranges[e]=null}getAnimationRange(e){return this._ranges[e]||null}clone(e,t,i){const r=Fe.Clone(()=>new wp(e,this.getScene()),this);if(t&&(r.parent=t),!i){const s=this.getDescendants(!0);for(let a=0;a<s.length;a++){const l=s[a];l.clone(e+"."+l.name,r)}}return r}getAnimationRanges(){const e=[];let t;for(t in this._ranges)e.push(this._ranges[t]);return e}beginAnimation(e,t,i,r){const s=this.getAnimationRange(e);return s?this._scene.beginAnimation(this,s.from,s.to,t,i,r):null}serializeAnimationRanges(){const e=[];for(const t in this._ranges){const i=this._ranges[t];if(!i)continue;const r={};r.name=t,r.from=i.from,r.to=i.to,e.push(r)}return e}computeWorldMatrix(e){return this._worldMatrix||(this._worldMatrix=z.Identity()),this._worldMatrix}dispose(e,t=!1){if(this._nodeDataStorage._isDisposed=!0,!e){const i=this.getDescendants(!0);for(const r of i)r.dispose(e,t)}this.parent?this.parent=null:this._removeFromSceneRootNodes(),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onEnabledStateChangedObservable.clear(),this.onClonedObservable.clear();for(const i of this._behaviors)i.detach();this._behaviors.length=0,this.metadata=null}static ParseAnimationRanges(e,t,i){if(t.ranges)for(let r=0;r<t.ranges.length;r++){const s=t.ranges[r];e.createAnimationRange(s.name,s.from,s.to)}}getHierarchyBoundingVectors(e=!0,t=null){this.getScene().incrementRenderId(),this.computeWorldMatrix(!0);let i,r;const s=this;if(s.getBoundingInfo&&s.subMeshes){const a=s.getBoundingInfo();i=a.boundingBox.minimumWorld.clone(),r=a.boundingBox.maximumWorld.clone()}else i=new A(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),r=new A(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);if(e){const a=this.getDescendants(!1);for(const l of a){const o=l;if(o.computeWorldMatrix(!0),t&&!t(o)||!o.getBoundingInfo||o.getTotalVertices()===0)continue;const u=o.getBoundingInfo().boundingBox,h=u.minimumWorld,d=u.maximumWorld;A.CheckExtends(h,i,r),A.CheckExtends(d,i,r)}}return{min:i,max:r}}};Mi._AnimationRangeFactory=(n,e,t)=>{throw ke("AnimationRange")};Mi._NodeConstructors={};R([I()],Mi.prototype,"name",void 0);R([I()],Mi.prototype,"id",void 0);R([I()],Mi.prototype,"uniqueId",void 0);R([I()],Mi.prototype,"state",void 0);R([I()],Mi.prototype,"metadata",void 0);class Ms{constructor(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r}toGlobal(e,t){return new Ms(this.x*e,this.y*t,this.width*e,this.height*t)}toGlobalToRef(e,t,i){return i.x=this.x*e,i.y=this.y*t,i.width=this.width*e,i.height=this.height*t,this}clone(){return new Ms(this.x,this.y,this.width,this.height)}}class Ie extends Mi{get position(){return this._position}set position(e){this._position=e}set upVector(e){this._upVector=e}get upVector(){return this._upVector}get screenArea(){let e=0,t=0;if(this.mode===Ie.PERSPECTIVE_CAMERA)this.fovMode===Ie.FOVMODE_VERTICAL_FIXED?(t=this.minZ*2*Math.tan(this.fov/2),e=this.getEngine().getAspectRatio(this)*t):(e=this.minZ*2*Math.tan(this.fov/2),t=e/this.getEngine().getAspectRatio(this));else{const i=this.getEngine().getRenderWidth()/2,r=this.getEngine().getRenderHeight()/2;e=(this.orthoRight??i)-(this.orthoLeft??-i),t=(this.orthoTop??r)-(this.orthoBottom??-r)}return e*t}set orthoLeft(e){this._orthoLeft=e;for(const t of this._rigCameras)t.orthoLeft=e}get orthoLeft(){return this._orthoLeft}set orthoRight(e){this._orthoRight=e;for(const t of this._rigCameras)t.orthoRight=e}get orthoRight(){return this._orthoRight}set orthoBottom(e){this._orthoBottom=e;for(const t of this._rigCameras)t.orthoBottom=e}get orthoBottom(){return this._orthoBottom}set orthoTop(e){this._orthoTop=e;for(const t of this._rigCameras)t.orthoTop=e}get orthoTop(){return this._orthoTop}set mode(e){this._mode=e;for(const t of this._rigCameras)t.mode=e}get mode(){return this._mode}get hasMoved(){return this._hasMoved}constructor(e,t,i,r=!0){super(e,i),this._position=A.Zero(),this._upVector=A.Up(),this.oblique=null,this._orthoLeft=null,this._orthoRight=null,this._orthoBottom=null,this._orthoTop=null,this.fov=.8,this.projectionPlaneTilt=0,this.minZ=1,this.maxZ=1e4,this.inertia=.9,this._mode=Ie.PERSPECTIVE_CAMERA,this.isIntermediate=!1,this.viewport=new Ms(0,0,1,1),this.layerMask=268435455,this.fovMode=Ie.FOVMODE_VERTICAL_FIXED,this.cameraRigMode=Ie.RIG_MODE_NONE,this.customRenderTargets=[],this.outputRenderTarget=null,this.onViewMatrixChangedObservable=new Y,this.onProjectionMatrixChangedObservable=new Y,this.onAfterCheckInputsObservable=new Y,this.onRestoreStateObservable=new Y,this.isRigCamera=!1,this._hasMoved=!1,this._rigCameras=new Array,this._skipRendering=!1,this._projectionMatrix=new z,this._postProcesses=new Array,this._activeMeshes=new or(256),this._globalPosition=A.Zero(),this._computedViewMatrix=z.Identity(),this._doNotComputeProjectionMatrix=!1,this._transformMatrix=z.Zero(),this._refreshFrustumPlanes=!0,this._absoluteRotation=ue.Identity(),this._isCamera=!0,this._isLeftCamera=!1,this._isRightCamera=!1,this.getScene().addCamera(this),r&&!this.getScene().activeCamera&&(this.getScene().activeCamera=this),this.position=t,this.renderPassId=this.getScene().getEngine().createRenderPassId(`Camera ${e}`)}storeState(){return this._stateStored=!0,this._storedFov=this.fov,this}_restoreStateValues(){return this._stateStored?(this.fov=this._storedFov,!0):!1}restoreState(){return this._restoreStateValues()?(this.onRestoreStateObservable.notifyObservers(this),!0):!1}getClassName(){return"Camera"}toString(e){let t="Name: "+this.name;if(t+=", type: "+this.getClassName(),this.animations)for(let i=0;i<this.animations.length;i++)t+=", animation[0]: "+this.animations[i].toString(e);return t}applyVerticalCorrection(){const e=this.absoluteRotation.toEulerAngles();this.projectionPlaneTilt=this._scene.useRightHandedSystem?-e.x:e.x}get globalPosition(){return this._globalPosition}getActiveMeshes(){return this._activeMeshes}isActiveMesh(e){return this._activeMeshes.indexOf(e)!==-1}isReady(e=!1){if(e){for(const t of this._postProcesses)if(t&&!t.isReady())return!1}return super.isReady(e)}_initCache(){super._initCache(),this._cache.position=new A(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.upVector=new A(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.mode=void 0,this._cache.minZ=void 0,this._cache.maxZ=void 0,this._cache.fov=void 0,this._cache.fovMode=void 0,this._cache.aspectRatio=void 0,this._cache.orthoLeft=void 0,this._cache.orthoRight=void 0,this._cache.orthoBottom=void 0,this._cache.orthoTop=void 0,this._cache.obliqueAngle=void 0,this._cache.obliqueLength=void 0,this._cache.obliqueOffset=void 0,this._cache.renderWidth=void 0,this._cache.renderHeight=void 0}_updateCache(e){e||super._updateCache(),this._cache.position.copyFrom(this.position),this._cache.upVector.copyFrom(this.upVector)}_isSynchronized(){return this._isSynchronizedViewMatrix()&&this._isSynchronizedProjectionMatrix()}_isSynchronizedViewMatrix(){return super._isSynchronized()?this._cache.position.equals(this.position)&&this._cache.upVector.equals(this.upVector)&&this.isSynchronizedWithParent():!1}_isSynchronizedProjectionMatrix(){let e=this._cache.mode===this.mode&&this._cache.minZ===this.minZ&&this._cache.maxZ===this.maxZ;if(!e)return!1;const t=this.getEngine();return this.mode===Ie.PERSPECTIVE_CAMERA?e=this._cache.fov===this.fov&&this._cache.fovMode===this.fovMode&&this._cache.aspectRatio===t.getAspectRatio(this)&&this._cache.projectionPlaneTilt===this.projectionPlaneTilt:(e=this._cache.orthoLeft===this.orthoLeft&&this._cache.orthoRight===this.orthoRight&&this._cache.orthoBottom===this.orthoBottom&&this._cache.orthoTop===this.orthoTop&&this._cache.renderWidth===t.getRenderWidth()&&this._cache.renderHeight===t.getRenderHeight(),this.oblique&&(e=e&&this._cache.obliqueAngle===this.oblique.angle&&this._cache.obliqueLength===this.oblique.length&&this._cache.obliqueOffset===this.oblique.offset)),e}attachControl(e,t){}detachControl(e){}update(){this._hasMoved=!1,this._checkInputs(),this.cameraRigMode!==Ie.RIG_MODE_NONE&&this._updateRigCameras(),this.getViewMatrix(),this.getProjectionMatrix()}_checkInputs(){this.onAfterCheckInputsObservable.notifyObservers(this)}get rigCameras(){return this._rigCameras}get rigPostProcess(){return this._rigPostProcess}_getFirstPostProcess(){for(let e=0;e<this._postProcesses.length;e++)if(this._postProcesses[e]!==null)return this._postProcesses[e];return null}_cascadePostProcessesToRigCams(){const e=this._getFirstPostProcess();e&&e.markTextureDirty();for(let t=0,i=this._rigCameras.length;t<i;t++){const r=this._rigCameras[t],s=r._rigPostProcess;s?(s.getEffectName()==="pass"&&(r.isIntermediate=this._postProcesses.length===0),r._postProcesses=this._postProcesses.slice(0).concat(s),s.markTextureDirty()):r._postProcesses=this._postProcesses.slice(0)}}attachPostProcess(e,t=null){return!e.isReusable()&&this._postProcesses.indexOf(e)>-1?(ee.Error("You're trying to reuse a post process not defined as reusable."),0):(t==null||t<0?this._postProcesses.push(e):this._postProcesses[t]===null?this._postProcesses[t]=e:this._postProcesses.splice(t,0,e),this._cascadePostProcessesToRigCams(),this._scene.prePassRenderer&&this._scene.prePassRenderer.markAsDirty(),this._postProcesses.indexOf(e))}detachPostProcess(e){const t=this._postProcesses.indexOf(e);t!==-1&&(this._postProcesses[t]=null),this._scene.prePassRenderer&&this._scene.prePassRenderer.markAsDirty(),this._cascadePostProcessesToRigCams()}getWorldMatrix(){return this._isSynchronizedViewMatrix()?this._worldMatrix:(this.getViewMatrix(),this._worldMatrix)}_getViewMatrix(){return z.Identity()}getViewMatrix(e){return!e&&this._isSynchronizedViewMatrix()?this._computedViewMatrix:(this._hasMoved=!0,this.updateCache(),this._computedViewMatrix=this._getViewMatrix(),this._currentRenderId=this.getScene().getRenderId(),this._childUpdateId++,this._refreshFrustumPlanes=!0,this._cameraRigParams&&this._cameraRigParams.vrPreViewMatrix&&this._computedViewMatrix.multiplyToRef(this._cameraRigParams.vrPreViewMatrix,this._computedViewMatrix),this.parent&&this.parent.onViewMatrixChangedObservable&&this.parent.onViewMatrixChangedObservable.notifyObservers(this.parent),this.onViewMatrixChangedObservable.notifyObservers(this),this._computedViewMatrix.invertToRef(this._worldMatrix),this._computedViewMatrix)}freezeProjectionMatrix(e){this._doNotComputeProjectionMatrix=!0,e!==void 0&&(this._projectionMatrix=e)}unfreezeProjectionMatrix(){this._doNotComputeProjectionMatrix=!1}getProjectionMatrix(e){var s,a,l;if(this._doNotComputeProjectionMatrix||!e&&this._isSynchronizedProjectionMatrix())return this._projectionMatrix;this._cache.mode=this.mode,this._cache.minZ=this.minZ,this._cache.maxZ=this.maxZ,this._refreshFrustumPlanes=!0;const t=this.getEngine(),i=this.getScene(),r=t.useReverseDepthBuffer;if(this.mode===Ie.PERSPECTIVE_CAMERA){this._cache.fov=this.fov,this._cache.fovMode=this.fovMode,this._cache.aspectRatio=t.getAspectRatio(this),this._cache.projectionPlaneTilt=this.projectionPlaneTilt,this.minZ<=0&&(this.minZ=.1);let o;i.useRightHandedSystem?o=z.PerspectiveFovRHToRef:o=z.PerspectiveFovLHToRef,o(this.fov,t.getAspectRatio(this),r?this.maxZ:this.minZ,r?this.minZ:this.maxZ,this._projectionMatrix,this.fovMode===Ie.FOVMODE_VERTICAL_FIXED,t.isNDCHalfZRange,this.projectionPlaneTilt,r)}else{const o=t.getRenderWidth()/2,c=t.getRenderHeight()/2;i.useRightHandedSystem?this.oblique?z.ObliqueOffCenterRHToRef(this.orthoLeft??-o,this.orthoRight??o,this.orthoBottom??-c,this.orthoTop??c,r?this.maxZ:this.minZ,r?this.minZ:this.maxZ,this.oblique.length,this.oblique.angle,this._computeObliqueDistance(this.oblique.offset),this._projectionMatrix,t.isNDCHalfZRange):z.OrthoOffCenterRHToRef(this.orthoLeft??-o,this.orthoRight??o,this.orthoBottom??-c,this.orthoTop??c,r?this.maxZ:this.minZ,r?this.minZ:this.maxZ,this._projectionMatrix,t.isNDCHalfZRange):this.oblique?z.ObliqueOffCenterLHToRef(this.orthoLeft??-o,this.orthoRight??o,this.orthoBottom??-c,this.orthoTop??c,r?this.maxZ:this.minZ,r?this.minZ:this.maxZ,this.oblique.length,this.oblique.angle,this._computeObliqueDistance(this.oblique.offset),this._projectionMatrix,t.isNDCHalfZRange):z.OrthoOffCenterLHToRef(this.orthoLeft??-o,this.orthoRight??o,this.orthoBottom??-c,this.orthoTop??c,r?this.maxZ:this.minZ,r?this.minZ:this.maxZ,this._projectionMatrix,t.isNDCHalfZRange),this._cache.orthoLeft=this.orthoLeft,this._cache.orthoRight=this.orthoRight,this._cache.orthoBottom=this.orthoBottom,this._cache.orthoTop=this.orthoTop,this._cache.obliqueAngle=(s=this.oblique)==null?void 0:s.angle,this._cache.obliqueLength=(a=this.oblique)==null?void 0:a.length,this._cache.obliqueOffset=(l=this.oblique)==null?void 0:l.offset,this._cache.renderWidth=t.getRenderWidth(),this._cache.renderHeight=t.getRenderHeight()}return this.onProjectionMatrixChangedObservable.notifyObservers(this),this._projectionMatrix}getTransformationMatrix(){return this._computedViewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),this._transformMatrix}_computeObliqueDistance(e){const t=this,i=this;return(t.radius||(i.target?A.Distance(this.position,i.target):this.position.length()))+e}_updateFrustumPlanes(){this._refreshFrustumPlanes&&(this.getTransformationMatrix(),this._frustumPlanes?un.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=un.GetPlanes(this._transformMatrix),this._refreshFrustumPlanes=!1)}isInFrustum(e,t=!1){if(this._updateFrustumPlanes(),t&&this.rigCameras.length>0){let i=!1;return this.rigCameras.forEach(r=>{r._updateFrustumPlanes(),i=i||e.isInFrustum(r._frustumPlanes)}),i}else return e.isInFrustum(this._frustumPlanes)}isCompletelyInFrustum(e){return this._updateFrustumPlanes(),e.isCompletelyInFrustum(this._frustumPlanes)}getForwardRay(e=100,t,i){throw ke("Ray")}getForwardRayToRef(e,t=100,i,r){throw ke("Ray")}dispose(e,t=!1){for(this.onViewMatrixChangedObservable.clear(),this.onProjectionMatrixChangedObservable.clear(),this.onAfterCheckInputsObservable.clear(),this.onRestoreStateObservable.clear(),this.inputs&&this.inputs.clear(),this.getScene().stopAnimation(this),this.getScene().removeCamera(this);this._rigCameras.length>0;){const r=this._rigCameras.pop();r&&r.dispose()}if(this._parentContainer){const r=this._parentContainer.cameras.indexOf(this);r>-1&&this._parentContainer.cameras.splice(r,1),this._parentContainer=null}if(this._rigPostProcess)this._rigPostProcess.dispose(this),this._rigPostProcess=null,this._postProcesses.length=0;else if(this.cameraRigMode!==Ie.RIG_MODE_NONE)this._rigPostProcess=null,this._postProcesses.length=0;else{let r=this._postProcesses.length;for(;--r>=0;){const s=this._postProcesses[r];s&&s.dispose(this)}}let i=this.customRenderTargets.length;for(;--i>=0;)this.customRenderTargets[i].dispose();this.customRenderTargets.length=0,this._activeMeshes.dispose(),this.getScene().getEngine().releaseRenderPassId(this.renderPassId),super.dispose(e,t)}get isLeftCamera(){return this._isLeftCamera}get isRightCamera(){return this._isRightCamera}get leftCamera(){return this._rigCameras.length<1?null:this._rigCameras[0]}get rightCamera(){return this._rigCameras.length<2?null:this._rigCameras[1]}getLeftTarget(){return this._rigCameras.length<1?null:this._rigCameras[0].getTarget()}getRightTarget(){return this._rigCameras.length<2?null:this._rigCameras[1].getTarget()}setCameraRigMode(e,t){if(this.cameraRigMode!==e){for(;this._rigCameras.length>0;){const i=this._rigCameras.pop();i&&i.dispose()}if(this.cameraRigMode=e,this._cameraRigParams={},this._cameraRigParams.interaxialDistance=t.interaxialDistance||.0637,this._cameraRigParams.stereoHalfAngle=X.ToRadians(this._cameraRigParams.interaxialDistance/.0637),this.cameraRigMode!==Ie.RIG_MODE_NONE){const i=this.createRigCamera(this.name+"_L",0);i&&(i._isLeftCamera=!0);const r=this.createRigCamera(this.name+"_R",1);r&&(r._isRightCamera=!0),i&&r&&(this._rigCameras.push(i),this._rigCameras.push(r))}this._setRigMode(t),this._cascadePostProcessesToRigCams(),this.update()}}_setRigMode(e){}_getVRProjectionMatrix(){return z.PerspectiveFovLHToRef(this._cameraRigParams.vrMetrics.aspectRatioFov,this._cameraRigParams.vrMetrics.aspectRatio,this.minZ,this.maxZ,this._cameraRigParams.vrWorkMatrix,!0,this.getEngine().isNDCHalfZRange),this._cameraRigParams.vrWorkMatrix.multiplyToRef(this._cameraRigParams.vrHMatrix,this._projectionMatrix),this._projectionMatrix}setCameraRigParameter(e,t){this._cameraRigParams||(this._cameraRigParams={}),this._cameraRigParams[e]=t,e==="interaxialDistance"&&(this._cameraRigParams.stereoHalfAngle=X.ToRadians(t/.0637))}createRigCamera(e,t){return null}_updateRigCameras(){for(let e=0;e<this._rigCameras.length;e++)this._rigCameras[e].minZ=this.minZ,this._rigCameras[e].maxZ=this.maxZ,this._rigCameras[e].fov=this.fov,this._rigCameras[e].upVector.copyFrom(this.upVector);this.cameraRigMode===Ie.RIG_MODE_STEREOSCOPIC_ANAGLYPH&&(this._rigCameras[0].viewport=this._rigCameras[1].viewport=this.viewport)}_setupInputs(){}serialize(){const e=Fe.Serialize(this);return e.uniqueId=this.uniqueId,e.type=this.getClassName(),this.parent&&this.parent._serializeAsParent(e),this.inputs&&this.inputs.serialize(e),Fe.AppendSerializedAnimations(this,e),e.ranges=this.serializeAnimationRanges(),e.isEnabled=this.isEnabled(),e}clone(e,t=null){const i=Fe.Clone(Ie.GetConstructorFromName(this.getClassName(),e,this.getScene(),this.interaxialDistance,this.isStereoscopicSideBySide),this);return i.name=e,i.parent=t,this.onClonedObservable.notifyObservers(i),i}getDirection(e){const t=A.Zero();return this.getDirectionToRef(e,t),t}get absoluteRotation(){return this.getWorldMatrix().decompose(void 0,this._absoluteRotation),this._absoluteRotation}getDirectionToRef(e,t){A.TransformNormalToRef(e,this.getWorldMatrix(),t)}static GetConstructorFromName(e,t,i,r=0,s=!0){const a=Mi.Construct(e,t,i,{interaxial_distance:r,isStereoscopicSideBySide:s});return a||(()=>Ie._CreateDefaultParsedCamera(t,i))}computeWorldMatrix(){return this.getWorldMatrix()}static Parse(e,t){const i=e.type,r=Ie.GetConstructorFromName(i,e.name,t,e.interaxial_distance,e.isStereoscopicSideBySide),s=Fe.Parse(r,e,t);if(e.parentId!==void 0&&(s._waitingParentId=e.parentId),e.parentInstanceIndex!==void 0&&(s._waitingParentInstanceIndex=e.parentInstanceIndex),s.inputs&&(s.inputs.parse(e),s._setupInputs()),e.upVector&&(s.upVector=A.FromArray(e.upVector)),s.setPosition&&(s.position.copyFromFloats(0,0,0),s.setPosition(A.FromArray(e.position))),e.target&&s.setTarget&&s.setTarget(A.FromArray(e.target)),e.cameraRigMode){const a=e.interaxial_distance?{interaxialDistance:e.interaxial_distance}:{};s.setCameraRigMode(e.cameraRigMode,a)}if(e.animations){for(let a=0;a<e.animations.length;a++){const l=e.animations[a],o=Bn("BABYLON.Animation");o&&s.animations.push(o.Parse(l))}Mi.ParseAnimationRanges(s,e,t)}return e.autoAnimate&&t.beginAnimation(s,e.autoAnimateFrom,e.autoAnimateTo,e.autoAnimateLoop,e.autoAnimateSpeed||1),e.isEnabled!==void 0&&s.setEnabled(e.isEnabled),s}_calculateHandednessMultiplier(){let e=this.getScene().useRightHandedSystem?-1:1;return this.parent&&this.parent._getWorldMatrixDeterminant()<0&&(e*=-1),e}}Ie._CreateDefaultParsedCamera=(n,e)=>{throw ke("UniversalCamera")};Ie.PERSPECTIVE_CAMERA=0;Ie.ORTHOGRAPHIC_CAMERA=1;Ie.FOVMODE_VERTICAL_FIXED=0;Ie.FOVMODE_HORIZONTAL_FIXED=1;Ie.RIG_MODE_NONE=0;Ie.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10;Ie.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11;Ie.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12;Ie.RIG_MODE_STEREOSCOPIC_OVERUNDER=13;Ie.RIG_MODE_STEREOSCOPIC_INTERLACED=14;Ie.RIG_MODE_VR=20;Ie.RIG_MODE_CUSTOM=22;Ie.ForceAttachControlToAlwaysPreventDefault=!1;R([Tn("position")],Ie.prototype,"_position",void 0);R([Tn("upVector")],Ie.prototype,"_upVector",void 0);R([I()],Ie.prototype,"orthoLeft",null);R([I()],Ie.prototype,"orthoRight",null);R([I()],Ie.prototype,"orthoBottom",null);R([I()],Ie.prototype,"orthoTop",null);R([I()],Ie.prototype,"fov",void 0);R([I()],Ie.prototype,"projectionPlaneTilt",void 0);R([I()],Ie.prototype,"minZ",void 0);R([I()],Ie.prototype,"maxZ",void 0);R([I()],Ie.prototype,"inertia",void 0);R([I()],Ie.prototype,"mode",null);R([I()],Ie.prototype,"layerMask",void 0);R([I()],Ie.prototype,"fovMode",void 0);R([I()],Ie.prototype,"cameraRigMode",void 0);R([I()],Ie.prototype,"interaxialDistance",void 0);R([I()],Ie.prototype,"isStereoscopicSideBySide",void 0);class Op{constructor(e,t,i){this.bu=e,this.bv=t,this.distance=i,this.faceId=0,this.subMeshId=0}}class Rs{constructor(e,t,i){this.vectors=Zi.BuildArray(8,A.Zero),this.center=A.Zero(),this.centerWorld=A.Zero(),this.extendSize=A.Zero(),this.extendSizeWorld=A.Zero(),this.directions=Zi.BuildArray(3,A.Zero),this.vectorsWorld=Zi.BuildArray(8,A.Zero),this.minimumWorld=A.Zero(),this.maximumWorld=A.Zero(),this.minimum=A.Zero(),this.maximum=A.Zero(),this._drawWrapperFront=null,this._drawWrapperBack=null,this.reConstruct(e,t,i)}reConstruct(e,t,i){const r=e.x,s=e.y,a=e.z,l=t.x,o=t.y,c=t.z,u=this.vectors;this.minimum.copyFromFloats(r,s,a),this.maximum.copyFromFloats(l,o,c),u[0].copyFromFloats(r,s,a),u[1].copyFromFloats(l,o,c),u[2].copyFromFloats(l,s,a),u[3].copyFromFloats(r,o,a),u[4].copyFromFloats(r,s,c),u[5].copyFromFloats(l,o,a),u[6].copyFromFloats(r,o,c),u[7].copyFromFloats(l,s,c),t.addToRef(e,this.center).scaleInPlace(.5),t.subtractToRef(e,this.extendSize).scaleInPlace(.5),this._worldMatrix=i||z.IdentityReadOnly,this._update(this._worldMatrix)}scale(e){const t=Rs._TmpVector3,i=this.maximum.subtractToRef(this.minimum,t[0]),r=i.length();i.normalizeFromLength(r);const s=r*e,a=i.scaleInPlace(s*.5),l=this.center.subtractToRef(a,t[1]),o=this.center.addToRef(a,t[2]);return this.reConstruct(l,o,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(e){const t=this.minimumWorld,i=this.maximumWorld,r=this.directions,s=this.vectorsWorld,a=this.vectors;if(e.isIdentity()){t.copyFrom(this.minimum),i.copyFrom(this.maximum);for(let l=0;l<8;++l)s[l].copyFrom(a[l]);this.extendSizeWorld.copyFrom(this.extendSize),this.centerWorld.copyFrom(this.center)}else{t.setAll(Number.MAX_VALUE),i.setAll(-Number.MAX_VALUE);for(let l=0;l<8;++l){const o=s[l];A.TransformCoordinatesToRef(a[l],e,o),t.minimizeInPlace(o),i.maximizeInPlace(o)}i.subtractToRef(t,this.extendSizeWorld).scaleInPlace(.5),i.addToRef(t,this.centerWorld).scaleInPlace(.5)}A.FromArrayToRef(e.m,0,r[0]),A.FromArrayToRef(e.m,4,r[1]),A.FromArrayToRef(e.m,8,r[2]),this._worldMatrix=e}isInFrustum(e){return Rs.IsInFrustum(this.vectorsWorld,e)}isCompletelyInFrustum(e){return Rs.IsCompletelyInFrustum(this.vectorsWorld,e)}intersectsPoint(e){const t=this.minimumWorld,i=this.maximumWorld,r=t.x,s=t.y,a=t.z,l=i.x,o=i.y,c=i.z,u=e.x,h=e.y,d=e.z,f=-ut;return!(l-u<f||f>u-r||o-h<f||f>h-s||c-d<f||f>d-a)}intersectsSphere(e){return Rs.IntersectsSphere(this.minimumWorld,this.maximumWorld,e.centerWorld,e.radiusWorld)}intersectsMinMax(e,t){const i=this.minimumWorld,r=this.maximumWorld,s=i.x,a=i.y,l=i.z,o=r.x,c=r.y,u=r.z,h=e.x,d=e.y,f=e.z,_=t.x,p=t.y,v=t.z;return!(o<h||s>_||c<d||a>p||u<f||l>v)}dispose(){var e,t;(e=this._drawWrapperFront)==null||e.dispose(),(t=this._drawWrapperBack)==null||t.dispose()}static Intersects(e,t){return e.intersectsMinMax(t.minimumWorld,t.maximumWorld)}static IntersectsSphere(e,t,i,r){const s=Rs._TmpVector3[0];return A.ClampToRef(i,e,t,s),A.DistanceSquared(i,s)<=r*r}static IsCompletelyInFrustum(e,t){for(let i=0;i<6;++i){const r=t[i];for(let s=0;s<8;++s)if(r.dotCoordinate(e[s])<0)return!1}return!0}static IsInFrustum(e,t){for(let i=0;i<6;++i){let r=!0;const s=t[i];for(let a=0;a<8;++a)if(s.dotCoordinate(e[a])>=0){r=!1;break}if(r)return!1}return!0}}Rs._TmpVector3=Zi.BuildArray(3,A.Zero);class Eo{constructor(e,t,i){this.center=A.Zero(),this.centerWorld=A.Zero(),this.minimum=A.Zero(),this.maximum=A.Zero(),this.reConstruct(e,t,i)}reConstruct(e,t,i){this.minimum.copyFrom(e),this.maximum.copyFrom(t);const r=A.Distance(e,t);t.addToRef(e,this.center).scaleInPlace(.5),this.radius=r*.5,this._update(i||z.IdentityReadOnly)}scale(e){const t=this.radius*e,i=Eo._TmpVector3,r=i[0].setAll(t),s=this.center.subtractToRef(r,i[1]),a=this.center.addToRef(r,i[2]);return this.reConstruct(s,a,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(e){if(e.isIdentity())this.centerWorld.copyFrom(this.center),this.radiusWorld=this.radius;else{A.TransformCoordinatesToRef(this.center,e,this.centerWorld);const t=Eo._TmpVector3[0];A.TransformNormalFromFloatsToRef(1,1,1,e,t),this.radiusWorld=Math.max(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z))*this.radius}}isInFrustum(e){const t=this.centerWorld,i=this.radiusWorld;for(let r=0;r<6;r++)if(e[r].dotCoordinate(t)<=-i)return!1;return!0}isCenterInFrustum(e){const t=this.centerWorld;for(let i=0;i<6;i++)if(e[i].dotCoordinate(t)<0)return!1;return!0}intersectsPoint(e){const t=A.DistanceSquared(this.centerWorld,e);return!(this.radiusWorld*this.radiusWorld<t)}static Intersects(e,t){const i=A.DistanceSquared(e.centerWorld,t.centerWorld),r=e.radiusWorld+t.radiusWorld;return!(r*r<i)}static CreateFromCenterAndRadius(e,t,i){this._TmpVector3[0].copyFrom(e),this._TmpVector3[1].copyFromFloats(0,0,t),this._TmpVector3[2].copyFrom(e),this._TmpVector3[0].addInPlace(this._TmpVector3[1]),this._TmpVector3[2].subtractInPlace(this._TmpVector3[1]);const r=new Eo(this._TmpVector3[0],this._TmpVector3[2]);return i?r._worldMatrix=i:r._worldMatrix=z.Identity(),r}}Eo._TmpVector3=Zi.BuildArray(3,A.Zero);const I_={min:0,max:0},P_={min:0,max:0},aE=(n,e,t)=>{const i=A.Dot(e.centerWorld,n),r=Math.abs(A.Dot(e.directions[0],n))*e.extendSize.x,s=Math.abs(A.Dot(e.directions[1],n))*e.extendSize.y,a=Math.abs(A.Dot(e.directions[2],n))*e.extendSize.z,l=r+s+a;t.min=i-l,t.max=i+l},Sr=(n,e,t)=>(aE(n,e,I_),aE(n,t,P_),!(I_.min>P_.max||P_.min>I_.max));class Zr{constructor(e,t,i){this._isLocked=!1,this.boundingBox=new Rs(e,t,i),this.boundingSphere=new Eo(e,t,i)}reConstruct(e,t,i){this.boundingBox.reConstruct(e,t,i),this.boundingSphere.reConstruct(e,t,i)}get minimum(){return this.boundingBox.minimum}get maximum(){return this.boundingBox.maximum}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked=e}update(e){this._isLocked||(this.boundingBox._update(e),this.boundingSphere._update(e))}centerOn(e,t){const i=Zr._TmpVector3[0].copyFrom(e).subtractInPlace(t),r=Zr._TmpVector3[1].copyFrom(e).addInPlace(t);return this.boundingBox.reConstruct(i,r,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(i,r,this.boundingBox.getWorldMatrix()),this}encapsulate(e){const t=A.Minimize(this.minimum,e),i=A.Maximize(this.maximum,e);return this.reConstruct(t,i,this.boundingBox.getWorldMatrix()),this}encapsulateBoundingInfo(e){const t=V.Matrix[0];this.boundingBox.getWorldMatrix().invertToRef(t);const i=V.Vector3[0];return A.TransformCoordinatesToRef(e.boundingBox.minimumWorld,t,i),this.encapsulate(i),A.TransformCoordinatesToRef(e.boundingBox.maximumWorld,t,i),this.encapsulate(i),this}scale(e){return this.boundingBox.scale(e),this.boundingSphere.scale(e),this}isInFrustum(e,t=0){return(t===2||t===3)&&this.boundingSphere.isCenterInFrustum(e)?!0:this.boundingSphere.isInFrustum(e)?t===1||t===3?!0:this.boundingBox.isInFrustum(e):!1}get diagonalLength(){const e=this.boundingBox;return e.maximumWorld.subtractToRef(e.minimumWorld,Zr._TmpVector3[0]).length()}isCompletelyInFrustum(e){return this.boundingBox.isCompletelyInFrustum(e)}_checkCollision(e){return e._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)}intersectsPoint(e){return!(!this.boundingSphere.centerWorld||!this.boundingSphere.intersectsPoint(e)||!this.boundingBox.intersectsPoint(e))}intersects(e,t){if(!Eo.Intersects(this.boundingSphere,e.boundingSphere)||!Rs.Intersects(this.boundingBox,e.boundingBox))return!1;if(!t)return!0;const i=this.boundingBox,r=e.boundingBox;return!(!Sr(i.directions[0],i,r)||!Sr(i.directions[1],i,r)||!Sr(i.directions[2],i,r)||!Sr(r.directions[0],i,r)||!Sr(r.directions[1],i,r)||!Sr(r.directions[2],i,r)||!Sr(A.Cross(i.directions[0],r.directions[0]),i,r)||!Sr(A.Cross(i.directions[0],r.directions[1]),i,r)||!Sr(A.Cross(i.directions[0],r.directions[2]),i,r)||!Sr(A.Cross(i.directions[1],r.directions[0]),i,r)||!Sr(A.Cross(i.directions[1],r.directions[1]),i,r)||!Sr(A.Cross(i.directions[1],r.directions[2]),i,r)||!Sr(A.Cross(i.directions[2],r.directions[0]),i,r)||!Sr(A.Cross(i.directions[2],r.directions[1]),i,r)||!Sr(A.Cross(i.directions[2],r.directions[2]),i,r))}}Zr._TmpVector3=Zi.BuildArray(2,A.Zero);class Qd{static extractMinAndMaxIndexed(e,t,i,r,s,a){for(let l=i;l<i+r;l++){const o=t[l]*3,c=e[o],u=e[o+1],h=e[o+2];s.minimizeInPlaceFromFloats(c,u,h),a.maximizeInPlaceFromFloats(c,u,h)}}static extractMinAndMax(e,t,i,r,s,a){for(let l=t,o=t*r;l<t+i;l++,o+=r){const c=e[o],u=e[o+1],h=e[o+2];s.minimizeInPlaceFromFloats(c,u,h),a.maximizeInPlaceFromFloats(c,u,h)}}}R([La.filter((...[n,e])=>!Array.isArray(n)&&!Array.isArray(e))],Qd,"extractMinAndMaxIndexed",null);R([La.filter((...[n])=>!Array.isArray(n))],Qd,"extractMinAndMax",null);function XN(n,e,t,i,r=null){const s=new A(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new A(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return Qd.extractMinAndMaxIndexed(n,e,t,i,s,a),r&&(s.x-=s.x*r.x+r.y,s.y-=s.y*r.x+r.y,s.z-=s.z*r.x+r.y,a.x+=a.x*r.x+r.y,a.y+=a.y*r.x+r.y,a.z+=a.z*r.x+r.y),{minimum:s,maximum:a}}function v1(n,e,t,i=null,r){const s=new A(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new A(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return r||(r=3),Qd.extractMinAndMax(n,e,t,r,s,a),i&&(s.x-=s.x*i.x+i.y,s.y-=s.y*i.x+i.y,s.z-=s.z*i.x+i.y,a.x+=a.x*i.x+i.y,a.y+=a.y*i.x+i.y,a.z+=a.z*i.x+i.y),{minimum:s,maximum:a}}class pn{get materialDefines(){var e;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.defines:(e=this._getDrawWrapper())==null?void 0:e.defines}set materialDefines(e){const t=this._mainDrawWrapperOverride??this._getDrawWrapper(void 0,!0);t.defines=e}_getDrawWrapper(e,t=!1){e=e??this._engine.currentRenderPassId;let i=this._drawWrappers[e];return!i&&t&&(this._drawWrappers[e]=i=new ec(this._mesh.getScene().getEngine())),i}_removeDrawWrapper(e,t=!0){var i;t&&((i=this._drawWrappers[e])==null||i.dispose()),this._drawWrappers[e]=void 0}get effect(){var e;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.effect:((e=this._getDrawWrapper())==null?void 0:e.effect)??null}get _drawWrapper(){return this._mainDrawWrapperOverride??this._getDrawWrapper(void 0,!0)}get _drawWrapperOverride(){return this._mainDrawWrapperOverride}_setMainDrawWrapperOverride(e){this._mainDrawWrapperOverride=e}setEffect(e,t=null,i,r=!0){const s=this._drawWrapper;s.setEffect(e,t,r),i!==void 0&&(s.materialContext=i),e||(s.defines=null,s.materialContext=void 0)}resetDrawCache(e){if(this._drawWrappers)if(e!==void 0){this._removeDrawWrapper(e);return}else for(const t of this._drawWrappers)t==null||t.dispose();this._drawWrappers=[]}static AddToMesh(e,t,i,r,s,a,l,o=!0){return new pn(e,t,i,r,s,a,l,o)}constructor(e,t,i,r,s,a,l,o=!0,c=!0){this.materialIndex=e,this.verticesStart=t,this.verticesCount=i,this.indexStart=r,this.indexCount=s,this._mainDrawWrapperOverride=null,this._linesIndexCount=0,this._linesIndexBuffer=null,this._lastColliderWorldVertices=null,this._lastColliderTransformMatrix=null,this._wasDispatched=!1,this._renderId=0,this._alphaIndex=0,this._distanceToCamera=0,this._currentMaterial=null,this._mesh=a,this._renderingMesh=l||a,c&&a.subMeshes.push(this),this._engine=this._mesh.getScene().getEngine(),this.resetDrawCache(),this._trianglePlanes=[],this._id=a.subMeshes.length-1,o&&(this.refreshBoundingInfo(),a.computeWorldMatrix(!0))}get IsGlobal(){return this.verticesStart===0&&this.verticesCount===this._mesh.getTotalVertices()&&this.indexStart===0&&this.indexCount===this._mesh.getTotalIndices()}getBoundingInfo(){return this.IsGlobal||this._mesh.hasThinInstances?this._mesh.getBoundingInfo():this._boundingInfo}setBoundingInfo(e){return this._boundingInfo=e,this}getMesh(){return this._mesh}getRenderingMesh(){return this._renderingMesh}getReplacementMesh(){return this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null}getEffectiveMesh(){const e=this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null;return e||this._renderingMesh}getMaterial(e=!0){const t=this._renderingMesh.getMaterialForRenderPass(this._engine.currentRenderPassId)??this._renderingMesh.material;if(t){if(this._isMultiMaterial(t)){const i=t.getSubMaterial(this.materialIndex);return this._currentMaterial!==i&&(this._currentMaterial=i,this.resetDrawCache()),i}}else return e?this._mesh.getScene().defaultMaterial:null;return t}_isMultiMaterial(e){return e.getSubMaterial!==void 0}refreshBoundingInfo(e=null){if(this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.geometry)return this;if(e||(e=this._renderingMesh.getVerticesData(x.PositionKind)),!e)return this._boundingInfo=this._mesh.getBoundingInfo(),this;const t=this._renderingMesh.getIndices();let i;if(this.indexStart===0&&this.indexCount===t.length){const r=this._renderingMesh.getBoundingInfo();i={minimum:r.minimum.clone(),maximum:r.maximum.clone()}}else i=XN(e,t,this.indexStart,this.indexCount,this._renderingMesh.geometry.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(i.minimum,i.maximum):this._boundingInfo=new Zr(i.minimum,i.maximum),this}_checkCollision(e){return this.getBoundingInfo()._checkCollision(e)}updateBoundingInfo(e){let t=this.getBoundingInfo();return t||(this.refreshBoundingInfo(),t=this.getBoundingInfo()),t&&t.update(e),this}isInFrustum(e){const t=this.getBoundingInfo();return t?t.isInFrustum(e,this._mesh.cullingStrategy):!1}isCompletelyInFrustum(e){const t=this.getBoundingInfo();return t?t.isCompletelyInFrustum(e):!1}render(e){return this._renderingMesh.render(this,e,this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:void 0),this}_getLinesIndexBuffer(e,t){if(!this._linesIndexBuffer){const i=[];for(let r=this.indexStart;r<this.indexStart+this.indexCount;r+=3)i.push(e[r],e[r+1],e[r+1],e[r+2],e[r+2],e[r]);this._linesIndexBuffer=t.createIndexBuffer(i),this._linesIndexCount=i.length}return this._linesIndexBuffer}canIntersects(e){const t=this.getBoundingInfo();return t?e.intersectsBox(t.boundingBox):!1}intersects(e,t,i,r,s){const a=this.getMaterial();if(!a)return null;let l=3,o=!1;switch(a.fillMode){case 3:case 5:case 6:case 8:return null;case 7:l=1,o=!0;break}return a.fillMode===4?i.length?this._intersectLines(e,t,i,this._mesh.intersectionThreshold,r):this._intersectUnIndexedLines(e,t,i,this._mesh.intersectionThreshold,r):!i.length&&this._mesh._unIndexed?this._intersectUnIndexedTriangles(e,t,i,r,s):this._intersectTriangles(e,t,i,l,o,r,s)}_intersectLines(e,t,i,r,s){let a=null;for(let l=this.indexStart;l<this.indexStart+this.indexCount;l+=2){const o=t[i[l]],c=t[i[l+1]],u=e.intersectionSegment(o,c,r);if(!(u<0)&&(s||!a||u<a.distance)&&(a=new Op(null,null,u),a.faceId=l/2,s))break}return a}_intersectUnIndexedLines(e,t,i,r,s){let a=null;for(let l=this.verticesStart;l<this.verticesStart+this.verticesCount;l+=2){const o=t[l],c=t[l+1],u=e.intersectionSegment(o,c,r);if(!(u<0)&&(s||!a||u<a.distance)&&(a=new Op(null,null,u),a.faceId=l/2,s))break}return a}_intersectTriangles(e,t,i,r,s,a,l){let o=null,c=-1;for(let u=this.indexStart;u<this.indexStart+this.indexCount-(3-r);u+=r){c++;const h=i[u],d=i[u+1],f=i[u+2];if(s&&f===4294967295){u+=2;continue}const _=t[h],p=t[d],v=t[f];if(!_||!p||!v||l&&!l(_,p,v,e,h,d,f))continue;const E=e.intersectsTriangle(_,p,v);if(E){if(E.distance<0)continue;if((a||!o||E.distance<o.distance)&&(o=E,o.faceId=c,a))break}}return o}_intersectUnIndexedTriangles(e,t,i,r,s){let a=null;for(let l=this.verticesStart;l<this.verticesStart+this.verticesCount;l+=3){const o=t[l],c=t[l+1],u=t[l+2];if(s&&!s(o,c,u,e,-1,-1,-1))continue;const h=e.intersectsTriangle(o,c,u);if(h){if(h.distance<0)continue;if((r||!a||h.distance<a.distance)&&(a=h,a.faceId=l/3,r))break}}return a}_rebuild(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)}clone(e,t){const i=new pn(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,e,t,!1);if(!this.IsGlobal){const r=this.getBoundingInfo();if(!r)return i;i._boundingInfo=new Zr(r.minimum,r.maximum)}return i}dispose(){this._linesIndexBuffer&&(this._mesh.getScene().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);const e=this._mesh.subMeshes.indexOf(this);this._mesh.subMeshes.splice(e,1),this.resetDrawCache()}getClassName(){return"SubMesh"}static CreateFromIndices(e,t,i,r,s,a=!0){let l=Number.MAX_VALUE,o=-Number.MAX_VALUE;const u=(s||r).getIndices();for(let h=t;h<t+i;h++){const d=u[h];d<l&&(l=d),d>o&&(o=d)}return new pn(e,l,o-l+1,t,i,r,s,a)}}class w_{}class Ue{constructor(){this.uniqueId=0,this.metadata={},this._applyTo=HN(this._applyToCoroutine.bind(this)),this.uniqueId=Ue._UniqueIDGenerator,Ue._UniqueIDGenerator++}set(e,t){switch(e.length||ee.Warn(`Setting vertex data kind '${t}' with an empty array`),t){case x.PositionKind:this.positions=e;break;case x.NormalKind:this.normals=e;break;case x.TangentKind:this.tangents=e;break;case x.UVKind:this.uvs=e;break;case x.UV2Kind:this.uvs2=e;break;case x.UV3Kind:this.uvs3=e;break;case x.UV4Kind:this.uvs4=e;break;case x.UV5Kind:this.uvs5=e;break;case x.UV6Kind:this.uvs6=e;break;case x.ColorKind:this.colors=e;break;case x.MatricesIndicesKind:this.matricesIndices=e;break;case x.MatricesWeightsKind:this.matricesWeights=e;break;case x.MatricesIndicesExtraKind:this.matricesIndicesExtra=e;break;case x.MatricesWeightsExtraKind:this.matricesWeightsExtra=e;break}}applyToMesh(e,t){return this._applyTo(e,t,!1),this}applyToGeometry(e,t){return this._applyTo(e,t,!1),this}updateMesh(e){return this._update(e),this}updateGeometry(e){return this._update(e),this}*_applyToCoroutine(e,t=!1,i){if(this.positions&&(e.setVerticesData(x.PositionKind,this.positions,t),i&&(yield)),this.normals&&(e.setVerticesData(x.NormalKind,this.normals,t),i&&(yield)),this.tangents&&(e.setVerticesData(x.TangentKind,this.tangents,t),i&&(yield)),this.uvs&&(e.setVerticesData(x.UVKind,this.uvs,t),i&&(yield)),this.uvs2&&(e.setVerticesData(x.UV2Kind,this.uvs2,t),i&&(yield)),this.uvs3&&(e.setVerticesData(x.UV3Kind,this.uvs3,t),i&&(yield)),this.uvs4&&(e.setVerticesData(x.UV4Kind,this.uvs4,t),i&&(yield)),this.uvs5&&(e.setVerticesData(x.UV5Kind,this.uvs5,t),i&&(yield)),this.uvs6&&(e.setVerticesData(x.UV6Kind,this.uvs6,t),i&&(yield)),this.colors&&(e.setVerticesData(x.ColorKind,this.colors,t),this.hasVertexAlpha&&e.hasVertexAlpha!==void 0&&(e.hasVertexAlpha=!0),i&&(yield)),this.matricesIndices&&(e.setVerticesData(x.MatricesIndicesKind,this.matricesIndices,t),i&&(yield)),this.matricesWeights&&(e.setVerticesData(x.MatricesWeightsKind,this.matricesWeights,t),i&&(yield)),this.matricesIndicesExtra&&(e.setVerticesData(x.MatricesIndicesExtraKind,this.matricesIndicesExtra,t),i&&(yield)),this.matricesWeightsExtra&&(e.setVerticesData(x.MatricesWeightsExtraKind,this.matricesWeightsExtra,t),i&&(yield)),this.indices?(e.setIndices(this.indices,null,t),i&&(yield)):e.setIndices([],null),e.subMeshes&&this.materialInfos&&this.materialInfos.length>1){const r=e;r.subMeshes=[];for(const s of this.materialInfos)new pn(s.materialIndex,s.verticesStart,s.verticesCount,s.indexStart,s.indexCount,r)}return this}_update(e,t,i){return this.positions&&e.updateVerticesData(x.PositionKind,this.positions,t,i),this.normals&&e.updateVerticesData(x.NormalKind,this.normals,t,i),this.tangents&&e.updateVerticesData(x.TangentKind,this.tangents,t,i),this.uvs&&e.updateVerticesData(x.UVKind,this.uvs,t,i),this.uvs2&&e.updateVerticesData(x.UV2Kind,this.uvs2,t,i),this.uvs3&&e.updateVerticesData(x.UV3Kind,this.uvs3,t,i),this.uvs4&&e.updateVerticesData(x.UV4Kind,this.uvs4,t,i),this.uvs5&&e.updateVerticesData(x.UV5Kind,this.uvs5,t,i),this.uvs6&&e.updateVerticesData(x.UV6Kind,this.uvs6,t,i),this.colors&&e.updateVerticesData(x.ColorKind,this.colors,t,i),this.matricesIndices&&e.updateVerticesData(x.MatricesIndicesKind,this.matricesIndices,t,i),this.matricesWeights&&e.updateVerticesData(x.MatricesWeightsKind,this.matricesWeights,t,i),this.matricesIndicesExtra&&e.updateVerticesData(x.MatricesIndicesExtraKind,this.matricesIndicesExtra,t,i),this.matricesWeightsExtra&&e.updateVerticesData(x.MatricesWeightsExtraKind,this.matricesWeightsExtra,t,i),this.indices&&e.setIndices(this.indices,null),this}static _TransformVector3Coordinates(e,t,i=0,r=e.length){const s=V.Vector3[0],a=V.Vector3[1];for(let l=i;l<i+r;l+=3)A.FromArrayToRef(e,l,s),A.TransformCoordinatesToRef(s,t,a),e[l]=a.x,e[l+1]=a.y,e[l+2]=a.z}static _TransformVector3Normals(e,t,i=0,r=e.length){const s=V.Vector3[0],a=V.Vector3[1];for(let l=i;l<i+r;l+=3)A.FromArrayToRef(e,l,s),A.TransformNormalToRef(s,t,a),e[l]=a.x,e[l+1]=a.y,e[l+2]=a.z}static _TransformVector4Normals(e,t,i=0,r=e.length){const s=V.Vector4[0],a=V.Vector4[1];for(let l=i;l<i+r;l+=4)qe.FromArrayToRef(e,l,s),qe.TransformNormalToRef(s,t,a),e[l]=a.x,e[l+1]=a.y,e[l+2]=a.z,e[l+3]=a.w}static _FlipFaces(e,t=0,i=e.length){for(let r=t;r<t+i;r+=3){const s=e[r+1];e[r+1]=e[r+2],e[r+2]=s}}transform(e){const t=e.determinant()<0;return this.positions&&Ue._TransformVector3Coordinates(this.positions,e),this.normals&&Ue._TransformVector3Normals(this.normals,e),this.tangents&&Ue._TransformVector4Normals(this.tangents,e),t&&this.indices&&Ue._FlipFaces(this.indices),this}splitBasedOnMaterialID(){if(!this.materialInfos||this.materialInfos.length<2)return[this];const e=[];for(const t of this.materialInfos){const i=new Ue;if(this.positions&&(i.positions=this.positions.slice(t.verticesStart*3,(t.verticesCount+t.verticesStart)*3)),this.normals&&(i.normals=this.normals.slice(t.verticesStart*3,(t.verticesCount+t.verticesStart)*3)),this.tangents&&(i.tangents=this.tangents.slice(t.verticesStart*4,(t.verticesCount+t.verticesStart)*4)),this.colors&&(i.colors=this.colors.slice(t.verticesStart*4,(t.verticesCount+t.verticesStart)*4)),this.uvs&&(i.uvs=this.uvs.slice(t.verticesStart*2,(t.verticesCount+t.verticesStart)*2)),this.uvs2&&(i.uvs2=this.uvs2.slice(t.verticesStart*2,(t.verticesCount+t.verticesStart)*2)),this.uvs3&&(i.uvs3=this.uvs3.slice(t.verticesStart*2,(t.verticesCount+t.verticesStart)*2)),this.uvs4&&(i.uvs4=this.uvs4.slice(t.verticesStart*2,(t.verticesCount+t.verticesStart)*2)),this.uvs5&&(i.uvs5=this.uvs5.slice(t.verticesStart*2,(t.verticesCount+t.verticesStart)*2)),this.uvs6&&(i.uvs6=this.uvs6.slice(t.verticesStart*2,(t.verticesCount+t.verticesStart)*2)),this.matricesIndices&&(i.matricesIndices=this.matricesIndices.slice(t.verticesStart*4,(t.verticesCount+t.verticesStart)*4)),this.matricesIndicesExtra&&(i.matricesIndicesExtra=this.matricesIndicesExtra.slice(t.verticesStart*4,(t.verticesCount+t.verticesStart)*4)),this.matricesWeights&&(i.matricesWeights=this.matricesWeights.slice(t.verticesStart*4,(t.verticesCount+t.verticesStart)*4)),this.matricesWeightsExtra&&(i.matricesWeightsExtra=this.matricesWeightsExtra.slice(t.verticesStart*4,(t.verticesCount+t.verticesStart)*4)),this.indices){i.indices=[];for(let s=t.indexStart;s<t.indexStart+t.indexCount;s++)i.indices.push(this.indices[s]-t.verticesStart)}const r=new w_;r.indexStart=0,r.indexCount=i.indices?i.indices.length:0,r.materialIndex=t.materialIndex,r.verticesStart=0,r.verticesCount=(i.positions?i.positions.length:0)/3,i.materialInfos=[r],e.push(i)}return e}merge(e,t=!1,i=!1,r=!1,s=!1){const a=Array.isArray(e)?e.map(l=>({vertexData:l})):[{vertexData:e}];return gm(this._mergeCoroutine(void 0,a,t,!1,i,r,s))}*_mergeCoroutine(e,t,i=!1,r,s,a=!1,l=!1){var f,_;this._validate();let o=t.map(p=>p.vertexData),c=this;if(l)for(const p of o)p&&(p._validate(),!this.normals&&p.normals&&(this.normals=new Float32Array(this.positions.length)),!this.tangents&&p.tangents&&(this.tangents=new Float32Array(this.positions.length/3*4)),!this.uvs&&p.uvs&&(this.uvs=new Float32Array(this.positions.length/3*2)),!this.uvs2&&p.uvs2&&(this.uvs2=new Float32Array(this.positions.length/3*2)),!this.uvs3&&p.uvs3&&(this.uvs3=new Float32Array(this.positions.length/3*2)),!this.uvs4&&p.uvs4&&(this.uvs4=new Float32Array(this.positions.length/3*2)),!this.uvs5&&p.uvs5&&(this.uvs5=new Float32Array(this.positions.length/3*2)),!this.uvs6&&p.uvs6&&(this.uvs6=new Float32Array(this.positions.length/3*2)),!this.colors&&p.colors&&(this.colors=new Float32Array(this.positions.length/3*4),this.colors.fill(1)),!this.matricesIndices&&p.matricesIndices&&(this.matricesIndices=new Float32Array(this.positions.length/3*4)),!this.matricesWeights&&p.matricesWeights&&(this.matricesWeights=new Float32Array(this.positions.length/3*4)),!this.matricesIndicesExtra&&p.matricesIndicesExtra&&(this.matricesIndicesExtra=new Float32Array(this.positions.length/3*4)),!this.matricesWeightsExtra&&p.matricesWeightsExtra&&(this.matricesWeightsExtra=new Float32Array(this.positions.length/3*4)));for(const p of o)if(p){if(l)this.normals&&!p.normals&&(p.normals=new Float32Array(p.positions.length)),this.tangents&&!p.tangents&&(p.tangents=new Float32Array(p.positions.length/3*4)),this.uvs&&!p.uvs&&(p.uvs=new Float32Array(p.positions.length/3*2)),this.uvs2&&!p.uvs2&&(p.uvs2=new Float32Array(p.positions.length/3*2)),this.uvs3&&!p.uvs3&&(p.uvs3=new Float32Array(p.positions.length/3*2)),this.uvs4&&!p.uvs4&&(p.uvs4=new Float32Array(p.positions.length/3*2)),this.uvs5&&!p.uvs5&&(p.uvs5=new Float32Array(p.positions.length/3*2)),this.uvs6&&!p.uvs6&&(p.uvs6=new Float32Array(p.positions.length/3*2)),this.colors&&!p.colors&&(p.colors=new Float32Array(p.positions.length/3*4),p.colors.fill(1)),this.matricesIndices&&!p.matricesIndices&&(p.matricesIndices=new Float32Array(p.positions.length/3*4)),this.matricesWeights&&!p.matricesWeights&&(p.matricesWeights=new Float32Array(p.positions.length/3*4)),this.matricesIndicesExtra&&!p.matricesIndicesExtra&&(p.matricesIndicesExtra=new Float32Array(p.positions.length/3*4)),this.matricesWeightsExtra&&!p.matricesWeightsExtra&&(p.matricesWeightsExtra=new Float32Array(p.positions.length/3*4));else if(p._validate(),!this.normals!=!p.normals||!this.tangents!=!p.tangents||!this.uvs!=!p.uvs||!this.uvs2!=!p.uvs2||!this.uvs3!=!p.uvs3||!this.uvs4!=!p.uvs4||!this.uvs5!=!p.uvs5||!this.uvs6!=!p.uvs6||!this.colors!=!p.colors||!this.matricesIndices!=!p.matricesIndices||!this.matricesWeights!=!p.matricesWeights||!this.matricesIndicesExtra!=!p.matricesIndicesExtra||!this.matricesWeightsExtra!=!p.matricesWeightsExtra)throw new Error("Cannot merge vertex data that do not have the same set of attributes")}if(a){let p=0,v=0,E=0;const g=[];let m=null;const y=[];for(const b of this.splitBasedOnMaterialID())y.push({vertexData:b,transform:e});for(const b of t)if(b.vertexData)for(const C of b.vertexData.splitBasedOnMaterialID())y.push({vertexData:C,transform:b.transform});y.sort((b,C)=>{const M=b.vertexData.materialInfos?b.vertexData.materialInfos[0].materialIndex:0,F=C.vertexData.materialInfos?C.vertexData.materialInfos[0].materialIndex:0;return M>F?1:M===F?0:-1});for(const b of y){const C=b.vertexData;if(C.materialInfos?p=C.materialInfos[0].materialIndex:p=0,m&&m.materialIndex===p)m.indexCount+=C.indices.length,m.verticesCount+=C.positions.length/3;else{const M=new w_;M.materialIndex=p,M.indexStart=v,M.indexCount=C.indices.length,M.verticesStart=E,M.verticesCount=C.positions.length/3,g.push(M),m=M}v+=C.indices.length,E+=C.positions.length/3}const T=y.splice(0,1)[0];c=T.vertexData,e=T.transform,o=y.map(b=>b.vertexData),t=y,this.materialInfos=g}const u=o.reduce((p,v)=>{var E;return p+(((E=v.indices)==null?void 0:E.length)??0)},((f=c.indices)==null?void 0:f.length)??0);let d=s||o.some(p=>p.indices===c.indices)?(_=c.indices)==null?void 0:_.slice():c.indices;if(u>0){let p=(d==null?void 0:d.length)??0;if(d||(d=new Array(u)),d.length!==u){if(Array.isArray(d))d.length=u;else{const E=i||d instanceof Uint32Array?new Uint32Array(u):new Uint16Array(u);E.set(d),d=E}e&&e.determinant()<0&&Ue._FlipFaces(d,0,p)}let v=c.positions?c.positions.length/3:0;for(const{vertexData:E,transform:g}of t)if(E.indices){for(let m=0;m<E.indices.length;m++)d[p+m]=E.indices[m]+v;g&&g.determinant()<0&&Ue._FlipFaces(d,p,E.indices.length),v+=E.positions.length/3,p+=E.indices.length,r&&(yield)}}return this.indices=d,this.positions=Ue._MergeElement(x.PositionKind,c.positions,e,t.map(p=>[p.vertexData.positions,p.transform])),r&&(yield),c.normals&&(this.normals=Ue._MergeElement(x.NormalKind,c.normals,e,t.map(p=>[p.vertexData.normals,p.transform])),r&&(yield)),c.tangents&&(this.tangents=Ue._MergeElement(x.TangentKind,c.tangents,e,t.map(p=>[p.vertexData.tangents,p.transform])),r&&(yield)),c.uvs&&(this.uvs=Ue._MergeElement(x.UVKind,c.uvs,e,t.map(p=>[p.vertexData.uvs,p.transform])),r&&(yield)),c.uvs2&&(this.uvs2=Ue._MergeElement(x.UV2Kind,c.uvs2,e,t.map(p=>[p.vertexData.uvs2,p.transform])),r&&(yield)),c.uvs3&&(this.uvs3=Ue._MergeElement(x.UV3Kind,c.uvs3,e,t.map(p=>[p.vertexData.uvs3,p.transform])),r&&(yield)),c.uvs4&&(this.uvs4=Ue._MergeElement(x.UV4Kind,c.uvs4,e,t.map(p=>[p.vertexData.uvs4,p.transform])),r&&(yield)),c.uvs5&&(this.uvs5=Ue._MergeElement(x.UV5Kind,c.uvs5,e,t.map(p=>[p.vertexData.uvs5,p.transform])),r&&(yield)),c.uvs6&&(this.uvs6=Ue._MergeElement(x.UV6Kind,c.uvs6,e,t.map(p=>[p.vertexData.uvs6,p.transform])),r&&(yield)),c.colors&&(this.colors=Ue._MergeElement(x.ColorKind,c.colors,e,t.map(p=>[p.vertexData.colors,p.transform])),(c.hasVertexAlpha!==void 0||t.some(p=>p.vertexData.hasVertexAlpha!==void 0))&&(this.hasVertexAlpha=c.hasVertexAlpha||t.some(p=>p.vertexData.hasVertexAlpha)),r&&(yield)),c.matricesIndices&&(this.matricesIndices=Ue._MergeElement(x.MatricesIndicesKind,c.matricesIndices,e,t.map(p=>[p.vertexData.matricesIndices,p.transform])),r&&(yield)),c.matricesWeights&&(this.matricesWeights=Ue._MergeElement(x.MatricesWeightsKind,c.matricesWeights,e,t.map(p=>[p.vertexData.matricesWeights,p.transform])),r&&(yield)),c.matricesIndicesExtra&&(this.matricesIndicesExtra=Ue._MergeElement(x.MatricesIndicesExtraKind,c.matricesIndicesExtra,e,t.map(p=>[p.vertexData.matricesIndicesExtra,p.transform])),r&&(yield)),c.matricesWeightsExtra&&(this.matricesWeightsExtra=Ue._MergeElement(x.MatricesWeightsExtraKind,c.matricesWeightsExtra,e,t.map(p=>[p.vertexData.matricesWeightsExtra,p.transform]))),this}static _MergeElement(e,t,i,r){const s=r.filter(o=>o[0]!==null&&o[0]!==void 0);if(!t&&s.length==0)return t;if(!t)return this._MergeElement(e,s[0][0],s[0][1],s.slice(1));const a=s.reduce((o,c)=>o+c[0].length,t.length),l=e===x.PositionKind?Ue._TransformVector3Coordinates:e===x.NormalKind?Ue._TransformVector3Normals:e===x.TangentKind?Ue._TransformVector4Normals:()=>{};if(t instanceof Float32Array){const o=new Float32Array(a);o.set(t),i&&l(o,i,0,t.length);let c=t.length;for(const[u,h]of s)o.set(u,c),h&&l(o,h,c,u.length),c+=u.length;return o}else{const o=new Array(a);for(let u=0;u<t.length;u++)o[u]=t[u];i&&l(o,i,0,t.length);let c=t.length;for(const[u,h]of s){for(let d=0;d<u.length;d++)o[c+d]=u[d];h&&l(o,h,c,u.length),c+=u.length}return o}}_validate(){if(!this.positions)throw new ws("Positions are required",vo.MeshInvalidPositionsError);const e=(r,s)=>{const a=x.DeduceStride(r);if(s.length%a!==0)throw new Error("The "+r+"s array count must be a multiple of "+a);return s.length/a},t=e(x.PositionKind,this.positions),i=(r,s)=>{const a=e(r,s);if(a!==t)throw new Error("The "+r+"s element count ("+a+") does not match the positions count ("+t+")")};this.normals&&i(x.NormalKind,this.normals),this.tangents&&i(x.TangentKind,this.tangents),this.uvs&&i(x.UVKind,this.uvs),this.uvs2&&i(x.UV2Kind,this.uvs2),this.uvs3&&i(x.UV3Kind,this.uvs3),this.uvs4&&i(x.UV4Kind,this.uvs4),this.uvs5&&i(x.UV5Kind,this.uvs5),this.uvs6&&i(x.UV6Kind,this.uvs6),this.colors&&i(x.ColorKind,this.colors),this.matricesIndices&&i(x.MatricesIndicesKind,this.matricesIndices),this.matricesWeights&&i(x.MatricesWeightsKind,this.matricesWeights),this.matricesIndicesExtra&&i(x.MatricesIndicesExtraKind,this.matricesIndicesExtra),this.matricesWeightsExtra&&i(x.MatricesWeightsExtraKind,this.matricesWeightsExtra)}clone(){const e=this.serialize();return Ue.Parse(e)}serialize(){const e={};if(this.positions&&(e.positions=Array.from(this.positions)),this.normals&&(e.normals=Array.from(this.normals)),this.tangents&&(e.tangents=Array.from(this.tangents)),this.uvs&&(e.uvs=Array.from(this.uvs)),this.uvs2&&(e.uvs2=Array.from(this.uvs2)),this.uvs3&&(e.uvs3=Array.from(this.uvs3)),this.uvs4&&(e.uvs4=Array.from(this.uvs4)),this.uvs5&&(e.uvs5=Array.from(this.uvs5)),this.uvs6&&(e.uvs6=Array.from(this.uvs6)),this.colors&&(e.colors=Array.from(this.colors),e.hasVertexAlpha=this.hasVertexAlpha),this.matricesIndices&&(e.matricesIndices=Array.from(this.matricesIndices),e.matricesIndices._isExpanded=!0),this.matricesWeights&&(e.matricesWeights=Array.from(this.matricesWeights)),this.matricesIndicesExtra&&(e.matricesIndicesExtra=Array.from(this.matricesIndicesExtra),e.matricesIndicesExtra._isExpanded=!0),this.matricesWeightsExtra&&(e.matricesWeightsExtra=Array.from(this.matricesWeightsExtra)),e.indices=Array.from(this.indices),this.materialInfos){e.materialInfos=[];for(const t of this.materialInfos){const i={indexStart:t.indexStart,indexCount:t.indexCount,materialIndex:t.materialIndex,verticesStart:t.verticesStart,verticesCount:t.verticesCount};e.materialInfos.push(i)}}return e}static ExtractFromMesh(e,t,i){return Ue._ExtractFrom(e,t,i)}static ExtractFromGeometry(e,t,i){return Ue._ExtractFrom(e,t,i)}static _ExtractFrom(e,t,i){const r=new Ue;return e.isVerticesDataPresent(x.PositionKind)&&(r.positions=e.getVerticesData(x.PositionKind,t,i)),e.isVerticesDataPresent(x.NormalKind)&&(r.normals=e.getVerticesData(x.NormalKind,t,i)),e.isVerticesDataPresent(x.TangentKind)&&(r.tangents=e.getVerticesData(x.TangentKind,t,i)),e.isVerticesDataPresent(x.UVKind)&&(r.uvs=e.getVerticesData(x.UVKind,t,i)),e.isVerticesDataPresent(x.UV2Kind)&&(r.uvs2=e.getVerticesData(x.UV2Kind,t,i)),e.isVerticesDataPresent(x.UV3Kind)&&(r.uvs3=e.getVerticesData(x.UV3Kind,t,i)),e.isVerticesDataPresent(x.UV4Kind)&&(r.uvs4=e.getVerticesData(x.UV4Kind,t,i)),e.isVerticesDataPresent(x.UV5Kind)&&(r.uvs5=e.getVerticesData(x.UV5Kind,t,i)),e.isVerticesDataPresent(x.UV6Kind)&&(r.uvs6=e.getVerticesData(x.UV6Kind,t,i)),e.isVerticesDataPresent(x.ColorKind)&&(r.colors=e.getVerticesData(x.ColorKind,t,i)),e.isVerticesDataPresent(x.MatricesIndicesKind)&&(r.matricesIndices=e.getVerticesData(x.MatricesIndicesKind,t,i)),e.isVerticesDataPresent(x.MatricesWeightsKind)&&(r.matricesWeights=e.getVerticesData(x.MatricesWeightsKind,t,i)),e.isVerticesDataPresent(x.MatricesIndicesExtraKind)&&(r.matricesIndicesExtra=e.getVerticesData(x.MatricesIndicesExtraKind,t,i)),e.isVerticesDataPresent(x.MatricesWeightsExtraKind)&&(r.matricesWeightsExtra=e.getVerticesData(x.MatricesWeightsExtraKind,t,i)),r.indices=e.getIndices(t,i),r}static CreateRibbon(e){throw ke("ribbonBuilder")}static CreateBox(e){throw ke("boxBuilder")}static CreateTiledBox(e){throw ke("tiledBoxBuilder")}static CreateTiledPlane(e){throw ke("tiledPlaneBuilder")}static CreateSphere(e){throw ke("sphereBuilder")}static CreateCylinder(e){throw ke("cylinderBuilder")}static CreateTorus(e){throw ke("torusBuilder")}static CreateLineSystem(e){throw ke("linesBuilder")}static CreateDashedLines(e){throw ke("linesBuilder")}static CreateGround(e){throw ke("groundBuilder")}static CreateTiledGround(e){throw ke("groundBuilder")}static CreateGroundFromHeightMap(e){throw ke("groundBuilder")}static CreatePlane(e){throw ke("planeBuilder")}static CreateDisc(e){throw ke("discBuilder")}static CreatePolygon(e,t,i,r,s,a,l){throw ke("polygonBuilder")}static CreateIcoSphere(e){throw ke("icoSphereBuilder")}static CreatePolyhedron(e){throw ke("polyhedronBuilder")}static CreateCapsule(e={orientation:A.Up(),subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6}){throw ke("capsuleBuilder")}static CreateTorusKnot(e){throw ke("torusKnotBuilder")}static ComputeNormals(e,t,i,r){let s=0,a=0,l=0,o=0,c=0,u=0,h=0,d=0,f=0,_=0,p=0,v=0,E=0,g=0,m=0,y=0,T=0,b=0,C=0,M=0,F=!1,P=!1,U=!1,G=!1,K=1,q=0,se=null;r&&(F=!!r.facetNormals,P=!!r.facetPositions,U=!!r.facetPartitioning,K=r.useRightHandedSystem===!0?-1:1,q=r.ratio||0,G=!!r.depthSort,se=r.distanceTo,G&&se===void 0&&(se=A.Zero()));let Ee=0,Se=0,$=0,_e=0;for(U&&r&&r.bbSize&&(Ee=r.subDiv.X*q/r.bbSize.x,Se=r.subDiv.Y*q/r.bbSize.y,$=r.subDiv.Z*q/r.bbSize.z,_e=r.subDiv.max*r.subDiv.max,r.facetPartitioning.length=0),s=0;s<e.length;s++)i[s]=0;const ae=t.length/3|0;for(s=0;s<ae;s++){if(v=t[s*3]*3,E=v+1,g=v+2,m=t[s*3+1]*3,y=m+1,T=m+2,b=t[s*3+2]*3,C=b+1,M=b+2,a=e[v]-e[m],l=e[E]-e[y],o=e[g]-e[T],c=e[b]-e[m],u=e[C]-e[y],h=e[M]-e[T],d=K*(l*h-o*u),f=K*(o*c-a*h),_=K*(a*u-l*c),p=Math.sqrt(d*d+f*f+_*_),p=p===0?1:p,d/=p,f/=p,_/=p,F&&r&&(r.facetNormals[s].x=d,r.facetNormals[s].y=f,r.facetNormals[s].z=_),P&&r&&(r.facetPositions[s].x=(e[v]+e[m]+e[b])/3,r.facetPositions[s].y=(e[E]+e[y]+e[C])/3,r.facetPositions[s].z=(e[g]+e[T]+e[M])/3),U&&r){const ce=Math.floor((r.facetPositions[s].x-r.bInfo.minimum.x*q)*Ee),he=Math.floor((r.facetPositions[s].y-r.bInfo.minimum.y*q)*Se),je=Math.floor((r.facetPositions[s].z-r.bInfo.minimum.z*q)*$),Xe=Math.floor((e[v]-r.bInfo.minimum.x*q)*Ee),Tt=Math.floor((e[E]-r.bInfo.minimum.y*q)*Se),Ze=Math.floor((e[g]-r.bInfo.minimum.z*q)*$),W=Math.floor((e[m]-r.bInfo.minimum.x*q)*Ee),pe=Math.floor((e[y]-r.bInfo.minimum.y*q)*Se),De=Math.floor((e[T]-r.bInfo.minimum.z*q)*$),ft=Math.floor((e[b]-r.bInfo.minimum.x*q)*Ee),st=Math.floor((e[C]-r.bInfo.minimum.y*q)*Se),$e=Math.floor((e[M]-r.bInfo.minimum.z*q)*$),bt=Xe+r.subDiv.max*Tt+_e*Ze,Wt=W+r.subDiv.max*pe+_e*De,rt=ft+r.subDiv.max*st+_e*$e,Ht=ce+r.subDiv.max*he+_e*je;r.facetPartitioning[Ht]=r.facetPartitioning[Ht]?r.facetPartitioning[Ht]:new Array,r.facetPartitioning[bt]=r.facetPartitioning[bt]?r.facetPartitioning[bt]:new Array,r.facetPartitioning[Wt]=r.facetPartitioning[Wt]?r.facetPartitioning[Wt]:new Array,r.facetPartitioning[rt]=r.facetPartitioning[rt]?r.facetPartitioning[rt]:new Array,r.facetPartitioning[bt].push(s),Wt!=bt&&r.facetPartitioning[Wt].push(s),rt==Wt||rt==bt||r.facetPartitioning[rt].push(s),Ht==bt||Ht==Wt||Ht==rt||r.facetPartitioning[Ht].push(s)}if(G&&r&&r.facetPositions){const ce=r.depthSortedFacets[s];ce.ind=s*3,ce.sqDistance=A.DistanceSquared(r.facetPositions[s],se)}i[v]+=d,i[E]+=f,i[g]+=_,i[m]+=d,i[y]+=f,i[T]+=_,i[b]+=d,i[C]+=f,i[M]+=_}for(s=0;s<i.length/3;s++)d=i[s*3],f=i[s*3+1],_=i[s*3+2],p=Math.sqrt(d*d+f*f+_*_),p=p===0?1:p,d/=p,f/=p,_/=p,i[s*3]=d,i[s*3+1]=f,i[s*3+2]=_}static _ComputeSides(e,t,i,r,s,a,l){const o=i.length,c=r.length;let u,h;switch(e=e||Ue.DEFAULTSIDE,e){case Ue.FRONTSIDE:break;case Ue.BACKSIDE:for(u=0;u<o;u+=3){const d=i[u];i[u]=i[u+2],i[u+2]=d}for(h=0;h<c;h++)r[h]=-r[h];break;case Ue.DOUBLESIDE:{const d=t.length,f=d/3;for(let v=0;v<d;v++)t[d+v]=t[v];for(u=0;u<o;u+=3)i[u+o]=i[u+2]+f,i[u+1+o]=i[u+1]+f,i[u+2+o]=i[u]+f;for(h=0;h<c;h++)r[c+h]=-r[h];const _=s.length;let p=0;for(p=0;p<_;p++)s[p+_]=s[p];for(a=a||new qe(0,0,1,1),l=l||new qe(0,0,1,1),p=0,u=0;u<_/2;u++)s[p]=a.x+(a.z-a.x)*s[p],s[p+1]=a.y+(a.w-a.y)*s[p+1],s[p+_]=l.x+(l.z-l.x)*s[p+_],s[p+_+1]=l.y+(l.w-l.y)*s[p+_+1],p+=2;break}}}static Parse(e){const t=new Ue,i=e.positions;i&&t.set(i,x.PositionKind);const r=e.normals;r&&t.set(r,x.NormalKind);const s=e.tangents;s&&t.set(s,x.TangentKind);const a=e.uvs;a&&t.set(a,x.UVKind);const l=e.uvs2;l&&t.set(l,x.UV2Kind);const o=e.uvs3;o&&t.set(o,x.UV3Kind);const c=e.uvs4;c&&t.set(c,x.UV4Kind);const u=e.uvs5;u&&t.set(u,x.UV5Kind);const h=e.uvs6;h&&t.set(h,x.UV6Kind);const d=e.colors;d&&(t.set(et.CheckColors4(d,i.length/3),x.ColorKind),e.hasVertexAlpha!==void 0&&(t.hasVertexAlpha=e.hasVertexAlpha));const f=e.matricesIndices;f&&t.set(f,x.MatricesIndicesKind);const _=e.matricesWeights;_&&t.set(_,x.MatricesWeightsKind);const p=e.indices;p&&(t.indices=p);const v=e.materialInfos;if(v){t.materialInfos=[];for(const E of v){const g=new w_;g.indexCount=E.indexCount,g.indexStart=E.indexStart,g.verticesCount=E.verticesCount,g.verticesStart=E.verticesStart,g.materialIndex=E.materialIndex,t.materialInfos.push(g)}}return t}static ImportVertexData(e,t){const i=Ue.Parse(e);t.setAllVerticesData(i,e.updatable)}}Ue.FRONTSIDE=0;Ue.BACKSIDE=1;Ue.DOUBLESIDE=2;Ue.DEFAULTSIDE=0;Ue._UniqueIDGenerator=0;R([La.filter((...[n])=>!Array.isArray(n))],Ue,"_TransformVector3Coordinates",null);R([La.filter((...[n])=>!Array.isArray(n))],Ue,"_TransformVector3Normals",null);R([La.filter((...[n])=>!Array.isArray(n))],Ue,"_TransformVector4Normals",null);R([La.filter((...[n])=>!Array.isArray(n))],Ue,"_FlipFaces",null);class As{}As.UseOpenGLOrientationForUV=!1;class rr{get boundingBias(){return this._boundingBias}set boundingBias(e){this._boundingBias?this._boundingBias.copyFrom(e):this._boundingBias=e.clone(),this._updateBoundingInfo(!0,null)}static CreateGeometryForMesh(e){const t=new rr(rr.RandomId(),e.getScene());return t.applyToMesh(e),t}get meshes(){return this._meshes}constructor(e,t,i,r=!1,s=null){this.delayLoadState=0,this._totalVertices=0,this._isDisposed=!1,this._indexBufferIsUpdatable=!1,this._positionsCache=[],this._parentContainer=null,this.useBoundingInfoFromGeometry=!1,this._scene=t||He.LastCreatedScene,this._scene&&(this.id=e,this.uniqueId=this._scene.getUniqueId(),this._engine=this._scene.getEngine(),this._meshes=[],this._vertexBuffers={},this._indices=[],this._updatable=r,i?this.setAllVerticesData(i,r):this._totalVertices=0,this._engine.getCaps().vertexArrayObject&&(this._vertexArrayObjects={}),s&&(this.applyToMesh(s),s.computeWorldMatrix(!0)))}get extend(){return this._extend}getScene(){return this._scene}getEngine(){return this._engine}isReady(){return this.delayLoadState===1||this.delayLoadState===0}get doNotSerialize(){for(let e=0;e<this._meshes.length;e++)if(!this._meshes[e].doNotSerialize)return!1;return!0}_rebuild(){this._vertexArrayObjects&&(this._vertexArrayObjects={}),this._meshes.length!==0&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,this._updatable,"Geometry_"+this.id+"_IndexBuffer"));const e=new Set;for(const t in this._vertexBuffers)e.add(this._vertexBuffers[t].getWrapperBuffer());e.forEach(t=>{t._rebuild()})}setAllVerticesData(e,t){e.applyToGeometry(this,t),this._notifyUpdate()}setVerticesData(e,t,i=!1,r){i&&Array.isArray(t)&&(t=new Float32Array(t));const s=new x(this._engine,t,e,{updatable:i,postponeInternalCreation:this._meshes.length===0,stride:r,label:"Geometry_"+this.id+"_"+e});this.setVerticesBuffer(s)}removeVerticesData(e){this._vertexBuffers[e]&&(this._vertexBuffers[e].dispose(),delete this._vertexBuffers[e]),this._vertexArrayObjects&&this._disposeVertexArrayObjects()}setVerticesBuffer(e,t=null,i=!0){const r=e.getKind();this._vertexBuffers[r]&&i&&this._vertexBuffers[r].dispose(),e._buffer&&e._buffer._increaseReferences(),this._vertexBuffers[r]=e;const s=this._meshes,a=s.length;if(r===x.PositionKind){this._totalVertices=t??e._maxVerticesCount,this._updateExtend(e.getFloatData(this._totalVertices)),this._resetPointsArrayCache();const l=this._extend&&this._extend.minimum||new A(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),o=this._extend&&this._extend.maximum||new A(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);for(let c=0;c<a;c++){const u=s[c];u.buildBoundingInfo(l,o),u._createGlobalSubMesh(u.isUnIndexed),u.computeWorldMatrix(!0),u.synchronizeInstances()}}this._notifyUpdate(r)}updateVerticesDataDirectly(e,t,i,r=!1){const s=this.getVertexBuffer(e);s&&(s.updateDirectly(t,i,r),this._notifyUpdate(e))}updateVerticesData(e,t,i=!1){const r=this.getVertexBuffer(e);r&&(r.update(t),e===x.PositionKind&&this._updateBoundingInfo(i,t),this._notifyUpdate(e))}_updateBoundingInfo(e,t){if(e&&this._updateExtend(t),this._resetPointsArrayCache(),e){const i=this._meshes;for(const r of i){r.hasBoundingInfo?r.getBoundingInfo().reConstruct(this._extend.minimum,this._extend.maximum):r.buildBoundingInfo(this._extend.minimum,this._extend.maximum);const s=r.subMeshes;for(const a of s)a.refreshBoundingInfo()}}}_bind(e,t,i,r){if(!e)return;t===void 0&&(t=this._indexBuffer);const s=this.getVertexBuffers();if(!s)return;if(t!=this._indexBuffer||!this._vertexArrayObjects&&!r){this._engine.bindBuffers(s,t,e,i);return}const a=r||this._vertexArrayObjects;a[e.key]||(a[e.key]=this._engine.recordVertexArrayObject(s,t,e,i)),this._engine.bindVertexArrayObject(a[e.key],t)}getTotalVertices(){return this.isReady()?this._totalVertices:0}getVerticesData(e,t,i){const r=this.getVertexBuffer(e);return r?r.getFloatData(this._totalVertices,i||t&&this._meshes.length!==1):null}isVertexBufferUpdatable(e){const t=this._vertexBuffers[e];return t?t.isUpdatable():!1}getVertexBuffer(e){return this.isReady()?this._vertexBuffers[e]:null}getVertexBuffers(){return this.isReady()?this._vertexBuffers:null}isVerticesDataPresent(e){return this._vertexBuffers?this._vertexBuffers[e]!==void 0:this._delayInfo?this._delayInfo.indexOf(e)!==-1:!1}getVerticesDataKinds(){const e=[];let t;if(!this._vertexBuffers&&this._delayInfo)for(t in this._delayInfo)e.push(t);else for(t in this._vertexBuffers)e.push(t);return e}updateIndices(e,t,i=!1){if(this._indexBuffer)if(!this._indexBufferIsUpdatable)this.setIndices(e,null,!0);else{const r=e.length!==this._indices.length;if(i||(this._indices=e.slice()),this._engine.updateDynamicIndexBuffer(this._indexBuffer,e,t),r)for(const s of this._meshes)s._createGlobalSubMesh(!0)}}setIndexBuffer(e,t,i){this._indices=[],this._indexBufferIsUpdatable=!1,this._indexBuffer=e,this._totalVertices=t,this._totalIndices=i,e.is32Bits||(e.is32Bits=this._totalIndices>65535);for(const r of this._meshes)r._createGlobalSubMesh(!0),r.synchronizeInstances();this._notifyUpdate()}setIndices(e,t=null,i=!1){this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indices=e,this._indexBufferIsUpdatable=i,this._meshes.length!==0&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,i,"Geometry_"+this.id+"_IndexBuffer")),t!=null&&(this._totalVertices=t);for(const r of this._meshes)r._createGlobalSubMesh(!0),r.synchronizeInstances();this._notifyUpdate()}getTotalIndices(){return this.isReady()?this._totalIndices!==void 0?this._totalIndices:this._indices.length:0}getIndices(e,t){if(!this.isReady())return null;const i=this._indices;return!t&&(!e||this._meshes.length===1)?i:i.slice()}getIndexBuffer(){return this.isReady()?this._indexBuffer:null}_releaseVertexArrayObject(e=null){!e||!this._vertexArrayObjects||this._vertexArrayObjects[e.key]&&(this._engine.releaseVertexArrayObject(this._vertexArrayObjects[e.key]),delete this._vertexArrayObjects[e.key])}releaseForMesh(e,t){const i=this._meshes,r=i.indexOf(e);r!==-1&&(i.splice(r,1),this._vertexArrayObjects&&e._invalidateInstanceVertexArrayObject(),e._geometry=null,i.length===0&&t&&this.dispose())}applyToMesh(e){if(e._geometry===this)return;const t=e._geometry;t&&t.releaseForMesh(e),this._vertexArrayObjects&&e._invalidateInstanceVertexArrayObject();const i=this._meshes;e._geometry=this,e._internalAbstractMeshDataInfo._positions=null,this._scene.pushGeometry(this),i.push(e),this.isReady()?this._applyToMesh(e):this._boundingInfo&&e.setBoundingInfo(this._boundingInfo)}_updateExtend(e=null){if(this.useBoundingInfoFromGeometry&&this._boundingInfo)this._extend={minimum:this._boundingInfo.minimum.clone(),maximum:this._boundingInfo.maximum.clone()};else{if(!e&&(e=this.getVerticesData(x.PositionKind),!e))return;this._extend=v1(e,0,this._totalVertices,this.boundingBias,3)}}_applyToMesh(e){const t=this._meshes.length;for(const i in this._vertexBuffers)t===1&&this._vertexBuffers[i].create(),i===x.PositionKind&&(this._extend||this._updateExtend(),e.buildBoundingInfo(this._extend.minimum,this._extend.maximum),e._createGlobalSubMesh(e.isUnIndexed),e._updateBoundingInfo());t===1&&this._indices&&this._indices.length>0&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,this._updatable,"Geometry_"+this.id+"_IndexBuffer")),e._syncGeometryWithMorphTargetManager(),e.synchronizeInstances()}_notifyUpdate(e){this.onGeometryUpdated&&this.onGeometryUpdated(this,e),this._vertexArrayObjects&&this._disposeVertexArrayObjects();for(const t of this._meshes)t._markSubMeshesAsAttributesDirty()}load(e,t){if(this.delayLoadState!==2){if(this.isReady()){t&&t();return}this.delayLoadState=2,this._queueLoad(e,t)}}_queueLoad(e,t){this.delayLoadingFile&&(e.addPendingData(this),e._loadFile(this.delayLoadingFile,i=>{if(!this._delayLoadingFunction)return;this._delayLoadingFunction(JSON.parse(i),this),this.delayLoadState=1,this._delayInfo=[],e.removePendingData(this);const r=this._meshes,s=r.length;for(let a=0;a<s;a++)this._applyToMesh(r[a]);t&&t()},void 0,!0))}toLeftHanded(){const e=this.getIndices(!1);if(e!=null&&e.length>0){for(let r=0;r<e.length;r+=3){const s=e[r+0];e[r+0]=e[r+2],e[r+2]=s}this.setIndices(e)}const t=this.getVerticesData(x.PositionKind,!1);if(t!=null&&t.length>0){for(let r=0;r<t.length;r+=3)t[r+2]=-t[r+2];this.setVerticesData(x.PositionKind,t,!1)}const i=this.getVerticesData(x.NormalKind,!1);if(i!=null&&i.length>0){for(let r=0;r<i.length;r+=3)i[r+2]=-i[r+2];this.setVerticesData(x.NormalKind,i,!1)}}_resetPointsArrayCache(){this._positions=null}_generatePointsArray(){if(this._positions)return!0;const e=this.getVerticesData(x.PositionKind);if(!e||e.length===0)return!1;for(let t=this._positionsCache.length*3,i=this._positionsCache.length;t<e.length;t+=3,++i)this._positionsCache[i]=A.FromArray(e,t);for(let t=0,i=0;t<e.length;t+=3,++i)this._positionsCache[i].set(e[0+t],e[1+t],e[2+t]);return this._positionsCache.length=e.length/3,this._positions=this._positionsCache,!0}isDisposed(){return this._isDisposed}_disposeVertexArrayObjects(){if(this._vertexArrayObjects){for(const i in this._vertexArrayObjects)this._engine.releaseVertexArrayObject(this._vertexArrayObjects[i]);this._vertexArrayObjects={};const e=this._meshes,t=e.length;for(let i=0;i<t;i++)e[i]._invalidateInstanceVertexArrayObject()}}dispose(){const e=this._meshes,t=e.length;let i;for(i=0;i<t;i++)this.releaseForMesh(e[i]);this._meshes.length=0,this._disposeVertexArrayObjects();for(const r in this._vertexBuffers)this._vertexBuffers[r].dispose();if(this._vertexBuffers={},this._totalVertices=0,this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indexBuffer=null,this._indices=[],this.delayLoadState=0,this.delayLoadingFile=null,this._delayLoadingFunction=null,this._delayInfo=[],this._boundingInfo=null,this._scene.removeGeometry(this),this._parentContainer){const r=this._parentContainer.geometries.indexOf(this);r>-1&&this._parentContainer.geometries.splice(r,1),this._parentContainer=null}this._isDisposed=!0}copy(e){const t=new Ue;t.indices=[];const i=this.getIndices();if(i)for(let o=0;o<i.length;o++)t.indices.push(i[o]);let r=!1,s=!1,a;for(a in this._vertexBuffers){const o=this.getVerticesData(a);if(o&&(o instanceof Float32Array?t.set(new Float32Array(o),a):t.set(o.slice(0),a),!s)){const c=this.getVertexBuffer(a);c&&(r=c.isUpdatable(),s=!r)}}const l=new rr(e,this._scene,t,r);l.delayLoadState=this.delayLoadState,l.delayLoadingFile=this.delayLoadingFile,l._delayLoadingFunction=this._delayLoadingFunction;for(a in this._delayInfo)l._delayInfo=l._delayInfo||[],l._delayInfo.push(a);return l._boundingInfo=new Zr(this._extend.minimum,this._extend.maximum),l}serialize(){const e={};return e.id=this.id,e.uniqueId=this.uniqueId,e.updatable=this._updatable,ct&&ct.HasTags(this)&&(e.tags=ct.GetTags(this)),e}_toNumberArray(e){return Array.isArray(e)?e:Array.prototype.slice.call(e)}clearCachedData(){this._indices=[],this._resetPointsArrayCache();for(const e in this._vertexBuffers)Object.prototype.hasOwnProperty.call(this._vertexBuffers,e)&&(this._vertexBuffers[e]._buffer._data=null)}serializeVerticeData(){const e=this.serialize();return this.isVerticesDataPresent(x.PositionKind)&&(e.positions=this._toNumberArray(this.getVerticesData(x.PositionKind)),this.isVertexBufferUpdatable(x.PositionKind)&&(e.positions._updatable=!0)),this.isVerticesDataPresent(x.NormalKind)&&(e.normals=this._toNumberArray(this.getVerticesData(x.NormalKind)),this.isVertexBufferUpdatable(x.NormalKind)&&(e.normals._updatable=!0)),this.isVerticesDataPresent(x.TangentKind)&&(e.tangents=this._toNumberArray(this.getVerticesData(x.TangentKind)),this.isVertexBufferUpdatable(x.TangentKind)&&(e.tangents._updatable=!0)),this.isVerticesDataPresent(x.UVKind)&&(e.uvs=this._toNumberArray(this.getVerticesData(x.UVKind)),this.isVertexBufferUpdatable(x.UVKind)&&(e.uvs._updatable=!0)),this.isVerticesDataPresent(x.UV2Kind)&&(e.uvs2=this._toNumberArray(this.getVerticesData(x.UV2Kind)),this.isVertexBufferUpdatable(x.UV2Kind)&&(e.uvs2._updatable=!0)),this.isVerticesDataPresent(x.UV3Kind)&&(e.uvs3=this._toNumberArray(this.getVerticesData(x.UV3Kind)),this.isVertexBufferUpdatable(x.UV3Kind)&&(e.uvs3._updatable=!0)),this.isVerticesDataPresent(x.UV4Kind)&&(e.uvs4=this._toNumberArray(this.getVerticesData(x.UV4Kind)),this.isVertexBufferUpdatable(x.UV4Kind)&&(e.uvs4._updatable=!0)),this.isVerticesDataPresent(x.UV5Kind)&&(e.uvs5=this._toNumberArray(this.getVerticesData(x.UV5Kind)),this.isVertexBufferUpdatable(x.UV5Kind)&&(e.uvs5._updatable=!0)),this.isVerticesDataPresent(x.UV6Kind)&&(e.uvs6=this._toNumberArray(this.getVerticesData(x.UV6Kind)),this.isVertexBufferUpdatable(x.UV6Kind)&&(e.uvs6._updatable=!0)),this.isVerticesDataPresent(x.ColorKind)&&(e.colors=this._toNumberArray(this.getVerticesData(x.ColorKind)),this.isVertexBufferUpdatable(x.ColorKind)&&(e.colors._updatable=!0)),this.isVerticesDataPresent(x.MatricesIndicesKind)&&(e.matricesIndices=this._toNumberArray(this.getVerticesData(x.MatricesIndicesKind)),e.matricesIndices._isExpanded=!0,this.isVertexBufferUpdatable(x.MatricesIndicesKind)&&(e.matricesIndices._updatable=!0)),this.isVerticesDataPresent(x.MatricesWeightsKind)&&(e.matricesWeights=this._toNumberArray(this.getVerticesData(x.MatricesWeightsKind)),this.isVertexBufferUpdatable(x.MatricesWeightsKind)&&(e.matricesWeights._updatable=!0)),e.indices=this._toNumberArray(this.getIndices()),e}static ExtractFromMesh(e,t){const i=e._geometry;return i?i.copy(t):null}static RandomId(){return X.RandomId()}static _GetGeometryByLoadedUniqueId(e,t){for(let i=0;i<t.geometries.length;i++)if(t.geometries[i]._loadedUniqueId===e)return t.geometries[i];return null}static _ImportGeometry(e,t){const i=t.getScene(),r=e.geometryUniqueId,s=e.geometryId;if(r||s){const a=r?this._GetGeometryByLoadedUniqueId(r,i):i.getGeometryById(s);a&&a.applyToMesh(t)}else if(e instanceof ArrayBuffer){const a=t._binaryInfo;if(a.positionsAttrDesc&&a.positionsAttrDesc.count>0){const l=new Float32Array(e,a.positionsAttrDesc.offset,a.positionsAttrDesc.count);t.setVerticesData(x.PositionKind,l,!1)}if(a.normalsAttrDesc&&a.normalsAttrDesc.count>0){const l=new Float32Array(e,a.normalsAttrDesc.offset,a.normalsAttrDesc.count);t.setVerticesData(x.NormalKind,l,!1)}if(a.tangetsAttrDesc&&a.tangetsAttrDesc.count>0){const l=new Float32Array(e,a.tangetsAttrDesc.offset,a.tangetsAttrDesc.count);t.setVerticesData(x.TangentKind,l,!1)}if(a.uvsAttrDesc&&a.uvsAttrDesc.count>0){const l=new Float32Array(e,a.uvsAttrDesc.offset,a.uvsAttrDesc.count);if(As.UseOpenGLOrientationForUV)for(let o=1;o<l.length;o+=2)l[o]=1-l[o];t.setVerticesData(x.UVKind,l,!1)}if(a.uvs2AttrDesc&&a.uvs2AttrDesc.count>0){const l=new Float32Array(e,a.uvs2AttrDesc.offset,a.uvs2AttrDesc.count);if(As.UseOpenGLOrientationForUV)for(let o=1;o<l.length;o+=2)l[o]=1-l[o];t.setVerticesData(x.UV2Kind,l,!1)}if(a.uvs3AttrDesc&&a.uvs3AttrDesc.count>0){const l=new Float32Array(e,a.uvs3AttrDesc.offset,a.uvs3AttrDesc.count);if(As.UseOpenGLOrientationForUV)for(let o=1;o<l.length;o+=2)l[o]=1-l[o];t.setVerticesData(x.UV3Kind,l,!1)}if(a.uvs4AttrDesc&&a.uvs4AttrDesc.count>0){const l=new Float32Array(e,a.uvs4AttrDesc.offset,a.uvs4AttrDesc.count);if(As.UseOpenGLOrientationForUV)for(let o=1;o<l.length;o+=2)l[o]=1-l[o];t.setVerticesData(x.UV4Kind,l,!1)}if(a.uvs5AttrDesc&&a.uvs5AttrDesc.count>0){const l=new Float32Array(e,a.uvs5AttrDesc.offset,a.uvs5AttrDesc.count);if(As.UseOpenGLOrientationForUV)for(let o=1;o<l.length;o+=2)l[o]=1-l[o];t.setVerticesData(x.UV5Kind,l,!1)}if(a.uvs6AttrDesc&&a.uvs6AttrDesc.count>0){const l=new Float32Array(e,a.uvs6AttrDesc.offset,a.uvs6AttrDesc.count);if(As.UseOpenGLOrientationForUV)for(let o=1;o<l.length;o+=2)l[o]=1-l[o];t.setVerticesData(x.UV6Kind,l,!1)}if(a.colorsAttrDesc&&a.colorsAttrDesc.count>0){const l=new Float32Array(e,a.colorsAttrDesc.offset,a.colorsAttrDesc.count);t.setVerticesData(x.ColorKind,l,!1,a.colorsAttrDesc.stride)}if(a.matricesIndicesAttrDesc&&a.matricesIndicesAttrDesc.count>0){const l=new Int32Array(e,a.matricesIndicesAttrDesc.offset,a.matricesIndicesAttrDesc.count),o=[];for(let c=0;c<l.length;c++){const u=l[c];o.push(u&255),o.push((u&65280)>>8),o.push((u&16711680)>>16),o.push(u>>24&255)}t.setVerticesData(x.MatricesIndicesKind,o,!1)}if(a.matricesIndicesExtraAttrDesc&&a.matricesIndicesExtraAttrDesc.count>0){const l=new Int32Array(e,a.matricesIndicesExtraAttrDesc.offset,a.matricesIndicesExtraAttrDesc.count),o=[];for(let c=0;c<l.length;c++){const u=l[c];o.push(u&255),o.push((u&65280)>>8),o.push((u&16711680)>>16),o.push(u>>24&255)}t.setVerticesData(x.MatricesIndicesExtraKind,o,!1)}if(a.matricesWeightsAttrDesc&&a.matricesWeightsAttrDesc.count>0){const l=new Float32Array(e,a.matricesWeightsAttrDesc.offset,a.matricesWeightsAttrDesc.count);t.setVerticesData(x.MatricesWeightsKind,l,!1)}if(a.indicesAttrDesc&&a.indicesAttrDesc.count>0){const l=new Int32Array(e,a.indicesAttrDesc.offset,a.indicesAttrDesc.count);t.setIndices(l,null)}if(a.subMeshesAttrDesc&&a.subMeshesAttrDesc.count>0){const l=new Int32Array(e,a.subMeshesAttrDesc.offset,a.subMeshesAttrDesc.count*5);t.subMeshes=[];for(let o=0;o<a.subMeshesAttrDesc.count;o++){const c=l[o*5+0],u=l[o*5+1],h=l[o*5+2],d=l[o*5+3],f=l[o*5+4];pn.AddToMesh(c,u,h,d,f,t)}}}else if(e.positions&&e.normals&&e.indices){if(t.setVerticesData(x.PositionKind,e.positions,e.positions._updatable),t.setVerticesData(x.NormalKind,e.normals,e.normals._updatable),e.tangents&&t.setVerticesData(x.TangentKind,e.tangents,e.tangents._updatable),e.uvs&&t.setVerticesData(x.UVKind,e.uvs,e.uvs._updatable),e.uvs2&&t.setVerticesData(x.UV2Kind,e.uvs2,e.uvs2._updatable),e.uvs3&&t.setVerticesData(x.UV3Kind,e.uvs3,e.uvs3._updatable),e.uvs4&&t.setVerticesData(x.UV4Kind,e.uvs4,e.uvs4._updatable),e.uvs5&&t.setVerticesData(x.UV5Kind,e.uvs5,e.uvs5._updatable),e.uvs6&&t.setVerticesData(x.UV6Kind,e.uvs6,e.uvs6._updatable),e.colors&&t.setVerticesData(x.ColorKind,et.CheckColors4(e.colors,e.positions.length/3),e.colors._updatable),e.matricesIndices)if(e.matricesIndices._isExpanded)delete e.matricesIndices._isExpanded,t.setVerticesData(x.MatricesIndicesKind,e.matricesIndices,e.matricesIndices._updatable);else{const a=[];for(let l=0;l<e.matricesIndices.length;l++){const o=e.matricesIndices[l];a.push(o&255),a.push((o&65280)>>8),a.push((o&16711680)>>16),a.push(o>>24&255)}t.setVerticesData(x.MatricesIndicesKind,a,e.matricesIndices._updatable)}if(e.matricesIndicesExtra)if(e.matricesIndicesExtra._isExpanded)delete e.matricesIndices._isExpanded,t.setVerticesData(x.MatricesIndicesExtraKind,e.matricesIndicesExtra,e.matricesIndicesExtra._updatable);else{const a=[];for(let l=0;l<e.matricesIndicesExtra.length;l++){const o=e.matricesIndicesExtra[l];a.push(o&255),a.push((o&65280)>>8),a.push((o&16711680)>>16),a.push(o>>24&255)}t.setVerticesData(x.MatricesIndicesExtraKind,a,e.matricesIndicesExtra._updatable)}e.matricesWeights&&(rr._CleanMatricesWeights(e,t),t.setVerticesData(x.MatricesWeightsKind,e.matricesWeights,e.matricesWeights._updatable)),e.matricesWeightsExtra&&t.setVerticesData(x.MatricesWeightsExtraKind,e.matricesWeightsExtra,e.matricesWeights._updatable),t.setIndices(e.indices,null)}if(e.subMeshes){t.subMeshes=[];for(let a=0;a<e.subMeshes.length;a++){const l=e.subMeshes[a];pn.AddToMesh(l.materialIndex,l.verticesStart,l.verticesCount,l.indexStart,l.indexCount,t)}}t._shouldGenerateFlatShading&&(t.convertToFlatShadedMesh(),t._shouldGenerateFlatShading=!1),t.computeWorldMatrix(!0),i.onMeshImportedObservable.notifyObservers(t)}static _CleanMatricesWeights(e,t){if(!Ei.CleanBoneMatrixWeights)return;let r=0;if(e.skeletonId>-1){const h=t.getScene().getLastSkeletonById(e.skeletonId);if(!h)return;r=h.bones.length}else return;const s=t.getVerticesData(x.MatricesIndicesKind),a=t.getVerticesData(x.MatricesIndicesExtraKind),l=e.matricesWeights,o=e.matricesWeightsExtra,c=e.numBoneInfluencer,u=l.length;for(let h=0;h<u;h+=4){let d=0,f=-1;for(let _=0;_<4;_++){const p=l[h+_];d+=p,p<.001&&f<0&&(f=_)}if(o)for(let _=0;_<4;_++){const p=o[h+_];d+=p,p<.001&&f<0&&(f=_+4)}if((f<0||f>c-1)&&(f=c-1),d>.001){const _=1/d;for(let p=0;p<4;p++)l[h+p]*=_;if(o)for(let p=0;p<4;p++)o[h+p]*=_}else f>=4?(o[h+f-4]=1-d,a[h+f-4]=r):(l[h+f]=1-d,s[h+f]=r)}t.setVerticesData(x.MatricesIndicesKind,s),e.matricesWeightsExtra&&t.setVerticesData(x.MatricesIndicesExtraKind,a)}static Parse(e,t,i){const r=new rr(e.id,t,void 0,e.updatable);return r._loadedUniqueId=e.uniqueId,ct&&ct.AddTagsTo(r,e.tags),e.delayLoadingFile?(r.delayLoadState=4,r.delayLoadingFile=i+e.delayLoadingFile,r._boundingInfo=new Zr(A.FromArray(e.boundingBoxMinimum),A.FromArray(e.boundingBoxMaximum)),r._delayInfo=[],e.hasUVs&&r._delayInfo.push(x.UVKind),e.hasUVs2&&r._delayInfo.push(x.UV2Kind),e.hasUVs3&&r._delayInfo.push(x.UV3Kind),e.hasUVs4&&r._delayInfo.push(x.UV4Kind),e.hasUVs5&&r._delayInfo.push(x.UV5Kind),e.hasUVs6&&r._delayInfo.push(x.UV6Kind),e.hasColors&&r._delayInfo.push(x.ColorKind),e.hasMatricesIndices&&r._delayInfo.push(x.MatricesIndicesKind),e.hasMatricesWeights&&r._delayInfo.push(x.MatricesWeightsKind),r._delayLoadingFunction=Ue.ImportVertexData):Ue.ImportVertexData(e,r),t.pushGeometry(r,!0),r}}var bs;(function(n){n[n.LOCAL=0]="LOCAL",n[n.WORLD=1]="WORLD",n[n.BONE=2]="BONE"})(bs||(bs={}));class Ro{}Ro.X=new A(1,0,0);Ro.Y=new A(0,1,0);Ro.Z=new A(0,0,1);var uo;(function(n){n[n.X=0]="X",n[n.Y=1]="Y",n[n.Z=2]="Z"})(uo||(uo={}));const YN=z.Compose(A.One(),ue.FromEulerAngles(0,Math.PI,0),A.Zero());class Ne extends Mi{get billboardMode(){return this._billboardMode}set billboardMode(e){this._billboardMode!==e&&(this._billboardMode=e,this._cache.useBillboardPosition=(this._billboardMode&Ne.BILLBOARDMODE_USE_POSITION)!==0,this._computeUseBillboardPath())}get preserveParentRotationForBillboard(){return this._preserveParentRotationForBillboard}set preserveParentRotationForBillboard(e){e!==this._preserveParentRotationForBillboard&&(this._preserveParentRotationForBillboard=e,this._computeUseBillboardPath())}_computeUseBillboardPath(){this._cache.useBillboardPath=this._billboardMode!==Ne.BILLBOARDMODE_NONE&&!this.preserveParentRotationForBillboard}get infiniteDistance(){return this._infiniteDistance}set infiniteDistance(e){this._infiniteDistance!==e&&(this._infiniteDistance=e)}constructor(e,t=null,i=!0){super(e,t),this._forward=new A(0,0,1),this._up=new A(0,1,0),this._right=new A(1,0,0),this._position=A.Zero(),this._rotation=A.Zero(),this._rotationQuaternion=null,this._scaling=A.One(),this._transformToBoneReferal=null,this._isAbsoluteSynced=!1,this._billboardMode=Ne.BILLBOARDMODE_NONE,this._preserveParentRotationForBillboard=!1,this.scalingDeterminant=1,this._infiniteDistance=!1,this.ignoreNonUniformScaling=!1,this.reIntegrateRotationIntoRotationQuaternion=!1,this._poseMatrix=null,this._localMatrix=z.Zero(),this._usePivotMatrix=!1,this._absolutePosition=A.Zero(),this._absoluteScaling=A.Zero(),this._absoluteRotationQuaternion=ue.Identity(),this._pivotMatrix=z.Identity(),this._postMultiplyPivotMatrix=!1,this._isWorldMatrixFrozen=!1,this._indexInSceneTransformNodesArray=-1,this.onAfterWorldMatrixUpdateObservable=new Y,this._nonUniformScaling=!1,i&&this.getScene().addTransformNode(this)}getClassName(){return"TransformNode"}get position(){return this._position}set position(e){this._position=e,this._isDirty=!0}isUsingPivotMatrix(){return this._usePivotMatrix}isUsingPostMultiplyPivotMatrix(){return this._postMultiplyPivotMatrix}get rotation(){return this._rotation}set rotation(e){this._rotation=e,this._rotationQuaternion=null,this._isDirty=!0}get scaling(){return this._scaling}set scaling(e){this._scaling=e,this._isDirty=!0}get rotationQuaternion(){return this._rotationQuaternion}set rotationQuaternion(e){this._rotationQuaternion=e,e&&this._rotation.setAll(0),this._isDirty=!0}get forward(){return A.TransformNormalFromFloatsToRef(0,0,this.getScene().useRightHandedSystem?-1:1,this.getWorldMatrix(),this._forward),this._forward.normalize()}get up(){return A.TransformNormalFromFloatsToRef(0,1,0,this.getWorldMatrix(),this._up),this._up.normalize()}get right(){return A.TransformNormalFromFloatsToRef(this.getScene().useRightHandedSystem?-1:1,0,0,this.getWorldMatrix(),this._right),this._right.normalize()}updatePoseMatrix(e){return this._poseMatrix?(this._poseMatrix.copyFrom(e),this):(this._poseMatrix=e.clone(),this)}getPoseMatrix(){return this._poseMatrix||(this._poseMatrix=z.Identity()),this._poseMatrix}_isSynchronized(){const e=this._cache;return!(this._billboardMode!==e.billboardMode||this._billboardMode!==Ne.BILLBOARDMODE_NONE||e.pivotMatrixUpdated||this._infiniteDistance||this._position._isDirty||this._scaling._isDirty||this._rotationQuaternion&&this._rotationQuaternion._isDirty||this._rotation._isDirty)}_initCache(){super._initCache();const e=this._cache;e.localMatrixUpdated=!1,e.billboardMode=-1,e.infiniteDistance=!1,e.useBillboardPosition=!1,e.useBillboardPath=!1}get absolutePosition(){return this.getAbsolutePosition()}get absoluteScaling(){return this._syncAbsoluteScalingAndRotation(),this._absoluteScaling}get absoluteRotationQuaternion(){return this._syncAbsoluteScalingAndRotation(),this._absoluteRotationQuaternion}setPreTransformMatrix(e){return this.setPivotMatrix(e,!1)}setPivotMatrix(e,t=!0){return this._pivotMatrix.copyFrom(e),this._usePivotMatrix=!this._pivotMatrix.isIdentity(),this._cache.pivotMatrixUpdated=!0,this._postMultiplyPivotMatrix=t,this._postMultiplyPivotMatrix&&(this._pivotMatrixInverse?this._pivotMatrix.invertToRef(this._pivotMatrixInverse):this._pivotMatrixInverse=z.Invert(this._pivotMatrix)),this}getPivotMatrix(){return this._pivotMatrix}instantiateHierarchy(e=null,t,i){const r=this.clone("Clone of "+(this.name||this.id),e||this.parent,!0);r&&i&&i(this,r);for(const s of this.getChildTransformNodes(!0))s.instantiateHierarchy(r,t,i);return r}freezeWorldMatrix(e=null,t=!1){return e?t?(this._rotation.setAll(0),this._rotationQuaternion=this._rotationQuaternion||ue.Identity(),e.decompose(this._scaling,this._rotationQuaternion,this._position),this.computeWorldMatrix(!0)):(this._worldMatrix=e,this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this._afterComputeWorldMatrix()):(this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0)),this._isDirty=!1,this._isWorldMatrixFrozen=!0,this}unfreezeWorldMatrix(){return this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0),this}get isWorldMatrixFrozen(){return this._isWorldMatrixFrozen}getAbsolutePosition(){return this.computeWorldMatrix(),this._absolutePosition}setAbsolutePosition(e){if(!e)return this;let t,i,r;if(e.x===void 0){if(arguments.length<3)return this;t=arguments[0],i=arguments[1],r=arguments[2]}else t=e.x,i=e.y,r=e.z;if(this.parent){const s=V.Matrix[0];this.parent.getWorldMatrix().invertToRef(s),A.TransformCoordinatesFromFloatsToRef(t,i,r,s,this.position)}else this.position.x=t,this.position.y=i,this.position.z=r;return this._absolutePosition.copyFrom(e),this}setPositionWithLocalVector(e){return this.computeWorldMatrix(),this.position=A.TransformNormal(e,this._localMatrix),this}getPositionExpressedInLocalSpace(){this.computeWorldMatrix();const e=V.Matrix[0];return this._localMatrix.invertToRef(e),A.TransformNormal(this.position,e)}locallyTranslate(e){return this.computeWorldMatrix(!0),this.position=A.TransformCoordinates(e,this._localMatrix),this}lookAt(e,t=0,i=0,r=0,s=bs.LOCAL){const a=Ne._LookAtVectorCache,l=s===bs.LOCAL?this.position:this.getAbsolutePosition();if(e.subtractToRef(l,a),this.setDirection(a,t,i,r),s===bs.WORLD&&this.parent)if(this.rotationQuaternion){const o=V.Matrix[0];this.rotationQuaternion.toRotationMatrix(o);const c=V.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(c),c.invert(),o.multiplyToRef(c,o),this.rotationQuaternion.fromRotationMatrix(o)}else{const o=V.Quaternion[0];ue.FromEulerVectorToRef(this.rotation,o);const c=V.Matrix[0];o.toRotationMatrix(c);const u=V.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(u),u.invert(),c.multiplyToRef(u,c),o.fromRotationMatrix(c),o.toEulerAnglesToRef(this.rotation)}return this}getDirection(e){const t=A.Zero();return this.getDirectionToRef(e,t),t}getDirectionToRef(e,t){return A.TransformNormalToRef(e,this.getWorldMatrix(),t),this}setDirection(e,t=0,i=0,r=0){const s=-Math.atan2(e.z,e.x)+Math.PI/2,a=Math.sqrt(e.x*e.x+e.z*e.z),l=-Math.atan2(e.y,a);return this.rotationQuaternion?ue.RotationYawPitchRollToRef(s+t,l+i,r,this.rotationQuaternion):(this.rotation.x=l+i,this.rotation.y=s+t,this.rotation.z=r),this}setPivotPoint(e,t=bs.LOCAL){this.getScene().getRenderId()==0&&this.computeWorldMatrix(!0);const i=this.getWorldMatrix();if(t==bs.WORLD){const r=V.Matrix[0];i.invertToRef(r),e=A.TransformCoordinates(e,r)}return this.setPivotMatrix(z.Translation(-e.x,-e.y,-e.z),!0)}getPivotPoint(){const e=A.Zero();return this.getPivotPointToRef(e),e}getPivotPointToRef(e){return e.x=-this._pivotMatrix.m[12],e.y=-this._pivotMatrix.m[13],e.z=-this._pivotMatrix.m[14],this}getAbsolutePivotPoint(){const e=A.Zero();return this.getAbsolutePivotPointToRef(e),e}getAbsolutePivotPointToRef(e){return this.getPivotPointToRef(e),A.TransformCoordinatesToRef(e,this.getWorldMatrix(),e),this}markAsDirty(e){if(this._isDirty)return this;if(this._children)for(const t of this._children)t.markAsDirty(e);return super.markAsDirty(e)}setParent(e,t=!1,i=!1){if(!e&&!this.parent)return this;const r=V.Quaternion[0],s=V.Vector3[0],a=V.Vector3[1],l=V.Matrix[1];z.IdentityToRef(l);const o=V.Matrix[0];this.computeWorldMatrix(!0);let c=this.rotationQuaternion;return c||(c=Ne._TmpRotation,ue.RotationYawPitchRollToRef(this._rotation.y,this._rotation.x,this._rotation.z,c)),z.ComposeToRef(this.scaling,c,this.position,o),this.parent&&o.multiplyToRef(this.parent.computeWorldMatrix(!0),o),e&&(e.computeWorldMatrix(!0).invertToRef(l),o.multiplyToRef(l,o)),o.decompose(a,r,s,t?this:void 0),this.rotationQuaternion?this.rotationQuaternion.copyFrom(r):r.toEulerAnglesToRef(this.rotation),this.scaling.copyFrom(a),this.position.copyFrom(s),this.parent=e,i&&this.setPivotMatrix(z.Identity()),this}get nonUniformScaling(){return this._nonUniformScaling}_updateNonUniformScalingState(e){return this._nonUniformScaling===e?!1:(this._nonUniformScaling=e,!0)}attachToBone(e,t){return this._currentParentWhenAttachingToBone=this.parent,this._transformToBoneReferal=t,this.parent=e,e.getSkeleton().prepare(!0),e.getFinalMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this}detachFromBone(e=!1){return this.parent?(this.parent.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this._transformToBoneReferal=null,e?this.parent=this._currentParentWhenAttachingToBone:this.parent=null,this):(e&&(this.parent=this._currentParentWhenAttachingToBone),this)}rotate(e,t,i){e.normalize(),this.rotationQuaternion||(this.rotationQuaternion=this.rotation.toQuaternion(),this.rotation.setAll(0));let r;if(!i||i===bs.LOCAL)r=ue.RotationAxisToRef(e,t,Ne._RotationAxisCache),this.rotationQuaternion.multiplyToRef(r,this.rotationQuaternion);else{if(this.parent){const s=this.parent.getWorldMatrix(),a=V.Matrix[0];s.invertToRef(a),e=A.TransformNormal(e,a),s.determinant()<0&&(t*=-1)}r=ue.RotationAxisToRef(e,t,Ne._RotationAxisCache),r.multiplyToRef(this.rotationQuaternion,this.rotationQuaternion)}return this}rotateAround(e,t,i){t.normalize(),this.rotationQuaternion||(this.rotationQuaternion=ue.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z),this.rotation.setAll(0));const r=V.Vector3[0],s=V.Vector3[1],a=V.Vector3[2],l=V.Quaternion[0],o=V.Matrix[0],c=V.Matrix[1],u=V.Matrix[2],h=V.Matrix[3];return e.subtractToRef(this.position,r),z.TranslationToRef(r.x,r.y,r.z,o),z.TranslationToRef(-r.x,-r.y,-r.z,c),z.RotationAxisToRef(t,i,u),c.multiplyToRef(u,h),h.multiplyToRef(o,h),h.decompose(s,l,a),this.position.addInPlace(a),l.multiplyToRef(this.rotationQuaternion,this.rotationQuaternion),this}translate(e,t,i){const r=e.scale(t);if(!i||i===bs.LOCAL){const s=this.getPositionExpressedInLocalSpace().add(r);this.setPositionWithLocalVector(s)}else this.setAbsolutePosition(this.getAbsolutePosition().add(r));return this}addRotation(e,t,i){let r;this.rotationQuaternion?r=this.rotationQuaternion:(r=V.Quaternion[1],ue.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,r));const s=V.Quaternion[0];return ue.RotationYawPitchRollToRef(t,e,i,s),r.multiplyInPlace(s),this.rotationQuaternion||r.toEulerAnglesToRef(this.rotation),this}_getEffectiveParent(){return this.parent}isWorldMatrixCameraDependent(){return this._infiniteDistance&&!this.parent||this._billboardMode!==Ne.BILLBOARDMODE_NONE&&!this.preserveParentRotationForBillboard}computeWorldMatrix(e=!1,t=null){if(this._isWorldMatrixFrozen&&!this._isDirty)return this._worldMatrix;const i=this.getScene().getRenderId();if(!this._isDirty&&!e&&(this._currentRenderId===i||this.isSynchronized()))return this._currentRenderId=i,this._worldMatrix;t=t||this.getScene().activeCamera,this._updateCache();const r=this._cache;r.pivotMatrixUpdated=!1,r.billboardMode=this.billboardMode,r.infiniteDistance=this.infiniteDistance,r.parent=this._parentNode,this._currentRenderId=i,this._childUpdateId+=1,this._isDirty=!1,this._position._isDirty=!1,this._rotation._isDirty=!1,this._scaling._isDirty=!1;const s=this._getEffectiveParent(),a=Ne._TmpScaling;let l=this._position;if(this._infiniteDistance&&!this.parent&&t){const c=t.getWorldMatrix(),u=new A(c.m[12],c.m[13],c.m[14]);l=Ne._TmpTranslation,l.copyFromFloats(this._position.x+u.x,this._position.y+u.y,this._position.z+u.z)}a.copyFromFloats(this._scaling.x*this.scalingDeterminant,this._scaling.y*this.scalingDeterminant,this._scaling.z*this.scalingDeterminant);let o;if(this._rotationQuaternion?(this._rotationQuaternion._isDirty=!1,o=this._rotationQuaternion,this.reIntegrateRotationIntoRotationQuaternion&&this.rotation.lengthSquared()&&(this._rotationQuaternion.multiplyInPlace(ue.RotationYawPitchRoll(this._rotation.y,this._rotation.x,this._rotation.z)),this._rotation.copyFromFloats(0,0,0))):(o=Ne._TmpRotation,ue.RotationYawPitchRollToRef(this._rotation.y,this._rotation.x,this._rotation.z,o)),this._usePivotMatrix){const c=V.Matrix[1];z.ScalingToRef(a.x,a.y,a.z,c);const u=V.Matrix[0];o.toRotationMatrix(u),this._pivotMatrix.multiplyToRef(c,V.Matrix[4]),V.Matrix[4].multiplyToRef(u,this._localMatrix),this._postMultiplyPivotMatrix&&this._localMatrix.multiplyToRef(this._pivotMatrixInverse,this._localMatrix),this._localMatrix.addTranslationFromFloats(l.x,l.y,l.z)}else z.ComposeToRef(a,o,l,this._localMatrix);if(s&&s.getWorldMatrix){if(e&&s.computeWorldMatrix(e),r.useBillboardPath){if(this._transformToBoneReferal){const d=this.parent;d.getSkeleton().prepare(),d.getFinalMatrix().multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),V.Matrix[7])}else V.Matrix[7].copyFrom(s.getWorldMatrix());const c=V.Vector3[5],u=V.Vector3[6],h=V.Quaternion[0];V.Matrix[7].decompose(u,h,c),z.ScalingToRef(u.x,u.y,u.z,V.Matrix[7]),V.Matrix[7].setTranslation(c),Ne.BillboardUseParentOrientation&&(this._position.applyRotationQuaternionToRef(h,c),this._localMatrix.setTranslation(c)),this._localMatrix.multiplyToRef(V.Matrix[7],this._worldMatrix)}else if(this._transformToBoneReferal){const c=this.parent;c.getSkeleton().prepare(),this._localMatrix.multiplyToRef(c.getFinalMatrix(),V.Matrix[6]),V.Matrix[6].multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),this._worldMatrix)}else this._localMatrix.multiplyToRef(s.getWorldMatrix(),this._worldMatrix);this._markSyncedWithParent()}else this._worldMatrix.copyFrom(this._localMatrix);if(r.useBillboardPath&&t&&this.billboardMode&&!r.useBillboardPosition){const c=V.Vector3[0];if(this._worldMatrix.getTranslationToRef(c),V.Matrix[1].copyFrom(t.getViewMatrix()),this._scene.useRightHandedSystem&&V.Matrix[1].multiplyToRef(YN,V.Matrix[1]),V.Matrix[1].setTranslationFromFloats(0,0,0),V.Matrix[1].invertToRef(V.Matrix[0]),(this.billboardMode&Ne.BILLBOARDMODE_ALL)!==Ne.BILLBOARDMODE_ALL){V.Matrix[0].decompose(void 0,V.Quaternion[0],void 0);const u=V.Vector3[1];V.Quaternion[0].toEulerAnglesToRef(u),(this.billboardMode&Ne.BILLBOARDMODE_X)!==Ne.BILLBOARDMODE_X&&(u.x=0),(this.billboardMode&Ne.BILLBOARDMODE_Y)!==Ne.BILLBOARDMODE_Y&&(u.y=0),(this.billboardMode&Ne.BILLBOARDMODE_Z)!==Ne.BILLBOARDMODE_Z&&(u.z=0),z.RotationYawPitchRollToRef(u.y,u.x,u.z,V.Matrix[0])}this._worldMatrix.setTranslationFromFloats(0,0,0),this._worldMatrix.multiplyToRef(V.Matrix[0],this._worldMatrix),this._worldMatrix.setTranslation(V.Vector3[0])}else if(r.useBillboardPath&&t&&r.useBillboardPosition){const c=V.Vector3[0];this._worldMatrix.getTranslationToRef(c);const u=t.globalPosition;this._worldMatrix.invertToRef(V.Matrix[1]);const h=V.Vector3[1];A.TransformCoordinatesToRef(u,V.Matrix[1],h),h.normalize();const d=-Math.atan2(h.z,h.x)+Math.PI/2,f=Math.sqrt(h.x*h.x+h.z*h.z),_=-Math.atan2(h.y,f);if(ue.RotationYawPitchRollToRef(d,_,0,V.Quaternion[0]),(this.billboardMode&Ne.BILLBOARDMODE_ALL)!==Ne.BILLBOARDMODE_ALL){const p=V.Vector3[1];V.Quaternion[0].toEulerAnglesToRef(p),(this.billboardMode&Ne.BILLBOARDMODE_X)!==Ne.BILLBOARDMODE_X&&(p.x=0),(this.billboardMode&Ne.BILLBOARDMODE_Y)!==Ne.BILLBOARDMODE_Y&&(p.y=0),(this.billboardMode&Ne.BILLBOARDMODE_Z)!==Ne.BILLBOARDMODE_Z&&(p.z=0),z.RotationYawPitchRollToRef(p.y,p.x,p.z,V.Matrix[0])}else z.FromQuaternionToRef(V.Quaternion[0],V.Matrix[0]);this._worldMatrix.setTranslationFromFloats(0,0,0),this._worldMatrix.multiplyToRef(V.Matrix[0],this._worldMatrix),this._worldMatrix.setTranslation(V.Vector3[0])}return this.ignoreNonUniformScaling?this._updateNonUniformScalingState(!1):this._scaling.isNonUniformWithinEpsilon(1e-6)?this._updateNonUniformScalingState(!0):s&&s._nonUniformScaling?this._updateNonUniformScalingState(s._nonUniformScaling):this._updateNonUniformScalingState(!1),this._afterComputeWorldMatrix(),this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this._isAbsoluteSynced=!1,this.onAfterWorldMatrixUpdateObservable.notifyObservers(this),this._poseMatrix||(this._poseMatrix=z.Invert(this._worldMatrix)),this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix}resetLocalMatrix(e=!0){if(this.computeWorldMatrix(),e){const t=this.getChildren();for(let i=0;i<t.length;++i){const r=t[i];if(r){r.computeWorldMatrix();const s=V.Matrix[0];r._localMatrix.multiplyToRef(this._localMatrix,s);const a=V.Quaternion[0];s.decompose(r.scaling,a,r.position),r.rotationQuaternion?r.rotationQuaternion.copyFrom(a):a.toEulerAnglesToRef(r.rotation)}}}this.scaling.copyFromFloats(1,1,1),this.position.copyFromFloats(0,0,0),this.rotation.copyFromFloats(0,0,0),this.rotationQuaternion&&(this.rotationQuaternion=ue.Identity()),this._worldMatrix=z.Identity()}_afterComputeWorldMatrix(){}registerAfterWorldMatrixUpdate(e){return this.onAfterWorldMatrixUpdateObservable.add(e),this}unregisterAfterWorldMatrixUpdate(e){return this.onAfterWorldMatrixUpdateObservable.removeCallback(e),this}getPositionInCameraSpace(e=null){return e||(e=this.getScene().activeCamera),A.TransformCoordinates(this.getAbsolutePosition(),e.getViewMatrix())}getDistanceToCamera(e=null){return e||(e=this.getScene().activeCamera),this.getAbsolutePosition().subtract(e.globalPosition).length()}clone(e,t,i){const r=Fe.Clone(()=>new Ne(e,this.getScene()),this);if(r.name=e,r.id=e,t&&(r.parent=t),!i){const s=this.getDescendants(!0);for(let a=0;a<s.length;a++){const l=s[a];l.clone&&l.clone(e+"."+l.name,r)}}return r}serialize(e){const t=Fe.Serialize(this,e);return t.type=this.getClassName(),t.uniqueId=this.uniqueId,this.parent&&this.parent._serializeAsParent(t),t.localMatrix=this.getPivotMatrix().asArray(),t.isEnabled=this.isEnabled(),Fe.AppendSerializedAnimations(this,t),t.ranges=this.serializeAnimationRanges(),t}static Parse(e,t,i){const r=Fe.Parse(()=>new Ne(e.name,t),e,t,i);if(e.localMatrix?r.setPreTransformMatrix(z.FromArray(e.localMatrix)):e.pivotMatrix&&r.setPivotMatrix(z.FromArray(e.pivotMatrix)),r.setEnabled(e.isEnabled),r._waitingParsedUniqueId=e.uniqueId,e.parentId!==void 0&&(r._waitingParentId=e.parentId),e.parentInstanceIndex!==void 0&&(r._waitingParentInstanceIndex=e.parentInstanceIndex),e.animations){for(let s=0;s<e.animations.length;s++){const a=e.animations[s],l=Bn("BABYLON.Animation");l&&r.animations.push(l.Parse(a))}Mi.ParseAnimationRanges(r,e,t)}return e.autoAnimate&&t.beginAnimation(r,e.autoAnimateFrom,e.autoAnimateTo,e.autoAnimateLoop,e.autoAnimateSpeed||1),r}getChildTransformNodes(e,t){const i=[];return this._getDescendants(i,e,r=>(!t||t(r))&&r instanceof Ne),i}dispose(e,t=!1){if(this.getScene().stopAnimation(this),this.getScene().removeTransformNode(this),this._parentContainer){const i=this._parentContainer.transformNodes.indexOf(this);i>-1&&this._parentContainer.transformNodes.splice(i,1),this._parentContainer=null}if(this.onAfterWorldMatrixUpdateObservable.clear(),e){const i=this.getChildTransformNodes(!0);for(const r of i)r.parent=null,r.computeWorldMatrix(!0)}super.dispose(e,t)}normalizeToUnitCube(e=!0,t=!1,i){let r=null,s=null;t&&(this.rotationQuaternion?(s=this.rotationQuaternion.clone(),this.rotationQuaternion.copyFromFloats(0,0,0,1)):this.rotation&&(r=this.rotation.clone(),this.rotation.copyFromFloats(0,0,0)));const a=this.getHierarchyBoundingVectors(e,i),l=a.max.subtract(a.min),o=Math.max(l.x,l.y,l.z);if(o===0)return this;const c=1/o;return this.scaling.scaleInPlace(c),t&&(this.rotationQuaternion&&s?this.rotationQuaternion.copyFrom(s):this.rotation&&r&&this.rotation.copyFrom(r)),this}_syncAbsoluteScalingAndRotation(){this._isAbsoluteSynced||(this._worldMatrix.decompose(this._absoluteScaling,this._absoluteRotationQuaternion),this._isAbsoluteSynced=!0)}}Ne.BILLBOARDMODE_NONE=0;Ne.BILLBOARDMODE_X=1;Ne.BILLBOARDMODE_Y=2;Ne.BILLBOARDMODE_Z=4;Ne.BILLBOARDMODE_ALL=7;Ne.BILLBOARDMODE_USE_POSITION=128;Ne.BillboardUseParentOrientation=!1;Ne._TmpRotation=ue.Zero();Ne._TmpScaling=A.Zero();Ne._TmpTranslation=A.Zero();Ne._LookAtVectorCache=new A(0,0,0);Ne._RotationAxisCache=new ue;R([Tn("position")],Ne.prototype,"_position",void 0);R([Tn("rotation")],Ne.prototype,"_rotation",void 0);R([IN("rotationQuaternion")],Ne.prototype,"_rotationQuaternion",void 0);R([Tn("scaling")],Ne.prototype,"_scaling",void 0);R([I("billboardMode")],Ne.prototype,"_billboardMode",void 0);R([I()],Ne.prototype,"scalingDeterminant",void 0);R([I("infiniteDistance")],Ne.prototype,"_infiniteDistance",void 0);R([I()],Ne.prototype,"ignoreNonUniformScaling",void 0);R([I()],Ne.prototype,"reIntegrateRotationIntoRotationQuaternion",void 0);class KN{constructor(){this._checkCollisions=!1,this._collisionMask=-1,this._collisionGroup=-1,this._surroundingMeshes=null,this._collider=null,this._oldPositionForCollisions=new A(0,0,0),this._diffPositionForCollisions=new A(0,0,0),this._collisionResponse=!0}}class qN{constructor(){this.facetNb=0,this.partitioningSubdivisions=10,this.partitioningBBoxRatio=1.01,this.facetDataEnabled=!1,this.facetParameters={},this.bbSize=A.Zero(),this.subDiv={max:1,X:1,Y:1,Z:1},this.facetDepthSort=!1,this.facetDepthSortEnabled=!1}}class $N{constructor(){this._hasVertexAlpha=!1,this._useVertexColors=!0,this._numBoneInfluencers=4,this._applyFog=!0,this._receiveShadows=!1,this._facetData=new qN,this._visibility=1,this._skeleton=null,this._layerMask=268435455,this._computeBonesUsingShaders=!0,this._isActive=!1,this._onlyForInstances=!1,this._isActiveIntermediate=!1,this._onlyForInstancesIntermediate=!1,this._actAsRegularMesh=!1,this._currentLOD=null,this._currentLODIsUpToDate=!1,this._collisionRetryCount=3,this._morphTargetManager=null,this._renderingGroupId=0,this._bakedVertexAnimationManager=null,this._material=null,this._positions=null,this._pointerOverDisableMeshTesting=!1,this._meshCollisionData=new KN,this._enableDistantPicking=!1,this._rawBoundingInfo=null}}class yr extends Ne{static get BILLBOARDMODE_NONE(){return Ne.BILLBOARDMODE_NONE}static get BILLBOARDMODE_X(){return Ne.BILLBOARDMODE_X}static get BILLBOARDMODE_Y(){return Ne.BILLBOARDMODE_Y}static get BILLBOARDMODE_Z(){return Ne.BILLBOARDMODE_Z}static get BILLBOARDMODE_ALL(){return Ne.BILLBOARDMODE_ALL}static get BILLBOARDMODE_USE_POSITION(){return Ne.BILLBOARDMODE_USE_POSITION}get facetNb(){return this._internalAbstractMeshDataInfo._facetData.facetNb}get partitioningSubdivisions(){return this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions}set partitioningSubdivisions(e){this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions=e}get partitioningBBoxRatio(){return this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio}set partitioningBBoxRatio(e){this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio=e}get mustDepthSortFacets(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSort}set mustDepthSortFacets(e){this._internalAbstractMeshDataInfo._facetData.facetDepthSort=e}get facetDepthSortFrom(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom}set facetDepthSortFrom(e){this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom=e}get collisionRetryCount(){return this._internalAbstractMeshDataInfo._collisionRetryCount}set collisionRetryCount(e){this._internalAbstractMeshDataInfo._collisionRetryCount=e}get isFacetDataEnabled(){return this._internalAbstractMeshDataInfo._facetData.facetDataEnabled}get morphTargetManager(){return this._internalAbstractMeshDataInfo._morphTargetManager}set morphTargetManager(e){this._internalAbstractMeshDataInfo._morphTargetManager!==e&&(this._internalAbstractMeshDataInfo._morphTargetManager=e,this._syncGeometryWithMorphTargetManager())}get bakedVertexAnimationManager(){return this._internalAbstractMeshDataInfo._bakedVertexAnimationManager}set bakedVertexAnimationManager(e){this._internalAbstractMeshDataInfo._bakedVertexAnimationManager!==e&&(this._internalAbstractMeshDataInfo._bakedVertexAnimationManager=e,this._markSubMeshesAsAttributesDirty())}_syncGeometryWithMorphTargetManager(){}_updateNonUniformScalingState(e){return super._updateNonUniformScalingState(e)?(this._markSubMeshesAsMiscDirty(),!0):!1}get rawBoundingInfo(){return this._internalAbstractMeshDataInfo._rawBoundingInfo}set rawBoundingInfo(e){this._internalAbstractMeshDataInfo._rawBoundingInfo=e}set onCollide(e){this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver&&this.onCollideObservable.remove(this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver),this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver=this.onCollideObservable.add(e)}set onCollisionPositionChange(e){this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver&&this.onCollisionPositionChangeObservable.remove(this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver),this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver=this.onCollisionPositionChangeObservable.add(e)}get visibility(){return this._internalAbstractMeshDataInfo._visibility}set visibility(e){if(this._internalAbstractMeshDataInfo._visibility===e)return;const t=this._internalAbstractMeshDataInfo._visibility;this._internalAbstractMeshDataInfo._visibility=e,(t===1&&e!==1||t!==1&&e===1)&&this._markSubMeshesAsDirty(i=>{i.markAsMiscDirty(),i.markAsPrePassDirty()})}get pointerOverDisableMeshTesting(){return this._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting}set pointerOverDisableMeshTesting(e){this._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting=e}get renderingGroupId(){return this._internalAbstractMeshDataInfo._renderingGroupId}set renderingGroupId(e){this._internalAbstractMeshDataInfo._renderingGroupId=e}get material(){return this._internalAbstractMeshDataInfo._material}set material(e){this._internalAbstractMeshDataInfo._material!==e&&(this._internalAbstractMeshDataInfo._material&&this._internalAbstractMeshDataInfo._material.meshMap&&(this._internalAbstractMeshDataInfo._material.meshMap[this.uniqueId]=void 0),this._internalAbstractMeshDataInfo._material=e,e&&e.meshMap&&(e.meshMap[this.uniqueId]=this),this.onMaterialChangedObservable.hasObservers()&&this.onMaterialChangedObservable.notifyObservers(this),this.subMeshes&&(this.resetDrawCache(),this._unBindEffect()))}getMaterialForRenderPass(e){var t;return(t=this._internalAbstractMeshDataInfo._materialForRenderPass)==null?void 0:t[e]}setMaterialForRenderPass(e,t){this.resetDrawCache(e),this._internalAbstractMeshDataInfo._materialForRenderPass||(this._internalAbstractMeshDataInfo._materialForRenderPass=[]),this._internalAbstractMeshDataInfo._materialForRenderPass[e]=t}get receiveShadows(){return this._internalAbstractMeshDataInfo._receiveShadows}set receiveShadows(e){this._internalAbstractMeshDataInfo._receiveShadows!==e&&(this._internalAbstractMeshDataInfo._receiveShadows=e,this._markSubMeshesAsLightDirty())}get hasVertexAlpha(){return this._internalAbstractMeshDataInfo._hasVertexAlpha}set hasVertexAlpha(e){this._internalAbstractMeshDataInfo._hasVertexAlpha!==e&&(this._internalAbstractMeshDataInfo._hasVertexAlpha=e,this._markSubMeshesAsAttributesDirty(),this._markSubMeshesAsMiscDirty())}get useVertexColors(){return this._internalAbstractMeshDataInfo._useVertexColors}set useVertexColors(e){this._internalAbstractMeshDataInfo._useVertexColors!==e&&(this._internalAbstractMeshDataInfo._useVertexColors=e,this._markSubMeshesAsAttributesDirty())}get computeBonesUsingShaders(){return this._internalAbstractMeshDataInfo._computeBonesUsingShaders}set computeBonesUsingShaders(e){this._internalAbstractMeshDataInfo._computeBonesUsingShaders!==e&&(this._internalAbstractMeshDataInfo._computeBonesUsingShaders=e,this._markSubMeshesAsAttributesDirty())}get numBoneInfluencers(){return this._internalAbstractMeshDataInfo._numBoneInfluencers}set numBoneInfluencers(e){this._internalAbstractMeshDataInfo._numBoneInfluencers!==e&&(this._internalAbstractMeshDataInfo._numBoneInfluencers=e,this._markSubMeshesAsAttributesDirty())}get applyFog(){return this._internalAbstractMeshDataInfo._applyFog}set applyFog(e){this._internalAbstractMeshDataInfo._applyFog!==e&&(this._internalAbstractMeshDataInfo._applyFog=e,this._markSubMeshesAsMiscDirty())}get enableDistantPicking(){return this._internalAbstractMeshDataInfo._enableDistantPicking}set enableDistantPicking(e){this._internalAbstractMeshDataInfo._enableDistantPicking=e}get layerMask(){return this._internalAbstractMeshDataInfo._layerMask}set layerMask(e){e!==this._internalAbstractMeshDataInfo._layerMask&&(this._internalAbstractMeshDataInfo._layerMask=e,this._resyncLightSources())}get collisionMask(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionMask}set collisionMask(e){this._internalAbstractMeshDataInfo._meshCollisionData._collisionMask=isNaN(e)?-1:e}get collisionResponse(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionResponse}set collisionResponse(e){this._internalAbstractMeshDataInfo._meshCollisionData._collisionResponse=e}get collisionGroup(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionGroup}set collisionGroup(e){this._internalAbstractMeshDataInfo._meshCollisionData._collisionGroup=isNaN(e)?-1:e}get surroundingMeshes(){return this._internalAbstractMeshDataInfo._meshCollisionData._surroundingMeshes}set surroundingMeshes(e){this._internalAbstractMeshDataInfo._meshCollisionData._surroundingMeshes=e}get lightSources(){return this._lightSources}get _positions(){return null}set skeleton(e){const t=this._internalAbstractMeshDataInfo._skeleton;t&&t.needInitialSkinMatrix&&t._unregisterMeshWithPoseMatrix(this),e&&e.needInitialSkinMatrix&&e._registerMeshWithPoseMatrix(this),this._internalAbstractMeshDataInfo._skeleton=e,this._internalAbstractMeshDataInfo._skeleton||(this._bonesTransformMatrices=null),this._markSubMeshesAsAttributesDirty()}get skeleton(){return this._internalAbstractMeshDataInfo._skeleton}constructor(e,t=null){switch(super(e,t,!1),this._internalAbstractMeshDataInfo=new $N,this._waitingMaterialId=null,this.cullingStrategy=yr.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY,this.onCollideObservable=new Y,this.onCollisionPositionChangeObservable=new Y,this.onMaterialChangedObservable=new Y,this.definedFacingForward=!0,this._occlusionQuery=null,this._renderingGroup=null,this.alphaIndex=Number.MAX_VALUE,this.isVisible=!0,this.isPickable=!0,this.isNearPickable=!1,this.isNearGrabbable=!1,this.showSubMeshesBoundingBox=!1,this.isBlocker=!1,this.enablePointerMoveEvents=!1,this.outlineColor=Pe.Red(),this.outlineWidth=.02,this.overlayColor=Pe.Red(),this.overlayAlpha=.5,this.useOctreeForRenderingSelection=!0,this.useOctreeForPicking=!0,this.useOctreeForCollisions=!0,this.alwaysSelectAsActiveMesh=!1,this.doNotSyncBoundingInfo=!1,this.actionManager=null,this.ellipsoid=new A(.5,1,.5),this.ellipsoidOffset=new A(0,0,0),this.edgesWidth=1,this.edgesColor=new et(1,0,0,1),this._edgesRenderer=null,this._masterMesh=null,this._boundingInfo=null,this._boundingInfoIsDirty=!0,this._renderId=0,this._intersectionsInProgress=new Array,this._unIndexed=!1,this._lightSources=new Array,this._waitingData={lods:null,actions:null,freezeWorldMatrix:null},this._bonesTransformMatrices=null,this._transformMatrixTexture=null,this.onRebuildObservable=new Y,this._onCollisionPositionChange=(i,r,s=null)=>{r.subtractToRef(this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions,this._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions),this._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions.length()>Z.CollisionsEpsilon&&this.position.addInPlace(this._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions),s&&this.onCollideObservable.notifyObservers(s),this.onCollisionPositionChangeObservable.notifyObservers(this.position)},t=this.getScene(),t.addMesh(this),this._resyncLightSources(),this._uniformBuffer=new me(this.getScene().getEngine(),void 0,void 0,e,!this.getScene().getEngine().isWebGPU),this._buildUniformLayout(),t.performancePriority){case ns.Aggressive:this.doNotSyncBoundingInfo=!0;case ns.Intermediate:this.alwaysSelectAsActiveMesh=!0,this.isPickable=!1;break}}_buildUniformLayout(){this._uniformBuffer.addUniform("world",16),this._uniformBuffer.addUniform("visibility",1),this._uniformBuffer.create()}transferToEffect(e){const t=this._uniformBuffer;t.updateMatrix("world",e),t.updateFloat("visibility",this._internalAbstractMeshDataInfo._visibility),t.update()}getMeshUniformBuffer(){return this._uniformBuffer}getClassName(){return"AbstractMesh"}toString(e){let t="Name: "+this.name+", isInstance: "+(this.getClassName()!=="InstancedMesh"?"YES":"NO");t+=", # of submeshes: "+(this.subMeshes?this.subMeshes.length:0);const i=this._internalAbstractMeshDataInfo._skeleton;return i&&(t+=", skeleton: "+i.name),e&&(t+=", billboard mode: "+["NONE","X","Y",null,"Z",null,null,"ALL"][this.billboardMode],t+=", freeze wrld mat: "+(this._isWorldMatrixFrozen||this._waitingData.freezeWorldMatrix?"YES":"NO")),t}_getEffectiveParent(){return this._masterMesh&&this.billboardMode!==Ne.BILLBOARDMODE_NONE?this._masterMesh:super._getEffectiveParent()}_getActionManagerForTrigger(e,t=!0){if(this.actionManager&&(t||this.actionManager.isRecursive))if(e){if(this.actionManager.hasSpecificTrigger(e))return this.actionManager}else return this.actionManager;return this.parent?this.parent._getActionManagerForTrigger(e,!1):null}_rebuild(e=!1){if(this.onRebuildObservable.notifyObservers(this),this._occlusionQuery!==null&&(this._occlusionQuery=null),!!this.subMeshes){for(const t of this.subMeshes)t._rebuild();this.resetDrawCache()}}_resyncLightSources(){this._lightSources.length=0;for(const e of this.getScene().lights)e.isEnabled()&&e.canAffectMesh(this)&&this._lightSources.push(e);this._markSubMeshesAsLightDirty()}_resyncLightSource(e){const t=e.isEnabled()&&e.canAffectMesh(this),i=this._lightSources.indexOf(e);let r=!1;if(i===-1){if(!t)return;this._lightSources.push(e)}else{if(t)return;r=!0,this._lightSources.splice(i,1)}this._markSubMeshesAsLightDirty(r)}_unBindEffect(){for(const e of this.subMeshes)e.setEffect(null)}_removeLightSource(e,t){const i=this._lightSources.indexOf(e);i!==-1&&(this._lightSources.splice(i,1),this._markSubMeshesAsLightDirty(t))}_markSubMeshesAsDirty(e){if(this.subMeshes)for(const t of this.subMeshes)for(let i=0;i<t._drawWrappers.length;++i){const r=t._drawWrappers[i];!r||!r.defines||!r.defines.markAllAsDirty||e(r.defines)}}_markSubMeshesAsLightDirty(e=!1){this._markSubMeshesAsDirty(t=>t.markAsLightDirty(e))}_markSubMeshesAsAttributesDirty(){this._markSubMeshesAsDirty(e=>e.markAsAttributesDirty())}_markSubMeshesAsMiscDirty(){this._markSubMeshesAsDirty(e=>e.markAsMiscDirty())}markAsDirty(e){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this}resetDrawCache(e){if(this.subMeshes)for(const t of this.subMeshes)t.resetDrawCache(e)}get isBlocked(){return!1}getLOD(e){return this}getTotalVertices(){return 0}getTotalIndices(){return 0}getIndices(){return null}getVerticesData(e){return null}setVerticesData(e,t,i,r){return this}updateVerticesData(e,t,i,r){return this}setIndices(e,t){return this}isVerticesDataPresent(e){return!1}getBoundingInfo(){return this._masterMesh?this._masterMesh.getBoundingInfo():(this._boundingInfoIsDirty&&(this._boundingInfoIsDirty=!1,this._updateBoundingInfo()),this._boundingInfo)}getRawBoundingInfo(){return this.rawBoundingInfo??this.getBoundingInfo()}setBoundingInfo(e){return this._boundingInfo=e,this}get hasBoundingInfo(){return this._boundingInfo!==null}buildBoundingInfo(e,t,i){return this._boundingInfo=new Zr(e,t,i),this._boundingInfo}normalizeToUnitCube(e=!0,t=!1,i){return super.normalizeToUnitCube(e,t,i)}get useBones(){return this.skeleton&&this.getScene().skeletonsEnabled&&this.isVerticesDataPresent(x.MatricesIndicesKind)&&this.isVerticesDataPresent(x.MatricesWeightsKind)}_preActivate(){}_preActivateForIntermediateRendering(e){}_activate(e,t){return this._renderId=e,!0}_postActivate(){}_freeze(){}_unFreeze(){}getWorldMatrix(){return this._masterMesh&&this.billboardMode===Ne.BILLBOARDMODE_NONE?this._masterMesh.getWorldMatrix():super.getWorldMatrix()}_getWorldMatrixDeterminant(){return this._masterMesh?this._masterMesh._getWorldMatrixDeterminant():super._getWorldMatrixDeterminant()}get isAnInstance(){return!1}get hasInstances(){return!1}get hasThinInstances(){return!1}movePOV(e,t,i){return this.position.addInPlace(this.calcMovePOV(e,t,i)),this}calcMovePOV(e,t,i){const r=new z;(this.rotationQuaternion?this.rotationQuaternion:ue.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z)).toRotationMatrix(r);const a=A.Zero(),l=this.definedFacingForward?-1:1;return A.TransformCoordinatesFromFloatsToRef(e*l,t,i*l,r,a),a}rotatePOV(e,t,i){return this.rotation.addInPlace(this.calcRotatePOV(e,t,i)),this}calcRotatePOV(e,t,i){const r=this.definedFacingForward?1:-1;return new A(e*r,t,i*r)}refreshBoundingInfo(e=!1,t=!1){return this._boundingInfo&&this._boundingInfo.isLocked?this:(this._refreshBoundingInfo(this._getPositionData(e,t),null),this)}_refreshBoundingInfo(e,t){if(e){const i=v1(e,0,this.getTotalVertices(),t);this._boundingInfo?this._boundingInfo.reConstruct(i.minimum,i.maximum):this._boundingInfo=new Zr(i.minimum,i.maximum)}if(this.subMeshes)for(let i=0;i<this.subMeshes.length;i++)this.subMeshes[i].refreshBoundingInfo(e);this._updateBoundingInfo()}_getData(e=!1,t=!1,i,r=x.PositionKind){if(i=i??this.getVerticesData(r).slice(),i&&t&&this.morphTargetManager){let s=0,a=0;for(let l=0;l<i.length;l++){let o=i[l];for(let c=0;c<this.morphTargetManager.numTargets;c++){const u=this.morphTargetManager.getTarget(c),h=u.influence;if(h!==0){let d=null;switch(r){case x.PositionKind:d=u.getPositions();break;case x.NormalKind:d=u.getNormals();break;case x.TangentKind:d=u.getTangents();break;case x.UVKind:d=u.getUVs();break}d&&(o+=(d[l]-i[l])*h)}}if(i[l]=o,s++,r===x.PositionKind&&this._positions&&s===3){s=0;const c=a*3;this._positions[a++].copyFromFloats(i[c],i[c+1],i[c+2])}}}if(i&&e&&this.skeleton){const s=this.getVerticesData(x.MatricesIndicesKind),a=this.getVerticesData(x.MatricesWeightsKind);if(a&&s){const l=this.numBoneInfluencers>4,o=l?this.getVerticesData(x.MatricesIndicesExtraKind):null,c=l?this.getVerticesData(x.MatricesWeightsExtraKind):null,u=this.skeleton.getTransformMatrices(this),h=V.Vector3[0],d=V.Matrix[0],f=V.Matrix[1];let _=0;for(let p=0;p<i.length;p+=3,_+=4){d.reset();let v,E;for(v=0;v<4;v++)E=a[_+v],E>0&&(z.FromFloat32ArrayToRefScaled(u,Math.floor(s[_+v]*16),E,f),d.addToSelf(f));if(l)for(v=0;v<4;v++)E=c[_+v],E>0&&(z.FromFloat32ArrayToRefScaled(u,Math.floor(o[_+v]*16),E,f),d.addToSelf(f));r===x.NormalKind?A.TransformNormalFromFloatsToRef(i[p],i[p+1],i[p+2],d,h):A.TransformCoordinatesFromFloatsToRef(i[p],i[p+1],i[p+2],d,h),h.toArray(i,p),r===x.PositionKind&&this._positions&&this._positions[p/3].copyFrom(h)}}}return i}getNormalsData(e=!1,t=!1){return this._getData(e,t,null,x.NormalKind)}getPositionData(e=!1,t=!1,i){return this._getData(e,t,i,x.PositionKind)}_getPositionData(e,t){var r;let i=this.getVerticesData(x.PositionKind);if(this._internalAbstractMeshDataInfo._positions&&(this._internalAbstractMeshDataInfo._positions=null),i&&(e&&this.skeleton||t&&this.morphTargetManager)){if(i=i.slice(),this._generatePointsArray(),this._positions){const s=this._positions;this._internalAbstractMeshDataInfo._positions=new Array(s.length);for(let a=0;a<s.length;a++)this._internalAbstractMeshDataInfo._positions[a]=((r=s[a])==null?void 0:r.clone())||new A}return this.getPositionData(e,t,i)}return i}_updateBoundingInfo(){return this._boundingInfo?this._boundingInfo.update(this.worldMatrixFromCache):this._boundingInfo=new Zr(A.Zero(),A.Zero(),this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache),this}_updateSubMeshesBoundingInfo(e){if(!this.subMeshes)return this;const t=this.subMeshes.length;for(let i=0;i<t;i++){const r=this.subMeshes[i];(t>1||!r.IsGlobal)&&r.updateBoundingInfo(e)}return this}_afterComputeWorldMatrix(){this.doNotSyncBoundingInfo||(this._boundingInfoIsDirty=!0)}isInFrustum(e){return this.getBoundingInfo().isInFrustum(e,this.cullingStrategy)}isCompletelyInFrustum(e){return this.getBoundingInfo().isCompletelyInFrustum(e)}intersectsMesh(e,t=!1,i){const r=this.getBoundingInfo(),s=e.getBoundingInfo();if(r.intersects(s,t))return!0;if(i){for(const a of this.getChildMeshes())if(a.intersectsMesh(e,t,!0))return!0}return!1}intersectsPoint(e){return this.getBoundingInfo().intersectsPoint(e)}get checkCollisions(){return this._internalAbstractMeshDataInfo._meshCollisionData._checkCollisions}set checkCollisions(e){this._internalAbstractMeshDataInfo._meshCollisionData._checkCollisions=e}get collider(){return this._internalAbstractMeshDataInfo._meshCollisionData._collider}moveWithCollisions(e){this.getAbsolutePosition().addToRef(this.ellipsoidOffset,this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions);const i=this.getScene().collisionCoordinator;return this._internalAbstractMeshDataInfo._meshCollisionData._collider||(this._internalAbstractMeshDataInfo._meshCollisionData._collider=i.createCollider()),this._internalAbstractMeshDataInfo._meshCollisionData._collider._radius=this.ellipsoid,i.getNewPosition(this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions,e,this._internalAbstractMeshDataInfo._meshCollisionData._collider,this.collisionRetryCount,this,this._onCollisionPositionChange,this.uniqueId),this}_collideForSubMesh(e,t,i){var r;if(this._generatePointsArray(),!this._positions)return this;if(!e._lastColliderWorldVertices||!e._lastColliderTransformMatrix.equals(t)){e._lastColliderTransformMatrix=t.clone(),e._lastColliderWorldVertices=[],e._trianglePlanes=[];const s=e.verticesStart,a=e.verticesStart+e.verticesCount;for(let l=s;l<a;l++)e._lastColliderWorldVertices.push(A.TransformCoordinates(this._positions[l],t))}return i._collide(e._trianglePlanes,e._lastColliderWorldVertices,this.getIndices(),e.indexStart,e.indexStart+e.indexCount,e.verticesStart,!!e.getMaterial(),this,this._shouldConvertRHS(),((r=e.getMaterial())==null?void 0:r.fillMode)===7),this}_processCollisionsForSubMeshes(e,t){const i=this._scene.getCollidingSubMeshCandidates(this,e),r=i.length;for(let s=0;s<r;s++){const a=i.data[s];r>1&&!a._checkCollision(e)||this._collideForSubMesh(a,t,e)}return this}_shouldConvertRHS(){return!1}_checkCollision(e){if(!this.getBoundingInfo()._checkCollision(e))return this;const t=V.Matrix[0],i=V.Matrix[1];return z.ScalingToRef(1/e._radius.x,1/e._radius.y,1/e._radius.z,t),this.worldMatrixFromCache.multiplyToRef(t,i),this._processCollisionsForSubMeshes(e,i),this}_generatePointsArray(){return!1}intersects(e,t,i,r=!1,s,a=!1){const l=new Fs,o=this.getClassName(),c=o==="InstancedLinesMesh"||o==="LinesMesh"||o==="GreasedLineMesh"?this.intersectionThreshold:0,u=this.getBoundingInfo();if(!this.subMeshes||!a&&(!e.intersectsSphere(u.boundingSphere,c)||!e.intersectsBox(u.boundingBox,c)))return l;if(r)return l.hit=!a,l.pickedMesh=a?null:this,l.distance=a?0:A.Distance(e.origin,u.boundingSphere.center),l.subMeshId=0,l;if(!this._generatePointsArray())return l;let h=null;const d=this._scene.getIntersectingSubMeshCandidates(this,e),f=d.length;let _=!1;for(let p=0;p<f;p++){const E=d.data[p].getMaterial();if(E&&(E.fillMode==7||E.fillMode==0||E.fillMode==1||E.fillMode==2||E.fillMode==4)){_=!0;break}}if(!_)return l.hit=!0,l.pickedMesh=this,l.distance=A.Distance(e.origin,u.boundingSphere.center),l.subMeshId=-1,l;for(let p=0;p<f;p++){const v=d.data[p];if(f>1&&!a&&!v.canIntersects(e))continue;const E=v.intersects(e,this._positions,this.getIndices(),t,i);if(E&&(t||!h||E.distance<h.distance)&&(h=E,h.subMeshId=p,t))break}if(h){const p=s??this.getWorldMatrix(),v=V.Vector3[0],E=V.Vector3[1];A.TransformCoordinatesToRef(e.origin,p,v),e.direction.scaleToRef(h.distance,E);const m=A.TransformNormal(E,p).addInPlace(v);return l.hit=!0,l.distance=A.Distance(v,m),l.pickedPoint=m,l.pickedMesh=this,l.bu=h.bu||0,l.bv=h.bv||0,l.subMeshFaceId=h.faceId,l.faceId=h.faceId+d.data[h.subMeshId].indexStart/(this.getClassName().indexOf("LinesMesh")!==-1?2:3),l.subMeshId=h.subMeshId,l}return l}clone(e,t,i){return null}releaseSubMeshes(){if(this.subMeshes)for(;this.subMeshes.length;)this.subMeshes[0].dispose();else this.subMeshes=[];return this}dispose(e,t=!1){let i;const r=this.getScene();for(this._scene.useMaterialMeshMap&&this._internalAbstractMeshDataInfo._material&&this._internalAbstractMeshDataInfo._material.meshMap&&(this._internalAbstractMeshDataInfo._material.meshMap[this.uniqueId]=void 0),r.freeActiveMeshes(),r.freeRenderingGroups(),r.renderingManager.maintainStateBetweenFrames&&r.renderingManager.restoreDispachedFlags(),this.actionManager!==void 0&&this.actionManager!==null&&(this._scene.meshes.some(l=>l!==this&&l.actionManager===this.actionManager)||this.actionManager.dispose(),this.actionManager=null),this._internalAbstractMeshDataInfo._skeleton=null,this._transformMatrixTexture&&(this._transformMatrixTexture.dispose(),this._transformMatrixTexture=null),i=0;i<this._intersectionsInProgress.length;i++){const l=this._intersectionsInProgress[i],o=l._intersectionsInProgress.indexOf(this);l._intersectionsInProgress.splice(o,1)}this._intersectionsInProgress.length=0,r.lights.forEach(l=>{let o=l.includedOnlyMeshes.indexOf(this);o!==-1&&l.includedOnlyMeshes.splice(o,1),o=l.excludedMeshes.indexOf(this),o!==-1&&l.excludedMeshes.splice(o,1);const c=l.getShadowGenerators();if(c){const u=c.values();for(let h=u.next();h.done!==!0;h=u.next()){const f=h.value.getShadowMap();f&&f.renderList&&(o=f.renderList.indexOf(this),o!==-1&&f.renderList.splice(o,1))}}}),(this.getClassName()!=="InstancedMesh"||this.getClassName()!=="InstancedLinesMesh")&&this.releaseSubMeshes();const a=r.getEngine();if(this._occlusionQuery!==null&&(this.isOcclusionQueryInProgress=!1,a.deleteQuery(this._occlusionQuery),this._occlusionQuery=null),a.wipeCaches(),r.removeMesh(this),this._parentContainer){const l=this._parentContainer.meshes.indexOf(this);l>-1&&this._parentContainer.meshes.splice(l,1),this._parentContainer=null}if(t&&this.material&&(this.material.getClassName()==="MultiMaterial"?this.material.dispose(!1,!0,!0):this.material.dispose(!1,!0)),!e)for(i=0;i<r.particleSystems.length;i++)r.particleSystems[i].emitter===this&&(r.particleSystems[i].dispose(),i--);this._internalAbstractMeshDataInfo._facetData.facetDataEnabled&&this.disableFacetData(),this._uniformBuffer.dispose(),this.onAfterWorldMatrixUpdateObservable.clear(),this.onCollideObservable.clear(),this.onCollisionPositionChangeObservable.clear(),this.onRebuildObservable.clear(),super.dispose(e,t)}addChild(e,t=!1){return e.setParent(this,t),this}removeChild(e,t=!1){return e.setParent(null,t),this}_initFacetData(){const e=this._internalAbstractMeshDataInfo._facetData;e.facetNormals||(e.facetNormals=[]),e.facetPositions||(e.facetPositions=[]),e.facetPartitioning||(e.facetPartitioning=new Array),e.facetNb=this.getIndices().length/3|0,e.partitioningSubdivisions=e.partitioningSubdivisions?e.partitioningSubdivisions:10,e.partitioningBBoxRatio=e.partitioningBBoxRatio?e.partitioningBBoxRatio:1.01;for(let t=0;t<e.facetNb;t++)e.facetNormals[t]=A.Zero(),e.facetPositions[t]=A.Zero();return e.facetDataEnabled=!0,this}updateFacetData(){const e=this._internalAbstractMeshDataInfo._facetData;e.facetDataEnabled||this._initFacetData();const t=this.getVerticesData(x.PositionKind),i=this.getIndices(),r=this.getVerticesData(x.NormalKind),s=this.getBoundingInfo();if(e.facetDepthSort&&!e.facetDepthSortEnabled){if(e.facetDepthSortEnabled=!0,i instanceof Uint16Array)e.depthSortedIndices=new Uint16Array(i);else if(i instanceof Uint32Array)e.depthSortedIndices=new Uint32Array(i);else{let l=!1;for(let o=0;o<i.length;o++)if(i[o]>65535){l=!0;break}l?e.depthSortedIndices=new Uint32Array(i):e.depthSortedIndices=new Uint16Array(i)}if(e.facetDepthSortFunction=function(l,o){return o.sqDistance-l.sqDistance},!e.facetDepthSortFrom){const l=this.getScene().activeCamera;e.facetDepthSortFrom=l?l.position:A.Zero()}e.depthSortedFacets=[];for(let l=0;l<e.facetNb;l++){const o={ind:l*3,sqDistance:0};e.depthSortedFacets.push(o)}e.invertedMatrix=z.Identity(),e.facetDepthSortOrigin=A.Zero()}e.bbSize.x=s.maximum.x-s.minimum.x>ut?s.maximum.x-s.minimum.x:ut,e.bbSize.y=s.maximum.y-s.minimum.y>ut?s.maximum.y-s.minimum.y:ut,e.bbSize.z=s.maximum.z-s.minimum.z>ut?s.maximum.z-s.minimum.z:ut;let a=e.bbSize.x>e.bbSize.y?e.bbSize.x:e.bbSize.y;if(a=a>e.bbSize.z?a:e.bbSize.z,e.subDiv.max=e.partitioningSubdivisions,e.subDiv.X=Math.floor(e.subDiv.max*e.bbSize.x/a),e.subDiv.Y=Math.floor(e.subDiv.max*e.bbSize.y/a),e.subDiv.Z=Math.floor(e.subDiv.max*e.bbSize.z/a),e.subDiv.X=e.subDiv.X<1?1:e.subDiv.X,e.subDiv.Y=e.subDiv.Y<1?1:e.subDiv.Y,e.subDiv.Z=e.subDiv.Z<1?1:e.subDiv.Z,e.facetParameters.facetNormals=this.getFacetLocalNormals(),e.facetParameters.facetPositions=this.getFacetLocalPositions(),e.facetParameters.facetPartitioning=this.getFacetLocalPartitioning(),e.facetParameters.bInfo=s,e.facetParameters.bbSize=e.bbSize,e.facetParameters.subDiv=e.subDiv,e.facetParameters.ratio=this.partitioningBBoxRatio,e.facetParameters.depthSort=e.facetDepthSort,e.facetDepthSort&&e.facetDepthSortEnabled&&(this.computeWorldMatrix(!0),this._worldMatrix.invertToRef(e.invertedMatrix),A.TransformCoordinatesToRef(e.facetDepthSortFrom,e.invertedMatrix,e.facetDepthSortOrigin),e.facetParameters.distanceTo=e.facetDepthSortOrigin),e.facetParameters.depthSortedFacets=e.depthSortedFacets,r&&Ue.ComputeNormals(t,i,r,e.facetParameters),e.facetDepthSort&&e.facetDepthSortEnabled){e.depthSortedFacets.sort(e.facetDepthSortFunction);const l=e.depthSortedIndices.length/3|0;for(let o=0;o<l;o++){const c=e.depthSortedFacets[o].ind;e.depthSortedIndices[o*3]=i[c],e.depthSortedIndices[o*3+1]=i[c+1],e.depthSortedIndices[o*3+2]=i[c+2]}this.updateIndices(e.depthSortedIndices,void 0,!0)}return this}getFacetLocalNormals(){const e=this._internalAbstractMeshDataInfo._facetData;return e.facetNormals||this.updateFacetData(),e.facetNormals}getFacetLocalPositions(){const e=this._internalAbstractMeshDataInfo._facetData;return e.facetPositions||this.updateFacetData(),e.facetPositions}getFacetLocalPartitioning(){const e=this._internalAbstractMeshDataInfo._facetData;return e.facetPartitioning||this.updateFacetData(),e.facetPartitioning}getFacetPosition(e){const t=A.Zero();return this.getFacetPositionToRef(e,t),t}getFacetPositionToRef(e,t){const i=this.getFacetLocalPositions()[e],r=this.getWorldMatrix();return A.TransformCoordinatesToRef(i,r,t),this}getFacetNormal(e){const t=A.Zero();return this.getFacetNormalToRef(e,t),t}getFacetNormalToRef(e,t){const i=this.getFacetLocalNormals()[e];return A.TransformNormalToRef(i,this.getWorldMatrix(),t),this}getFacetsAtLocalCoordinates(e,t,i){const r=this.getBoundingInfo(),s=this._internalAbstractMeshDataInfo._facetData,a=Math.floor((e-r.minimum.x*s.partitioningBBoxRatio)*s.subDiv.X*s.partitioningBBoxRatio/s.bbSize.x),l=Math.floor((t-r.minimum.y*s.partitioningBBoxRatio)*s.subDiv.Y*s.partitioningBBoxRatio/s.bbSize.y),o=Math.floor((i-r.minimum.z*s.partitioningBBoxRatio)*s.subDiv.Z*s.partitioningBBoxRatio/s.bbSize.z);return a<0||a>s.subDiv.max||l<0||l>s.subDiv.max||o<0||o>s.subDiv.max?null:s.facetPartitioning[a+s.subDiv.max*l+s.subDiv.max*s.subDiv.max*o]}getClosestFacetAtCoordinates(e,t,i,r,s=!1,a=!0){const l=this.getWorldMatrix(),o=V.Matrix[5];l.invertToRef(o);const c=V.Vector3[8];A.TransformCoordinatesFromFloatsToRef(e,t,i,o,c);const u=this.getClosestFacetAtLocalCoordinates(c.x,c.y,c.z,r,s,a);return r&&A.TransformCoordinatesFromFloatsToRef(r.x,r.y,r.z,l,r),u}getClosestFacetAtLocalCoordinates(e,t,i,r,s=!1,a=!0){let l=null,o=0,c=0,u=0,h=0,d=0,f=0,_=0,p=0;const v=this.getFacetLocalPositions(),E=this.getFacetLocalNormals(),g=this.getFacetsAtLocalCoordinates(e,t,i);if(!g)return null;let m=Number.MAX_VALUE,y=m,T,b,C;for(let M=0;M<g.length;M++)T=g[M],b=E[T],C=v[T],h=(e-C.x)*b.x+(t-C.y)*b.y+(i-C.z)*b.z,(!s||s&&a&&h>=0||s&&!a&&h<=0)&&(h=b.x*C.x+b.y*C.y+b.z*C.z,d=-(b.x*e+b.y*t+b.z*i-h)/(b.x*b.x+b.y*b.y+b.z*b.z),f=e+b.x*d,_=t+b.y*d,p=i+b.z*d,o=f-e,c=_-t,u=p-i,y=o*o+c*c+u*u,y<m&&(m=y,l=T,r&&(r.x=f,r.y=_,r.z=p)));return l}getFacetDataParameters(){return this._internalAbstractMeshDataInfo._facetData.facetParameters}disableFacetData(){const e=this._internalAbstractMeshDataInfo._facetData;return e.facetDataEnabled&&(e.facetDataEnabled=!1,e.facetPositions=[],e.facetNormals=[],e.facetPartitioning=new Array,e.facetParameters=null,e.depthSortedIndices=new Uint32Array(0)),this}updateIndices(e,t,i=!1){return this}createNormals(e){const t=this.getVerticesData(x.PositionKind),i=this.getIndices();let r;return this.isVerticesDataPresent(x.NormalKind)?r=this.getVerticesData(x.NormalKind):r=[],Ue.ComputeNormals(t,i,r,{useRightHandedSystem:this.getScene().useRightHandedSystem}),this.setVerticesData(x.NormalKind,r,e),this}alignWithNormal(e,t){t||(t=Ro.Y);const i=V.Vector3[0],r=V.Vector3[1];return A.CrossToRef(t,e,r),A.CrossToRef(e,r,i),this.rotationQuaternion?ue.RotationQuaternionFromAxisToRef(i,e,r,this.rotationQuaternion):A.RotationFromAxisToRef(i,e,r,this.rotation),this}_checkOcclusionQuery(){return!1}disableEdgesRendering(){throw ke("EdgesRenderer")}enableEdgesRendering(e,t,i){throw ke("EdgesRenderer")}getConnectedParticleSystems(){return this._scene.particleSystems.filter(e=>e.emitter===this)}}yr.OCCLUSION_TYPE_NONE=0;yr.OCCLUSION_TYPE_OPTIMISTIC=1;yr.OCCLUSION_TYPE_STRICT=2;yr.OCCLUSION_ALGORITHM_TYPE_ACCURATE=0;yr.OCCLUSION_ALGORITHM_TYPE_CONSERVATIVE=1;yr.CULLINGSTRATEGY_STANDARD=0;yr.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1;yr.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2;yr.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3;Ji("BABYLON.AbstractMesh",yr);class Gs{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=519,this.funcRef=1,this.funcMask=255,this.opStencilFail=7680,this.opDepthFail=7680,this.opStencilDepthPass=7681}get func(){return this._func}set func(e){this._func=e}get funcRef(){return this._funcRef}set funcRef(e){this._funcRef=e}get funcMask(){return this._funcMask}set funcMask(e){this._funcMask=e}get opStencilFail(){return this._opStencilFail}set opStencilFail(e){this._opStencilFail=e}get opDepthFail(){return this._opDepthFail}set opDepthFail(e){this._opDepthFail=e}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(e){this._opStencilDepthPass=e}get mask(){return this._mask}set mask(e){this._mask=e}get enabled(){return this._enabled}set enabled(e){this._enabled=e}getClassName(){return"MaterialStencilState"}copyTo(e){Fe.Clone(()=>e,this)}serialize(){return Fe.Serialize(this)}parse(e,t,i){Fe.Parse(()=>this,e,t,i)}}R([I()],Gs.prototype,"func",null);R([I()],Gs.prototype,"funcRef",null);R([I()],Gs.prototype,"funcMask",null);R([I()],Gs.prototype,"opStencilFail",null);R([I()],Gs.prototype,"opDepthFail",null);R([I()],Gs.prototype,"opStencilDepthPass",null);R([I()],Gs.prototype,"mask",null);R([I()],Gs.prototype,"enabled",null);var zi;(function(n){n[n.Created=1]="Created",n[n.Disposed=2]="Disposed",n[n.GetDefineNames=4]="GetDefineNames",n[n.PrepareUniformBuffer=8]="PrepareUniformBuffer",n[n.IsReadyForSubMesh=16]="IsReadyForSubMesh",n[n.PrepareDefines=32]="PrepareDefines",n[n.BindForSubMesh=64]="BindForSubMesh",n[n.PrepareEffect=128]="PrepareEffect",n[n.GetAnimatables=256]="GetAnimatables",n[n.GetActiveTextures=512]="GetActiveTextures",n[n.HasTexture=1024]="HasTexture",n[n.FillRenderTargetTextures=2048]="FillRenderTargetTextures",n[n.HasRenderTargetTextures=4096]="HasRenderTargetTextures",n[n.HardBindForSubMesh=8192]="HardBindForSubMesh"})(zi||(zi={}));function mm(n){n.indexOf("vClipPlane")===-1&&n.push("vClipPlane"),n.indexOf("vClipPlane2")===-1&&n.push("vClipPlane2"),n.indexOf("vClipPlane3")===-1&&n.push("vClipPlane3"),n.indexOf("vClipPlane4")===-1&&n.push("vClipPlane4"),n.indexOf("vClipPlane5")===-1&&n.push("vClipPlane5"),n.indexOf("vClipPlane6")===-1&&n.push("vClipPlane6")}function QN(n,e,t){const i=!!(n.clipPlane??e.clipPlane),r=!!(n.clipPlane2??e.clipPlane2),s=!!(n.clipPlane3??e.clipPlane3),a=!!(n.clipPlane4??e.clipPlane4),l=!!(n.clipPlane5??e.clipPlane5),o=!!(n.clipPlane6??e.clipPlane6);i&&t.push("#define CLIPPLANE"),r&&t.push("#define CLIPPLANE2"),s&&t.push("#define CLIPPLANE3"),a&&t.push("#define CLIPPLANE4"),l&&t.push("#define CLIPPLANE5"),o&&t.push("#define CLIPPLANE6")}function ZN(n,e,t){let i=!1;const r=!!(n.clipPlane??e.clipPlane),s=!!(n.clipPlane2??e.clipPlane2),a=!!(n.clipPlane3??e.clipPlane3),l=!!(n.clipPlane4??e.clipPlane4),o=!!(n.clipPlane5??e.clipPlane5),c=!!(n.clipPlane6??e.clipPlane6);return t.CLIPPLANE!==r&&(t.CLIPPLANE=r,i=!0),t.CLIPPLANE2!==s&&(t.CLIPPLANE2=s,i=!0),t.CLIPPLANE3!==a&&(t.CLIPPLANE3=a,i=!0),t.CLIPPLANE4!==l&&(t.CLIPPLANE4=l,i=!0),t.CLIPPLANE5!==o&&(t.CLIPPLANE5=o,i=!0),t.CLIPPLANE6!==c&&(t.CLIPPLANE6=c,i=!0),i}function vm(n,e,t){let i=e.clipPlane??t.clipPlane;Jo(n,"vClipPlane",i),i=e.clipPlane2??t.clipPlane2,Jo(n,"vClipPlane2",i),i=e.clipPlane3??t.clipPlane3,Jo(n,"vClipPlane3",i),i=e.clipPlane4??t.clipPlane4,Jo(n,"vClipPlane4",i),i=e.clipPlane5??t.clipPlane5,Jo(n,"vClipPlane5",i),i=e.clipPlane6??t.clipPlane6,Jo(n,"vClipPlane6",i)}function Jo(n,e,t){t&&n.setFloat4(e,t.normal.x,t.normal.y,t.normal.z,t.d)}const oE=Pe.Black();function Em(n,e,t){if(!n||n.LOGARITHMICDEPTH||n.indexOf&&n.indexOf("LOGARITHMICDEPTH")>=0){const i=t.activeCamera;i.mode===1&&ee.Error("Logarithmic depth is not compatible with orthographic cameras!",20),e.setFloat("logarithmicDepthConstant",2/(Math.log(i.maxZ+1)/Math.LN2))}}function ym(n,e,t,i=!1){t&&n.fogEnabled&&(!e||e.applyFog)&&n.fogMode!==0&&(t.setFloat4("vFogInfos",n.fogMode,n.fogStart,n.fogEnd,n.fogDensity),i?(n.fogColor.toLinearSpaceToRef(oE,n.getEngine().useExactSrgbConversions),t.setColor3("vFogColor",oE)):t.setColor3("vFogColor",n.fogColor))}function E1(n,e,t){const i=t.NUM_MORPH_INFLUENCERS;if(i>0&&He.LastCreatedEngine){const r=He.LastCreatedEngine.getCaps().maxVertexAttribs,s=e.morphTargetManager;if(s!=null&&s.isUsingTextureForTargets)return;const a=s&&s.supportsNormals&&t.NORMAL,l=s&&s.supportsTangents&&t.TANGENT,o=s&&s.supportsUVs&&t.UV1;for(let c=0;c<i;c++)n.push("position"+c),a&&n.push("normal"+c),l&&n.push("tangent"+c),o&&n.push("uv_"+c),n.length>r&&ee.Error("Cannot add more vertex attributes for mesh "+e.name)}}function y1(n,e=!1){n.push("world0"),n.push("world1"),n.push("world2"),n.push("world3"),e&&(n.push("previousWorld0"),n.push("previousWorld1"),n.push("previousWorld2"),n.push("previousWorld3"))}function Tm(n,e){const t=n.morphTargetManager;!n||!t||e.setFloatArray("morphTargetInfluences",t.influences)}function T1(n,e){e.bindToEffect(n,"Scene")}function Bt(n,e,t){e._needUVs=!0,e[t]=!0,n.optimizeUVAllocation&&n.getTextureMatrix().isIdentityAs3x2()?(e[t+"DIRECTUV"]=n.coordinatesIndex+1,e["MAINUV"+(n.coordinatesIndex+1)]=!0):e[t+"DIRECTUV"]=0}function Dt(n,e,t){const i=n.getTextureMatrix();e.updateMatrix(t+"Matrix",i)}function bm(n,e,t){t.BAKED_VERTEX_ANIMATION_TEXTURE&&t.INSTANCES&&n.push("bakedVertexAnimationSettingsInstanced")}function JN(n,e){return e.set(n),e}function Cm(n,e,t){if(!(!e||!n)&&(n.computeBonesUsingShaders&&e._bonesComputationForcedToCPU&&(n.computeBonesUsingShaders=!1),n.useBones&&n.computeBonesUsingShaders&&n.skeleton)){const i=n.skeleton;if(i.isUsingTextureForMatrices&&e.getUniformIndex("boneTextureWidth")>-1){const r=i.getTransformMatrixTexture(n);e.setTexture("boneSampler",r),e.setFloat("boneTextureWidth",4*(i.bones.length+1))}else{const r=i.getTransformMatrices(n);r&&(e.setMatrices("mBones",r),t&&n.getScene().prePassRenderer&&n.getScene().prePassRenderer.getIndex(2)&&(t.previousBones[n.uniqueId]||(t.previousBones[n.uniqueId]=r.slice()),e.setMatrices("mPreviousBones",t.previousBones[n.uniqueId]),JN(r,t.previousBones[n.uniqueId])))}}}function eF(n,e,t,i,r,s=!0){n._bindLight(e,t,i,r,s)}function b1(n,e,t,i,r=4){const s=Math.min(e.lightSources.length,r);for(let a=0;a<s;a++){const l=e.lightSources[a];eF(l,a,n,t,typeof i=="boolean"?i:i.SPECULARTERM,e.receiveShadows)}}function C1(n,e,t,i){t.NUM_BONE_INFLUENCERS>0&&(i.addCPUSkinningFallback(0,e),n.push("matricesIndices"),n.push("matricesWeights"),t.NUM_BONE_INFLUENCERS>4&&(n.push("matricesIndicesExtra"),n.push("matricesWeightsExtra")))}function A1(n,e){(e.INSTANCES||e.THIN_INSTANCES)&&y1(n,!!e.PREPASS_VELOCITY),e.INSTANCESCOLOR&&n.push("instanceColor")}function S1(n,e,t=4,i=0){let r=0;for(let s=0;s<t&&n["LIGHT"+s];s++)s>0&&(r=i+s,e.addFallback(r,"LIGHT"+s)),n.SHADOWS||(n["SHADOW"+s]&&e.addFallback(i,"SHADOW"+s),n["SHADOWPCF"+s]&&e.addFallback(i,"SHADOWPCF"+s),n["SHADOWPCSS"+s]&&e.addFallback(i,"SHADOWPCSS"+s),n["SHADOWPOISSON"+s]&&e.addFallback(i,"SHADOWPOISSON"+s),n["SHADOWESM"+s]&&e.addFallback(i,"SHADOWESM"+s),n["SHADOWCLOSEESM"+s]&&e.addFallback(i,"SHADOWCLOSEESM"+s));return r++}function tF(n,e){return e.fogEnabled&&n.applyFog&&e.fogMode!==0}function R1(n,e,t,i,r,s,a,l=!1){a._areMiscDirty&&(a.LOGARITHMICDEPTH=t,a.POINTSIZE=i,a.FOG=r&&tF(n,e),a.NONUNIFORMSCALING=n.nonUniformScaling,a.ALPHATEST=s,a.DECAL_AFTER_DETAIL=l)}function x1(n,e,t,i,r=4,s=!1){if(!t._areLightsDirty)return t._needNormals;let a=0;const l={needNormals:t._needNormals,needRebuild:!1,lightmapMode:!1,shadowEnabled:!1,specularEnabled:!1};if(n.lightsEnabled&&!s){for(const c of e.lightSources)if(iF(n,e,c,a,t,i,l),a++,a===r)break}t.SPECULARTERM=l.specularEnabled,t.SHADOWS=l.shadowEnabled;for(let c=a;c<r;c++)t["LIGHT"+c]!==void 0&&(t["LIGHT"+c]=!1,t["HEMILIGHT"+c]=!1,t["POINTLIGHT"+c]=!1,t["DIRLIGHT"+c]=!1,t["SPOTLIGHT"+c]=!1,t["SHADOW"+c]=!1,t["SHADOWCSM"+c]=!1,t["SHADOWCSMDEBUG"+c]=!1,t["SHADOWCSMNUM_CASCADES"+c]=!1,t["SHADOWCSMUSESHADOWMAXZ"+c]=!1,t["SHADOWCSMNOBLEND"+c]=!1,t["SHADOWCSM_RIGHTHANDED"+c]=!1,t["SHADOWPCF"+c]=!1,t["SHADOWPCSS"+c]=!1,t["SHADOWPOISSON"+c]=!1,t["SHADOWESM"+c]=!1,t["SHADOWCLOSEESM"+c]=!1,t["SHADOWCUBE"+c]=!1,t["SHADOWLOWQUALITY"+c]=!1,t["SHADOWMEDIUMQUALITY"+c]=!1);const o=n.getEngine().getCaps();return t.SHADOWFLOAT===void 0&&(l.needRebuild=!0),t.SHADOWFLOAT=l.shadowEnabled&&(o.textureFloatRender&&o.textureFloatLinearFiltering||o.textureHalfFloatRender&&o.textureHalfFloatLinearFiltering),t.LIGHTMAPEXCLUDED=l.lightmapMode,l.needRebuild&&t.rebuild(),l.needNormals}function iF(n,e,t,i,r,s,a){switch(a.needNormals=!0,r["LIGHT"+i]===void 0&&(a.needRebuild=!0),r["LIGHT"+i]=!0,r["SPOTLIGHT"+i]=!1,r["HEMILIGHT"+i]=!1,r["POINTLIGHT"+i]=!1,r["DIRLIGHT"+i]=!1,t.prepareLightSpecificDefines(r,i),r["LIGHT_FALLOFF_PHYSICAL"+i]=!1,r["LIGHT_FALLOFF_GLTF"+i]=!1,r["LIGHT_FALLOFF_STANDARD"+i]=!1,t.falloffType){case Et.FALLOFF_GLTF:r["LIGHT_FALLOFF_GLTF"+i]=!0;break;case Et.FALLOFF_PHYSICAL:r["LIGHT_FALLOFF_PHYSICAL"+i]=!0;break;case Et.FALLOFF_STANDARD:r["LIGHT_FALLOFF_STANDARD"+i]=!0;break}if(t.specular.equalsFloats(0,0,0)||(a.specularEnabled=!0),r["SHADOW"+i]=!1,r["SHADOWCSM"+i]=!1,r["SHADOWCSMDEBUG"+i]=!1,r["SHADOWCSMNUM_CASCADES"+i]=!1,r["SHADOWCSMUSESHADOWMAXZ"+i]=!1,r["SHADOWCSMNOBLEND"+i]=!1,r["SHADOWCSM_RIGHTHANDED"+i]=!1,r["SHADOWPCF"+i]=!1,r["SHADOWPCSS"+i]=!1,r["SHADOWPOISSON"+i]=!1,r["SHADOWESM"+i]=!1,r["SHADOWCLOSEESM"+i]=!1,r["SHADOWCUBE"+i]=!1,r["SHADOWLOWQUALITY"+i]=!1,r["SHADOWMEDIUMQUALITY"+i]=!1,e&&e.receiveShadows&&n.shadowsEnabled&&t.shadowEnabled){const l=t.getShadowGenerator(n.activeCamera)??t.getShadowGenerator();if(l){const o=l.getShadowMap();o&&o.renderList&&o.renderList.length>0&&(a.shadowEnabled=!0,l.prepareDefines(r,i))}}t.lightmapMode!=Et.LIGHTMAP_DEFAULT?(a.lightmapMode=!0,r["LIGHTMAPEXCLUDED"+i]=!0,r["LIGHTMAPNOSPECULAR"+i]=t.lightmapMode==Et.LIGHTMAP_SHADOWSONLY):(r["LIGHTMAPEXCLUDED"+i]=!1,r["LIGHTMAPNOSPECULAR"+i]=!1)}function M1(n,e,t,i,r,s=null,a=!1){let l=aF(n,i);s!==!1&&(l=ZN(t,n,i)),i.DEPTHPREPASS!==!e.getColorWrite()&&(i.DEPTHPREPASS=!i.DEPTHPREPASS,l=!0),i.INSTANCES!==r&&(i.INSTANCES=r,l=!0),i.THIN_INSTANCES!==a&&(i.THIN_INSTANCES=a,l=!0),l&&i.markAsUnprocessed()}function rF(n,e){if(n.useBones&&n.computeBonesUsingShaders&&n.skeleton){e.NUM_BONE_INFLUENCERS=n.numBoneInfluencers;const t=e.BONETEXTURE!==void 0;if(n.skeleton.isUsingTextureForMatrices&&t)e.BONETEXTURE=!0;else{e.BonesPerMesh=n.skeleton.bones.length+1,e.BONETEXTURE=t?!1:void 0;const i=n.getScene().prePassRenderer;if(i&&i.enabled){const r=i.excludedSkinnedMesh.indexOf(n)===-1;e.BONES_VELOCITY_ENABLED=r}}}else e.NUM_BONE_INFLUENCERS=0,e.BonesPerMesh=0,e.BONETEXTURE!==void 0&&(e.BONETEXTURE=!1)}function nF(n,e){const t=n.morphTargetManager;t?(e.MORPHTARGETS_UV=t.supportsUVs&&e.UV1,e.MORPHTARGETS_TANGENT=t.supportsTangents&&e.TANGENT,e.MORPHTARGETS_NORMAL=t.supportsNormals&&e.NORMAL,e.NUM_MORPH_INFLUENCERS=t.numMaxInfluencers||t.numInfluencers,e.MORPHTARGETS=e.NUM_MORPH_INFLUENCERS>0,e.MORPHTARGETS_TEXTURE=t.isUsingTextureForTargets):(e.MORPHTARGETS_UV=!1,e.MORPHTARGETS_TANGENT=!1,e.MORPHTARGETS_NORMAL=!1,e.MORPHTARGETS=!1,e.NUM_MORPH_INFLUENCERS=0)}function sF(n,e){const t=n.bakedVertexAnimationManager;e.BAKED_VERTEX_ANIMATION_TEXTURE=!!(t&&t.isEnabled)}function I1(n,e,t,i,r=!1,s=!0,a=!0){if(!e._areAttributesDirty&&e._needNormals===e._normals&&e._needUVs===e._uvs)return!1;e._normals=e._needNormals,e._uvs=e._needUVs,e.NORMAL=e._needNormals&&n.isVerticesDataPresent("normal"),e._needNormals&&n.isVerticesDataPresent("tangent")&&(e.TANGENT=!0);for(let l=1;l<=6;++l)e["UV"+l]=e._needUVs?n.isVerticesDataPresent(`uv${l===1?"":l}`):!1;{const l=n.useVertexColors&&n.isVerticesDataPresent("color");e.VERTEXCOLOR=l,e.VERTEXALPHA=n.hasVertexAlpha&&l&&s}return n.isVerticesDataPresent("instanceColor")&&(n.hasInstances||n.hasThinInstances)&&(e.INSTANCESCOLOR=!0),rF(n,e),r&&nF(n,e),a&&sF(n,e),!0}function P1(n,e){if(n.activeCamera){const t=e.MULTIVIEW;e.MULTIVIEW=n.activeCamera.outputRenderTarget!==null&&n.activeCamera.outputRenderTarget.getViewCount()>1,e.MULTIVIEW!=t&&e.markAsUnprocessed()}}function w1(n,e,t){const i=e.ORDER_INDEPENDENT_TRANSPARENCY,r=e.ORDER_INDEPENDENT_TRANSPARENCY_16BITS;e.ORDER_INDEPENDENT_TRANSPARENCY=n.useOrderIndependentTransparency&&t,e.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!n.getEngine().getCaps().textureFloatLinearFiltering,(i!==e.ORDER_INDEPENDENT_TRANSPARENCY||r!==e.ORDER_INDEPENDENT_TRANSPARENCY_16BITS)&&e.markAsUnprocessed()}function O1(n,e,t){const i=e.PREPASS;if(!e._arePrePassDirty)return;const r=[{type:1,define:"PREPASS_POSITION",index:"PREPASS_POSITION_INDEX"},{type:2,define:"PREPASS_VELOCITY",index:"PREPASS_VELOCITY_INDEX"},{type:3,define:"PREPASS_REFLECTIVITY",index:"PREPASS_REFLECTIVITY_INDEX"},{type:0,define:"PREPASS_IRRADIANCE",index:"PREPASS_IRRADIANCE_INDEX"},{type:7,define:"PREPASS_ALBEDO_SQRT",index:"PREPASS_ALBEDO_SQRT_INDEX"},{type:5,define:"PREPASS_DEPTH",index:"PREPASS_DEPTH_INDEX"},{type:6,define:"PREPASS_NORMAL",index:"PREPASS_NORMAL_INDEX"}];if(n.prePassRenderer&&n.prePassRenderer.enabled&&t){e.PREPASS=!0,e.SCENE_MRT_COUNT=n.prePassRenderer.mrtCount,e.PREPASS_NORMAL_WORLDSPACE=n.prePassRenderer.generateNormalsInWorldSpace;for(let s=0;s<r.length;s++){const a=n.prePassRenderer.getIndex(r[s].type);a!==-1?(e[r[s].define]=!0,e[r[s].index]=a):e[r[s].define]=!1}}else{e.PREPASS=!1;for(let s=0;s<r.length;s++)e[r[s].define]=!1}e.PREPASS!=i&&(e.markAsUnprocessed(),e.markAsImageProcessingDirty())}function aF(n,e){let t=!1;if(n.activeCamera){const i=e.CAMERA_ORTHOGRAPHIC?1:0,r=e.CAMERA_PERSPECTIVE?1:0,s=n.activeCamera.mode===1?1:0,a=n.activeCamera.mode===0?1:0;(i^s||r^a)&&(e.CAMERA_ORTHOGRAPHIC=s===1,e.CAMERA_PERSPECTIVE=a===1,t=!0)}return t}function oF(n,e,t,i,r=null,s=!1){r&&r.push("Light"+n),!s&&(e.push("vLightData"+n,"vLightDiffuse"+n,"vLightSpecular"+n,"vLightDirection"+n,"vLightFalloff"+n,"vLightGround"+n,"lightMatrix"+n,"shadowsInfo"+n,"depthValues"+n),t.push("shadowSampler"+n),t.push("depthSampler"+n),e.push("viewFrustumZ"+n,"cascadeBlendFactor"+n,"lightSizeUVCorrection"+n,"depthCorrection"+n,"penumbraDarkness"+n,"frustumLengths"+n),i&&(t.push("projectionLightSampler"+n),e.push("textureProjectionMatrix"+n)))}function D1(n,e,t,i=4){let r,s=null;if(n.uniformsNames){const a=n;r=a.uniformsNames,s=a.uniformBuffersNames,e=a.samplers,t=a.defines,i=a.maxSimultaneousLights||0}else r=n,e||(e=[]);for(let a=0;a<i&&t["LIGHT"+a];a++)oF(a,r,e,t["PROJECTEDLIGHTTEXTURE"+a],s);t.NUM_MORPH_INFLUENCERS&&(r.push("morphTargetInfluences"),r.push("morphTargetCount")),t.BAKED_VERTEX_ANIMATION_TEXTURE&&(r.push("bakedVertexAnimationSettings"),r.push("bakedVertexAnimationTextureSizeInverted"),r.push("bakedVertexAnimationTime"),e.push("bakedVertexAnimationTexture"))}class j{get canRenderToMRT(){return!1}set alpha(e){if(this._alpha===e)return;const t=this._alpha;this._alpha=e,(t===1||e===1)&&this.markAsDirty(j.MiscDirtyFlag+j.PrePassDirtyFlag)}get alpha(){return this._alpha}set backFaceCulling(e){this._backFaceCulling!==e&&(this._backFaceCulling=e,this.markAsDirty(j.TextureDirtyFlag))}get backFaceCulling(){return this._backFaceCulling}set cullBackFaces(e){this._cullBackFaces!==e&&(this._cullBackFaces=e,this.markAsDirty(j.TextureDirtyFlag))}get cullBackFaces(){return this._cullBackFaces}get blockDirtyMechanism(){return this._blockDirtyMechanism}set blockDirtyMechanism(e){this._blockDirtyMechanism!==e&&(this._blockDirtyMechanism=e,e||this.markDirty())}atomicMaterialsUpdate(e){this.blockDirtyMechanism=!0;try{e(this)}finally{this.blockDirtyMechanism=!1}}get hasRenderTargetTextures(){return this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._eventInfo.hasRenderTargetTextures}set onDispose(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new Y),this._onBindObservable}set onBind(e){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(e)}get onUnBindObservable(){return this._onUnBindObservable||(this._onUnBindObservable=new Y),this._onUnBindObservable}get onEffectCreatedObservable(){return this._onEffectCreatedObservable||(this._onEffectCreatedObservable=new Y),this._onEffectCreatedObservable}set alphaMode(e){this._alphaMode!==e&&(this._alphaMode=e,this.markAsDirty(j.TextureDirtyFlag))}get alphaMode(){return this._alphaMode}set needDepthPrePass(e){this._needDepthPrePass!==e&&(this._needDepthPrePass=e,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))}get needDepthPrePass(){return this._needDepthPrePass}get isPrePassCapable(){return!1}set fogEnabled(e){this._fogEnabled!==e&&(this._fogEnabled=e,this.markAsDirty(j.MiscDirtyFlag))}get fogEnabled(){return this._fogEnabled}get wireframe(){switch(this._fillMode){case j.WireFrameFillMode:case j.LineListDrawMode:case j.LineLoopDrawMode:case j.LineStripDrawMode:return!0}return this._scene.forceWireframe}set wireframe(e){this.fillMode=e?j.WireFrameFillMode:j.TriangleFillMode}get pointsCloud(){switch(this._fillMode){case j.PointFillMode:case j.PointListDrawMode:return!0}return this._scene.forcePointsCloud}set pointsCloud(e){this.fillMode=e?j.PointFillMode:j.TriangleFillMode}get fillMode(){return this._fillMode}set fillMode(e){this._fillMode!==e&&(this._fillMode=e,this.markAsDirty(j.MiscDirtyFlag))}get useLogarithmicDepth(){return this._useLogarithmicDepth}set useLogarithmicDepth(e){const t=this.getScene().getEngine().getCaps().fragmentDepthSupported;e&&!t&&ee.Warn("Logarithmic depth has been requested for a material on a device that doesn't support it."),this._useLogarithmicDepth=e&&t,this._markAllSubMeshesAsMiscDirty()}_getDrawWrapper(){return this._drawWrapper}_setDrawWrapper(e){this._drawWrapper=e}constructor(e,t,i){this.shadowDepthWrapper=null,this.allowShaderHotSwapping=!0,this.metadata=null,this.reservedDataStore=null,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this._alpha=1,this._backFaceCulling=!0,this._cullBackFaces=!0,this._blockDirtyMechanism=!1,this.onCompiled=null,this.onError=null,this.getRenderTargetTextures=null,this.doNotSerialize=!1,this._storeEffectOnSubMeshes=!1,this.animations=null,this.onDisposeObservable=new Y,this._onDisposeObserver=null,this._onUnBindObservable=null,this._onBindObserver=null,this._alphaMode=2,this._needDepthPrePass=!1,this.disableDepthWrite=!1,this.disableColorWrite=!1,this.forceDepthWrite=!1,this.depthFunction=0,this.separateCullingPass=!1,this._fogEnabled=!0,this.pointSize=1,this.zOffset=0,this.zOffsetUnits=0,this.stencil=new Gs,this._useUBO=!1,this._fillMode=j.TriangleFillMode,this._cachedDepthWriteState=!1,this._cachedColorWriteState=!1,this._cachedDepthFunctionState=0,this._indexInSceneMaterialArray=-1,this.meshMap=null,this._parentContainer=null,this._uniformBufferLayoutBuilt=!1,this._eventInfo={},this._callbackPluginEventGeneric=()=>{},this._callbackPluginEventIsReadyForSubMesh=()=>{},this._callbackPluginEventPrepareDefines=()=>{},this._callbackPluginEventPrepareDefinesBeforeAttributes=()=>{},this._callbackPluginEventHardBindForSubMesh=()=>{},this._callbackPluginEventBindForSubMesh=()=>{},this._callbackPluginEventHasRenderTargetTextures=()=>{},this._callbackPluginEventFillRenderTargetTextures=()=>{},this._forceAlphaTest=!1,this._transparencyMode=null,this.name=e;const r=t||He.LastCreatedScene;r&&(this._scene=r,this._dirtyCallbacks={},this._dirtyCallbacks[1]=this._markAllSubMeshesAsTexturesDirty.bind(this),this._dirtyCallbacks[2]=this._markAllSubMeshesAsLightsDirty.bind(this),this._dirtyCallbacks[4]=this._markAllSubMeshesAsFresnelDirty.bind(this),this._dirtyCallbacks[8]=this._markAllSubMeshesAsAttributesDirty.bind(this),this._dirtyCallbacks[16]=this._markAllSubMeshesAsMiscDirty.bind(this),this._dirtyCallbacks[32]=this._markAllSubMeshesAsPrePassDirty.bind(this),this._dirtyCallbacks[63]=this._markAllSubMeshesAsAllDirty.bind(this),this.id=e||X.RandomId(),this.uniqueId=this._scene.getUniqueId(),this._materialContext=this._scene.getEngine().createMaterialContext(),this._drawWrapper=new ec(this._scene.getEngine(),!1),this._drawWrapper.materialContext=this._materialContext,this._scene.useRightHandedSystem?this.sideOrientation=j.ClockWiseSideOrientation:this.sideOrientation=j.CounterClockWiseSideOrientation,this._uniformBuffer=new me(this._scene.getEngine(),void 0,void 0,e),this._useUBO=this.getScene().getEngine().supportsUniformBuffers,i||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={}),j.OnEventObservable.notifyObservers(this,zi.Created))}toString(e){return"Name: "+this.name}getClassName(){return"Material"}get _isMaterial(){return!0}get isFrozen(){return this.checkReadyOnlyOnce}freeze(){this.markDirty(),this.checkReadyOnlyOnce=!0}unfreeze(){this.markDirty(),this.checkReadyOnlyOnce=!1}isReady(e,t){return!0}isReadyForSubMesh(e,t,i){const r=t.materialDefines;return r?(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=r,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),this._eventInfo.isReadyForSubMesh):!1}getEffect(){return this._drawWrapper.effect}getScene(){return this._scene}get transparencyMode(){return this._transparencyMode}set transparencyMode(e){this._transparencyMode!==e&&(this._transparencyMode=e,this._forceAlphaTest=e===j.MATERIAL_ALPHATESTANDBLEND,this._markAllSubMeshesAsTexturesAndMiscDirty())}get _disableAlphaBlending(){return this._transparencyMode===j.MATERIAL_OPAQUE||this._transparencyMode===j.MATERIAL_ALPHATEST}needAlphaBlending(){return this._disableAlphaBlending?!1:this.alpha<1}needAlphaBlendingForMesh(e){return e.visibility<1?!0:this._disableAlphaBlending?!1:e.hasVertexAlpha||this.needAlphaBlending()}needAlphaTesting(){return!!this._forceAlphaTest}_shouldTurnAlphaTestOn(e){return!this.needAlphaBlendingForMesh(e)&&this.needAlphaTesting()}getAlphaTestTexture(){return null}markDirty(e=!1){const t=this.getScene().meshes;for(const i of t)if(i.subMeshes){for(const r of i.subMeshes)if(r.getMaterial()===this)for(const s of r._drawWrappers)s&&this._materialContext===s.materialContext&&(s._wasPreviouslyReady=!1,s._wasPreviouslyUsingInstances=null,s._forceRebindOnNextCall=e)}e&&this.markAsDirty(j.AllDirtyFlag)}_preBind(e,t=null){const i=this._scene.getEngine(),s=(t??this.sideOrientation)===j.ClockWiseSideOrientation;return i.enableEffect(e||this._getDrawWrapper()),i.setState(this.backFaceCulling,this.zOffset,!1,s,this._scene._mirroredCameraPosition?!this.cullBackFaces:this.cullBackFaces,this.stencil,this.zOffsetUnits),s}bind(e,t){}buildUniformLayout(){const e=this._uniformBuffer;this._eventInfo.ubo=e,this._callbackPluginEventGeneric(zi.PrepareUniformBuffer,this._eventInfo),e.create(),this._uniformBufferLayoutBuilt=!0}bindForSubMesh(e,t,i){const r=i._drawWrapper;this._eventInfo.subMesh=i,this._callbackPluginEventBindForSubMesh(this._eventInfo),r._forceRebindOnNextCall=!1}bindOnlyWorldMatrix(e){}bindView(e){this._useUBO?this._needToBindSceneUbo=!0:e.setMatrix("view",this.getScene().getViewMatrix())}bindViewProjection(e){this._useUBO?this._needToBindSceneUbo=!0:(e.setMatrix("viewProjection",this.getScene().getTransformMatrix()),e.setMatrix("projection",this.getScene().getProjectionMatrix()))}bindEyePosition(e,t){this._useUBO?this._needToBindSceneUbo=!0:this._scene.bindEyePosition(e,t)}_afterBind(e,t=null,i){if(this._scene._cachedMaterial=this,this._needToBindSceneUbo&&t&&(this._needToBindSceneUbo=!1,T1(t,this.getScene().getSceneUniformBuffer()),this._scene.finalizeSceneUbo()),e?this._scene._cachedVisibility=e.visibility:this._scene._cachedVisibility=1,this._onBindObservable&&e&&this._onBindObservable.notifyObservers(e),this.disableDepthWrite){const r=this._scene.getEngine();this._cachedDepthWriteState=r.getDepthWrite(),r.setDepthWrite(!1)}if(this.disableColorWrite){const r=this._scene.getEngine();this._cachedColorWriteState=r.getColorWrite(),r.setColorWrite(!1)}if(this.depthFunction!==0){const r=this._scene.getEngine();this._cachedDepthFunctionState=r.getDepthFunction()||0,r.setDepthFunction(this.depthFunction)}}unbind(){this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this),this.depthFunction!==0&&this._scene.getEngine().setDepthFunction(this._cachedDepthFunctionState),this.disableDepthWrite&&this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState),this.disableColorWrite&&this._scene.getEngine().setColorWrite(this._cachedColorWriteState)}getAnimatables(){return this._eventInfo.animatables=[],this._callbackPluginEventGeneric(zi.GetAnimatables,this._eventInfo),this._eventInfo.animatables}getActiveTextures(){return this._eventInfo.activeTextures=[],this._callbackPluginEventGeneric(zi.GetActiveTextures,this._eventInfo),this._eventInfo.activeTextures}hasTexture(e){return this._eventInfo.hasTexture=!1,this._eventInfo.texture=e,this._callbackPluginEventGeneric(zi.HasTexture,this._eventInfo),this._eventInfo.hasTexture}clone(e){return null}_clonePlugins(e,t){const i={};if(this._serializePlugins(i),j._ParsePlugins(i,e,this._scene,t),this.pluginManager)for(const r of this.pluginManager._plugins){const s=e.pluginManager.getPlugin(r.name);s&&r.copyTo(s)}}getBindedMeshes(){if(this.meshMap){const e=[];for(const t in this.meshMap){const i=this.meshMap[t];i&&e.push(i)}return e}else return this._scene.meshes.filter(t=>t.material===this)}forceCompilation(e,t,i,r){const s={clipPlane:!1,useInstances:!1,...i},a=this.getScene(),l=this.allowShaderHotSwapping;this.allowShaderHotSwapping=!1;const o=()=>{if(!this._scene||!this._scene.getEngine())return;const c=a.clipPlane;if(s.clipPlane&&(a.clipPlane=new hn(0,0,0,1)),this._storeEffectOnSubMeshes){let u=!0,h=null;if(e.subMeshes){const d=new pn(0,0,0,0,0,e,void 0,!1,!1);d.materialDefines&&(d.materialDefines._renderId=-1),this.isReadyForSubMesh(e,d,s.useInstances)||(d.effect&&d.effect.getCompilationError()&&d.effect.allFallbacksProcessed()?h=d.effect.getCompilationError():(u=!1,setTimeout(o,16)))}u&&(this.allowShaderHotSwapping=l,h&&r&&r(h),t&&t(this))}else this.isReady()?(this.allowShaderHotSwapping=l,t&&t(this)):setTimeout(o,16);s.clipPlane&&(a.clipPlane=c)};o()}forceCompilationAsync(e,t){return new Promise((i,r)=>{this.forceCompilation(e,()=>{i()},t,s=>{r(s)})})}markAsDirty(e){this.getScene().blockMaterialDirtyMechanism||this._blockDirtyMechanism||(j._DirtyCallbackArray.length=0,e&j.TextureDirtyFlag&&j._DirtyCallbackArray.push(j._TextureDirtyCallBack),e&j.LightDirtyFlag&&j._DirtyCallbackArray.push(j._LightsDirtyCallBack),e&j.FresnelDirtyFlag&&j._DirtyCallbackArray.push(j._FresnelDirtyCallBack),e&j.AttributesDirtyFlag&&j._DirtyCallbackArray.push(j._AttributeDirtyCallBack),e&j.MiscDirtyFlag&&j._DirtyCallbackArray.push(j._MiscDirtyCallBack),e&j.PrePassDirtyFlag&&j._DirtyCallbackArray.push(j._PrePassDirtyCallBack),j._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(j._RunDirtyCallBacks),this.getScene().resetCachedMaterial())}resetDrawCache(){const e=this.getScene().meshes;for(const t of e)if(t.subMeshes)for(const i of t.subMeshes)i.getMaterial()===this&&i.resetDrawCache()}_markAllSubMeshesAsDirty(e){if(this.getScene().blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const t=this.getScene().meshes;for(const i of t)if(i.subMeshes){for(const r of i.subMeshes)if(r.getMaterial(!1)===this)for(const s of r._drawWrappers)!s||!s.defines||!s.defines.markAllAsDirty||this._materialContext===s.materialContext&&e(s.defines)}}_markScenePrePassDirty(){if(this.getScene().blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const e=this.getScene().enablePrePassRenderer();e&&e.markAsDirty()}_markAllSubMeshesAsAllDirty(){this._markAllSubMeshesAsDirty(j._AllDirtyCallBack)}_markAllSubMeshesAsImageProcessingDirty(){this._markAllSubMeshesAsDirty(j._ImageProcessingDirtyCallBack)}_markAllSubMeshesAsTexturesDirty(){this._markAllSubMeshesAsDirty(j._TextureDirtyCallBack)}_markAllSubMeshesAsFresnelDirty(){this._markAllSubMeshesAsDirty(j._FresnelDirtyCallBack)}_markAllSubMeshesAsFresnelAndMiscDirty(){this._markAllSubMeshesAsDirty(j._FresnelAndMiscDirtyCallBack)}_markAllSubMeshesAsLightsDirty(){this._markAllSubMeshesAsDirty(j._LightsDirtyCallBack)}_markAllSubMeshesAsAttributesDirty(){this._markAllSubMeshesAsDirty(j._AttributeDirtyCallBack)}_markAllSubMeshesAsMiscDirty(){this._markAllSubMeshesAsDirty(j._MiscDirtyCallBack)}_markAllSubMeshesAsPrePassDirty(){this._markAllSubMeshesAsDirty(j._MiscDirtyCallBack)}_markAllSubMeshesAsTexturesAndMiscDirty(){this._markAllSubMeshesAsDirty(j._TextureAndMiscDirtyCallBack)}_checkScenePerformancePriority(){if(this._scene.performancePriority!==ns.BackwardCompatible){this.checkReadyOnlyOnce=!0;const e=this._scene.onScenePerformancePriorityChangedObservable.addOnce(()=>{this.checkReadyOnlyOnce=!1});this.onDisposeObservable.add(()=>{this._scene.onScenePerformancePriorityChangedObservable.remove(e)})}}setPrePassRenderer(e){return!1}dispose(e,t,i){const r=this.getScene();if(r.stopAnimation(this),r.freeProcessedMaterials(),r.removeMaterial(this),this._eventInfo.forceDisposeTextures=t,this._callbackPluginEventGeneric(zi.Disposed,this._eventInfo),this._parentContainer){const s=this._parentContainer.materials.indexOf(this);s>-1&&this._parentContainer.materials.splice(s,1),this._parentContainer=null}if(i!==!0)if(this.meshMap)for(const s in this.meshMap){const a=this.meshMap[s];a&&(a.material=null,this.releaseVertexArrayObject(a,e))}else{const s=r.meshes;for(const a of s)a.material===this&&!a.sourceMesh&&(a.material=null,this.releaseVertexArrayObject(a,e))}this._uniformBuffer.dispose(),e&&this._drawWrapper.effect&&(this._storeEffectOnSubMeshes||this._drawWrapper.effect.dispose(),this._drawWrapper.effect=null),this.metadata=null,this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this._onBindObservable&&this._onBindObservable.clear(),this._onUnBindObservable&&this._onUnBindObservable.clear(),this._onEffectCreatedObservable&&this._onEffectCreatedObservable.clear(),this._eventInfo&&(this._eventInfo={})}releaseVertexArrayObject(e,t){const i=e.geometry;if(i)if(this._storeEffectOnSubMeshes){if(e.subMeshes)for(const r of e.subMeshes)i._releaseVertexArrayObject(r.effect),t&&r.effect&&r.effect.dispose()}else i._releaseVertexArrayObject(this._drawWrapper.effect)}serialize(){const e=Fe.Serialize(this);return e.stencil=this.stencil.serialize(),e.uniqueId=this.uniqueId,this._serializePlugins(e),e}_serializePlugins(e){if(e.plugins={},this.pluginManager)for(const t of this.pluginManager._plugins)e.plugins[t.getClassName()]=t.serialize()}static Parse(e,t,i){if(!e.customType)e.customType="BABYLON.StandardMaterial";else if(e.customType==="BABYLON.PBRMaterial"&&e.overloadedAlbedo&&(e.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return ee.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library."),null;const s=X.Instantiate(e.customType).Parse(e,t,i);return s._loadedUniqueId=e.uniqueId,s}static _ParsePlugins(e,t,i,r){var s;if(e.plugins)for(const a in e.plugins){const l=e.plugins[a];let o=(s=t.pluginManager)==null?void 0:s.getPlugin(l.name);if(!o){const c=X.Instantiate("BABYLON."+a);c&&(o=new c(t))}o==null||o.parse(l,i,r)}}}j.TriangleFillMode=0;j.WireFrameFillMode=1;j.PointFillMode=2;j.PointListDrawMode=3;j.LineListDrawMode=4;j.LineLoopDrawMode=5;j.LineStripDrawMode=6;j.TriangleStripDrawMode=7;j.TriangleFanDrawMode=8;j.ClockWiseSideOrientation=0;j.CounterClockWiseSideOrientation=1;j.TextureDirtyFlag=1;j.LightDirtyFlag=2;j.FresnelDirtyFlag=4;j.AttributesDirtyFlag=8;j.MiscDirtyFlag=16;j.PrePassDirtyFlag=32;j.AllDirtyFlag=63;j.MATERIAL_OPAQUE=0;j.MATERIAL_ALPHATEST=1;j.MATERIAL_ALPHABLEND=2;j.MATERIAL_ALPHATESTANDBLEND=3;j.MATERIAL_NORMALBLENDMETHOD_WHITEOUT=0;j.MATERIAL_NORMALBLENDMETHOD_RNM=1;j.OnEventObservable=new Y;j._AllDirtyCallBack=n=>n.markAllAsDirty();j._ImageProcessingDirtyCallBack=n=>n.markAsImageProcessingDirty();j._TextureDirtyCallBack=n=>n.markAsTexturesDirty();j._FresnelDirtyCallBack=n=>n.markAsFresnelDirty();j._MiscDirtyCallBack=n=>n.markAsMiscDirty();j._PrePassDirtyCallBack=n=>n.markAsPrePassDirty();j._LightsDirtyCallBack=n=>n.markAsLightDirty();j._AttributeDirtyCallBack=n=>n.markAsAttributesDirty();j._FresnelAndMiscDirtyCallBack=n=>{j._FresnelDirtyCallBack(n),j._MiscDirtyCallBack(n)};j._TextureAndMiscDirtyCallBack=n=>{j._TextureDirtyCallBack(n),j._MiscDirtyCallBack(n)};j._DirtyCallbackArray=[];j._RunDirtyCallBacks=n=>{for(const e of j._DirtyCallbackArray)e(n)};R([I()],j.prototype,"id",void 0);R([I()],j.prototype,"uniqueId",void 0);R([I()],j.prototype,"name",void 0);R([I()],j.prototype,"metadata",void 0);R([I()],j.prototype,"checkReadyOnEveryCall",void 0);R([I()],j.prototype,"checkReadyOnlyOnce",void 0);R([I()],j.prototype,"state",void 0);R([I("alpha")],j.prototype,"_alpha",void 0);R([I("backFaceCulling")],j.prototype,"_backFaceCulling",void 0);R([I("cullBackFaces")],j.prototype,"_cullBackFaces",void 0);R([I()],j.prototype,"sideOrientation",void 0);R([I("alphaMode")],j.prototype,"_alphaMode",void 0);R([I()],j.prototype,"_needDepthPrePass",void 0);R([I()],j.prototype,"disableDepthWrite",void 0);R([I()],j.prototype,"disableColorWrite",void 0);R([I()],j.prototype,"forceDepthWrite",void 0);R([I()],j.prototype,"depthFunction",void 0);R([I()],j.prototype,"separateCullingPass",void 0);R([I("fogEnabled")],j.prototype,"_fogEnabled",void 0);R([I()],j.prototype,"pointSize",void 0);R([I()],j.prototype,"zOffset",void 0);R([I()],j.prototype,"zOffsetUnits",void 0);R([I()],j.prototype,"pointsCloud",null);R([I()],j.prototype,"fillMode",null);R([I()],j.prototype,"useLogarithmicDepth",null);R([I()],j.prototype,"transparencyMode",null);class Na extends j{get subMaterials(){return this._subMaterials}set subMaterials(e){this._subMaterials=e,this._hookArray(e)}getChildren(){return this.subMaterials}constructor(e,t){super(e,t,!0),this._waitingSubMaterialsUniqueIds=[],this.getScene().addMultiMaterial(this),this.subMaterials=[],this._storeEffectOnSubMeshes=!0}_hookArray(e){const t=e.push;e.push=(...r)=>{const s=t.apply(e,r);return this._markAllSubMeshesAsTexturesDirty(),s};const i=e.splice;e.splice=(r,s)=>{const a=i.apply(e,[r,s]);return this._markAllSubMeshesAsTexturesDirty(),a}}getSubMaterial(e){return e<0||e>=this.subMaterials.length?this.getScene().defaultMaterial:this.subMaterials[e]}getActiveTextures(){return super.getActiveTextures().concat(...this.subMaterials.map(e=>e?e.getActiveTextures():[]))}hasTexture(e){var t;if(super.hasTexture(e))return!0;for(let i=0;i<this.subMaterials.length;i++)if((t=this.subMaterials[i])!=null&&t.hasTexture(e))return!0;return!1}getClassName(){return"MultiMaterial"}isReadyForSubMesh(e,t,i){for(let r=0;r<this.subMaterials.length;r++){const s=this.subMaterials[r];if(s){if(s._storeEffectOnSubMeshes){if(!s.isReadyForSubMesh(e,t,i))return!1;continue}if(!s.isReady(e))return!1}}return!0}clone(e,t){const i=new Na(e,this.getScene());for(let r=0;r<this.subMaterials.length;r++){let s=null;const a=this.subMaterials[r];t&&a?s=a.clone(e+"-"+a.name):s=this.subMaterials[r],i.subMaterials.push(s)}return i}serialize(){const e={};e.name=this.name,e.id=this.id,e.uniqueId=this.uniqueId,ct&&(e.tags=ct.GetTags(this)),e.materialsUniqueIds=[],e.materials=[];for(let t=0;t<this.subMaterials.length;t++){const i=this.subMaterials[t];i?(e.materialsUniqueIds.push(i.uniqueId),e.materials.push(i.id)):(e.materialsUniqueIds.push(null),e.materials.push(null))}return e}dispose(e,t,i){const r=this.getScene();if(!r)return;if(i)for(let a=0;a<this.subMaterials.length;a++){const l=this.subMaterials[a];l&&l.dispose(e,t)}const s=r.multiMaterials.indexOf(this);s>=0&&r.multiMaterials.splice(s,1),super.dispose(e,t)}static ParseMultiMaterial(e,t){const i=new Na(e.name,t);return i.id=e.id,i._loadedUniqueId=e.uniqueId,ct&&ct.AddTagsTo(i,e.tags),e.materialsUniqueIds?i._waitingSubMaterialsUniqueIds=e.materialsUniqueIds:e.materials.forEach(r=>i.subMaterials.push(t.getLastMaterialById(r))),i}}Ji("BABYLON.MultiMaterial",Na);class lF{constructor(e,t){this.distanceOrScreenCoverage=e,this.mesh=t}}class cF{constructor(){this.visibleInstances={},this.batchCache=new lE,this.batchCacheReplacementModeInFrozenMode=new lE,this.instancesBufferSize=32*16*4}}class lE{constructor(){this.mustReturn=!1,this.visibleInstances=new Array,this.renderSelf=[],this.hardwareInstancedRendering=[]}}class uF{constructor(){this.instancesCount=0,this.matrixBuffer=null,this.previousMatrixBuffer=null,this.matrixBufferSize=32*16,this.matrixData=null,this.boundingVectors=[],this.worldMatrices=null}}class hF{constructor(){this._areNormalsFrozen=!1,this._source=null,this.meshMap=null,this._preActivateId=-1,this._LODLevels=new Array,this._useLODScreenCoverage=!1,this._effectiveMaterial=null,this._forcedInstanceCount=0,this._overrideRenderingFillMode=null}}class Ae extends yr{static _GetDefaultSideOrientation(e){return e||Ae.FRONTSIDE}get useLODScreenCoverage(){return this._internalMeshDataInfo._useLODScreenCoverage}set useLODScreenCoverage(e){this._internalMeshDataInfo._useLODScreenCoverage=e,this._sortLODLevels()}get computeBonesUsingShaders(){return this._internalAbstractMeshDataInfo._computeBonesUsingShaders}set computeBonesUsingShaders(e){this._internalAbstractMeshDataInfo._computeBonesUsingShaders!==e&&(e&&this._internalMeshDataInfo._sourcePositions&&(this.setVerticesData(x.PositionKind,this._internalMeshDataInfo._sourcePositions,!0),this._internalMeshDataInfo._sourceNormals&&this.setVerticesData(x.NormalKind,this._internalMeshDataInfo._sourceNormals,!0),this._internalMeshDataInfo._sourcePositions=null,this._internalMeshDataInfo._sourceNormals=null),this._internalAbstractMeshDataInfo._computeBonesUsingShaders=e,this._markSubMeshesAsAttributesDirty())}get onBeforeRenderObservable(){return this._internalMeshDataInfo._onBeforeRenderObservable||(this._internalMeshDataInfo._onBeforeRenderObservable=new Y),this._internalMeshDataInfo._onBeforeRenderObservable}get onBeforeBindObservable(){return this._internalMeshDataInfo._onBeforeBindObservable||(this._internalMeshDataInfo._onBeforeBindObservable=new Y),this._internalMeshDataInfo._onBeforeBindObservable}get onAfterRenderObservable(){return this._internalMeshDataInfo._onAfterRenderObservable||(this._internalMeshDataInfo._onAfterRenderObservable=new Y),this._internalMeshDataInfo._onAfterRenderObservable}get onBetweenPassObservable(){return this._internalMeshDataInfo._onBetweenPassObservable||(this._internalMeshDataInfo._onBetweenPassObservable=new Y),this._internalMeshDataInfo._onBetweenPassObservable}get onBeforeDrawObservable(){return this._internalMeshDataInfo._onBeforeDrawObservable||(this._internalMeshDataInfo._onBeforeDrawObservable=new Y),this._internalMeshDataInfo._onBeforeDrawObservable}set onBeforeDraw(e){this._onBeforeDrawObserver&&this.onBeforeDrawObservable.remove(this._onBeforeDrawObserver),this._onBeforeDrawObserver=this.onBeforeDrawObservable.add(e)}get hasInstances(){return this.instances.length>0}get hasThinInstances(){return(this.forcedInstanceCount||this._thinInstanceDataStorage.instancesCount||0)>0}get forcedInstanceCount(){return this._internalMeshDataInfo._forcedInstanceCount}set forcedInstanceCount(e){this._internalMeshDataInfo._forcedInstanceCount=e}get overrideRenderingFillMode(){return this._internalMeshDataInfo._overrideRenderingFillMode}set overrideRenderingFillMode(e){this._internalMeshDataInfo._overrideRenderingFillMode=e}get source(){return this._internalMeshDataInfo._source}get cloneMeshMap(){return this._internalMeshDataInfo.meshMap}get isUnIndexed(){return this._unIndexed}set isUnIndexed(e){this._unIndexed!==e&&(this._unIndexed=e,this._markSubMeshesAsAttributesDirty())}get worldMatrixInstancedBuffer(){return this._instanceDataStorage.instancesData}get previousWorldMatrixInstancedBuffer(){return this._instanceDataStorage.instancesPreviousData}get manualUpdateOfWorldMatrixInstancedBuffer(){return this._instanceDataStorage.manualUpdate}set manualUpdateOfWorldMatrixInstancedBuffer(e){this._instanceDataStorage.manualUpdate=e}get manualUpdateOfPreviousWorldMatrixInstancedBuffer(){return this._instanceDataStorage.previousManualUpdate}set manualUpdateOfPreviousWorldMatrixInstancedBuffer(e){this._instanceDataStorage.previousManualUpdate=e}get forceWorldMatrixInstancedBufferUpdate(){return this._instanceDataStorage.forceMatrixUpdates}set forceWorldMatrixInstancedBufferUpdate(e){this._instanceDataStorage.forceMatrixUpdates=e}constructor(e,t=null,i=null,r=null,s,a=!0){if(super(e,t),this._internalMeshDataInfo=new hF,this.delayLoadState=0,this.instances=[],this._creationDataStorage=null,this._geometry=null,this._instanceDataStorage=new cF,this._thinInstanceDataStorage=new uF,this._shouldGenerateFlatShading=!1,this._originalBuilderSideOrientation=Ae.DEFAULTSIDE,this.overrideMaterialSideOrientation=null,this.ignoreCameraMaxZ=!1,t=this.getScene(),this._onBeforeDraw=(l,o,c)=>{l&&c&&(this._uniformBuffer?this.transferToEffect(o):c.bindOnlyWorldMatrix(o))},r){if(r._geometry&&r._geometry.applyToMesh(this),cm.DeepCopy(r,this,["name","material","skeleton","instances","parent","uniqueId","source","metadata","morphTargetManager","hasInstances","worldMatrixInstancedBuffer","previousWorldMatrixInstancedBuffer","hasLODLevels","geometry","isBlocked","areNormalsFrozen","facetNb","isFacetDataEnabled","lightSources","useBones","isAnInstance","collider","edgesRenderer","forward","up","right","absolutePosition","absoluteScaling","absoluteRotationQuaternion","isWorldMatrixFrozen","nonUniformScaling","behaviors","worldMatrixFromCache","hasThinInstances","cloneMeshMap","hasBoundingInfo","physicsBody","physicsImpostor"],["_poseMatrix"]),this._internalMeshDataInfo._source=r,t.useClonedMeshMap&&(r._internalMeshDataInfo.meshMap||(r._internalMeshDataInfo.meshMap={}),r._internalMeshDataInfo.meshMap[this.uniqueId]=this),this._originalBuilderSideOrientation=r._originalBuilderSideOrientation,this._creationDataStorage=r._creationDataStorage,r._ranges){const l=r._ranges;for(const o in l)Object.prototype.hasOwnProperty.call(l,o)&&l[o]&&this.createAnimationRange(o,l[o].from,l[o].to)}if(r.metadata&&r.metadata.clone?this.metadata=r.metadata.clone():this.metadata=r.metadata,this._internalMetadata=r._internalMetadata,ct&&ct.HasTags(r)&&ct.AddTagsTo(this,ct.GetTags(r,!0)),this.setEnabled(r.isEnabled(!1)),this.parent=r.parent,this.setPivotMatrix(r.getPivotMatrix(),this._postMultiplyPivotMatrix),this.id=e+"."+r.id,this.material=r.material,!s){const l=r.getDescendants(!0);for(let o=0;o<l.length;o++){const c=l[o];c.clone&&c.clone(e+"."+c.name,this)}}if(r.morphTargetManager&&(this.morphTargetManager=r.morphTargetManager),t.getPhysicsEngine){const l=t.getPhysicsEngine();if(a&&l)if(l.getPluginVersion()===1){const o=l.getImpostorForPhysicsObject(r);o&&(this.physicsImpostor=o.clone(this))}else l.getPluginVersion()===2&&r.physicsBody&&r.physicsBody.clone(this)}for(let l=0;l<t.particleSystems.length;l++){const o=t.particleSystems[l];o.emitter===r&&o.clone(o.name,this)}this.skeleton=r.skeleton,this.refreshBoundingInfo(!0,!0),this.computeWorldMatrix(!0)}i!==null&&(this.parent=i),this._instanceDataStorage.hardwareInstancedRendering=this.getEngine().getCaps().instancedArrays,this._internalMeshDataInfo._onMeshReadyObserverAdded=l=>{l.unregisterOnNextCall=!0,this.isReady(!0)?this.onMeshReadyObservable.notifyObservers(this):this._internalMeshDataInfo._checkReadinessObserver||(this._internalMeshDataInfo._checkReadinessObserver=this._scene.onBeforeRenderObservable.add(()=>{this.isReady(!0)&&(this._scene.onBeforeRenderObservable.remove(this._internalMeshDataInfo._checkReadinessObserver),this._internalMeshDataInfo._checkReadinessObserver=null,this.onMeshReadyObservable.notifyObservers(this))}))},this.onMeshReadyObservable=new Y(this._internalMeshDataInfo._onMeshReadyObserverAdded),r&&r.onClonedObservable.notifyObservers(this)}instantiateHierarchy(e=null,t,i){const r=this.getTotalVertices()===0||t&&t.doNotInstantiate&&(t.doNotInstantiate===!0||t.doNotInstantiate(this))?this.clone("Clone of "+(this.name||this.id),e||this.parent,!0):this.createInstance("instance of "+(this.name||this.id));r.parent=e||this.parent,r.position=this.position.clone(),r.scaling=this.scaling.clone(),this.rotationQuaternion?r.rotationQuaternion=this.rotationQuaternion.clone():r.rotation=this.rotation.clone(),i&&i(this,r);for(const s of this.getChildTransformNodes(!0))s.getClassName()==="InstancedMesh"&&r.getClassName()==="Mesh"&&s.sourceMesh===this?s.instantiateHierarchy(r,{doNotInstantiate:t&&t.doNotInstantiate||!1,newSourcedMesh:r},i):s.instantiateHierarchy(r,t,i);return r}getClassName(){return"Mesh"}get _isMesh(){return!0}toString(e){let t=super.toString(e);if(t+=", n vertices: "+this.getTotalVertices(),t+=", parent: "+(this._waitingParentId?this._waitingParentId:this.parent?this.parent.name:"NONE"),this.animations)for(let i=0;i<this.animations.length;i++)t+=", animation[0]: "+this.animations[i].toString(e);if(e)if(this._geometry){const i=this.getIndices(),r=this.getVerticesData(x.PositionKind);r&&i&&(t+=", flat shading: "+(r.length/3===i.length?"YES":"NO"))}else t+=", flat shading: UNKNOWN";return t}_unBindEffect(){super._unBindEffect();for(const e of this.instances)e._unBindEffect()}get hasLODLevels(){return this._internalMeshDataInfo._LODLevels.length>0}getLODLevels(){return this._internalMeshDataInfo._LODLevels}_sortLODLevels(){const e=this._internalMeshDataInfo._useLODScreenCoverage?-1:1;this._internalMeshDataInfo._LODLevels.sort((t,i)=>t.distanceOrScreenCoverage<i.distanceOrScreenCoverage?e:t.distanceOrScreenCoverage>i.distanceOrScreenCoverage?-e:0)}addLODLevel(e,t){if(t&&t._masterMesh)return ee.Warn("You cannot use a mesh as LOD level twice"),this;const i=new lF(e,t);return this._internalMeshDataInfo._LODLevels.push(i),t&&(t._masterMesh=this),this._sortLODLevels(),this}getLODLevelAtDistance(e){const t=this._internalMeshDataInfo;for(let i=0;i<t._LODLevels.length;i++){const r=t._LODLevels[i];if(r.distanceOrScreenCoverage===e)return r.mesh}return null}removeLODLevel(e){const t=this._internalMeshDataInfo;for(let i=0;i<t._LODLevels.length;i++)t._LODLevels[i].mesh===e&&(t._LODLevels.splice(i,1),e&&(e._masterMesh=null));return this._sortLODLevels(),this}getLOD(e,t){const i=this._internalMeshDataInfo;if(!i._LODLevels||i._LODLevels.length===0)return this;const r=t||this.getBoundingInfo().boundingSphere,s=e.mode===Ie.ORTHOGRAPHIC_CAMERA?e.minZ:r.centerWorld.subtract(e.globalPosition).length();let a=s,l=1;if(i._useLODScreenCoverage){const o=e.screenArea;let c=r.radiusWorld*e.minZ/s;c=c*c*Math.PI,a=c/o,l=-1}if(l*i._LODLevels[i._LODLevels.length-1].distanceOrScreenCoverage>l*a)return this.onLODLevelSelection&&this.onLODLevelSelection(a,this,this),this;for(let o=0;o<i._LODLevels.length;o++){const c=i._LODLevels[o];if(l*c.distanceOrScreenCoverage<l*a){if(c.mesh){if(c.mesh.delayLoadState===4)return c.mesh._checkDelayState(),this;if(c.mesh.delayLoadState===2)return this;c.mesh._preActivate(),c.mesh._updateSubMeshesBoundingInfo(this.worldMatrixFromCache)}return this.onLODLevelSelection&&this.onLODLevelSelection(a,this,c.mesh),c.mesh}}return this.onLODLevelSelection&&this.onLODLevelSelection(a,this,this),this}get geometry(){return this._geometry}getTotalVertices(){return this._geometry===null||this._geometry===void 0?0:this._geometry.getTotalVertices()}getVerticesData(e,t,i,r){var a,l;if(!this._geometry)return null;let s=r||(l=(a=this._userInstancedBuffersStorage)==null?void 0:a.vertexBuffers[e])==null?void 0:l.getFloatData(this.instances.length+1,i||t&&this._geometry.meshes.length!==1);return s||(s=this._geometry.getVerticesData(e,t,i)),s}getVertexBuffer(e,t){var i;return this._geometry?(t||(i=this._userInstancedBuffersStorage)==null?void 0:i.vertexBuffers[e])??this._geometry.getVertexBuffer(e):null}isVerticesDataPresent(e,t){var i;return this._geometry?!t&&((i=this._userInstancedBuffersStorage)==null?void 0:i.vertexBuffers[e])!==void 0||this._geometry.isVerticesDataPresent(e):this._delayInfo?this._delayInfo.indexOf(e)!==-1:!1}isVertexBufferUpdatable(e,t){var i;if(!this._geometry)return this._delayInfo?this._delayInfo.indexOf(e)!==-1:!1;if(!t){const r=(i=this._userInstancedBuffersStorage)==null?void 0:i.vertexBuffers[e];if(r)return r.isUpdatable()}return this._geometry.isVertexBufferUpdatable(e)}getVerticesDataKinds(e){if(!this._geometry){const i=[];return this._delayInfo&&this._delayInfo.forEach(function(r){i.push(r)}),i}const t=this._geometry.getVerticesDataKinds();if(!e&&this._userInstancedBuffersStorage)for(const i in this._userInstancedBuffersStorage.vertexBuffers)t.indexOf(i)===-1&&t.push(i);return t}getTotalIndices(){return this._geometry?this._geometry.getTotalIndices():0}getIndices(e,t){return this._geometry?this._geometry.getIndices(e,t):[]}get isBlocked(){return this._masterMesh!==null&&this._masterMesh!==void 0}isReady(e=!1,t=!1){var o,c,u,h,d;if(this.delayLoadState===2||!super.isReady(e))return!1;if(!this.subMeshes||this.subMeshes.length===0||!e)return!0;const i=this.getEngine(),r=this.getScene(),s=t||i.getCaps().instancedArrays&&(this.instances.length>0||this.hasThinInstances);this.computeWorldMatrix();const a=this.material||r.defaultMaterial;if(a){if(a._storeEffectOnSubMeshes)for(const f of this.subMeshes){const _=f.getMaterial();if(_){if(_._storeEffectOnSubMeshes){if(!_.isReadyForSubMesh(this,f,s))return!1}else if(!_.isReady(this,s))return!1}}else if(!a.isReady(this,s))return!1}const l=i.currentRenderPassId;for(const f of this.lightSources){const _=f.getShadowGenerators();if(!_)continue;const p=_.values();for(let v=p.next();v.done!==!0;v=p.next()){const E=v.value;if(E&&(!((o=E.getShadowMap())!=null&&o.renderList)||(c=E.getShadowMap())!=null&&c.renderList&&((h=(u=E.getShadowMap())==null?void 0:u.renderList)==null?void 0:h.indexOf(this))!==-1)){const m=E.getShadowMap().renderPassIds??[i.currentRenderPassId];for(let y=0;y<m.length;++y){i.currentRenderPassId=m[y];for(const T of this.subMeshes)if(!E.isReady(T,s,((d=T.getMaterial())==null?void 0:d.needAlphaBlendingForMesh(this))??!1))return i.currentRenderPassId=l,!1}i.currentRenderPassId=l}}}for(const f of this._internalMeshDataInfo._LODLevels)if(f.mesh&&!f.mesh.isReady(s))return!1;return!0}get areNormalsFrozen(){return this._internalMeshDataInfo._areNormalsFrozen}freezeNormals(){return this._internalMeshDataInfo._areNormalsFrozen=!0,this}unfreezeNormals(){return this._internalMeshDataInfo._areNormalsFrozen=!1,this}set overridenInstanceCount(e){this._instanceDataStorage.overridenInstanceCount=e}_preActivate(){const e=this._internalMeshDataInfo,t=this.getScene().getRenderId();return e._preActivateId===t?this:(e._preActivateId=t,this._instanceDataStorage.visibleInstances=null,this)}_preActivateForIntermediateRendering(e){return this._instanceDataStorage.visibleInstances&&(this._instanceDataStorage.visibleInstances.intermediateDefaultRenderId=e),this}_registerInstanceForRenderId(e,t){return this._instanceDataStorage.visibleInstances||(this._instanceDataStorage.visibleInstances={defaultRenderId:t,selfDefaultRenderId:this._renderId}),this._instanceDataStorage.visibleInstances[t]||(this._instanceDataStorage.previousRenderId!==void 0&&this._instanceDataStorage.isFrozen&&(this._instanceDataStorage.visibleInstances[this._instanceDataStorage.previousRenderId]=null),this._instanceDataStorage.previousRenderId=t,this._instanceDataStorage.visibleInstances[t]=new Array),this._instanceDataStorage.visibleInstances[t].push(e),this}_afterComputeWorldMatrix(){super._afterComputeWorldMatrix(),this.hasThinInstances&&(this.doNotSyncBoundingInfo||this.thinInstanceRefreshBoundingInfo(!1))}_postActivate(){this.edgesShareWithInstances&&this.edgesRenderer&&this.edgesRenderer.isEnabled&&this._renderingGroup&&(this._renderingGroup._edgesRenderers.pushNoDuplicate(this.edgesRenderer),this.edgesRenderer.customInstances.push(this.getWorldMatrix()))}refreshBoundingInfo(e=!1,t=!1){if(this.hasBoundingInfo&&this.getBoundingInfo().isLocked)return this;const i=this.geometry?this.geometry.boundingBias:null;return this._refreshBoundingInfo(this._getPositionData(e,t),i),this}_createGlobalSubMesh(e){const t=this.getTotalVertices();if(!t||!this.getIndices())return null;if(this.subMeshes&&this.subMeshes.length>0){const i=this.getIndices();if(!i)return null;const r=i.length;let s=!1;if(e)s=!0;else for(const a of this.subMeshes){if(a.indexStart+a.indexCount>r){s=!0;break}if(a.verticesStart+a.verticesCount>t){s=!0;break}}if(!s)return this.subMeshes[0]}return this.releaseSubMeshes(),new pn(0,0,t,0,this.getTotalIndices(),this)}subdivide(e){if(e<1)return;const t=this.getTotalIndices();let i=t/e|0,r=0;for(;i%3!==0;)i++;this.releaseSubMeshes();for(let s=0;s<e&&!(r>=t);s++)pn.CreateFromIndices(0,r,s===e-1?t-r:i,this,void 0,!1),r+=i;this.refreshBoundingInfo(),this.synchronizeInstances()}setVerticesData(e,t,i=!1,r){if(this._geometry)this._geometry.setVerticesData(e,t,i,r);else{const s=new Ue;s.set(t,e);const a=this.getScene();new rr(rr.RandomId(),a,s,i,this)}return this}removeVerticesData(e){this._geometry&&this._geometry.removeVerticesData(e)}markVerticesDataAsUpdatable(e,t=!0){const i=this.getVertexBuffer(e);!i||i.isUpdatable()===t||this.setVerticesData(e,this.getVerticesData(e),t)}setVerticesBuffer(e,t=!0){return this._geometry||(this._geometry=rr.CreateGeometryForMesh(this)),this._geometry.setVerticesBuffer(e,null,t),this}updateVerticesData(e,t,i,r){return this._geometry?(r?(this.makeGeometryUnique(),this.updateVerticesData(e,t,i,!1)):this._geometry.updateVerticesData(e,t,i),this):this}updateMeshPositions(e,t=!0){const i=this.getVerticesData(x.PositionKind);if(!i)return this;if(e(i),this.updateVerticesData(x.PositionKind,i,!1,!1),t){const r=this.getIndices(),s=this.getVerticesData(x.NormalKind);if(!s)return this;Ue.ComputeNormals(i,r,s),this.updateVerticesData(x.NormalKind,s,!1,!1)}return this}makeGeometryUnique(){if(!this._geometry)return this;if(this._geometry.meshes.length===1)return this;const e=this._geometry,t=this._geometry.copy(rr.RandomId());return e.releaseForMesh(this,!0),t.applyToMesh(this),this}setIndexBuffer(e,t,i){let r=this._geometry;r||(r=new rr(rr.RandomId(),this.getScene(),void 0,void 0,this)),r.setIndexBuffer(e,t,i)}setIndices(e,t=null,i=!1){if(this._geometry)this._geometry.setIndices(e,t,i);else{const r=new Ue;r.indices=e;const s=this.getScene();new rr(rr.RandomId(),s,r,i,this)}return this}updateIndices(e,t,i=!1){return this._geometry?(this._geometry.updateIndices(e,t,i),this):this}toLeftHanded(){return this._geometry?(this._geometry.toLeftHanded(),this):this}_bind(e,t,i,r=!0){if(!this._geometry)return this;const s=this.getScene().getEngine();this.morphTargetManager&&this.morphTargetManager.isUsingTextureForTargets&&this.morphTargetManager._bind(t);let a;if(this._unIndexed)a=null;else switch(this._getRenderingFillMode(i)){case j.PointFillMode:a=null;break;case j.WireFrameFillMode:a=e._getLinesIndexBuffer(this.getIndices(),s);break;default:case j.TriangleFillMode:a=this._geometry.getIndexBuffer();break}return!r||!this._userInstancedBuffersStorage||this.hasThinInstances?this._geometry._bind(t,a):this._geometry._bind(t,a,this._userInstancedBuffersStorage.vertexBuffers,this._userInstancedBuffersStorage.vertexArrayObjects),this}_draw(e,t,i){if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;this._internalMeshDataInfo._onBeforeDrawObservable&&this._internalMeshDataInfo._onBeforeDrawObservable.notifyObservers(this);const s=this.getScene().getEngine();return this._unIndexed||t==j.PointFillMode?s.drawArraysType(t,e.verticesStart,e.verticesCount,this.forcedInstanceCount||i):t==j.WireFrameFillMode?s.drawElementsType(t,0,e._linesIndexCount,this.forcedInstanceCount||i):s.drawElementsType(t,e.indexStart,e.indexCount,this.forcedInstanceCount||i),this}registerBeforeRender(e){return this.onBeforeRenderObservable.add(e),this}unregisterBeforeRender(e){return this.onBeforeRenderObservable.removeCallback(e),this}registerAfterRender(e){return this.onAfterRenderObservable.add(e),this}unregisterAfterRender(e){return this.onAfterRenderObservable.removeCallback(e),this}_getInstancesRenderList(e,t=!1){if(this._instanceDataStorage.isFrozen){if(t)return this._instanceDataStorage.batchCacheReplacementModeInFrozenMode.hardwareInstancedRendering[e]=!1,this._instanceDataStorage.batchCacheReplacementModeInFrozenMode.renderSelf[e]=!0,this._instanceDataStorage.batchCacheReplacementModeInFrozenMode;if(this._instanceDataStorage.previousBatch)return this._instanceDataStorage.previousBatch}const i=this.getScene(),r=i._isInIntermediateRendering(),s=r?this._internalAbstractMeshDataInfo._onlyForInstancesIntermediate:this._internalAbstractMeshDataInfo._onlyForInstances,a=this._instanceDataStorage.batchCache;if(a.mustReturn=!1,a.renderSelf[e]=t||!s&&this.isEnabled()&&this.isVisible,a.visibleInstances[e]=null,this._instanceDataStorage.visibleInstances&&!t){const l=this._instanceDataStorage.visibleInstances,o=i.getRenderId(),c=r?l.intermediateDefaultRenderId:l.defaultRenderId;a.visibleInstances[e]=l[o],!a.visibleInstances[e]&&c&&(a.visibleInstances[e]=l[c])}return a.hardwareInstancedRendering[e]=!t&&this._instanceDataStorage.hardwareInstancedRendering&&a.visibleInstances[e]!==null&&a.visibleInstances[e]!==void 0,this._instanceDataStorage.previousBatch=a,a}_renderWithInstances(e,t,i,r,s){var g;const a=i.visibleInstances[e._id],l=a?a.length:0,o=this._instanceDataStorage,c=o.instancesBufferSize;let u=o.instancesBuffer,h=o.instancesPreviousBuffer;const f=(l+1)*16*4;for(;o.instancesBufferSize<f;)o.instancesBufferSize*=2;(!o.instancesData||c!=o.instancesBufferSize)&&(o.instancesData=new Float32Array(o.instancesBufferSize/4)),(this._scene.needsPreviousWorldMatrices&&!o.instancesPreviousData||c!=o.instancesBufferSize)&&(o.instancesPreviousData=new Float32Array(o.instancesBufferSize/4));let _=0,p=0;const v=i.renderSelf[e._id],E=!u||c!==o.instancesBufferSize||this._scene.needsPreviousWorldMatrices&&!o.instancesPreviousBuffer;if(!this._instanceDataStorage.manualUpdate&&(!o.isFrozen||E)){const m=this.getWorldMatrix();if(v&&(this._scene.needsPreviousWorldMatrices&&(o.masterMeshPreviousWorldMatrix?(o.masterMeshPreviousWorldMatrix.copyToArray(o.instancesPreviousData,_),o.masterMeshPreviousWorldMatrix.copyFrom(m)):(o.masterMeshPreviousWorldMatrix=m.clone(),o.masterMeshPreviousWorldMatrix.copyToArray(o.instancesPreviousData,_))),m.copyToArray(o.instancesData,_),_+=16,p++),a){if(Ae.INSTANCEDMESH_SORT_TRANSPARENT&&this._scene.activeCamera&&((g=e.getMaterial())!=null&&g.needAlphaBlendingForMesh(e.getRenderingMesh()))){const y=this._scene.activeCamera.globalPosition;for(let T=0;T<a.length;T++){const b=a[T];b._distanceToCamera=A.Distance(b.getBoundingInfo().boundingSphere.centerWorld,y)}a.sort((T,b)=>T._distanceToCamera>b._distanceToCamera?-1:T._distanceToCamera<b._distanceToCamera?1:0)}for(let y=0;y<a.length;y++){const T=a[y],b=T.getWorldMatrix();b.copyToArray(o.instancesData,_),this._scene.needsPreviousWorldMatrices&&(T._previousWorldMatrix?(T._previousWorldMatrix.copyToArray(o.instancesPreviousData,_),T._previousWorldMatrix.copyFrom(b)):(T._previousWorldMatrix=b.clone(),T._previousWorldMatrix.copyToArray(o.instancesPreviousData,_))),_+=16,p++}}}else p=(v?1:0)+l;return E?(u&&u.dispose(),h&&h.dispose(),u=new ou(s,o.instancesData,!0,16,!1,!0),o.instancesBuffer=u,this._userInstancedBuffersStorage||(this._userInstancedBuffersStorage={data:{},vertexBuffers:{},strides:{},sizes:{},vertexArrayObjects:this.getEngine().getCaps().vertexArrayObject?{}:void 0}),this._userInstancedBuffersStorage.vertexBuffers.world0=u.createVertexBuffer("world0",0,4),this._userInstancedBuffersStorage.vertexBuffers.world1=u.createVertexBuffer("world1",4,4),this._userInstancedBuffersStorage.vertexBuffers.world2=u.createVertexBuffer("world2",8,4),this._userInstancedBuffersStorage.vertexBuffers.world3=u.createVertexBuffer("world3",12,4),this._scene.needsPreviousWorldMatrices&&(h=new ou(s,o.instancesPreviousData,!0,16,!1,!0),o.instancesPreviousBuffer=h,this._userInstancedBuffersStorage.vertexBuffers.previousWorld0=h.createVertexBuffer("previousWorld0",0,4),this._userInstancedBuffersStorage.vertexBuffers.previousWorld1=h.createVertexBuffer("previousWorld1",4,4),this._userInstancedBuffersStorage.vertexBuffers.previousWorld2=h.createVertexBuffer("previousWorld2",8,4),this._userInstancedBuffersStorage.vertexBuffers.previousWorld3=h.createVertexBuffer("previousWorld3",12,4)),this._invalidateInstanceVertexArrayObject()):(!this._instanceDataStorage.isFrozen||this._instanceDataStorage.forceMatrixUpdates)&&(u.updateDirectly(o.instancesData,0,p),this._scene.needsPreviousWorldMatrices&&(!this._instanceDataStorage.manualUpdate||this._instanceDataStorage.previousManualUpdate)&&h.updateDirectly(o.instancesPreviousData,0,p)),this._processInstancedBuffers(a,v),this.getScene()._activeIndices.addCount(e.indexCount*p,!1),s._currentDrawContext&&(s._currentDrawContext.useInstancing=!0),this._bind(e,r,t),this._draw(e,t,p),this._scene.needsPreviousWorldMatrices&&!E&&this._instanceDataStorage.manualUpdate&&(!this._instanceDataStorage.isFrozen||this._instanceDataStorage.forceMatrixUpdates)&&!this._instanceDataStorage.previousManualUpdate&&h.updateDirectly(o.instancesData,0,p),s.unbindInstanceAttributes(),this}_renderWithThinInstances(e,t,i,r){var a;const s=((a=this._thinInstanceDataStorage)==null?void 0:a.instancesCount)??0;this.getScene()._activeIndices.addCount(e.indexCount*s,!1),r._currentDrawContext&&(r._currentDrawContext.useInstancing=!0),this._bind(e,i,t),this._draw(e,t,s),this._scene.needsPreviousWorldMatrices&&!this._thinInstanceDataStorage.previousMatrixData&&this._thinInstanceDataStorage.matrixData&&(this._thinInstanceDataStorage.previousMatrixBuffer?this._thinInstanceDataStorage.previousMatrixBuffer.updateDirectly(this._thinInstanceDataStorage.matrixData,0,s):this._thinInstanceDataStorage.previousMatrixBuffer=this._thinInstanceCreateMatrixBuffer("previousWorld",this._thinInstanceDataStorage.matrixData,!1)),r.unbindInstanceAttributes()}_processInstancedBuffers(e,t){}_processRendering(e,t,i,r,s,a,l,o){const c=this.getScene(),u=c.getEngine();if(r=this._getRenderingFillMode(r),a&&t.getRenderingMesh().hasThinInstances)return this._renderWithThinInstances(t,r,i,u),this;if(a)this._renderWithInstances(t,r,s,i,u);else{u._currentDrawContext&&(u._currentDrawContext.useInstancing=!1);let h=0;s.renderSelf[t._id]&&(l&&l(!1,e.getWorldMatrix(),o),h++,this._draw(t,r,this._instanceDataStorage.overridenInstanceCount));const d=s.visibleInstances[t._id];if(d){const f=d.length;h+=f;for(let _=0;_<f;_++){const v=d[_].getWorldMatrix();l&&l(!0,v,o),this._draw(t,r)}}c._activeIndices.addCount(t.indexCount*h,!1)}return this}_rebuild(e=!1){if(this._instanceDataStorage.instancesBuffer&&(e&&this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null),this._userInstancedBuffersStorage){for(const t in this._userInstancedBuffersStorage.vertexBuffers){const i=this._userInstancedBuffersStorage.vertexBuffers[t];i&&(e&&i.dispose(),this._userInstancedBuffersStorage.vertexBuffers[t]=null)}this._userInstancedBuffersStorage.vertexArrayObjects&&(this._userInstancedBuffersStorage.vertexArrayObjects={})}this._internalMeshDataInfo._effectiveMaterial=null,super._rebuild(e)}_freeze(){if(this.subMeshes){for(let e=0;e<this.subMeshes.length;e++)this._getInstancesRenderList(e);this._internalMeshDataInfo._effectiveMaterial=null,this._instanceDataStorage.isFrozen=!0}}_unFreeze(){this._instanceDataStorage.isFrozen=!1,this._instanceDataStorage.previousBatch=null}renderWithRenderPassId(e,t,i,r,s=!0){const a=this._scene.getEngine(),l=a.currentRenderPassId;if(e!==void 0&&(a.currentRenderPassId=e),r)(!s||s&&r.isInFrustum(this._scene._frustumPlanes))&&this.render(r,!!t,i);else for(let o=0;o<this.subMeshes.length;o++){const c=this.subMeshes[o];(!s||s&&c.isInFrustum(this._scene._frustumPlanes))&&this.render(c,!!t,i)}return e!==void 0&&(a.currentRenderPassId=l),this}render(e,t,i){var C,M;const r=this.getScene();this._internalAbstractMeshDataInfo._isActiveIntermediate?this._internalAbstractMeshDataInfo._isActiveIntermediate=!1:this._internalAbstractMeshDataInfo._isActive=!1;const s=((C=r.activeCameras)==null?void 0:C.length)??0;if((s>1&&r.activeCamera===r.activeCameras[0]||s<=1)&&this._checkOcclusionQuery()&&!this._occlusionDataStorage.forceRenderingWhenOccluded)return this;const l=this._getInstancesRenderList(e._id,!!i);if(l.mustReturn)return this;if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;const o=r.getEngine();let c=0,u=null;this.ignoreCameraMaxZ&&r.activeCamera&&!r._isInIntermediateRendering()&&(c=r.activeCamera.maxZ,u=r.activeCamera,r.activeCamera.maxZ=0,r.updateTransformMatrix(!0)),this._internalMeshDataInfo._onBeforeRenderObservable&&this._internalMeshDataInfo._onBeforeRenderObservable.notifyObservers(this);const h=e.getRenderingMesh(),d=l.hardwareInstancedRendering[e._id]||h.hasThinInstances||!!this._userInstancedBuffersStorage&&!e.getMesh()._internalAbstractMeshDataInfo._actAsRegularMesh,f=this._instanceDataStorage,_=e.getMaterial();if(!_)return u&&(u.maxZ=c,r.updateTransformMatrix(!0)),this;if(!f.isFrozen||!this._internalMeshDataInfo._effectiveMaterial||this._internalMeshDataInfo._effectiveMaterial!==_){if(_._storeEffectOnSubMeshes){if(!_.isReadyForSubMesh(this,e,d))return u&&(u.maxZ=c,r.updateTransformMatrix(!0)),this}else if(!_.isReady(this,d))return u&&(u.maxZ=c,r.updateTransformMatrix(!0)),this;this._internalMeshDataInfo._effectiveMaterial=_}else if(_._storeEffectOnSubMeshes&&!((M=e._drawWrapper)!=null&&M._wasPreviouslyReady)||!_._storeEffectOnSubMeshes&&!_._getDrawWrapper()._wasPreviouslyReady)return u&&(u.maxZ=c,r.updateTransformMatrix(!0)),this;t&&o.setAlphaMode(this._internalMeshDataInfo._effectiveMaterial.alphaMode);let p;this._internalMeshDataInfo._effectiveMaterial._storeEffectOnSubMeshes?p=e._drawWrapper:p=this._internalMeshDataInfo._effectiveMaterial._getDrawWrapper();const v=(p==null?void 0:p.effect)??null;for(const F of r._beforeRenderingMeshStage)F.action(this,e,l,v);if(!p||!v)return u&&(u.maxZ=c,r.updateTransformMatrix(!0)),this;const E=i||this;let g;if(!f.isFrozen&&(this._internalMeshDataInfo._effectiveMaterial.backFaceCulling||this.overrideMaterialSideOrientation!==null||this._internalMeshDataInfo._effectiveMaterial.twoSidedLighting)){const F=E._getWorldMatrixDeterminant();g=this.overrideMaterialSideOrientation,g==null&&(g=this._internalMeshDataInfo._effectiveMaterial.sideOrientation),F<0&&(g=g===j.ClockWiseSideOrientation?j.CounterClockWiseSideOrientation:j.ClockWiseSideOrientation),f.sideOrientation=g}else g=f.sideOrientation;const m=this._internalMeshDataInfo._effectiveMaterial._preBind(p,g);this._internalMeshDataInfo._effectiveMaterial.forceDepthWrite&&o.setDepthWrite(!0);const y=this._internalMeshDataInfo._effectiveMaterial,T=y.fillMode;this._internalMeshDataInfo._onBeforeBindObservable&&this._internalMeshDataInfo._onBeforeBindObservable.notifyObservers(this),d||this._bind(e,v,T,!1);const b=E.getWorldMatrix();y._storeEffectOnSubMeshes?y.bindForSubMesh(b,this,e):y.bind(b,this),!y.backFaceCulling&&y.separateCullingPass&&(o.setState(!0,y.zOffset,!1,!m,y.cullBackFaces,y.stencil,y.zOffsetUnits),this._processRendering(this,e,v,T,l,d,this._onBeforeDraw,this._internalMeshDataInfo._effectiveMaterial),o.setState(!0,y.zOffset,!1,m,y.cullBackFaces,y.stencil,y.zOffsetUnits),this._internalMeshDataInfo._onBetweenPassObservable&&this._internalMeshDataInfo._onBetweenPassObservable.notifyObservers(e)),this._processRendering(this,e,v,T,l,d,this._onBeforeDraw,this._internalMeshDataInfo._effectiveMaterial),this._internalMeshDataInfo._effectiveMaterial.unbind();for(const F of r._afterRenderingMeshStage)F.action(this,e,l,v);return this._internalMeshDataInfo._onAfterRenderObservable&&this._internalMeshDataInfo._onAfterRenderObservable.notifyObservers(this),u&&(u.maxZ=c,r.updateTransformMatrix(!0)),r.performancePriority===ns.Aggressive&&!f.isFrozen&&this._freeze(),this}cleanMatrixWeights(){this.isVerticesDataPresent(x.MatricesWeightsKind)&&(this.isVerticesDataPresent(x.MatricesWeightsExtraKind)?this._normalizeSkinWeightsAndExtra():this._normalizeSkinFourWeights())}_normalizeSkinFourWeights(){const e=this.getVerticesData(x.MatricesWeightsKind),t=e.length;for(let i=0;i<t;i+=4){const r=e[i]+e[i+1]+e[i+2]+e[i+3];if(r===0)e[i]=1;else{const s=1/r;e[i]*=s,e[i+1]*=s,e[i+2]*=s,e[i+3]*=s}}this.setVerticesData(x.MatricesWeightsKind,e)}_normalizeSkinWeightsAndExtra(){const e=this.getVerticesData(x.MatricesWeightsExtraKind),t=this.getVerticesData(x.MatricesWeightsKind),i=t.length;for(let r=0;r<i;r+=4){let s=t[r]+t[r+1]+t[r+2]+t[r+3];if(s+=e[r]+e[r+1]+e[r+2]+e[r+3],s===0)t[r]=1;else{const a=1/s;t[r]*=a,t[r+1]*=a,t[r+2]*=a,t[r+3]*=a,e[r]*=a,e[r+1]*=a,e[r+2]*=a,e[r+3]*=a}}this.setVerticesData(x.MatricesWeightsKind,t),this.setVerticesData(x.MatricesWeightsKind,e)}validateSkinning(){const e=this.getVerticesData(x.MatricesWeightsExtraKind),t=this.getVerticesData(x.MatricesWeightsKind);if(t===null||this.skeleton==null)return{skinned:!1,valid:!0,report:"not skinned"};const i=t.length;let r=0,s=0,a=0,l=0;const o=e===null?4:8,c=[];for(let v=0;v<=o;v++)c[v]=0;const u=.001;for(let v=0;v<i;v+=4){let E=t[v],g=E,m=g===0?0:1;for(let y=1;y<o;y++){const T=y<4?t[v+y]:e[v+y-4];T>E&&r++,T!==0&&m++,g+=T,E=T}if(c[m]++,m>a&&(a=m),g===0)s++;else{const y=1/g;let T=0;for(let b=0;b<o;b++)b<4?T+=Math.abs(t[v+b]-t[v+b]*y):T+=Math.abs(e[v+b-4]-e[v+b-4]*y);T>u&&l++}}const h=this.skeleton.bones.length,d=this.getVerticesData(x.MatricesIndicesKind),f=this.getVerticesData(x.MatricesIndicesExtraKind);let _=0;for(let v=0;v<i;v+=4)for(let E=0;E<o;E++){const g=E<4?d[v+E]:f[v+E-4];(g>=h||g<0)&&_++}const p="Number of Weights = "+i/4+`
Maximum influences = `+a+`
Missing Weights = `+s+`
Not Sorted = `+r+`
Not Normalized = `+l+`
WeightCounts = [`+c+`]
Number of bones = `+h+`
Bad Bone Indices = `+_;return{skinned:!0,valid:s===0&&l===0&&_===0,report:p}}_checkDelayState(){const e=this.getScene();return this._geometry?this._geometry.load(e):this.delayLoadState===4&&(this.delayLoadState=2,this._queueLoad(e)),this}_queueLoad(e){e.addPendingData(this);const t=this.delayLoadingFile.indexOf(".babylonbinarymeshdata")!==-1;return X.LoadFile(this.delayLoadingFile,i=>{i instanceof ArrayBuffer?this._delayLoadingFunction(i,this):this._delayLoadingFunction(JSON.parse(i),this),this.instances.forEach(r=>{r.refreshBoundingInfo(),r._syncSubMeshes()}),this.delayLoadState=1,e.removePendingData(this)},()=>{},e.offlineProvider,t),this}isInFrustum(e){return this.delayLoadState===2||!super.isInFrustum(e)?!1:(this._checkDelayState(),!0)}setMaterialById(e){const t=this.getScene().materials;let i;for(i=t.length-1;i>-1;i--)if(t[i].id===e)return this.material=t[i],this;const r=this.getScene().multiMaterials;for(i=r.length-1;i>-1;i--)if(r[i].id===e)return this.material=r[i],this;return this}getAnimatables(){const e=[];return this.material&&e.push(this.material),this.skeleton&&e.push(this.skeleton),e}bakeTransformIntoVertices(e){if(!this.isVerticesDataPresent(x.PositionKind))return this;const t=this.subMeshes.splice(0);this._resetPointsArrayCache();let i=this.getVerticesData(x.PositionKind);const r=A.Zero();let s;for(s=0;s<i.length;s+=3)A.TransformCoordinatesFromFloatsToRef(i[s],i[s+1],i[s+2],e,r).toArray(i,s);if(this.setVerticesData(x.PositionKind,i,this.getVertexBuffer(x.PositionKind).isUpdatable()),this.isVerticesDataPresent(x.NormalKind)){for(i=this.getVerticesData(x.NormalKind),s=0;s<i.length;s+=3)A.TransformNormalFromFloatsToRef(i[s],i[s+1],i[s+2],e,r).normalize().toArray(i,s);this.setVerticesData(x.NormalKind,i,this.getVertexBuffer(x.NormalKind).isUpdatable())}if(this.isVerticesDataPresent(x.TangentKind)){for(i=this.getVerticesData(x.TangentKind),s=0;s<i.length;s+=4)A.TransformNormalFromFloatsToRef(i[s],i[s+1],i[s+2],e,r).normalize().toArray(i,s);this.setVerticesData(x.TangentKind,i,this.getVertexBuffer(x.TangentKind).isUpdatable())}return e.determinant()<0&&this.flipFaces(),this.releaseSubMeshes(),this.subMeshes=t,this}bakeCurrentTransformIntoVertices(e=!0){return this.bakeTransformIntoVertices(this.computeWorldMatrix(!0)),this.resetLocalMatrix(e),this}get _positions(){return this._internalAbstractMeshDataInfo._positions?this._internalAbstractMeshDataInfo._positions:this._geometry?this._geometry._positions:null}_resetPointsArrayCache(){return this._geometry&&this._geometry._resetPointsArrayCache(),this}_generatePointsArray(){return this._geometry?this._geometry._generatePointsArray():!1}clone(e="",t=null,i,r=!0){return new Ae(e,this.getScene(),t,this,i,r)}dispose(e,t=!1){this.morphTargetManager=null,this._geometry&&this._geometry.releaseForMesh(this,!0);const i=this._internalMeshDataInfo;if(i._onBeforeDrawObservable&&i._onBeforeDrawObservable.clear(),i._onBeforeBindObservable&&i._onBeforeBindObservable.clear(),i._onBeforeRenderObservable&&i._onBeforeRenderObservable.clear(),i._onAfterRenderObservable&&i._onAfterRenderObservable.clear(),i._onBetweenPassObservable&&i._onBetweenPassObservable.clear(),this._scene.useClonedMeshMap){if(i.meshMap)for(const r in i.meshMap){const s=i.meshMap[r];s&&(s._internalMeshDataInfo._source=null,i.meshMap[r]=void 0)}i._source&&i._source._internalMeshDataInfo.meshMap&&(i._source._internalMeshDataInfo.meshMap[this.uniqueId]=void 0)}else{const r=this.getScene().meshes;for(const s of r){const a=s;a._internalMeshDataInfo&&a._internalMeshDataInfo._source&&a._internalMeshDataInfo._source===this&&(a._internalMeshDataInfo._source=null)}}i._source=null,this._instanceDataStorage.visibleInstances={},this._disposeInstanceSpecificData(),this._disposeThinInstanceSpecificData(),this._internalMeshDataInfo._checkReadinessObserver&&this._scene.onBeforeRenderObservable.remove(this._internalMeshDataInfo._checkReadinessObserver),super.dispose(e,t)}_disposeInstanceSpecificData(){}_disposeThinInstanceSpecificData(){}_invalidateInstanceVertexArrayObject(){}applyDisplacementMap(e,t,i,r,s,a,l=!1,o){const c=this.getScene(),u=h=>{const d=h.width,f=h.height,p=this.getEngine().createCanvas(d,f).getContext("2d");p.drawImage(h,0,0);const v=p.getImageData(0,0,d,f).data;this.applyDisplacementMapFromBuffer(v,d,f,t,i,s,a,l),r&&r(this)};return X.LoadImage(e,u,o||(()=>{}),c.offlineProvider),this}applyDisplacementMapFromBuffer(e,t,i,r,s,a,l,o=!1){if(!this.isVerticesDataPresent(x.PositionKind)||!this.isVerticesDataPresent(x.NormalKind)||!this.isVerticesDataPresent(x.UVKind))return ee.Warn("Cannot call applyDisplacementMap: Given mesh is not complete. Position, Normal or UV are missing"),this;const c=this.getVerticesData(x.PositionKind,!0,!0),u=this.getVerticesData(x.NormalKind),h=this.getVerticesData(x.UVKind);let d=A.Zero();const f=A.Zero(),_=xe.Zero();a=a||xe.Zero(),l=l||new xe(1,1);for(let p=0;p<c.length;p+=3){A.FromArrayToRef(c,p,d),A.FromArrayToRef(u,p,f),xe.FromArrayToRef(h,p/3*2,_);const v=Math.abs(_.x*l.x+a.x%1)*(t-1)%t|0,E=Math.abs(_.y*l.y+a.y%1)*(i-1)%i|0,g=(v+E*t)*4,m=e[g]/255,y=e[g+1]/255,T=e[g+2]/255,b=m*.3+y*.59+T*.11;f.normalize(),f.scaleInPlace(r+(s-r)*b),d=d.add(f),d.toArray(c,p)}return Ue.ComputeNormals(c,this.getIndices(),u),o?(this.setVerticesData(x.PositionKind,c),this.setVerticesData(x.NormalKind,u),this.setVerticesData(x.UVKind,h)):(this.updateVerticesData(x.PositionKind,c),this.updateVerticesData(x.NormalKind,u)),this}_getFlattenedNormals(e,t){const i=new Float32Array(e.length*3);let r=0;const s=this.overrideMaterialSideOrientation===(this._scene.useRightHandedSystem?1:0);for(let a=0;a<e.length;a+=3){const l=A.FromArray(t,e[a]*3),o=A.FromArray(t,e[a+1]*3),c=A.FromArray(t,e[a+2]*3),u=l.subtract(o),h=c.subtract(o),d=A.Normalize(A.Cross(u,h));s&&d.scaleInPlace(-1);for(let f=0;f<3;f++)i[r++]=d.x,i[r++]=d.y,i[r++]=d.z}return i}_convertToUnIndexedMesh(e=!1){const t=this.getVerticesDataKinds(),i=this.getIndices(),r={},s=(l,o)=>{const c=new Float32Array(i.length*o);let u=0;for(let h=0;h<i.length;h++)for(let d=0;d<o;d++)c[u++]=l[i[h]*o+d];return c},a=this.geometry?this.subMeshes.slice(0):[];for(const l of t)r[l]=this.getVerticesData(l);for(const l of t){const o=this.getVertexBuffer(l),c=o.getStrideSize();if(e&&l===x.NormalKind){const u=this._getFlattenedNormals(i,r[x.PositionKind]);this.setVerticesData(x.NormalKind,u,o.isUpdatable(),c)}else this.setVerticesData(l,s(r[l],c),o.isUpdatable(),c)}if(this.morphTargetManager){for(let l=0;l<this.morphTargetManager.numTargets;l++){const o=this.morphTargetManager.getTarget(l),c=o.getPositions();o.setPositions(s(c,3));const u=o.getNormals();u&&o.setNormals(e?this._getFlattenedNormals(i,c):s(u,3));const h=o.getTangents();h&&o.setTangents(s(h,3));const d=o.getUVs();d&&o.setUVs(s(d,2))}this.morphTargetManager.synchronize()}for(let l=0;l<i.length;l++)i[l]=l;this.setIndices(i),this._unIndexed=!0,this.releaseSubMeshes();for(const l of a)pn.AddToMesh(l.materialIndex,l.indexStart,l.indexCount,l.indexStart,l.indexCount,this);return this.synchronizeInstances(),this}convertToFlatShadedMesh(){return this._convertToUnIndexedMesh(!0)}convertToUnIndexedMesh(){return this._convertToUnIndexedMesh()}flipFaces(e=!1){const t=Ue.ExtractFromMesh(this);let i;if(e&&this.isVerticesDataPresent(x.NormalKind)&&t.normals)for(i=0;i<t.normals.length;i++)t.normals[i]*=-1;if(t.indices){let r;for(i=0;i<t.indices.length;i+=3)r=t.indices[i+1],t.indices[i+1]=t.indices[i+2],t.indices[i+2]=r}return t.applyToMesh(this,this.isVertexBufferUpdatable(x.PositionKind)),this}increaseVertices(e=1){const t=Ue.ExtractFromMesh(this),i=t.indices&&!Array.isArray(t.indices)&&Array.from?Array.from(t.indices):t.indices,r=t.positions&&!Array.isArray(t.positions)&&Array.from?Array.from(t.positions):t.positions,s=t.uvs&&!Array.isArray(t.uvs)&&Array.from?Array.from(t.uvs):t.uvs,a=t.normals&&!Array.isArray(t.normals)&&Array.from?Array.from(t.normals):t.normals;if(!i||!r)ee.Warn("Couldn't increase number of vertices : VertexData must contain at least indices and positions");else{t.indices=i,t.positions=r,s&&(t.uvs=s),a&&(t.normals=a);const l=e+1,o=new Array;for(let T=0;T<l+1;T++)o[T]=new Array;let c,u;const h=new A(0,0,0),d=new A(0,0,0),f=new xe(0,0),_=new Array,p=new Array,v=new Array;let E,g=r.length,m;s&&(m=s.length);let y;a&&(y=a.length);for(let T=0;T<i.length;T+=3){p[0]=i[T],p[1]=i[T+1],p[2]=i[T+2];for(let b=0;b<3;b++)if(c=p[b],u=p[(b+1)%3],v[c]===void 0&&v[u]===void 0?(v[c]=new Array,v[u]=new Array):(v[c]===void 0&&(v[c]=new Array),v[u]===void 0&&(v[u]=new Array)),v[c][u]===void 0&&v[u][c]===void 0){v[c][u]=[],h.x=(r[3*u]-r[3*c])/l,h.y=(r[3*u+1]-r[3*c+1])/l,h.z=(r[3*u+2]-r[3*c+2])/l,a&&(d.x=(a[3*u]-a[3*c])/l,d.y=(a[3*u+1]-a[3*c+1])/l,d.z=(a[3*u+2]-a[3*c+2])/l),s&&(f.x=(s[2*u]-s[2*c])/l,f.y=(s[2*u+1]-s[2*c+1])/l),v[c][u].push(c);for(let C=1;C<l;C++)v[c][u].push(r.length/3),r[g++]=r[3*c]+C*h.x,r[g++]=r[3*c+1]+C*h.y,r[g++]=r[3*c+2]+C*h.z,a&&(a[y++]=a[3*c]+C*d.x,a[y++]=a[3*c+1]+C*d.y,a[y++]=a[3*c+2]+C*d.z),s&&(s[m++]=s[2*c]+C*f.x,s[m++]=s[2*c+1]+C*f.y);v[c][u].push(u),v[u][c]=new Array,E=v[c][u].length;for(let C=0;C<E;C++)v[u][c][C]=v[c][u][E-1-C]}o[0][0]=i[T],o[1][0]=v[i[T]][i[T+1]][1],o[1][1]=v[i[T]][i[T+2]][1];for(let b=2;b<l;b++){o[b][0]=v[i[T]][i[T+1]][b],o[b][b]=v[i[T]][i[T+2]][b],h.x=(r[3*o[b][b]]-r[3*o[b][0]])/b,h.y=(r[3*o[b][b]+1]-r[3*o[b][0]+1])/b,h.z=(r[3*o[b][b]+2]-r[3*o[b][0]+2])/b,a&&(d.x=(a[3*o[b][b]]-a[3*o[b][0]])/b,d.y=(a[3*o[b][b]+1]-a[3*o[b][0]+1])/b,d.z=(a[3*o[b][b]+2]-a[3*o[b][0]+2])/b),s&&(f.x=(s[2*o[b][b]]-s[2*o[b][0]])/b,f.y=(s[2*o[b][b]+1]-s[2*o[b][0]+1])/b);for(let C=1;C<b;C++)o[b][C]=r.length/3,r[g++]=r[3*o[b][0]]+C*h.x,r[g++]=r[3*o[b][0]+1]+C*h.y,r[g++]=r[3*o[b][0]+2]+C*h.z,a&&(a[y++]=a[3*o[b][0]]+C*d.x,a[y++]=a[3*o[b][0]+1]+C*d.y,a[y++]=a[3*o[b][0]+2]+C*d.z),s&&(s[m++]=s[2*o[b][0]]+C*f.x,s[m++]=s[2*o[b][0]+1]+C*f.y)}o[l]=v[i[T+1]][i[T+2]],_.push(o[0][0],o[1][0],o[1][1]);for(let b=1;b<l;b++){let C;for(C=0;C<b;C++)_.push(o[b][C],o[b+1][C],o[b+1][C+1]),_.push(o[b][C],o[b+1][C+1],o[b][C+1]);_.push(o[b][C],o[b+1][C],o[b+1][C+1])}}t.indices=_,t.applyToMesh(this,this.isVertexBufferUpdatable(x.PositionKind))}}forceSharedVertices(){const e=Ue.ExtractFromMesh(this),t=e.uvs,i=e.indices,r=e.positions,s=e.colors,a=e.matricesIndices,l=e.matricesWeights,o=e.matricesIndicesExtra,c=e.matricesWeightsExtra;if(i===void 0||r===void 0||i===null||r===null)ee.Warn("VertexData contains empty entries");else{const u=new Array,h=new Array,d=new Array,f=new Array,_=new Array,p=new Array,v=new Array,E=new Array;let g=new Array,m=0;const y={};let T,b;for(let M=0;M<i.length;M+=3){b=[i[M],i[M+1],i[M+2]],g=[];for(let F=0;F<3;F++){g[F]="";for(let P=0;P<3;P++)Math.abs(r[3*b[F]+P])<1e-8&&(r[3*b[F]+P]=0),g[F]+=r[3*b[F]+P]+"|"}if(!(g[0]==g[1]||g[0]==g[2]||g[1]==g[2]))for(let F=0;F<3;F++){if(T=y[g[F]],T===void 0){y[g[F]]=m,T=m++;for(let P=0;P<3;P++)u.push(r[3*b[F]+P]);if(s!=null)for(let P=0;P<4;P++)f.push(s[4*b[F]+P]);if(t!=null)for(let P=0;P<2;P++)d.push(t[2*b[F]+P]);if(a!=null)for(let P=0;P<4;P++)_.push(a[4*b[F]+P]);if(l!=null)for(let P=0;P<4;P++)p.push(l[4*b[F]+P]);if(o!=null)for(let P=0;P<4;P++)v.push(o[4*b[F]+P]);if(c!=null)for(let P=0;P<4;P++)E.push(c[4*b[F]+P])}h.push(T)}}const C=new Array;Ue.ComputeNormals(u,h,C),e.positions=u,e.indices=h,e.normals=C,t!=null&&(e.uvs=d),s!=null&&(e.colors=f),a!=null&&(e.matricesIndices=_),l!=null&&(e.matricesWeights=p),o!=null&&(e.matricesIndicesExtra=v),l!=null&&(e.matricesWeightsExtra=E),e.applyToMesh(this,this.isVertexBufferUpdatable(x.PositionKind))}}static _instancedMeshFactory(e,t){throw ke("InstancedMesh")}static _PhysicsImpostorParser(e,t,i){throw ke("PhysicsImpostor")}createInstance(e){return Ae._instancedMeshFactory(e,this)}synchronizeInstances(){for(let e=0;e<this.instances.length;e++)this.instances[e]._syncSubMeshes();return this}optimizeIndices(e){const t=this.getIndices(),i=this.getVerticesData(x.PositionKind);if(!i||!t)return this;const r=[];for(let a=0;a<i.length;a=a+3)r.push(A.FromArray(i,a));const s=[];return Jh.SyncAsyncForLoop(r.length,40,a=>{const l=r.length-1-a,o=r[l];for(let c=0;c<l;++c){const u=r[c];if(o.equals(u)){s[l]=c;break}}},()=>{for(let l=0;l<t.length;++l)t[l]=s[t[l]]||t[l];const a=this.subMeshes.slice(0);this.setIndices(t),this.subMeshes=a,e&&e(this)}),this}serialize(e={}){e.name=this.name,e.id=this.id,e.uniqueId=this.uniqueId,e.type=this.getClassName(),ct&&ct.HasTags(this)&&(e.tags=ct.GetTags(this)),e.position=this.position.asArray(),this.rotationQuaternion?e.rotationQuaternion=this.rotationQuaternion.asArray():this.rotation&&(e.rotation=this.rotation.asArray()),e.scaling=this.scaling.asArray(),this._postMultiplyPivotMatrix?e.pivotMatrix=this.getPivotMatrix().asArray():e.localMatrix=this.getPivotMatrix().asArray(),e.isEnabled=this.isEnabled(!1),e.isVisible=this.isVisible,e.infiniteDistance=this.infiniteDistance,e.pickable=this.isPickable,e.receiveShadows=this.receiveShadows,e.billboardMode=this.billboardMode,e.visibility=this.visibility,e.alwaysSelectAsActiveMesh=this.alwaysSelectAsActiveMesh,e.checkCollisions=this.checkCollisions,e.ellipsoid=this.ellipsoid.asArray(),e.ellipsoidOffset=this.ellipsoidOffset.asArray(),e.doNotSyncBoundingInfo=this.doNotSyncBoundingInfo,e.isBlocker=this.isBlocker,e.overrideMaterialSideOrientation=this.overrideMaterialSideOrientation,this.parent&&this.parent._serializeAsParent(e),e.isUnIndexed=this.isUnIndexed;const t=this._geometry;if(t&&this.subMeshes){e.geometryUniqueId=t.uniqueId,e.geometryId=t.id,e.subMeshes=[];for(let i=0;i<this.subMeshes.length;i++){const r=this.subMeshes[i];e.subMeshes.push({materialIndex:r.materialIndex,verticesStart:r.verticesStart,verticesCount:r.verticesCount,indexStart:r.indexStart,indexCount:r.indexCount})}}if(this.material?this.material.doNotSerialize||(e.materialUniqueId=this.material.uniqueId,e.materialId=this.material.id):(this.material=null,e.materialUniqueId=this._scene.defaultMaterial.uniqueId,e.materialId=this._scene.defaultMaterial.id),this.morphTargetManager&&(e.morphTargetManagerId=this.morphTargetManager.uniqueId),this.skeleton&&(e.skeletonId=this.skeleton.id,e.numBoneInfluencers=this.numBoneInfluencers),this.getScene()._getComponent(Oe.NAME_PHYSICSENGINE)){const i=this.getPhysicsImpostor();i&&(e.physicsMass=i.getParam("mass"),e.physicsFriction=i.getParam("friction"),e.physicsRestitution=i.getParam("mass"),e.physicsImpostor=i.type)}this.metadata&&(e.metadata=this.metadata),e.instances=[];for(let i=0;i<this.instances.length;i++){const r=this.instances[i];if(r.doNotSerialize)continue;const s={name:r.name,id:r.id,isEnabled:r.isEnabled(!1),isVisible:r.isVisible,isPickable:r.isPickable,checkCollisions:r.checkCollisions,position:r.position.asArray(),scaling:r.scaling.asArray()};if(r.parent&&r.parent._serializeAsParent(s),r.rotationQuaternion?s.rotationQuaternion=r.rotationQuaternion.asArray():r.rotation&&(s.rotation=r.rotation.asArray()),this.getScene()._getComponent(Oe.NAME_PHYSICSENGINE)){const a=r.getPhysicsImpostor();a&&(s.physicsMass=a.getParam("mass"),s.physicsFriction=a.getParam("friction"),s.physicsRestitution=a.getParam("mass"),s.physicsImpostor=a.type)}r.metadata&&(s.metadata=r.metadata),r.actionManager&&(s.actions=r.actionManager.serialize(r.name)),e.instances.push(s),Fe.AppendSerializedAnimations(r,s),s.ranges=r.serializeAnimationRanges()}if(this._thinInstanceDataStorage.instancesCount&&this._thinInstanceDataStorage.matrixData&&(e.thinInstances={instancesCount:this._thinInstanceDataStorage.instancesCount,matrixData:Array.from(this._thinInstanceDataStorage.matrixData),matrixBufferSize:this._thinInstanceDataStorage.matrixBufferSize,enablePicking:this.thinInstanceEnablePicking},this._userThinInstanceBuffersStorage)){const i={data:{},sizes:{},strides:{}};for(const r in this._userThinInstanceBuffersStorage.data)i.data[r]=Array.from(this._userThinInstanceBuffersStorage.data[r]),i.sizes[r]=this._userThinInstanceBuffersStorage.sizes[r],i.strides[r]=this._userThinInstanceBuffersStorage.strides[r];e.thinInstances.userThinInstance=i}return Fe.AppendSerializedAnimations(this,e),e.ranges=this.serializeAnimationRanges(),e.layerMask=this.layerMask,e.alphaIndex=this.alphaIndex,e.hasVertexAlpha=this.hasVertexAlpha,e.overlayAlpha=this.overlayAlpha,e.overlayColor=this.overlayColor.asArray(),e.renderOverlay=this.renderOverlay,e.applyFog=this.applyFog,this.actionManager&&(e.actions=this.actionManager.serialize(this.name)),e}_syncGeometryWithMorphTargetManager(){if(!this.geometry)return;this._markSubMeshesAsAttributesDirty();const e=this._internalAbstractMeshDataInfo._morphTargetManager;if(e&&e.vertexCount){if(e.vertexCount!==this.getTotalVertices()){ee.Error("Mesh is incompatible with morph targets. Targets and mesh must all have the same vertices count."),this.morphTargetManager=null;return}if(e.isUsingTextureForTargets)return;for(let t=0;t<e.numInfluencers;t++){const i=e.getActiveTarget(t),r=i.getPositions();if(!r){ee.Error("Invalid morph target. Target must have positions.");return}this.geometry.setVerticesData(x.PositionKind+t,r,!1,3);const s=i.getNormals();s&&this.geometry.setVerticesData(x.NormalKind+t,s,!1,3);const a=i.getTangents();a&&this.geometry.setVerticesData(x.TangentKind+t,a,!1,3);const l=i.getUVs();l&&this.geometry.setVerticesData(x.UVKind+"_"+t,l,!1,2)}}else{let t=0;for(;this.geometry.isVerticesDataPresent(x.PositionKind+t);)this.geometry.removeVerticesData(x.PositionKind+t),this.geometry.isVerticesDataPresent(x.NormalKind+t)&&this.geometry.removeVerticesData(x.NormalKind+t),this.geometry.isVerticesDataPresent(x.TangentKind+t)&&this.geometry.removeVerticesData(x.TangentKind+t),this.geometry.isVerticesDataPresent(x.UVKind+t)&&this.geometry.removeVerticesData(x.UVKind+"_"+t),t++}}static Parse(e,t,i){let r;if(e.type&&e.type==="LinesMesh"?r=Ae._LinesMeshParser(e,t):e.type&&e.type==="GroundMesh"?r=Ae._GroundMeshParser(e,t):e.type&&e.type==="GoldbergMesh"?r=Ae._GoldbergMeshParser(e,t):e.type&&e.type==="GreasedLineMesh"?r=Ae._GreasedLineMeshParser(e,t):e.type&&e.type==="TrailMesh"?r=Ae._TrailMeshParser(e,t):r=new Ae(e.name,t),r.id=e.id,r._waitingParsedUniqueId=e.uniqueId,ct&&ct.AddTagsTo(r,e.tags),r.position=A.FromArray(e.position),e.metadata!==void 0&&(r.metadata=e.metadata),e.rotationQuaternion?r.rotationQuaternion=ue.FromArray(e.rotationQuaternion):e.rotation&&(r.rotation=A.FromArray(e.rotation)),r.scaling=A.FromArray(e.scaling),e.localMatrix?r.setPreTransformMatrix(z.FromArray(e.localMatrix)):e.pivotMatrix&&r.setPivotMatrix(z.FromArray(e.pivotMatrix)),r.setEnabled(e.isEnabled),r.isVisible=e.isVisible,r.infiniteDistance=e.infiniteDistance,r.alwaysSelectAsActiveMesh=!!e.alwaysSelectAsActiveMesh,r.showBoundingBox=e.showBoundingBox,r.showSubMeshesBoundingBox=e.showSubMeshesBoundingBox,e.applyFog!==void 0&&(r.applyFog=e.applyFog),e.pickable!==void 0&&(r.isPickable=e.pickable),e.alphaIndex!==void 0&&(r.alphaIndex=e.alphaIndex),r.receiveShadows=e.receiveShadows,e.billboardMode!==void 0&&(r.billboardMode=e.billboardMode),e.visibility!==void 0&&(r.visibility=e.visibility),r.checkCollisions=e.checkCollisions,r.doNotSyncBoundingInfo=!!e.doNotSyncBoundingInfo,e.ellipsoid&&(r.ellipsoid=A.FromArray(e.ellipsoid)),e.ellipsoidOffset&&(r.ellipsoidOffset=A.FromArray(e.ellipsoidOffset)),e.overrideMaterialSideOrientation!==void 0&&(r.overrideMaterialSideOrientation=e.overrideMaterialSideOrientation),e.isBlocker!==void 0&&(r.isBlocker=e.isBlocker),r._shouldGenerateFlatShading=e.useFlatShading,e.freezeWorldMatrix&&(r._waitingData.freezeWorldMatrix=e.freezeWorldMatrix),e.parentId!==void 0&&(r._waitingParentId=e.parentId),e.parentInstanceIndex!==void 0&&(r._waitingParentInstanceIndex=e.parentInstanceIndex),e.actions!==void 0&&(r._waitingData.actions=e.actions),e.overlayAlpha!==void 0&&(r.overlayAlpha=e.overlayAlpha),e.overlayColor!==void 0&&(r.overlayColor=Pe.FromArray(e.overlayColor)),e.renderOverlay!==void 0&&(r.renderOverlay=e.renderOverlay),r.isUnIndexed=!!e.isUnIndexed,r.hasVertexAlpha=e.hasVertexAlpha,e.delayLoadingFile?(r.delayLoadState=4,r.delayLoadingFile=i+e.delayLoadingFile,r.buildBoundingInfo(A.FromArray(e.boundingBoxMinimum),A.FromArray(e.boundingBoxMaximum)),e._binaryInfo&&(r._binaryInfo=e._binaryInfo),r._delayInfo=[],e.hasUVs&&r._delayInfo.push(x.UVKind),e.hasUVs2&&r._delayInfo.push(x.UV2Kind),e.hasUVs3&&r._delayInfo.push(x.UV3Kind),e.hasUVs4&&r._delayInfo.push(x.UV4Kind),e.hasUVs5&&r._delayInfo.push(x.UV5Kind),e.hasUVs6&&r._delayInfo.push(x.UV6Kind),e.hasColors&&r._delayInfo.push(x.ColorKind),e.hasMatricesIndices&&r._delayInfo.push(x.MatricesIndicesKind),e.hasMatricesWeights&&r._delayInfo.push(x.MatricesWeightsKind),r._delayLoadingFunction=rr._ImportGeometry,Ei.ForceFullSceneLoadingForIncremental&&r._checkDelayState()):rr._ImportGeometry(e,r),e.materialUniqueId?r._waitingMaterialId=e.materialUniqueId:e.materialId&&(r._waitingMaterialId=e.materialId),e.morphTargetManagerId>-1&&(r.morphTargetManager=t.getMorphTargetManagerById(e.morphTargetManagerId)),e.skeletonId!==void 0&&e.skeletonId!==null&&(r.skeleton=t.getLastSkeletonById(e.skeletonId),e.numBoneInfluencers&&(r.numBoneInfluencers=e.numBoneInfluencers)),e.animations){for(let s=0;s<e.animations.length;s++){const a=e.animations[s],l=Bn("BABYLON.Animation");l&&r.animations.push(l.Parse(a))}Mi.ParseAnimationRanges(r,e,t)}if(e.autoAnimate&&t.beginAnimation(r,e.autoAnimateFrom,e.autoAnimateTo,e.autoAnimateLoop,e.autoAnimateSpeed||1),e.layerMask&&!isNaN(e.layerMask)?r.layerMask=Math.abs(parseInt(e.layerMask)):r.layerMask=268435455,e.physicsImpostor&&Ae._PhysicsImpostorParser(t,r,e),e.lodMeshIds&&(r._waitingData.lods={ids:e.lodMeshIds,distances:e.lodDistances?e.lodDistances:null,coverages:e.lodCoverages?e.lodCoverages:null}),e.instances)for(let s=0;s<e.instances.length;s++){const a=e.instances[s],l=r.createInstance(a.name);if(a.id&&(l.id=a.id),ct&&(a.tags?ct.AddTagsTo(l,a.tags):ct.AddTagsTo(l,e.tags)),l.position=A.FromArray(a.position),a.metadata!==void 0&&(l.metadata=a.metadata),a.parentId!==void 0&&(l._waitingParentId=a.parentId),a.parentInstanceIndex!==void 0&&(l._waitingParentInstanceIndex=a.parentInstanceIndex),a.isEnabled!==void 0&&a.isEnabled!==null&&l.setEnabled(a.isEnabled),a.isVisible!==void 0&&a.isVisible!==null&&(l.isVisible=a.isVisible),a.isPickable!==void 0&&a.isPickable!==null&&(l.isPickable=a.isPickable),a.rotationQuaternion?l.rotationQuaternion=ue.FromArray(a.rotationQuaternion):a.rotation&&(l.rotation=A.FromArray(a.rotation)),l.scaling=A.FromArray(a.scaling),a.checkCollisions!=null&&a.checkCollisions!=null&&(l.checkCollisions=a.checkCollisions),a.pickable!=null&&a.pickable!=null&&(l.isPickable=a.pickable),a.showBoundingBox!=null&&a.showBoundingBox!=null&&(l.showBoundingBox=a.showBoundingBox),a.showSubMeshesBoundingBox!=null&&a.showSubMeshesBoundingBox!=null&&(l.showSubMeshesBoundingBox=a.showSubMeshesBoundingBox),a.alphaIndex!=null&&a.showSubMeshesBoundingBox!=null&&(l.alphaIndex=a.alphaIndex),a.physicsImpostor&&Ae._PhysicsImpostorParser(t,l,a),a.actions!==void 0&&(l._waitingData.actions=a.actions),a.animations){for(let o=0;o<a.animations.length;o++){const c=a.animations[o],u=Bn("BABYLON.Animation");u&&l.animations.push(u.Parse(c))}Mi.ParseAnimationRanges(l,a,t),a.autoAnimate&&t.beginAnimation(l,a.autoAnimateFrom,a.autoAnimateTo,a.autoAnimateLoop,a.autoAnimateSpeed||1)}}if(e.thinInstances){const s=e.thinInstances;if(r.thinInstanceEnablePicking=!!s.enablePicking,s.matrixData?(r.thinInstanceSetBuffer("matrix",new Float32Array(s.matrixData),16,!1),r._thinInstanceDataStorage.matrixBufferSize=s.matrixBufferSize,r._thinInstanceDataStorage.instancesCount=s.instancesCount):r._thinInstanceDataStorage.matrixBufferSize=s.matrixBufferSize,e.thinInstances.userThinInstance){const a=e.thinInstances.userThinInstance;for(const l in a.data)r.thinInstanceSetBuffer(l,new Float32Array(a.data[l]),a.strides[l],!1),r._userThinInstanceBuffersStorage.sizes[l]=a.sizes[l]}}return r}setPositionsForCPUSkinning(){const e=this._internalMeshDataInfo;if(!e._sourcePositions){const t=this.getVerticesData(x.PositionKind);if(!t)return e._sourcePositions;e._sourcePositions=new Float32Array(t),this.isVertexBufferUpdatable(x.PositionKind)||this.setVerticesData(x.PositionKind,t,!0)}return e._sourcePositions}setNormalsForCPUSkinning(){const e=this._internalMeshDataInfo;if(!e._sourceNormals){const t=this.getVerticesData(x.NormalKind);if(!t)return e._sourceNormals;e._sourceNormals=new Float32Array(t),this.isVertexBufferUpdatable(x.NormalKind)||this.setVerticesData(x.NormalKind,t,!0)}return e._sourceNormals}applySkeleton(e){if(!this.geometry)return this;if(this.geometry._softwareSkinningFrameId==this.getScene().getFrameId())return this;if(this.geometry._softwareSkinningFrameId=this.getScene().getFrameId(),!this.isVerticesDataPresent(x.PositionKind))return this;if(!this.isVerticesDataPresent(x.MatricesIndicesKind))return this;if(!this.isVerticesDataPresent(x.MatricesWeightsKind))return this;const t=this.isVerticesDataPresent(x.NormalKind),i=this._internalMeshDataInfo;if(!i._sourcePositions){const E=this.subMeshes.slice();this.setPositionsForCPUSkinning(),this.subMeshes=E}t&&!i._sourceNormals&&this.setNormalsForCPUSkinning();let r=this.getVerticesData(x.PositionKind);if(!r)return this;r instanceof Float32Array||(r=new Float32Array(r));let s=this.getVerticesData(x.NormalKind);if(t){if(!s)return this;s instanceof Float32Array||(s=new Float32Array(s))}const a=this.getVerticesData(x.MatricesIndicesKind),l=this.getVerticesData(x.MatricesWeightsKind);if(!l||!a)return this;const o=this.numBoneInfluencers>4,c=o?this.getVerticesData(x.MatricesIndicesExtraKind):null,u=o?this.getVerticesData(x.MatricesWeightsExtraKind):null,h=e.getTransformMatrices(this),d=A.Zero(),f=new z,_=new z;let p=0,v;for(let E=0;E<r.length;E+=3,p+=4){let g;for(v=0;v<4;v++)g=l[p+v],g>0&&(z.FromFloat32ArrayToRefScaled(h,Math.floor(a[p+v]*16),g,_),f.addToSelf(_));if(o)for(v=0;v<4;v++)g=u[p+v],g>0&&(z.FromFloat32ArrayToRefScaled(h,Math.floor(c[p+v]*16),g,_),f.addToSelf(_));A.TransformCoordinatesFromFloatsToRef(i._sourcePositions[E],i._sourcePositions[E+1],i._sourcePositions[E+2],f,d),d.toArray(r,E),t&&(A.TransformNormalFromFloatsToRef(i._sourceNormals[E],i._sourceNormals[E+1],i._sourceNormals[E+2],f,d),d.toArray(s,E)),f.reset()}return this.updateVerticesData(x.PositionKind,r),t&&this.updateVerticesData(x.NormalKind,s),this}static MinMax(e){let t=null,i=null;return e.forEach(function(r){const a=r.getBoundingInfo().boundingBox;!t||!i?(t=a.minimumWorld,i=a.maximumWorld):(t.minimizeInPlace(a.minimumWorld),i.maximizeInPlace(a.maximumWorld))}),!t||!i?{min:A.Zero(),max:A.Zero()}:{min:t,max:i}}static Center(e){const t=e instanceof Array?Ae.MinMax(e):e;return A.Center(t.min,t.max)}static MergeMeshes(e,t=!0,i,r,s,a){return gm(Ae._MergeMeshesCoroutine(e,t,i,r,s,a,!1))}static MergeMeshesAsync(e,t=!0,i,r,s,a){return WN(Ae._MergeMeshesCoroutine(e,t,i,r,s,a,!0),GN())}static*_MergeMeshesCoroutine(e,t=!0,i,r,s,a,l){if(e=e.filter(Boolean),e.length===0)return null;let o;if(!i){let C=0;for(o=0;o<e.length;o++)if(C+=e[o].getTotalVertices(),C>=65536)return ee.Warn("Cannot merge meshes because resulting mesh will have more than 65536 vertices. Please use allow32BitsIndices = true to use 32 bits indices"),null}a&&(s=!1);const c=new Array,u=new Array,h=new Array,d=e[0].overrideMaterialSideOrientation;for(o=0;o<e.length;o++){const C=e[o];if(C.isAnInstance)return ee.Warn("Cannot merge instance meshes."),null;if(d!==C.overrideMaterialSideOrientation)return ee.Warn("Cannot merge meshes with different overrideMaterialSideOrientation values."),null;if(s&&h.push(C.getTotalIndices()),a)if(C.material){const M=C.material;if(M instanceof Na){for(let F=0;F<M.subMaterials.length;F++)c.indexOf(M.subMaterials[F])<0&&c.push(M.subMaterials[F]);for(let F=0;F<C.subMeshes.length;F++)u.push(c.indexOf(M.subMaterials[C.subMeshes[F].materialIndex])),h.push(C.subMeshes[F].indexCount)}else{c.indexOf(M)<0&&c.push(M);for(let F=0;F<C.subMeshes.length;F++)u.push(c.indexOf(M)),h.push(C.subMeshes[F].indexCount)}}else for(let M=0;M<C.subMeshes.length;M++)u.push(0),h.push(C.subMeshes[M].indexCount)}const f=e[0],_=C=>{const M=C.computeWorldMatrix(!0);return{vertexData:Ue.ExtractFromMesh(C,!1,!1),transform:M}},{vertexData:p,transform:v}=_(f);l&&(yield);const E=new Array(e.length-1);for(let C=1;C<e.length;C++)E[C-1]=_(e[C]),l&&(yield);const g=p._mergeCoroutine(v,E,i,l,!t);let m=g.next();for(;!m.done;)l&&(yield),m=g.next();const y=m.value;r||(r=new Ae(f.name+"_merged",f.getScene()));const T=y._applyToCoroutine(r,void 0,l);let b=T.next();for(;!b.done;)l&&(yield),b=T.next();if(r.checkCollisions=f.checkCollisions,r.overrideMaterialSideOrientation=f.overrideMaterialSideOrientation,t)for(o=0;o<e.length;o++)e[o].dispose();if(s||a){r.releaseSubMeshes(),o=0;let C=0;for(;o<h.length;)pn.CreateFromIndices(0,C,h[o],r,void 0,!1),C+=h[o],o++;for(const M of r.subMeshes)M.refreshBoundingInfo();r.computeWorldMatrix(!0)}if(a){const C=new Na(f.name+"_merged",f.getScene());C.subMaterials=c;for(let M=0;M<r.subMeshes.length;M++)r.subMeshes[M].materialIndex=u[M];r.material=C}else r.material=f.material;return r}addInstance(e){e._indexInSourceMeshInstanceArray=this.instances.length,this.instances.push(e)}removeInstance(e){const t=e._indexInSourceMeshInstanceArray;if(t!=-1){if(t!==this.instances.length-1){const i=this.instances[this.instances.length-1];this.instances[t]=i,i._indexInSourceMeshInstanceArray=t}e._indexInSourceMeshInstanceArray=-1,this.instances.pop()}}_shouldConvertRHS(){return this.overrideMaterialSideOrientation===j.CounterClockWiseSideOrientation}_getRenderingFillMode(e){const t=this.getScene();return t.forcePointsCloud?j.PointFillMode:t.forceWireframe?j.WireFrameFillMode:this.overrideRenderingFillMode??e}setMaterialByID(e){return this.setMaterialById(e)}static CreateRibbon(e,t,i,r,s,a,l,o,c){throw new Error("Import MeshBuilder to populate this function")}static CreateDisc(e,t,i,r,s,a){throw new Error("Import MeshBuilder to populate this function")}static CreateBox(e,t,i,r,s){throw new Error("Import MeshBuilder to populate this function")}static CreateSphere(e,t,i,r,s,a){throw new Error("Import MeshBuilder to populate this function")}static CreateHemisphere(e,t,i,r){throw new Error("Import MeshBuilder to populate this function")}static CreateCylinder(e,t,i,r,s,a,l,o,c){throw new Error("Import MeshBuilder to populate this function")}static CreateTorus(e,t,i,r,s,a,l){throw new Error("Import MeshBuilder to populate this function")}static CreateTorusKnot(e,t,i,r,s,a,l,o,c,u){throw new Error("Import MeshBuilder to populate this function")}static CreateLines(e,t,i,r,s){throw new Error("Import MeshBuilder to populate this function")}static CreateDashedLines(e,t,i,r,s,a,l,o){throw new Error("Import MeshBuilder to populate this function")}static CreatePolygon(e,t,i,r,s,a,l){throw new Error("Import MeshBuilder to populate this function")}static ExtrudePolygon(e,t,i,r,s,a,l,o){throw new Error("Import MeshBuilder to populate this function")}static ExtrudeShape(e,t,i,r,s,a,l,o,c,u){throw new Error("Import MeshBuilder to populate this function")}static ExtrudeShapeCustom(e,t,i,r,s,a,l,o,c,u,h,d){throw new Error("Import MeshBuilder to populate this function")}static CreateLathe(e,t,i,r,s,a,l){throw new Error("Import MeshBuilder to populate this function")}static CreatePlane(e,t,i,r,s){throw new Error("Import MeshBuilder to populate this function")}static CreateGround(e,t,i,r,s,a){throw new Error("Import MeshBuilder to populate this function")}static CreateTiledGround(e,t,i,r,s,a,l,o,c){throw new Error("Import MeshBuilder to populate this function")}static CreateGroundFromHeightMap(e,t,i,r,s,a,l,o,c,u,h){throw new Error("Import MeshBuilder to populate this function")}static CreateTube(e,t,i,r,s,a,l,o,c,u){throw new Error("Import MeshBuilder to populate this function")}static CreatePolyhedron(e,t,i){throw new Error("Import MeshBuilder to populate this function")}static CreateIcoSphere(e,t,i){throw new Error("Import MeshBuilder to populate this function")}static CreateDecal(e,t,i,r,s,a){throw new Error("Import MeshBuilder to populate this function")}static CreateCapsule(e,t,i){throw new Error("Import MeshBuilder to populate this function")}static ExtendToGoldberg(e){throw new Error("Import MeshBuilder to populate this function")}}Ae.FRONTSIDE=Ue.FRONTSIDE;Ae.BACKSIDE=Ue.BACKSIDE;Ae.DOUBLESIDE=Ue.DOUBLESIDE;Ae.DEFAULTSIDE=Ue.DEFAULTSIDE;Ae.NO_CAP=0;Ae.CAP_START=1;Ae.CAP_END=2;Ae.CAP_ALL=3;Ae.NO_FLIP=0;Ae.FLIP_TILE=1;Ae.ROTATE_TILE=2;Ae.FLIP_ROW=3;Ae.ROTATE_ROW=4;Ae.FLIP_N_ROTATE_TILE=5;Ae.FLIP_N_ROTATE_ROW=6;Ae.CENTER=0;Ae.LEFT=1;Ae.RIGHT=2;Ae.TOP=3;Ae.BOTTOM=4;Ae.INSTANCEDMESH_SORT_TRANSPARENT=!1;Ae._GroundMeshParser=(n,e)=>{throw ke("GroundMesh")};Ae._GoldbergMeshParser=(n,e)=>{throw ke("GoldbergMesh")};Ae._LinesMeshParser=(n,e)=>{throw ke("LinesMesh")};Ae._GreasedLineMeshParser=(n,e)=>{throw ke("GreasedLineMesh")};Ae._GreasedLineRibbonMeshParser=(n,e)=>{throw ke("GreasedLineRibbonMesh")};Ae._TrailMeshParser=(n,e)=>{throw ke("TrailMesh")};Ji("BABYLON.Mesh",Ae);Ae._instancedMeshFactory=(n,e)=>{const t=new yo(n,e);if(e.instancedBuffers){t.instancedBuffers={};for(const i in e.instancedBuffers)t.instancedBuffers[i]=e.instancedBuffers[i]}return t};class yo extends yr{constructor(e,t){super(e,t.getScene()),this._indexInSourceMeshInstanceArray=-1,this._distanceToCamera=0,t.addInstance(this),this._sourceMesh=t,this._unIndexed=t._unIndexed,this.position.copyFrom(t.position),this.rotation.copyFrom(t.rotation),this.scaling.copyFrom(t.scaling),t.rotationQuaternion&&(this.rotationQuaternion=t.rotationQuaternion.clone()),this.animations=t.animations.slice();for(const i of t.getAnimationRanges())i!=null&&this.createAnimationRange(i.name,i.from,i.to);this.infiniteDistance=t.infiniteDistance,this.setPivotMatrix(t.getPivotMatrix()),this.refreshBoundingInfo(!0,!0),this._syncSubMeshes()}getClassName(){return"InstancedMesh"}get lightSources(){return this._sourceMesh._lightSources}_resyncLightSources(){}_resyncLightSource(){}_removeLightSource(){}get receiveShadows(){return this._sourceMesh.receiveShadows}set receiveShadows(e){var t;((t=this._sourceMesh)==null?void 0:t.receiveShadows)!==e&&X.Warn("Setting receiveShadows on an instanced mesh has no effect")}get material(){return this._sourceMesh.material}set material(e){var t;((t=this._sourceMesh)==null?void 0:t.material)!==e&&X.Warn("Setting material on an instanced mesh has no effect")}get visibility(){return this._sourceMesh.visibility}set visibility(e){var t;((t=this._sourceMesh)==null?void 0:t.visibility)!==e&&X.Warn("Setting visibility on an instanced mesh has no effect")}get skeleton(){return this._sourceMesh.skeleton}set skeleton(e){var t;((t=this._sourceMesh)==null?void 0:t.skeleton)!==e&&X.Warn("Setting skeleton on an instanced mesh has no effect")}get renderingGroupId(){return this._sourceMesh.renderingGroupId}set renderingGroupId(e){!this._sourceMesh||e===this._sourceMesh.renderingGroupId||ee.Warn("Note - setting renderingGroupId of an instanced mesh has no effect on the scene")}getTotalVertices(){return this._sourceMesh?this._sourceMesh.getTotalVertices():0}getTotalIndices(){return this._sourceMesh.getTotalIndices()}get sourceMesh(){return this._sourceMesh}createInstance(e){return this._sourceMesh.createInstance(e)}isReady(e=!1){return this._sourceMesh.isReady(e,!0)}getVerticesData(e,t,i){return this._sourceMesh.getVerticesData(e,t,i)}setVerticesData(e,t,i,r){return this.sourceMesh&&this.sourceMesh.setVerticesData(e,t,i,r),this.sourceMesh}updateVerticesData(e,t,i,r){return this.sourceMesh&&this.sourceMesh.updateVerticesData(e,t,i,r),this.sourceMesh}setIndices(e,t=null){return this.sourceMesh&&this.sourceMesh.setIndices(e,t),this.sourceMesh}isVerticesDataPresent(e){return this._sourceMesh.isVerticesDataPresent(e)}getIndices(){return this._sourceMesh.getIndices()}get _positions(){return this._sourceMesh._positions}refreshBoundingInfo(e=!1,t=!1){if(this.hasBoundingInfo&&this.getBoundingInfo().isLocked)return this;const i=this._sourceMesh.geometry?this._sourceMesh.geometry.boundingBias:null;return this._refreshBoundingInfo(this._sourceMesh._getPositionData(e,t),i),this}_preActivate(){return this._currentLOD&&this._currentLOD._preActivate(),this}_activate(e,t){if(super._activate(e,t),this._sourceMesh.subMeshes||ee.Warn("Instances should only be created for meshes with geometry."),this._currentLOD){if(this._currentLOD._getWorldMatrixDeterminant()>=0!=this._getWorldMatrixDeterminant()>=0)return this._internalAbstractMeshDataInfo._actAsRegularMesh=!0,!0;if(this._internalAbstractMeshDataInfo._actAsRegularMesh=!1,this._currentLOD._registerInstanceForRenderId(this,e),t){if(!this._currentLOD._internalAbstractMeshDataInfo._isActiveIntermediate)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!0,!0}else if(!this._currentLOD._internalAbstractMeshDataInfo._isActive)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstances=!0,!0}return!1}_postActivate(){this._sourceMesh.edgesShareWithInstances&&this._sourceMesh._edgesRenderer&&this._sourceMesh._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup?(this._sourceMesh._renderingGroup._edgesRenderers.pushNoDuplicate(this._sourceMesh._edgesRenderer),this._sourceMesh._edgesRenderer.customInstances.push(this.getWorldMatrix())):this._edgesRenderer&&this._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup&&this._sourceMesh._renderingGroup._edgesRenderers.push(this._edgesRenderer)}getWorldMatrix(){if(this._currentLOD&&this._currentLOD.billboardMode!==Ne.BILLBOARDMODE_NONE&&this._currentLOD._masterMesh!==this){this._billboardWorldMatrix||(this._billboardWorldMatrix=new z);const e=this._currentLOD._masterMesh;return this._currentLOD._masterMesh=this,V.Vector3[7].copyFrom(this._currentLOD.position),this._currentLOD.position.set(0,0,0),this._billboardWorldMatrix.copyFrom(this._currentLOD.computeWorldMatrix(!0)),this._currentLOD.position.copyFrom(V.Vector3[7]),this._currentLOD._masterMesh=e,this._billboardWorldMatrix}return super.getWorldMatrix()}get isAnInstance(){return!0}getLOD(e){if(!e)return this;const t=this.sourceMesh.getLODLevels();if(!t||t.length===0)this._currentLOD=this.sourceMesh;else{const i=this.getBoundingInfo();this._currentLOD=this.sourceMesh.getLOD(e,i.boundingSphere)}return this._currentLOD}_preActivateForIntermediateRendering(e){return this.sourceMesh._preActivateForIntermediateRendering(e)}_syncSubMeshes(){if(this.releaseSubMeshes(),this._sourceMesh.subMeshes)for(let e=0;e<this._sourceMesh.subMeshes.length;e++)this._sourceMesh.subMeshes[e].clone(this,this._sourceMesh);return this}_generatePointsArray(){return this._sourceMesh._generatePointsArray()}_updateBoundingInfo(){return this.hasBoundingInfo?this.getBoundingInfo().update(this.worldMatrixFromCache):this.buildBoundingInfo(this.absolutePosition,this.absolutePosition,this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache),this}clone(e,t=null,i,r){const s=(r||this._sourceMesh).createInstance(e);if(cm.DeepCopy(this,s,["name","subMeshes","uniqueId","parent","lightSources","receiveShadows","material","visibility","skeleton","sourceMesh","isAnInstance","facetNb","isFacetDataEnabled","isBlocked","useBones","hasInstances","collider","edgesRenderer","forward","up","right","absolutePosition","absoluteScaling","absoluteRotationQuaternion","isWorldMatrixFrozen","nonUniformScaling","behaviors","worldMatrixFromCache","hasThinInstances","hasBoundingInfo"],[]),this.refreshBoundingInfo(),t&&(s.parent=t),!i)for(let a=0;a<this.getScene().meshes.length;a++){const l=this.getScene().meshes[a];l.parent===this&&l.clone(l.name,s)}return s.computeWorldMatrix(!0),this.onClonedObservable.notifyObservers(s),s}dispose(e,t=!1){this._sourceMesh.removeInstance(this),super.dispose(e,t)}_serializeAsParent(e){super._serializeAsParent(e),e.parentId=this._sourceMesh.uniqueId,e.parentInstanceIndex=this._indexInSourceMeshInstanceArray}instantiateHierarchy(e=null,t,i){const r=this.clone("Clone of "+(this.name||this.id),e||this.parent,!0,t&&t.newSourcedMesh);r&&i&&i(this,r);for(const s of this.getChildTransformNodes(!0))s.instantiateHierarchy(r,t,i);return r}}Ae.prototype.registerInstancedBuffer=function(n,e){var t,i;if((i=(t=this._userInstancedBuffersStorage)==null?void 0:t.vertexBuffers[n])==null||i.dispose(),!this.instancedBuffers){this.instancedBuffers={};for(const r of this.instances)r.instancedBuffers={}}this._userInstancedBuffersStorage||(this._userInstancedBuffersStorage={data:{},vertexBuffers:{},strides:{},sizes:{},vertexArrayObjects:this.getEngine().getCaps().vertexArrayObject?{}:void 0}),this.instancedBuffers[n]=null,this._userInstancedBuffersStorage.strides[n]=e,this._userInstancedBuffersStorage.sizes[n]=e*32,this._userInstancedBuffersStorage.data[n]=new Float32Array(this._userInstancedBuffersStorage.sizes[n]),this._userInstancedBuffersStorage.vertexBuffers[n]=new x(this.getEngine(),this._userInstancedBuffersStorage.data[n],n,!0,!1,e,!0);for(const r of this.instances)r.instancedBuffers[n]=null;this._invalidateInstanceVertexArrayObject(),this._markSubMeshesAsAttributesDirty()};Ae.prototype._processInstancedBuffers=function(n,e){const t=n?n.length:0;for(const i in this.instancedBuffers){let r=this._userInstancedBuffersStorage.sizes[i];const s=this._userInstancedBuffersStorage.strides[i],a=(t+1)*s;for(;r<a;)r*=2;this._userInstancedBuffersStorage.data[i].length!=r&&(this._userInstancedBuffersStorage.data[i]=new Float32Array(r),this._userInstancedBuffersStorage.sizes[i]=r,this._userInstancedBuffersStorage.vertexBuffers[i]&&(this._userInstancedBuffersStorage.vertexBuffers[i].dispose(),this._userInstancedBuffersStorage.vertexBuffers[i]=null));const l=this._userInstancedBuffersStorage.data[i];let o=0;if(e){const c=this.instancedBuffers[i];c.toArray?c.toArray(l,o):c.copyToArray?c.copyToArray(l,o):l[o]=c,o+=s}for(let c=0;c<t;c++){const h=n[c].instancedBuffers[i];h.toArray?h.toArray(l,o):h.copyToArray?h.copyToArray(l,o):l[o]=h,o+=s}this._userInstancedBuffersStorage.vertexBuffers[i]?this._userInstancedBuffersStorage.vertexBuffers[i].updateDirectly(l,0):(this._userInstancedBuffersStorage.vertexBuffers[i]=new x(this.getEngine(),this._userInstancedBuffersStorage.data[i],i,!0,!1,s,!0),this._invalidateInstanceVertexArrayObject())}};Ae.prototype._invalidateInstanceVertexArrayObject=function(){if(!(!this._userInstancedBuffersStorage||this._userInstancedBuffersStorage.vertexArrayObjects===void 0)){for(const n in this._userInstancedBuffersStorage.vertexArrayObjects)this.getEngine().releaseVertexArrayObject(this._userInstancedBuffersStorage.vertexArrayObjects[n]);this._userInstancedBuffersStorage.vertexArrayObjects={}}};Ae.prototype._disposeInstanceSpecificData=function(){for(this._instanceDataStorage.instancesBuffer&&(this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null);this.instances.length;)this.instances[0].dispose();for(const n in this.instancedBuffers)this._userInstancedBuffersStorage.vertexBuffers[n]&&this._userInstancedBuffersStorage.vertexBuffers[n].dispose();this._invalidateInstanceVertexArrayObject(),this.instancedBuffers={}};class Ye extends Mi{get range(){return this._range}set range(e){this._range=e,this._inverseSquaredRange=1/(this.range*this.range)}get intensityMode(){return this._intensityMode}set intensityMode(e){this._intensityMode=e,this._computePhotometricScale()}get radius(){return this._radius}set radius(e){this._radius=e,this._computePhotometricScale()}get shadowEnabled(){return this._shadowEnabled}set shadowEnabled(e){this._shadowEnabled!==e&&(this._shadowEnabled=e,this._markMeshesAsLightDirty())}get includedOnlyMeshes(){return this._includedOnlyMeshes}set includedOnlyMeshes(e){this._includedOnlyMeshes=e,this._hookArrayForIncludedOnly(e)}get excludedMeshes(){return this._excludedMeshes}set excludedMeshes(e){this._excludedMeshes=e,this._hookArrayForExcluded(e)}get excludeWithLayerMask(){return this._excludeWithLayerMask}set excludeWithLayerMask(e){this._excludeWithLayerMask=e,this._resyncMeshes()}get includeOnlyWithLayerMask(){return this._includeOnlyWithLayerMask}set includeOnlyWithLayerMask(e){this._includeOnlyWithLayerMask=e,this._resyncMeshes()}get lightmapMode(){return this._lightmapMode}set lightmapMode(e){this._lightmapMode!==e&&(this._lightmapMode=e,this._markMeshesAsLightDirty())}getViewMatrix(e){return null}getProjectionMatrix(e,t){return null}constructor(e,t){super(e,t),this.diffuse=new Pe(1,1,1),this.specular=new Pe(1,1,1),this.falloffType=Ye.FALLOFF_DEFAULT,this.intensity=1,this._range=Number.MAX_VALUE,this._inverseSquaredRange=0,this._photometricScale=1,this._intensityMode=Ye.INTENSITYMODE_AUTOMATIC,this._radius=1e-5,this.renderPriority=0,this._shadowEnabled=!0,this._excludeWithLayerMask=0,this._includeOnlyWithLayerMask=0,this._lightmapMode=0,this._shadowGenerators=null,this._excludedMeshesIds=new Array,this._includedOnlyMeshesIds=new Array,this._isLight=!0,this.getScene().addLight(this),this._uniformBuffer=new me(this.getScene().getEngine(),void 0,void 0,e),this._buildUniformLayout(),this.includedOnlyMeshes=[],this.excludedMeshes=[],this._resyncMeshes()}transferTexturesToEffect(e,t){return this}_bindLight(e,t,i,r,s=!0){const a=e.toString();let l=!1;if(this._uniformBuffer.bindToEffect(i,"Light"+a),this._renderId!==t.getRenderId()||this._lastUseSpecular!==r||!this._uniformBuffer.useUbo){this._renderId=t.getRenderId(),this._lastUseSpecular=r;const o=this.getScaledIntensity();this.transferToEffect(i,a),this.diffuse.scaleToRef(o,Dn.Color3[0]),this._uniformBuffer.updateColor4("vLightDiffuse",Dn.Color3[0],this.range,a),r&&(this.specular.scaleToRef(o,Dn.Color3[1]),this._uniformBuffer.updateColor4("vLightSpecular",Dn.Color3[1],this.radius,a)),l=!0}if(this.transferTexturesToEffect(i,a),t.shadowsEnabled&&this.shadowEnabled&&s){const o=this.getShadowGenerator(t.activeCamera)??this.getShadowGenerator();o&&(o.bindShadowLight(a,i),l=!0)}l?this._uniformBuffer.update():this._uniformBuffer.bindUniformBuffer()}getClassName(){return"Light"}toString(e){let t="Name: "+this.name;if(t+=", type: "+["Point","Directional","Spot","Hemispheric"][this.getTypeID()],this.animations)for(let i=0;i<this.animations.length;i++)t+=", animation[0]: "+this.animations[i].toString(e);return t}_syncParentEnabledState(){super._syncParentEnabledState(),this.isDisposed()||this._resyncMeshes()}setEnabled(e){super.setEnabled(e),this._resyncMeshes()}getShadowGenerator(e=null){return this._shadowGenerators===null?null:this._shadowGenerators.get(e)??null}getShadowGenerators(){return this._shadowGenerators}getAbsolutePosition(){return A.Zero()}canAffectMesh(e){return e?!(this.includedOnlyMeshes&&this.includedOnlyMeshes.length>0&&this.includedOnlyMeshes.indexOf(e)===-1||this.excludedMeshes&&this.excludedMeshes.length>0&&this.excludedMeshes.indexOf(e)!==-1||this.includeOnlyWithLayerMask!==0&&!(this.includeOnlyWithLayerMask&e.layerMask)||this.excludeWithLayerMask!==0&&this.excludeWithLayerMask&e.layerMask):!0}dispose(e,t=!1){if(this._shadowGenerators){const i=this._shadowGenerators.values();for(let r=i.next();r.done!==!0;r=i.next())r.value.dispose();this._shadowGenerators=null}if(this.getScene().stopAnimation(this),this._parentContainer){const i=this._parentContainer.lights.indexOf(this);i>-1&&this._parentContainer.lights.splice(i,1),this._parentContainer=null}for(const i of this.getScene().meshes)i._removeLightSource(this,!0);this._uniformBuffer.dispose(),this.getScene().removeLight(this),super.dispose(e,t)}getTypeID(){return 0}getScaledIntensity(){return this._photometricScale*this.intensity}clone(e,t=null){const i=Ye.GetConstructorFromName(this.getTypeID(),e,this.getScene());if(!i)return null;const r=Fe.Clone(i,this);return e&&(r.name=e),t&&(r.parent=t),r.setEnabled(this.isEnabled()),this.onClonedObservable.notifyObservers(r),r}serialize(){const e=Fe.Serialize(this);return e.uniqueId=this.uniqueId,e.type=this.getTypeID(),this.parent&&this.parent._serializeAsParent(e),this.excludedMeshes.length>0&&(e.excludedMeshesIds=[],this.excludedMeshes.forEach(t=>{e.excludedMeshesIds.push(t.id)})),this.includedOnlyMeshes.length>0&&(e.includedOnlyMeshesIds=[],this.includedOnlyMeshes.forEach(t=>{e.includedOnlyMeshesIds.push(t.id)})),Fe.AppendSerializedAnimations(this,e),e.ranges=this.serializeAnimationRanges(),e.isEnabled=this.isEnabled(),e}static GetConstructorFromName(e,t,i){const r=Mi.Construct("Light_Type_"+e,t,i);return r||null}static Parse(e,t){const i=Ye.GetConstructorFromName(e.type,e.name,t);if(!i)return null;const r=Fe.Parse(i,e,t);if(e.excludedMeshesIds&&(r._excludedMeshesIds=e.excludedMeshesIds),e.includedOnlyMeshesIds&&(r._includedOnlyMeshesIds=e.includedOnlyMeshesIds),e.parentId!==void 0&&(r._waitingParentId=e.parentId),e.parentInstanceIndex!==void 0&&(r._waitingParentInstanceIndex=e.parentInstanceIndex),e.falloffType!==void 0&&(r.falloffType=e.falloffType),e.lightmapMode!==void 0&&(r.lightmapMode=e.lightmapMode),e.animations){for(let s=0;s<e.animations.length;s++){const a=e.animations[s],l=Bn("BABYLON.Animation");l&&r.animations.push(l.Parse(a))}Mi.ParseAnimationRanges(r,e,t)}return e.autoAnimate&&t.beginAnimation(r,e.autoAnimateFrom,e.autoAnimateTo,e.autoAnimateLoop,e.autoAnimateSpeed||1),e.isEnabled!==void 0&&r.setEnabled(e.isEnabled),r}_hookArrayForExcluded(e){const t=e.push;e.push=(...r)=>{const s=t.apply(e,r);for(const a of r)a._resyncLightSource(this);return s};const i=e.splice;e.splice=(r,s)=>{const a=i.apply(e,[r,s]);for(const l of a)l._resyncLightSource(this);return a};for(const r of e)r._resyncLightSource(this)}_hookArrayForIncludedOnly(e){const t=e.push;e.push=(...r)=>{const s=t.apply(e,r);return this._resyncMeshes(),s};const i=e.splice;e.splice=(r,s)=>{const a=i.apply(e,[r,s]);return this._resyncMeshes(),a},this._resyncMeshes()}_resyncMeshes(){for(const e of this.getScene().meshes)e._resyncLightSource(this)}_markMeshesAsLightDirty(){for(const e of this.getScene().meshes)e.lightSources.indexOf(this)!==-1&&e._markSubMeshesAsLightDirty()}_computePhotometricScale(){this._photometricScale=this._getPhotometricScale(),this.getScene().resetCachedMaterial()}_getPhotometricScale(){let e=0;const t=this.getTypeID();let i=this.intensityMode;switch(i===Ye.INTENSITYMODE_AUTOMATIC&&(t===Ye.LIGHTTYPEID_DIRECTIONALLIGHT?i=Ye.INTENSITYMODE_ILLUMINANCE:i=Ye.INTENSITYMODE_LUMINOUSINTENSITY),t){case Ye.LIGHTTYPEID_POINTLIGHT:case Ye.LIGHTTYPEID_SPOTLIGHT:switch(i){case Ye.INTENSITYMODE_LUMINOUSPOWER:e=1/(4*Math.PI);break;case Ye.INTENSITYMODE_LUMINOUSINTENSITY:e=1;break;case Ye.INTENSITYMODE_LUMINANCE:e=this.radius*this.radius;break}break;case Ye.LIGHTTYPEID_DIRECTIONALLIGHT:switch(i){case Ye.INTENSITYMODE_ILLUMINANCE:e=1;break;case Ye.INTENSITYMODE_LUMINANCE:{let r=this.radius;r=Math.max(r,.001),e=2*Math.PI*(1-Math.cos(r));break}}break;case Ye.LIGHTTYPEID_HEMISPHERICLIGHT:e=1;break}return e}_reorderLightsInScene(){const e=this.getScene();this._renderPriority!=0&&(e.requireLightSorting=!0),this.getScene().sortLightsByPriority()}}Ye.FALLOFF_DEFAULT=Et.FALLOFF_DEFAULT;Ye.FALLOFF_PHYSICAL=Et.FALLOFF_PHYSICAL;Ye.FALLOFF_GLTF=Et.FALLOFF_GLTF;Ye.FALLOFF_STANDARD=Et.FALLOFF_STANDARD;Ye.LIGHTMAP_DEFAULT=Et.LIGHTMAP_DEFAULT;Ye.LIGHTMAP_SPECULAR=Et.LIGHTMAP_SPECULAR;Ye.LIGHTMAP_SHADOWSONLY=Et.LIGHTMAP_SHADOWSONLY;Ye.INTENSITYMODE_AUTOMATIC=Et.INTENSITYMODE_AUTOMATIC;Ye.INTENSITYMODE_LUMINOUSPOWER=Et.INTENSITYMODE_LUMINOUSPOWER;Ye.INTENSITYMODE_LUMINOUSINTENSITY=Et.INTENSITYMODE_LUMINOUSINTENSITY;Ye.INTENSITYMODE_ILLUMINANCE=Et.INTENSITYMODE_ILLUMINANCE;Ye.INTENSITYMODE_LUMINANCE=Et.INTENSITYMODE_LUMINANCE;Ye.LIGHTTYPEID_POINTLIGHT=Et.LIGHTTYPEID_POINTLIGHT;Ye.LIGHTTYPEID_DIRECTIONALLIGHT=Et.LIGHTTYPEID_DIRECTIONALLIGHT;Ye.LIGHTTYPEID_SPOTLIGHT=Et.LIGHTTYPEID_SPOTLIGHT;Ye.LIGHTTYPEID_HEMISPHERICLIGHT=Et.LIGHTTYPEID_HEMISPHERICLIGHT;R([br()],Ye.prototype,"diffuse",void 0);R([br()],Ye.prototype,"specular",void 0);R([I()],Ye.prototype,"falloffType",void 0);R([I()],Ye.prototype,"intensity",void 0);R([I()],Ye.prototype,"range",null);R([I()],Ye.prototype,"intensityMode",null);R([I()],Ye.prototype,"radius",null);R([I()],Ye.prototype,"_renderPriority",void 0);R([ie("_reorderLightsInScene")],Ye.prototype,"renderPriority",void 0);R([I("shadowEnabled")],Ye.prototype,"_shadowEnabled",void 0);R([I("excludeWithLayerMask")],Ye.prototype,"_excludeWithLayerMask",void 0);R([I("includeOnlyWithLayerMask")],Ye.prototype,"_includeOnlyWithLayerMask",void 0);R([I("lightmapMode")],Ye.prototype,"_lightmapMode",void 0);class dF extends Fu{}class fF{constructor(){this.rootNodes=[],this.skeletons=[],this.animationGroups=[]}dispose(){this.rootNodes.slice(0).forEach(e=>{e.dispose()}),this.rootNodes.length=0,this.skeletons.slice(0).forEach(e=>{e.dispose()}),this.skeletons.length=0,this.animationGroups.slice(0).forEach(e=>{e.dispose()}),this.animationGroups.length=0}}class _F extends Fu{constructor(e){super(),this._wasAddedToScene=!1,e=e||He.LastCreatedScene,e&&(this.scene=e,this.sounds=[],this.effectLayers=[],this.layers=[],this.lensFlareSystems=[],this.proceduralTextures=[],this.reflectionProbes=[],e.onDisposeObservable.add(()=>{this._wasAddedToScene||this.dispose()}),this._onContextRestoredObserver=e.getEngine().onContextRestoredObservable.add(()=>{for(const t of this.geometries)t._rebuild();for(const t of this.meshes)t._rebuild();for(const t of this.particleSystems)t.rebuild();for(const t of this.textures)t._rebuild()}))}_topologicalSort(e){const t=new Map;for(const l of e)t.set(l.uniqueId,l);const i={dependsOn:new Map,dependedBy:new Map};for(const l of e){const o=l.uniqueId;i.dependsOn.set(o,new Set),i.dependedBy.set(o,new Set)}for(const l of e){const o=l.uniqueId,c=i.dependsOn.get(o);if(l instanceof yo){const h=l.sourceMesh;t.has(h.uniqueId)&&(c.add(h.uniqueId),i.dependedBy.get(h.uniqueId).add(o))}const u=i.dependedBy.get(o);for(const h of l.getDescendants()){const d=h.uniqueId;t.has(d)&&(u.add(d),i.dependsOn.get(d).add(o))}}const r=[],s=[];for(const l of e){const o=l.uniqueId;i.dependsOn.get(o).size===0&&(s.push(l),t.delete(o))}const a=s;for(;a.length>0;){const l=a.shift();r.push(l);const o=i.dependedBy.get(l.uniqueId);for(const c of Array.from(o.values())){const u=i.dependsOn.get(c);u.delete(l.uniqueId),u.size===0&&t.get(c)&&(a.push(t.get(c)),t.delete(c))}}return t.size>0&&(ee.Error("SceneSerializer._topologicalSort: There were unvisited nodes:"),t.forEach(l=>ee.Error(l.name))),r}_addNodeAndDescendantsToList(e,t,i,r){if(!(!i||r&&!r(i)||t.has(i.uniqueId))){e.push(i),t.add(i.uniqueId);for(const s of i.getDescendants(!0))this._addNodeAndDescendantsToList(e,t,s,r)}}_isNodeInContainer(e){return e instanceof yr&&this.meshes.indexOf(e)!==-1||e instanceof Ne&&this.transformNodes.indexOf(e)!==-1||e instanceof Ye&&this.lights.indexOf(e)!==-1||e instanceof Ie&&this.cameras.indexOf(e)!==-1}_isValidHierarchy(){for(const e of this.meshes)if(e.parent&&!this._isNodeInContainer(e.parent))return ee.Warn(`Node ${e.name} has a parent that is not in the container.`),!1;for(const e of this.transformNodes)if(e.parent&&!this._isNodeInContainer(e.parent))return ee.Warn(`Node ${e.name} has a parent that is not in the container.`),!1;for(const e of this.lights)if(e.parent&&!this._isNodeInContainer(e.parent))return ee.Warn(`Node ${e.name} has a parent that is not in the container.`),!1;for(const e of this.cameras)if(e.parent&&!this._isNodeInContainer(e.parent))return ee.Warn(`Node ${e.name} has a parent that is not in the container.`),!1;return!0}instantiateModelsToScene(e,t=!1,i){this._isValidHierarchy()||X.Warn("SceneSerializer.InstantiateModelsToScene: The Asset Container hierarchy is not valid.");const r={},s={},a=new fF,l=[],o=[],c={doNotInstantiate:!0,...i},u=(p,v)=>{if(r[p.uniqueId]=v.uniqueId,s[v.uniqueId]=v,e&&(v.name=e(p.name)),v instanceof Ae){const E=v;if(E.morphTargetManager){const g=p.morphTargetManager;E.morphTargetManager=g.clone();for(let m=0;m<g.numTargets;m++){const y=g.getTarget(m),T=E.morphTargetManager.getTarget(m);r[y.uniqueId]=T.uniqueId,s[T.uniqueId]=T}}}},h=[],d=new Set;for(const p of this.transformNodes)p.parent===null&&this._addNodeAndDescendantsToList(h,d,p,c.predicate);for(const p of this.meshes)p.parent===null&&this._addNodeAndDescendantsToList(h,d,p,c.predicate);const f=this._topologicalSort(h),_=(p,v)=>{if(u(p,v),p.parent){const E=r[p.parent.uniqueId],g=s[E];g?v.parent=g:v.parent=p.parent}if(v.position&&p.position&&v.position.copyFrom(p.position),v.rotationQuaternion&&p.rotationQuaternion&&v.rotationQuaternion.copyFrom(p.rotationQuaternion),v.rotation&&p.rotation&&v.rotation.copyFrom(p.rotation),v.scaling&&p.scaling&&v.scaling.copyFrom(p.scaling),v.material){const E=v;if(E.material)if(t){const g=p.material;if(o.indexOf(g)===-1){let m=g.clone(e?e(g.name):"Clone of "+g.name);if(o.push(g),r[g.uniqueId]=m.uniqueId,s[m.uniqueId]=m,g.getClassName()==="MultiMaterial"){const y=g;for(const T of y.subMaterials)T&&(m=T.clone(e?e(T.name):"Clone of "+T.name),o.push(T),r[T.uniqueId]=m.uniqueId,s[m.uniqueId]=m);y.subMaterials=y.subMaterials.map(T=>T&&s[r[T.uniqueId]])}}E.getClassName()!=="InstancedMesh"&&(E.material=s[r[g.uniqueId]])}else E.material.getClassName()==="MultiMaterial"?this.scene.multiMaterials.indexOf(E.material)===-1&&this.scene.addMultiMaterial(E.material):this.scene.materials.indexOf(E.material)===-1&&this.scene.addMaterial(E.material)}v.parent===null&&a.rootNodes.push(v)};return f.forEach(p=>{if(p.getClassName()==="InstancedMesh"){const v=p,E=v.sourceMesh,g=r[E.uniqueId],y=(typeof g=="number"?s[g]:E).createInstance(v.name);_(v,y)}else{let v=!0;p.getClassName()==="TransformNode"||p.getClassName()==="Node"||p.skeleton||!p.getTotalVertices||p.getTotalVertices()===0?v=!1:c.doNotInstantiate&&(typeof c.doNotInstantiate=="function"?v=!c.doNotInstantiate(p):v=!c.doNotInstantiate);const E=v?p.createInstance(`instance of ${p.name}`):p.clone(`Clone of ${p.name}`,null,!0);if(!E)throw new Error(`Could not clone or instantiate node on Asset Container ${p.name}`);_(p,E)}}),this.skeletons.forEach(p=>{if(c.predicate&&!c.predicate(p))return;const v=p.clone(e?e(p.name):"Clone of "+p.name);for(const E of this.meshes)if(E.skeleton===p&&!E.isAnInstance){const g=s[r[E.uniqueId]];if(!g||g.isAnInstance||(g.skeleton=v,l.indexOf(v)!==-1))continue;l.push(v);for(const m of v.bones)m._linkedTransformNode&&(m._linkedTransformNode=s[r[m._linkedTransformNode.uniqueId]])}a.skeletons.push(v)}),this.animationGroups.forEach(p=>{if(c.predicate&&!c.predicate(p))return;const v=p.clone(e?e(p.name):"Clone of "+p.name,E=>s[r[E.uniqueId]]||E);a.animationGroups.push(v)}),a}addAllToScene(){if(!this._wasAddedToScene){this._isValidHierarchy()||X.Warn("SceneSerializer.addAllToScene: The Asset Container hierarchy is not valid."),this._wasAddedToScene=!0,this.addToScene(null),this.environmentTexture&&(this.scene.environmentTexture=this.environmentTexture);for(const e of this.scene._serializableComponents)e.addFromContainer(this);this.scene.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null}}addToScene(e=null){const t=[];this.cameras.forEach(i=>{e&&!e(i)||(this.scene.addCamera(i),t.push(i))}),this.lights.forEach(i=>{e&&!e(i)||(this.scene.addLight(i),t.push(i))}),this.meshes.forEach(i=>{e&&!e(i)||(this.scene.addMesh(i),t.push(i))}),this.skeletons.forEach(i=>{e&&!e(i)||this.scene.addSkeleton(i)}),this.animations.forEach(i=>{e&&!e(i)||this.scene.addAnimation(i)}),this.animationGroups.forEach(i=>{e&&!e(i)||this.scene.addAnimationGroup(i)}),this.multiMaterials.forEach(i=>{e&&!e(i)||this.scene.addMultiMaterial(i)}),this.materials.forEach(i=>{e&&!e(i)||this.scene.addMaterial(i)}),this.morphTargetManagers.forEach(i=>{e&&!e(i)||this.scene.addMorphTargetManager(i)}),this.geometries.forEach(i=>{e&&!e(i)||this.scene.addGeometry(i)}),this.transformNodes.forEach(i=>{e&&!e(i)||(this.scene.addTransformNode(i),t.push(i))}),this.actionManagers.forEach(i=>{e&&!e(i)||this.scene.addActionManager(i)}),this.textures.forEach(i=>{e&&!e(i)||this.scene.addTexture(i)}),this.reflectionProbes.forEach(i=>{e&&!e(i)||this.scene.addReflectionProbe(i)});for(const i of t)i.parent&&this.scene.getNodes().indexOf(i.parent)===-1&&(i.setParent?i.setParent(null):i.parent=null)}removeAllFromScene(){this._isValidHierarchy()||X.Warn("SceneSerializer.removeAllFromScene: The Asset Container hierarchy is not valid."),this._wasAddedToScene=!1,this.removeFromScene(null),this.environmentTexture===this.scene.environmentTexture&&(this.scene.environmentTexture=null);for(const e of this.scene._serializableComponents)e.removeFromContainer(this)}removeFromScene(e=null){this.cameras.forEach(t=>{e&&!e(t)||this.scene.removeCamera(t)}),this.lights.forEach(t=>{e&&!e(t)||this.scene.removeLight(t)}),this.meshes.forEach(t=>{e&&!e(t)||this.scene.removeMesh(t,!0)}),this.skeletons.forEach(t=>{e&&!e(t)||this.scene.removeSkeleton(t)}),this.animations.forEach(t=>{e&&!e(t)||this.scene.removeAnimation(t)}),this.animationGroups.forEach(t=>{e&&!e(t)||this.scene.removeAnimationGroup(t)}),this.multiMaterials.forEach(t=>{e&&!e(t)||this.scene.removeMultiMaterial(t)}),this.materials.forEach(t=>{e&&!e(t)||this.scene.removeMaterial(t)}),this.morphTargetManagers.forEach(t=>{e&&!e(t)||this.scene.removeMorphTargetManager(t)}),this.geometries.forEach(t=>{e&&!e(t)||this.scene.removeGeometry(t)}),this.transformNodes.forEach(t=>{e&&!e(t)||this.scene.removeTransformNode(t)}),this.actionManagers.forEach(t=>{e&&!e(t)||this.scene.removeActionManager(t)}),this.textures.forEach(t=>{e&&!e(t)||this.scene.removeTexture(t)}),this.reflectionProbes.forEach(t=>{e&&!e(t)||this.scene.removeReflectionProbe(t)})}dispose(){this.cameras.slice(0).forEach(e=>{e.dispose()}),this.cameras.length=0,this.lights.slice(0).forEach(e=>{e.dispose()}),this.lights.length=0,this.meshes.slice(0).forEach(e=>{e.dispose()}),this.meshes.length=0,this.skeletons.slice(0).forEach(e=>{e.dispose()}),this.skeletons.length=0,this.animationGroups.slice(0).forEach(e=>{e.dispose()}),this.animationGroups.length=0,this.multiMaterials.slice(0).forEach(e=>{e.dispose()}),this.multiMaterials.length=0,this.materials.slice(0).forEach(e=>{e.dispose()}),this.materials.length=0,this.geometries.slice(0).forEach(e=>{e.dispose()}),this.geometries.length=0,this.transformNodes.slice(0).forEach(e=>{e.dispose()}),this.transformNodes.length=0,this.actionManagers.slice(0).forEach(e=>{e.dispose()}),this.actionManagers.length=0,this.textures.slice(0).forEach(e=>{e.dispose()}),this.textures.length=0,this.reflectionProbes.slice(0).forEach(e=>{e.dispose()}),this.reflectionProbes.length=0,this.morphTargetManagers.slice(0).forEach(e=>{e.dispose()}),this.morphTargetManagers.length=0,this.environmentTexture&&(this.environmentTexture.dispose(),this.environmentTexture=null);for(const e of this.scene._serializableComponents)e.removeFromContainer(this,!0);this._onContextRestoredObserver&&(this.scene.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null)}_moveAssets(e,t,i){if(!(!e||!t))for(const r of e){let s=!0;if(i){for(const a of i)if(r===a){s=!1;break}}s&&(t.push(r),r._parentContainer=this)}}moveAllFromScene(e){this._wasAddedToScene=!1,e===void 0&&(e=new dF);for(const t in this)Object.prototype.hasOwnProperty.call(this,t)&&(this[t]=this[t]||(t==="_environmentTexture"?null:[]),this._moveAssets(this.scene[t],this[t],e[t]));this.environmentTexture=this.scene.environmentTexture,this.removeAllFromScene()}createRootMesh(){const e=new Ae("assetContainerRootMesh",this.scene);return this.meshes.forEach(t=>{t.parent||e.addChild(t)}),this.meshes.unshift(e),e}mergeAnimationsTo(e=He.LastCreatedScene,t,i=null){if(!e)return ee.Error("No scene available to merge animations to"),[];const r=i||(l=>{let o=null;const c=l.animations.length?l.animations[0].targetProperty:"",u=l.name.split(".").join("").split("_primitive")[0];switch(c){case"position":case"rotationQuaternion":o=e.getTransformNodeByName(l.name)||e.getTransformNodeByName(u);break;case"influence":o=e.getMorphTargetByName(l.name)||e.getMorphTargetByName(u);break;default:o=e.getNodeByName(l.name)||e.getNodeByName(u)}return o});this.getNodes().forEach(l=>{const o=r(l);if(o!==null){for(const c of l.animations){const u=o.animations.filter(h=>h.targetProperty===c.targetProperty);for(const h of u){const d=o.animations.indexOf(h,0);d>-1&&o.animations.splice(d,1)}}o.animations=o.animations.concat(l.animations)}});const a=[];return this.animationGroups.slice().forEach(l=>{a.push(l.clone(l.name,r)),l.animatables.forEach(o=>{o.stop()})}),t.forEach(l=>{const o=r(l.target);o&&(e.beginAnimation(o,l.fromFrame,l.toFrame,l.loopAnimation,l.speedRatio,l.onAnimationEnd?l.onAnimationEnd:void 0,void 0,!0,void 0,l.onAnimationLoop?l.onAnimationLoop:void 0),e.stopAnimation(l.target))}),a}populateRootNodes(){this.rootNodes.length=0,this.meshes.forEach(e=>{!e.parent&&this.rootNodes.indexOf(e)===-1&&this.rootNodes.push(e)}),this.transformNodes.forEach(e=>{!e.parent&&this.rootNodes.indexOf(e)===-1&&this.rootNodes.push(e)}),this.lights.forEach(e=>{!e.parent&&this.rootNodes.indexOf(e)===-1&&this.rootNodes.push(e)}),this.cameras.forEach(e=>{!e.parent&&this.rootNodes.indexOf(e)===-1&&this.rootNodes.push(e)})}addAllAssetsToContainer(e){if(!e)return;const t=[],i=new Set;for(t.push(e);t.length>0;){const r=t.pop();if(r instanceof Ae?(r.geometry&&this.geometries.indexOf(r.geometry)===-1&&this.geometries.push(r.geometry),this.meshes.push(r)):r instanceof Ne?this.transformNodes.push(r):r instanceof Ye?this.lights.push(r):r instanceof Ie&&this.cameras.push(r),r instanceof yr){if(r.material&&this.materials.indexOf(r.material)===-1){this.materials.push(r.material);for(const s of r.material.getActiveTextures())this.textures.indexOf(s)===-1&&this.textures.push(s)}r.skeleton&&this.skeletons.indexOf(r.skeleton)===-1&&this.skeletons.push(r.skeleton),r.morphTargetManager&&this.morphTargetManagers.indexOf(r.morphTargetManager)===-1&&this.morphTargetManagers.push(r.morphTargetManager)}for(const s of r.getChildren())i.has(s)||t.push(s);i.add(r)}this.populateRootNodes()}}class Yr{constructor(e,t){this.width=e,this.height=t}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let e=this.width|0;return e=e*397^(this.height|0),e}copyFrom(e){this.width=e.width,this.height=e.height}copyFromFloats(e,t){return this.width=e,this.height=t,this}set(e,t){return this.copyFromFloats(e,t)}multiplyByFloats(e,t){return new Yr(this.width*e,this.height*t)}clone(){return new Yr(this.width,this.height)}equals(e){return e?this.width===e.width&&this.height===e.height:!1}get surface(){return this.width*this.height}static Zero(){return new Yr(0,0)}add(e){return new Yr(this.width+e.width,this.height+e.height)}subtract(e){return new Yr(this.width-e.width,this.height-e.height)}scale(e){return new Yr(this.width*e,this.height*e)}static Lerp(e,t,i){const r=e.width+(t.width-e.width)*i,s=e.height+(t.height-e.height)*i;return new Yr(r,s)}}class Am{get wrapU(){return this._wrapU}set wrapU(e){this._wrapU=e}get wrapV(){return this._wrapV}set wrapV(e){this._wrapV=e}get coordinatesMode(){return 0}get isCube(){return this._texture?this._texture.isCube:!1}set isCube(e){this._texture&&(this._texture.isCube=e)}get is3D(){return this._texture?this._texture.is3D:!1}set is3D(e){this._texture&&(this._texture.is3D=e)}get is2DArray(){return this._texture?this._texture.is2DArray:!1}set is2DArray(e){this._texture&&(this._texture.is2DArray=e)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(e){return(e==null?void 0:e._shareDepth)!==void 0}constructor(e){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=Yr.Zero(),this._cachedBaseSize=Yr.Zero(),this._initialSamplingMode=2,this._texture=Am._IsRenderTargetWrapper(e)?e.texture:e,this._texture&&(this._engine=this._texture.getEngine())}isReady(){return this.delayLoadState===4?(this.delayLoad(),!1):this._texture?this._texture.isReady:!1}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return!this.isReady()||!this._texture?(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize):this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(e){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(e,this._texture)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}class zt extends Am{set hasAlpha(e){this._hasAlpha!==e&&(this._hasAlpha=e,this._scene&&this._scene.markAllMaterialsAsDirty(1,t=>t.hasTexture(this)))}get hasAlpha(){return this._hasAlpha}set getAlphaFromRGB(e){this._getAlphaFromRGB!==e&&(this._getAlphaFromRGB=e,this._scene&&this._scene.markAllMaterialsAsDirty(1,t=>t.hasTexture(this)))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(e){this._coordinatesIndex!==e&&(this._coordinatesIndex=e,this._scene&&this._scene.markAllMaterialsAsDirty(1,t=>t.hasTexture(this)))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(e){this._coordinatesMode!==e&&(this._coordinatesMode=e,this._scene&&this._scene.markAllMaterialsAsDirty(1,t=>t.hasTexture(this)))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(e){this._wrapU=e}get wrapV(){return this._wrapV}set wrapV(e){this._wrapV=e}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(e){this._texture?this._texture.isCube=e:this._isCube=e}get is3D(){return this._texture?this._texture.is3D:!1}set is3D(e){this._texture&&(this._texture.is3D=e)}get is2DArray(){return this._texture?this._texture.is2DArray:!1}set is2DArray(e){this._texture&&(this._texture.is2DArray=e)}get gammaSpace(){if(this._texture)this._texture._gammaSpace===null&&(this._texture._gammaSpace=this._gammaSpace);else return this._gammaSpace;return this._texture._gammaSpace&&!this._texture._useSRGBBuffer}set gammaSpace(e){var t;if(this._texture){if(this._texture._gammaSpace===e)return;this._texture._gammaSpace=e}else{if(this._gammaSpace===e)return;this._gammaSpace=e}(t=this.getScene())==null||t.markAllMaterialsAsDirty(1,i=>i.hasTexture(this))}get isRGBD(){return this._texture!=null&&this._texture._isRGBD}set isRGBD(e){var t;e!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=e),(t=this.getScene())==null||t.markAllMaterialsAsDirty(1,i=>i.hasTexture(this)))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(e){this._texture&&(this._texture._lodGenerationOffset=e)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(e){this._texture&&(this._texture._lodGenerationScale=e)}get linearSpecularLOD(){return this._texture?this._texture._linearSpecularLOD:!1}set linearSpecularLOD(e){this._texture&&(this._texture._linearSpecularLOD=e)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(e){this._texture&&(this._texture._irradianceTexture=e)}get uid(){return this._uid||(this._uid=$d()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(e,t=null){super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=zt.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.onDisposeObservable=new Y,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,e?zt._IsScene(e)?this._scene=e:this._engine=e:this._scene=He.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=t,this._uid=null}getScene(){return this._scene}_getEngine(){return this._engine}checkTransformsAreIdentical(e){return e!==null}getTextureMatrix(){return z.IdentityReadOnly}getReflectionTextureMatrix(){return z.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(e){}get canRescale(){return!1}_getFromCache(e,t,i,r,s,a){const l=this._getEngine();if(!l)return null;const o=l._getUseSRGBBuffer(!!s,t),c=l.getLoadedTexturesCache();for(let u=0;u<c.length;u++){const h=c[u];if((s===void 0||o===h._useSRGBBuffer)&&(r===void 0||r===h.invertY)&&h.url===e&&h.generateMipMaps===!t&&(!i||i===h.samplingMode)&&(a===void 0||a===h.isCube))return h.incrementReferences(),h}return null}_rebuild(e=!1){}clone(){return null}get textureType(){return this._texture&&this._texture.type!==void 0?this._texture.type:0}get textureFormat(){return this._texture&&this._texture.format!==void 0?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const e=this.getScene();e&&e.markAllMaterialsAsDirty(1)}readPixels(e=0,t=0,i=null,r=!0,s=!1,a=0,l=0,o=Number.MAX_VALUE,c=Number.MAX_VALUE){if(!this._texture)return null;const u=this._getEngine();if(!u)return null;const h=this.getSize();let d=h.width,f=h.height;t!==0&&(d=d/Math.pow(2,t),f=f/Math.pow(2,t),d=Math.round(d),f=Math.round(f)),o=Math.min(d,o),c=Math.min(f,c);try{return this._texture.isCube?u._readTexturePixels(this._texture,o,c,e,t,i,r,s,a,l):u._readTexturePixels(this._texture,o,c,-1,t,i,r,s,a,l)}catch{return null}}_readPixelsSync(e=0,t=0,i=null,r=!0,s=!1){if(!this._texture)return null;const a=this.getSize();let l=a.width,o=a.height;const c=this._getEngine();if(!c)return null;t!=0&&(l=l/Math.pow(2,t),o=o/Math.pow(2,t),l=Math.round(l),o=Math.round(o));try{return this._texture.isCube?c._readTexturePixelsSync(this._texture,l,o,e,t,i,r,s):c._readTexturePixelsSync(this._texture,l,o,-1,t,i,r,s)}catch{return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const e=this._scene.textures.indexOf(this);if(e>=0&&this._scene.textures.splice(e,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const t=this._parentContainer.textures.indexOf(this);t>-1&&this._parentContainer.textures.splice(t,1),this._parentContainer=null}}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.metadata=null,super.dispose()}serialize(e=!1){if(!this.name&&!e)return null;const t=Fe.Serialize(this);return Fe.AppendSerializedAnimations(this,t),t}static WhenAllReady(e,t){let i=e.length;if(i===0){t();return}for(let r=0;r<e.length;r++){const s=e[r];if(s.isReady())--i===0&&t();else{const a=s.onLoadObservable;a?a.addOnce(()=>{--i===0&&t()}):--i===0&&t()}}}static _IsScene(e){return e.getClassName()==="Scene"}}zt.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4;R([I()],zt.prototype,"uniqueId",void 0);R([I()],zt.prototype,"name",void 0);R([I()],zt.prototype,"metadata",void 0);R([I("hasAlpha")],zt.prototype,"_hasAlpha",void 0);R([I("getAlphaFromRGB")],zt.prototype,"_getAlphaFromRGB",void 0);R([I()],zt.prototype,"level",void 0);R([I("coordinatesIndex")],zt.prototype,"_coordinatesIndex",void 0);R([I()],zt.prototype,"optimizeUVAllocation",void 0);R([I("coordinatesMode")],zt.prototype,"_coordinatesMode",void 0);R([I()],zt.prototype,"wrapU",null);R([I()],zt.prototype,"wrapV",null);R([I()],zt.prototype,"wrapR",void 0);R([I()],zt.prototype,"anisotropicFilteringLevel",void 0);R([I()],zt.prototype,"isCube",null);R([I()],zt.prototype,"is3D",null);R([I()],zt.prototype,"is2DArray",null);R([I()],zt.prototype,"gammaSpace",null);R([I()],zt.prototype,"invertZ",void 0);R([I()],zt.prototype,"lodLevelInAlpha",void 0);R([I()],zt.prototype,"lodGenerationOffset",null);R([I()],zt.prototype,"lodGenerationScale",null);R([I()],zt.prototype,"linearSpecularLOD",null);R([At()],zt.prototype,"irradianceTexture",null);R([I()],zt.prototype,"isRenderTarget",void 0);function L1(n,e,t=!1){const i=e.width,r=e.height;if(n instanceof Float32Array){let c=n.byteLength/n.BYTES_PER_ELEMENT;const u=new Uint8Array(c);for(;--c>=0;){let h=n[c];h<0?h=0:h>1&&(h=1),u[c]=h*255}n=u}const s=document.createElement("canvas");s.width=i,s.height=r;const a=s.getContext("2d");if(!a)return null;const l=a.createImageData(i,r);if(l.data.set(n),a.putImageData(l,0,0),t){const c=document.createElement("canvas");c.width=i,c.height=r;const u=c.getContext("2d");return u?(u.translate(0,r),u.scale(1,-1),u.drawImage(s,0,0),c.toDataURL("image/png")):null}return s.toDataURL("image/png")}function pF(n,e=0,t=0){const i=n.getInternalTexture();if(!i)return null;const r=n._readPixelsSync(e,t);return r?L1(r,n.getSize(),i.invertY):null}async function gF(n,e=0,t=0){const i=n.getInternalTexture();if(!i)return null;const r=await n.readPixels(e,t);return r?L1(r,n.getSize(),i.invertY):null}let re=class ri extends zt{static _CreateVideoTexture(e,t,i,r=!1,s=!1,a=ri.TRILINEAR_SAMPLINGMODE,l={},o,c=5){throw ke("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(e){this._isBlocking=e}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(e,t,i,r,s=ri.TRILINEAR_SAMPLINGMODE,a=null,l=null,o=null,c=!1,u,h,d,f,_){super(t),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new Y,this._isBlocking=!0,this.name=e||"",this.url=e;let p,v=!1,E=null,g=!0;typeof i=="object"&&i!==null?(p=i.noMipmap??!1,r=i.invertY??!As.UseOpenGLOrientationForUV,s=i.samplingMode??ri.TRILINEAR_SAMPLINGMODE,a=i.onLoad??null,l=i.onError??null,o=i.buffer??null,c=i.deleteBuffer??!1,u=i.format,h=i.mimeType,d=i.loaderOptions,f=i.creationFlags,v=i.useSRGBBuffer??!1,E=i.internalTexture??null,g=i.gammaSpace??g):p=!!i,this._gammaSpace=g,this._noMipmap=p,this._invertY=r===void 0?!As.UseOpenGLOrientationForUV:r,this._initialSamplingMode=s,this._buffer=o,this._deleteBuffer=c,this._mimeType=h,this._loaderOptions=d,this._creationFlags=f,this._useSRGBBuffer=v,this._forcedExtension=_,u&&(this._format=u);const m=this.getScene(),y=this._getEngine();if(!y)return;y.onBeforeTextureInitObservable.notifyObservers(this);const T=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),this._texture._cachedWrapU!==null&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),this._texture._cachedWrapV!==null&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),this._texture._cachedWrapR!==null&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),a&&a(),!this.isBlocking&&m&&m.resetCachedMaterial()},b=(C,M)=>{this._loadingError=!0,this._errorObject={message:C,exception:M},l&&l(C,M),ri.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!E){this._delayedOnLoad=T,this._delayedOnError=b;return}if(this._texture=E??this._getFromCache(this.url,p,s,this._invertY,v,this.isCube),this._texture)if(this._texture.isReady)$h.SetImmediate(()=>T());else{const C=this._texture.onLoadedObservable.add(T);this._texture.onErrorObservable.add(M=>{var F;b(M.message,M.exception),(F=this._texture)==null||F.onLoadedObservable.remove(C)})}else if(!m||!m.useDelayedTextureLoading){try{this._texture=y.createTexture(this.url,p,this._invertY,m,s,T,b,this._buffer,void 0,this._format,this._forcedExtension,h,d,f,v)}catch(C){throw b("error loading",C),C}c&&(this._buffer=null)}else this.delayLoadState=4,this._delayedOnLoad=T,this._delayedOnError=b}updateURL(e,t=null,i,r){this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(1,s=>s.hasTexture(this))),(!this.name||this.name.startsWith("data:"))&&(this.name=e),this.url=e,this._buffer=t,this._forcedExtension=r,this.delayLoadState=4,i&&(this._delayedOnLoad=i),this.delayLoad()}delayLoad(){if(this.delayLoadState!==4)return;const e=this.getScene();e&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?$h.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=e.getEngine().createTexture(this.url,this._noMipmap,this._invertY,e,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(e,t,i,r){e*=this._cachedUScale,t*=this._cachedVScale,e-=this.uRotationCenter*this._cachedUScale,t-=this.vRotationCenter*this._cachedVScale,i-=this.wRotationCenter,A.TransformCoordinatesFromFloatsToRef(e,t,i,this._rowGenerationMatrix,r),r.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,r.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,r.z+=this.wRotationCenter}checkTransformsAreIdentical(e){return e!==null&&this.uOffset===e.uOffset&&this.vOffset===e.vOffset&&this.uScale===e.uScale&&this.vScale===e.vScale&&this.uAng===e.uAng&&this.vAng===e.vAng&&this.wAng===e.wAng}getTextureMatrix(e=1){if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*e===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*e,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,(!this._cachedTextureMatrix||!this._rowGenerationMatrix)&&(this._cachedTextureMatrix=z.Zero(),this._rowGenerationMatrix=new z,this._t0=A.Zero(),this._t1=A.Zero(),this._t2=A.Zero()),z.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(z.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,V.Matrix[0]),z.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,V.Matrix[1]),z.ScalingToRef(this._cachedUScale,this._cachedVScale,0,V.Matrix[2]),z.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,V.Matrix[3]),V.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(V.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(V.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(V.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),z.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const t=this.getScene();return t?(this.optimizeUVAllocation&&t.markAllMaterialsAsDirty(1,i=>i.hasTexture(this)),this._cachedTextureMatrix):this._cachedTextureMatrix}getReflectionTextureMatrix(){const e=this.getScene();if(!e)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode)if(this.coordinatesMode===ri.PROJECTION_MODE){if(this._cachedReflectionProjectionMatrixId===e.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}else return this._cachedReflectionTextureMatrix;this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=z.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=z.Zero());const t=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case ri.PLANAR_MODE:{z.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break}case ri.PROJECTION_MODE:{z.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const i=e.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=i.updateFlag,i.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:z.IdentityToRef(this._cachedReflectionTextureMatrix);break}return t&&e.markAllMaterialsAsDirty(1,i=>i.hasTexture(this)),this._cachedReflectionTextureMatrix}clone(){const e={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,onLoad:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return Fe.Clone(()=>new ri(this._texture?this._texture.url:null,this.getScene(),e),this)}serialize(){var i;const e=this.name;ri.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const t=super.serialize(ri._SerializeInternalTextureUniqueId);return t?((ri.SerializeBuffers||ri.ForceSerializeBuffers)&&(typeof this._buffer=="string"&&this._buffer.substr(0,5)==="data:"?(t.base64String=this._buffer,t.name=t.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?t.base64String="data:image/png;base64,"+i1(this._buffer):(ri.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(t.base64String=!this._engine||this._engine._features.supportSyncTextureRead?pF(this):gF(this))),t.invertY=this._invertY,t.samplingMode=this.samplingMode,t._creationFlags=this._creationFlags,t._useSRGBBuffer=this._useSRGBBuffer,ri._SerializeInternalTextureUniqueId&&(t.internalTextureUniqueId=((i=this._texture)==null?void 0:i.uniqueId)??void 0),t.noMipmap=this._noMipmap,this.name=e,t):null}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(e,t,i){if(e.customType){const c=Hc.Instantiate(e.customType).Parse(e,t,i);return e.samplingMode&&c.updateSamplingMode&&c._samplingMode&&c._samplingMode!==e.samplingMode&&c.updateSamplingMode(e.samplingMode),c}if(e.isCube&&!e.isRenderTarget)return ri._CubeTextureParser(e,t,i);const r=e.internalTextureUniqueId!==void 0;if(!e.name&&!e.isRenderTarget&&!r)return null;let s;if(r){const o=t.getEngine().getLoadedTexturesCache();for(const c of o)if(c.uniqueId===e.internalTextureUniqueId){s=c;break}}const a=o=>{var c;if(o&&o._texture&&(o._texture._cachedWrapU=null,o._texture._cachedWrapV=null,o._texture._cachedWrapR=null),e.samplingMode){const u=e.samplingMode;o&&o.samplingMode!==u&&o.updateSamplingMode(u)}if(o&&e.animations)for(let u=0;u<e.animations.length;u++){const h=e.animations[u],d=Bn("BABYLON.Animation");d&&o.animations.push(d.Parse(h))}r&&!s&&((c=o==null?void 0:o._texture)==null||c._setUniqueId(e.internalTextureUniqueId))};return Fe.Parse(()=>{let o=!0;if(e.noMipmap&&(o=!1),e.mirrorPlane){const c=ri._CreateMirror(e.name,e.renderTargetSize,t,o);return c._waitingRenderList=e.renderList,c.mirrorPlane=hn.FromArray(e.mirrorPlane),a(c),c}else if(e.isRenderTarget){let c=null;if(e.isCube){if(t.reflectionProbes)for(let u=0;u<t.reflectionProbes.length;u++){const h=t.reflectionProbes[u];if(h.name===e.name)return h.cubeTexture}}else c=ri._CreateRenderTargetTexture(e.name,e.renderTargetSize,t,o,e._creationFlags??0),c._waitingRenderList=e.renderList;return a(c),c}else if(e.isVideo){const c=ri._CreateVideoTexture(i+(e.url||e.name),i+(e.src||e.url),t,o,e.invertY,e.samplingMode,e.settings||{});return a(c),c}else{let c;if(e.base64String&&!s)c=ri.CreateFromBase64String(e.base64String,e.base64String,t,!o,e.invertY,e.samplingMode,()=>{a(c)},e._creationFlags??0,e._useSRGBBuffer??!1),c.name=e.name;else{let u;e.name&&(e.name.indexOf("://")>0||e.name.startsWith("data:"))?u=e.name:u=i+e.name,e.url&&(e.url.startsWith("data:")||ri.UseSerializedUrlIfAny)&&(u=e.url);const h={noMipmap:!o,invertY:e.invertY,samplingMode:e.samplingMode,onLoad:()=>{a(c)},internalTexture:s};c=new ri(u,t,h)}return c}},e,t)}static CreateFromBase64String(e,t,i,r,s,a=ri.TRILINEAR_SAMPLINGMODE,l=null,o=null,c=5,u){return new ri("data:"+t,i,r,s,a,l,o,e,!1,c,void 0,void 0,u)}static LoadFromDataString(e,t,i,r=!1,s,a=!0,l=ri.TRILINEAR_SAMPLINGMODE,o=null,c=null,u=5,h){return e.substr(0,5)!=="data:"&&(e="data:"+e),new ri(e,i,s,a,l,o,c,t,r,u,void 0,void 0,h)}};re.SerializeBuffers=!0;re.ForceSerializeBuffers=!1;re.OnTextureLoadErrorObservable=new Y;re._SerializeInternalTextureUniqueId=!1;re._CubeTextureParser=(n,e,t)=>{throw ke("CubeTexture")};re._CreateMirror=(n,e,t,i)=>{throw ke("MirrorTexture")};re._CreateRenderTargetTexture=(n,e,t,i,r)=>{throw ke("RenderTargetTexture")};re.NEAREST_SAMPLINGMODE=1;re.NEAREST_NEAREST_MIPLINEAR=8;re.BILINEAR_SAMPLINGMODE=2;re.LINEAR_LINEAR_MIPNEAREST=11;re.TRILINEAR_SAMPLINGMODE=3;re.LINEAR_LINEAR_MIPLINEAR=3;re.NEAREST_NEAREST_MIPNEAREST=4;re.NEAREST_LINEAR_MIPNEAREST=5;re.NEAREST_LINEAR_MIPLINEAR=6;re.NEAREST_LINEAR=7;re.NEAREST_NEAREST=1;re.LINEAR_NEAREST_MIPNEAREST=9;re.LINEAR_NEAREST_MIPLINEAR=10;re.LINEAR_LINEAR=2;re.LINEAR_NEAREST=12;re.EXPLICIT_MODE=0;re.SPHERICAL_MODE=1;re.PLANAR_MODE=2;re.CUBIC_MODE=3;re.PROJECTION_MODE=4;re.SKYBOX_MODE=5;re.INVCUBIC_MODE=6;re.EQUIRECTANGULAR_MODE=7;re.FIXED_EQUIRECTANGULAR_MODE=8;re.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9;re.CLAMP_ADDRESSMODE=0;re.WRAP_ADDRESSMODE=1;re.MIRROR_ADDRESSMODE=2;re.UseSerializedUrlIfAny=!1;R([I()],re.prototype,"url",void 0);R([I()],re.prototype,"uOffset",void 0);R([I()],re.prototype,"vOffset",void 0);R([I()],re.prototype,"uScale",void 0);R([I()],re.prototype,"vScale",void 0);R([I()],re.prototype,"uAng",void 0);R([I()],re.prototype,"vAng",void 0);R([I()],re.prototype,"wAng",void 0);R([I()],re.prototype,"uRotationCenter",void 0);R([I()],re.prototype,"vRotationCenter",void 0);R([I()],re.prototype,"wRotationCenter",void 0);R([I()],re.prototype,"homogeneousRotationInUVTransform",void 0);R([I()],re.prototype,"isBlocking",null);Ji("BABYLON.Texture",re);Fe._TextureParser=re.Parse;class td{constructor(){this.previousWorldMatrices={},this.previousBones={}}static AddUniforms(e){e.push("previousWorld","previousViewProjection","mPreviousBones")}static AddSamplers(e){}bindForSubMesh(e,t,i,r,s){if(t.prePassRenderer&&t.prePassRenderer.enabled&&t.prePassRenderer.currentRTisSceneRT&&t.prePassRenderer.getIndex(2)!==-1){this.previousWorldMatrices[i.uniqueId]||(this.previousWorldMatrices[i.uniqueId]=r.clone()),this.previousViewProjection||(this.previousViewProjection=t.getTransformMatrix().clone(),this.currentViewProjection=t.getTransformMatrix().clone());const a=t.getEngine();this.currentViewProjection.updateFlag!==t.getTransformMatrix().updateFlag?(this._lastUpdateFrameId=a.frameId,this.previousViewProjection.copyFrom(this.currentViewProjection),this.currentViewProjection.copyFrom(t.getTransformMatrix())):this._lastUpdateFrameId!==a.frameId&&(this._lastUpdateFrameId=a.frameId,this.previousViewProjection.copyFrom(this.currentViewProjection)),e.setMatrix("previousWorld",this.previousWorldMatrices[i.uniqueId]),e.setMatrix("previousViewProjection",this.previousViewProjection),this.previousWorldMatrices[i.uniqueId]=r.clone()}}}class Ws{constructor(e){if(this._keys=[],this._isDirty=!0,this._areLightsDirty=!0,this._areLightsDisposed=!1,this._areAttributesDirty=!0,this._areTexturesDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._arePrePassDirty=!0,this._areImageProcessingDirty=!0,this._normals=!1,this._uvs=!1,this._needNormals=!1,this._needUVs=!1,this._externalProperties=e,e)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this._setDefaultValue(t)}get isDirty(){return this._isDirty}markAsProcessed(){this._isDirty=!1,this._areAttributesDirty=!1,this._areTexturesDirty=!1,this._areFresnelDirty=!1,this._areLightsDirty=!1,this._areLightsDisposed=!1,this._areMiscDirty=!1,this._arePrePassDirty=!1,this._areImageProcessingDirty=!1}markAsUnprocessed(){this._isDirty=!0}markAllAsDirty(){this._areTexturesDirty=!0,this._areAttributesDirty=!0,this._areLightsDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._arePrePassDirty=!1,this._areImageProcessingDirty=!0,this._isDirty=!0}markAsImageProcessingDirty(){this._areImageProcessingDirty=!0,this._isDirty=!0}markAsLightDirty(e=!1){this._areLightsDirty=!0,this._areLightsDisposed=this._areLightsDisposed||e,this._isDirty=!0}markAsAttributesDirty(){this._areAttributesDirty=!0,this._isDirty=!0}markAsTexturesDirty(){this._areTexturesDirty=!0,this._isDirty=!0}markAsFresnelDirty(){this._areFresnelDirty=!0,this._isDirty=!0}markAsMiscDirty(){this._areMiscDirty=!0,this._isDirty=!0}markAsPrePassDirty(){this._arePrePassDirty=!0,this._isDirty=!0}rebuild(){this._keys.length=0;for(const e of Object.keys(this))e[0]!=="_"&&this._keys.push(e);if(this._externalProperties)for(const e in this._externalProperties)this._keys.indexOf(e)===-1&&this._keys.push(e)}isEqual(e){if(this._keys.length!==e._keys.length)return!1;for(let t=0;t<this._keys.length;t++){const i=this._keys[t];if(this[i]!==e[i])return!1}return!0}cloneTo(e){this._keys.length!==e._keys.length&&(e._keys=this._keys.slice(0));for(let t=0;t<this._keys.length;t++){const i=this._keys[t];e[i]=this[i]}}reset(){this._keys.forEach(e=>this._setDefaultValue(e))}_setDefaultValue(e){var r,s,a,l;const t=((s=(r=this._externalProperties)==null?void 0:r[e])==null?void 0:s.type)??typeof this[e],i=(l=(a=this._externalProperties)==null?void 0:a[e])==null?void 0:l.default;switch(t){case"number":this[e]=i??0;break;case"string":this[e]=i??"";break;default:this[e]=i??!1;break}}toString(){let e="";for(let t=0;t<this._keys.length;t++){const i=this._keys[t],r=this[i];switch(typeof r){case"number":case"string":e+="#define "+i+" "+r+`
`;break;default:r&&(e+="#define "+i+`
`);break}}return e}}class Sm extends j{constructor(e,t,i=!0){super(e,t),this._normalMatrix=new z,this._storeEffectOnSubMeshes=i}getEffect(){return this._storeEffectOnSubMeshes?this._activeEffect:super.getEffect()}isReady(e,t){return e?!this._storeEffectOnSubMeshes||!e.subMeshes||e.subMeshes.length===0?!0:this.isReadyForSubMesh(e,e.subMeshes[0],t):!1}_isReadyForSubMesh(e){const t=e.materialDefines;return!!(!this.checkReadyOnEveryCall&&e.effect&&t&&t._renderId===this.getScene().getRenderId())}bindOnlyWorldMatrix(e){this._activeEffect.setMatrix("world",e)}bindOnlyNormalMatrix(e){this._activeEffect.setMatrix("normalMatrix",e)}bind(e,t){t&&this.bindForSubMesh(e,t,t.subMeshes[0])}_afterBind(e,t=null,i){super._afterBind(e,t,i),this.getScene()._cachedEffect=t,i?i._drawWrapper._forceRebindOnNextCall=!1:this._drawWrapper._forceRebindOnNextCall=!1}_mustRebind(e,t,i,r=1){return i._drawWrapper._forceRebindOnNextCall||e.isCachedMaterialInvalid(this,t,r)}dispose(e,t,i){this._activeEffect=void 0,super.dispose(e,t,i)}}class te{static get DiffuseTextureEnabled(){return this._DiffuseTextureEnabled}static set DiffuseTextureEnabled(e){this._DiffuseTextureEnabled!==e&&(this._DiffuseTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get DetailTextureEnabled(){return this._DetailTextureEnabled}static set DetailTextureEnabled(e){this._DetailTextureEnabled!==e&&(this._DetailTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get DecalMapEnabled(){return this._DecalMapEnabled}static set DecalMapEnabled(e){this._DecalMapEnabled!==e&&(this._DecalMapEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get AmbientTextureEnabled(){return this._AmbientTextureEnabled}static set AmbientTextureEnabled(e){this._AmbientTextureEnabled!==e&&(this._AmbientTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get OpacityTextureEnabled(){return this._OpacityTextureEnabled}static set OpacityTextureEnabled(e){this._OpacityTextureEnabled!==e&&(this._OpacityTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get ReflectionTextureEnabled(){return this._ReflectionTextureEnabled}static set ReflectionTextureEnabled(e){this._ReflectionTextureEnabled!==e&&(this._ReflectionTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get EmissiveTextureEnabled(){return this._EmissiveTextureEnabled}static set EmissiveTextureEnabled(e){this._EmissiveTextureEnabled!==e&&(this._EmissiveTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get SpecularTextureEnabled(){return this._SpecularTextureEnabled}static set SpecularTextureEnabled(e){this._SpecularTextureEnabled!==e&&(this._SpecularTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get BumpTextureEnabled(){return this._BumpTextureEnabled}static set BumpTextureEnabled(e){this._BumpTextureEnabled!==e&&(this._BumpTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get LightmapTextureEnabled(){return this._LightmapTextureEnabled}static set LightmapTextureEnabled(e){this._LightmapTextureEnabled!==e&&(this._LightmapTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get RefractionTextureEnabled(){return this._RefractionTextureEnabled}static set RefractionTextureEnabled(e){this._RefractionTextureEnabled!==e&&(this._RefractionTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get ColorGradingTextureEnabled(){return this._ColorGradingTextureEnabled}static set ColorGradingTextureEnabled(e){this._ColorGradingTextureEnabled!==e&&(this._ColorGradingTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get FresnelEnabled(){return this._FresnelEnabled}static set FresnelEnabled(e){this._FresnelEnabled!==e&&(this._FresnelEnabled=e,Z.MarkAllMaterialsAsDirty(4))}static get ClearCoatTextureEnabled(){return this._ClearCoatTextureEnabled}static set ClearCoatTextureEnabled(e){this._ClearCoatTextureEnabled!==e&&(this._ClearCoatTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get ClearCoatBumpTextureEnabled(){return this._ClearCoatBumpTextureEnabled}static set ClearCoatBumpTextureEnabled(e){this._ClearCoatBumpTextureEnabled!==e&&(this._ClearCoatBumpTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get ClearCoatTintTextureEnabled(){return this._ClearCoatTintTextureEnabled}static set ClearCoatTintTextureEnabled(e){this._ClearCoatTintTextureEnabled!==e&&(this._ClearCoatTintTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get SheenTextureEnabled(){return this._SheenTextureEnabled}static set SheenTextureEnabled(e){this._SheenTextureEnabled!==e&&(this._SheenTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get AnisotropicTextureEnabled(){return this._AnisotropicTextureEnabled}static set AnisotropicTextureEnabled(e){this._AnisotropicTextureEnabled!==e&&(this._AnisotropicTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get ThicknessTextureEnabled(){return this._ThicknessTextureEnabled}static set ThicknessTextureEnabled(e){this._ThicknessTextureEnabled!==e&&(this._ThicknessTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get RefractionIntensityTextureEnabled(){return this._ThicknessTextureEnabled}static set RefractionIntensityTextureEnabled(e){this._RefractionIntensityTextureEnabled!==e&&(this._RefractionIntensityTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get TranslucencyIntensityTextureEnabled(){return this._ThicknessTextureEnabled}static set TranslucencyIntensityTextureEnabled(e){this._TranslucencyIntensityTextureEnabled!==e&&(this._TranslucencyIntensityTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}static get IridescenceTextureEnabled(){return this._IridescenceTextureEnabled}static set IridescenceTextureEnabled(e){this._IridescenceTextureEnabled!==e&&(this._IridescenceTextureEnabled=e,Z.MarkAllMaterialsAsDirty(1))}}te._DiffuseTextureEnabled=!0;te._DetailTextureEnabled=!0;te._DecalMapEnabled=!0;te._AmbientTextureEnabled=!0;te._OpacityTextureEnabled=!0;te._ReflectionTextureEnabled=!0;te._EmissiveTextureEnabled=!0;te._SpecularTextureEnabled=!0;te._BumpTextureEnabled=!0;te._LightmapTextureEnabled=!0;te._RefractionTextureEnabled=!0;te._ColorGradingTextureEnabled=!0;te._FresnelEnabled=!0;te._ClearCoatTextureEnabled=!0;te._ClearCoatBumpTextureEnabled=!0;te._ClearCoatTintTextureEnabled=!0;te._SheenTextureEnabled=!0;te._AnisotropicTextureEnabled=!0;te._ThicknessTextureEnabled=!0;te._RefractionIntensityTextureEnabled=!0;te._TranslucencyIntensityTextureEnabled=!0;te._IridescenceTextureEnabled=!0;const mF="decalFragmentDeclaration",vF=`#ifdef DECAL
uniform vec4 vDecalInfos;
#endif
`;ne.IncludesShadersStore[mF]=vF;const EF="defaultFragmentDeclaration",yF=`uniform vec4 vEyePosition;uniform vec4 vDiffuseColor;
#ifdef SPECULARTERM
uniform vec4 vSpecularColor;
#endif
uniform vec3 vEmissiveColor;uniform vec3 vAmbientColor;uniform float visibility;
#ifdef DIFFUSE
uniform vec2 vDiffuseInfos;
#endif
#ifdef AMBIENT
uniform vec2 vAmbientInfos;
#endif
#ifdef OPACITY 
uniform vec2 vOpacityInfos;
#endif
#ifdef EMISSIVE
uniform vec2 vEmissiveInfos;
#endif
#ifdef LIGHTMAP
uniform vec2 vLightmapInfos;
#endif
#ifdef BUMP
uniform vec3 vBumpInfos;uniform vec2 vTangentSpaceParams;
#endif
#ifdef ALPHATEST
uniform float alphaCutOff;
#endif
#if defined(REFLECTIONMAP_SPHERICAL) || defined(REFLECTIONMAP_PROJECTION) || defined(REFRACTION) || defined(PREPASS)
uniform mat4 view;
#endif
#ifdef REFRACTION
uniform vec4 vRefractionInfos;
#ifndef REFRACTIONMAP_3D
uniform mat4 refractionMatrix;
#endif
#ifdef REFRACTIONFRESNEL
uniform vec4 refractionLeftColor;uniform vec4 refractionRightColor;
#endif
#if defined(USE_LOCAL_REFRACTIONMAP_CUBIC) && defined(REFRACTIONMAP_3D)
uniform vec3 vRefractionPosition;uniform vec3 vRefractionSize; 
#endif
#endif
#if defined(SPECULAR) && defined(SPECULARTERM)
uniform vec2 vSpecularInfos;
#endif
#ifdef DIFFUSEFRESNEL
uniform vec4 diffuseLeftColor;uniform vec4 diffuseRightColor;
#endif
#ifdef OPACITYFRESNEL
uniform vec4 opacityParts;
#endif
#ifdef EMISSIVEFRESNEL
uniform vec4 emissiveLeftColor;uniform vec4 emissiveRightColor;
#endif
#ifdef REFLECTION
uniform vec2 vReflectionInfos;
#if defined(REFLECTIONMAP_PLANAR) || defined(REFLECTIONMAP_CUBIC) || defined(REFLECTIONMAP_PROJECTION) || defined(REFLECTIONMAP_EQUIRECTANGULAR) || defined(REFLECTIONMAP_SPHERICAL) || defined(REFLECTIONMAP_SKYBOX)
uniform mat4 reflectionMatrix;
#endif
#ifndef REFLECTIONMAP_SKYBOX
#if defined(USE_LOCAL_REFLECTIONMAP_CUBIC) && defined(REFLECTIONMAP_CUBIC)
uniform vec3 vReflectionPosition;uniform vec3 vReflectionSize; 
#endif
#endif
#ifdef REFLECTIONFRESNEL
uniform vec4 reflectionLeftColor;uniform vec4 reflectionRightColor;
#endif
#endif
#ifdef DETAIL
uniform vec4 vDetailInfos;
#endif
#include<decalFragmentDeclaration>
#define ADDITIONAL_FRAGMENT_DECLARATION
`;ne.IncludesShadersStore[EF]=yF;const TF="sceneUboDeclaration",bF=`layout(std140,column_major) uniform;uniform Scene {mat4 viewProjection;
#ifdef MULTIVIEW
mat4 viewProjectionR;
#endif 
mat4 view;mat4 projection;vec4 vEyePosition;};
`;ne.IncludesShadersStore[TF]=bF;const CF="meshUboDeclaration",AF=`#ifdef WEBGL2
uniform mat4 world;uniform float visibility;
#else
layout(std140,column_major) uniform;uniform Mesh
{mat4 world;float visibility;};
#endif
#define WORLD_UBO
`;ne.IncludesShadersStore[CF]=AF;const SF="defaultUboDeclaration",RF=`layout(std140,column_major) uniform;uniform Material
{vec4 diffuseLeftColor;vec4 diffuseRightColor;vec4 opacityParts;vec4 reflectionLeftColor;vec4 reflectionRightColor;vec4 refractionLeftColor;vec4 refractionRightColor;vec4 emissiveLeftColor;vec4 emissiveRightColor;vec2 vDiffuseInfos;vec2 vAmbientInfos;vec2 vOpacityInfos;vec2 vReflectionInfos;vec3 vReflectionPosition;vec3 vReflectionSize;vec2 vEmissiveInfos;vec2 vLightmapInfos;vec2 vSpecularInfos;vec3 vBumpInfos;mat4 diffuseMatrix;mat4 ambientMatrix;mat4 opacityMatrix;mat4 reflectionMatrix;mat4 emissiveMatrix;mat4 lightmapMatrix;mat4 specularMatrix;mat4 bumpMatrix;vec2 vTangentSpaceParams;float pointSize;float alphaCutOff;mat4 refractionMatrix;vec4 vRefractionInfos;vec3 vRefractionPosition;vec3 vRefractionSize;vec4 vSpecularColor;vec3 vEmissiveColor;vec4 vDiffuseColor;vec3 vAmbientColor;
#define ADDITIONAL_UBO_DECLARATION
};
#include<sceneUboDeclaration>
#include<meshUboDeclaration>
`;ne.IncludesShadersStore[SF]=RF;const xF="prePassDeclaration",MF=`#ifdef PREPASS
#extension GL_EXT_draw_buffers : require
layout(location=0) out highp vec4 glFragData[{X}];highp vec4 gl_FragColor;
#ifdef PREPASS_DEPTH
varying highp vec3 vViewPos;
#endif
#ifdef PREPASS_VELOCITY
varying highp vec4 vCurrentPosition;varying highp vec4 vPreviousPosition;
#endif
#endif
`;ne.IncludesShadersStore[xF]=MF;const IF="oitDeclaration",PF=`#ifdef ORDER_INDEPENDENT_TRANSPARENCY
#extension GL_EXT_draw_buffers : require
layout(location=0) out vec2 depth; 
layout(location=1) out vec4 frontColor;layout(location=2) out vec4 backColor;
#define MAX_DEPTH 99999.0
highp vec4 gl_FragColor;uniform sampler2D oitDepthSampler;uniform sampler2D oitFrontColorSampler;
#endif
`;ne.IncludesShadersStore[IF]=PF;const wF="mainUVVaryingDeclaration",OF=`#ifdef MAINUV{X}
varying vec2 vMainUV{X};
#endif
`;ne.IncludesShadersStore[wF]=OF;const DF="helperFunctions",LF=`const float PI=3.1415926535897932384626433832795;const float RECIPROCAL_PI=0.3183098861837907;const float RECIPROCAL_PI2=0.15915494309189535;const float HALF_MIN=5.96046448e-08; 
const float LinearEncodePowerApprox=2.2;const float GammaEncodePowerApprox=1.0/LinearEncodePowerApprox;const vec3 LuminanceEncodeApprox=vec3(0.2126,0.7152,0.0722);const float Epsilon=0.0000001;
#define saturate(x) clamp(x,0.0,1.0)
#define absEps(x) abs(x)+Epsilon
#define maxEps(x) max(x,Epsilon)
#define saturateEps(x) clamp(x,Epsilon,1.0)
mat3 transposeMat3(mat3 inMatrix) {vec3 i0=inMatrix[0];vec3 i1=inMatrix[1];vec3 i2=inMatrix[2];mat3 outMatrix=mat3(
vec3(i0.x,i1.x,i2.x),
vec3(i0.y,i1.y,i2.y),
vec3(i0.z,i1.z,i2.z)
);return outMatrix;}
mat3 inverseMat3(mat3 inMatrix) {float a00=inMatrix[0][0],a01=inMatrix[0][1],a02=inMatrix[0][2];float a10=inMatrix[1][0],a11=inMatrix[1][1],a12=inMatrix[1][2];float a20=inMatrix[2][0],a21=inMatrix[2][1],a22=inMatrix[2][2];float b01=a22*a11-a12*a21;float b11=-a22*a10+a12*a20;float b21=a21*a10-a11*a20;float det=a00*b01+a01*b11+a02*b21;return mat3(b01,(-a22*a01+a02*a21),(a12*a01-a02*a11),
b11,(a22*a00-a02*a20),(-a12*a00+a02*a10),
b21,(-a21*a00+a01*a20),(a11*a00-a01*a10))/det;}
#if USE_EXACT_SRGB_CONVERSIONS
vec3 toLinearSpaceExact(vec3 color)
{vec3 nearZeroSection=0.0773993808*color;vec3 remainingSection=pow(0.947867299*(color+vec3(0.055)),vec3(2.4));
#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)
return mix(remainingSection,nearZeroSection,lessThanEqual(color,vec3(0.04045)));
#else
return
vec3(
color.r<=0.04045 ? nearZeroSection.r : remainingSection.r,
color.g<=0.04045 ? nearZeroSection.g : remainingSection.g,
color.b<=0.04045 ? nearZeroSection.b : remainingSection.b);
#endif
}
vec3 toGammaSpaceExact(vec3 color)
{vec3 nearZeroSection=12.92*color;vec3 remainingSection=1.055*pow(color,vec3(0.41666))-vec3(0.055);
#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)
return mix(remainingSection,nearZeroSection,lessThanEqual(color,vec3(0.0031308)));
#else
return
vec3(
color.r<=0.0031308 ? nearZeroSection.r : remainingSection.r,
color.g<=0.0031308 ? nearZeroSection.g : remainingSection.g,
color.b<=0.0031308 ? nearZeroSection.b : remainingSection.b);
#endif
}
#endif
float toLinearSpace(float color)
{
#if USE_EXACT_SRGB_CONVERSIONS
float nearZeroSection=0.0773993808*color;float remainingSection=pow(0.947867299*(color+0.055),2.4);return color<=0.04045 ? nearZeroSection : remainingSection;
#else
return pow(color,LinearEncodePowerApprox);
#endif
}
vec3 toLinearSpace(vec3 color)
{
#if USE_EXACT_SRGB_CONVERSIONS
return toLinearSpaceExact(color);
#else
return pow(color,vec3(LinearEncodePowerApprox));
#endif
}
vec4 toLinearSpace(vec4 color)
{
#if USE_EXACT_SRGB_CONVERSIONS
return vec4(toLinearSpaceExact(color.rgb),color.a);
#else
return vec4(pow(color.rgb,vec3(LinearEncodePowerApprox)),color.a);
#endif
}
float toGammaSpace(float color)
{
#if USE_EXACT_SRGB_CONVERSIONS
float nearZeroSection=12.92*color;float remainingSection=1.055*pow(color,0.41666)-0.055;return color<=0.0031308 ? nearZeroSection : remainingSection;
#else
return pow(color,GammaEncodePowerApprox);
#endif
}
vec3 toGammaSpace(vec3 color)
{
#if USE_EXACT_SRGB_CONVERSIONS
return toGammaSpaceExact(color);
#else
return pow(color,vec3(GammaEncodePowerApprox));
#endif
}
vec4 toGammaSpace(vec4 color)
{
#if USE_EXACT_SRGB_CONVERSIONS
return vec4(toGammaSpaceExact(color.rgb),color.a);
#else
return vec4(pow(color.rgb,vec3(GammaEncodePowerApprox)),color.a);
#endif
}
float square(float value)
{return value*value;}
vec3 square(vec3 value)
{return value*value;}
float pow5(float value) {float sq=value*value;return sq*sq*value;}
float getLuminance(vec3 color)
{return clamp(dot(color,LuminanceEncodeApprox),0.,1.);}
float getRand(vec2 seed) {return fract(sin(dot(seed.xy ,vec2(12.9898,78.233)))*43758.5453);}
float dither(vec2 seed,float varianceAmount) {float rand=getRand(seed);float normVariance=varianceAmount/255.0;float dither=mix(-normVariance,normVariance,rand);return dither;}
const float rgbdMaxRange=255.0;vec4 toRGBD(vec3 color) {float maxRGB=maxEps(max(color.r,max(color.g,color.b)));float D =max(rgbdMaxRange/maxRGB,1.);D =clamp(floor(D)/255.0,0.,1.);vec3 rgb=color.rgb*D;rgb=toGammaSpace(rgb);return vec4(clamp(rgb,0.,1.),D); }
vec3 fromRGBD(vec4 rgbd) {rgbd.rgb=toLinearSpace(rgbd.rgb);return rgbd.rgb/rgbd.a;}
vec3 parallaxCorrectNormal( vec3 vertexPos,vec3 origVec,vec3 cubeSize,vec3 cubePos ) {vec3 invOrigVec=vec3(1.0,1.0,1.0)/origVec;vec3 halfSize=cubeSize*0.5;vec3 intersecAtMaxPlane=(cubePos+halfSize-vertexPos)*invOrigVec;vec3 intersecAtMinPlane=(cubePos-halfSize-vertexPos)*invOrigVec;vec3 largestIntersec=max(intersecAtMaxPlane,intersecAtMinPlane);float distance=min(min(largestIntersec.x,largestIntersec.y),largestIntersec.z);vec3 intersectPositionWS=vertexPos+origVec*distance;return intersectPositionWS-cubePos;}
`;ne.IncludesShadersStore[DF]=LF;const NF="lightFragmentDeclaration",FF=`#ifdef LIGHT{X}
uniform vec4 vLightData{X};uniform vec4 vLightDiffuse{X};
#ifdef SPECULARTERM
uniform vec4 vLightSpecular{X};
#else
vec4 vLightSpecular{X}=vec4(0.);
#endif
#ifdef SHADOW{X}
#ifdef SHADOWCSM{X}
uniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];uniform float viewFrustumZ{X}[SHADOWCSMNUM_CASCADES{X}];uniform float frustumLengths{X}[SHADOWCSMNUM_CASCADES{X}];uniform float cascadeBlendFactor{X};varying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];varying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];varying vec4 vPositionFromCamera{X};
#if defined(SHADOWPCSS{X})
uniform highp sampler2DArrayShadow shadowSampler{X};uniform highp sampler2DArray depthSampler{X};uniform vec2 lightSizeUVCorrection{X}[SHADOWCSMNUM_CASCADES{X}];uniform float depthCorrection{X}[SHADOWCSMNUM_CASCADES{X}];uniform float penumbraDarkness{X};
#elif defined(SHADOWPCF{X})
uniform highp sampler2DArrayShadow shadowSampler{X};
#else
uniform highp sampler2DArray shadowSampler{X};
#endif
#ifdef SHADOWCSMDEBUG{X}
const vec3 vCascadeColorsMultiplier{X}[8]=vec3[8]
(
vec3 ( 1.5,0.0,0.0 ),
vec3 ( 0.0,1.5,0.0 ),
vec3 ( 0.0,0.0,5.5 ),
vec3 ( 1.5,0.0,5.5 ),
vec3 ( 1.5,1.5,0.0 ),
vec3 ( 1.0,1.0,1.0 ),
vec3 ( 0.0,1.0,5.5 ),
vec3 ( 0.5,3.5,0.75 )
);vec3 shadowDebug{X};
#endif
#ifdef SHADOWCSMUSESHADOWMAXZ{X}
int index{X}=-1;
#else
int index{X}=SHADOWCSMNUM_CASCADES{X}-1;
#endif
float diff{X}=0.;
#elif defined(SHADOWCUBE{X})
uniform samplerCube shadowSampler{X};
#else
varying vec4 vPositionFromLight{X};varying float vDepthMetric{X};
#if defined(SHADOWPCSS{X})
uniform highp sampler2DShadow shadowSampler{X};uniform highp sampler2D depthSampler{X};
#elif defined(SHADOWPCF{X})
uniform highp sampler2DShadow shadowSampler{X};
#else
uniform sampler2D shadowSampler{X};
#endif
uniform mat4 lightMatrix{X};
#endif
uniform vec4 shadowsInfo{X};uniform vec2 depthValues{X};
#endif
#ifdef SPOTLIGHT{X}
uniform vec4 vLightDirection{X};uniform vec4 vLightFalloff{X};
#elif defined(POINTLIGHT{X})
uniform vec4 vLightFalloff{X};
#elif defined(HEMILIGHT{X})
uniform vec3 vLightGround{X};
#endif
#ifdef PROJECTEDLIGHTTEXTURE{X}
uniform mat4 textureProjectionMatrix{X};uniform sampler2D projectionLightSampler{X};
#endif
#endif
`;ne.IncludesShadersStore[NF]=FF;const kF="lightUboDeclaration",BF=`#ifdef LIGHT{X}
uniform Light{X}
{vec4 vLightData;vec4 vLightDiffuse;vec4 vLightSpecular;
#ifdef SPOTLIGHT{X}
vec4 vLightDirection;vec4 vLightFalloff;
#elif defined(POINTLIGHT{X})
vec4 vLightFalloff;
#elif defined(HEMILIGHT{X})
vec3 vLightGround;
#endif
vec4 shadowsInfo;vec2 depthValues;} light{X};
#ifdef PROJECTEDLIGHTTEXTURE{X}
uniform mat4 textureProjectionMatrix{X};uniform sampler2D projectionLightSampler{X};
#endif
#ifdef SHADOW{X}
#ifdef SHADOWCSM{X}
uniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];uniform float viewFrustumZ{X}[SHADOWCSMNUM_CASCADES{X}];uniform float frustumLengths{X}[SHADOWCSMNUM_CASCADES{X}];uniform float cascadeBlendFactor{X};varying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];varying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];varying vec4 vPositionFromCamera{X};
#if defined(SHADOWPCSS{X})
uniform highp sampler2DArrayShadow shadowSampler{X};uniform highp sampler2DArray depthSampler{X};uniform vec2 lightSizeUVCorrection{X}[SHADOWCSMNUM_CASCADES{X}];uniform float depthCorrection{X}[SHADOWCSMNUM_CASCADES{X}];uniform float penumbraDarkness{X};
#elif defined(SHADOWPCF{X})
uniform highp sampler2DArrayShadow shadowSampler{X};
#else
uniform highp sampler2DArray shadowSampler{X};
#endif
#ifdef SHADOWCSMDEBUG{X}
const vec3 vCascadeColorsMultiplier{X}[8]=vec3[8]
(
vec3 ( 1.5,0.0,0.0 ),
vec3 ( 0.0,1.5,0.0 ),
vec3 ( 0.0,0.0,5.5 ),
vec3 ( 1.5,0.0,5.5 ),
vec3 ( 1.5,1.5,0.0 ),
vec3 ( 1.0,1.0,1.0 ),
vec3 ( 0.0,1.0,5.5 ),
vec3 ( 0.5,3.5,0.75 )
);vec3 shadowDebug{X};
#endif
#ifdef SHADOWCSMUSESHADOWMAXZ{X}
int index{X}=-1;
#else
int index{X}=SHADOWCSMNUM_CASCADES{X}-1;
#endif
float diff{X}=0.;
#elif defined(SHADOWCUBE{X})
uniform samplerCube shadowSampler{X}; 
#else
varying vec4 vPositionFromLight{X};varying float vDepthMetric{X};
#if defined(SHADOWPCSS{X})
uniform highp sampler2DShadow shadowSampler{X};uniform highp sampler2D depthSampler{X};
#elif defined(SHADOWPCF{X})
uniform highp sampler2DShadow shadowSampler{X};
#else
uniform sampler2D shadowSampler{X};
#endif
uniform mat4 lightMatrix{X};
#endif
#endif
#endif
`;ne.IncludesShadersStore[kF]=BF;const UF="lightsFragmentFunctions",zF=`struct lightingInfo
{vec3 diffuse;
#ifdef SPECULARTERM
vec3 specular;
#endif
#ifdef NDOTL
float ndl;
#endif
};lightingInfo computeLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,float range,float glossiness) {lightingInfo result;vec3 lightVectorW;float attenuation=1.0;if (lightData.w==0.)
{vec3 direction=lightData.xyz-vPositionW;attenuation=max(0.,1.0-length(direction)/range);lightVectorW=normalize(direction);}
else
{lightVectorW=normalize(-lightData.xyz);}
float ndl=max(0.,dot(vNormal,lightVectorW));
#ifdef NDOTL
result.ndl=ndl;
#endif
result.diffuse=ndl*diffuseColor*attenuation;
#ifdef SPECULARTERM
vec3 angleW=normalize(viewDirectionW+lightVectorW);float specComp=max(0.,dot(vNormal,angleW));specComp=pow(specComp,max(1.,glossiness));result.specular=specComp*specularColor*attenuation;
#endif
return result;}
lightingInfo computeSpotLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec4 lightDirection,vec3 diffuseColor,vec3 specularColor,float range,float glossiness) {lightingInfo result;vec3 direction=lightData.xyz-vPositionW;vec3 lightVectorW=normalize(direction);float attenuation=max(0.,1.0-length(direction)/range);float cosAngle=max(0.,dot(lightDirection.xyz,-lightVectorW));if (cosAngle>=lightDirection.w)
{cosAngle=max(0.,pow(cosAngle,lightData.w));attenuation*=cosAngle;float ndl=max(0.,dot(vNormal,lightVectorW));
#ifdef NDOTL
result.ndl=ndl;
#endif
result.diffuse=ndl*diffuseColor*attenuation;
#ifdef SPECULARTERM
vec3 angleW=normalize(viewDirectionW+lightVectorW);float specComp=max(0.,dot(vNormal,angleW));specComp=pow(specComp,max(1.,glossiness));result.specular=specComp*specularColor*attenuation;
#endif
return result;}
result.diffuse=vec3(0.);
#ifdef SPECULARTERM
result.specular=vec3(0.);
#endif
#ifdef NDOTL
result.ndl=0.;
#endif
return result;}
lightingInfo computeHemisphericLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,vec3 groundColor,float glossiness) {lightingInfo result;float ndl=dot(vNormal,lightData.xyz)*0.5+0.5;
#ifdef NDOTL
result.ndl=ndl;
#endif
result.diffuse=mix(groundColor,diffuseColor,ndl);
#ifdef SPECULARTERM
vec3 angleW=normalize(viewDirectionW+lightData.xyz);float specComp=max(0.,dot(vNormal,angleW));specComp=pow(specComp,max(1.,glossiness));result.specular=specComp*specularColor;
#endif
return result;}
#define inline
vec3 computeProjectionTextureDiffuseLighting(sampler2D projectionLightSampler,mat4 textureProjectionMatrix){vec4 strq=textureProjectionMatrix*vec4(vPositionW,1.0);strq/=strq.w;vec3 textureColor=texture2D(projectionLightSampler,strq.xy).rgb;return textureColor;}`;ne.IncludesShadersStore[UF]=zF;const VF="shadowsFragmentFunctions",GF=`#ifdef SHADOWS
#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)
#define TEXTUREFUNC(s,c,l) texture2DLodEXT(s,c,l)
#else
#define TEXTUREFUNC(s,c,b) texture2D(s,c,b)
#endif
#ifndef SHADOWFLOAT
float unpack(vec4 color)
{const vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(color,bit_shift);}
#endif
float computeFallOff(float value,vec2 clipSpace,float frustumEdgeFalloff)
{float mask=smoothstep(1.0-frustumEdgeFalloff,1.00000012,clamp(dot(clipSpace,clipSpace),0.,1.));return mix(value,1.0,mask);}
#define inline
float computeShadowCube(vec3 worldPos,vec3 lightPosition,samplerCube shadowSampler,float darkness,vec2 depthValues)
{vec3 directionToLight=worldPos-lightPosition;float depth=length(directionToLight);depth=(depth+depthValues.x)/(depthValues.y);depth=clamp(depth,0.,1.0);directionToLight=normalize(directionToLight);directionToLight.y=-directionToLight.y;
#ifndef SHADOWFLOAT
float shadow=unpack(textureCube(shadowSampler,directionToLight));
#else
float shadow=textureCube(shadowSampler,directionToLight).x;
#endif
return depth>shadow ? darkness : 1.0;}
#define inline
float computeShadowWithPoissonSamplingCube(vec3 worldPos,vec3 lightPosition,samplerCube shadowSampler,float mapSize,float darkness,vec2 depthValues)
{vec3 directionToLight=worldPos-lightPosition;float depth=length(directionToLight);depth=(depth+depthValues.x)/(depthValues.y);depth=clamp(depth,0.,1.0);directionToLight=normalize(directionToLight);directionToLight.y=-directionToLight.y;float visibility=1.;vec3 poissonDisk[4];poissonDisk[0]=vec3(-1.0,1.0,-1.0);poissonDisk[1]=vec3(1.0,-1.0,-1.0);poissonDisk[2]=vec3(-1.0,-1.0,-1.0);poissonDisk[3]=vec3(1.0,-1.0,1.0);
#ifndef SHADOWFLOAT
if (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[0]*mapSize))<depth) visibility-=0.25;if (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[1]*mapSize))<depth) visibility-=0.25;if (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[2]*mapSize))<depth) visibility-=0.25;if (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[3]*mapSize))<depth) visibility-=0.25;
#else
if (textureCube(shadowSampler,directionToLight+poissonDisk[0]*mapSize).x<depth) visibility-=0.25;if (textureCube(shadowSampler,directionToLight+poissonDisk[1]*mapSize).x<depth) visibility-=0.25;if (textureCube(shadowSampler,directionToLight+poissonDisk[2]*mapSize).x<depth) visibility-=0.25;if (textureCube(shadowSampler,directionToLight+poissonDisk[3]*mapSize).x<depth) visibility-=0.25;
#endif
return min(1.0,visibility+darkness);}
#define inline
float computeShadowWithESMCube(vec3 worldPos,vec3 lightPosition,samplerCube shadowSampler,float darkness,float depthScale,vec2 depthValues)
{vec3 directionToLight=worldPos-lightPosition;float depth=length(directionToLight);depth=(depth+depthValues.x)/(depthValues.y);float shadowPixelDepth=clamp(depth,0.,1.0);directionToLight=normalize(directionToLight);directionToLight.y=-directionToLight.y;
#ifndef SHADOWFLOAT
float shadowMapSample=unpack(textureCube(shadowSampler,directionToLight));
#else
float shadowMapSample=textureCube(shadowSampler,directionToLight).x;
#endif
float esm=1.0-clamp(exp(min(87.,depthScale*shadowPixelDepth))*shadowMapSample,0.,1.-darkness);return esm;}
#define inline
float computeShadowWithCloseESMCube(vec3 worldPos,vec3 lightPosition,samplerCube shadowSampler,float darkness,float depthScale,vec2 depthValues)
{vec3 directionToLight=worldPos-lightPosition;float depth=length(directionToLight);depth=(depth+depthValues.x)/(depthValues.y);float shadowPixelDepth=clamp(depth,0.,1.0);directionToLight=normalize(directionToLight);directionToLight.y=-directionToLight.y;
#ifndef SHADOWFLOAT
float shadowMapSample=unpack(textureCube(shadowSampler,directionToLight));
#else
float shadowMapSample=textureCube(shadowSampler,directionToLight).x;
#endif
float esm=clamp(exp(min(87.,-depthScale*(shadowPixelDepth-shadowMapSample))),darkness,1.);return esm;}
#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)
#define inline
float computeShadowCSM(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray shadowSampler,float darkness,float frustumEdgeFalloff)
{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec2 uv=0.5*clipSpace.xy+vec2(0.5);vec3 uvLayer=vec3(uv.x,uv.y,layer);float shadowPixelDepth=clamp(depthMetric,0.,1.0);
#ifndef SHADOWFLOAT
float shadow=unpack(texture2D(shadowSampler,uvLayer));
#else
float shadow=texture2D(shadowSampler,uvLayer).x;
#endif
return shadowPixelDepth>shadow ? computeFallOff(darkness,clipSpace.xy,frustumEdgeFalloff) : 1.;}
#endif
#define inline
float computeShadow(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float frustumEdgeFalloff)
{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec2 uv=0.5*clipSpace.xy+vec2(0.5);if (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)
{return 1.0;}
else
{float shadowPixelDepth=clamp(depthMetric,0.,1.0);
#ifndef SHADOWFLOAT
float shadow=unpack(TEXTUREFUNC(shadowSampler,uv,0.));
#else
float shadow=TEXTUREFUNC(shadowSampler,uv,0.).x;
#endif
return shadowPixelDepth>shadow ? computeFallOff(darkness,clipSpace.xy,frustumEdgeFalloff) : 1.;}}
#define inline
float computeShadowWithPoissonSampling(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float mapSize,float darkness,float frustumEdgeFalloff)
{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec2 uv=0.5*clipSpace.xy+vec2(0.5);if (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)
{return 1.0;}
else
{float shadowPixelDepth=clamp(depthMetric,0.,1.0);float visibility=1.;vec2 poissonDisk[4];poissonDisk[0]=vec2(-0.94201624,-0.39906216);poissonDisk[1]=vec2(0.94558609,-0.76890725);poissonDisk[2]=vec2(-0.094184101,-0.92938870);poissonDisk[3]=vec2(0.34495938,0.29387760);
#ifndef SHADOWFLOAT
if (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[0]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;if (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[1]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;if (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[2]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;if (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[3]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;
#else
if (TEXTUREFUNC(shadowSampler,uv+poissonDisk[0]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;if (TEXTUREFUNC(shadowSampler,uv+poissonDisk[1]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;if (TEXTUREFUNC(shadowSampler,uv+poissonDisk[2]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;if (TEXTUREFUNC(shadowSampler,uv+poissonDisk[3]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;
#endif
return computeFallOff(min(1.0,visibility+darkness),clipSpace.xy,frustumEdgeFalloff);}}
#define inline
float computeShadowWithESM(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float depthScale,float frustumEdgeFalloff)
{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec2 uv=0.5*clipSpace.xy+vec2(0.5);if (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)
{return 1.0;}
else
{float shadowPixelDepth=clamp(depthMetric,0.,1.0);
#ifndef SHADOWFLOAT
float shadowMapSample=unpack(TEXTUREFUNC(shadowSampler,uv,0.));
#else
float shadowMapSample=TEXTUREFUNC(shadowSampler,uv,0.).x;
#endif
float esm=1.0-clamp(exp(min(87.,depthScale*shadowPixelDepth))*shadowMapSample,0.,1.-darkness);return computeFallOff(esm,clipSpace.xy,frustumEdgeFalloff);}}
#define inline
float computeShadowWithCloseESM(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float depthScale,float frustumEdgeFalloff)
{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec2 uv=0.5*clipSpace.xy+vec2(0.5);if (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)
{return 1.0;}
else
{float shadowPixelDepth=clamp(depthMetric,0.,1.0); 
#ifndef SHADOWFLOAT
float shadowMapSample=unpack(TEXTUREFUNC(shadowSampler,uv,0.));
#else
float shadowMapSample=TEXTUREFUNC(shadowSampler,uv,0.).x;
#endif
float esm=clamp(exp(min(87.,-depthScale*(shadowPixelDepth-shadowMapSample))),darkness,1.);return computeFallOff(esm,clipSpace.xy,frustumEdgeFalloff);}}
#ifdef IS_NDC_HALF_ZRANGE
#define ZINCLIP clipSpace.z
#else
#define ZINCLIP uvDepth.z
#endif
#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)
#define GREATEST_LESS_THAN_ONE 0.99999994
/* disable_uniformity_analysis */
#define inline
float computeShadowWithCSMPCF1(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,float darkness,float frustumEdgeFalloff)
{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);vec4 uvDepthLayer=vec4(uvDepth.x,uvDepth.y,layer,uvDepth.z);float shadow=texture2D(shadowSampler,uvDepthLayer);shadow=mix(darkness,1.,shadow);return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}
#define inline
float computeShadowWithCSMPCF3(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)
{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);vec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; 
uv+=0.5; 
vec2 st=fract(uv); 
vec2 base_uv=floor(uv)-0.5; 
base_uv*=shadowMapSizeAndInverse.y; 
vec2 uvw0=3.-2.*st;vec2 uvw1=1.+2.*st;vec2 u=vec2((2.-st.x)/uvw0.x-1.,st.x/uvw1.x+1.)*shadowMapSizeAndInverse.y;vec2 v=vec2((2.-st.y)/uvw0.y-1.,st.y/uvw1.y+1.)*shadowMapSizeAndInverse.y;float shadow=0.;shadow+=uvw0.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[0]),layer,uvDepth.z));shadow+=uvw1.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[0]),layer,uvDepth.z));shadow+=uvw0.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[1]),layer,uvDepth.z));shadow+=uvw1.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[1]),layer,uvDepth.z));shadow=shadow/16.;shadow=mix(darkness,1.,shadow);return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}
#define inline
float computeShadowWithCSMPCF5(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)
{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);vec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; 
uv+=0.5; 
vec2 st=fract(uv); 
vec2 base_uv=floor(uv)-0.5; 
base_uv*=shadowMapSizeAndInverse.y; 
vec2 uvw0=4.-3.*st;vec2 uvw1=vec2(7.);vec2 uvw2=1.+3.*st;vec3 u=vec3((3.-2.*st.x)/uvw0.x-2.,(3.+st.x)/uvw1.x,st.x/uvw2.x+2.)*shadowMapSizeAndInverse.y;vec3 v=vec3((3.-2.*st.y)/uvw0.y-2.,(3.+st.y)/uvw1.y,st.y/uvw2.y+2.)*shadowMapSizeAndInverse.y;float shadow=0.;shadow+=uvw0.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[0]),layer,uvDepth.z));shadow+=uvw1.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[0]),layer,uvDepth.z));shadow+=uvw2.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[0]),layer,uvDepth.z));shadow+=uvw0.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[1]),layer,uvDepth.z));shadow+=uvw1.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[1]),layer,uvDepth.z));shadow+=uvw2.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[1]),layer,uvDepth.z));shadow+=uvw0.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[2]),layer,uvDepth.z));shadow+=uvw1.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[2]),layer,uvDepth.z));shadow+=uvw2.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[2]),layer,uvDepth.z));shadow=shadow/144.;shadow=mix(darkness,1.,shadow);return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}
#define inline
float computeShadowWithPCF1(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,float darkness,float frustumEdgeFalloff)
{if (depthMetric>1.0 || depthMetric<0.0) {return 1.0;}
else
{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=ZINCLIP;float shadow=TEXTUREFUNC(shadowSampler,uvDepth,0.);shadow=mix(darkness,1.,shadow);return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}}
#define inline
float computeShadowWithPCF3(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)
{if (depthMetric>1.0 || depthMetric<0.0) {return 1.0;}
else
{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=ZINCLIP;vec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; 
uv+=0.5; 
vec2 st=fract(uv); 
vec2 base_uv=floor(uv)-0.5; 
base_uv*=shadowMapSizeAndInverse.y; 
vec2 uvw0=3.-2.*st;vec2 uvw1=1.+2.*st;vec2 u=vec2((2.-st.x)/uvw0.x-1.,st.x/uvw1.x+1.)*shadowMapSizeAndInverse.y;vec2 v=vec2((2.-st.y)/uvw0.y-1.,st.y/uvw1.y+1.)*shadowMapSizeAndInverse.y;float shadow=0.;shadow+=uvw0.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[0]),uvDepth.z),0.);shadow+=uvw1.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[0]),uvDepth.z),0.);shadow+=uvw0.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[1]),uvDepth.z),0.);shadow+=uvw1.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[1]),uvDepth.z),0.);shadow=shadow/16.;shadow=mix(darkness,1.,shadow);return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}}
#define inline
float computeShadowWithPCF5(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)
{if (depthMetric>1.0 || depthMetric<0.0) {return 1.0;}
else
{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=ZINCLIP;vec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; 
uv+=0.5; 
vec2 st=fract(uv); 
vec2 base_uv=floor(uv)-0.5; 
base_uv*=shadowMapSizeAndInverse.y; 
vec2 uvw0=4.-3.*st;vec2 uvw1=vec2(7.);vec2 uvw2=1.+3.*st;vec3 u=vec3((3.-2.*st.x)/uvw0.x-2.,(3.+st.x)/uvw1.x,st.x/uvw2.x+2.)*shadowMapSizeAndInverse.y;vec3 v=vec3((3.-2.*st.y)/uvw0.y-2.,(3.+st.y)/uvw1.y,st.y/uvw2.y+2.)*shadowMapSizeAndInverse.y;float shadow=0.;shadow+=uvw0.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[0]),uvDepth.z),0.);shadow+=uvw1.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[0]),uvDepth.z),0.);shadow+=uvw2.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[0]),uvDepth.z),0.);shadow+=uvw0.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[1]),uvDepth.z),0.);shadow+=uvw1.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[1]),uvDepth.z),0.);shadow+=uvw2.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[1]),uvDepth.z),0.);shadow+=uvw0.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[2]),uvDepth.z),0.);shadow+=uvw1.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[2]),uvDepth.z),0.);shadow+=uvw2.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[2]),uvDepth.z),0.);shadow=shadow/144.;shadow=mix(darkness,1.,shadow);return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}}
const vec3 PoissonSamplers32[64]=vec3[64](
vec3(0.06407013,0.05409927,0.),
vec3(0.7366577,0.5789394,0.),
vec3(-0.6270542,-0.5320278,0.),
vec3(-0.4096107,0.8411095,0.),
vec3(0.6849564,-0.4990818,0.),
vec3(-0.874181,-0.04579735,0.),
vec3(0.9989998,0.0009880066,0.),
vec3(-0.004920578,-0.9151649,0.),
vec3(0.1805763,0.9747483,0.),
vec3(-0.2138451,0.2635818,0.),
vec3(0.109845,0.3884785,0.),
vec3(0.06876755,-0.3581074,0.),
vec3(0.374073,-0.7661266,0.),
vec3(0.3079132,-0.1216763,0.),
vec3(-0.3794335,-0.8271583,0.),
vec3(-0.203878,-0.07715034,0.),
vec3(0.5912697,0.1469799,0.),
vec3(-0.88069,0.3031784,0.),
vec3(0.5040108,0.8283722,0.),
vec3(-0.5844124,0.5494877,0.),
vec3(0.6017799,-0.1726654,0.),
vec3(-0.5554981,0.1559997,0.),
vec3(-0.3016369,-0.3900928,0.),
vec3(-0.5550632,-0.1723762,0.),
vec3(0.925029,0.2995041,0.),
vec3(-0.2473137,0.5538505,0.),
vec3(0.9183037,-0.2862392,0.),
vec3(0.2469421,0.6718712,0.),
vec3(0.3916397,-0.4328209,0.),
vec3(-0.03576927,-0.6220032,0.),
vec3(-0.04661255,0.7995201,0.),
vec3(0.4402924,0.3640312,0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.),
vec3(0.)
);const vec3 PoissonSamplers64[64]=vec3[64](
vec3(-0.613392,0.617481,0.),
vec3(0.170019,-0.040254,0.),
vec3(-0.299417,0.791925,0.),
vec3(0.645680,0.493210,0.),
vec3(-0.651784,0.717887,0.),
vec3(0.421003,0.027070,0.),
vec3(-0.817194,-0.271096,0.),
vec3(-0.705374,-0.668203,0.),
vec3(0.977050,-0.108615,0.),
vec3(0.063326,0.142369,0.),
vec3(0.203528,0.214331,0.),
vec3(-0.667531,0.326090,0.),
vec3(-0.098422,-0.295755,0.),
vec3(-0.885922,0.215369,0.),
vec3(0.566637,0.605213,0.),
vec3(0.039766,-0.396100,0.),
vec3(0.751946,0.453352,0.),
vec3(0.078707,-0.715323,0.),
vec3(-0.075838,-0.529344,0.),
vec3(0.724479,-0.580798,0.),
vec3(0.222999,-0.215125,0.),
vec3(-0.467574,-0.405438,0.),
vec3(-0.248268,-0.814753,0.),
vec3(0.354411,-0.887570,0.),
vec3(0.175817,0.382366,0.),
vec3(0.487472,-0.063082,0.),
vec3(-0.084078,0.898312,0.),
vec3(0.488876,-0.783441,0.),
vec3(0.470016,0.217933,0.),
vec3(-0.696890,-0.549791,0.),
vec3(-0.149693,0.605762,0.),
vec3(0.034211,0.979980,0.),
vec3(0.503098,-0.308878,0.),
vec3(-0.016205,-0.872921,0.),
vec3(0.385784,-0.393902,0.),
vec3(-0.146886,-0.859249,0.),
vec3(0.643361,0.164098,0.),
vec3(0.634388,-0.049471,0.),
vec3(-0.688894,0.007843,0.),
vec3(0.464034,-0.188818,0.),
vec3(-0.440840,0.137486,0.),
vec3(0.364483,0.511704,0.),
vec3(0.034028,0.325968,0.),
vec3(0.099094,-0.308023,0.),
vec3(0.693960,-0.366253,0.),
vec3(0.678884,-0.204688,0.),
vec3(0.001801,0.780328,0.),
vec3(0.145177,-0.898984,0.),
vec3(0.062655,-0.611866,0.),
vec3(0.315226,-0.604297,0.),
vec3(-0.780145,0.486251,0.),
vec3(-0.371868,0.882138,0.),
vec3(0.200476,0.494430,0.),
vec3(-0.494552,-0.711051,0.),
vec3(0.612476,0.705252,0.),
vec3(-0.578845,-0.768792,0.),
vec3(-0.772454,-0.090976,0.),
vec3(0.504440,0.372295,0.),
vec3(0.155736,0.065157,0.),
vec3(0.391522,0.849605,0.),
vec3(-0.620106,-0.328104,0.),
vec3(0.789239,-0.419965,0.),
vec3(-0.545396,0.538133,0.),
vec3(-0.178564,-0.596057,0.)
);
#define inline
float computeShadowWithCSMPCSS(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,int searchTapCount,int pcfTapCount,vec3[64] poissonSamplers,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)
{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);vec4 uvDepthLayer=vec4(uvDepth.x,uvDepth.y,layer,uvDepth.z);float blockerDepth=0.0;float sumBlockerDepth=0.0;float numBlocker=0.0;for (int i=0; i<searchTapCount; i ++) {blockerDepth=texture2D(depthSampler,vec3(uvDepth.xy+(lightSizeUV*lightSizeUVCorrection*shadowMapSizeInverse*PoissonSamplers32[i].xy),layer)).r;if (blockerDepth<depthMetric) {sumBlockerDepth+=blockerDepth;numBlocker++;}}
float avgBlockerDepth=sumBlockerDepth/numBlocker;float AAOffset=shadowMapSizeInverse*10.;float penumbraRatio=((depthMetric-avgBlockerDepth)*depthCorrection+AAOffset);vec4 filterRadius=vec4(penumbraRatio*lightSizeUV*lightSizeUVCorrection*shadowMapSizeInverse,0.,0.);float random=getRand(vPositionFromLight.xy);float rotationAngle=random*3.1415926;vec2 rotationVector=vec2(cos(rotationAngle),sin(rotationAngle));float shadow=0.;for (int i=0; i<pcfTapCount; i++) {vec4 offset=vec4(poissonSamplers[i],0.);offset=vec4(offset.x*rotationVector.x-offset.y*rotationVector.y,offset.y*rotationVector.x+offset.x*rotationVector.y,0.,0.);shadow+=texture2D(shadowSampler,uvDepthLayer+offset*filterRadius);}
shadow/=float(pcfTapCount);shadow=mix(shadow,1.,min((depthMetric-avgBlockerDepth)*depthCorrection*penumbraDarkness,1.));shadow=mix(darkness,1.,shadow);if (numBlocker<1.0) {return 1.0;}
else
{return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}}
#define inline
float computeShadowWithPCSS(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,int searchTapCount,int pcfTapCount,vec3[64] poissonSamplers)
{if (depthMetric>1.0 || depthMetric<0.0) {return 1.0;}
else
{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=ZINCLIP;float blockerDepth=0.0;float sumBlockerDepth=0.0;float numBlocker=0.0;for (int i=0; i<searchTapCount; i ++) {blockerDepth=TEXTUREFUNC(depthSampler,uvDepth.xy+(lightSizeUV*shadowMapSizeInverse*PoissonSamplers32[i].xy),0.).r;if (blockerDepth<depthMetric) {sumBlockerDepth+=blockerDepth;numBlocker++;}}
if (numBlocker<1.0) {return 1.0;}
else
{float avgBlockerDepth=sumBlockerDepth/numBlocker;float AAOffset=shadowMapSizeInverse*10.;float penumbraRatio=((depthMetric-avgBlockerDepth)+AAOffset);float filterRadius=penumbraRatio*lightSizeUV*shadowMapSizeInverse;float random=getRand(vPositionFromLight.xy);float rotationAngle=random*3.1415926;vec2 rotationVector=vec2(cos(rotationAngle),sin(rotationAngle));float shadow=0.;for (int i=0; i<pcfTapCount; i++) {vec3 offset=poissonSamplers[i];offset=vec3(offset.x*rotationVector.x-offset.y*rotationVector.y,offset.y*rotationVector.x+offset.x*rotationVector.y,0.);shadow+=TEXTUREFUNC(shadowSampler,uvDepth+offset*filterRadius,0.);}
shadow/=float(pcfTapCount);shadow=mix(shadow,1.,depthMetric-avgBlockerDepth);shadow=mix(darkness,1.,shadow);return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}}}
#define inline
float computeShadowWithPCSS16(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)
{return computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,16,PoissonSamplers32);}
#define inline
float computeShadowWithPCSS32(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)
{return computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,32,PoissonSamplers32);}
#define inline
float computeShadowWithPCSS64(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)
{return computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,32,64,PoissonSamplers64);}
#define inline
float computeShadowWithCSMPCSS16(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)
{return computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,16,PoissonSamplers32,lightSizeUVCorrection,depthCorrection,penumbraDarkness);}
#define inline
float computeShadowWithCSMPCSS32(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)
{return computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,32,PoissonSamplers32,lightSizeUVCorrection,depthCorrection,penumbraDarkness);}
#define inline
float computeShadowWithCSMPCSS64(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)
{return computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,32,64,PoissonSamplers64,lightSizeUVCorrection,depthCorrection,penumbraDarkness);}
#endif
#endif
`;ne.IncludesShadersStore[VF]=GF;const WF="samplerFragmentDeclaration",HF=`#ifdef _DEFINENAME_
#if _DEFINENAME_DIRECTUV==1
#define v_VARYINGNAME_UV vMainUV1
#elif _DEFINENAME_DIRECTUV==2
#define v_VARYINGNAME_UV vMainUV2
#elif _DEFINENAME_DIRECTUV==3
#define v_VARYINGNAME_UV vMainUV3
#elif _DEFINENAME_DIRECTUV==4
#define v_VARYINGNAME_UV vMainUV4
#elif _DEFINENAME_DIRECTUV==5
#define v_VARYINGNAME_UV vMainUV5
#elif _DEFINENAME_DIRECTUV==6
#define v_VARYINGNAME_UV vMainUV6
#else
varying vec2 v_VARYINGNAME_UV;
#endif
uniform sampler2D _SAMPLERNAME_Sampler;
#endif
`;ne.IncludesShadersStore[WF]=HF;const jF="fresnelFunction",XF=`#ifdef FRESNEL
float computeFresnelTerm(vec3 viewDirection,vec3 worldNormal,float bias,float power)
{float fresnelTerm=pow(bias+abs(dot(viewDirection,worldNormal)),power);return clamp(fresnelTerm,0.,1.);}
#endif
`;ne.IncludesShadersStore[jF]=XF;const YF="reflectionFunction",KF=`vec3 computeFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)
{float lon=atan(direction.z,direction.x);float lat=acos(direction.y);vec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;float s=sphereCoords.x*0.5+0.5;float t=sphereCoords.y;return vec3(s,t,0); }
vec3 computeMirroredFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)
{float lon=atan(direction.z,direction.x);float lat=acos(direction.y);vec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;float s=sphereCoords.x*0.5+0.5;float t=sphereCoords.y;return vec3(1.0-s,t,0); }
vec3 computeEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)
{vec3 cameraToVertex=normalize(worldPos.xyz-eyePosition);vec3 r=normalize(reflect(cameraToVertex,worldNormal));r=vec3(reflectionMatrix*vec4(r,0));float lon=atan(r.z,r.x);float lat=acos(r.y);vec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;float s=sphereCoords.x*0.5+0.5;float t=sphereCoords.y;return vec3(s,t,0);}
vec3 computeSphericalCoords(vec4 worldPos,vec3 worldNormal,mat4 view,mat4 reflectionMatrix)
{vec3 viewDir=normalize(vec3(view*worldPos));vec3 viewNormal=normalize(vec3(view*vec4(worldNormal,0.0)));vec3 r=reflect(viewDir,viewNormal);r=vec3(reflectionMatrix*vec4(r,0));r.z=r.z-1.0;float m=2.0*length(r);return vec3(r.x/m+0.5,1.0-r.y/m-0.5,0);}
vec3 computePlanarCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)
{vec3 viewDir=worldPos.xyz-eyePosition;vec3 coords=normalize(reflect(viewDir,worldNormal));return vec3(reflectionMatrix*vec4(coords,1));}
vec3 computeCubicCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)
{vec3 viewDir=normalize(worldPos.xyz-eyePosition);vec3 coords=reflect(viewDir,worldNormal);coords=vec3(reflectionMatrix*vec4(coords,0));
#ifdef INVERTCUBICMAP
coords.y*=-1.0;
#endif
return coords;}
vec3 computeCubicLocalCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix,vec3 reflectionSize,vec3 reflectionPosition)
{vec3 viewDir=normalize(worldPos.xyz-eyePosition);vec3 coords=reflect(viewDir,worldNormal);coords=parallaxCorrectNormal(worldPos.xyz,coords,reflectionSize,reflectionPosition);coords=vec3(reflectionMatrix*vec4(coords,0));
#ifdef INVERTCUBICMAP
coords.y*=-1.0;
#endif
return coords;}
vec3 computeProjectionCoords(vec4 worldPos,mat4 view,mat4 reflectionMatrix)
{return vec3(reflectionMatrix*(view*worldPos));}
vec3 computeSkyBoxCoords(vec3 positionW,mat4 reflectionMatrix)
{return vec3(reflectionMatrix*vec4(positionW,1.));}
#ifdef REFLECTION
vec3 computeReflectionCoords(vec4 worldPos,vec3 worldNormal)
{
#ifdef REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED
vec3 direction=normalize(vDirectionW);return computeMirroredFixedEquirectangularCoords(worldPos,worldNormal,direction);
#endif
#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED
vec3 direction=normalize(vDirectionW);return computeFixedEquirectangularCoords(worldPos,worldNormal,direction);
#endif
#ifdef REFLECTIONMAP_EQUIRECTANGULAR
return computeEquirectangularCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);
#endif
#ifdef REFLECTIONMAP_SPHERICAL
return computeSphericalCoords(worldPos,worldNormal,view,reflectionMatrix);
#endif
#ifdef REFLECTIONMAP_PLANAR
return computePlanarCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);
#endif
#ifdef REFLECTIONMAP_CUBIC
#ifdef USE_LOCAL_REFLECTIONMAP_CUBIC
return computeCubicLocalCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix,vReflectionSize,vReflectionPosition);
#else
return computeCubicCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);
#endif
#endif
#ifdef REFLECTIONMAP_PROJECTION
return computeProjectionCoords(worldPos,view,reflectionMatrix);
#endif
#ifdef REFLECTIONMAP_SKYBOX
return computeSkyBoxCoords(vPositionUVW,reflectionMatrix);
#endif
#ifdef REFLECTIONMAP_EXPLICIT
return vec3(0,0,0);
#endif
}
#endif
`;ne.IncludesShadersStore[YF]=KF;const qF="imageProcessingDeclaration",$F=`#ifdef EXPOSURE
uniform float exposureLinear;
#endif
#ifdef CONTRAST
uniform float contrast;
#endif
#if defined(VIGNETTE) || defined(DITHER)
uniform vec2 vInverseScreenSize;
#endif
#ifdef VIGNETTE
uniform vec4 vignetteSettings1;uniform vec4 vignetteSettings2;
#endif
#ifdef COLORCURVES
uniform vec4 vCameraColorCurveNegative;uniform vec4 vCameraColorCurveNeutral;uniform vec4 vCameraColorCurvePositive;
#endif
#ifdef COLORGRADING
#ifdef COLORGRADING3D
uniform highp sampler3D txColorTransform;
#else
uniform sampler2D txColorTransform;
#endif
uniform vec4 colorTransformSettings;
#endif
#ifdef DITHER
uniform float ditherIntensity;
#endif
`;ne.IncludesShadersStore[qF]=$F;const QF="imageProcessingFunctions",ZF=`#if defined(COLORGRADING) && !defined(COLORGRADING3D)
/** 
* Polyfill for SAMPLE_TEXTURE_3D,which is unsupported in WebGL.
* sampler3dSetting.x=textureOffset (0.5/textureSize).
* sampler3dSetting.y=textureSize.
*/
#define inline
vec3 sampleTexture3D(sampler2D colorTransform,vec3 color,vec2 sampler3dSetting)
{float sliceSize=2.0*sampler3dSetting.x; 
#ifdef SAMPLER3DGREENDEPTH
float sliceContinuous=(color.g-sampler3dSetting.x)*sampler3dSetting.y;
#else
float sliceContinuous=(color.b-sampler3dSetting.x)*sampler3dSetting.y;
#endif
float sliceInteger=floor(sliceContinuous);float sliceFraction=sliceContinuous-sliceInteger;
#ifdef SAMPLER3DGREENDEPTH
vec2 sliceUV=color.rb;
#else
vec2 sliceUV=color.rg;
#endif
sliceUV.x*=sliceSize;sliceUV.x+=sliceInteger*sliceSize;sliceUV=saturate(sliceUV);vec4 slice0Color=texture2D(colorTransform,sliceUV);sliceUV.x+=sliceSize;sliceUV=saturate(sliceUV);vec4 slice1Color=texture2D(colorTransform,sliceUV);vec3 result=mix(slice0Color.rgb,slice1Color.rgb,sliceFraction);
#ifdef SAMPLER3DBGRMAP
color.rgb=result.rgb;
#else
color.rgb=result.bgr;
#endif
return color;}
#endif
#ifdef TONEMAPPING_ACES
const mat3 ACESInputMat=mat3(
vec3(0.59719,0.07600,0.02840),
vec3(0.35458,0.90834,0.13383),
vec3(0.04823,0.01566,0.83777)
);const mat3 ACESOutputMat=mat3(
vec3( 1.60475,-0.10208,-0.00327),
vec3(-0.53108, 1.10813,-0.07276),
vec3(-0.07367,-0.00605, 1.07602)
);vec3 RRTAndODTFit(vec3 v)
{vec3 a=v*(v+0.0245786)-0.000090537;vec3 b=v*(0.983729*v+0.4329510)+0.238081;return a/b;}
vec3 ACESFitted(vec3 color)
{color=ACESInputMat*color;color=RRTAndODTFit(color);color=ACESOutputMat*color;color=saturate(color);return color;}
#endif
#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_DEFINITIONS
vec4 applyImageProcessing(vec4 result) {
#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_UPDATERESULT_ATSTART
#ifdef EXPOSURE
result.rgb*=exposureLinear;
#endif
#ifdef VIGNETTE
vec2 viewportXY=gl_FragCoord.xy*vInverseScreenSize;viewportXY=viewportXY*2.0-1.0;vec3 vignetteXY1=vec3(viewportXY*vignetteSettings1.xy+vignetteSettings1.zw,1.0);float vignetteTerm=dot(vignetteXY1,vignetteXY1);float vignette=pow(vignetteTerm,vignetteSettings2.w);vec3 vignetteColor=vignetteSettings2.rgb;
#ifdef VIGNETTEBLENDMODEMULTIPLY
vec3 vignetteColorMultiplier=mix(vignetteColor,vec3(1,1,1),vignette);result.rgb*=vignetteColorMultiplier;
#endif
#ifdef VIGNETTEBLENDMODEOPAQUE
result.rgb=mix(vignetteColor,result.rgb,vignette);
#endif
#endif
#ifdef TONEMAPPING
#ifdef TONEMAPPING_ACES
result.rgb=ACESFitted(result.rgb);
#else
const float tonemappingCalibration=1.590579;result.rgb=1.0-exp2(-tonemappingCalibration*result.rgb);
#endif
#endif
result.rgb=toGammaSpace(result.rgb);result.rgb=saturate(result.rgb);
#ifdef CONTRAST
vec3 resultHighContrast=result.rgb*result.rgb*(3.0-2.0*result.rgb);if (contrast<1.0) {result.rgb=mix(vec3(0.5,0.5,0.5),result.rgb,contrast);} else {result.rgb=mix(result.rgb,resultHighContrast,contrast-1.0);}
#endif
#ifdef COLORGRADING
vec3 colorTransformInput=result.rgb*colorTransformSettings.xxx+colorTransformSettings.yyy;
#ifdef COLORGRADING3D
vec3 colorTransformOutput=texture(txColorTransform,colorTransformInput).rgb;
#else
vec3 colorTransformOutput=sampleTexture3D(txColorTransform,colorTransformInput,colorTransformSettings.yz).rgb;
#endif
result.rgb=mix(result.rgb,colorTransformOutput,colorTransformSettings.www);
#endif
#ifdef COLORCURVES
float luma=getLuminance(result.rgb);vec2 curveMix=clamp(vec2(luma*3.0-1.5,luma*-3.0+1.5),vec2(0.0),vec2(1.0));vec4 colorCurve=vCameraColorCurveNeutral+curveMix.x*vCameraColorCurvePositive-curveMix.y*vCameraColorCurveNegative;result.rgb*=colorCurve.rgb;result.rgb=mix(vec3(luma),result.rgb,colorCurve.a);
#endif
#ifdef DITHER
float rand=getRand(gl_FragCoord.xy*vInverseScreenSize);float dither=mix(-ditherIntensity,ditherIntensity,rand);result.rgb=saturate(result.rgb+vec3(dither));
#endif
#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_UPDATERESULT_ATEND
return result;}`;ne.IncludesShadersStore[QF]=ZF;const JF="bumpFragmentMainFunctions",e3=`#if defined(BUMP) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC) || defined(DETAIL)
#if defined(TANGENT) && defined(NORMAL) 
varying mat3 vTBN;
#endif
#ifdef OBJECTSPACE_NORMALMAP
uniform mat4 normalMatrix;
#if defined(WEBGL2) || defined(WEBGPU)
mat4 toNormalMatrix(mat4 wMatrix)
{mat4 ret=inverse(wMatrix);ret=transpose(ret);ret[0][3]=0.;ret[1][3]=0.;ret[2][3]=0.;ret[3]=vec4(0.,0.,0.,1.);return ret;}
#else
mat4 toNormalMatrix(mat4 m)
{float
a00=m[0][0],a01=m[0][1],a02=m[0][2],a03=m[0][3],
a10=m[1][0],a11=m[1][1],a12=m[1][2],a13=m[1][3],
a20=m[2][0],a21=m[2][1],a22=m[2][2],a23=m[2][3],
a30=m[3][0],a31=m[3][1],a32=m[3][2],a33=m[3][3],
b00=a00*a11-a01*a10,
b01=a00*a12-a02*a10,
b02=a00*a13-a03*a10,
b03=a01*a12-a02*a11,
b04=a01*a13-a03*a11,
b05=a02*a13-a03*a12,
b06=a20*a31-a21*a30,
b07=a20*a32-a22*a30,
b08=a20*a33-a23*a30,
b09=a21*a32-a22*a31,
b10=a21*a33-a23*a31,
b11=a22*a33-a23*a32,
det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;mat4 mi=mat4(
a11*b11-a12*b10+a13*b09,
a02*b10-a01*b11-a03*b09,
a31*b05-a32*b04+a33*b03,
a22*b04-a21*b05-a23*b03,
a12*b08-a10*b11-a13*b07,
a00*b11-a02*b08+a03*b07,
a32*b02-a30*b05-a33*b01,
a20*b05-a22*b02+a23*b01,
a10*b10-a11*b08+a13*b06,
a01*b08-a00*b10-a03*b06,
a30*b04-a31*b02+a33*b00,
a21*b02-a20*b04-a23*b00,
a11*b07-a10*b09-a12*b06,
a00*b09-a01*b07+a02*b06,
a31*b01-a30*b03-a32*b00,
a20*b03-a21*b01+a22*b00)/det;return mat4(mi[0][0],mi[1][0],mi[2][0],mi[3][0],
mi[0][1],mi[1][1],mi[2][1],mi[3][1],
mi[0][2],mi[1][2],mi[2][2],mi[3][2],
mi[0][3],mi[1][3],mi[2][3],mi[3][3]);}
#endif
#endif
vec3 perturbNormalBase(mat3 cotangentFrame,vec3 normal,float scale)
{
#ifdef NORMALXYSCALE
normal=normalize(normal*vec3(scale,scale,1.0));
#endif
return normalize(cotangentFrame*normal);}
vec3 perturbNormal(mat3 cotangentFrame,vec3 textureSample,float scale)
{return perturbNormalBase(cotangentFrame,textureSample*2.0-1.0,scale);}
mat3 cotangent_frame(vec3 normal,vec3 p,vec2 uv,vec2 tangentSpaceParams)
{vec3 dp1=dFdx(p);vec3 dp2=dFdy(p);vec2 duv1=dFdx(uv);vec2 duv2=dFdy(uv);vec3 dp2perp=cross(dp2,normal);vec3 dp1perp=cross(normal,dp1);vec3 tangent=dp2perp*duv1.x+dp1perp*duv2.x;vec3 bitangent=dp2perp*duv1.y+dp1perp*duv2.y;tangent*=tangentSpaceParams.x;bitangent*=tangentSpaceParams.y;float det=max(dot(tangent,tangent),dot(bitangent,bitangent));float invmax=det==0.0 ? 0.0 : inversesqrt(det);return mat3(tangent*invmax,bitangent*invmax,normal);}
#endif
`;ne.IncludesShadersStore[JF]=e3;const t3="bumpFragmentFunctions",i3=`#if defined(BUMP)
#include<samplerFragmentDeclaration>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump,_SAMPLERNAME_,bump)
#endif
#if defined(DETAIL)
#include<samplerFragmentDeclaration>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail,_SAMPLERNAME_,detail)
#endif
#if defined(BUMP) && defined(PARALLAX)
const float minSamples=4.;const float maxSamples=15.;const int iMaxSamples=15;vec2 parallaxOcclusion(vec3 vViewDirCoT,vec3 vNormalCoT,vec2 texCoord,float parallaxScale) {float parallaxLimit=length(vViewDirCoT.xy)/vViewDirCoT.z;parallaxLimit*=parallaxScale;vec2 vOffsetDir=normalize(vViewDirCoT.xy);vec2 vMaxOffset=vOffsetDir*parallaxLimit;float numSamples=maxSamples+(dot(vViewDirCoT,vNormalCoT)*(minSamples-maxSamples));float stepSize=1.0/numSamples;float currRayHeight=1.0;vec2 vCurrOffset=vec2(0,0);vec2 vLastOffset=vec2(0,0);float lastSampledHeight=1.0;float currSampledHeight=1.0;bool keepWorking=true;for (int i=0; i<iMaxSamples; i++)
{currSampledHeight=texture2D(bumpSampler,texCoord+vCurrOffset).w;if (!keepWorking)
{}
else if (currSampledHeight>currRayHeight)
{float delta1=currSampledHeight-currRayHeight;float delta2=(currRayHeight+stepSize)-lastSampledHeight;float ratio=delta1/(delta1+delta2);vCurrOffset=(ratio)* vLastOffset+(1.0-ratio)*vCurrOffset;keepWorking=false;}
else
{currRayHeight-=stepSize;vLastOffset=vCurrOffset;
#ifdef PARALLAX_RHS
vCurrOffset-=stepSize*vMaxOffset;
#else
vCurrOffset+=stepSize*vMaxOffset;
#endif
lastSampledHeight=currSampledHeight;}}
return vCurrOffset;}
vec2 parallaxOffset(vec3 viewDir,float heightScale)
{float height=texture2D(bumpSampler,vBumpUV).w;vec2 texCoordOffset=heightScale*viewDir.xy*height;
#ifdef PARALLAX_RHS
return texCoordOffset;
#else
return -texCoordOffset;
#endif
}
#endif
`;ne.IncludesShadersStore[t3]=i3;const r3="clipPlaneFragmentDeclaration",n3=`#ifdef CLIPPLANE
varying float fClipDistance;
#endif
#ifdef CLIPPLANE2
varying float fClipDistance2;
#endif
#ifdef CLIPPLANE3
varying float fClipDistance3;
#endif
#ifdef CLIPPLANE4
varying float fClipDistance4;
#endif
#ifdef CLIPPLANE5
varying float fClipDistance5;
#endif
#ifdef CLIPPLANE6
varying float fClipDistance6;
#endif
`;ne.IncludesShadersStore[r3]=n3;const s3="logDepthDeclaration",a3=`#ifdef LOGARITHMICDEPTH
uniform float logarithmicDepthConstant;varying float vFragmentDepth;
#endif
`;ne.IncludesShadersStore[s3]=a3;const o3="fogFragmentDeclaration",l3=`#ifdef FOG
#define FOGMODE_NONE 0.
#define FOGMODE_EXP 1.
#define FOGMODE_EXP2 2.
#define FOGMODE_LINEAR 3.
#define E 2.71828
uniform vec4 vFogInfos;uniform vec3 vFogColor;varying vec3 vFogDistance;float CalcFogFactor()
{float fogCoeff=1.0;float fogStart=vFogInfos.y;float fogEnd=vFogInfos.z;float fogDensity=vFogInfos.w;float fogDistance=length(vFogDistance);if (FOGMODE_LINEAR==vFogInfos.x)
{fogCoeff=(fogEnd-fogDistance)/(fogEnd-fogStart);}
else if (FOGMODE_EXP==vFogInfos.x)
{fogCoeff=1.0/pow(E,fogDistance*fogDensity);}
else if (FOGMODE_EXP2==vFogInfos.x)
{fogCoeff=1.0/pow(E,fogDistance*fogDistance*fogDensity*fogDensity);}
return clamp(fogCoeff,0.0,1.0);}
#endif
`;ne.IncludesShadersStore[o3]=l3;const c3="clipPlaneFragment",u3=`#if defined(CLIPPLANE) || defined(CLIPPLANE2) || defined(CLIPPLANE3) || defined(CLIPPLANE4) || defined(CLIPPLANE5) || defined(CLIPPLANE6)
if (false) {}
#endif
#ifdef CLIPPLANE
else if (fClipDistance>0.0)
{discard;}
#endif
#ifdef CLIPPLANE2
else if (fClipDistance2>0.0)
{discard;}
#endif
#ifdef CLIPPLANE3
else if (fClipDistance3>0.0)
{discard;}
#endif
#ifdef CLIPPLANE4
else if (fClipDistance4>0.0)
{discard;}
#endif
#ifdef CLIPPLANE5
else if (fClipDistance5>0.0)
{discard;}
#endif
#ifdef CLIPPLANE6
else if (fClipDistance6>0.0)
{discard;}
#endif
`;ne.IncludesShadersStore[c3]=u3;const h3="bumpFragment",d3=`vec2 uvOffset=vec2(0.0,0.0);
#if defined(BUMP) || defined(PARALLAX) || defined(DETAIL)
#ifdef NORMALXYSCALE
float normalScale=1.0;
#elif defined(BUMP)
float normalScale=vBumpInfos.y;
#else
float normalScale=1.0;
#endif
#if defined(TANGENT) && defined(NORMAL)
mat3 TBN=vTBN;
#elif defined(BUMP)
vec2 TBNUV=gl_FrontFacing ? vBumpUV : -vBumpUV;mat3 TBN=cotangent_frame(normalW*normalScale,vPositionW,TBNUV,vTangentSpaceParams);
#else
vec2 TBNUV=gl_FrontFacing ? vDetailUV : -vDetailUV;mat3 TBN=cotangent_frame(normalW*normalScale,vPositionW,TBNUV,vec2(1.,1.));
#endif
#elif defined(ANISOTROPIC)
#if defined(TANGENT) && defined(NORMAL)
mat3 TBN=vTBN;
#else
vec2 TBNUV=gl_FrontFacing ? vMainUV1 : -vMainUV1;mat3 TBN=cotangent_frame(normalW,vPositionW,TBNUV,vec2(1.,1.));
#endif
#endif
#ifdef PARALLAX
mat3 invTBN=transposeMat3(TBN);
#ifdef PARALLAXOCCLUSION
uvOffset=parallaxOcclusion(invTBN*-viewDirectionW,invTBN*normalW,vBumpUV,vBumpInfos.z);
#else
uvOffset=parallaxOffset(invTBN*viewDirectionW,vBumpInfos.z);
#endif
#endif
#ifdef DETAIL
vec4 detailColor=texture2D(detailSampler,vDetailUV+uvOffset);vec2 detailNormalRG=detailColor.wy*2.0-1.0;float detailNormalB=sqrt(1.-saturate(dot(detailNormalRG,detailNormalRG)));vec3 detailNormal=vec3(detailNormalRG,detailNormalB);
#endif
#ifdef BUMP
#ifdef OBJECTSPACE_NORMALMAP
#define CUSTOM_FRAGMENT_BUMP_FRAGMENT
normalW=normalize(texture2D(bumpSampler,vBumpUV).xyz *2.0-1.0);normalW=normalize(mat3(normalMatrix)*normalW);
#elif !defined(DETAIL)
normalW=perturbNormal(TBN,texture2D(bumpSampler,vBumpUV+uvOffset).xyz,vBumpInfos.y);
#else
vec3 bumpNormal=texture2D(bumpSampler,vBumpUV+uvOffset).xyz*2.0-1.0;
#if DETAIL_NORMALBLENDMETHOD==0 
detailNormal.xy*=vDetailInfos.z;vec3 blendedNormal=normalize(vec3(bumpNormal.xy+detailNormal.xy,bumpNormal.z*detailNormal.z));
#elif DETAIL_NORMALBLENDMETHOD==1 
detailNormal.xy*=vDetailInfos.z;bumpNormal+=vec3(0.0,0.0,1.0);detailNormal*=vec3(-1.0,-1.0,1.0);vec3 blendedNormal=bumpNormal*dot(bumpNormal,detailNormal)/bumpNormal.z-detailNormal;
#endif
normalW=perturbNormalBase(TBN,blendedNormal,vBumpInfos.y);
#endif
#elif defined(DETAIL)
detailNormal.xy*=vDetailInfos.z;normalW=perturbNormalBase(TBN,detailNormal,vDetailInfos.z);
#endif
`;ne.IncludesShadersStore[h3]=d3;const f3="decalFragment",_3=`#ifdef DECAL
#ifdef GAMMADECAL
decalColor.rgb=toLinearSpace(decalColor.rgb);
#endif
#ifdef DECAL_SMOOTHALPHA
decalColor.a*=decalColor.a;
#endif
surfaceAlbedo.rgb=mix(surfaceAlbedo.rgb,decalColor.rgb,decalColor.a);
#endif
`;ne.IncludesShadersStore[f3]=_3;const p3="depthPrePass",g3=`#ifdef DEPTHPREPASS
gl_FragColor=vec4(0.,0.,0.,1.0);return;
#endif
`;ne.IncludesShadersStore[p3]=g3;const m3="lightFragment",v3=`#ifdef LIGHT{X}
#if defined(SHADOWONLY) || defined(LIGHTMAP) && defined(LIGHTMAPEXCLUDED{X}) && defined(LIGHTMAPNOSPECULAR{X})
#else
#ifdef PBR
#ifdef SPOTLIGHT{X}
preInfo=computePointAndSpotPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);
#elif defined(POINTLIGHT{X})
preInfo=computePointAndSpotPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);
#elif defined(HEMILIGHT{X})
preInfo=computeHemisphericPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);
#elif defined(DIRLIGHT{X})
preInfo=computeDirectionalPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);
#endif
preInfo.NdotV=NdotV;
#ifdef SPOTLIGHT{X}
#ifdef LIGHT_FALLOFF_GLTF{X}
preInfo.attenuation=computeDistanceLightFalloff_GLTF(preInfo.lightDistanceSquared,light{X}.vLightFalloff.y);preInfo.attenuation*=computeDirectionalLightFalloff_GLTF(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightFalloff.z,light{X}.vLightFalloff.w);
#elif defined(LIGHT_FALLOFF_PHYSICAL{X})
preInfo.attenuation=computeDistanceLightFalloff_Physical(preInfo.lightDistanceSquared);preInfo.attenuation*=computeDirectionalLightFalloff_Physical(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w);
#elif defined(LIGHT_FALLOFF_STANDARD{X})
preInfo.attenuation=computeDistanceLightFalloff_Standard(preInfo.lightOffset,light{X}.vLightFalloff.x);preInfo.attenuation*=computeDirectionalLightFalloff_Standard(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w,light{X}.vLightData.w);
#else
preInfo.attenuation=computeDistanceLightFalloff(preInfo.lightOffset,preInfo.lightDistanceSquared,light{X}.vLightFalloff.x,light{X}.vLightFalloff.y);preInfo.attenuation*=computeDirectionalLightFalloff(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w,light{X}.vLightData.w,light{X}.vLightFalloff.z,light{X}.vLightFalloff.w);
#endif
#elif defined(POINTLIGHT{X})
#ifdef LIGHT_FALLOFF_GLTF{X}
preInfo.attenuation=computeDistanceLightFalloff_GLTF(preInfo.lightDistanceSquared,light{X}.vLightFalloff.y);
#elif defined(LIGHT_FALLOFF_PHYSICAL{X})
preInfo.attenuation=computeDistanceLightFalloff_Physical(preInfo.lightDistanceSquared);
#elif defined(LIGHT_FALLOFF_STANDARD{X})
preInfo.attenuation=computeDistanceLightFalloff_Standard(preInfo.lightOffset,light{X}.vLightFalloff.x);
#else
preInfo.attenuation=computeDistanceLightFalloff(preInfo.lightOffset,preInfo.lightDistanceSquared,light{X}.vLightFalloff.x,light{X}.vLightFalloff.y);
#endif
#else
preInfo.attenuation=1.0;
#endif
#ifdef HEMILIGHT{X}
preInfo.roughness=roughness;
#else
preInfo.roughness=adjustRoughnessFromLightProperties(roughness,light{X}.vLightSpecular.a,preInfo.lightDistance);
#endif
#ifdef IRIDESCENCE
preInfo.iridescenceIntensity=iridescenceIntensity;
#endif
#ifdef HEMILIGHT{X}
info.diffuse=computeHemisphericDiffuseLighting(preInfo,light{X}.vLightDiffuse.rgb,light{X}.vLightGround);
#elif defined(SS_TRANSLUCENCY)
info.diffuse=computeDiffuseAndTransmittedLighting(preInfo,light{X}.vLightDiffuse.rgb,subSurfaceOut.transmittance);
#else
info.diffuse=computeDiffuseLighting(preInfo,light{X}.vLightDiffuse.rgb);
#endif
#ifdef SPECULARTERM
#ifdef ANISOTROPIC
info.specular=computeAnisotropicSpecularLighting(preInfo,viewDirectionW,normalW,anisotropicOut.anisotropicTangent,anisotropicOut.anisotropicBitangent,anisotropicOut.anisotropy,clearcoatOut.specularEnvironmentR0,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);
#else
info.specular=computeSpecularLighting(preInfo,normalW,clearcoatOut.specularEnvironmentR0,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);
#endif
#endif
#ifdef SHEEN
#ifdef SHEEN_LINKWITHALBEDO
preInfo.roughness=sheenOut.sheenIntensity;
#else
#ifdef HEMILIGHT{X}
preInfo.roughness=sheenOut.sheenRoughness;
#else
preInfo.roughness=adjustRoughnessFromLightProperties(sheenOut.sheenRoughness,light{X}.vLightSpecular.a,preInfo.lightDistance);
#endif
#endif
info.sheen=computeSheenLighting(preInfo,normalW,sheenOut.sheenColor,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);
#endif
#ifdef CLEARCOAT
#ifdef HEMILIGHT{X}
preInfo.roughness=clearcoatOut.clearCoatRoughness;
#else
preInfo.roughness=adjustRoughnessFromLightProperties(clearcoatOut.clearCoatRoughness,light{X}.vLightSpecular.a,preInfo.lightDistance);
#endif
info.clearCoat=computeClearCoatLighting(preInfo,clearcoatOut.clearCoatNormalW,clearcoatOut.clearCoatAARoughnessFactors.x,clearcoatOut.clearCoatIntensity,light{X}.vLightDiffuse.rgb);
#ifdef CLEARCOAT_TINT
absorption=computeClearCoatLightingAbsorption(clearcoatOut.clearCoatNdotVRefract,preInfo.L,clearcoatOut.clearCoatNormalW,clearcoatOut.clearCoatColor,clearcoatOut.clearCoatThickness,clearcoatOut.clearCoatIntensity);info.diffuse*=absorption;
#ifdef SPECULARTERM
info.specular*=absorption;
#endif
#endif
info.diffuse*=info.clearCoat.w;
#ifdef SPECULARTERM
info.specular*=info.clearCoat.w;
#endif
#ifdef SHEEN
info.sheen*=info.clearCoat.w;
#endif
#endif
#else
#ifdef SPOTLIGHT{X}
info=computeSpotLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDirection,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightDiffuse.a,glossiness);
#elif defined(HEMILIGHT{X})
info=computeHemisphericLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightGround,glossiness);
#elif defined(POINTLIGHT{X}) || defined(DIRLIGHT{X})
info=computeLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightDiffuse.a,glossiness);
#endif
#endif
#ifdef PROJECTEDLIGHTTEXTURE{X}
info.diffuse*=computeProjectionTextureDiffuseLighting(projectionLightSampler{X},textureProjectionMatrix{X});
#endif
#endif
#ifdef SHADOW{X}
#ifdef SHADOWCSM{X}
for (int i=0; i<SHADOWCSMNUM_CASCADES{X}; i++) 
{
#ifdef SHADOWCSM_RIGHTHANDED{X}
diff{X}=viewFrustumZ{X}[i]+vPositionFromCamera{X}.z;
#else
diff{X}=viewFrustumZ{X}[i]-vPositionFromCamera{X}.z;
#endif
if (diff{X}>=0.) {index{X}=i;break;}}
#ifdef SHADOWCSMUSESHADOWMAXZ{X}
if (index{X}>=0)
#endif
{
#if defined(SHADOWPCF{X})
#if defined(SHADOWLOWQUALITY{X})
shadow=computeShadowWithCSMPCF1(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#elif defined(SHADOWMEDIUMQUALITY{X})
shadow=computeShadowWithCSMPCF3(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#else
shadow=computeShadowWithCSMPCF5(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
#elif defined(SHADOWPCSS{X})
#if defined(SHADOWLOWQUALITY{X})
shadow=computeShadowWithCSMPCSS16(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});
#elif defined(SHADOWMEDIUMQUALITY{X})
shadow=computeShadowWithCSMPCSS32(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});
#else
shadow=computeShadowWithCSMPCSS64(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});
#endif
#else
shadow=computeShadowCSM(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
#ifdef SHADOWCSMDEBUG{X}
shadowDebug{X}=vec3(shadow)*vCascadeColorsMultiplier{X}[index{X}];
#endif
#ifndef SHADOWCSMNOBLEND{X}
float frustumLength=frustumLengths{X}[index{X}];float diffRatio=clamp(diff{X}/frustumLength,0.,1.)*cascadeBlendFactor{X};if (index{X}<(SHADOWCSMNUM_CASCADES{X}-1) && diffRatio<1.)
{index{X}+=1;float nextShadow=0.;
#if defined(SHADOWPCF{X})
#if defined(SHADOWLOWQUALITY{X})
nextShadow=computeShadowWithCSMPCF1(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#elif defined(SHADOWMEDIUMQUALITY{X})
nextShadow=computeShadowWithCSMPCF3(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#else
nextShadow=computeShadowWithCSMPCF5(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
#elif defined(SHADOWPCSS{X})
#if defined(SHADOWLOWQUALITY{X})
nextShadow=computeShadowWithCSMPCSS16(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});
#elif defined(SHADOWMEDIUMQUALITY{X})
nextShadow=computeShadowWithCSMPCSS32(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});
#else
nextShadow=computeShadowWithCSMPCSS64(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});
#endif
#else
nextShadow=computeShadowCSM(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
shadow=mix(nextShadow,shadow,diffRatio);
#ifdef SHADOWCSMDEBUG{X}
shadowDebug{X}=mix(vec3(nextShadow)*vCascadeColorsMultiplier{X}[index{X}],shadowDebug{X},diffRatio);
#endif
}
#endif
}
#elif defined(SHADOWCLOSEESM{X})
#if defined(SHADOWCUBE{X})
shadow=computeShadowWithCloseESMCube(vPositionW,light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.depthValues);
#else
shadow=computeShadowWithCloseESM(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.shadowsInfo.w);
#endif
#elif defined(SHADOWESM{X})
#if defined(SHADOWCUBE{X})
shadow=computeShadowWithESMCube(vPositionW,light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.depthValues);
#else
shadow=computeShadowWithESM(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.shadowsInfo.w);
#endif
#elif defined(SHADOWPOISSON{X})
#if defined(SHADOWCUBE{X})
shadow=computeShadowWithPoissonSamplingCube(vPositionW,light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.x,light{X}.depthValues);
#else
shadow=computeShadowWithPoissonSampling(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
#elif defined(SHADOWPCF{X})
#if defined(SHADOWLOWQUALITY{X})
shadow=computeShadowWithPCF1(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#elif defined(SHADOWMEDIUMQUALITY{X})
shadow=computeShadowWithPCF3(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#else
shadow=computeShadowWithPCF5(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
#elif defined(SHADOWPCSS{X})
#if defined(SHADOWLOWQUALITY{X})
shadow=computeShadowWithPCSS16(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#elif defined(SHADOWMEDIUMQUALITY{X})
shadow=computeShadowWithPCSS32(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#else
shadow=computeShadowWithPCSS64(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
#else
#if defined(SHADOWCUBE{X})
shadow=computeShadowCube(vPositionW,light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.depthValues);
#else
shadow=computeShadow(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
#endif
#ifdef SHADOWONLY
#ifndef SHADOWINUSE
#define SHADOWINUSE
#endif
globalShadow+=shadow;shadowLightCount+=1.0;
#endif
#else
shadow=1.;
#endif
aggShadow+=shadow;numLights+=1.0;
#ifndef SHADOWONLY
#ifdef CUSTOMUSERLIGHTING
diffuseBase+=computeCustomDiffuseLighting(info,diffuseBase,shadow);
#ifdef SPECULARTERM
specularBase+=computeCustomSpecularLighting(info,specularBase,shadow);
#endif
#elif defined(LIGHTMAP) && defined(LIGHTMAPEXCLUDED{X})
diffuseBase+=lightmapColor.rgb*shadow;
#ifdef SPECULARTERM
#ifndef LIGHTMAPNOSPECULAR{X}
specularBase+=info.specular*shadow*lightmapColor.rgb;
#endif
#endif
#ifdef CLEARCOAT
#ifndef LIGHTMAPNOSPECULAR{X}
clearCoatBase+=info.clearCoat.rgb*shadow*lightmapColor.rgb;
#endif
#endif
#ifdef SHEEN
#ifndef LIGHTMAPNOSPECULAR{X}
sheenBase+=info.sheen.rgb*shadow;
#endif
#endif
#else
#ifdef SHADOWCSMDEBUG{X}
diffuseBase+=info.diffuse*shadowDebug{X};
#else 
diffuseBase+=info.diffuse*shadow;
#endif
#ifdef SPECULARTERM
specularBase+=info.specular*shadow;
#endif
#ifdef CLEARCOAT
clearCoatBase+=info.clearCoat.rgb*shadow;
#endif
#ifdef SHEEN
sheenBase+=info.sheen.rgb*shadow;
#endif
#endif
#endif
#endif
`;ne.IncludesShadersStore[m3]=v3;const E3="logDepthFragment",y3=`#ifdef LOGARITHMICDEPTH
gl_FragDepthEXT=log2(vFragmentDepth)*logarithmicDepthConstant*0.5;
#endif
`;ne.IncludesShadersStore[E3]=y3;const T3="fogFragment",b3=`#ifdef FOG
float fog=CalcFogFactor();
#ifdef PBR
fog=toLinearSpace(fog);
#endif
color.rgb=mix(vFogColor,color.rgb,fog);
#endif
`;ne.IncludesShadersStore[T3]=b3;const C3="oitFragment",A3=`#ifdef ORDER_INDEPENDENT_TRANSPARENCY
float fragDepth=gl_FragCoord.z; 
#ifdef ORDER_INDEPENDENT_TRANSPARENCY_16BITS
uint halfFloat=packHalf2x16(vec2(fragDepth));vec2 full=unpackHalf2x16(halfFloat);fragDepth=full.x;
#endif
ivec2 fragCoord=ivec2(gl_FragCoord.xy);vec2 lastDepth=texelFetch(oitDepthSampler,fragCoord,0).rg;vec4 lastFrontColor=texelFetch(oitFrontColorSampler,fragCoord,0);depth.rg=vec2(-MAX_DEPTH);frontColor=lastFrontColor;backColor=vec4(0.0);
#ifdef USE_REVERSE_DEPTHBUFFER
float furthestDepth=-lastDepth.x;float nearestDepth=lastDepth.y;
#else
float nearestDepth=-lastDepth.x;float furthestDepth=lastDepth.y;
#endif
float alphaMultiplier=1.0-lastFrontColor.a;
#ifdef USE_REVERSE_DEPTHBUFFER
if (fragDepth>nearestDepth || fragDepth<furthestDepth) {
#else
if (fragDepth<nearestDepth || fragDepth>furthestDepth) {
#endif
return;}
#ifdef USE_REVERSE_DEPTHBUFFER
if (fragDepth<nearestDepth && fragDepth>furthestDepth) {
#else
if (fragDepth>nearestDepth && fragDepth<furthestDepth) {
#endif
depth.rg=vec2(-fragDepth,fragDepth);return;}
#endif
`;ne.IncludesShadersStore[C3]=A3;const S3="defaultPixelShader",R3=`#include<__decl__defaultFragment>
#if defined(BUMP) || !defined(NORMAL)
#extension GL_OES_standard_derivatives : enable
#endif
#include<prePassDeclaration>[SCENE_MRT_COUNT]
#include<oitDeclaration>
#define CUSTOM_FRAGMENT_BEGIN
#ifdef LOGARITHMICDEPTH
#extension GL_EXT_frag_depth : enable
#endif
varying vec3 vPositionW;
#ifdef NORMAL
varying vec3 vNormalW;
#endif
#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)
varying vec4 vColor;
#endif
#include<mainUVVaryingDeclaration>[1..7]
#include<helperFunctions>
#include<__decl__lightFragment>[0..maxSimultaneousLights]
#include<lightsFragmentFunctions>
#include<shadowsFragmentFunctions>
#include<samplerFragmentDeclaration>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse,_SAMPLERNAME_,diffuse)
#include<samplerFragmentDeclaration>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient,_SAMPLERNAME_,ambient)
#include<samplerFragmentDeclaration>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity,_SAMPLERNAME_,opacity)
#include<samplerFragmentDeclaration>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive,_SAMPLERNAME_,emissive)
#include<samplerFragmentDeclaration>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap,_SAMPLERNAME_,lightmap)
#include<samplerFragmentDeclaration>(_DEFINENAME_,DECAL,_VARYINGNAME_,Decal,_SAMPLERNAME_,decal)
#ifdef REFRACTION
#ifdef REFRACTIONMAP_3D
uniform samplerCube refractionCubeSampler;
#else
uniform sampler2D refraction2DSampler;
#endif
#endif
#if defined(SPECULARTERM)
#include<samplerFragmentDeclaration>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular,_SAMPLERNAME_,specular)
#endif
#include<fresnelFunction>
#ifdef REFLECTION
#ifdef REFLECTIONMAP_3D
uniform samplerCube reflectionCubeSampler;
#else
uniform sampler2D reflection2DSampler;
#endif
#ifdef REFLECTIONMAP_SKYBOX
varying vec3 vPositionUVW;
#else
#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)
varying vec3 vDirectionW;
#endif
#endif
#include<reflectionFunction>
#endif
#include<imageProcessingDeclaration>
#include<imageProcessingFunctions>
#include<bumpFragmentMainFunctions>
#include<bumpFragmentFunctions>
#include<clipPlaneFragmentDeclaration>
#include<logDepthDeclaration>
#include<fogFragmentDeclaration>
#define CUSTOM_FRAGMENT_DEFINITIONS
void main(void) {
#define CUSTOM_FRAGMENT_MAIN_BEGIN
#include<clipPlaneFragment>
vec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);vec4 baseColor=vec4(1.,1.,1.,1.);vec3 diffuseColor=vDiffuseColor.rgb;float alpha=vDiffuseColor.a;
#ifdef NORMAL
vec3 normalW=normalize(vNormalW);
#else
vec3 normalW=normalize(-cross(dFdx(vPositionW),dFdy(vPositionW)));
#endif
#include<bumpFragment>
#ifdef TWOSIDEDLIGHTING
normalW=gl_FrontFacing ? normalW : -normalW;
#endif
#ifdef DIFFUSE
baseColor=texture2D(diffuseSampler,vDiffuseUV+uvOffset);
#if defined(ALPHATEST) && !defined(ALPHATEST_AFTERALLALPHACOMPUTATIONS)
if (baseColor.a<alphaCutOff)
discard;
#endif
#ifdef ALPHAFROMDIFFUSE
alpha*=baseColor.a;
#endif
#define CUSTOM_FRAGMENT_UPDATE_ALPHA
baseColor.rgb*=vDiffuseInfos.y;
#endif
#if defined(DECAL) && !defined(DECAL_AFTER_DETAIL)
vec4 decalColor=texture2D(decalSampler,vDecalUV+uvOffset);
#include<decalFragment>(surfaceAlbedo,baseColor,GAMMADECAL,_GAMMADECAL_NOTUSED_)
#endif
#include<depthPrePass>
#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)
baseColor.rgb*=vColor.rgb;
#endif
#ifdef DETAIL
baseColor.rgb=baseColor.rgb*2.0*mix(0.5,detailColor.r,vDetailInfos.y);
#endif
#if defined(DECAL) && defined(DECAL_AFTER_DETAIL)
vec4 decalColor=texture2D(decalSampler,vDecalUV+uvOffset);
#include<decalFragment>(surfaceAlbedo,baseColor,GAMMADECAL,_GAMMADECAL_NOTUSED_)
#endif
#define CUSTOM_FRAGMENT_UPDATE_DIFFUSE
vec3 baseAmbientColor=vec3(1.,1.,1.);
#ifdef AMBIENT
baseAmbientColor=texture2D(ambientSampler,vAmbientUV+uvOffset).rgb*vAmbientInfos.y;
#endif
#define CUSTOM_FRAGMENT_BEFORE_LIGHTS
#ifdef SPECULARTERM
float glossiness=vSpecularColor.a;vec3 specularColor=vSpecularColor.rgb;
#ifdef SPECULAR
vec4 specularMapColor=texture2D(specularSampler,vSpecularUV+uvOffset);specularColor=specularMapColor.rgb;
#ifdef GLOSSINESS
glossiness=glossiness*specularMapColor.a;
#endif
#endif
#else
float glossiness=0.;
#endif
vec3 diffuseBase=vec3(0.,0.,0.);lightingInfo info;
#ifdef SPECULARTERM
vec3 specularBase=vec3(0.,0.,0.);
#endif
float shadow=1.;float aggShadow=0.;float numLights=0.;
#ifdef LIGHTMAP
vec4 lightmapColor=texture2D(lightmapSampler,vLightmapUV+uvOffset);
#ifdef RGBDLIGHTMAP
lightmapColor.rgb=fromRGBD(lightmapColor);
#endif
lightmapColor.rgb*=vLightmapInfos.y;
#endif
#include<lightFragment>[0..maxSimultaneousLights]
aggShadow=aggShadow/numLights;vec4 refractionColor=vec4(0.,0.,0.,1.);
#ifdef REFRACTION
vec3 refractionVector=normalize(refract(-viewDirectionW,normalW,vRefractionInfos.y));
#ifdef REFRACTIONMAP_3D
#ifdef USE_LOCAL_REFRACTIONMAP_CUBIC
refractionVector=parallaxCorrectNormal(vPositionW,refractionVector,vRefractionSize,vRefractionPosition);
#endif
refractionVector.y=refractionVector.y*vRefractionInfos.w;vec4 refractionLookup=textureCube(refractionCubeSampler,refractionVector);if (dot(refractionVector,viewDirectionW)<1.0) {refractionColor=refractionLookup;}
#else
vec3 vRefractionUVW=vec3(refractionMatrix*(view*vec4(vPositionW+refractionVector*vRefractionInfos.z,1.0)));vec2 refractionCoords=vRefractionUVW.xy/vRefractionUVW.z;refractionCoords.y=1.0-refractionCoords.y;refractionColor=texture2D(refraction2DSampler,refractionCoords);
#endif
#ifdef RGBDREFRACTION
refractionColor.rgb=fromRGBD(refractionColor);
#endif
#ifdef IS_REFRACTION_LINEAR
refractionColor.rgb=toGammaSpace(refractionColor.rgb);
#endif
refractionColor.rgb*=vRefractionInfos.x;
#endif
vec4 reflectionColor=vec4(0.,0.,0.,1.);
#ifdef REFLECTION
vec3 vReflectionUVW=computeReflectionCoords(vec4(vPositionW,1.0),normalW);
#ifdef REFLECTIONMAP_OPPOSITEZ
vReflectionUVW.z*=-1.0;
#endif
#ifdef REFLECTIONMAP_3D
#ifdef ROUGHNESS
float bias=vReflectionInfos.y;
#ifdef SPECULARTERM
#ifdef SPECULAR
#ifdef GLOSSINESS
bias*=(1.0-specularMapColor.a);
#endif
#endif
#endif
reflectionColor=textureCube(reflectionCubeSampler,vReflectionUVW,bias);
#else
reflectionColor=textureCube(reflectionCubeSampler,vReflectionUVW);
#endif
#else
vec2 coords=vReflectionUVW.xy;
#ifdef REFLECTIONMAP_PROJECTION
coords/=vReflectionUVW.z;
#endif
coords.y=1.0-coords.y;reflectionColor=texture2D(reflection2DSampler,coords);
#endif
#ifdef RGBDREFLECTION
reflectionColor.rgb=fromRGBD(reflectionColor);
#endif
#ifdef IS_REFLECTION_LINEAR
reflectionColor.rgb=toGammaSpace(reflectionColor.rgb);
#endif
reflectionColor.rgb*=vReflectionInfos.x;
#ifdef REFLECTIONFRESNEL
float reflectionFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,reflectionRightColor.a,reflectionLeftColor.a);
#ifdef REFLECTIONFRESNELFROMSPECULAR
#ifdef SPECULARTERM
reflectionColor.rgb*=specularColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;
#else
reflectionColor.rgb*=reflectionLeftColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;
#endif
#else
reflectionColor.rgb*=reflectionLeftColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;
#endif
#endif
#endif
#ifdef REFRACTIONFRESNEL
float refractionFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,refractionRightColor.a,refractionLeftColor.a);refractionColor.rgb*=refractionLeftColor.rgb*(1.0-refractionFresnelTerm)+refractionFresnelTerm*refractionRightColor.rgb;
#endif
#ifdef OPACITY
vec4 opacityMap=texture2D(opacitySampler,vOpacityUV+uvOffset);
#ifdef OPACITYRGB
opacityMap.rgb=opacityMap.rgb*vec3(0.3,0.59,0.11);alpha*=(opacityMap.x+opacityMap.y+opacityMap.z)* vOpacityInfos.y;
#else
alpha*=opacityMap.a*vOpacityInfos.y;
#endif
#endif
#if defined(VERTEXALPHA) || defined(INSTANCESCOLOR) && defined(INSTANCES)
alpha*=vColor.a;
#endif
#ifdef OPACITYFRESNEL
float opacityFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,opacityParts.z,opacityParts.w);alpha+=opacityParts.x*(1.0-opacityFresnelTerm)+opacityFresnelTerm*opacityParts.y;
#endif
#ifdef ALPHATEST
#ifdef ALPHATEST_AFTERALLALPHACOMPUTATIONS
if (alpha<alphaCutOff)
discard;
#endif
#ifndef ALPHABLEND
alpha=1.0;
#endif
#endif
vec3 emissiveColor=vEmissiveColor;
#ifdef EMISSIVE
emissiveColor+=texture2D(emissiveSampler,vEmissiveUV+uvOffset).rgb*vEmissiveInfos.y;
#endif
#ifdef EMISSIVEFRESNEL
float emissiveFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,emissiveRightColor.a,emissiveLeftColor.a);emissiveColor*=emissiveLeftColor.rgb*(1.0-emissiveFresnelTerm)+emissiveFresnelTerm*emissiveRightColor.rgb;
#endif
#ifdef DIFFUSEFRESNEL
float diffuseFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,diffuseRightColor.a,diffuseLeftColor.a);diffuseBase*=diffuseLeftColor.rgb*(1.0-diffuseFresnelTerm)+diffuseFresnelTerm*diffuseRightColor.rgb;
#endif
#ifdef EMISSIVEASILLUMINATION
vec3 finalDiffuse=clamp(diffuseBase*diffuseColor+vAmbientColor,0.0,1.0)*baseColor.rgb;
#else
#ifdef LINKEMISSIVEWITHDIFFUSE
vec3 finalDiffuse=clamp((diffuseBase+emissiveColor)*diffuseColor+vAmbientColor,0.0,1.0)*baseColor.rgb;
#else
vec3 finalDiffuse=clamp(diffuseBase*diffuseColor+emissiveColor+vAmbientColor,0.0,1.0)*baseColor.rgb;
#endif
#endif
#ifdef SPECULARTERM
vec3 finalSpecular=specularBase*specularColor;
#ifdef SPECULAROVERALPHA
alpha=clamp(alpha+dot(finalSpecular,vec3(0.3,0.59,0.11)),0.,1.);
#endif
#else
vec3 finalSpecular=vec3(0.0);
#endif
#ifdef REFLECTIONOVERALPHA
alpha=clamp(alpha+dot(reflectionColor.rgb,vec3(0.3,0.59,0.11)),0.,1.);
#endif
#ifdef EMISSIVEASILLUMINATION
vec4 color=vec4(clamp(finalDiffuse*baseAmbientColor+finalSpecular+reflectionColor.rgb+emissiveColor+refractionColor.rgb,0.0,1.0),alpha);
#else
vec4 color=vec4(finalDiffuse*baseAmbientColor+finalSpecular+reflectionColor.rgb+refractionColor.rgb,alpha);
#endif
#ifdef LIGHTMAP
#ifndef LIGHTMAPEXCLUDED
#ifdef USELIGHTMAPASSHADOWMAP
color.rgb*=lightmapColor.rgb;
#else
color.rgb+=lightmapColor.rgb;
#endif
#endif
#endif
#define CUSTOM_FRAGMENT_BEFORE_FOG
color.rgb=max(color.rgb,0.);
#include<logDepthFragment>
#include<fogFragment>
#ifdef IMAGEPROCESSINGPOSTPROCESS
color.rgb=toLinearSpace(color.rgb);
#else
#ifdef IMAGEPROCESSING
color.rgb=toLinearSpace(color.rgb);color=applyImageProcessing(color);
#endif
#endif
color.a*=visibility;
#ifdef PREMULTIPLYALPHA
color.rgb*=color.a;
#endif
#define CUSTOM_FRAGMENT_BEFORE_FRAGCOLOR
#ifdef PREPASS
float writeGeometryInfo=color.a>0.4 ? 1.0 : 0.0;gl_FragData[0]=color; 
#ifdef PREPASS_POSITION
gl_FragData[PREPASS_POSITION_INDEX]=vec4(vPositionW,writeGeometryInfo);
#endif
#ifdef PREPASS_VELOCITY
vec2 a=(vCurrentPosition.xy/vCurrentPosition.w)*0.5+0.5;vec2 b=(vPreviousPosition.xy/vPreviousPosition.w)*0.5+0.5;vec2 velocity=abs(a-b);velocity=vec2(pow(velocity.x,1.0/3.0),pow(velocity.y,1.0/3.0))*sign(a-b)*0.5+0.5;gl_FragData[PREPASS_VELOCITY_INDEX]=vec4(velocity,0.0,writeGeometryInfo);
#endif
#ifdef PREPASS_IRRADIANCE
gl_FragData[PREPASS_IRRADIANCE_INDEX]=vec4(0.0,0.0,0.0,writeGeometryInfo); 
#endif
#ifdef PREPASS_DEPTH
gl_FragData[PREPASS_DEPTH_INDEX]=vec4(vViewPos.z,0.0,0.0,writeGeometryInfo); 
#endif
#ifdef PREPASS_NORMAL
#ifdef PREPASS_NORMAL_WORLDSPACE
gl_FragData[PREPASS_NORMAL_INDEX]=vec4(normalW,writeGeometryInfo); 
#else
gl_FragData[PREPASS_NORMAL_INDEX]=vec4(normalize((view*vec4(normalW,0.0)).rgb),writeGeometryInfo); 
#endif
#endif
#ifdef PREPASS_ALBEDO_SQRT
gl_FragData[PREPASS_ALBEDO_SQRT_INDEX]=vec4(0.0,0.0,0.0,writeGeometryInfo); 
#endif
#ifdef PREPASS_REFLECTIVITY
#if defined(SPECULARTERM)
#if defined(SPECULAR)
gl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(toLinearSpace(specularMapColor))*writeGeometryInfo; 
#else
gl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(toLinearSpace(specularColor),1.0)*writeGeometryInfo;
#endif
#else
gl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(0.0,0.0,0.0,1.0)*writeGeometryInfo;
#endif
#endif
#endif
#if !defined(PREPASS) || defined(WEBGL2)
gl_FragColor=color;
#endif
#include<oitFragment>
#if ORDER_INDEPENDENT_TRANSPARENCY
if (fragDepth==nearestDepth) {frontColor.rgb+=color.rgb*color.a*alphaMultiplier;frontColor.a=1.0-alphaMultiplier*(1.0-color.a);} else {backColor+=color;}
#endif
#define CUSTOM_FRAGMENT_MAIN_END
}
`;ne.ShadersStore[S3]=R3;const x3="decalVertexDeclaration",M3=`#ifdef DECAL
uniform vec4 vDecalInfos;uniform mat4 decalMatrix;
#endif
`;ne.IncludesShadersStore[x3]=M3;const I3="defaultVertexDeclaration",P3=`uniform mat4 viewProjection;uniform mat4 view;
#ifdef DIFFUSE
uniform mat4 diffuseMatrix;uniform vec2 vDiffuseInfos;
#endif
#ifdef AMBIENT
uniform mat4 ambientMatrix;uniform vec2 vAmbientInfos;
#endif
#ifdef OPACITY
uniform mat4 opacityMatrix;uniform vec2 vOpacityInfos;
#endif
#ifdef EMISSIVE
uniform vec2 vEmissiveInfos;uniform mat4 emissiveMatrix;
#endif
#ifdef LIGHTMAP
uniform vec2 vLightmapInfos;uniform mat4 lightmapMatrix;
#endif
#if defined(SPECULAR) && defined(SPECULARTERM)
uniform vec2 vSpecularInfos;uniform mat4 specularMatrix;
#endif
#ifdef BUMP
uniform vec3 vBumpInfos;uniform mat4 bumpMatrix;
#endif
#ifdef REFLECTION
uniform mat4 reflectionMatrix;
#endif
#ifdef POINTSIZE
uniform float pointSize;
#endif
#ifdef DETAIL
uniform vec4 vDetailInfos;uniform mat4 detailMatrix;
#endif
#include<decalVertexDeclaration>
#define ADDITIONAL_VERTEX_DECLARATION
`;ne.IncludesShadersStore[I3]=P3;const w3="uvAttributeDeclaration",O3=`#ifdef UV{X}
attribute vec2 uv{X};
#endif
`;ne.IncludesShadersStore[w3]=O3;const D3="bonesDeclaration",L3=`#if NUM_BONE_INFLUENCERS>0
attribute vec4 matricesIndices;attribute vec4 matricesWeights;
#if NUM_BONE_INFLUENCERS>4
attribute vec4 matricesIndicesExtra;attribute vec4 matricesWeightsExtra;
#endif
#ifndef BAKED_VERTEX_ANIMATION_TEXTURE
#ifdef BONETEXTURE
uniform highp sampler2D boneSampler;uniform float boneTextureWidth;
#else
uniform mat4 mBones[BonesPerMesh];
#endif
#ifdef BONES_VELOCITY_ENABLED
uniform mat4 mPreviousBones[BonesPerMesh];
#endif
#ifdef BONETEXTURE
#define inline
mat4 readMatrixFromRawSampler(sampler2D smp,float index)
{float offset=index *4.0;float dx=1.0/boneTextureWidth;vec4 m0=texture2D(smp,vec2(dx*(offset+0.5),0.));vec4 m1=texture2D(smp,vec2(dx*(offset+1.5),0.));vec4 m2=texture2D(smp,vec2(dx*(offset+2.5),0.));vec4 m3=texture2D(smp,vec2(dx*(offset+3.5),0.));return mat4(m0,m1,m2,m3);}
#endif
#endif
#endif
`;ne.IncludesShadersStore[D3]=L3;const N3="bakedVertexAnimationDeclaration",F3=`#ifdef BAKED_VERTEX_ANIMATION_TEXTURE
uniform float bakedVertexAnimationTime;uniform vec2 bakedVertexAnimationTextureSizeInverted;uniform vec4 bakedVertexAnimationSettings;uniform sampler2D bakedVertexAnimationTexture;
#ifdef INSTANCES
attribute vec4 bakedVertexAnimationSettingsInstanced;
#endif
#define inline
mat4 readMatrixFromRawSamplerVAT(sampler2D smp,float index,float frame)
{float offset=index*4.0;float frameUV=(frame+0.5)*bakedVertexAnimationTextureSizeInverted.y;float dx=bakedVertexAnimationTextureSizeInverted.x;vec4 m0=texture2D(smp,vec2(dx*(offset+0.5),frameUV));vec4 m1=texture2D(smp,vec2(dx*(offset+1.5),frameUV));vec4 m2=texture2D(smp,vec2(dx*(offset+2.5),frameUV));vec4 m3=texture2D(smp,vec2(dx*(offset+3.5),frameUV));return mat4(m0,m1,m2,m3);}
#endif
`;ne.IncludesShadersStore[N3]=F3;const k3="instancesDeclaration",B3=`#ifdef INSTANCES
attribute vec4 world0;attribute vec4 world1;attribute vec4 world2;attribute vec4 world3;
#ifdef INSTANCESCOLOR
attribute vec4 instanceColor;
#endif
#if defined(THIN_INSTANCES) && !defined(WORLD_UBO)
uniform mat4 world;
#endif
#if defined(VELOCITY) || defined(PREPASS_VELOCITY)
attribute vec4 previousWorld0;attribute vec4 previousWorld1;attribute vec4 previousWorld2;attribute vec4 previousWorld3;
#ifdef THIN_INSTANCES
uniform mat4 previousWorld;
#endif
#endif
#else
#if !defined(WORLD_UBO)
uniform mat4 world;
#endif
#if defined(VELOCITY) || defined(PREPASS_VELOCITY)
uniform mat4 previousWorld;
#endif
#endif
`;ne.IncludesShadersStore[k3]=B3;const U3="prePassVertexDeclaration",z3=`#ifdef PREPASS
#ifdef PREPASS_DEPTH
varying vec3 vViewPos;
#endif
#ifdef PREPASS_VELOCITY
uniform mat4 previousViewProjection;varying vec4 vCurrentPosition;varying vec4 vPreviousPosition;
#endif
#endif
`;ne.IncludesShadersStore[U3]=z3;const V3="samplerVertexDeclaration",G3=`#if defined(_DEFINENAME_) && _DEFINENAME_DIRECTUV==0
varying vec2 v_VARYINGNAME_UV;
#endif
`;ne.IncludesShadersStore[V3]=G3;const W3="bumpVertexDeclaration",H3=`#if defined(BUMP) || defined(PARALLAX) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC)
#if defined(TANGENT) && defined(NORMAL) 
varying mat3 vTBN;
#endif
#endif
`;ne.IncludesShadersStore[W3]=H3;const j3="clipPlaneVertexDeclaration",X3=`#ifdef CLIPPLANE
uniform vec4 vClipPlane;varying float fClipDistance;
#endif
#ifdef CLIPPLANE2
uniform vec4 vClipPlane2;varying float fClipDistance2;
#endif
#ifdef CLIPPLANE3
uniform vec4 vClipPlane3;varying float fClipDistance3;
#endif
#ifdef CLIPPLANE4
uniform vec4 vClipPlane4;varying float fClipDistance4;
#endif
#ifdef CLIPPLANE5
uniform vec4 vClipPlane5;varying float fClipDistance5;
#endif
#ifdef CLIPPLANE6
uniform vec4 vClipPlane6;varying float fClipDistance6;
#endif
`;ne.IncludesShadersStore[j3]=X3;const Y3="fogVertexDeclaration",K3=`#ifdef FOG
varying vec3 vFogDistance;
#endif
`;ne.IncludesShadersStore[Y3]=K3;const q3="lightVxFragmentDeclaration",$3=`#ifdef LIGHT{X}
uniform vec4 vLightData{X};uniform vec4 vLightDiffuse{X};
#ifdef SPECULARTERM
uniform vec4 vLightSpecular{X};
#else
vec4 vLightSpecular{X}=vec4(0.);
#endif
#ifdef SHADOW{X}
#ifdef SHADOWCSM{X}
uniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];varying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];varying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];varying vec4 vPositionFromCamera{X};
#elif defined(SHADOWCUBE{X})
#else
varying vec4 vPositionFromLight{X};varying float vDepthMetric{X};uniform mat4 lightMatrix{X};
#endif
uniform vec4 shadowsInfo{X};uniform vec2 depthValues{X};
#endif
#ifdef SPOTLIGHT{X}
uniform vec4 vLightDirection{X};uniform vec4 vLightFalloff{X};
#elif defined(POINTLIGHT{X})
uniform vec4 vLightFalloff{X};
#elif defined(HEMILIGHT{X})
uniform vec3 vLightGround{X};
#endif
#endif
`;ne.IncludesShadersStore[q3]=$3;const Q3="lightVxUboDeclaration",Z3=`#ifdef LIGHT{X}
uniform Light{X}
{vec4 vLightData;vec4 vLightDiffuse;vec4 vLightSpecular;
#ifdef SPOTLIGHT{X}
vec4 vLightDirection;vec4 vLightFalloff;
#elif defined(POINTLIGHT{X})
vec4 vLightFalloff;
#elif defined(HEMILIGHT{X})
vec3 vLightGround;
#endif
vec4 shadowsInfo;vec2 depthValues;} light{X};
#ifdef SHADOW{X}
#ifdef SHADOWCSM{X}
uniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];varying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];varying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];varying vec4 vPositionFromCamera{X};
#elif defined(SHADOWCUBE{X})
#else
varying vec4 vPositionFromLight{X};varying float vDepthMetric{X};uniform mat4 lightMatrix{X};
#endif
#endif
#endif
`;ne.IncludesShadersStore[Q3]=Z3;const J3="morphTargetsVertexGlobalDeclaration",e4=`#ifdef MORPHTARGETS
uniform float morphTargetInfluences[NUM_MORPH_INFLUENCERS];
#ifdef MORPHTARGETS_TEXTURE 
uniform float morphTargetTextureIndices[NUM_MORPH_INFLUENCERS];uniform vec3 morphTargetTextureInfo;uniform highp sampler2DArray morphTargets;vec3 readVector3FromRawSampler(int targetIndex,float vertexIndex)
{ 
float y=floor(vertexIndex/morphTargetTextureInfo.y);float x=vertexIndex-y*morphTargetTextureInfo.y;vec3 textureUV=vec3((x+0.5)/morphTargetTextureInfo.y,(y+0.5)/morphTargetTextureInfo.z,morphTargetTextureIndices[targetIndex]);return texture(morphTargets,textureUV).xyz;}
#endif
#endif
`;ne.IncludesShadersStore[J3]=e4;const t4="morphTargetsVertexDeclaration",i4=`#ifdef MORPHTARGETS
#ifndef MORPHTARGETS_TEXTURE
attribute vec3 position{X};
#ifdef MORPHTARGETS_NORMAL
attribute vec3 normal{X};
#endif
#ifdef MORPHTARGETS_TANGENT
attribute vec3 tangent{X};
#endif
#ifdef MORPHTARGETS_UV
attribute vec2 uv_{X};
#endif
#elif {X}==0
uniform int morphTargetCount;
#endif
#endif
`;ne.IncludesShadersStore[t4]=i4;const r4="morphTargetsVertexGlobal",n4=`#ifdef MORPHTARGETS
#ifdef MORPHTARGETS_TEXTURE
float vertexID;
#endif
#endif
`;ne.IncludesShadersStore[r4]=n4;const s4="morphTargetsVertex",a4=`#ifdef MORPHTARGETS
#ifdef MORPHTARGETS_TEXTURE
#if {X}==0
for (int i=0; i<NUM_MORPH_INFLUENCERS; i++) {if (i>=morphTargetCount) break;vertexID=float(gl_VertexID)*morphTargetTextureInfo.x;positionUpdated+=(readVector3FromRawSampler(i,vertexID)-position)*morphTargetInfluences[i];vertexID+=1.0;
#ifdef MORPHTARGETS_NORMAL
normalUpdated+=(readVector3FromRawSampler(i,vertexID) -normal)*morphTargetInfluences[i];vertexID+=1.0;
#endif
#ifdef MORPHTARGETS_UV
uvUpdated+=(readVector3FromRawSampler(i,vertexID).xy-uv)*morphTargetInfluences[i];vertexID+=1.0;
#endif
#ifdef MORPHTARGETS_TANGENT
tangentUpdated.xyz+=(readVector3FromRawSampler(i,vertexID) -tangent.xyz)*morphTargetInfluences[i];
#endif
}
#endif
#else
positionUpdated+=(position{X}-position)*morphTargetInfluences[{X}];
#ifdef MORPHTARGETS_NORMAL
normalUpdated+=(normal{X}-normal)*morphTargetInfluences[{X}];
#endif
#ifdef MORPHTARGETS_TANGENT
tangentUpdated.xyz+=(tangent{X}-tangent.xyz)*morphTargetInfluences[{X}];
#endif
#ifdef MORPHTARGETS_UV
uvUpdated+=(uv_{X}-uv)*morphTargetInfluences[{X}];
#endif
#endif
#endif
`;ne.IncludesShadersStore[s4]=a4;const o4="instancesVertex",l4=`#ifdef INSTANCES
mat4 finalWorld=mat4(world0,world1,world2,world3);
#if defined(PREPASS_VELOCITY) || defined(VELOCITY)
mat4 finalPreviousWorld=mat4(previousWorld0,previousWorld1,previousWorld2,previousWorld3);
#endif
#ifdef THIN_INSTANCES
finalWorld=world*finalWorld;
#if defined(PREPASS_VELOCITY) || defined(VELOCITY)
finalPreviousWorld=previousWorld*finalPreviousWorld;
#endif
#endif
#else
mat4 finalWorld=world;
#if defined(PREPASS_VELOCITY) || defined(VELOCITY)
mat4 finalPreviousWorld=previousWorld;
#endif
#endif
`;ne.IncludesShadersStore[o4]=l4;const c4="bonesVertex",u4=`#ifndef BAKED_VERTEX_ANIMATION_TEXTURE
#if NUM_BONE_INFLUENCERS>0
mat4 influence;
#ifdef BONETEXTURE
influence=readMatrixFromRawSampler(boneSampler,matricesIndices[0])*matricesWeights[0];
#if NUM_BONE_INFLUENCERS>1
influence+=readMatrixFromRawSampler(boneSampler,matricesIndices[1])*matricesWeights[1];
#endif
#if NUM_BONE_INFLUENCERS>2
influence+=readMatrixFromRawSampler(boneSampler,matricesIndices[2])*matricesWeights[2];
#endif
#if NUM_BONE_INFLUENCERS>3
influence+=readMatrixFromRawSampler(boneSampler,matricesIndices[3])*matricesWeights[3];
#endif
#if NUM_BONE_INFLUENCERS>4
influence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[0])*matricesWeightsExtra[0];
#endif
#if NUM_BONE_INFLUENCERS>5
influence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[1])*matricesWeightsExtra[1];
#endif
#if NUM_BONE_INFLUENCERS>6
influence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[2])*matricesWeightsExtra[2];
#endif
#if NUM_BONE_INFLUENCERS>7
influence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[3])*matricesWeightsExtra[3];
#endif
#else
influence=mBones[int(matricesIndices[0])]*matricesWeights[0];
#if NUM_BONE_INFLUENCERS>1
influence+=mBones[int(matricesIndices[1])]*matricesWeights[1];
#endif
#if NUM_BONE_INFLUENCERS>2
influence+=mBones[int(matricesIndices[2])]*matricesWeights[2];
#endif
#if NUM_BONE_INFLUENCERS>3
influence+=mBones[int(matricesIndices[3])]*matricesWeights[3];
#endif
#if NUM_BONE_INFLUENCERS>4
influence+=mBones[int(matricesIndicesExtra[0])]*matricesWeightsExtra[0];
#endif
#if NUM_BONE_INFLUENCERS>5
influence+=mBones[int(matricesIndicesExtra[1])]*matricesWeightsExtra[1];
#endif
#if NUM_BONE_INFLUENCERS>6
influence+=mBones[int(matricesIndicesExtra[2])]*matricesWeightsExtra[2];
#endif
#if NUM_BONE_INFLUENCERS>7
influence+=mBones[int(matricesIndicesExtra[3])]*matricesWeightsExtra[3];
#endif
#endif
finalWorld=finalWorld*influence;
#endif
#endif
`;ne.IncludesShadersStore[c4]=u4;const h4="bakedVertexAnimation",d4=`#ifdef BAKED_VERTEX_ANIMATION_TEXTURE
{
#ifdef INSTANCES
#define BVASNAME bakedVertexAnimationSettingsInstanced
#else
#define BVASNAME bakedVertexAnimationSettings
#endif
float VATStartFrame=BVASNAME.x;float VATEndFrame=BVASNAME.y;float VATOffsetFrame=BVASNAME.z;float VATSpeed=BVASNAME.w;float totalFrames=VATEndFrame-VATStartFrame+1.0;float time=bakedVertexAnimationTime*VATSpeed/totalFrames;float frameCorrection=time<1.0 ? 0.0 : 1.0;float numOfFrames=totalFrames-frameCorrection;float VATFrameNum=fract(time)*numOfFrames;VATFrameNum=mod(VATFrameNum+VATOffsetFrame,numOfFrames);VATFrameNum=floor(VATFrameNum);VATFrameNum+=VATStartFrame+frameCorrection;mat4 VATInfluence;VATInfluence=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[0],VATFrameNum)*matricesWeights[0];
#if NUM_BONE_INFLUENCERS>1
VATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[1],VATFrameNum)*matricesWeights[1];
#endif
#if NUM_BONE_INFLUENCERS>2
VATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[2],VATFrameNum)*matricesWeights[2];
#endif
#if NUM_BONE_INFLUENCERS>3
VATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[3],VATFrameNum)*matricesWeights[3];
#endif
#if NUM_BONE_INFLUENCERS>4
VATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[0],VATFrameNum)*matricesWeightsExtra[0];
#endif
#if NUM_BONE_INFLUENCERS>5
VATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[1],VATFrameNum)*matricesWeightsExtra[1];
#endif
#if NUM_BONE_INFLUENCERS>6
VATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[2],VATFrameNum)*matricesWeightsExtra[2];
#endif
#if NUM_BONE_INFLUENCERS>7
VATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[3],VATFrameNum)*matricesWeightsExtra[3];
#endif
finalWorld=finalWorld*VATInfluence;}
#endif
`;ne.IncludesShadersStore[h4]=d4;const f4="prePassVertex",_4=`#ifdef PREPASS_DEPTH
vViewPos=(view*worldPos).rgb;
#endif
#if defined(PREPASS_VELOCITY) && defined(BONES_VELOCITY_ENABLED)
vCurrentPosition=viewProjection*worldPos;
#if NUM_BONE_INFLUENCERS>0
mat4 previousInfluence;previousInfluence=mPreviousBones[int(matricesIndices[0])]*matricesWeights[0];
#if NUM_BONE_INFLUENCERS>1
previousInfluence+=mPreviousBones[int(matricesIndices[1])]*matricesWeights[1];
#endif 
#if NUM_BONE_INFLUENCERS>2
previousInfluence+=mPreviousBones[int(matricesIndices[2])]*matricesWeights[2];
#endif 
#if NUM_BONE_INFLUENCERS>3
previousInfluence+=mPreviousBones[int(matricesIndices[3])]*matricesWeights[3];
#endif
#if NUM_BONE_INFLUENCERS>4
previousInfluence+=mPreviousBones[int(matricesIndicesExtra[0])]*matricesWeightsExtra[0];
#endif 
#if NUM_BONE_INFLUENCERS>5
previousInfluence+=mPreviousBones[int(matricesIndicesExtra[1])]*matricesWeightsExtra[1];
#endif 
#if NUM_BONE_INFLUENCERS>6
previousInfluence+=mPreviousBones[int(matricesIndicesExtra[2])]*matricesWeightsExtra[2];
#endif 
#if NUM_BONE_INFLUENCERS>7
previousInfluence+=mPreviousBones[int(matricesIndicesExtra[3])]*matricesWeightsExtra[3];
#endif
vPreviousPosition=previousViewProjection*finalPreviousWorld*previousInfluence*vec4(positionUpdated,1.0);
#else
vPreviousPosition=previousViewProjection*finalPreviousWorld*vec4(positionUpdated,1.0);
#endif
#endif
`;ne.IncludesShadersStore[f4]=_4;const p4="uvVariableDeclaration",g4=`#if !defined(UV{X}) && defined(MAINUV{X})
vec2 uv{X}=vec2(0.,0.);
#endif
#ifdef MAINUV{X}
vMainUV{X}=uv{X};
#endif
`;ne.IncludesShadersStore[p4]=g4;const m4="samplerVertexImplementation",v4=`#if defined(_DEFINENAME_) && _DEFINENAME_DIRECTUV==0
if (v_INFONAME_==0.)
{v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uvUpdated,1.0,0.0));}
#ifdef UV2
else if (v_INFONAME_==1.)
{v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv2,1.0,0.0));}
#endif
#ifdef UV3
else if (v_INFONAME_==2.)
{v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv3,1.0,0.0));}
#endif
#ifdef UV4
else if (v_INFONAME_==3.)
{v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv4,1.0,0.0));}
#endif
#ifdef UV5
else if (v_INFONAME_==4.)
{v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv5,1.0,0.0));}
#endif
#ifdef UV6
else if (v_INFONAME_==5.)
{v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv6,1.0,0.0));}
#endif
#endif
`;ne.IncludesShadersStore[m4]=v4;const E4="bumpVertex",y4=`#if defined(BUMP) || defined(PARALLAX) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC)
#if defined(TANGENT) && defined(NORMAL)
vec3 tbnNormal=normalize(normalUpdated);vec3 tbnTangent=normalize(tangentUpdated.xyz);vec3 tbnBitangent=cross(tbnNormal,tbnTangent)*tangentUpdated.w;vTBN=mat3(finalWorld)*mat3(tbnTangent,tbnBitangent,tbnNormal);
#endif
#endif
`;ne.IncludesShadersStore[E4]=y4;const T4="clipPlaneVertex",b4=`#ifdef CLIPPLANE
fClipDistance=dot(worldPos,vClipPlane);
#endif
#ifdef CLIPPLANE2
fClipDistance2=dot(worldPos,vClipPlane2);
#endif
#ifdef CLIPPLANE3
fClipDistance3=dot(worldPos,vClipPlane3);
#endif
#ifdef CLIPPLANE4
fClipDistance4=dot(worldPos,vClipPlane4);
#endif
#ifdef CLIPPLANE5
fClipDistance5=dot(worldPos,vClipPlane5);
#endif
#ifdef CLIPPLANE6
fClipDistance6=dot(worldPos,vClipPlane6);
#endif
`;ne.IncludesShadersStore[T4]=b4;const C4="fogVertex",A4=`#ifdef FOG
vFogDistance=(view*worldPos).xyz;
#endif
`;ne.IncludesShadersStore[C4]=A4;const S4="shadowsVertex",R4=`#ifdef SHADOWS
#if defined(SHADOWCSM{X})
vPositionFromCamera{X}=view*worldPos;for (int i=0; i<SHADOWCSMNUM_CASCADES{X}; i++) {vPositionFromLight{X}[i]=lightMatrix{X}[i]*worldPos;
#ifdef USE_REVERSE_DEPTHBUFFER
vDepthMetric{X}[i]=(-vPositionFromLight{X}[i].z+light{X}.depthValues.x)/light{X}.depthValues.y;
#else
vDepthMetric{X}[i]=(vPositionFromLight{X}[i].z+light{X}.depthValues.x)/light{X}.depthValues.y;
#endif
}
#elif defined(SHADOW{X}) && !defined(SHADOWCUBE{X})
vPositionFromLight{X}=lightMatrix{X}*worldPos;
#ifdef USE_REVERSE_DEPTHBUFFER
vDepthMetric{X}=(-vPositionFromLight{X}.z+light{X}.depthValues.x)/light{X}.depthValues.y;
#else
vDepthMetric{X}=(vPositionFromLight{X}.z+light{X}.depthValues.x)/light{X}.depthValues.y;
#endif
#endif
#endif
`;ne.IncludesShadersStore[S4]=R4;const x4="vertexColorMixing",M4=`#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)
vColor=vec4(1.0);
#ifdef VERTEXCOLOR
#ifdef VERTEXALPHA
vColor*=color;
#else
vColor.rgb*=color.rgb;
#endif
#endif
#ifdef INSTANCESCOLOR
vColor*=instanceColor;
#endif
#endif
`;ne.IncludesShadersStore[x4]=M4;const I4="pointCloudVertex",P4=`#if defined(POINTSIZE) && !defined(WEBGPU)
gl_PointSize=pointSize;
#endif
`;ne.IncludesShadersStore[I4]=P4;const w4="logDepthVertex",O4=`#ifdef LOGARITHMICDEPTH
vFragmentDepth=1.0+gl_Position.w;gl_Position.z=log2(max(0.000001,vFragmentDepth))*logarithmicDepthConstant;
#endif
`;ne.IncludesShadersStore[w4]=O4;const D4="defaultVertexShader",L4=`#include<__decl__defaultVertex>
#define CUSTOM_VERTEX_BEGIN
attribute vec3 position;
#ifdef NORMAL
attribute vec3 normal;
#endif
#ifdef TANGENT
attribute vec4 tangent;
#endif
#ifdef UV1
attribute vec2 uv;
#endif
#include<uvAttributeDeclaration>[2..7]
#ifdef VERTEXCOLOR
attribute vec4 color;
#endif
#include<helperFunctions>
#include<bonesDeclaration>
#include<bakedVertexAnimationDeclaration>
#include<instancesDeclaration>
#include<prePassVertexDeclaration>
#include<mainUVVaryingDeclaration>[1..7]
#include<samplerVertexDeclaration>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse)
#include<samplerVertexDeclaration>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail)
#include<samplerVertexDeclaration>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient)
#include<samplerVertexDeclaration>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity)
#include<samplerVertexDeclaration>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive)
#include<samplerVertexDeclaration>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap)
#if defined(SPECULARTERM)
#include<samplerVertexDeclaration>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular)
#endif
#include<samplerVertexDeclaration>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump)
#include<samplerVertexDeclaration>(_DEFINENAME_,DECAL,_VARYINGNAME_,Decal)
varying vec3 vPositionW;
#ifdef NORMAL
varying vec3 vNormalW;
#endif
#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)
varying vec4 vColor;
#endif
#include<bumpVertexDeclaration>
#include<clipPlaneVertexDeclaration>
#include<fogVertexDeclaration>
#include<__decl__lightVxFragment>[0..maxSimultaneousLights]
#include<morphTargetsVertexGlobalDeclaration>
#include<morphTargetsVertexDeclaration>[0..maxSimultaneousMorphTargets]
#ifdef REFLECTIONMAP_SKYBOX
varying vec3 vPositionUVW;
#endif
#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)
varying vec3 vDirectionW;
#endif
#include<logDepthDeclaration>
#define CUSTOM_VERTEX_DEFINITIONS
void main(void) {
#define CUSTOM_VERTEX_MAIN_BEGIN
vec3 positionUpdated=position;
#ifdef NORMAL
vec3 normalUpdated=normal;
#endif
#ifdef TANGENT
vec4 tangentUpdated=tangent;
#endif
#ifdef UV1
vec2 uvUpdated=uv;
#endif
#include<morphTargetsVertexGlobal>
#include<morphTargetsVertex>[0..maxSimultaneousMorphTargets]
#ifdef REFLECTIONMAP_SKYBOX
vPositionUVW=positionUpdated;
#endif
#define CUSTOM_VERTEX_UPDATE_POSITION
#define CUSTOM_VERTEX_UPDATE_NORMAL
#include<instancesVertex>
#if defined(PREPASS) && defined(PREPASS_VELOCITY) && !defined(BONES_VELOCITY_ENABLED)
vCurrentPosition=viewProjection*finalWorld*vec4(positionUpdated,1.0);vPreviousPosition=previousViewProjection*finalPreviousWorld*vec4(positionUpdated,1.0);
#endif
#include<bonesVertex>
#include<bakedVertexAnimation>
vec4 worldPos=finalWorld*vec4(positionUpdated,1.0);
#ifdef NORMAL
mat3 normalWorld=mat3(finalWorld);
#if defined(INSTANCES) && defined(THIN_INSTANCES)
vNormalW=normalUpdated/vec3(dot(normalWorld[0],normalWorld[0]),dot(normalWorld[1],normalWorld[1]),dot(normalWorld[2],normalWorld[2]));vNormalW=normalize(normalWorld*vNormalW);
#else
#ifdef NONUNIFORMSCALING
normalWorld=transposeMat3(inverseMat3(normalWorld));
#endif
vNormalW=normalize(normalWorld*normalUpdated);
#endif
#endif
#define CUSTOM_VERTEX_UPDATE_WORLDPOS
#ifdef MULTIVIEW
if (gl_ViewID_OVR==0u) {gl_Position=viewProjection*worldPos;} else {gl_Position=viewProjectionR*worldPos;}
#else
gl_Position=viewProjection*worldPos;
#endif
vPositionW=vec3(worldPos);
#include<prePassVertex>
#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)
vDirectionW=normalize(vec3(finalWorld*vec4(positionUpdated,0.0)));
#endif
#ifndef UV1
vec2 uvUpdated=vec2(0.,0.);
#endif
#ifdef MAINUV1
vMainUV1=uvUpdated;
#endif
#include<uvVariableDeclaration>[2..7]
#include<samplerVertexImplementation>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse,_MATRIXNAME_,diffuse,_INFONAME_,DiffuseInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail,_MATRIXNAME_,detail,_INFONAME_,DetailInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient,_MATRIXNAME_,ambient,_INFONAME_,AmbientInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity,_MATRIXNAME_,opacity,_INFONAME_,OpacityInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive,_MATRIXNAME_,emissive,_INFONAME_,EmissiveInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap,_MATRIXNAME_,lightmap,_INFONAME_,LightmapInfos.x)
#if defined(SPECULARTERM)
#include<samplerVertexImplementation>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular,_MATRIXNAME_,specular,_INFONAME_,SpecularInfos.x)
#endif
#include<samplerVertexImplementation>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump,_MATRIXNAME_,bump,_INFONAME_,BumpInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,DECAL,_VARYINGNAME_,Decal,_MATRIXNAME_,decal,_INFONAME_,DecalInfos.x)
#include<bumpVertex>
#include<clipPlaneVertex>
#include<fogVertex>
#include<shadowsVertex>[0..maxSimultaneousLights]
#include<vertexColorMixing>
#include<pointCloudVertex>
#include<logDepthVertex>
#define CUSTOM_VERTEX_MAIN_END
}
`;ne.ShadersStore[D4]=L4;class Rm{constructor(){this._defines={},this._currentRank=32,this._maxRank=-1,this._mesh=null}unBindMesh(){this._mesh=null}addFallback(e,t){this._defines[e]||(e<this._currentRank&&(this._currentRank=e),e>this._maxRank&&(this._maxRank=e),this._defines[e]=new Array),this._defines[e].push(t)}addCPUSkinningFallback(e,t){this._mesh=t,e<this._currentRank&&(this._currentRank=e),e>this._maxRank&&(this._maxRank=e)}get hasMoreFallbacks(){return this._currentRank<=this._maxRank}reduce(e,t){if(this._mesh&&this._mesh.computeBonesUsingShaders&&this._mesh.numBoneInfluencers>0){this._mesh.computeBonesUsingShaders=!1,e=e.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),t._bonesComputationForcedToCPU=!0;const i=this._mesh.getScene();for(let r=0;r<i.meshes.length;r++){const s=i.meshes[r];if(!s.material){!this._mesh.material&&s.computeBonesUsingShaders&&s.numBoneInfluencers>0&&(s.computeBonesUsingShaders=!1);continue}if(!(!s.computeBonesUsingShaders||s.numBoneInfluencers===0)){if(s.material.getEffect()===t)s.computeBonesUsingShaders=!1;else if(s.subMeshes){for(const a of s.subMeshes)if(a.effect===t){s.computeBonesUsingShaders=!1;break}}}}}else{const i=this._defines[this._currentRank];if(i)for(let r=0;r<i.length;r++)e=e.replace("#define "+i[r],"");this._currentRank++}return e}}const N4=new RegExp("^([gimus]+)!");class va{constructor(e){this._plugins=[],this._activePlugins=[],this._activePluginsForExtraEvents=[],this._material=e,this._scene=e.getScene(),this._engine=this._scene.getEngine()}_addPlugin(e){for(let r=0;r<this._plugins.length;++r)if(this._plugins[r].name===e.name)return!1;if(this._material._uniformBufferLayoutBuilt)throw`The plugin "${e.name}" can't be added to the material "${this._material.name}" because this material has already been used for rendering! Please add plugins to materials before any rendering with this material occurs.`;const t=e.getClassName();va._MaterialPluginClassToMainDefine[t]||(va._MaterialPluginClassToMainDefine[t]="MATERIALPLUGIN_"+ ++va._MaterialPluginCounter),this._material._callbackPluginEventGeneric=(r,s)=>this._handlePluginEvent(r,s),this._plugins.push(e),this._plugins.sort((r,s)=>r.priority-s.priority),this._codeInjectionPoints={};const i={};i[va._MaterialPluginClassToMainDefine[t]]={type:"boolean",default:!0};for(const r of this._plugins)r.collectDefines(i),this._collectPointNames("vertex",r.getCustomCode("vertex")),this._collectPointNames("fragment",r.getCustomCode("fragment"));return this._defineNamesFromPlugins=i,!0}_activatePlugin(e){this._activePlugins.indexOf(e)===-1&&(this._activePlugins.push(e),this._activePlugins.sort((t,i)=>t.priority-i.priority),this._material._callbackPluginEventIsReadyForSubMesh=this._handlePluginEventIsReadyForSubMesh.bind(this),this._material._callbackPluginEventPrepareDefinesBeforeAttributes=this._handlePluginEventPrepareDefinesBeforeAttributes.bind(this),this._material._callbackPluginEventPrepareDefines=this._handlePluginEventPrepareDefines.bind(this),this._material._callbackPluginEventBindForSubMesh=this._handlePluginEventBindForSubMesh.bind(this),e.registerForExtraEvents&&(this._activePluginsForExtraEvents.push(e),this._activePluginsForExtraEvents.sort((t,i)=>t.priority-i.priority),this._material._callbackPluginEventHasRenderTargetTextures=this._handlePluginEventHasRenderTargetTextures.bind(this),this._material._callbackPluginEventFillRenderTargetTextures=this._handlePluginEventFillRenderTargetTextures.bind(this),this._material._callbackPluginEventHardBindForSubMesh=this._handlePluginEventHardBindForSubMesh.bind(this)))}getPlugin(e){for(let t=0;t<this._plugins.length;++t)if(this._plugins[t].name===e)return this._plugins[t];return null}_handlePluginEventIsReadyForSubMesh(e){let t=!0;for(const i of this._activePlugins)t=t&&i.isReadyForSubMesh(e.defines,this._scene,this._engine,e.subMesh);e.isReadyForSubMesh=t}_handlePluginEventPrepareDefinesBeforeAttributes(e){for(const t of this._activePlugins)t.prepareDefinesBeforeAttributes(e.defines,this._scene,e.mesh)}_handlePluginEventPrepareDefines(e){for(const t of this._activePlugins)t.prepareDefines(e.defines,this._scene,e.mesh)}_handlePluginEventHardBindForSubMesh(e){for(const t of this._activePluginsForExtraEvents)t.hardBindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,e.subMesh)}_handlePluginEventBindForSubMesh(e){for(const t of this._activePlugins)t.bindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,e.subMesh)}_handlePluginEventHasRenderTargetTextures(e){let t=!1;for(const i of this._activePluginsForExtraEvents)if(t=i.hasRenderTargetTextures(),t)break;e.hasRenderTargetTextures=t}_handlePluginEventFillRenderTargetTextures(e){for(const t of this._activePluginsForExtraEvents)t.fillRenderTargetTextures(e.renderTargets)}_handlePluginEvent(e,t){switch(e){case zi.GetActiveTextures:{const i=t;for(const r of this._activePlugins)r.getActiveTextures(i.activeTextures);break}case zi.GetAnimatables:{const i=t;for(const r of this._activePlugins)r.getAnimatables(i.animatables);break}case zi.HasTexture:{const i=t;let r=!1;for(const s of this._activePlugins)if(r=s.hasTexture(i.texture),r)break;i.hasTexture=r;break}case zi.Disposed:{const i=t;for(const r of this._plugins)r.dispose(i.forceDisposeTextures);break}case zi.GetDefineNames:{const i=t;i.defineNames=this._defineNamesFromPlugins;break}case zi.PrepareEffect:{const i=t;for(const r of this._activePlugins)i.fallbackRank=r.addFallbacks(i.defines,i.fallbacks,i.fallbackRank),r.getAttributes(i.attributes,this._scene,i.mesh);this._uniformList.length>0&&i.uniforms.push(...this._uniformList),this._samplerList.length>0&&i.samplers.push(...this._samplerList),this._uboList.length>0&&i.uniformBuffersNames.push(...this._uboList),i.customCode=this._injectCustomCode(i,i.customCode);break}case zi.PrepareUniformBuffer:{const i=t;this._uboDeclaration="",this._vertexDeclaration="",this._fragmentDeclaration="",this._uniformList=[],this._samplerList=[],this._uboList=[];for(const r of this._plugins){const s=r.getUniforms();if(s){if(s.ubo)for(const a of s.ubo){if(a.size&&a.type){const l=a.arraySize??0;i.ubo.addUniform(a.name,a.size,l),this._uboDeclaration+=`${a.type} ${a.name}${l>0?`[${l}]`:""};
`}this._uniformList.push(a.name)}s.vertex&&(this._vertexDeclaration+=s.vertex+`
`),s.fragment&&(this._fragmentDeclaration+=s.fragment+`
`)}r.getSamplers(this._samplerList),r.getUniformBuffersNames(this._uboList)}break}}}_collectPointNames(e,t){if(t)for(const i in t)this._codeInjectionPoints[e]||(this._codeInjectionPoints[e]={}),this._codeInjectionPoints[e][i]=!0}_injectCustomCode(e,t){return(i,r)=>{var l,o;t&&(r=t(i,r)),this._uboDeclaration&&(r=r.replace("#define ADDITIONAL_UBO_DECLARATION",this._uboDeclaration)),this._vertexDeclaration&&(r=r.replace("#define ADDITIONAL_VERTEX_DECLARATION",this._vertexDeclaration)),this._fragmentDeclaration&&(r=r.replace("#define ADDITIONAL_FRAGMENT_DECLARATION",this._fragmentDeclaration));const s=(l=this._codeInjectionPoints)==null?void 0:l[i];if(!s)return r;let a=null;for(let c in s){let u="";for(const h of this._activePlugins){let d=(o=h.getCustomCode(i))==null?void 0:o[c];if(d){if(h.resolveIncludes){if(a===null){const f=Oi.GLSL;a={defines:[],indexParameters:e.indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:void 0,supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:ne.GetShadersRepository(f),includesShadersStore:ne.GetIncludesShadersStore(f),version:void 0,platformName:this._engine.shaderPlatformName,processingContext:void 0,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:void 0}}a.isFragment=i==="fragment",is._ProcessIncludes(d,a,f=>d=f)}u+=d+`
`}}if(u.length>0)if(c.charAt(0)==="!"){c=c.substring(1);let h="g";if(c.charAt(0)==="!")h="",c=c.substring(1);else{const p=N4.exec(c);p&&p.length>=2&&(h=p[1],c=c.substring(h.length+1))}h.indexOf("g")<0&&(h+="g");const d=r,f=new RegExp(c,h);let _=f.exec(d);for(;_!==null;){let p=u;for(let v=0;v<_.length;++v)p=p.replace("$"+v,_[v]);r=r.replace(_[0],p),_=f.exec(d)}}else{const h="#define "+c;r=r.replace(h,`
`+u+`
`+h)}}return r}}}va._MaterialPluginClassToMainDefine={};va._MaterialPluginCounter=0;He.OnEnginesDisposedObservable.add(()=>{k4()});const F4=[];let cE=null;function k4(){F4.length=0,j.OnEventObservable.remove(cE),cE=null}class Gn{_enable(e){e&&this._pluginManager._activatePlugin(this)}constructor(e,t,i,r,s=!0,a=!1,l=!1){this.priority=500,this.resolveIncludes=!1,this.registerForExtraEvents=!1,this._material=e,this.name=t,this.priority=i,this.resolveIncludes=l,e.pluginManager||(e.pluginManager=new va(e),e.onDisposeObservable.add(()=>{e.pluginManager=void 0})),this._pluginDefineNames=r,this._pluginManager=e.pluginManager,s&&this._pluginManager._addPlugin(this),a&&this._enable(!0),this.markAllDefinesAsDirty=e._dirtyCallbacks[63]}getClassName(){return"MaterialPluginBase"}isReadyForSubMesh(e,t,i,r){return!0}hardBindForSubMesh(e,t,i,r){}bindForSubMesh(e,t,i,r){}dispose(e){}getCustomCode(e){return null}collectDefines(e){if(this._pluginDefineNames)for(const t of Object.keys(this._pluginDefineNames)){if(t[0]==="_")continue;const i=typeof this._pluginDefineNames[t];e[t]={type:i==="number"?"number":i==="string"?"string":i==="boolean"?"boolean":"object",default:this._pluginDefineNames[t]}}}prepareDefinesBeforeAttributes(e,t,i){}prepareDefines(e,t,i){}hasTexture(e){return!1}hasRenderTargetTextures(){return!1}fillRenderTargetTextures(e){}getActiveTextures(e){}getAnimatables(e){}addFallbacks(e,t,i){return i}getSamplers(e){}getAttributes(e,t,i){}getUniformBuffersNames(e){}getUniforms(){return{}}copyTo(e){Fe.Clone(()=>e,this)}serialize(){return Fe.Serialize(this)}parse(e,t,i){Fe.Parse(()=>this,e,t,i)}}R([I()],Gn.prototype,"name",void 0);R([I()],Gn.prototype,"priority",void 0);R([I()],Gn.prototype,"resolveIncludes",void 0);R([I()],Gn.prototype,"registerForExtraEvents",void 0);class B4 extends Ws{constructor(){super(...arguments),this.DETAIL=!1,this.DETAILDIRECTUV=0,this.DETAIL_NORMALBLENDMETHOD=0}}class za extends Gn{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}constructor(e,t=!0){super(e,"DetailMap",140,new B4,t),this._texture=null,this.diffuseBlendLevel=1,this.roughnessBlendLevel=1,this.bumpLevel=1,this._normalBlendMethod=j.MATERIAL_NORMALBLENDMETHOD_WHITEOUT,this._isEnabled=!1,this.isEnabled=!1,this._internalMarkAllSubMeshesAsTexturesDirty=e._dirtyCallbacks[1]}isReadyForSubMesh(e,t,i){return this._isEnabled?!(e._areTexturesDirty&&t.texturesEnabled&&i.getCaps().standardDerivatives&&this._texture&&te.DetailTextureEnabled&&!this._texture.isReady()):!0}prepareDefines(e,t){if(this._isEnabled){e.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod;const i=t.getEngine();e._areTexturesDirty&&(i.getCaps().standardDerivatives&&this._texture&&te.DetailTextureEnabled&&this._isEnabled?(Bt(this._texture,e,"DETAIL"),e.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod):e.DETAIL=!1)}else e.DETAIL=!1}bindForSubMesh(e,t){if(!this._isEnabled)return;const i=this._material.isFrozen;(!e.useUbo||!i||!e.isSync)&&this._texture&&te.DetailTextureEnabled&&(e.updateFloat4("vDetailInfos",this._texture.coordinatesIndex,this.diffuseBlendLevel,this.bumpLevel,this.roughnessBlendLevel),Dt(this._texture,e,"detail")),t.texturesEnabled&&this._texture&&te.DetailTextureEnabled&&e.setTexture("detailSampler",this._texture)}hasTexture(e){return this._texture===e}getActiveTextures(e){this._texture&&e.push(this._texture)}getAnimatables(e){this._texture&&this._texture.animations&&this._texture.animations.length>0&&e.push(this._texture)}dispose(e){var t;e&&((t=this._texture)==null||t.dispose())}getClassName(){return"DetailMapConfiguration"}getSamplers(e){e.push("detailSampler")}getUniforms(){return{ubo:[{name:"vDetailInfos",size:4,type:"vec4"},{name:"detailMatrix",size:16,type:"mat4"}]}}}R([At("detailTexture"),ie("_markAllSubMeshesAsTexturesDirty")],za.prototype,"texture",void 0);R([I()],za.prototype,"diffuseBlendLevel",void 0);R([I()],za.prototype,"roughnessBlendLevel",void 0);R([I()],za.prototype,"bumpLevel",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],za.prototype,"normalBlendMethod",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],za.prototype,"isEnabled",void 0);const O_={effect:null,subMesh:null};class U4 extends Ws{constructor(e){super(e),this.MAINUV1=!1,this.MAINUV2=!1,this.MAINUV3=!1,this.MAINUV4=!1,this.MAINUV5=!1,this.MAINUV6=!1,this.DIFFUSE=!1,this.DIFFUSEDIRECTUV=0,this.BAKED_VERTEX_ANIMATION_TEXTURE=!1,this.AMBIENT=!1,this.AMBIENTDIRECTUV=0,this.OPACITY=!1,this.OPACITYDIRECTUV=0,this.OPACITYRGB=!1,this.REFLECTION=!1,this.EMISSIVE=!1,this.EMISSIVEDIRECTUV=0,this.SPECULAR=!1,this.SPECULARDIRECTUV=0,this.BUMP=!1,this.BUMPDIRECTUV=0,this.PARALLAX=!1,this.PARALLAX_RHS=!1,this.PARALLAXOCCLUSION=!1,this.SPECULAROVERALPHA=!1,this.CLIPPLANE=!1,this.CLIPPLANE2=!1,this.CLIPPLANE3=!1,this.CLIPPLANE4=!1,this.CLIPPLANE5=!1,this.CLIPPLANE6=!1,this.ALPHATEST=!1,this.DEPTHPREPASS=!1,this.ALPHAFROMDIFFUSE=!1,this.POINTSIZE=!1,this.FOG=!1,this.SPECULARTERM=!1,this.DIFFUSEFRESNEL=!1,this.OPACITYFRESNEL=!1,this.REFLECTIONFRESNEL=!1,this.REFRACTIONFRESNEL=!1,this.EMISSIVEFRESNEL=!1,this.FRESNEL=!1,this.NORMAL=!1,this.TANGENT=!1,this.UV1=!1,this.UV2=!1,this.UV3=!1,this.UV4=!1,this.UV5=!1,this.UV6=!1,this.VERTEXCOLOR=!1,this.VERTEXALPHA=!1,this.NUM_BONE_INFLUENCERS=0,this.BonesPerMesh=0,this.BONETEXTURE=!1,this.BONES_VELOCITY_ENABLED=!1,this.INSTANCES=!1,this.THIN_INSTANCES=!1,this.INSTANCESCOLOR=!1,this.GLOSSINESS=!1,this.ROUGHNESS=!1,this.EMISSIVEASILLUMINATION=!1,this.LINKEMISSIVEWITHDIFFUSE=!1,this.REFLECTIONFRESNELFROMSPECULAR=!1,this.LIGHTMAP=!1,this.LIGHTMAPDIRECTUV=0,this.OBJECTSPACE_NORMALMAP=!1,this.USELIGHTMAPASSHADOWMAP=!1,this.REFLECTIONMAP_3D=!1,this.REFLECTIONMAP_SPHERICAL=!1,this.REFLECTIONMAP_PLANAR=!1,this.REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFRACTIONMAP_CUBIC=!1,this.REFLECTIONMAP_PROJECTION=!1,this.REFLECTIONMAP_SKYBOX=!1,this.REFLECTIONMAP_EXPLICIT=!1,this.REFLECTIONMAP_EQUIRECTANGULAR=!1,this.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_OPPOSITEZ=!1,this.INVERTCUBICMAP=!1,this.LOGARITHMICDEPTH=!1,this.REFRACTION=!1,this.REFRACTIONMAP_3D=!1,this.REFLECTIONOVERALPHA=!1,this.TWOSIDEDLIGHTING=!1,this.SHADOWFLOAT=!1,this.MORPHTARGETS=!1,this.MORPHTARGETS_NORMAL=!1,this.MORPHTARGETS_TANGENT=!1,this.MORPHTARGETS_UV=!1,this.NUM_MORPH_INFLUENCERS=0,this.MORPHTARGETS_TEXTURE=!1,this.NONUNIFORMSCALING=!1,this.PREMULTIPLYALPHA=!1,this.ALPHATEST_AFTERALLALPHACOMPUTATIONS=!1,this.ALPHABLEND=!0,this.PREPASS=!1,this.PREPASS_IRRADIANCE=!1,this.PREPASS_IRRADIANCE_INDEX=-1,this.PREPASS_ALBEDO_SQRT=!1,this.PREPASS_ALBEDO_SQRT_INDEX=-1,this.PREPASS_DEPTH=!1,this.PREPASS_DEPTH_INDEX=-1,this.PREPASS_NORMAL=!1,this.PREPASS_NORMAL_INDEX=-1,this.PREPASS_NORMAL_WORLDSPACE=!1,this.PREPASS_POSITION=!1,this.PREPASS_POSITION_INDEX=-1,this.PREPASS_VELOCITY=!1,this.PREPASS_VELOCITY_INDEX=-1,this.PREPASS_REFLECTIVITY=!1,this.PREPASS_REFLECTIVITY_INDEX=-1,this.SCENE_MRT_COUNT=0,this.RGBDLIGHTMAP=!1,this.RGBDREFLECTION=!1,this.RGBDREFRACTION=!1,this.IMAGEPROCESSING=!1,this.VIGNETTE=!1,this.VIGNETTEBLENDMODEMULTIPLY=!1,this.VIGNETTEBLENDMODEOPAQUE=!1,this.TONEMAPPING=!1,this.TONEMAPPING_ACES=!1,this.CONTRAST=!1,this.COLORCURVES=!1,this.COLORGRADING=!1,this.COLORGRADING3D=!1,this.SAMPLER3DGREENDEPTH=!1,this.SAMPLER3DBGRMAP=!1,this.DITHER=!1,this.IMAGEPROCESSINGPOSTPROCESS=!1,this.SKIPFINALCOLORCLAMP=!1,this.MULTIVIEW=!1,this.ORDER_INDEPENDENT_TRANSPARENCY=!1,this.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!1,this.CAMERA_ORTHOGRAPHIC=!1,this.CAMERA_PERSPECTIVE=!1,this.IS_REFLECTION_LINEAR=!1,this.IS_REFRACTION_LINEAR=!1,this.EXPOSURE=!1,this.DECAL_AFTER_DETAIL=!1,this.rebuild()}setReflectionMode(e){const t=["REFLECTIONMAP_CUBIC","REFLECTIONMAP_EXPLICIT","REFLECTIONMAP_PLANAR","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_SKYBOX","REFLECTIONMAP_SPHERICAL","REFLECTIONMAP_EQUIRECTANGULAR","REFLECTIONMAP_EQUIRECTANGULAR_FIXED","REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED"];for(const i of t)this[i]=i===e}}class le extends Sm{get imageProcessingConfiguration(){return this._imageProcessingConfiguration}set imageProcessingConfiguration(e){this._attachImageProcessingConfiguration(e),this._markAllSubMeshesAsTexturesDirty()}_attachImageProcessingConfiguration(e){e!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),e?this._imageProcessingConfiguration=e:this._imageProcessingConfiguration=this.getScene().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add(()=>{this._markAllSubMeshesAsImageProcessingDirty()})))}get isPrePassCapable(){return!this.disableDepthWrite}get cameraColorCurvesEnabled(){return this.imageProcessingConfiguration.colorCurvesEnabled}set cameraColorCurvesEnabled(e){this.imageProcessingConfiguration.colorCurvesEnabled=e}get cameraColorGradingEnabled(){return this.imageProcessingConfiguration.colorGradingEnabled}set cameraColorGradingEnabled(e){this.imageProcessingConfiguration.colorGradingEnabled=e}get cameraToneMappingEnabled(){return this._imageProcessingConfiguration.toneMappingEnabled}set cameraToneMappingEnabled(e){this._imageProcessingConfiguration.toneMappingEnabled=e}get cameraExposure(){return this._imageProcessingConfiguration.exposure}set cameraExposure(e){this._imageProcessingConfiguration.exposure=e}get cameraContrast(){return this._imageProcessingConfiguration.contrast}set cameraContrast(e){this._imageProcessingConfiguration.contrast=e}get cameraColorGradingTexture(){return this._imageProcessingConfiguration.colorGradingTexture}set cameraColorGradingTexture(e){this._imageProcessingConfiguration.colorGradingTexture=e}get cameraColorCurves(){return this._imageProcessingConfiguration.colorCurves}set cameraColorCurves(e){this._imageProcessingConfiguration.colorCurves=e}get canRenderToMRT(){return!0}constructor(e,t){super(e,t),this._diffuseTexture=null,this._ambientTexture=null,this._opacityTexture=null,this._reflectionTexture=null,this._emissiveTexture=null,this._specularTexture=null,this._bumpTexture=null,this._lightmapTexture=null,this._refractionTexture=null,this.ambientColor=new Pe(0,0,0),this.diffuseColor=new Pe(1,1,1),this.specularColor=new Pe(1,1,1),this.emissiveColor=new Pe(0,0,0),this.specularPower=64,this._useAlphaFromDiffuseTexture=!1,this._useEmissiveAsIllumination=!1,this._linkEmissiveWithDiffuse=!1,this._useSpecularOverAlpha=!1,this._useReflectionOverAlpha=!1,this._disableLighting=!1,this._useObjectSpaceNormalMap=!1,this._useParallax=!1,this._useParallaxOcclusion=!1,this.parallaxScaleBias=.05,this._roughness=0,this.indexOfRefraction=.98,this.invertRefractionY=!0,this.alphaCutOff=.4,this._useLightmapAsShadowmap=!1,this._useReflectionFresnelFromSpecular=!1,this._useGlossinessFromSpecularMapAlpha=!1,this._maxSimultaneousLights=4,this._invertNormalMapX=!1,this._invertNormalMapY=!1,this._twoSidedLighting=!1,this._applyDecalMapAfterDetailMap=!1,this._renderTargets=new or(16),this._worldViewProjectionMatrix=z.Zero(),this._globalAmbientColor=new Pe(0,0,0),this._cacheHasRenderTargetTextures=!1,this.detailMap=new za(this),this._attachImageProcessingConfiguration(null),this.prePassConfiguration=new td,this.getRenderTargetTextures=()=>(this._renderTargets.reset(),le.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget&&this._renderTargets.push(this._reflectionTexture),le.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget&&this._renderTargets.push(this._refractionTexture),this._eventInfo.renderTargets=this._renderTargets,this._callbackPluginEventFillRenderTargetTextures(this._eventInfo),this._renderTargets)}get hasRenderTargetTextures(){return le.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget||le.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget?!0:this._cacheHasRenderTargetTextures}getClassName(){return"StandardMaterial"}needAlphaBlending(){return this._disableAlphaBlending?!1:this.alpha<1||this._opacityTexture!=null||this._shouldUseAlphaFromDiffuseTexture()||this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled}needAlphaTesting(){return this._forceAlphaTest?!0:this._hasAlphaChannel()&&(this._transparencyMode==null||this._transparencyMode===j.MATERIAL_ALPHATEST)}_shouldUseAlphaFromDiffuseTexture(){return this._diffuseTexture!=null&&this._diffuseTexture.hasAlpha&&this._useAlphaFromDiffuseTexture&&this._transparencyMode!==j.MATERIAL_OPAQUE}_hasAlphaChannel(){return this._diffuseTexture!=null&&this._diffuseTexture.hasAlpha||this._opacityTexture!=null}getAlphaTestTexture(){return this._diffuseTexture}isReadyForSubMesh(e,t,i=!1){this._uniformBufferLayoutBuilt||this.buildUniformLayout();const r=t._drawWrapper;if(r.effect&&this.isFrozen&&r._wasPreviouslyReady&&r._wasPreviouslyUsingInstances===i)return!0;t.materialDefines||(this._callbackPluginEventGeneric(zi.GetDefineNames,this._eventInfo),t.materialDefines=new U4(this._eventInfo.defineNames));const s=this.getScene(),a=t.materialDefines;if(this._isReadyForSubMesh(t))return!0;const l=s.getEngine();a._needNormals=x1(s,e,a,!0,this._maxSimultaneousLights,this._disableLighting),P1(s,a);const o=this.needAlphaBlendingForMesh(e)&&this.getScene().useOrderIndependentTransparency;if(O1(s,a,this.canRenderToMRT&&!o),w1(s,a,o),a._areTexturesDirty){this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._cacheHasRenderTargetTextures=this._eventInfo.hasRenderTargetTextures,a._needUVs=!1;for(let u=1;u<=6;++u)a["MAINUV"+u]=!1;if(s.texturesEnabled){if(a.DIFFUSEDIRECTUV=0,a.BUMPDIRECTUV=0,a.AMBIENTDIRECTUV=0,a.OPACITYDIRECTUV=0,a.EMISSIVEDIRECTUV=0,a.SPECULARDIRECTUV=0,a.LIGHTMAPDIRECTUV=0,this._diffuseTexture&&le.DiffuseTextureEnabled)if(this._diffuseTexture.isReadyOrNotBlocking())Bt(this._diffuseTexture,a,"DIFFUSE");else return!1;else a.DIFFUSE=!1;if(this._ambientTexture&&le.AmbientTextureEnabled)if(this._ambientTexture.isReadyOrNotBlocking())Bt(this._ambientTexture,a,"AMBIENT");else return!1;else a.AMBIENT=!1;if(this._opacityTexture&&le.OpacityTextureEnabled)if(this._opacityTexture.isReadyOrNotBlocking())Bt(this._opacityTexture,a,"OPACITY"),a.OPACITYRGB=this._opacityTexture.getAlphaFromRGB;else return!1;else a.OPACITY=!1;if(this._reflectionTexture&&le.ReflectionTextureEnabled)if(this._reflectionTexture.isReadyOrNotBlocking()){switch(a._needNormals=!0,a.REFLECTION=!0,a.ROUGHNESS=this._roughness>0,a.REFLECTIONOVERALPHA=this._useReflectionOverAlpha,a.INVERTCUBICMAP=this._reflectionTexture.coordinatesMode===re.INVCUBIC_MODE,a.REFLECTIONMAP_3D=this._reflectionTexture.isCube,a.REFLECTIONMAP_OPPOSITEZ=a.REFLECTIONMAP_3D&&this.getScene().useRightHandedSystem?!this._reflectionTexture.invertZ:this._reflectionTexture.invertZ,a.RGBDREFLECTION=this._reflectionTexture.isRGBD,this._reflectionTexture.coordinatesMode){case re.EXPLICIT_MODE:a.setReflectionMode("REFLECTIONMAP_EXPLICIT");break;case re.PLANAR_MODE:a.setReflectionMode("REFLECTIONMAP_PLANAR");break;case re.PROJECTION_MODE:a.setReflectionMode("REFLECTIONMAP_PROJECTION");break;case re.SKYBOX_MODE:a.setReflectionMode("REFLECTIONMAP_SKYBOX");break;case re.SPHERICAL_MODE:a.setReflectionMode("REFLECTIONMAP_SPHERICAL");break;case re.EQUIRECTANGULAR_MODE:a.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR");break;case re.FIXED_EQUIRECTANGULAR_MODE:a.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR_FIXED");break;case re.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:a.setReflectionMode("REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED");break;case re.CUBIC_MODE:case re.INVCUBIC_MODE:default:a.setReflectionMode("REFLECTIONMAP_CUBIC");break}a.USE_LOCAL_REFLECTIONMAP_CUBIC=!!this._reflectionTexture.boundingBoxSize}else return!1;else a.REFLECTION=!1,a.REFLECTIONMAP_OPPOSITEZ=!1;if(this._emissiveTexture&&le.EmissiveTextureEnabled)if(this._emissiveTexture.isReadyOrNotBlocking())Bt(this._emissiveTexture,a,"EMISSIVE");else return!1;else a.EMISSIVE=!1;if(this._lightmapTexture&&le.LightmapTextureEnabled)if(this._lightmapTexture.isReadyOrNotBlocking())Bt(this._lightmapTexture,a,"LIGHTMAP"),a.USELIGHTMAPASSHADOWMAP=this._useLightmapAsShadowmap,a.RGBDLIGHTMAP=this._lightmapTexture.isRGBD;else return!1;else a.LIGHTMAP=!1;if(this._specularTexture&&le.SpecularTextureEnabled)if(this._specularTexture.isReadyOrNotBlocking())Bt(this._specularTexture,a,"SPECULAR"),a.GLOSSINESS=this._useGlossinessFromSpecularMapAlpha;else return!1;else a.SPECULAR=!1;if(s.getEngine().getCaps().standardDerivatives&&this._bumpTexture&&le.BumpTextureEnabled){if(this._bumpTexture.isReady())Bt(this._bumpTexture,a,"BUMP"),a.PARALLAX=this._useParallax,a.PARALLAX_RHS=s.useRightHandedSystem,a.PARALLAXOCCLUSION=this._useParallaxOcclusion;else return!1;a.OBJECTSPACE_NORMALMAP=this._useObjectSpaceNormalMap}else a.BUMP=!1,a.PARALLAX=!1,a.PARALLAX_RHS=!1,a.PARALLAXOCCLUSION=!1;if(this._refractionTexture&&le.RefractionTextureEnabled)if(this._refractionTexture.isReadyOrNotBlocking())a._needUVs=!0,a.REFRACTION=!0,a.REFRACTIONMAP_3D=this._refractionTexture.isCube,a.RGBDREFRACTION=this._refractionTexture.isRGBD,a.USE_LOCAL_REFRACTIONMAP_CUBIC=!!this._refractionTexture.boundingBoxSize;else return!1;else a.REFRACTION=!1;a.TWOSIDEDLIGHTING=!this._backFaceCulling&&this._twoSidedLighting}else a.DIFFUSE=!1,a.AMBIENT=!1,a.OPACITY=!1,a.REFLECTION=!1,a.EMISSIVE=!1,a.LIGHTMAP=!1,a.BUMP=!1,a.REFRACTION=!1;a.ALPHAFROMDIFFUSE=this._shouldUseAlphaFromDiffuseTexture(),a.EMISSIVEASILLUMINATION=this._useEmissiveAsIllumination,a.LINKEMISSIVEWITHDIFFUSE=this._linkEmissiveWithDiffuse,a.SPECULAROVERALPHA=this._useSpecularOverAlpha,a.PREMULTIPLYALPHA=this.alphaMode===7||this.alphaMode===8,a.ALPHATEST_AFTERALLALPHACOMPUTATIONS=this.transparencyMode!==null,a.ALPHABLEND=this.transparencyMode===null||this.needAlphaBlendingForMesh(e)}if(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=a,this._eventInfo.subMesh=t,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),!this._eventInfo.isReadyForSubMesh)return!1;if(a._areImageProcessingDirty&&this._imageProcessingConfiguration){if(!this._imageProcessingConfiguration.isReady())return!1;this._imageProcessingConfiguration.prepareDefines(a),a.IS_REFLECTION_LINEAR=this.reflectionTexture!=null&&!this.reflectionTexture.gammaSpace,a.IS_REFRACTION_LINEAR=this.refractionTexture!=null&&!this.refractionTexture.gammaSpace}a._areFresnelDirty&&(le.FresnelEnabled?(this._diffuseFresnelParameters||this._opacityFresnelParameters||this._emissiveFresnelParameters||this._refractionFresnelParameters||this._reflectionFresnelParameters)&&(a.DIFFUSEFRESNEL=this._diffuseFresnelParameters&&this._diffuseFresnelParameters.isEnabled,a.OPACITYFRESNEL=this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled,a.REFLECTIONFRESNEL=this._reflectionFresnelParameters&&this._reflectionFresnelParameters.isEnabled,a.REFLECTIONFRESNELFROMSPECULAR=this._useReflectionFresnelFromSpecular,a.REFRACTIONFRESNEL=this._refractionFresnelParameters&&this._refractionFresnelParameters.isEnabled,a.EMISSIVEFRESNEL=this._emissiveFresnelParameters&&this._emissiveFresnelParameters.isEnabled,a._needNormals=!0,a.FRESNEL=!0):a.FRESNEL=!1),R1(e,s,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e)||this._forceAlphaTest,a,this._applyDecalMapAfterDetailMap),M1(s,l,this,a,i,null,t.getRenderingMesh().hasThinInstances),this._eventInfo.defines=a,this._eventInfo.mesh=e,this._callbackPluginEventPrepareDefinesBeforeAttributes(this._eventInfo),I1(e,a,!0,!0,!0),this._callbackPluginEventPrepareDefines(this._eventInfo);let c=!1;if(a.isDirty){const u=a._areLightsDisposed;a.markAsProcessed();const h=new Rm;a.REFLECTION&&h.addFallback(0,"REFLECTION"),a.SPECULAR&&h.addFallback(0,"SPECULAR"),a.BUMP&&h.addFallback(0,"BUMP"),a.PARALLAX&&h.addFallback(1,"PARALLAX"),a.PARALLAX_RHS&&h.addFallback(1,"PARALLAX_RHS"),a.PARALLAXOCCLUSION&&h.addFallback(0,"PARALLAXOCCLUSION"),a.SPECULAROVERALPHA&&h.addFallback(0,"SPECULAROVERALPHA"),a.FOG&&h.addFallback(1,"FOG"),a.POINTSIZE&&h.addFallback(0,"POINTSIZE"),a.LOGARITHMICDEPTH&&h.addFallback(0,"LOGARITHMICDEPTH"),S1(a,h,this._maxSimultaneousLights),a.SPECULARTERM&&h.addFallback(0,"SPECULARTERM"),a.DIFFUSEFRESNEL&&h.addFallback(1,"DIFFUSEFRESNEL"),a.OPACITYFRESNEL&&h.addFallback(2,"OPACITYFRESNEL"),a.REFLECTIONFRESNEL&&h.addFallback(3,"REFLECTIONFRESNEL"),a.EMISSIVEFRESNEL&&h.addFallback(4,"EMISSIVEFRESNEL"),a.FRESNEL&&h.addFallback(4,"FRESNEL"),a.MULTIVIEW&&h.addFallback(0,"MULTIVIEW");const d=[x.PositionKind];a.NORMAL&&d.push(x.NormalKind),a.TANGENT&&d.push(x.TangentKind);for(let b=1;b<=6;++b)a["UV"+b]&&d.push(`uv${b===1?"":b}`);a.VERTEXCOLOR&&d.push(x.ColorKind),C1(d,e,a,h),A1(d,a),E1(d,e,a),bm(d,e,a);let f="default";const _=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vDiffuseColor","vSpecularColor","vEmissiveColor","visibility","vFogInfos","vFogColor","pointSize","vDiffuseInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vEmissiveInfos","vSpecularInfos","vBumpInfos","vLightmapInfos","vRefractionInfos","mBones","diffuseMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","specularMatrix","bumpMatrix","normalMatrix","lightmapMatrix","refractionMatrix","diffuseLeftColor","diffuseRightColor","opacityParts","reflectionLeftColor","reflectionRightColor","emissiveLeftColor","emissiveRightColor","refractionLeftColor","refractionRightColor","vReflectionPosition","vReflectionSize","vRefractionPosition","vRefractionSize","logarithmicDepthConstant","vTangentSpaceParams","alphaCutOff","boneTextureWidth","morphTargetTextureInfo","morphTargetTextureIndices"],p=["diffuseSampler","ambientSampler","opacitySampler","reflectionCubeSampler","reflection2DSampler","emissiveSampler","specularSampler","bumpSampler","lightmapSampler","refractionCubeSampler","refraction2DSampler","boneSampler","morphTargets","oitDepthSampler","oitFrontColorSampler"],v=["Material","Scene","Mesh"],E={maxSimultaneousLights:this._maxSimultaneousLights,maxSimultaneousMorphTargets:a.NUM_MORPH_INFLUENCERS};this._eventInfo.fallbacks=h,this._eventInfo.fallbackRank=0,this._eventInfo.defines=a,this._eventInfo.uniforms=_,this._eventInfo.attributes=d,this._eventInfo.samplers=p,this._eventInfo.uniformBuffersNames=v,this._eventInfo.customCode=void 0,this._eventInfo.mesh=e,this._eventInfo.indexParameters=E,this._callbackPluginEventGeneric(zi.PrepareEffect,this._eventInfo),td.AddUniforms(_),it&&(it.PrepareUniforms(_,a),it.PrepareSamplers(p,a)),D1({uniformsNames:_,uniformBuffersNames:v,samplers:p,defines:a,maxSimultaneousLights:this._maxSimultaneousLights}),mm(_);const g={};this.customShaderNameResolve&&(f=this.customShaderNameResolve(f,_,v,p,a,d,g));const m=a.toString(),y=t.effect;let T=s.getEngine().createEffect(f,{attributes:d,uniformsNames:_,uniformBuffersNames:v,samplers:p,defines:m,fallbacks:h,onCompiled:this.onCompiled,onError:this.onError,indexParameters:E,processFinalCode:g.processFinalCode,processCodeAfterIncludes:this._eventInfo.customCode,multiTarget:a.PREPASS},l);if(this._eventInfo.customCode=void 0,T)if(this._onEffectCreatedObservable&&(O_.effect=T,O_.subMesh=t,this._onEffectCreatedObservable.notifyObservers(O_)),this.allowShaderHotSwapping&&y&&!T.isReady()){if(T=y,a.markAsUnprocessed(),c=this.isFrozen,u)return a._areLightsDisposed=!0,!1}else s.resetCachedMaterial(),t.setEffect(T,a,this._materialContext)}return!t.effect||!t.effect.isReady()?!1:(a._renderId=s.getRenderId(),r._wasPreviouslyReady=!c,r._wasPreviouslyUsingInstances=i,this._checkScenePerformancePriority(),!0)}buildUniformLayout(){const e=this._uniformBuffer;e.addUniform("diffuseLeftColor",4),e.addUniform("diffuseRightColor",4),e.addUniform("opacityParts",4),e.addUniform("reflectionLeftColor",4),e.addUniform("reflectionRightColor",4),e.addUniform("refractionLeftColor",4),e.addUniform("refractionRightColor",4),e.addUniform("emissiveLeftColor",4),e.addUniform("emissiveRightColor",4),e.addUniform("vDiffuseInfos",2),e.addUniform("vAmbientInfos",2),e.addUniform("vOpacityInfos",2),e.addUniform("vReflectionInfos",2),e.addUniform("vReflectionPosition",3),e.addUniform("vReflectionSize",3),e.addUniform("vEmissiveInfos",2),e.addUniform("vLightmapInfos",2),e.addUniform("vSpecularInfos",2),e.addUniform("vBumpInfos",3),e.addUniform("diffuseMatrix",16),e.addUniform("ambientMatrix",16),e.addUniform("opacityMatrix",16),e.addUniform("reflectionMatrix",16),e.addUniform("emissiveMatrix",16),e.addUniform("lightmapMatrix",16),e.addUniform("specularMatrix",16),e.addUniform("bumpMatrix",16),e.addUniform("vTangentSpaceParams",2),e.addUniform("pointSize",1),e.addUniform("alphaCutOff",1),e.addUniform("refractionMatrix",16),e.addUniform("vRefractionInfos",4),e.addUniform("vRefractionPosition",3),e.addUniform("vRefractionSize",3),e.addUniform("vSpecularColor",4),e.addUniform("vEmissiveColor",3),e.addUniform("vDiffuseColor",4),e.addUniform("vAmbientColor",3),super.buildUniformLayout()}bindForSubMesh(e,t,i){var c;const r=this.getScene(),s=i.materialDefines;if(!s)return;const a=i.effect;if(!a)return;this._activeEffect=a,t.getMeshUniformBuffer().bindToEffect(a,"Mesh"),t.transferToEffect(e),this._uniformBuffer.bindToEffect(a,"Material"),this.prePassConfiguration.bindForSubMesh(this._activeEffect,r,t,e,this.isFrozen),this._eventInfo.subMesh=i,this._callbackPluginEventHardBindForSubMesh(this._eventInfo),s.OBJECTSPACE_NORMALMAP&&(e.toNormalMatrix(this._normalMatrix),this.bindOnlyNormalMatrix(this._normalMatrix));const l=this._mustRebind(r,a,i,t.visibility);Cm(t,a);const o=this._uniformBuffer;if(l){if(this.bindViewProjection(a),!o.useUbo||!this.isFrozen||!o.isSync||i._drawWrapper._forceRebindOnNextCall){if(le.FresnelEnabled&&s.FRESNEL&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled&&(o.updateColor4("diffuseLeftColor",this.diffuseFresnelParameters.leftColor,this.diffuseFresnelParameters.power),o.updateColor4("diffuseRightColor",this.diffuseFresnelParameters.rightColor,this.diffuseFresnelParameters.bias)),this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&o.updateColor4("opacityParts",new Pe(this.opacityFresnelParameters.leftColor.toLuminance(),this.opacityFresnelParameters.rightColor.toLuminance(),this.opacityFresnelParameters.bias),this.opacityFresnelParameters.power),this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled&&(o.updateColor4("reflectionLeftColor",this.reflectionFresnelParameters.leftColor,this.reflectionFresnelParameters.power),o.updateColor4("reflectionRightColor",this.reflectionFresnelParameters.rightColor,this.reflectionFresnelParameters.bias)),this.refractionFresnelParameters&&this.refractionFresnelParameters.isEnabled&&(o.updateColor4("refractionLeftColor",this.refractionFresnelParameters.leftColor,this.refractionFresnelParameters.power),o.updateColor4("refractionRightColor",this.refractionFresnelParameters.rightColor,this.refractionFresnelParameters.bias)),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(o.updateColor4("emissiveLeftColor",this.emissiveFresnelParameters.leftColor,this.emissiveFresnelParameters.power),o.updateColor4("emissiveRightColor",this.emissiveFresnelParameters.rightColor,this.emissiveFresnelParameters.bias))),r.texturesEnabled){if(this._diffuseTexture&&le.DiffuseTextureEnabled&&(o.updateFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),Dt(this._diffuseTexture,o,"diffuse")),this._ambientTexture&&le.AmbientTextureEnabled&&(o.updateFloat2("vAmbientInfos",this._ambientTexture.coordinatesIndex,this._ambientTexture.level),Dt(this._ambientTexture,o,"ambient")),this._opacityTexture&&le.OpacityTextureEnabled&&(o.updateFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,this._opacityTexture.level),Dt(this._opacityTexture,o,"opacity")),this._hasAlphaChannel()&&o.updateFloat("alphaCutOff",this.alphaCutOff),this._reflectionTexture&&le.ReflectionTextureEnabled&&(o.updateFloat2("vReflectionInfos",this._reflectionTexture.level,this.roughness),o.updateMatrix("reflectionMatrix",this._reflectionTexture.getReflectionTextureMatrix()),this._reflectionTexture.boundingBoxSize)){const u=this._reflectionTexture;o.updateVector3("vReflectionPosition",u.boundingBoxPosition),o.updateVector3("vReflectionSize",u.boundingBoxSize)}if(this._emissiveTexture&&le.EmissiveTextureEnabled&&(o.updateFloat2("vEmissiveInfos",this._emissiveTexture.coordinatesIndex,this._emissiveTexture.level),Dt(this._emissiveTexture,o,"emissive")),this._lightmapTexture&&le.LightmapTextureEnabled&&(o.updateFloat2("vLightmapInfos",this._lightmapTexture.coordinatesIndex,this._lightmapTexture.level),Dt(this._lightmapTexture,o,"lightmap")),this._specularTexture&&le.SpecularTextureEnabled&&(o.updateFloat2("vSpecularInfos",this._specularTexture.coordinatesIndex,this._specularTexture.level),Dt(this._specularTexture,o,"specular")),this._bumpTexture&&r.getEngine().getCaps().standardDerivatives&&le.BumpTextureEnabled&&(o.updateFloat3("vBumpInfos",this._bumpTexture.coordinatesIndex,1/this._bumpTexture.level,this.parallaxScaleBias),Dt(this._bumpTexture,o,"bump"),r._mirroredCameraPosition?o.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?1:-1,this._invertNormalMapY?1:-1):o.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?-1:1,this._invertNormalMapY?-1:1)),this._refractionTexture&&le.RefractionTextureEnabled){let u=1;if(this._refractionTexture.isCube||(o.updateMatrix("refractionMatrix",this._refractionTexture.getReflectionTextureMatrix()),this._refractionTexture.depth&&(u=this._refractionTexture.depth)),o.updateFloat4("vRefractionInfos",this._refractionTexture.level,this.indexOfRefraction,u,this.invertRefractionY?-1:1),this._refractionTexture.boundingBoxSize){const h=this._refractionTexture;o.updateVector3("vRefractionPosition",h.boundingBoxPosition),o.updateVector3("vRefractionSize",h.boundingBoxSize)}}}this.pointsCloud&&o.updateFloat("pointSize",this.pointSize),s.SPECULARTERM&&o.updateColor4("vSpecularColor",this.specularColor,this.specularPower),o.updateColor3("vEmissiveColor",le.EmissiveTextureEnabled?this.emissiveColor:Pe.BlackReadOnly),o.updateColor4("vDiffuseColor",this.diffuseColor,this.alpha),r.ambientColor.multiplyToRef(this.ambientColor,this._globalAmbientColor),o.updateColor3("vAmbientColor",this._globalAmbientColor)}r.texturesEnabled&&(this._diffuseTexture&&le.DiffuseTextureEnabled&&a.setTexture("diffuseSampler",this._diffuseTexture),this._ambientTexture&&le.AmbientTextureEnabled&&a.setTexture("ambientSampler",this._ambientTexture),this._opacityTexture&&le.OpacityTextureEnabled&&a.setTexture("opacitySampler",this._opacityTexture),this._reflectionTexture&&le.ReflectionTextureEnabled&&(this._reflectionTexture.isCube?a.setTexture("reflectionCubeSampler",this._reflectionTexture):a.setTexture("reflection2DSampler",this._reflectionTexture)),this._emissiveTexture&&le.EmissiveTextureEnabled&&a.setTexture("emissiveSampler",this._emissiveTexture),this._lightmapTexture&&le.LightmapTextureEnabled&&a.setTexture("lightmapSampler",this._lightmapTexture),this._specularTexture&&le.SpecularTextureEnabled&&a.setTexture("specularSampler",this._specularTexture),this._bumpTexture&&r.getEngine().getCaps().standardDerivatives&&le.BumpTextureEnabled&&a.setTexture("bumpSampler",this._bumpTexture),this._refractionTexture&&le.RefractionTextureEnabled&&(this._refractionTexture.isCube?a.setTexture("refractionCubeSampler",this._refractionTexture):a.setTexture("refraction2DSampler",this._refractionTexture))),this.getScene().useOrderIndependentTransparency&&this.needAlphaBlendingForMesh(t)&&this.getScene().depthPeelingRenderer.bind(a),this._eventInfo.subMesh=i,this._callbackPluginEventBindForSubMesh(this._eventInfo),vm(a,this,r),this.bindEyePosition(a)}else r.getEngine()._features.needToAlwaysBindUniformBuffers&&(this._needToBindSceneUbo=!0);(l||!this.isFrozen)&&(r.lightsEnabled&&!this._disableLighting&&b1(r,t,a,s,this._maxSimultaneousLights),(r.fogEnabled&&t.applyFog&&r.fogMode!==Pt.FOGMODE_NONE||this._reflectionTexture||this._refractionTexture||t.receiveShadows||s.PREPASS)&&this.bindView(a),ym(r,t,a),s.NUM_MORPH_INFLUENCERS&&Tm(t,a),s.BAKED_VERTEX_ANIMATION_TEXTURE&&((c=t.bakedVertexAnimationManager)==null||c.bind(a,s.INSTANCES)),this.useLogarithmicDepth&&Em(s,a,r),this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.applyByPostProcess&&this._imageProcessingConfiguration.bind(this._activeEffect)),this._afterBind(t,this._activeEffect,i),o.update()}getAnimatables(){const e=super.getAnimatables();return this._diffuseTexture&&this._diffuseTexture.animations&&this._diffuseTexture.animations.length>0&&e.push(this._diffuseTexture),this._ambientTexture&&this._ambientTexture.animations&&this._ambientTexture.animations.length>0&&e.push(this._ambientTexture),this._opacityTexture&&this._opacityTexture.animations&&this._opacityTexture.animations.length>0&&e.push(this._opacityTexture),this._reflectionTexture&&this._reflectionTexture.animations&&this._reflectionTexture.animations.length>0&&e.push(this._reflectionTexture),this._emissiveTexture&&this._emissiveTexture.animations&&this._emissiveTexture.animations.length>0&&e.push(this._emissiveTexture),this._specularTexture&&this._specularTexture.animations&&this._specularTexture.animations.length>0&&e.push(this._specularTexture),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&e.push(this._bumpTexture),this._lightmapTexture&&this._lightmapTexture.animations&&this._lightmapTexture.animations.length>0&&e.push(this._lightmapTexture),this._refractionTexture&&this._refractionTexture.animations&&this._refractionTexture.animations.length>0&&e.push(this._refractionTexture),e}getActiveTextures(){const e=super.getActiveTextures();return this._diffuseTexture&&e.push(this._diffuseTexture),this._ambientTexture&&e.push(this._ambientTexture),this._opacityTexture&&e.push(this._opacityTexture),this._reflectionTexture&&e.push(this._reflectionTexture),this._emissiveTexture&&e.push(this._emissiveTexture),this._specularTexture&&e.push(this._specularTexture),this._bumpTexture&&e.push(this._bumpTexture),this._lightmapTexture&&e.push(this._lightmapTexture),this._refractionTexture&&e.push(this._refractionTexture),e}hasTexture(e){return!!(super.hasTexture(e)||this._diffuseTexture===e||this._ambientTexture===e||this._opacityTexture===e||this._reflectionTexture===e||this._emissiveTexture===e||this._specularTexture===e||this._bumpTexture===e||this._lightmapTexture===e||this._refractionTexture===e)}dispose(e,t){var i,r,s,a,l,o,c,u,h;t&&((i=this._diffuseTexture)==null||i.dispose(),(r=this._ambientTexture)==null||r.dispose(),(s=this._opacityTexture)==null||s.dispose(),(a=this._reflectionTexture)==null||a.dispose(),(l=this._emissiveTexture)==null||l.dispose(),(o=this._specularTexture)==null||o.dispose(),(c=this._bumpTexture)==null||c.dispose(),(u=this._lightmapTexture)==null||u.dispose(),(h=this._refractionTexture)==null||h.dispose()),this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),super.dispose(e,t)}clone(e,t=!0,i=""){const r=Fe.Clone(()=>new le(e,this.getScene()),this,{cloneTexturesOnlyOnce:t});return r.name=e,r.id=e,this.stencil.copyTo(r.stencil),this._clonePlugins(r,i),r}static Parse(e,t,i){const r=Fe.Parse(()=>new le(e.name,t),e,t,i);return e.stencil&&r.stencil.parse(e.stencil,t,i),j._ParsePlugins(e,r,t,i),r}static get DiffuseTextureEnabled(){return te.DiffuseTextureEnabled}static set DiffuseTextureEnabled(e){te.DiffuseTextureEnabled=e}static get DetailTextureEnabled(){return te.DetailTextureEnabled}static set DetailTextureEnabled(e){te.DetailTextureEnabled=e}static get AmbientTextureEnabled(){return te.AmbientTextureEnabled}static set AmbientTextureEnabled(e){te.AmbientTextureEnabled=e}static get OpacityTextureEnabled(){return te.OpacityTextureEnabled}static set OpacityTextureEnabled(e){te.OpacityTextureEnabled=e}static get ReflectionTextureEnabled(){return te.ReflectionTextureEnabled}static set ReflectionTextureEnabled(e){te.ReflectionTextureEnabled=e}static get EmissiveTextureEnabled(){return te.EmissiveTextureEnabled}static set EmissiveTextureEnabled(e){te.EmissiveTextureEnabled=e}static get SpecularTextureEnabled(){return te.SpecularTextureEnabled}static set SpecularTextureEnabled(e){te.SpecularTextureEnabled=e}static get BumpTextureEnabled(){return te.BumpTextureEnabled}static set BumpTextureEnabled(e){te.BumpTextureEnabled=e}static get LightmapTextureEnabled(){return te.LightmapTextureEnabled}static set LightmapTextureEnabled(e){te.LightmapTextureEnabled=e}static get RefractionTextureEnabled(){return te.RefractionTextureEnabled}static set RefractionTextureEnabled(e){te.RefractionTextureEnabled=e}static get ColorGradingTextureEnabled(){return te.ColorGradingTextureEnabled}static set ColorGradingTextureEnabled(e){te.ColorGradingTextureEnabled=e}static get FresnelEnabled(){return te.FresnelEnabled}static set FresnelEnabled(e){te.FresnelEnabled=e}}R([At("diffuseTexture")],le.prototype,"_diffuseTexture",void 0);R([ie("_markAllSubMeshesAsTexturesAndMiscDirty")],le.prototype,"diffuseTexture",void 0);R([At("ambientTexture")],le.prototype,"_ambientTexture",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"ambientTexture",void 0);R([At("opacityTexture")],le.prototype,"_opacityTexture",void 0);R([ie("_markAllSubMeshesAsTexturesAndMiscDirty")],le.prototype,"opacityTexture",void 0);R([At("reflectionTexture")],le.prototype,"_reflectionTexture",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"reflectionTexture",void 0);R([At("emissiveTexture")],le.prototype,"_emissiveTexture",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"emissiveTexture",void 0);R([At("specularTexture")],le.prototype,"_specularTexture",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"specularTexture",void 0);R([At("bumpTexture")],le.prototype,"_bumpTexture",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"bumpTexture",void 0);R([At("lightmapTexture")],le.prototype,"_lightmapTexture",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"lightmapTexture",void 0);R([At("refractionTexture")],le.prototype,"_refractionTexture",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"refractionTexture",void 0);R([br("ambient")],le.prototype,"ambientColor",void 0);R([br("diffuse")],le.prototype,"diffuseColor",void 0);R([br("specular")],le.prototype,"specularColor",void 0);R([br("emissive")],le.prototype,"emissiveColor",void 0);R([I()],le.prototype,"specularPower",void 0);R([I("useAlphaFromDiffuseTexture")],le.prototype,"_useAlphaFromDiffuseTexture",void 0);R([ie("_markAllSubMeshesAsTexturesAndMiscDirty")],le.prototype,"useAlphaFromDiffuseTexture",void 0);R([I("useEmissiveAsIllumination")],le.prototype,"_useEmissiveAsIllumination",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"useEmissiveAsIllumination",void 0);R([I("linkEmissiveWithDiffuse")],le.prototype,"_linkEmissiveWithDiffuse",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"linkEmissiveWithDiffuse",void 0);R([I("useSpecularOverAlpha")],le.prototype,"_useSpecularOverAlpha",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"useSpecularOverAlpha",void 0);R([I("useReflectionOverAlpha")],le.prototype,"_useReflectionOverAlpha",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"useReflectionOverAlpha",void 0);R([I("disableLighting")],le.prototype,"_disableLighting",void 0);R([ie("_markAllSubMeshesAsLightsDirty")],le.prototype,"disableLighting",void 0);R([I("useObjectSpaceNormalMap")],le.prototype,"_useObjectSpaceNormalMap",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"useObjectSpaceNormalMap",void 0);R([I("useParallax")],le.prototype,"_useParallax",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"useParallax",void 0);R([I("useParallaxOcclusion")],le.prototype,"_useParallaxOcclusion",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"useParallaxOcclusion",void 0);R([I()],le.prototype,"parallaxScaleBias",void 0);R([I("roughness")],le.prototype,"_roughness",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"roughness",void 0);R([I()],le.prototype,"indexOfRefraction",void 0);R([I()],le.prototype,"invertRefractionY",void 0);R([I()],le.prototype,"alphaCutOff",void 0);R([I("useLightmapAsShadowmap")],le.prototype,"_useLightmapAsShadowmap",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"useLightmapAsShadowmap",void 0);R([ku("diffuseFresnelParameters")],le.prototype,"_diffuseFresnelParameters",void 0);R([ie("_markAllSubMeshesAsFresnelDirty")],le.prototype,"diffuseFresnelParameters",void 0);R([ku("opacityFresnelParameters")],le.prototype,"_opacityFresnelParameters",void 0);R([ie("_markAllSubMeshesAsFresnelAndMiscDirty")],le.prototype,"opacityFresnelParameters",void 0);R([ku("reflectionFresnelParameters")],le.prototype,"_reflectionFresnelParameters",void 0);R([ie("_markAllSubMeshesAsFresnelDirty")],le.prototype,"reflectionFresnelParameters",void 0);R([ku("refractionFresnelParameters")],le.prototype,"_refractionFresnelParameters",void 0);R([ie("_markAllSubMeshesAsFresnelDirty")],le.prototype,"refractionFresnelParameters",void 0);R([ku("emissiveFresnelParameters")],le.prototype,"_emissiveFresnelParameters",void 0);R([ie("_markAllSubMeshesAsFresnelDirty")],le.prototype,"emissiveFresnelParameters",void 0);R([I("useReflectionFresnelFromSpecular")],le.prototype,"_useReflectionFresnelFromSpecular",void 0);R([ie("_markAllSubMeshesAsFresnelDirty")],le.prototype,"useReflectionFresnelFromSpecular",void 0);R([I("useGlossinessFromSpecularMapAlpha")],le.prototype,"_useGlossinessFromSpecularMapAlpha",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"useGlossinessFromSpecularMapAlpha",void 0);R([I("maxSimultaneousLights")],le.prototype,"_maxSimultaneousLights",void 0);R([ie("_markAllSubMeshesAsLightsDirty")],le.prototype,"maxSimultaneousLights",void 0);R([I("invertNormalMapX")],le.prototype,"_invertNormalMapX",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"invertNormalMapX",void 0);R([I("invertNormalMapY")],le.prototype,"_invertNormalMapY",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"invertNormalMapY",void 0);R([I("twoSidedLighting")],le.prototype,"_twoSidedLighting",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],le.prototype,"twoSidedLighting",void 0);R([I("applyDecalMapAfterDetailMap")],le.prototype,"_applyDecalMapAfterDetailMap",void 0);R([ie("_markAllSubMeshesAsMiscDirty")],le.prototype,"applyDecalMapAfterDetailMap",void 0);Ji("BABYLON.StandardMaterial",le);Pt.DefaultMaterialFactory=n=>new le("default material",n);class wn{constructor(){this.materials=[]}parseMTL(e,t,i,r){if(t instanceof ArrayBuffer)return;const s=t.split(`
`),a=/\s+/;let l,o=null;for(let c=0;c<s.length;c++){const u=s[c].trim();if(u.length===0||u.charAt(0)==="#")continue;const h=u.indexOf(" ");let d=h>=0?u.substring(0,h):u;d=d.toLowerCase();const f=h>=0?u.substring(h+1).trim():"";if(d==="newmtl")o&&this.materials.push(o),e._blockEntityCollection=!!r,o=new le(f,e),o._parentContainer=r,e._blockEntityCollection=!1;else if(d==="kd"&&o)l=f.split(a,3).map(parseFloat),o.diffuseColor=Pe.FromArray(l);else if(d==="ka"&&o)l=f.split(a,3).map(parseFloat),o.ambientColor=Pe.FromArray(l);else if(d==="ks"&&o)l=f.split(a,3).map(parseFloat),o.specularColor=Pe.FromArray(l);else if(d==="ke"&&o)l=f.split(a,3).map(parseFloat),o.emissiveColor=Pe.FromArray(l);else if(d==="ns"&&o)o.specularPower=parseFloat(f);else if(d==="d"&&o)o.alpha=parseFloat(f);else if(d==="map_ka"&&o)o.ambientTexture=wn._GetTexture(i,f,e);else if(d==="map_kd"&&o)o.diffuseTexture=wn._GetTexture(i,f,e);else if(d==="map_ks"&&o)o.specularTexture=wn._GetTexture(i,f,e);else if(d!=="map_ns")if(d==="map_bump"&&o){const _=f.split(a),p=_.indexOf("-bm");let v=null;p>=0&&(v=_[p+1],_.splice(p,2)),o.bumpTexture=wn._GetTexture(i,_.join(" "),e),o.bumpTexture&&v!==null&&(o.bumpTexture.level=parseFloat(v))}else d==="map_d"&&o&&(o.opacityTexture=wn._GetTexture(i,f,e))}o&&this.materials.push(o)}static _GetTexture(e,t,i){if(!t)return null;let r=e;if(e==="file:"){let s=t.lastIndexOf("\\");s===-1&&(s=t.lastIndexOf("/")),s>-1?r+=t.substr(s+1):r+=t}else r+=t;return new re(r,i,!1,wn.INVERT_TEXTURE_Y)}}wn.INVERT_TEXTURE_Y=!0;class It{constructor(e,t,i){this._positions=[],this._normals=[],this._uvs=[],this._colors=[],this._meshesFromObj=[],this._indicesForBabylon=[],this._wrappedPositionForBabylon=[],this._wrappedUvsForBabylon=[],this._wrappedColorsForBabylon=[],this._wrappedNormalsForBabylon=[],this._tuplePosNorm=[],this._curPositionInIndices=0,this._hasMeshes=!1,this._unwrappedPositionsForBabylon=[],this._unwrappedColorsForBabylon=[],this._unwrappedNormalsForBabylon=[],this._unwrappedUVForBabylon=[],this._triangles=[],this._materialNameFromObj="",this._objMeshName="",this._increment=1,this._isFirstMaterial=!0,this._grayColor=new et(.5,.5,.5,1),this._materialToUse=e,this._babylonMeshesArray=t,this._loadingOptions=i}_isInArray(e,t){e[t[0]]||(e[t[0]]={normals:[],idx:[]});const i=e[t[0]].normals.indexOf(t[1]);return i===-1?-1:e[t[0]].idx[i]}_isInArrayUV(e,t){e[t[0]]||(e[t[0]]={normals:[],idx:[],uv:[]});const i=e[t[0]].normals.indexOf(t[1]);return i!=1&&t[2]===e[t[0]].uv[i]?e[t[0]].idx[i]:-1}_setData(e,t,i,r,s,a,l){let o;this._loadingOptions.optimizeWithUV?o=this._isInArrayUV(this._tuplePosNorm,[e,i,t]):o=this._isInArray(this._tuplePosNorm,[e,i]),o===-1?(this._indicesForBabylon.push(this._wrappedPositionForBabylon.length),this._wrappedPositionForBabylon.push(r),this._wrappedUvsForBabylon.push(s),this._wrappedNormalsForBabylon.push(a),l!==void 0&&this._wrappedColorsForBabylon.push(l),this._tuplePosNorm[e].normals.push(i),this._tuplePosNorm[e].idx.push(this._curPositionInIndices++),this._loadingOptions.optimizeWithUV&&this._tuplePosNorm[e].uv.push(t)):this._indicesForBabylon.push(o)}_unwrapData(){for(let e=0;e<this._wrappedPositionForBabylon.length;e++)this._unwrappedPositionsForBabylon.push(this._wrappedPositionForBabylon[e].x*this._handednessSign,this._wrappedPositionForBabylon[e].y,this._wrappedPositionForBabylon[e].z),this._unwrappedNormalsForBabylon.push(this._wrappedNormalsForBabylon[e].x*this._handednessSign,this._wrappedNormalsForBabylon[e].y,this._wrappedNormalsForBabylon[e].z),this._unwrappedUVForBabylon.push(this._wrappedUvsForBabylon[e].x,this._wrappedUvsForBabylon[e].y),this._loadingOptions.importVertexColors&&this._unwrappedColorsForBabylon.push(this._wrappedColorsForBabylon[e].r,this._wrappedColorsForBabylon[e].g,this._wrappedColorsForBabylon[e].b,this._wrappedColorsForBabylon[e].a);this._wrappedPositionForBabylon.length=0,this._wrappedNormalsForBabylon.length=0,this._wrappedUvsForBabylon.length=0,this._wrappedColorsForBabylon.length=0,this._tuplePosNorm.length=0,this._curPositionInIndices=0}_getTriangles(e,t){for(let i=t;i<e.length-1;i++)this._pushTriangle(e,i)}_setDataForCurrentFaceWithPattern1(e,t){this._getTriangles(e,t);for(let i=0;i<this._triangles.length;i++){const r=parseInt(this._triangles[i])-1;this._setData(r,0,0,this._positions[r],xe.Zero(),A.Up(),this._loadingOptions.importVertexColors?this._colors[r]:void 0)}this._triangles.length=0}_setDataForCurrentFaceWithPattern2(e,t){this._getTriangles(e,t);for(let i=0;i<this._triangles.length;i++){const r=this._triangles[i].split("/"),s=parseInt(r[0])-1,a=parseInt(r[1])-1;this._setData(s,a,0,this._positions[s],this._uvs[a],A.Up(),this._loadingOptions.importVertexColors?this._colors[s]:void 0)}this._triangles.length=0}_setDataForCurrentFaceWithPattern3(e,t){this._getTriangles(e,t);for(let i=0;i<this._triangles.length;i++){const r=this._triangles[i].split("/"),s=parseInt(r[0])-1,a=parseInt(r[1])-1,l=parseInt(r[2])-1;this._setData(s,a,l,this._positions[s],this._uvs[a],this._normals[l])}this._triangles.length=0}_setDataForCurrentFaceWithPattern4(e,t){this._getTriangles(e,t);for(let i=0;i<this._triangles.length;i++){const r=this._triangles[i].split("//"),s=parseInt(r[0])-1,a=parseInt(r[1])-1;this._setData(s,1,a,this._positions[s],xe.Zero(),this._normals[a],this._loadingOptions.importVertexColors?this._colors[s]:void 0)}this._triangles.length=0}_setDataForCurrentFaceWithPattern5(e,t){this._getTriangles(e,t);for(let i=0;i<this._triangles.length;i++){const r=this._triangles[i].split("/"),s=this._positions.length+parseInt(r[0]),a=this._uvs.length+parseInt(r[1]),l=this._normals.length+parseInt(r[2]);this._setData(s,a,l,this._positions[s],this._uvs[a],this._normals[l],this._loadingOptions.importVertexColors?this._colors[s]:void 0)}this._triangles.length=0}_addPreviousObjMesh(){this._meshesFromObj.length>0&&(this._handledMesh=this._meshesFromObj[this._meshesFromObj.length-1],this._unwrapData(),this._loadingOptions.useLegacyBehavior&&this._indicesForBabylon.reverse(),this._handledMesh.indices=this._indicesForBabylon.slice(),this._handledMesh.positions=this._unwrappedPositionsForBabylon.slice(),this._handledMesh.normals=this._unwrappedNormalsForBabylon.slice(),this._handledMesh.uvs=this._unwrappedUVForBabylon.slice(),this._loadingOptions.importVertexColors&&(this._handledMesh.colors=this._unwrappedColorsForBabylon.slice()),this._indicesForBabylon.length=0,this._unwrappedPositionsForBabylon.length=0,this._unwrappedColorsForBabylon.length=0,this._unwrappedNormalsForBabylon.length=0,this._unwrappedUVForBabylon.length=0)}_optimizeNormals(e){const t=e.getVerticesData(x.PositionKind),i=e.getVerticesData(x.NormalKind),r={};if(!t||!i)return;for(let a=0;a<t.length/3;a++){const l=t[a*3+0],o=t[a*3+1],c=t[a*3+2],u=l+"_"+o+"_"+c;let h=r[u];h||(h=[],r[u]=h),h.push(a)}const s=new A;for(const a in r){const l=r[a];if(l.length<2)continue;const o=l[0];for(let c=1;c<l.length;++c){const u=l[c];i[o*3+0]+=i[u*3+0],i[o*3+1]+=i[u*3+1],i[o*3+2]+=i[u*3+2]}s.copyFromFloats(i[o*3+0],i[o*3+1],i[o*3+2]),s.normalize();for(let c=0;c<l.length;++c){const u=l[c];i[u*3+0]=s.x,i[u*3+1]=s.y,i[u*3+2]=s.z}}e.setVerticesData(x.NormalKind,i)}parse(e,t,i,r,s){var l;this._loadingOptions.useLegacyBehavior?(this._pushTriangle=(o,c)=>this._triangles.push(o[0],o[c],o[c+1]),this._handednessSign=1):i.useRightHandedSystem?(this._pushTriangle=(o,c)=>this._triangles.push(o[0],o[c+1],o[c]),this._handednessSign=1):(this._pushTriangle=(o,c)=>this._triangles.push(o[0],o[c],o[c+1]),this._handednessSign=-1);const a=t.split(`
`);for(let o=0;o<a.length;o++){const c=a[o].trim().replace(/\s\s/g," ");let u;if(!(c.length===0||c.charAt(0)==="#"))if(It.VertexPattern.test(c)){if(u=c.match(/[^ ]+/g),this._positions.push(new A(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))),this._loadingOptions.importVertexColors)if(u.length>=7){const h=parseFloat(u[4]),d=parseFloat(u[5]),f=parseFloat(u[6]);this._colors.push(new et(h>1?h/255:h,d>1?d/255:d,f>1?f/255:f,u.length===7||u[7]===void 0?1:parseFloat(u[7])))}else this._colors.push(this._grayColor)}else if((u=It.NormalPattern.exec(c))!==null)this._normals.push(new A(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])));else if((u=It.UVPattern.exec(c))!==null)this._uvs.push(new xe(parseFloat(u[1])*this._loadingOptions.UVScaling.x,parseFloat(u[2])*this._loadingOptions.UVScaling.y));else if((u=It.FacePattern3.exec(c))!==null)this._setDataForCurrentFaceWithPattern3(u[1].trim().split(" "),1);else if((u=It.FacePattern4.exec(c))!==null)this._setDataForCurrentFaceWithPattern4(u[1].trim().split(" "),1);else if((u=It.FacePattern5.exec(c))!==null)this._setDataForCurrentFaceWithPattern5(u[1].trim().split(" "),1);else if((u=It.FacePattern2.exec(c))!==null)this._setDataForCurrentFaceWithPattern2(u[1].trim().split(" "),1);else if((u=It.FacePattern1.exec(c))!==null)this._setDataForCurrentFaceWithPattern1(u[1].trim().split(" "),1);else if((u=It.LinePattern1.exec(c))!==null)this._setDataForCurrentFaceWithPattern1(u[1].trim().split(" "),0);else if((u=It.LinePattern2.exec(c))!==null)this._setDataForCurrentFaceWithPattern2(u[1].trim().split(" "),0);else if((u=It.LinePattern3.exec(c))!==null)this._setDataForCurrentFaceWithPattern3(u[1].trim().split(" "),0);else if(It.GroupDescriptor.test(c)||It.ObjectDescriptor.test(c)){const h={name:c.substring(2).trim(),indices:null,positions:null,normals:null,uvs:null,colors:null,materialName:this._materialNameFromObj,isObject:It.ObjectDescriptor.test(c)};this._addPreviousObjMesh(),this._meshesFromObj.push(h),this._hasMeshes=!0,this._isFirstMaterial=!0,this._increment=1}else if(It.UseMtlDescriptor.test(c)){if(this._materialNameFromObj=c.substring(7).trim(),!this._isFirstMaterial||!this._hasMeshes){this._addPreviousObjMesh();const h={name:(this._objMeshName||"mesh")+"_mm"+this._increment.toString(),indices:null,positions:null,normals:null,uvs:null,colors:null,materialName:this._materialNameFromObj,isObject:!1};this._increment++,this._meshesFromObj.push(h),this._hasMeshes=!0}this._hasMeshes&&this._isFirstMaterial&&(this._meshesFromObj[this._meshesFromObj.length-1].materialName=this._materialNameFromObj,this._isFirstMaterial=!1)}else It.MtlLibGroupDescriptor.test(c)?s(c.substring(7).trim()):It.SmoothDescriptor.test(c)||ee.Log("Unhandled expression at line : "+c)}if(this._hasMeshes&&(this._handledMesh=this._meshesFromObj[this._meshesFromObj.length-1],this._loadingOptions.useLegacyBehavior&&this._indicesForBabylon.reverse(),this._unwrapData(),this._handledMesh.indices=this._indicesForBabylon,this._handledMesh.positions=this._unwrappedPositionsForBabylon,this._handledMesh.normals=this._unwrappedNormalsForBabylon,this._handledMesh.uvs=this._unwrappedUVForBabylon,this._loadingOptions.importVertexColors&&(this._handledMesh.colors=this._unwrappedColorsForBabylon)),!this._hasMeshes){let o=null;if(this._indicesForBabylon.length)this._loadingOptions.useLegacyBehavior&&this._indicesForBabylon.reverse(),this._unwrapData();else{for(const c of this._positions)this._unwrappedPositionsForBabylon.push(c.x,c.y,c.z);if(this._normals.length)for(const c of this._normals)this._unwrappedNormalsForBabylon.push(c.x,c.y,c.z);if(this._uvs.length)for(const c of this._uvs)this._unwrappedUVForBabylon.push(c.x,c.y);if(this._colors.length)for(const c of this._colors)this._unwrappedColorsForBabylon.push(c.r,c.g,c.b,c.a);this._materialNameFromObj||(o=new le(rr.RandomId(),i),o.pointsCloud=!0,this._materialNameFromObj=o.name,this._normals.length||(o.disableLighting=!0,o.emissiveColor=Pe.White()))}this._meshesFromObj.push({name:rr.RandomId(),indices:this._indicesForBabylon,positions:this._unwrappedPositionsForBabylon,colors:this._unwrappedColorsForBabylon,normals:this._unwrappedNormalsForBabylon,uvs:this._unwrappedUVForBabylon,materialName:this._materialNameFromObj,directMaterial:o,isObject:!0})}for(let o=0;o<this._meshesFromObj.length;o++){if(e&&this._meshesFromObj[o].name){if(e instanceof Array){if(e.indexOf(this._meshesFromObj[o].name)===-1)continue}else if(this._meshesFromObj[o].name!==e)continue}this._handledMesh=this._meshesFromObj[o],i._blockEntityCollection=!!r;const c=new Ae(this._meshesFromObj[o].name,i);if(c._parentContainer=r,i._blockEntityCollection=!1,this._handledMesh._babylonMesh=c,!this._handledMesh.isObject){for(let h=o-1;h>=0;--h)if(this._meshesFromObj[h].isObject&&this._meshesFromObj[h]._babylonMesh){c.parent=this._meshesFromObj[h]._babylonMesh;break}}if(this._materialToUse.push(this._meshesFromObj[o].materialName),((l=this._handledMesh.positions)==null?void 0:l.length)===0){this._babylonMeshesArray.push(c);continue}const u=new Ue;if(u.uvs=this._handledMesh.uvs,u.indices=this._handledMesh.indices,u.positions=this._handledMesh.positions,this._loadingOptions.computeNormals){const h=new Array;Ue.ComputeNormals(this._handledMesh.positions,this._handledMesh.indices,h),u.normals=h}else u.normals=this._handledMesh.normals;this._loadingOptions.importVertexColors&&(u.colors=this._handledMesh.colors),u.applyToMesh(c),this._loadingOptions.invertY&&(c.scaling.y*=-1),this._loadingOptions.optimizeNormals&&this._optimizeNormals(c),this._babylonMeshesArray.push(c),this._handledMesh.directMaterial&&(c.material=this._handledMesh.directMaterial)}}}It.ObjectDescriptor=/^o/;It.GroupDescriptor=/^g/;It.MtlLibGroupDescriptor=/^mtllib /;It.UseMtlDescriptor=/^usemtl /;It.SmoothDescriptor=/^s /;It.VertexPattern=/^v(\s+[\d|.|+|\-|e|E]+){3,7}/;It.NormalPattern=/^vn(\s+[\d|.|+|\-|e|E]+)( +[\d|.|+|\-|e|E]+)( +[\d|.|+|\-|e|E]+)/;It.UVPattern=/^vt(\s+[\d|.|+|\-|e|E]+)( +[\d|.|+|\-|e|E]+)/;It.FacePattern1=/^f\s+(([\d]{1,}[\s]?){3,})+/;It.FacePattern2=/^f\s+((([\d]{1,}\/[\d]{1,}[\s]?){3,})+)/;It.FacePattern3=/^f\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){3,})+)/;It.FacePattern4=/^f\s+((([\d]{1,}\/\/[\d]{1,}[\s]?){3,})+)/;It.FacePattern5=/^f\s+(((-[\d]{1,}\/-[\d]{1,}\/-[\d]{1,}[\s]?){3,})+)/;It.LinePattern1=/^l\s+(([\d]{1,}[\s]?){2,})+/;It.LinePattern2=/^l\s+((([\d]{1,}\/[\d]{1,}[\s]?){2,})+)/;It.LinePattern3=/^l\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){2,})+)/;class di{static get INVERT_TEXTURE_Y(){return wn.INVERT_TEXTURE_Y}static set INVERT_TEXTURE_Y(e){wn.INVERT_TEXTURE_Y=e}constructor(e){this.name="obj",this.extensions=".obj",this._assetContainer=null,this._loadingOptions=e||di._DefaultLoadingOptions}static get _DefaultLoadingOptions(){return{computeNormals:di.COMPUTE_NORMALS,optimizeNormals:di.OPTIMIZE_NORMALS,importVertexColors:di.IMPORT_VERTEX_COLORS,invertY:di.INVERT_Y,invertTextureY:di.INVERT_TEXTURE_Y,UVScaling:di.UV_SCALING,materialLoadingFailsSilently:di.MATERIAL_LOADING_FAILS_SILENTLY,optimizeWithUV:di.OPTIMIZE_WITH_UV,skipMaterials:di.SKIP_MATERIALS,useLegacyBehavior:di.USE_LEGACY_BEHAVIOR}}_loadMTL(e,t,i,r){const s=t+e;X.LoadFile(s,i,void 0,void 0,!1,(a,l)=>{r(s,l)})}createPlugin(){return new di(di._DefaultLoadingOptions)}canDirectLoad(){return!1}importMeshAsync(e,t,i,r){return this._parseSolid(e,t,i,r).then(s=>({meshes:s,particleSystems:[],skeletons:[],animationGroups:[],transformNodes:[],geometries:[],lights:[],spriteManagers:[]}))}loadAsync(e,t,i){return this.importMeshAsync(null,e,t,i).then(()=>{})}loadAssetContainerAsync(e,t,i){const r=new _F(e);return this._assetContainer=r,this.importMeshAsync(null,e,t,i).then(s=>(s.meshes.forEach(a=>r.meshes.push(a)),s.meshes.forEach(a=>{const l=a.material;l&&r.materials.indexOf(l)==-1&&(r.materials.push(l),l.getActiveTextures().forEach(c=>{r.textures.indexOf(c)==-1&&r.textures.push(c)}))}),this._assetContainer=null,r)).catch(s=>{throw this._assetContainer=null,s})}_parseSolid(e,t,i,r){let s="";const a=new wn,l=[],o=[];new It(l,o,this._loadingOptions).parse(e,i,t,this._assetContainer,h=>{s=h});const u=[];return s!==""&&!this._loadingOptions.skipMaterials&&u.push(new Promise((h,d)=>{this._loadMTL(s,r,f=>{try{a.parseMTL(t,f,r,this._assetContainer);for(let _=0;_<a.materials.length;_++){let p=0;const v=[];let E;for(;(E=l.indexOf(a.materials[_].name,p))>-1;)v.push(E),p=E+1;if(E===-1&&v.length===0)a.materials[_].dispose();else for(let g=0;g<v.length;g++){const m=o[v[g]],y=a.materials[_];m.material=y,m.getTotalIndices()||(y.pointsCloud=!0)}}h()}catch(_){X.Warn(`Error processing MTL file: '${s}'`),this._loadingOptions.materialLoadingFailsSilently?h():d(_)}},(f,_)=>{X.Warn(`Error downloading MTL file: '${s}'`),this._loadingOptions.materialLoadingFailsSilently?h():d(_)})})),Promise.all(u).then(()=>o)}}di.OPTIMIZE_WITH_UV=!0;di.INVERT_Y=!1;di.IMPORT_VERTEX_COLORS=!1;di.COMPUTE_NORMALS=!1;di.OPTIMIZE_NORMALS=!1;di.UV_SCALING=new xe(1,1);di.SKIP_MATERIALS=!1;di.MATERIAL_LOADING_FAILS_SILENTLY=!0;di.USE_LEGACY_BEHAVIOR=!1;ot&&ot.RegisterPlugin(new di);class Ea{constructor(e,t="",i="black"){this._renderingCanvas=e,this._loadingText=t,this._loadingDivBackgroundColor=i,this._resizeLoadingUI=()=>{const r=this._renderingCanvas.getBoundingClientRect(),s=window.getComputedStyle(this._renderingCanvas).position;this._loadingDiv&&(this._loadingDiv.style.position=s==="fixed"?"fixed":"absolute",this._loadingDiv.style.left=r.left+"px",this._loadingDiv.style.top=r.top+"px",this._loadingDiv.style.width=r.width+"px",this._loadingDiv.style.height=r.height+"px")}}displayLoadingUI(){if(this._loadingDiv)return;this._loadingDiv=document.createElement("div"),this._loadingDiv.id="babylonjsLoadingDiv",this._loadingDiv.style.opacity="0",this._loadingDiv.style.transition="opacity 1.5s ease",this._loadingDiv.style.pointerEvents="none",this._loadingDiv.style.display="grid",this._loadingDiv.style.gridTemplateRows="100%",this._loadingDiv.style.gridTemplateColumns="100%",this._loadingDiv.style.justifyItems="center",this._loadingDiv.style.alignItems="center",this._loadingTextDiv=document.createElement("div"),this._loadingTextDiv.style.position="absolute",this._loadingTextDiv.style.left="0",this._loadingTextDiv.style.top="50%",this._loadingTextDiv.style.marginTop="80px",this._loadingTextDiv.style.width="100%",this._loadingTextDiv.style.height="20px",this._loadingTextDiv.style.fontFamily="Arial",this._loadingTextDiv.style.fontSize="14px",this._loadingTextDiv.style.color="white",this._loadingTextDiv.style.textAlign="center",this._loadingTextDiv.style.zIndex="1",this._loadingTextDiv.innerHTML="Loading",this._loadingDiv.appendChild(this._loadingTextDiv),this._loadingTextDiv.innerHTML=this._loadingText,this._style=document.createElement("style"),this._style.type="text/css";const e=`@-webkit-keyframes spin1 {                    0% { -webkit-transform: rotate(0deg);}
                    100% { -webkit-transform: rotate(360deg);}
                }                @keyframes spin1 {                    0% { transform: rotate(0deg);}
                    100% { transform: rotate(360deg);}
                }`;this._style.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(this._style);const t=!!window.SVGSVGElement,i=new Image;Ea.DefaultLogoUrl?i.src=Ea.DefaultLogoUrl:i.src=t?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxODAuMTcgMjA4LjA0Ij48ZGVmcz48c3R5bGU+LmNscy0xe2ZpbGw6I2ZmZjt9LmNscy0ye2ZpbGw6I2UwNjg0Yjt9LmNscy0ze2ZpbGw6I2JiNDY0Yjt9LmNscy00e2ZpbGw6I2UwZGVkODt9LmNscy01e2ZpbGw6I2Q1ZDJjYTt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPkJhYnlsb25Mb2dvPC90aXRsZT48ZyBpZD0iTGF5ZXJfMiIgZGF0YS1uYW1lPSJMYXllciAyIj48ZyBpZD0iUGFnZV9FbGVtZW50cyIgZGF0YS1uYW1lPSJQYWdlIEVsZW1lbnRzIj48cGF0aCBjbGFzcz0iY2xzLTEiIGQ9Ik05MC4wOSwwLDAsNTJWMTU2bDkwLjA5LDUyLDkwLjA4LTUyVjUyWiIvPjxwb2x5Z29uIGNsYXNzPSJjbHMtMiIgcG9pbnRzPSIxODAuMTcgNTIuMDEgMTUxLjk3IDM1LjczIDEyNC44NSA1MS4zOSAxNTMuMDUgNjcuNjcgMTgwLjE3IDUyLjAxIi8+PHBvbHlnb24gY2xhc3M9ImNscy0yIiBwb2ludHM9IjI3LjEyIDY3LjY3IDExNy4yMSAxNS42NiA5MC4wOCAwIDAgNTIuMDEgMjcuMTIgNjcuNjciLz48cG9seWdvbiBjbGFzcz0iY2xzLTIiIHBvaW50cz0iNjEuODkgMTIwLjMgOTAuMDggMTM2LjU4IDExOC4yOCAxMjAuMyA5MC4wOCAxMDQuMDIgNjEuODkgMTIwLjMiLz48cG9seWdvbiBjbGFzcz0iY2xzLTMiIHBvaW50cz0iMTUzLjA1IDY3LjY3IDE1My4wNSAxNDAuMzcgOTAuMDggMTc2LjcyIDI3LjEyIDE0MC4zNyAyNy4xMiA2Ny42NyAwIDUyLjAxIDAgMTU2LjAzIDkwLjA4IDIwOC4wNCAxODAuMTcgMTU2LjAzIDE4MC4xNyA1Mi4wMSAxNTMuMDUgNjcuNjciLz48cG9seWdvbiBjbGFzcz0iY2xzLTMiIHBvaW50cz0iOTAuMDggNzEuNDYgNjEuODkgODcuNzQgNjEuODkgMTIwLjMgOTAuMDggMTA0LjAyIDExOC4yOCAxMjAuMyAxMTguMjggODcuNzQgOTAuMDggNzEuNDYiLz48cG9seWdvbiBjbGFzcz0iY2xzLTQiIHBvaW50cz0iMTUzLjA1IDY3LjY3IDExOC4yOCA4Ny43NCAxMTguMjggMTIwLjMgOTAuMDggMTM2LjU4IDkwLjA4IDE3Ni43MiAxNTMuMDUgMTQwLjM3IDE1My4wNSA2Ny42NyIvPjxwb2x5Z29uIGNsYXNzPSJjbHMtNSIgcG9pbnRzPSIyNy4xMiA2Ny42NyA2MS44OSA4Ny43NCA2MS44OSAxMjAuMyA5MC4wOCAxMzYuNTggOTAuMDggMTc2LjcyIDI3LjEyIDE0MC4zNyAyNy4xMiA2Ny42NyIvPjwvZz48L2c+PC9zdmc+":"https://cdn.babylonjs.com/Assets/babylonLogo.png",i.style.width="150px",i.style.gridColumn="1",i.style.gridRow="1",i.style.top="50%",i.style.left="50%",i.style.transform="translate(-50%, -50%)",i.style.position="absolute";const r=document.createElement("div");r.style.width="300px",r.style.gridColumn="1",r.style.gridRow="1",r.style.top="50%",r.style.left="50%",r.style.transform="translate(-50%, -50%)",r.style.position="absolute";const s=new Image;if(Ea.DefaultSpinnerUrl?s.src=Ea.DefaultSpinnerUrl:s.src=t?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzOTIgMzkyIj48ZGVmcz48c3R5bGU+LmNscy0xe2ZpbGw6I2UwNjg0Yjt9LmNscy0ye2ZpbGw6bm9uZTt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPlNwaW5uZXJJY29uPC90aXRsZT48ZyBpZD0iTGF5ZXJfMiIgZGF0YS1uYW1lPSJMYXllciAyIj48ZyBpZD0iU3Bpbm5lciI+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNNDAuMjEsMTI2LjQzYzMuNy03LjMxLDcuNjctMTQuNDQsMTItMjEuMzJsMy4zNi01LjEsMy41Mi01YzEuMjMtMS42MywyLjQxLTMuMjksMy42NS00LjkxczIuNTMtMy4yMSwzLjgyLTQuNzlBMTg1LjIsMTg1LjIsMCwwLDEsODMuNCw2Ny40M2EyMDgsMjA4LDAsMCwxLDE5LTE1LjY2YzMuMzUtMi40MSw2Ljc0LTQuNzgsMTAuMjUtN3M3LjExLTQuMjgsMTAuNzUtNi4zMmM3LjI5LTQsMTQuNzMtOCwyMi41My0xMS40OSwzLjktMS43Miw3Ljg4LTMuMywxMi00LjY0YTEwNC4yMiwxMDQuMjIsMCwwLDEsMTIuNDQtMy4yMyw2Mi40NCw2Mi40NCwwLDAsMSwxMi43OC0xLjM5QTI1LjkyLDI1LjkyLDAsMCwxLDE5NiwyMS40NGE2LjU1LDYuNTUsMCwwLDEsMi4wNSw5LDYuNjYsNi42NiwwLDAsMS0xLjY0LDEuNzhsLS40MS4yOWEyMi4wNywyMi4wNywwLDAsMS01Ljc4LDMsMzAuNDIsMzAuNDIsMCwwLDEtNS42NywxLjYyLDM3LjgyLDM3LjgyLDAsMCwxLTUuNjkuNzFjLTEsMC0xLjkuMTgtMi44NS4yNmwtMi44NS4yNHEtNS43Mi41MS0xMS40OCwxLjFjLTMuODQuNC03LjcxLjgyLTExLjU4LDEuNGExMTIuMzQsMTEyLjM0LDAsMCwwLTIyLjk0LDUuNjFjLTMuNzIsMS4zNS03LjM0LDMtMTAuOTQsNC42NHMtNy4xNCwzLjUxLTEwLjYsNS41MUExNTEuNiwxNTEuNiwwLDAsMCw2OC41Niw4N0M2Ny4yMyw4OC40OCw2Niw5MCw2NC42NCw5MS41NnMtMi41MSwzLjE1LTMuNzUsNC43M2wtMy41NCw0LjljLTEuMTMsMS42Ni0yLjIzLDMuMzUtMy4zMyw1YTEyNywxMjcsMCwwLDAtMTAuOTMsMjEuNDksMS41OCwxLjU4LDAsMSwxLTMtMS4xNVM0MC4xOSwxMjYuNDcsNDAuMjEsMTI2LjQzWiIvPjxyZWN0IGNsYXNzPSJjbHMtMiIgd2lkdGg9IjM5MiIgaGVpZ2h0PSIzOTIiLz48L2c+PC9nPjwvc3ZnPg==":"https://cdn.babylonjs.com/Assets/loadingIcon.png",s.style.animation="spin1 0.75s infinite linear",s.style.webkitAnimation="spin1 0.75s infinite linear",s.style.transformOrigin="50% 50%",s.style.webkitTransformOrigin="50% 50%",!t){const a={w:16,h:18.5},l={w:30,h:30};i.style.width=`${a.w}vh`,i.style.height=`${a.h}vh`,i.style.left=`calc(50% - ${a.w/2}vh)`,i.style.top=`calc(50% - ${a.h/2}vh)`,s.style.width=`${l.w}vh`,s.style.height=`${l.h}vh`,s.style.left=`calc(50% - ${l.w/2}vh)`,s.style.top=`calc(50% - ${l.h/2}vh)`}r.appendChild(s),this._loadingDiv.appendChild(i),this._loadingDiv.appendChild(r),this._resizeLoadingUI(),window.addEventListener("resize",this._resizeLoadingUI),this._loadingDiv.style.backgroundColor=this._loadingDivBackgroundColor,document.body.appendChild(this._loadingDiv),this._loadingDiv.style.opacity="1"}hideLoadingUI(){if(!this._loadingDiv)return;const e=()=>{this._loadingTextDiv&&(this._loadingTextDiv.remove(),this._loadingTextDiv=null),this._loadingDiv&&(this._loadingDiv.remove(),this._loadingDiv=null),this._style&&(this._style.remove(),this._style=null),window.removeEventListener("resize",this._resizeLoadingUI)};this._loadingDiv.style.opacity="0",this._loadingDiv.addEventListener("transitionend",e)}set loadingUIText(e){this._loadingText=e,this._loadingTextDiv&&(this._loadingTextDiv.innerHTML=this._loadingText)}get loadingUIText(){return this._loadingText}get loadingUIBackgroundColor(){return this._loadingDivBackgroundColor}set loadingUIBackgroundColor(e){this._loadingDivBackgroundColor=e,this._loadingDiv&&(this._loadingDiv.style.backgroundColor=this._loadingDivBackgroundColor)}}Ea.DefaultLogoUrl="";Ea.DefaultSpinnerUrl="";Z.DefaultLoadingScreenFactory=n=>new Ea(n);class lt{constructor(e,t,i=Number.MAX_VALUE,r=ut){this.origin=e,this.direction=t,this.length=i,this.epsilon=r}clone(){return new lt(this.origin.clone(),this.direction.clone(),this.length)}intersectsBoxMinMax(e,t,i=0){const r=lt._TmpVector3[0].copyFromFloats(e.x-i,e.y-i,e.z-i),s=lt._TmpVector3[1].copyFromFloats(t.x+i,t.y+i,t.z+i);let a=0,l=Number.MAX_VALUE,o,c,u,h;if(Math.abs(this.direction.x)<1e-7){if(this.origin.x<r.x||this.origin.x>s.x)return!1}else if(o=1/this.direction.x,c=(r.x-this.origin.x)*o,u=(s.x-this.origin.x)*o,u===-1/0&&(u=1/0),c>u&&(h=c,c=u,u=h),a=Math.max(c,a),l=Math.min(u,l),a>l)return!1;if(Math.abs(this.direction.y)<1e-7){if(this.origin.y<r.y||this.origin.y>s.y)return!1}else if(o=1/this.direction.y,c=(r.y-this.origin.y)*o,u=(s.y-this.origin.y)*o,u===-1/0&&(u=1/0),c>u&&(h=c,c=u,u=h),a=Math.max(c,a),l=Math.min(u,l),a>l)return!1;if(Math.abs(this.direction.z)<1e-7){if(this.origin.z<r.z||this.origin.z>s.z)return!1}else if(o=1/this.direction.z,c=(r.z-this.origin.z)*o,u=(s.z-this.origin.z)*o,u===-1/0&&(u=1/0),c>u&&(h=c,c=u,u=h),a=Math.max(c,a),l=Math.min(u,l),a>l)return!1;return!0}intersectsBox(e,t=0){return this.intersectsBoxMinMax(e.minimum,e.maximum,t)}intersectsSphere(e,t=0){const i=e.center.x-this.origin.x,r=e.center.y-this.origin.y,s=e.center.z-this.origin.z,a=i*i+r*r+s*s,l=e.radius+t,o=l*l;if(a<=o)return!0;const c=i*this.direction.x+r*this.direction.y+s*this.direction.z;return c<0?!1:a-c*c<=o}intersectsTriangle(e,t,i){const r=lt._TmpVector3[0],s=lt._TmpVector3[1],a=lt._TmpVector3[2],l=lt._TmpVector3[3],o=lt._TmpVector3[4];t.subtractToRef(e,r),i.subtractToRef(e,s),A.CrossToRef(this.direction,s,a);const c=A.Dot(r,a);if(c===0)return null;const u=1/c;this.origin.subtractToRef(e,l);const h=A.Dot(l,a)*u;if(h<-this.epsilon||h>1+this.epsilon)return null;A.CrossToRef(l,r,o);const d=A.Dot(this.direction,o)*u;if(d<-this.epsilon||h+d>1+this.epsilon)return null;const f=A.Dot(s,o)*u;return f>this.length?null:new Op(1-h-d,h,f)}intersectsPlane(e){let t;const i=A.Dot(e.normal,this.direction);if(Math.abs(i)<999999997475243e-21)return null;{const r=A.Dot(e.normal,this.origin);return t=(-e.d-r)/i,t<0?t<-999999997475243e-21?null:0:t}}intersectsAxis(e,t=0){switch(e){case"y":{const i=(this.origin.y-t)/this.direction.y;return i>0?null:new A(this.origin.x+this.direction.x*-i,t,this.origin.z+this.direction.z*-i)}case"x":{const i=(this.origin.x-t)/this.direction.x;return i>0?null:new A(t,this.origin.y+this.direction.y*-i,this.origin.z+this.direction.z*-i)}case"z":{const i=(this.origin.z-t)/this.direction.z;return i>0?null:new A(this.origin.x+this.direction.x*-i,this.origin.y+this.direction.y*-i,t)}default:return null}}intersectsMesh(e,t,i,r=!1,s,a=!1){const l=V.Matrix[0];return e.getWorldMatrix().invertToRef(l),this._tmpRay?lt.TransformToRef(this,l,this._tmpRay):this._tmpRay=lt.Transform(this,l),e.intersects(this._tmpRay,t,i,r,s,a)}intersectsMeshes(e,t,i){i?i.length=0:i=[];for(let r=0;r<e.length;r++){const s=this.intersectsMesh(e[r],t);s.hit&&i.push(s)}return i.sort(this._comparePickingInfo),i}_comparePickingInfo(e,t){return e.distance<t.distance?-1:e.distance>t.distance?1:0}intersectionSegment(e,t,i){const r=this.origin,s=V.Vector3[0],a=V.Vector3[1],l=V.Vector3[2],o=V.Vector3[3];t.subtractToRef(e,s),this.direction.scaleToRef(lt._Rayl,l),r.addToRef(l,a),e.subtractToRef(r,o);const c=A.Dot(s,s),u=A.Dot(s,l),h=A.Dot(l,l),d=A.Dot(s,o),f=A.Dot(l,o),_=c*h-u*u;let p,v=_,E,g=_;_<lt._Smallnum?(p=0,v=1,E=f,g=h):(p=u*f-h*d,E=c*f-u*d,p<0?(p=0,E=f,g=h):p>v&&(p=v,E=f+u,g=h)),E<0?(E=0,-d<0?p=0:-d>c?p=v:(p=-d,v=c)):E>g&&(E=g,-d+u<0?p=0:-d+u>c?p=v:(p=-d+u,v=c));const m=Math.abs(p)<lt._Smallnum?0:p/v,y=Math.abs(E)<lt._Smallnum?0:E/g,T=V.Vector3[4];l.scaleToRef(y,T);const b=V.Vector3[5];s.scaleToRef(m,b),b.addInPlace(o);const C=V.Vector3[6];return b.subtractToRef(T,C),y>0&&y<=this.length&&C.lengthSquared()<i*i?b.length():-1}update(e,t,i,r,s,a,l,o=!1){if(o){lt._RayDistant||(lt._RayDistant=lt.Zero()),lt._RayDistant.unprojectRayToRef(e,t,i,r,z.IdentityReadOnly,a,l);const c=V.Matrix[0];s.invertToRef(c),lt.TransformToRef(lt._RayDistant,c,this)}else this.unprojectRayToRef(e,t,i,r,s,a,l);return this}static Zero(){return new lt(A.Zero(),A.Zero())}static CreateNew(e,t,i,r,s,a,l){return lt.Zero().update(e,t,i,r,s,a,l)}static CreateNewFromTo(e,t,i=z.IdentityReadOnly){const r=new lt(new A(0,0,0),new A(0,0,0));return lt.CreateFromToToRef(e,t,r,i)}static CreateFromToToRef(e,t,i,r=z.IdentityReadOnly){i.origin.copyFrom(e);const s=t.subtractToRef(e,i.direction),a=Math.sqrt(s.x*s.x+s.y*s.y+s.z*s.z);return i.length=a,i.direction.normalize(),lt.TransformToRef(i,r,i)}static Transform(e,t){const i=new lt(new A(0,0,0),new A(0,0,0));return lt.TransformToRef(e,t,i),i}static TransformToRef(e,t,i){A.TransformCoordinatesToRef(e.origin,t,i.origin),A.TransformNormalToRef(e.direction,t,i.direction),i.length=e.length,i.epsilon=e.epsilon;const r=i.direction,s=r.length();if(!(s===0||s===1)){const a=1/s;r.x*=a,r.y*=a,r.z*=a,i.length*=s}return i}unprojectRayToRef(e,t,i,r,s,a,l){const o=V.Matrix[0];s.multiplyToRef(a,o),o.multiplyToRef(l,o),o.invert();const c=He.LastCreatedEngine,u=V.Vector3[0];u.x=e/i*2-1,u.y=-(t/r*2-1),u.z=c!=null&&c.useReverseDepthBuffer?1:c!=null&&c.isNDCHalfZRange?0:-1;const h=V.Vector3[1].copyFromFloats(u.x,u.y,1-1e-8),d=V.Vector3[2],f=V.Vector3[3];A._UnprojectFromInvertedMatrixToRef(u,o,d),A._UnprojectFromInvertedMatrixToRef(h,o,f),this.origin.copyFrom(d),f.subtractToRef(d,this.direction),this.direction.normalize()}}lt._TmpVector3=Zi.BuildArray(6,A.Zero);lt._RayDistant=lt.Zero();lt._Smallnum=1e-8;lt._Rayl=1e9;Pt.prototype.createPickingRay=function(n,e,t,i,r=!1){const s=lt.Zero();return this.createPickingRayToRef(n,e,t,s,i,r),s};Pt.prototype.createPickingRayToRef=function(n,e,t,i,r,s=!1,a=!1){const l=this.getEngine();if(!r&&!(r=this.activeCamera))return this;const o=r.viewport,c=l.getRenderHeight(),{x:u,y:h,width:d,height:f}=o.toGlobal(l.getRenderWidth(),c),_=1/l.getHardwareScalingLevel();return n=n*_-u,e=e*_-(c-h-f),i.update(n,e,d,f,t||z.IdentityReadOnly,s?z.IdentityReadOnly:r.getViewMatrix(),r.getProjectionMatrix(),a),this};Pt.prototype.createPickingRayInCameraSpace=function(n,e,t){const i=lt.Zero();return this.createPickingRayInCameraSpaceToRef(n,e,i,t),i};Pt.prototype.createPickingRayInCameraSpaceToRef=function(n,e,t,i){if(!Fs)return this;const r=this.getEngine();if(!i&&!(i=this.activeCamera))throw new Error("Active camera not set");const s=i.viewport,a=r.getRenderHeight(),{x:l,y:o,width:c,height:u}=s.toGlobal(r.getRenderWidth(),a),h=z.Identity(),d=1/r.getHardwareScalingLevel();return n=n*d-l,e=e*d-(a-o-u),t.update(n,e,c,u,h,h,i.getProjectionMatrix()),this};Pt.prototype._internalPickForMesh=function(n,e,t,i,r,s,a,l){const o=e(i,t.enableDistantPicking),c=t.intersects(o,r,a,s,i,l);return!c||!c.hit||!r&&n!=null&&c.distance>=n.distance?null:c};Pt.prototype._internalPick=function(n,e,t,i,r){let s=null;const a=!!(this.activeCameras&&this.activeCameras.length>1&&this.cameraToUseForPointers!==this.activeCamera),l=this.cameraToUseForPointers||this.activeCamera;for(let o=0;o<this.meshes.length;o++){const c=this.meshes[o];if(e){if(!e(c))continue}else if(!c.isEnabled()||!c.isVisible||!c.isPickable)continue;const u=a&&c.isWorldMatrixCameraDependent(),h=c.computeWorldMatrix(u,l);if(c.hasThinInstances&&c.thinInstanceEnablePicking){const d=this._internalPickForMesh(s,n,c,h,!0,!0,r);if(d){if(i)return d;const f=V.Matrix[1],_=c.thinInstanceGetWorldMatrices();for(let p=0;p<_.length;p++){_[p].multiplyToRef(h,f);const E=this._internalPickForMesh(s,n,c,f,t,i,r,!0);if(E&&(s=E,s.thinInstanceIndex=p,t))return s}}}else{const d=this._internalPickForMesh(s,n,c,h,t,i,r);if(d&&(s=d,t))return s}}return s||new Fs};Pt.prototype._internalMultiPick=function(n,e,t){if(!Fs)return null;const i=[],r=!!(this.activeCameras&&this.activeCameras.length>1&&this.cameraToUseForPointers!==this.activeCamera),s=this.cameraToUseForPointers||this.activeCamera;for(let a=0;a<this.meshes.length;a++){const l=this.meshes[a];if(e){if(!e(l))continue}else if(!l.isEnabled()||!l.isVisible||!l.isPickable)continue;const o=r&&l.isWorldMatrixCameraDependent(),c=l.computeWorldMatrix(o,s);if(l.hasThinInstances&&l.thinInstanceEnablePicking){if(this._internalPickForMesh(null,n,l,c,!0,!0,t)){const h=V.Matrix[1],d=l.thinInstanceGetWorldMatrices();for(let f=0;f<d.length;f++){d[f].multiplyToRef(c,h);const p=this._internalPickForMesh(null,n,l,h,!1,!1,t,!0);p&&(p.thinInstanceIndex=f,i.push(p))}}}else{const u=this._internalPickForMesh(null,n,l,c,!1,!1,t);u&&i.push(u)}}return i};Pt.prototype.pickWithBoundingInfo=function(n,e,t,i,r){if(!Fs)return null;const s=this._internalPick(a=>(this._tempPickingRay||(this._tempPickingRay=lt.Zero()),this.createPickingRayToRef(n,e,a,this._tempPickingRay,r||null),this._tempPickingRay),t,i,!0);return s&&(s.ray=this.createPickingRay(n,e,z.Identity(),r||null)),s};Object.defineProperty(Pt.prototype,"_pickingAvailable",{get:()=>!0,enumerable:!1,configurable:!1});Pt.prototype.pick=function(n,e,t,i,r,s,a=!1){const l=this._internalPick((o,c)=>(this._tempPickingRay||(this._tempPickingRay=lt.Zero()),this.createPickingRayToRef(n,e,o,this._tempPickingRay,r||null,!1,c),this._tempPickingRay),t,i,!1,s);return l&&(l.ray=this.createPickingRay(n,e,z.Identity(),r||null)),l};Pt.prototype.pickWithRay=function(n,e,t,i){const r=this._internalPick(s=>(this._pickWithRayInverseMatrix||(this._pickWithRayInverseMatrix=z.Identity()),s.invertToRef(this._pickWithRayInverseMatrix),this._cachedRayForTransform||(this._cachedRayForTransform=lt.Zero()),lt.TransformToRef(n,this._pickWithRayInverseMatrix,this._cachedRayForTransform),this._cachedRayForTransform),e,t,!1,i);return r&&(r.ray=n),r};Pt.prototype.multiPick=function(n,e,t,i,r){return this._internalMultiPick(s=>this.createPickingRay(n,e,s,i||null),t,r)};Pt.prototype.multiPickWithRay=function(n,e,t){return this._internalMultiPick(i=>(this._pickWithRayInverseMatrix||(this._pickWithRayInverseMatrix=z.Identity()),i.invertToRef(this._pickWithRayInverseMatrix),this._cachedRayForTransform||(this._cachedRayForTransform=lt.Zero()),lt.TransformToRef(n,this._pickWithRayInverseMatrix,this._cachedRayForTransform),this._cachedRayForTransform),e,t)};Ie.prototype.getForwardRay=function(n=100,e,t){return this.getForwardRayToRef(new lt(A.Zero(),A.Zero(),n),n,e,t)};Ie.prototype.getForwardRayToRef=function(n,e=100,t,i){t||(t=this.getWorldMatrix()),n.length=e,i?n.origin.copyFrom(i):n.origin.copyFrom(this.position);const r=V.Vector3[2];r.set(0,0,this._scene.useRightHandedSystem?-1:1);const s=V.Vector3[3];return A.TransformNormalToRef(r,t,s),A.NormalizeToRef(s,n.direction),n};ArrayBuffer.prototype.toAscii=function(){const n=new Uint8Array(this);let e="";for(const t of n)t<32||t>126||(e+=String.fromCharCode(t));return e};ArrayBuffer.prototype.sliceAt=function(n,e){return this.slice(n,n+e)};DataView.prototype.getAscii=function(n,e){return this.buffer.slice(n,n+e).toAscii()};function Ge(){return Ge=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Ge.apply(this,arguments)}function z4(n){if(Array.isArray(n))return n}function V4(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,a,l=[],o=!0,c=!1;try{if(s=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;o=!1}else for(;!(o=(i=s.call(t)).done)&&(l.push(i.value),l.length!==e);o=!0);}catch(u){c=!0,r=u}finally{try{if(!o&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw r}}return l}}function Dp(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function N1(n,e){if(n){if(typeof n=="string")return Dp(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Dp(n,e)}}function G4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yt(n,e){return z4(n)||V4(n,e)||N1(n,e)||G4()}function W4(n,e){if(n==null)return{};var t={};for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){if(e.indexOf(i)>=0)continue;t[i]=n[i]}return t}function pt(n,e){if(n==null)return{};var t=W4(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}var H4={},To={},F1={};function j4(n){for(var e=5381,t=n.length;t;)e=e*33^n.charCodeAt(--t);return e>>>0}var X4=j4,k1={};(function(n){n.__esModule=!0,n.default=void 0;function e(l,o){for(var c=0;c<o.length;c++){var u=o[c];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(l,u.key,u)}}function t(l,o,c){return o&&e(l.prototype,o),l}var i=typeof process<"u"&&H4&&!0,r=function(o){return Object.prototype.toString.call(o)==="[object String]"},s=function(){function l(c){var u=c===void 0?{}:c,h=u.name,d=h===void 0?"stylesheet":h,f=u.optimizeForSpeed,_=f===void 0?i:f,p=u.isBrowser,v=p===void 0?typeof window<"u":p;a(r(d),"`name` must be a string"),this._name=d,this._deletedRulePlaceholder="#"+d+"-deleted-rule____{}",a(typeof _=="boolean","`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=_,this._isBrowser=v,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var E=this._isBrowser&&document.querySelector('meta[property="csp-nonce"]');this._nonce=E?E.getAttribute("content"):null}var o=l.prototype;return o.setOptimizeForSpeed=function(u){a(typeof u=="boolean","`setOptimizeForSpeed` accepts a boolean"),a(this._rulesCount===0,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=u,this.inject()},o.isOptimizeForSpeed=function(){return this._optimizeForSpeed},o.inject=function(){var u=this;if(a(!this._injected,"sheet already injected"),this._injected=!0,this._isBrowser&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(i||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(d,f){return typeof f=="number"?u._serverSheet.cssRules[f]={cssText:d}:u._serverSheet.cssRules.push({cssText:d}),f},deleteRule:function(d){u._serverSheet.cssRules[d]=null}}},o.getSheetForTag=function(u){if(u.sheet)return u.sheet;for(var h=0;h<document.styleSheets.length;h++)if(document.styleSheets[h].ownerNode===u)return document.styleSheets[h]},o.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},o.insertRule=function(u,h){if(a(r(u),"`insertRule` accepts only strings"),!this._isBrowser)return typeof h!="number"&&(h=this._serverSheet.cssRules.length),this._serverSheet.insertRule(u,h),this._rulesCount++;if(this._optimizeForSpeed){var d=this.getSheet();typeof h!="number"&&(h=d.cssRules.length);try{d.insertRule(u,h)}catch{return i||console.warn(`StyleSheet: illegal rule: 

`+u+`

See https://stackoverflow.com/q/20007992 for more info`),-1}}else{var f=this._tags[h];this._tags.push(this.makeStyleTag(this._name,u,f))}return this._rulesCount++},o.replaceRule=function(u,h){if(this._optimizeForSpeed||!this._isBrowser){var d=this._isBrowser?this.getSheet():this._serverSheet;if(h.trim()||(h=this._deletedRulePlaceholder),!d.cssRules[u])return u;d.deleteRule(u);try{d.insertRule(h,u)}catch{i||console.warn(`StyleSheet: illegal rule: 

`+h+`

See https://stackoverflow.com/q/20007992 for more info`),d.insertRule(this._deletedRulePlaceholder,u)}}else{var f=this._tags[u];a(f,"old rule at index `"+u+"` not found"),f.textContent=h}return u},o.deleteRule=function(u){if(!this._isBrowser){this._serverSheet.deleteRule(u);return}if(this._optimizeForSpeed)this.replaceRule(u,"");else{var h=this._tags[u];a(h,"rule at index `"+u+"` not found"),h.parentNode.removeChild(h),this._tags[u]=null}},o.flush=function(){this._injected=!1,this._rulesCount=0,this._isBrowser?(this._tags.forEach(function(u){return u&&u.parentNode.removeChild(u)}),this._tags=[]):this._serverSheet.cssRules=[]},o.cssRules=function(){var u=this;return this._isBrowser?this._tags.reduce(function(h,d){return d?h=h.concat(Array.prototype.map.call(u.getSheetForTag(d).cssRules,function(f){return f.cssText===u._deletedRulePlaceholder?null:f})):h.push(null),h},[]):this._serverSheet.cssRules},o.makeStyleTag=function(u,h,d){h&&a(r(h),"makeStyleTag acceps only strings as second parameter");var f=document.createElement("style");this._nonce&&f.setAttribute("nonce",this._nonce),f.type="text/css",f.setAttribute("data-"+u,""),h&&f.appendChild(document.createTextNode(h));var _=document.head||document.getElementsByTagName("head")[0];return d?_.insertBefore(f,d):_.appendChild(f),f},t(l,[{key:"length",get:function(){return this._rulesCount}}]),l}();n.default=s;function a(l,o){if(!l)throw new Error("StyleSheet: "+o+".")}})(k1);(function(n){n.__esModule=!0,n.default=void 0;var e=i(X4),t=i(k1);function i(l){return l&&l.__esModule?l:{default:l}}var r=function(o){return o.replace(/\/style/gi,"\\/style")},s=function(){function l(c){var u=c===void 0?{}:c,h=u.styleSheet,d=h===void 0?null:h,f=u.optimizeForSpeed,_=f===void 0?!1:f,p=u.isBrowser,v=p===void 0?typeof window<"u":p;this._sheet=d||new t.default({name:"styled-jsx",optimizeForSpeed:_}),this._sheet.inject(),d&&typeof _=="boolean"&&(this._sheet.setOptimizeForSpeed(_),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._isBrowser=v,this._fromServer=void 0,this._indices={},this._instancesCounts={},this.computeId=this.createComputeId(),this.computeSelector=this.createComputeSelector()}var o=l.prototype;return o.add=function(u){var h=this;this._optimizeForSpeed===void 0&&(this._optimizeForSpeed=Array.isArray(u.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._isBrowser&&!this._fromServer&&(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(v,E){return v[E]=0,v},{}));var d=this.getIdAndRules(u),f=d.styleId,_=d.rules;if(f in this._instancesCounts){this._instancesCounts[f]+=1;return}var p=_.map(function(v){return h._sheet.insertRule(v)}).filter(function(v){return v!==-1});this._indices[f]=p,this._instancesCounts[f]=1},o.remove=function(u){var h=this,d=this.getIdAndRules(u),f=d.styleId;if(a(f in this._instancesCounts,"styleId: `"+f+"` not found"),this._instancesCounts[f]-=1,this._instancesCounts[f]<1){var _=this._fromServer&&this._fromServer[f];_?(_.parentNode.removeChild(_),delete this._fromServer[f]):(this._indices[f].forEach(function(p){return h._sheet.deleteRule(p)}),delete this._indices[f]),delete this._instancesCounts[f]}},o.update=function(u,h){this.add(h),this.remove(u)},o.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={},this.computeId=this.createComputeId(),this.computeSelector=this.createComputeSelector()},o.cssRules=function(){var u=this,h=this._fromServer?Object.keys(this._fromServer).map(function(f){return[f,u._fromServer[f]]}):[],d=this._sheet.cssRules();return h.concat(Object.keys(this._indices).map(function(f){return[f,u._indices[f].map(function(_){return d[_].cssText}).join(u._optimizeForSpeed?"":`
`)]}).filter(function(f){return!!f[1]}))},o.createComputeId=function(){var u={};return function(h,d){if(!d)return"jsx-"+h;var f=String(d),_=h+f;return u[_]||(u[_]="jsx-"+(0,e.default)(h+"-"+f)),u[_]}},o.createComputeSelector=function(u){u===void 0&&(u=/__jsx-style-dynamic-selector/g);var h={};return function(d,f){this._isBrowser||(f=r(f));var _=d+f;return h[_]||(h[_]=f.replace(u,d)),h[_]}},o.getIdAndRules=function(u){var h=this,d=u.children,f=u.dynamic,_=u.id;if(f){var p=this.computeId(_,f);return{styleId:p,rules:Array.isArray(d)?d.map(function(v){return h.computeSelector(p,v)}):[this.computeSelector(p,d)]}}return{styleId:this.computeId(_),rules:Array.isArray(d)?d:[d]}},o.selectFromServer=function(){var u=Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]'));return u.reduce(function(h,d){var f=d.id.slice(2);return h[f]=d,h},{})},l}();n.default=s;function a(l,o){if(!l)throw new Error("StyleSheetRegistry: "+o+".")}})(F1);(function(n){n.__esModule=!0,n.default=s,n.flush=a;var e=k,t=i(F1);function i(l){return l&&l.__esModule?l:{default:l}}var r=new t.default;function s(l){return typeof window>"u"?(r.add(l),null):((0,e.useLayoutEffect)(function(){return r.add(l),function(){r.remove(l)}},[l.id,String(l.dynamic)]),null)}s.dynamic=function(l){return l.map(function(o){var c=o[0],u=o[1];return r.computeId(c,u)}).join(" ")};function a(){var l=r.cssRules();return r.flush(),l}})(To);var Q=To.default||To;Q.flush=To.flush;var id={};(function(n){n.__esModule=!0,n.default=r,n.flushToHTML=s;var e=i(k),t=To.default||To;t.flush=To.flush;function i(a){return a&&a.__esModule?a:{default:a}}function r(a){return a===void 0&&(a={}),(0,t.flush)().map(function(l){var o=l[0],c=l[1];return e.default.createElement("style",{id:"__"+o,key:"__"+o,nonce:a.nonce?a.nonce:void 0,dangerouslySetInnerHTML:{__html:c}})})}function s(a){return a===void 0&&(a={}),(0,t.flush)().reduce(function(l,o){var c=o[0],u=o[1];return l+='<style id="__'+c+'"'+(a.nonce?' nonce="'+a.nonce+'"':"")+">"+u+"</style>",l},"")}})(id);var xm=id.default||id;xm.flushToHTML=id.flushToHTML;function rd(n){"@babel/helpers - typeof";return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rd(n)}var B1={sans:'"Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif',mono:"Menlo, Monaco, Lucida Console, Liberation Mono, DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace",prism:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,"Liberation Mono", "Courier New", monospace'},nd={xs:{min:"0",max:"650px"},sm:{min:"650px",max:"900px"},md:{min:"900px",max:"1280px"},lg:{min:"1280px",max:"1920px"},xl:{min:"1920px",max:"10000px"}},U1={gap:"16pt",gapNegative:"-16pt",gapHalf:"8pt",gapHalfNegative:"-8pt",gapQuarter:"4pt",gapQuarterNegative:"-4pt",pageMargin:"16pt",pageWidth:"750pt",pageWidthWithMargin:"782pt",breakpointMobile:nd.xs.max,breakpointTablet:nd.sm.max,radius:"6px",unit:"16px"},Y4={accents_1:"#fafafa",accents_2:"#eaeaea",accents_3:"#999",accents_4:"#888",accents_5:"#666",accents_6:"#444",accents_7:"#333",accents_8:"#111",background:"#fff",foreground:"#000",selection:"#79ffe1",secondary:"#666",code:"#f81ce5",border:"#eaeaea",error:"#e00",errorLight:"#ff1a1a",errorLighter:"#f7d4d6",errorDark:"#c50000",success:"#0070f3",successLight:"#3291ff",successLighter:"#d3e5ff",successDark:"#0761d1",warning:"#f5a623",warningLight:"#f7b955",warningLighter:"#ffefcf",warningDark:"#ab570a",cyan:"#50e3c2",cyanLighter:"#aaffec",cyanLight:"#79ffe1",cyanDark:"#29bc9b",violet:"#7928ca",violetLighter:"#e3d7fc",violetLight:"#8a63d2",violetDark:"#4c2889",purple:"#f81ce5",alert:"#ff0080",magenta:"#eb367f",link:"#0070f3"},K4={linkStyle:"none",linkHoverStyle:"none",dropdownBoxShadow:"0 4px 4px 0 rgba(0, 0, 0, 0.02)",scrollerStart:"rgba(255, 255, 255, 1)",scrollerEnd:"rgba(255, 255, 255, 0)",shadowSmall:"0 5px 10px rgba(0, 0, 0, 0.12)",shadowMedium:"0 8px 30px rgba(0, 0, 0, 0.12)",shadowLarge:"0 30px 60px rgba(0, 0, 0, 0.12)",portalOpacity:.25},q4=B1,$4=nd,Q4=U1,Mm={type:"light",font:q4,layout:Q4,palette:Y4,breakpoints:$4,expressiveness:K4},Z4={accents_1:"#111",accents_2:"#333",accents_3:"#444",accents_4:"#666",accents_5:"#888",accents_6:"#999",accents_7:"#eaeaea",accents_8:"#fafafa",background:"#000",foreground:"#fff",selection:"#f81ce5",secondary:"#888",code:"#79ffe1",border:"#333",error:"#e00",errorLighter:"#f7d4d6",errorLight:"#ff1a1a",errorDark:"#c50000",success:"#0070f3",successLighter:"#d3e5ff",successLight:"#3291ff",successDark:"#0761d1",warning:"#f5a623",warningLighter:"#ffefcf",warningLight:"#f7b955",warningDark:"#ab570a",cyan:"#50e3c2",cyanLighter:"#aaffec",cyanLight:"#79ffe1",cyanDark:"#29bc9b",violet:"#7928ca",violetLighter:"#e3d7fc",violetLight:"#8a63d2",violetDark:"#4c2889",purple:"#f81ce5",alert:"#ff0080",magenta:"#eb367f",link:"#3291ff"},J4={linkStyle:"none",linkHoverStyle:"none",dropdownBoxShadow:"0 0 0 1px #333",scrollerStart:"rgba(255, 255, 255, 1)",scrollerEnd:"rgba(255, 255, 255, 0)",shadowSmall:"0 0 0 1px #333",shadowMedium:"0 0 0 1px #333",shadowLarge:"0 0 0 1px #333",portalOpacity:.75},ek=B1,tk=nd,ik=U1,z1={type:"dark",font:ek,layout:ik,palette:Z4,breakpoints:tk,expressiveness:J4},lh=function(e){return e&&rd(e)==="object"},rk=function n(e,t){if(!lh(t)||!lh(e))return e;for(var i=Object.keys(e),r={},s=0,a=i;s<a.length;s++){var l=a[s],o=e[l],c=t[l];Array.isArray(o)&&Array.isArray(c)?r[l]=c.concat(o):lh(o)&&lh(c)?r[l]=n(o,Ge({},c)):c?r[l]=c:r[l]=o}return r},V1=function(){return[Mm,z1]},nk=function(){return Mm},Zd=function(e){if(!e)return!1;var t=V1(),i=t.find(function(r){return r.type===e});return!i},sk=function(e){if(!e)return!1;var t=typeof e=="string",i=t?e:e.type;return!Zd(i)},ak=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return!!e.find(function(t){return Zd(t.type)})},Im=function(e,t){if(!Zd(t.type))throw new Error("Duplicate or unavailable theme type");return rk(e,t)},ok=function(e){return Im(z1,e)},lk=function(e){return Im(Mm,e)},cl={isPresetTheme:sk,isAvailableThemeType:Zd,hasUserCustomTheme:ak,getPresets:V1,getPresetStaticTheme:nk,create:Im,createFromDark:ok,createFromLight:lk},ck=cl.getPresetStaticTheme(),G1=k.createContext(ck),Lt=function(){return k.useContext(G1)},uk=function(e){for(var t=Object.keys(e),i=t.length,r="",s=0;s<i;s++){var a=t[s],l=e[t[s]];l&&(r=r?"".concat(r," ").concat(String(a)):String(a))}return r},hk=function(e){return rd(e)==="object"&&!Array.isArray(e)},Ut=function(){var e=arguments.length,t="";if(e===0)return t;for(var i=0;i<e;i++){var r=i<0||arguments.length<=i?void 0:arguments[i];r&&(hk(r)?t+=" ".concat(uk(r)):t+=" ".concat(String(r).trim()))}return t.trim()},dk=["width","height","padding","margin","w","h","paddingLeft","paddingRight","paddingTop","paddingBottom","pl","pr","pt","pb","marginLeft","marginRight","marginTop","marginBottom","ml","mr","mt","mb","px","py","mx","my","font","unit","scale"],Rr=function(e){return"".concat(e)},fk={getScaleProps:function(){},getAllScaleProps:function(){return{}},SCALES:{pl:Rr,pr:Rr,pb:Rr,pt:Rr,px:Rr,py:Rr,mb:Rr,ml:Rr,mr:Rr,mt:Rr,mx:Rr,my:Rr,width:Rr,height:Rr,font:Rr},unit:"16px"},W1=k.createContext(fk),$t=function(){return k.useContext(W1)},H1=function(){return Math.random().toString(32).slice(2,10)},j1=function(e,t){var i=k.Children.map(e,function(r){return k.isValidElement(r)?r.type:null});return(i||[]).includes(t)},sd=function(e,t){var i=[],r=k.Children.map(e,function(a){return k.isValidElement(a)&&a.type===t?(i.push(a),null):a}),s=i.length>=0?i:void 0;return[r,s]},_k=function(e,t,i){var r=[],s=Array.isArray(i),a=k.Children.map(e,function(o){return k.isValidElement(o)?o.props?s?i.includes(o.props[t])?(r.push(o),null):o:o.props[t]===i?(r.push(o),null):o:o:null}),l=r.length>=0?r:void 0;return[a,l]},pk=function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(k.Children.count(e)===0)return[];var r=i.length===0,s=function(l){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k.cloneElement(l,o)};return k.Children.map(e,function(a){if(!k.isValidElement(a))return a;if(r)return s(a,t);var l=i.find(function(o){return o===a.type});return l?s(a,t):a})},gk=function(e,t){if(!e||!t)return!1;for(var i=t;i;){if(i===e)return!0;i=i.parentNode}return!1},X1=function(){return!!(typeof window<"u"&&window.document&&window.document.createElement)},uE=function(){return X1()?navigator.platform.toUpperCase().indexOf("MAC")>=0:!1},mk=function(e){return e!==void 0&&!Number.isNaN(+e)};function Y1(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=vk(n))||e){t&&(n=t);var i=0,r=function(){};return{s:r,n:function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}},e:function(c){throw c},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,l;return{s:function(){t=t.call(n)},n:function(){var c=t.next();return s=c.done,c},e:function(c){a=!0,l=c},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(a)throw l}}}}function vk(n,e){if(n){if(typeof n=="string")return hE(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return hE(n,e)}}function hE(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}var Ek=function(e){var t=function(r){if(!Array.isArray(r))return e[r];var s=void 0,a=Y1(r),l;try{for(a.s();!(l=a.n()).done;){var o=l.value,c=e[o];typeof c<"u"&&(s=c)}}catch(u){a.e(u)}finally{a.f()}return s};return t},yk=function(e){var t=function(){var r={},s=Y1(dk),a;try{for(s.s();!(a=s.n()).done;){var l=a.value,o=e[l];typeof o<"u"&&(r[l]=o)}}catch(c){s.e(c)}finally{s.f()}return r};return t},Tk=["children"],bk=["paddingLeft","pl","paddingRight","pr","paddingTop","pt","paddingBottom","pb","marginTop","mt","marginRight","mr","marginBottom","mb","marginLeft","ml","px","py","mx","my","width","height","font","w","h","margin","padding","unit","scale"],Ck=function(e){if(e===1)return e;var t=Math.abs((e-1)/2);return e>1?1+t:1-t},oi=function(e){var t=S.forwardRef(function(i,r){var s,a,l,o,c,u,h,d,f,_,p,v,E,g,m,y,T,b,C,M,F,P,U,G,K,q,se,Ee,Se,$,_e,ae,ce=i.children,he=pt(i,Tk),je=Lt(),Xe=je.layout,Tt=he.paddingLeft,Ze=he.pl,W=he.paddingRight,pe=he.pr,De=he.paddingTop,ft=he.pt,st=he.paddingBottom,$e=he.pb,bt=he.marginTop,Wt=he.mt,rt=he.marginRight,Ht=he.mr,Ni=he.marginBottom,Ar=he.mb,$s=he.marginLeft,jo=he.ml,ds=he.px,Hr=he.py,jr=he.mx,Yn=he.my,fs=he.width,Fr=he.height,_s=he.font,Xo=he.w,Qs=he.h,Kn=he.margin,ur=he.padding,$a=he.unit,Zs=$a===void 0?Xe.unit:$a,Qa=he.scale,fc=Qa===void 0?1:Qa,Yo=pt(he,bk),Ai=function(Js){return function(ea,ta){ea===0&&(ea=1,ta=ta||0);var Za=Ck(fc)*ea;if(typeof Js>"u")return typeof ta<"u"?"".concat(ta):"calc(".concat(Za," * ").concat(Zs,")");if(!mk(Js))return"".concat(Js);var _c=Za*Number(Js);return"calc(".concat(_c," * ").concat(Zs,")")}},Ko={unit:Zs,SCALES:{pt:Ai((s=(a=De??ft)!==null&&a!==void 0?a:Hr)!==null&&s!==void 0?s:ur),pr:Ai((l=(o=W??pe)!==null&&o!==void 0?o:ds)!==null&&l!==void 0?l:ur),pb:Ai((c=(u=st??$e)!==null&&u!==void 0?u:Hr)!==null&&c!==void 0?c:ur),pl:Ai((h=(d=Tt??Ze)!==null&&d!==void 0?d:ds)!==null&&h!==void 0?h:ur),px:Ai((f=(_=(p=(v=ds??Tt)!==null&&v!==void 0?v:W)!==null&&p!==void 0?p:Ze)!==null&&_!==void 0?_:pe)!==null&&f!==void 0?f:ur),py:Ai((E=(g=(m=(y=Hr??De)!==null&&y!==void 0?y:st)!==null&&m!==void 0?m:ft)!==null&&g!==void 0?g:$e)!==null&&E!==void 0?E:ur),mt:Ai((T=(b=bt??Wt)!==null&&b!==void 0?b:Yn)!==null&&T!==void 0?T:Kn),mr:Ai((C=(M=rt??Ht)!==null&&M!==void 0?M:jr)!==null&&C!==void 0?C:Kn),mb:Ai((F=(P=Ni??Ar)!==null&&P!==void 0?P:Yn)!==null&&F!==void 0?F:Kn),ml:Ai((U=(G=$s??jo)!==null&&G!==void 0?G:jr)!==null&&U!==void 0?U:Kn),mx:Ai((K=(q=(se=(Ee=jr??$s)!==null&&Ee!==void 0?Ee:rt)!==null&&se!==void 0?se:jo)!==null&&q!==void 0?q:Ht)!==null&&K!==void 0?K:Kn),my:Ai((Se=($=(_e=(ae=Yn??bt)!==null&&ae!==void 0?ae:Ni)!==null&&_e!==void 0?_e:Wt)!==null&&$!==void 0?$:Ar)!==null&&Se!==void 0?Se:Kn),width:Ai(fs??Xo),height:Ai(Fr??Qs),font:Ai(_s)},getScaleProps:Ek(he),getAllScaleProps:yk(he)};return k.createElement(W1.Provider,{value:Ko},k.createElement(e,Ge({},Yo,{ref:r}),ce))});return t.displayName="Scale".concat(e.displayName||"Wrapper"),t},Wn=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t};Wn("default","secondary","success","warning","error","abort","secondary-light","success-light","warning-light","error-light");Wn("default","secondary","success","warning","error");Wn("default","secondary","success","warning","error","dark","lite");Wn("default","secondary","success","warning","error","dark","lite","alert","purple","violet","cyan");Wn("default","silent","prevent");Wn("hover","click");Wn("top","topStart","topEnd","left","leftStart","leftEnd","bottom","bottomStart","bottomEnd","right","rightStart","rightEnd");Wn("start","center","end","left","right");var K1={exports:{}},tn={},q1={exports:{}},$1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e($,_e){var ae=$.length;$.push(_e);e:for(;0<ae;){var ce=ae-1>>>1,he=$[ce];if(0<r(he,_e))$[ce]=_e,$[ae]=he,ae=ce;else break e}}function t($){return $.length===0?null:$[0]}function i($){if($.length===0)return null;var _e=$[0],ae=$.pop();if(ae!==_e){$[0]=ae;e:for(var ce=0,he=$.length,je=he>>>1;ce<je;){var Xe=2*(ce+1)-1,Tt=$[Xe],Ze=Xe+1,W=$[Ze];if(0>r(Tt,ae))Ze<he&&0>r(W,Tt)?($[ce]=W,$[Ze]=ae,ce=Ze):($[ce]=Tt,$[Xe]=ae,ce=Xe);else if(Ze<he&&0>r(W,ae))$[ce]=W,$[Ze]=ae,ce=Ze;else break e}}return _e}function r($,_e){var ae=$.sortIndex-_e.sortIndex;return ae!==0?ae:$.id-_e.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();n.unstable_now=function(){return a.now()-l}}var o=[],c=[],u=1,h=null,d=3,f=!1,_=!1,p=!1,v=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m($){for(var _e=t(c);_e!==null;){if(_e.callback===null)i(c);else if(_e.startTime<=$)i(c),_e.sortIndex=_e.expirationTime,e(o,_e);else break;_e=t(c)}}function y($){if(p=!1,m($),!_)if(t(o)!==null)_=!0,Ee(T);else{var _e=t(c);_e!==null&&Se(y,_e.startTime-$)}}function T($,_e){_=!1,p&&(p=!1,E(M),M=-1),f=!0;var ae=d;try{for(m(_e),h=t(o);h!==null&&(!(h.expirationTime>_e)||$&&!U());){var ce=h.callback;if(typeof ce=="function"){h.callback=null,d=h.priorityLevel;var he=ce(h.expirationTime<=_e);_e=n.unstable_now(),typeof he=="function"?h.callback=he:h===t(o)&&i(o),m(_e)}else i(o);h=t(o)}if(h!==null)var je=!0;else{var Xe=t(c);Xe!==null&&Se(y,Xe.startTime-_e),je=!1}return je}finally{h=null,d=ae,f=!1}}var b=!1,C=null,M=-1,F=5,P=-1;function U(){return!(n.unstable_now()-P<F)}function G(){if(C!==null){var $=n.unstable_now();P=$;var _e=!0;try{_e=C(!0,$)}finally{_e?K():(b=!1,C=null)}}else b=!1}var K;if(typeof g=="function")K=function(){g(G)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,se=q.port2;q.port1.onmessage=G,K=function(){se.postMessage(null)}}else K=function(){v(G,0)};function Ee($){C=$,b||(b=!0,K())}function Se($,_e){M=v(function(){$(n.unstable_now())},_e)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_continueExecution=function(){_||f||(_=!0,Ee(T))},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(o)},n.unstable_next=function($){switch(d){case 1:case 2:case 3:var _e=3;break;default:_e=d}var ae=d;d=_e;try{return $()}finally{d=ae}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function($,_e){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ae=d;d=$;try{return _e()}finally{d=ae}},n.unstable_scheduleCallback=function($,_e,ae){var ce=n.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?ce+ae:ce):ae=ce,$){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=ae+he,$={id:u++,callback:_e,priorityLevel:$,startTime:ae,expirationTime:he,sortIndex:-1},ae>ce?($.sortIndex=ae,e(c,$),t(o)===null&&$===t(c)&&(p?(E(M),M=-1):p=!0,Se(y,ae-ce))):($.sortIndex=he,e(o,$),_||f||(_=!0,Ee(T))),$},n.unstable_shouldYield=U,n.unstable_wrapCallback=function($){var _e=d;return function(){var ae=d;d=_e;try{return $.apply(this,arguments)}finally{d=ae}}}})($1);q1.exports=$1;var Ak=q1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sk=S,en=Ak;function ye(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Q1=new Set,lu={};function Lo(n,e){Ul(n,e),Ul(n+"Capture",e)}function Ul(n,e){for(lu[n]=e,n=0;n<e.length;n++)Q1.add(e[n])}var ks=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lp=Object.prototype.hasOwnProperty,Rk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,dE={},fE={};function xk(n){return Lp.call(fE,n)?!0:Lp.call(dE,n)?!1:Rk.test(n)?fE[n]=!0:(dE[n]=!0,!1)}function Mk(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function Ik(n,e,t,i){if(e===null||typeof e>"u"||Mk(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Dr(n,e,t,i,r,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var gr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){gr[n]=new Dr(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];gr[e]=new Dr(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){gr[n]=new Dr(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){gr[n]=new Dr(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){gr[n]=new Dr(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){gr[n]=new Dr(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){gr[n]=new Dr(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){gr[n]=new Dr(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){gr[n]=new Dr(n,5,!1,n.toLowerCase(),null,!1,!1)});var Pm=/[\-:]([a-z])/g;function wm(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Pm,wm);gr[e]=new Dr(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Pm,wm);gr[e]=new Dr(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Pm,wm);gr[e]=new Dr(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){gr[n]=new Dr(n,1,!1,n.toLowerCase(),null,!1,!1)});gr.xlinkHref=new Dr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){gr[n]=new Dr(n,1,!1,n.toLowerCase(),null,!0,!0)});function Om(n,e,t,i){var r=gr.hasOwnProperty(e)?gr[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Ik(e,t,r,i)&&(t=null),i||r===null?xk(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var Hs=Sk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ch=Symbol.for("react.element"),ul=Symbol.for("react.portal"),hl=Symbol.for("react.fragment"),Dm=Symbol.for("react.strict_mode"),Np=Symbol.for("react.profiler"),Z1=Symbol.for("react.provider"),J1=Symbol.for("react.context"),Lm=Symbol.for("react.forward_ref"),Fp=Symbol.for("react.suspense"),kp=Symbol.for("react.suspense_list"),Nm=Symbol.for("react.memo"),da=Symbol.for("react.lazy"),eb=Symbol.for("react.offscreen"),_E=Symbol.iterator;function gc(n){return n===null||typeof n!="object"?null:(n=_E&&n[_E]||n["@@iterator"],typeof n=="function"?n:null)}var bi=Object.assign,D_;function Nc(n){if(D_===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);D_=e&&e[1]||""}return`
`+D_+n}var L_=!1;function N_(n,e){if(!n||L_)return"";L_=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){i=c}n.call(e.prototype)}else{try{throw Error()}catch(c){i=c}n()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),s=i.stack.split(`
`),a=r.length-1,l=s.length-1;1<=a&&0<=l&&r[a]!==s[l];)l--;for(;1<=a&&0<=l;a--,l--)if(r[a]!==s[l]){if(a!==1||l!==1)do if(a--,l--,0>l||r[a]!==s[l]){var o=`
`+r[a].replace(" at new "," at ");return n.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",n.displayName)),o}while(1<=a&&0<=l);break}}}finally{L_=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Nc(n):""}function Pk(n){switch(n.tag){case 5:return Nc(n.type);case 16:return Nc("Lazy");case 13:return Nc("Suspense");case 19:return Nc("SuspenseList");case 0:case 2:case 15:return n=N_(n.type,!1),n;case 11:return n=N_(n.type.render,!1),n;case 1:return n=N_(n.type,!0),n;default:return""}}function Bp(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case hl:return"Fragment";case ul:return"Portal";case Np:return"Profiler";case Dm:return"StrictMode";case Fp:return"Suspense";case kp:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case J1:return(n.displayName||"Context")+".Consumer";case Z1:return(n._context.displayName||"Context")+".Provider";case Lm:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Nm:return e=n.displayName||null,e!==null?e:Bp(n.type)||"Memo";case da:e=n._payload,n=n._init;try{return Bp(n(e))}catch{}}return null}function wk(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bp(e);case 8:return e===Dm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Fa(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function tb(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ok(n){var e=tb(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function uh(n){n._valueTracker||(n._valueTracker=Ok(n))}function ib(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=tb(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function ad(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Up(n,e){var t=e.checked;return bi({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function pE(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=Fa(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function rb(n,e){e=e.checked,e!=null&&Om(n,"checked",e,!1)}function zp(n,e){rb(n,e);var t=Fa(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Vp(n,e.type,t):e.hasOwnProperty("defaultValue")&&Vp(n,e.type,Fa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function gE(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Vp(n,e,t){(e!=="number"||ad(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Fc=Array.isArray;function Pl(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Fa(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function Gp(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ye(91));return bi({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function mE(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ye(92));if(Fc(t)){if(1<t.length)throw Error(ye(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Fa(t)}}function nb(n,e){var t=Fa(e.value),i=Fa(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function vE(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function sb(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wp(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?sb(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var hh,ab=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(hh=hh||document.createElement("div"),hh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=hh.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function cu(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var jc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dk=["Webkit","ms","Moz","O"];Object.keys(jc).forEach(function(n){Dk.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),jc[e]=jc[n]})});function ob(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||jc.hasOwnProperty(n)&&jc[n]?(""+e).trim():e+"px"}function lb(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=ob(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var Lk=bi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Hp(n,e){if(e){if(Lk[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ye(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ye(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ye(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ye(62))}}function jp(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xp=null;function Fm(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Yp=null,wl=null,Ol=null;function EE(n){if(n=zu(n)){if(typeof Yp!="function")throw Error(ye(280));var e=n.stateNode;e&&(e=nf(e),Yp(n.stateNode,n.type,e))}}function cb(n){wl?Ol?Ol.push(n):Ol=[n]:wl=n}function ub(){if(wl){var n=wl,e=Ol;if(Ol=wl=null,EE(n),e)for(n=0;n<e.length;n++)EE(e[n])}}function hb(n,e){return n(e)}function db(){}var F_=!1;function fb(n,e,t){if(F_)return n(e,t);F_=!0;try{return hb(n,e,t)}finally{F_=!1,(wl!==null||Ol!==null)&&(db(),ub())}}function uu(n,e){var t=n.stateNode;if(t===null)return null;var i=nf(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(ye(231,e,typeof t));return t}var Kp=!1;if(ks)try{var mc={};Object.defineProperty(mc,"passive",{get:function(){Kp=!0}}),window.addEventListener("test",mc,mc),window.removeEventListener("test",mc,mc)}catch{Kp=!1}function Nk(n,e,t,i,r,s,a,l,o){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var Xc=!1,od=null,ld=!1,qp=null,Fk={onError:function(n){Xc=!0,od=n}};function kk(n,e,t,i,r,s,a,l,o){Xc=!1,od=null,Nk.apply(Fk,arguments)}function Bk(n,e,t,i,r,s,a,l,o){if(kk.apply(this,arguments),Xc){if(Xc){var c=od;Xc=!1,od=null}else throw Error(ye(198));ld||(ld=!0,qp=c)}}function No(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function _b(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function yE(n){if(No(n)!==n)throw Error(ye(188))}function Uk(n){var e=n.alternate;if(!e){if(e=No(n),e===null)throw Error(ye(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return yE(r),n;if(s===i)return yE(r),e;s=s.sibling}throw Error(ye(188))}if(t.return!==i.return)t=r,i=s;else{for(var a=!1,l=r.child;l;){if(l===t){a=!0,t=r,i=s;break}if(l===i){a=!0,i=r,t=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===t){a=!0,t=s,i=r;break}if(l===i){a=!0,i=s,t=r;break}l=l.sibling}if(!a)throw Error(ye(189))}}if(t.alternate!==i)throw Error(ye(190))}if(t.tag!==3)throw Error(ye(188));return t.stateNode.current===t?n:e}function pb(n){return n=Uk(n),n!==null?gb(n):null}function gb(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=gb(n);if(e!==null)return e;n=n.sibling}return null}var mb=en.unstable_scheduleCallback,TE=en.unstable_cancelCallback,zk=en.unstable_shouldYield,Vk=en.unstable_requestPaint,Di=en.unstable_now,Gk=en.unstable_getCurrentPriorityLevel,km=en.unstable_ImmediatePriority,vb=en.unstable_UserBlockingPriority,cd=en.unstable_NormalPriority,Wk=en.unstable_LowPriority,Eb=en.unstable_IdlePriority,Jd=null,ss=null;function Hk(n){if(ss&&typeof ss.onCommitFiberRoot=="function")try{ss.onCommitFiberRoot(Jd,n,void 0,(n.current.flags&128)===128)}catch{}}var Ln=Math.clz32?Math.clz32:Yk,jk=Math.log,Xk=Math.LN2;function Yk(n){return n>>>=0,n===0?32:31-(jk(n)/Xk|0)|0}var dh=64,fh=4194304;function kc(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function ud(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,s=n.pingedLanes,a=t&268435455;if(a!==0){var l=a&~r;l!==0?i=kc(l):(s&=a,s!==0&&(i=kc(s)))}else a=t&~r,a!==0?i=kc(a):s!==0&&(i=kc(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-Ln(e),r=1<<t,i|=n[t],e&=~r;return i}function Kk(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qk(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,s=n.pendingLanes;0<s;){var a=31-Ln(s),l=1<<a,o=r[a];o===-1?(!(l&t)||l&i)&&(r[a]=Kk(l,e)):o<=e&&(n.expiredLanes|=l),s&=~l}}function $p(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function yb(){var n=dh;return dh<<=1,!(dh&4194240)&&(dh=64),n}function k_(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Bu(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Ln(e),n[e]=t}function $k(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-Ln(t),s=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~s}}function Bm(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-Ln(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var Kt=0;function Tb(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var bb,Um,Cb,Ab,Sb,Qp=!1,_h=[],Ca=null,Aa=null,Sa=null,hu=new Map,du=new Map,ga=[],Qk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bE(n,e){switch(n){case"focusin":case"focusout":Ca=null;break;case"dragenter":case"dragleave":Aa=null;break;case"mouseover":case"mouseout":Sa=null;break;case"pointerover":case"pointerout":hu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":du.delete(e.pointerId)}}function vc(n,e,t,i,r,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=zu(e),e!==null&&Um(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function Zk(n,e,t,i,r){switch(e){case"focusin":return Ca=vc(Ca,n,e,t,i,r),!0;case"dragenter":return Aa=vc(Aa,n,e,t,i,r),!0;case"mouseover":return Sa=vc(Sa,n,e,t,i,r),!0;case"pointerover":var s=r.pointerId;return hu.set(s,vc(hu.get(s)||null,n,e,t,i,r)),!0;case"gotpointercapture":return s=r.pointerId,du.set(s,vc(du.get(s)||null,n,e,t,i,r)),!0}return!1}function Rb(n){var e=fo(n.target);if(e!==null){var t=No(e);if(t!==null){if(e=t.tag,e===13){if(e=_b(t),e!==null){n.blockedOn=e,Sb(n.priority,function(){Cb(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Fh(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Zp(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);Xp=i,t.target.dispatchEvent(i),Xp=null}else return e=zu(t),e!==null&&Um(e),n.blockedOn=t,!1;e.shift()}return!0}function CE(n,e,t){Fh(n)&&t.delete(e)}function Jk(){Qp=!1,Ca!==null&&Fh(Ca)&&(Ca=null),Aa!==null&&Fh(Aa)&&(Aa=null),Sa!==null&&Fh(Sa)&&(Sa=null),hu.forEach(CE),du.forEach(CE)}function Ec(n,e){n.blockedOn===e&&(n.blockedOn=null,Qp||(Qp=!0,en.unstable_scheduleCallback(en.unstable_NormalPriority,Jk)))}function fu(n){function e(r){return Ec(r,n)}if(0<_h.length){Ec(_h[0],n);for(var t=1;t<_h.length;t++){var i=_h[t];i.blockedOn===n&&(i.blockedOn=null)}}for(Ca!==null&&Ec(Ca,n),Aa!==null&&Ec(Aa,n),Sa!==null&&Ec(Sa,n),hu.forEach(e),du.forEach(e),t=0;t<ga.length;t++)i=ga[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<ga.length&&(t=ga[0],t.blockedOn===null);)Rb(t),t.blockedOn===null&&ga.shift()}var Dl=Hs.ReactCurrentBatchConfig,hd=!0;function e5(n,e,t,i){var r=Kt,s=Dl.transition;Dl.transition=null;try{Kt=1,zm(n,e,t,i)}finally{Kt=r,Dl.transition=s}}function t5(n,e,t,i){var r=Kt,s=Dl.transition;Dl.transition=null;try{Kt=4,zm(n,e,t,i)}finally{Kt=r,Dl.transition=s}}function zm(n,e,t,i){if(hd){var r=Zp(n,e,t,i);if(r===null)Y_(n,e,i,dd,t),bE(n,i);else if(Zk(r,n,e,t,i))i.stopPropagation();else if(bE(n,i),e&4&&-1<Qk.indexOf(n)){for(;r!==null;){var s=zu(r);if(s!==null&&bb(s),s=Zp(n,e,t,i),s===null&&Y_(n,e,i,dd,t),s===r)break;r=s}r!==null&&i.stopPropagation()}else Y_(n,e,i,null,t)}}var dd=null;function Zp(n,e,t,i){if(dd=null,n=Fm(i),n=fo(n),n!==null)if(e=No(n),e===null)n=null;else if(t=e.tag,t===13){if(n=_b(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return dd=n,null}function xb(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gk()){case km:return 1;case vb:return 4;case cd:case Wk:return 16;case Eb:return 536870912;default:return 16}default:return 16}}var ya=null,Vm=null,kh=null;function Mb(){if(kh)return kh;var n,e=Vm,t=e.length,i,r="value"in ya?ya.value:ya.textContent,s=r.length;for(n=0;n<t&&e[n]===r[n];n++);var a=t-n;for(i=1;i<=a&&e[t-i]===r[s-i];i++);return kh=r.slice(n,1<i?1-i:void 0)}function Bh(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function ph(){return!0}function AE(){return!1}function rn(n){function e(t,i,r,s,a){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ph:AE,this.isPropagationStopped=AE,this}return bi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=ph)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=ph)},persist:function(){},isPersistent:ph}),e}var ic={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gm=rn(ic),Uu=bi({},ic,{view:0,detail:0}),i5=rn(Uu),B_,U_,yc,ef=bi({},Uu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wm,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==yc&&(yc&&n.type==="mousemove"?(B_=n.screenX-yc.screenX,U_=n.screenY-yc.screenY):U_=B_=0,yc=n),B_)},movementY:function(n){return"movementY"in n?n.movementY:U_}}),SE=rn(ef),r5=bi({},ef,{dataTransfer:0}),n5=rn(r5),s5=bi({},Uu,{relatedTarget:0}),z_=rn(s5),a5=bi({},ic,{animationName:0,elapsedTime:0,pseudoElement:0}),o5=rn(a5),l5=bi({},ic,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),c5=rn(l5),u5=bi({},ic,{data:0}),RE=rn(u5),h5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},d5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},f5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _5(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=f5[n])?!!e[n]:!1}function Wm(){return _5}var p5=bi({},Uu,{key:function(n){if(n.key){var e=h5[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Bh(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?d5[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wm,charCode:function(n){return n.type==="keypress"?Bh(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Bh(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),g5=rn(p5),m5=bi({},ef,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xE=rn(m5),v5=bi({},Uu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wm}),E5=rn(v5),y5=bi({},ic,{propertyName:0,elapsedTime:0,pseudoElement:0}),T5=rn(y5),b5=bi({},ef,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),C5=rn(b5),A5=[9,13,27,32],Hm=ks&&"CompositionEvent"in window,Yc=null;ks&&"documentMode"in document&&(Yc=document.documentMode);var S5=ks&&"TextEvent"in window&&!Yc,Ib=ks&&(!Hm||Yc&&8<Yc&&11>=Yc),ME=" ",IE=!1;function Pb(n,e){switch(n){case"keyup":return A5.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wb(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var dl=!1;function R5(n,e){switch(n){case"compositionend":return wb(e);case"keypress":return e.which!==32?null:(IE=!0,ME);case"textInput":return n=e.data,n===ME&&IE?null:n;default:return null}}function x5(n,e){if(dl)return n==="compositionend"||!Hm&&Pb(n,e)?(n=Mb(),kh=Vm=ya=null,dl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ib&&e.locale!=="ko"?null:e.data;default:return null}}var M5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function PE(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!M5[n.type]:e==="textarea"}function Ob(n,e,t,i){cb(i),e=fd(e,"onChange"),0<e.length&&(t=new Gm("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var Kc=null,_u=null;function I5(n){Wb(n,0)}function tf(n){var e=pl(n);if(ib(e))return n}function P5(n,e){if(n==="change")return e}var Db=!1;if(ks){var V_;if(ks){var G_="oninput"in document;if(!G_){var wE=document.createElement("div");wE.setAttribute("oninput","return;"),G_=typeof wE.oninput=="function"}V_=G_}else V_=!1;Db=V_&&(!document.documentMode||9<document.documentMode)}function OE(){Kc&&(Kc.detachEvent("onpropertychange",Lb),_u=Kc=null)}function Lb(n){if(n.propertyName==="value"&&tf(_u)){var e=[];Ob(e,_u,n,Fm(n)),fb(I5,e)}}function w5(n,e,t){n==="focusin"?(OE(),Kc=e,_u=t,Kc.attachEvent("onpropertychange",Lb)):n==="focusout"&&OE()}function O5(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return tf(_u)}function D5(n,e){if(n==="click")return tf(e)}function L5(n,e){if(n==="input"||n==="change")return tf(e)}function N5(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Un=typeof Object.is=="function"?Object.is:N5;function pu(n,e){if(Un(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!Lp.call(e,r)||!Un(n[r],e[r]))return!1}return!0}function DE(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function LE(n,e){var t=DE(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=DE(t)}}function Nb(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Nb(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Fb(){for(var n=window,e=ad();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=ad(n.document)}return e}function jm(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function F5(n){var e=Fb(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&Nb(t.ownerDocument.documentElement,t)){if(i!==null&&jm(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!n.extend&&s>i&&(r=i,i=s,s=r),r=LE(t,s);var a=LE(t,i);r&&a&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),s>i?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var k5=ks&&"documentMode"in document&&11>=document.documentMode,fl=null,Jp=null,qc=null,eg=!1;function NE(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;eg||fl==null||fl!==ad(i)||(i=fl,"selectionStart"in i&&jm(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),qc&&pu(qc,i)||(qc=i,i=fd(Jp,"onSelect"),0<i.length&&(e=new Gm("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=fl)))}function gh(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var _l={animationend:gh("Animation","AnimationEnd"),animationiteration:gh("Animation","AnimationIteration"),animationstart:gh("Animation","AnimationStart"),transitionend:gh("Transition","TransitionEnd")},W_={},kb={};ks&&(kb=document.createElement("div").style,"AnimationEvent"in window||(delete _l.animationend.animation,delete _l.animationiteration.animation,delete _l.animationstart.animation),"TransitionEvent"in window||delete _l.transitionend.transition);function rf(n){if(W_[n])return W_[n];if(!_l[n])return n;var e=_l[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in kb)return W_[n]=e[t];return n}var Bb=rf("animationend"),Ub=rf("animationiteration"),zb=rf("animationstart"),Vb=rf("transitionend"),Gb=new Map,FE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Va(n,e){Gb.set(n,e),Lo(e,[n])}for(var H_=0;H_<FE.length;H_++){var j_=FE[H_],B5=j_.toLowerCase(),U5=j_[0].toUpperCase()+j_.slice(1);Va(B5,"on"+U5)}Va(Bb,"onAnimationEnd");Va(Ub,"onAnimationIteration");Va(zb,"onAnimationStart");Va("dblclick","onDoubleClick");Va("focusin","onFocus");Va("focusout","onBlur");Va(Vb,"onTransitionEnd");Ul("onMouseEnter",["mouseout","mouseover"]);Ul("onMouseLeave",["mouseout","mouseover"]);Ul("onPointerEnter",["pointerout","pointerover"]);Ul("onPointerLeave",["pointerout","pointerover"]);Lo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Lo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Lo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Lo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Lo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Lo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),z5=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bc));function kE(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,Bk(i,e,void 0,n),n.currentTarget=null}function Wb(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var a=i.length-1;0<=a;a--){var l=i[a],o=l.instance,c=l.currentTarget;if(l=l.listener,o!==s&&r.isPropagationStopped())break e;kE(r,l,c),s=o}else for(a=0;a<i.length;a++){if(l=i[a],o=l.instance,c=l.currentTarget,l=l.listener,o!==s&&r.isPropagationStopped())break e;kE(r,l,c),s=o}}}if(ld)throw n=qp,ld=!1,qp=null,n}function li(n,e){var t=e[sg];t===void 0&&(t=e[sg]=new Set);var i=n+"__bubble";t.has(i)||(Hb(e,n,2,!1),t.add(i))}function X_(n,e,t){var i=0;e&&(i|=4),Hb(t,n,i,e)}var mh="_reactListening"+Math.random().toString(36).slice(2);function gu(n){if(!n[mh]){n[mh]=!0,Q1.forEach(function(t){t!=="selectionchange"&&(z5.has(t)||X_(t,!1,n),X_(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[mh]||(e[mh]=!0,X_("selectionchange",!1,e))}}function Hb(n,e,t,i){switch(xb(e)){case 1:var r=e5;break;case 4:r=t5;break;default:r=zm}t=r.bind(null,e,t,n),r=void 0,!Kp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function Y_(n,e,t,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var l=i.stateNode.containerInfo;if(l===r||l.nodeType===8&&l.parentNode===r)break;if(a===4)for(a=i.return;a!==null;){var o=a.tag;if((o===3||o===4)&&(o=a.stateNode.containerInfo,o===r||o.nodeType===8&&o.parentNode===r))return;a=a.return}for(;l!==null;){if(a=fo(l),a===null)return;if(o=a.tag,o===5||o===6){i=s=a;continue e}l=l.parentNode}}i=i.return}fb(function(){var c=s,u=Fm(t),h=[];e:{var d=Gb.get(n);if(d!==void 0){var f=Gm,_=n;switch(n){case"keypress":if(Bh(t)===0)break e;case"keydown":case"keyup":f=g5;break;case"focusin":_="focus",f=z_;break;case"focusout":_="blur",f=z_;break;case"beforeblur":case"afterblur":f=z_;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=SE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=n5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=E5;break;case Bb:case Ub:case zb:f=o5;break;case Vb:f=T5;break;case"scroll":f=i5;break;case"wheel":f=C5;break;case"copy":case"cut":case"paste":f=c5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=xE}var p=(e&4)!==0,v=!p&&n==="scroll",E=p?d!==null?d+"Capture":null:d;p=[];for(var g=c,m;g!==null;){m=g;var y=m.stateNode;if(m.tag===5&&y!==null&&(m=y,E!==null&&(y=uu(g,E),y!=null&&p.push(mu(g,y,m)))),v)break;g=g.return}0<p.length&&(d=new f(d,_,null,t,u),h.push({event:d,listeners:p}))}}if(!(e&7)){e:{if(d=n==="mouseover"||n==="pointerover",f=n==="mouseout"||n==="pointerout",d&&t!==Xp&&(_=t.relatedTarget||t.fromElement)&&(fo(_)||_[Bs]))break e;if((f||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,f?(_=t.relatedTarget||t.toElement,f=c,_=_?fo(_):null,_!==null&&(v=No(_),_!==v||_.tag!==5&&_.tag!==6)&&(_=null)):(f=null,_=c),f!==_)){if(p=SE,y="onMouseLeave",E="onMouseEnter",g="mouse",(n==="pointerout"||n==="pointerover")&&(p=xE,y="onPointerLeave",E="onPointerEnter",g="pointer"),v=f==null?d:pl(f),m=_==null?d:pl(_),d=new p(y,g+"leave",f,t,u),d.target=v,d.relatedTarget=m,y=null,fo(u)===c&&(p=new p(E,g+"enter",_,t,u),p.target=m,p.relatedTarget=v,y=p),v=y,f&&_)t:{for(p=f,E=_,g=0,m=p;m;m=el(m))g++;for(m=0,y=E;y;y=el(y))m++;for(;0<g-m;)p=el(p),g--;for(;0<m-g;)E=el(E),m--;for(;g--;){if(p===E||E!==null&&p===E.alternate)break t;p=el(p),E=el(E)}p=null}else p=null;f!==null&&BE(h,d,f,p,!1),_!==null&&v!==null&&BE(h,v,_,p,!0)}}e:{if(d=c?pl(c):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var T=P5;else if(PE(d))if(Db)T=L5;else{T=O5;var b=w5}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(T=D5);if(T&&(T=T(n,c))){Ob(h,T,t,u);break e}b&&b(n,d,c),n==="focusout"&&(b=d._wrapperState)&&b.controlled&&d.type==="number"&&Vp(d,"number",d.value)}switch(b=c?pl(c):window,n){case"focusin":(PE(b)||b.contentEditable==="true")&&(fl=b,Jp=c,qc=null);break;case"focusout":qc=Jp=fl=null;break;case"mousedown":eg=!0;break;case"contextmenu":case"mouseup":case"dragend":eg=!1,NE(h,t,u);break;case"selectionchange":if(k5)break;case"keydown":case"keyup":NE(h,t,u)}var C;if(Hm)e:{switch(n){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else dl?Pb(n,t)&&(M="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(M="onCompositionStart");M&&(Ib&&t.locale!=="ko"&&(dl||M!=="onCompositionStart"?M==="onCompositionEnd"&&dl&&(C=Mb()):(ya=u,Vm="value"in ya?ya.value:ya.textContent,dl=!0)),b=fd(c,M),0<b.length&&(M=new RE(M,n,null,t,u),h.push({event:M,listeners:b}),C?M.data=C:(C=wb(t),C!==null&&(M.data=C)))),(C=S5?R5(n,t):x5(n,t))&&(c=fd(c,"onBeforeInput"),0<c.length&&(u=new RE("onBeforeInput","beforeinput",null,t,u),h.push({event:u,listeners:c}),u.data=C))}Wb(h,e)})}function mu(n,e,t){return{instance:n,listener:e,currentTarget:t}}function fd(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=uu(n,t),s!=null&&i.unshift(mu(n,s,r)),s=uu(n,e),s!=null&&i.push(mu(n,s,r))),n=n.return}return i}function el(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function BE(n,e,t,i,r){for(var s=e._reactName,a=[];t!==null&&t!==i;){var l=t,o=l.alternate,c=l.stateNode;if(o!==null&&o===i)break;l.tag===5&&c!==null&&(l=c,r?(o=uu(t,s),o!=null&&a.unshift(mu(t,o,l))):r||(o=uu(t,s),o!=null&&a.push(mu(t,o,l)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var V5=/\r\n?/g,G5=/\u0000|\uFFFD/g;function UE(n){return(typeof n=="string"?n:""+n).replace(V5,`
`).replace(G5,"")}function vh(n,e,t){if(e=UE(e),UE(n)!==e&&t)throw Error(ye(425))}function _d(){}var tg=null,ig=null;function rg(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ng=typeof setTimeout=="function"?setTimeout:void 0,W5=typeof clearTimeout=="function"?clearTimeout:void 0,zE=typeof Promise=="function"?Promise:void 0,H5=typeof queueMicrotask=="function"?queueMicrotask:typeof zE<"u"?function(n){return zE.resolve(null).then(n).catch(j5)}:ng;function j5(n){setTimeout(function(){throw n})}function K_(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),fu(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);fu(e)}function Ra(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function VE(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var rc=Math.random().toString(36).slice(2),es="__reactFiber$"+rc,vu="__reactProps$"+rc,Bs="__reactContainer$"+rc,sg="__reactEvents$"+rc,X5="__reactListeners$"+rc,Y5="__reactHandles$"+rc;function fo(n){var e=n[es];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Bs]||t[es]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=VE(n);n!==null;){if(t=n[es])return t;n=VE(n)}return e}n=t,t=n.parentNode}return null}function zu(n){return n=n[es]||n[Bs],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function pl(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(ye(33))}function nf(n){return n[vu]||null}var ag=[],gl=-1;function Ga(n){return{current:n}}function ci(n){0>gl||(n.current=ag[gl],ag[gl]=null,gl--)}function ai(n,e){gl++,ag[gl]=n.current,n.current=e}var ka={},Tr=Ga(ka),zr=Ga(!1),xo=ka;function zl(n,e){var t=n.type.contextTypes;if(!t)return ka;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function Vr(n){return n=n.childContextTypes,n!=null}function pd(){ci(zr),ci(Tr)}function GE(n,e,t){if(Tr.current!==ka)throw Error(ye(168));ai(Tr,e),ai(zr,t)}function jb(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(ye(108,wk(n)||"Unknown",r));return bi({},t,i)}function gd(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||ka,xo=Tr.current,ai(Tr,n),ai(zr,zr.current),!0}function WE(n,e,t){var i=n.stateNode;if(!i)throw Error(ye(169));t?(n=jb(n,e,xo),i.__reactInternalMemoizedMergedChildContext=n,ci(zr),ci(Tr),ai(Tr,n)):ci(zr),ai(zr,t)}var Ss=null,sf=!1,q_=!1;function Xb(n){Ss===null?Ss=[n]:Ss.push(n)}function K5(n){sf=!0,Xb(n)}function Wa(){if(!q_&&Ss!==null){q_=!0;var n=0,e=Kt;try{var t=Ss;for(Kt=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}Ss=null,sf=!1}catch(r){throw Ss!==null&&(Ss=Ss.slice(n+1)),mb(km,Wa),r}finally{Kt=e,q_=!1}}return null}var ml=[],vl=0,md=null,vd=0,dn=[],fn=0,Mo=null,Is=1,Ps="";function ao(n,e){ml[vl++]=vd,ml[vl++]=md,md=n,vd=e}function Yb(n,e,t){dn[fn++]=Is,dn[fn++]=Ps,dn[fn++]=Mo,Mo=n;var i=Is;n=Ps;var r=32-Ln(i)-1;i&=~(1<<r),t+=1;var s=32-Ln(e)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Is=1<<32-Ln(e)+r|t<<r|i,Ps=s+n}else Is=1<<s|t<<r|i,Ps=n}function Xm(n){n.return!==null&&(ao(n,1),Yb(n,1,0))}function Ym(n){for(;n===md;)md=ml[--vl],ml[vl]=null,vd=ml[--vl],ml[vl]=null;for(;n===Mo;)Mo=dn[--fn],dn[fn]=null,Ps=dn[--fn],dn[fn]=null,Is=dn[--fn],dn[fn]=null}var Jr=null,$r=null,pi=!1,On=null;function Kb(n,e){var t=gn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function HE(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Jr=n,$r=Ra(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Jr=n,$r=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Mo!==null?{id:Is,overflow:Ps}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=gn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Jr=n,$r=null,!0):!1;default:return!1}}function og(n){return(n.mode&1)!==0&&(n.flags&128)===0}function lg(n){if(pi){var e=$r;if(e){var t=e;if(!HE(n,e)){if(og(n))throw Error(ye(418));e=Ra(t.nextSibling);var i=Jr;e&&HE(n,e)?Kb(i,t):(n.flags=n.flags&-4097|2,pi=!1,Jr=n)}}else{if(og(n))throw Error(ye(418));n.flags=n.flags&-4097|2,pi=!1,Jr=n}}}function jE(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Jr=n}function Eh(n){if(n!==Jr)return!1;if(!pi)return jE(n),pi=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!rg(n.type,n.memoizedProps)),e&&(e=$r)){if(og(n))throw qb(),Error(ye(418));for(;e;)Kb(n,e),e=Ra(e.nextSibling)}if(jE(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ye(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){$r=Ra(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}$r=null}}else $r=Jr?Ra(n.stateNode.nextSibling):null;return!0}function qb(){for(var n=$r;n;)n=Ra(n.nextSibling)}function Vl(){$r=Jr=null,pi=!1}function Km(n){On===null?On=[n]:On.push(n)}var q5=Hs.ReactCurrentBatchConfig;function Tc(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ye(309));var i=t.stateNode}if(!i)throw Error(ye(147,n));var r=i,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var l=r.refs;a===null?delete l[s]:l[s]=a},e._stringRef=s,e)}if(typeof n!="string")throw Error(ye(284));if(!t._owner)throw Error(ye(290,n))}return n}function yh(n,e){throw n=Object.prototype.toString.call(e),Error(ye(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function XE(n){var e=n._init;return e(n._payload)}function $b(n){function e(E,g){if(n){var m=E.deletions;m===null?(E.deletions=[g],E.flags|=16):m.push(g)}}function t(E,g){if(!n)return null;for(;g!==null;)e(E,g),g=g.sibling;return null}function i(E,g){for(E=new Map;g!==null;)g.key!==null?E.set(g.key,g):E.set(g.index,g),g=g.sibling;return E}function r(E,g){return E=Pa(E,g),E.index=0,E.sibling=null,E}function s(E,g,m){return E.index=m,n?(m=E.alternate,m!==null?(m=m.index,m<g?(E.flags|=2,g):m):(E.flags|=2,g)):(E.flags|=1048576,g)}function a(E){return n&&E.alternate===null&&(E.flags|=2),E}function l(E,g,m,y){return g===null||g.tag!==6?(g=ip(m,E.mode,y),g.return=E,g):(g=r(g,m),g.return=E,g)}function o(E,g,m,y){var T=m.type;return T===hl?u(E,g,m.props.children,y,m.key):g!==null&&(g.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===da&&XE(T)===g.type)?(y=r(g,m.props),y.ref=Tc(E,g,m),y.return=E,y):(y=jh(m.type,m.key,m.props,null,E.mode,y),y.ref=Tc(E,g,m),y.return=E,y)}function c(E,g,m,y){return g===null||g.tag!==4||g.stateNode.containerInfo!==m.containerInfo||g.stateNode.implementation!==m.implementation?(g=rp(m,E.mode,y),g.return=E,g):(g=r(g,m.children||[]),g.return=E,g)}function u(E,g,m,y,T){return g===null||g.tag!==7?(g=Co(m,E.mode,y,T),g.return=E,g):(g=r(g,m),g.return=E,g)}function h(E,g,m){if(typeof g=="string"&&g!==""||typeof g=="number")return g=ip(""+g,E.mode,m),g.return=E,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case ch:return m=jh(g.type,g.key,g.props,null,E.mode,m),m.ref=Tc(E,null,g),m.return=E,m;case ul:return g=rp(g,E.mode,m),g.return=E,g;case da:var y=g._init;return h(E,y(g._payload),m)}if(Fc(g)||gc(g))return g=Co(g,E.mode,m,null),g.return=E,g;yh(E,g)}return null}function d(E,g,m,y){var T=g!==null?g.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return T!==null?null:l(E,g,""+m,y);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case ch:return m.key===T?o(E,g,m,y):null;case ul:return m.key===T?c(E,g,m,y):null;case da:return T=m._init,d(E,g,T(m._payload),y)}if(Fc(m)||gc(m))return T!==null?null:u(E,g,m,y,null);yh(E,m)}return null}function f(E,g,m,y,T){if(typeof y=="string"&&y!==""||typeof y=="number")return E=E.get(m)||null,l(g,E,""+y,T);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ch:return E=E.get(y.key===null?m:y.key)||null,o(g,E,y,T);case ul:return E=E.get(y.key===null?m:y.key)||null,c(g,E,y,T);case da:var b=y._init;return f(E,g,m,b(y._payload),T)}if(Fc(y)||gc(y))return E=E.get(m)||null,u(g,E,y,T,null);yh(g,y)}return null}function _(E,g,m,y){for(var T=null,b=null,C=g,M=g=0,F=null;C!==null&&M<m.length;M++){C.index>M?(F=C,C=null):F=C.sibling;var P=d(E,C,m[M],y);if(P===null){C===null&&(C=F);break}n&&C&&P.alternate===null&&e(E,C),g=s(P,g,M),b===null?T=P:b.sibling=P,b=P,C=F}if(M===m.length)return t(E,C),pi&&ao(E,M),T;if(C===null){for(;M<m.length;M++)C=h(E,m[M],y),C!==null&&(g=s(C,g,M),b===null?T=C:b.sibling=C,b=C);return pi&&ao(E,M),T}for(C=i(E,C);M<m.length;M++)F=f(C,E,M,m[M],y),F!==null&&(n&&F.alternate!==null&&C.delete(F.key===null?M:F.key),g=s(F,g,M),b===null?T=F:b.sibling=F,b=F);return n&&C.forEach(function(U){return e(E,U)}),pi&&ao(E,M),T}function p(E,g,m,y){var T=gc(m);if(typeof T!="function")throw Error(ye(150));if(m=T.call(m),m==null)throw Error(ye(151));for(var b=T=null,C=g,M=g=0,F=null,P=m.next();C!==null&&!P.done;M++,P=m.next()){C.index>M?(F=C,C=null):F=C.sibling;var U=d(E,C,P.value,y);if(U===null){C===null&&(C=F);break}n&&C&&U.alternate===null&&e(E,C),g=s(U,g,M),b===null?T=U:b.sibling=U,b=U,C=F}if(P.done)return t(E,C),pi&&ao(E,M),T;if(C===null){for(;!P.done;M++,P=m.next())P=h(E,P.value,y),P!==null&&(g=s(P,g,M),b===null?T=P:b.sibling=P,b=P);return pi&&ao(E,M),T}for(C=i(E,C);!P.done;M++,P=m.next())P=f(C,E,M,P.value,y),P!==null&&(n&&P.alternate!==null&&C.delete(P.key===null?M:P.key),g=s(P,g,M),b===null?T=P:b.sibling=P,b=P);return n&&C.forEach(function(G){return e(E,G)}),pi&&ao(E,M),T}function v(E,g,m,y){if(typeof m=="object"&&m!==null&&m.type===hl&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case ch:e:{for(var T=m.key,b=g;b!==null;){if(b.key===T){if(T=m.type,T===hl){if(b.tag===7){t(E,b.sibling),g=r(b,m.props.children),g.return=E,E=g;break e}}else if(b.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===da&&XE(T)===b.type){t(E,b.sibling),g=r(b,m.props),g.ref=Tc(E,b,m),g.return=E,E=g;break e}t(E,b);break}else e(E,b);b=b.sibling}m.type===hl?(g=Co(m.props.children,E.mode,y,m.key),g.return=E,E=g):(y=jh(m.type,m.key,m.props,null,E.mode,y),y.ref=Tc(E,g,m),y.return=E,E=y)}return a(E);case ul:e:{for(b=m.key;g!==null;){if(g.key===b)if(g.tag===4&&g.stateNode.containerInfo===m.containerInfo&&g.stateNode.implementation===m.implementation){t(E,g.sibling),g=r(g,m.children||[]),g.return=E,E=g;break e}else{t(E,g);break}else e(E,g);g=g.sibling}g=rp(m,E.mode,y),g.return=E,E=g}return a(E);case da:return b=m._init,v(E,g,b(m._payload),y)}if(Fc(m))return _(E,g,m,y);if(gc(m))return p(E,g,m,y);yh(E,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,g!==null&&g.tag===6?(t(E,g.sibling),g=r(g,m),g.return=E,E=g):(t(E,g),g=ip(m,E.mode,y),g.return=E,E=g),a(E)):t(E,g)}return v}var Gl=$b(!0),Qb=$b(!1),Ed=Ga(null),yd=null,El=null,qm=null;function $m(){qm=El=yd=null}function Qm(n){var e=Ed.current;ci(Ed),n._currentValue=e}function cg(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function Ll(n,e){yd=n,qm=El=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Ur=!0),n.firstContext=null)}function En(n){var e=n._currentValue;if(qm!==n)if(n={context:n,memoizedValue:e,next:null},El===null){if(yd===null)throw Error(ye(308));El=n,yd.dependencies={lanes:0,firstContext:n}}else El=El.next=n;return e}var _o=null;function Zm(n){_o===null?_o=[n]:_o.push(n)}function Zb(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,Zm(e)):(t.next=r.next,r.next=t),e.interleaved=t,Us(n,i)}function Us(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var fa=!1;function Jm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jb(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Os(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function xa(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,Nt&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Us(n,t)}return r=i.interleaved,r===null?(e.next=e,Zm(i)):(e.next=r.next,r.next=e),i.interleaved=e,Us(n,t)}function Uh(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,Bm(n,t)}}function YE(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=a:s=s.next=a,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Td(n,e,t,i){var r=n.updateQueue;fa=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,l=r.shared.pending;if(l!==null){r.shared.pending=null;var o=l,c=o.next;o.next=null,a===null?s=c:a.next=c,a=o;var u=n.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==a&&(l===null?u.firstBaseUpdate=c:l.next=c,u.lastBaseUpdate=o))}if(s!==null){var h=r.baseState;a=0,u=c=o=null,l=s;do{var d=l.lane,f=l.eventTime;if((i&d)===d){u!==null&&(u=u.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var _=n,p=l;switch(d=e,f=t,p.tag){case 1:if(_=p.payload,typeof _=="function"){h=_.call(f,h,d);break e}h=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=p.payload,d=typeof _=="function"?_.call(f,h,d):_,d==null)break e;h=bi({},h,d);break e;case 2:fa=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,d=r.effects,d===null?r.effects=[l]:d.push(l))}else f={eventTime:f,lane:d,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(c=u=f,o=h):u=u.next=f,a|=d;if(l=l.next,l===null){if(l=r.shared.pending,l===null)break;d=l,l=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(!0);if(u===null&&(o=h),r.baseState=o,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Po|=a,n.lanes=a,n.memoizedState=h}}function KE(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(ye(191,r));r.call(i)}}}var Vu={},as=Ga(Vu),Eu=Ga(Vu),yu=Ga(Vu);function po(n){if(n===Vu)throw Error(ye(174));return n}function ev(n,e){switch(ai(yu,e),ai(Eu,n),ai(as,Vu),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Wp(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Wp(e,n)}ci(as),ai(as,e)}function Wl(){ci(as),ci(Eu),ci(yu)}function eC(n){po(yu.current);var e=po(as.current),t=Wp(e,n.type);e!==t&&(ai(Eu,n),ai(as,t))}function tv(n){Eu.current===n&&(ci(as),ci(Eu))}var yi=Ga(0);function bd(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var $_=[];function iv(){for(var n=0;n<$_.length;n++)$_[n]._workInProgressVersionPrimary=null;$_.length=0}var zh=Hs.ReactCurrentDispatcher,Q_=Hs.ReactCurrentBatchConfig,Io=0,Ti=null,qi=null,sr=null,Cd=!1,$c=!1,Tu=0,$5=0;function mr(){throw Error(ye(321))}function rv(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Un(n[t],e[t]))return!1;return!0}function nv(n,e,t,i,r,s){if(Io=s,Ti=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zh.current=n===null||n.memoizedState===null?eB:tB,n=t(i,r),$c){s=0;do{if($c=!1,Tu=0,25<=s)throw Error(ye(301));s+=1,sr=qi=null,e.updateQueue=null,zh.current=iB,n=t(i,r)}while($c)}if(zh.current=Ad,e=qi!==null&&qi.next!==null,Io=0,sr=qi=Ti=null,Cd=!1,e)throw Error(ye(300));return n}function sv(){var n=Tu!==0;return Tu=0,n}function Zn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sr===null?Ti.memoizedState=sr=n:sr=sr.next=n,sr}function yn(){if(qi===null){var n=Ti.alternate;n=n!==null?n.memoizedState:null}else n=qi.next;var e=sr===null?Ti.memoizedState:sr.next;if(e!==null)sr=e,qi=n;else{if(n===null)throw Error(ye(310));qi=n,n={memoizedState:qi.memoizedState,baseState:qi.baseState,baseQueue:qi.baseQueue,queue:qi.queue,next:null},sr===null?Ti.memoizedState=sr=n:sr=sr.next=n}return sr}function bu(n,e){return typeof e=="function"?e(n):e}function Z_(n){var e=yn(),t=e.queue;if(t===null)throw Error(ye(311));t.lastRenderedReducer=n;var i=qi,r=i.baseQueue,s=t.pending;if(s!==null){if(r!==null){var a=r.next;r.next=s.next,s.next=a}i.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,i=i.baseState;var l=a=null,o=null,c=s;do{var u=c.lane;if((Io&u)===u)o!==null&&(o=o.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:n(i,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};o===null?(l=o=h,a=i):o=o.next=h,Ti.lanes|=u,Po|=u}c=c.next}while(c!==null&&c!==s);o===null?a=i:o.next=l,Un(i,e.memoizedState)||(Ur=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=o,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do s=r.lane,Ti.lanes|=s,Po|=s,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function J_(n){var e=yn(),t=e.queue;if(t===null)throw Error(ye(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var a=r=r.next;do s=n(s,a.action),a=a.next;while(a!==r);Un(s,e.memoizedState)||(Ur=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,i]}function tC(){}function iC(n,e){var t=Ti,i=yn(),r=e(),s=!Un(i.memoizedState,r);if(s&&(i.memoizedState=r,Ur=!0),i=i.queue,av(sC.bind(null,t,i,n),[n]),i.getSnapshot!==e||s||sr!==null&&sr.memoizedState.tag&1){if(t.flags|=2048,Cu(9,nC.bind(null,t,i,r,e),void 0,null),cr===null)throw Error(ye(349));Io&30||rC(t,e,r)}return r}function rC(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Ti.updateQueue,e===null?(e={lastEffect:null,stores:null},Ti.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function nC(n,e,t,i){e.value=t,e.getSnapshot=i,aC(e)&&oC(n)}function sC(n,e,t){return t(function(){aC(e)&&oC(n)})}function aC(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Un(n,t)}catch{return!0}}function oC(n){var e=Us(n,1);e!==null&&Nn(e,n,1,-1)}function qE(n){var e=Zn();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bu,lastRenderedState:n},e.queue=n,n=n.dispatch=J5.bind(null,Ti,n),[e.memoizedState,n]}function Cu(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=Ti.updateQueue,e===null?(e={lastEffect:null,stores:null},Ti.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function lC(){return yn().memoizedState}function Vh(n,e,t,i){var r=Zn();Ti.flags|=n,r.memoizedState=Cu(1|e,t,void 0,i===void 0?null:i)}function af(n,e,t,i){var r=yn();i=i===void 0?null:i;var s=void 0;if(qi!==null){var a=qi.memoizedState;if(s=a.destroy,i!==null&&rv(i,a.deps)){r.memoizedState=Cu(e,t,s,i);return}}Ti.flags|=n,r.memoizedState=Cu(1|e,t,s,i)}function $E(n,e){return Vh(8390656,8,n,e)}function av(n,e){return af(2048,8,n,e)}function cC(n,e){return af(4,2,n,e)}function uC(n,e){return af(4,4,n,e)}function hC(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function dC(n,e,t){return t=t!=null?t.concat([n]):null,af(4,4,hC.bind(null,e,n),t)}function ov(){}function fC(n,e){var t=yn();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&rv(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function _C(n,e){var t=yn();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&rv(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function pC(n,e,t){return Io&21?(Un(t,e)||(t=yb(),Ti.lanes|=t,Po|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Ur=!0),n.memoizedState=t)}function Q5(n,e){var t=Kt;Kt=t!==0&&4>t?t:4,n(!0);var i=Q_.transition;Q_.transition={};try{n(!1),e()}finally{Kt=t,Q_.transition=i}}function gC(){return yn().memoizedState}function Z5(n,e,t){var i=Ia(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},mC(n))vC(e,t);else if(t=Zb(n,e,t,i),t!==null){var r=Pr();Nn(t,n,i,r),EC(t,e,i)}}function J5(n,e,t){var i=Ia(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(mC(n))vC(e,r);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,l=s(a,t);if(r.hasEagerState=!0,r.eagerState=l,Un(l,a)){var o=e.interleaved;o===null?(r.next=r,Zm(e)):(r.next=o.next,o.next=r),e.interleaved=r;return}}catch{}finally{}t=Zb(n,e,r,i),t!==null&&(r=Pr(),Nn(t,n,i,r),EC(t,e,i))}}function mC(n){var e=n.alternate;return n===Ti||e!==null&&e===Ti}function vC(n,e){$c=Cd=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function EC(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,Bm(n,t)}}var Ad={readContext:En,useCallback:mr,useContext:mr,useEffect:mr,useImperativeHandle:mr,useInsertionEffect:mr,useLayoutEffect:mr,useMemo:mr,useReducer:mr,useRef:mr,useState:mr,useDebugValue:mr,useDeferredValue:mr,useTransition:mr,useMutableSource:mr,useSyncExternalStore:mr,useId:mr,unstable_isNewReconciler:!1},eB={readContext:En,useCallback:function(n,e){return Zn().memoizedState=[n,e===void 0?null:e],n},useContext:En,useEffect:$E,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Vh(4194308,4,hC.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Vh(4194308,4,n,e)},useInsertionEffect:function(n,e){return Vh(4,2,n,e)},useMemo:function(n,e){var t=Zn();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=Zn();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=Z5.bind(null,Ti,n),[i.memoizedState,n]},useRef:function(n){var e=Zn();return n={current:n},e.memoizedState=n},useState:qE,useDebugValue:ov,useDeferredValue:function(n){return Zn().memoizedState=n},useTransition:function(){var n=qE(!1),e=n[0];return n=Q5.bind(null,n[1]),Zn().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=Ti,r=Zn();if(pi){if(t===void 0)throw Error(ye(407));t=t()}else{if(t=e(),cr===null)throw Error(ye(349));Io&30||rC(i,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,$E(sC.bind(null,i,s,n),[n]),i.flags|=2048,Cu(9,nC.bind(null,i,s,t,e),void 0,null),t},useId:function(){var n=Zn(),e=cr.identifierPrefix;if(pi){var t=Ps,i=Is;t=(i&~(1<<32-Ln(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=Tu++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=$5++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},tB={readContext:En,useCallback:fC,useContext:En,useEffect:av,useImperativeHandle:dC,useInsertionEffect:cC,useLayoutEffect:uC,useMemo:_C,useReducer:Z_,useRef:lC,useState:function(){return Z_(bu)},useDebugValue:ov,useDeferredValue:function(n){var e=yn();return pC(e,qi.memoizedState,n)},useTransition:function(){var n=Z_(bu)[0],e=yn().memoizedState;return[n,e]},useMutableSource:tC,useSyncExternalStore:iC,useId:gC,unstable_isNewReconciler:!1},iB={readContext:En,useCallback:fC,useContext:En,useEffect:av,useImperativeHandle:dC,useInsertionEffect:cC,useLayoutEffect:uC,useMemo:_C,useReducer:J_,useRef:lC,useState:function(){return J_(bu)},useDebugValue:ov,useDeferredValue:function(n){var e=yn();return qi===null?e.memoizedState=n:pC(e,qi.memoizedState,n)},useTransition:function(){var n=J_(bu)[0],e=yn().memoizedState;return[n,e]},useMutableSource:tC,useSyncExternalStore:iC,useId:gC,unstable_isNewReconciler:!1};function Rn(n,e){if(n&&n.defaultProps){e=bi({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function ug(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:bi({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var of={isMounted:function(n){return(n=n._reactInternals)?No(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=Pr(),r=Ia(n),s=Os(i,r);s.payload=e,t!=null&&(s.callback=t),e=xa(n,s,r),e!==null&&(Nn(e,n,r,i),Uh(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=Pr(),r=Ia(n),s=Os(i,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=xa(n,s,r),e!==null&&(Nn(e,n,r,i),Uh(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Pr(),i=Ia(n),r=Os(t,i);r.tag=2,e!=null&&(r.callback=e),e=xa(n,r,i),e!==null&&(Nn(e,n,i,t),Uh(e,n,i))}};function QE(n,e,t,i,r,s,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,s,a):e.prototype&&e.prototype.isPureReactComponent?!pu(t,i)||!pu(r,s):!0}function yC(n,e,t){var i=!1,r=ka,s=e.contextType;return typeof s=="object"&&s!==null?s=En(s):(r=Vr(e)?xo:Tr.current,i=e.contextTypes,s=(i=i!=null)?zl(n,r):ka),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=of,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=s),e}function ZE(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&of.enqueueReplaceState(e,e.state,null)}function hg(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs={},Jm(n);var s=e.contextType;typeof s=="object"&&s!==null?r.context=En(s):(s=Vr(e)?xo:Tr.current,r.context=zl(n,s)),r.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ug(n,e,s,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&of.enqueueReplaceState(r,r.state,null),Td(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function Hl(n,e){try{var t="",i=e;do t+=Pk(i),i=i.return;while(i);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:r,digest:null}}function ep(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function dg(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var rB=typeof WeakMap=="function"?WeakMap:Map;function TC(n,e,t){t=Os(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){Rd||(Rd=!0,bg=i),dg(n,e)},t}function bC(n,e,t){t=Os(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){dg(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){dg(n,e),typeof i!="function"&&(Ma===null?Ma=new Set([this]):Ma.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function JE(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new rB;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=mB.bind(null,n,e,t),e.then(n,n))}function ey(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function ty(n,e,t,i,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Os(-1,1),e.tag=2,xa(t,e,1))),t.lanes|=1),n)}var nB=Hs.ReactCurrentOwner,Ur=!1;function xr(n,e,t,i){e.child=n===null?Qb(e,null,t,i):Gl(e,n.child,t,i)}function iy(n,e,t,i,r){t=t.render;var s=e.ref;return Ll(e,r),i=nv(n,e,t,i,s,r),t=sv(),n!==null&&!Ur?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,zs(n,e,r)):(pi&&t&&Xm(e),e.flags|=1,xr(n,e,i,r),e.child)}function ry(n,e,t,i,r){if(n===null){var s=t.type;return typeof s=="function"&&!pv(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,CC(n,e,s,i,r)):(n=jh(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&r)){var a=s.memoizedProps;if(t=t.compare,t=t!==null?t:pu,t(a,i)&&n.ref===e.ref)return zs(n,e,r)}return e.flags|=1,n=Pa(s,i),n.ref=e.ref,n.return=e,e.child=n}function CC(n,e,t,i,r){if(n!==null){var s=n.memoizedProps;if(pu(s,i)&&n.ref===e.ref)if(Ur=!1,e.pendingProps=i=s,(n.lanes&r)!==0)n.flags&131072&&(Ur=!0);else return e.lanes=n.lanes,zs(n,e,r)}return fg(n,e,t,i,r)}function AC(n,e,t){var i=e.pendingProps,r=i.children,s=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ai(Tl,Xr),Xr|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,ai(Tl,Xr),Xr|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:t,ai(Tl,Xr),Xr|=i}else s!==null?(i=s.baseLanes|t,e.memoizedState=null):i=t,ai(Tl,Xr),Xr|=i;return xr(n,e,r,t),e.child}function SC(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function fg(n,e,t,i,r){var s=Vr(t)?xo:Tr.current;return s=zl(e,s),Ll(e,r),t=nv(n,e,t,i,s,r),i=sv(),n!==null&&!Ur?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,zs(n,e,r)):(pi&&i&&Xm(e),e.flags|=1,xr(n,e,t,r),e.child)}function ny(n,e,t,i,r){if(Vr(t)){var s=!0;gd(e)}else s=!1;if(Ll(e,r),e.stateNode===null)Gh(n,e),yC(e,t,i),hg(e,t,i,r),i=!0;else if(n===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var o=a.context,c=t.contextType;typeof c=="object"&&c!==null?c=En(c):(c=Vr(t)?xo:Tr.current,c=zl(e,c));var u=t.getDerivedStateFromProps,h=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==i||o!==c)&&ZE(e,a,i,c),fa=!1;var d=e.memoizedState;a.state=d,Td(e,i,a,r),o=e.memoizedState,l!==i||d!==o||zr.current||fa?(typeof u=="function"&&(ug(e,t,u,i),o=e.memoizedState),(l=fa||QE(e,t,l,i,d,o,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=o),a.props=i,a.state=o,a.context=c,i=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,Jb(n,e),l=e.memoizedProps,c=e.type===e.elementType?l:Rn(e.type,l),a.props=c,h=e.pendingProps,d=a.context,o=t.contextType,typeof o=="object"&&o!==null?o=En(o):(o=Vr(t)?xo:Tr.current,o=zl(e,o));var f=t.getDerivedStateFromProps;(u=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==h||d!==o)&&ZE(e,a,i,o),fa=!1,d=e.memoizedState,a.state=d,Td(e,i,a,r);var _=e.memoizedState;l!==h||d!==_||zr.current||fa?(typeof f=="function"&&(ug(e,t,f,i),_=e.memoizedState),(c=fa||QE(e,t,c,i,d,_,o)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,_,o),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,_,o)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=_),a.props=i,a.state=_,a.context=o,i=c):(typeof a.componentDidUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),i=!1)}return _g(n,e,t,i,s,r)}function _g(n,e,t,i,r,s){SC(n,e);var a=(e.flags&128)!==0;if(!i&&!a)return r&&WE(e,t,!1),zs(n,e,s);i=e.stateNode,nB.current=e;var l=a&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&a?(e.child=Gl(e,n.child,null,s),e.child=Gl(e,null,l,s)):xr(n,e,l,s),e.memoizedState=i.state,r&&WE(e,t,!0),e.child}function RC(n){var e=n.stateNode;e.pendingContext?GE(n,e.pendingContext,e.pendingContext!==e.context):e.context&&GE(n,e.context,!1),ev(n,e.containerInfo)}function sy(n,e,t,i,r){return Vl(),Km(r),e.flags|=256,xr(n,e,t,i),e.child}var pg={dehydrated:null,treeContext:null,retryLane:0};function gg(n){return{baseLanes:n,cachePool:null,transitions:null}}function xC(n,e,t){var i=e.pendingProps,r=yi.current,s=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=n!==null&&n.memoizedState===null?!1:(r&2)!==0),l?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),ai(yi,r&1),n===null)return lg(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=i.children,n=i.fallback,s?(i=e.mode,s=e.child,a={mode:"hidden",children:a},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=uf(a,i,0,null),n=Co(n,i,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=gg(t),e.memoizedState=pg,n):lv(e,a));if(r=n.memoizedState,r!==null&&(l=r.dehydrated,l!==null))return sB(n,e,a,i,l,r,t);if(s){s=i.fallback,a=e.mode,r=n.child,l=r.sibling;var o={mode:"hidden",children:i.children};return!(a&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=o,e.deletions=null):(i=Pa(r,o),i.subtreeFlags=r.subtreeFlags&14680064),l!==null?s=Pa(l,s):(s=Co(s,a,t,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,a=n.child.memoizedState,a=a===null?gg(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=n.childLanes&~t,e.memoizedState=pg,i}return s=n.child,n=s.sibling,i=Pa(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function lv(n,e){return e=uf({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Th(n,e,t,i){return i!==null&&Km(i),Gl(e,n.child,null,t),n=lv(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function sB(n,e,t,i,r,s,a){if(t)return e.flags&256?(e.flags&=-257,i=ep(Error(ye(422))),Th(n,e,a,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=uf({mode:"visible",children:i.children},r,0,null),s=Co(s,r,a,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Gl(e,n.child,null,a),e.child.memoizedState=gg(a),e.memoizedState=pg,s);if(!(e.mode&1))return Th(n,e,a,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var l=i.dgst;return i=l,s=Error(ye(419)),i=ep(s,i,void 0),Th(n,e,a,i)}if(l=(a&n.childLanes)!==0,Ur||l){if(i=cr,i!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|a)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Us(n,r),Nn(i,n,r,-1))}return _v(),i=ep(Error(ye(421))),Th(n,e,a,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=vB.bind(null,n),r._reactRetry=e,null):(n=s.treeContext,$r=Ra(r.nextSibling),Jr=e,pi=!0,On=null,n!==null&&(dn[fn++]=Is,dn[fn++]=Ps,dn[fn++]=Mo,Is=n.id,Ps=n.overflow,Mo=e),e=lv(e,i.children),e.flags|=4096,e)}function ay(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),cg(n.return,e,t)}function tp(n,e,t,i,r){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=t,s.tailMode=r)}function MC(n,e,t){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(xr(n,e,i.children,t),i=yi.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&ay(n,t,e);else if(n.tag===19)ay(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(ai(yi,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&bd(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),tp(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&bd(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}tp(e,!0,t,null,s);break;case"together":tp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Gh(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function zs(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Po|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(ye(153));if(e.child!==null){for(n=e.child,t=Pa(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Pa(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function aB(n,e,t){switch(e.tag){case 3:RC(e),Vl();break;case 5:eC(e);break;case 1:Vr(e.type)&&gd(e);break;case 4:ev(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;ai(Ed,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(ai(yi,yi.current&1),e.flags|=128,null):t&e.child.childLanes?xC(n,e,t):(ai(yi,yi.current&1),n=zs(n,e,t),n!==null?n.sibling:null);ai(yi,yi.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return MC(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),ai(yi,yi.current),i)break;return null;case 22:case 23:return e.lanes=0,AC(n,e,t)}return zs(n,e,t)}var IC,mg,PC,wC;IC=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};mg=function(){};PC=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,po(as.current);var s=null;switch(t){case"input":r=Up(n,r),i=Up(n,i),s=[];break;case"select":r=bi({},r,{value:void 0}),i=bi({},i,{value:void 0}),s=[];break;case"textarea":r=Gp(n,r),i=Gp(n,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=_d)}Hp(t,i);var a;t=null;for(c in r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var l=r[c];for(a in l)l.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(lu.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var o=i[c];if(l=r!=null?r[c]:void 0,i.hasOwnProperty(c)&&o!==l&&(o!=null||l!=null))if(c==="style")if(l){for(a in l)!l.hasOwnProperty(a)||o&&o.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in o)o.hasOwnProperty(a)&&l[a]!==o[a]&&(t||(t={}),t[a]=o[a])}else t||(s||(s=[]),s.push(c,t)),t=o;else c==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,l=l?l.__html:void 0,o!=null&&l!==o&&(s=s||[]).push(c,o)):c==="children"?typeof o!="string"&&typeof o!="number"||(s=s||[]).push(c,""+o):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(lu.hasOwnProperty(c)?(o!=null&&c==="onScroll"&&li("scroll",n),s||l===o||(s=[])):(s=s||[]).push(c,o))}t&&(s=s||[]).push("style",t);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};wC=function(n,e,t,i){t!==i&&(e.flags|=4)};function bc(n,e){if(!pi)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function vr(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function oB(n,e,t){var i=e.pendingProps;switch(Ym(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vr(e),null;case 1:return Vr(e.type)&&pd(),vr(e),null;case 3:return i=e.stateNode,Wl(),ci(zr),ci(Tr),iv(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(Eh(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,On!==null&&(Sg(On),On=null))),mg(n,e),vr(e),null;case 5:tv(e);var r=po(yu.current);if(t=e.type,n!==null&&e.stateNode!=null)PC(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(ye(166));return vr(e),null}if(n=po(as.current),Eh(e)){i=e.stateNode,t=e.type;var s=e.memoizedProps;switch(i[es]=e,i[vu]=s,n=(e.mode&1)!==0,t){case"dialog":li("cancel",i),li("close",i);break;case"iframe":case"object":case"embed":li("load",i);break;case"video":case"audio":for(r=0;r<Bc.length;r++)li(Bc[r],i);break;case"source":li("error",i);break;case"img":case"image":case"link":li("error",i),li("load",i);break;case"details":li("toggle",i);break;case"input":pE(i,s),li("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},li("invalid",i);break;case"textarea":mE(i,s),li("invalid",i)}Hp(t,s),r=null;for(var a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="children"?typeof l=="string"?i.textContent!==l&&(s.suppressHydrationWarning!==!0&&vh(i.textContent,l,n),r=["children",l]):typeof l=="number"&&i.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&vh(i.textContent,l,n),r=["children",""+l]):lu.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&li("scroll",i)}switch(t){case"input":uh(i),gE(i,s,!0);break;case"textarea":uh(i),vE(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=_d)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=sb(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=a.createElement(t,{is:i.is}):(n=a.createElement(t),t==="select"&&(a=n,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):n=a.createElementNS(n,t),n[es]=e,n[vu]=i,IC(n,e,!1,!1),e.stateNode=n;e:{switch(a=jp(t,i),t){case"dialog":li("cancel",n),li("close",n),r=i;break;case"iframe":case"object":case"embed":li("load",n),r=i;break;case"video":case"audio":for(r=0;r<Bc.length;r++)li(Bc[r],n);r=i;break;case"source":li("error",n),r=i;break;case"img":case"image":case"link":li("error",n),li("load",n),r=i;break;case"details":li("toggle",n),r=i;break;case"input":pE(n,i),r=Up(n,i),li("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=bi({},i,{value:void 0}),li("invalid",n);break;case"textarea":mE(n,i),r=Gp(n,i),li("invalid",n);break;default:r=i}Hp(t,r),l=r;for(s in l)if(l.hasOwnProperty(s)){var o=l[s];s==="style"?lb(n,o):s==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,o!=null&&ab(n,o)):s==="children"?typeof o=="string"?(t!=="textarea"||o!=="")&&cu(n,o):typeof o=="number"&&cu(n,""+o):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(lu.hasOwnProperty(s)?o!=null&&s==="onScroll"&&li("scroll",n):o!=null&&Om(n,s,o,a))}switch(t){case"input":uh(n),gE(n,i,!1);break;case"textarea":uh(n),vE(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Fa(i.value));break;case"select":n.multiple=!!i.multiple,s=i.value,s!=null?Pl(n,!!i.multiple,s,!1):i.defaultValue!=null&&Pl(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=_d)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return vr(e),null;case 6:if(n&&e.stateNode!=null)wC(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(ye(166));if(t=po(yu.current),po(as.current),Eh(e)){if(i=e.stateNode,t=e.memoizedProps,i[es]=e,(s=i.nodeValue!==t)&&(n=Jr,n!==null))switch(n.tag){case 3:vh(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&vh(i.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[es]=e,e.stateNode=i}return vr(e),null;case 13:if(ci(yi),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(pi&&$r!==null&&e.mode&1&&!(e.flags&128))qb(),Vl(),e.flags|=98560,s=!1;else if(s=Eh(e),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(ye(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ye(317));s[es]=e}else Vl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;vr(e),s=!1}else On!==null&&(Sg(On),On=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||yi.current&1?Qi===0&&(Qi=3):_v())),e.updateQueue!==null&&(e.flags|=4),vr(e),null);case 4:return Wl(),mg(n,e),n===null&&gu(e.stateNode.containerInfo),vr(e),null;case 10:return Qm(e.type._context),vr(e),null;case 17:return Vr(e.type)&&pd(),vr(e),null;case 19:if(ci(yi),s=e.memoizedState,s===null)return vr(e),null;if(i=(e.flags&128)!==0,a=s.rendering,a===null)if(i)bc(s,!1);else{if(Qi!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=bd(n),a!==null){for(e.flags|=128,bc(s,!1),i=a.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)s=t,n=i,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,n=a.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return ai(yi,yi.current&1|2),e.child}n=n.sibling}s.tail!==null&&Di()>jl&&(e.flags|=128,i=!0,bc(s,!1),e.lanes=4194304)}else{if(!i)if(n=bd(a),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),bc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!pi)return vr(e),null}else 2*Di()-s.renderingStartTime>jl&&t!==1073741824&&(e.flags|=128,i=!0,bc(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(t=s.last,t!==null?t.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Di(),e.sibling=null,t=yi.current,ai(yi,i?t&1|2:t&1),e):(vr(e),null);case 22:case 23:return fv(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Xr&1073741824&&(vr(e),e.subtreeFlags&6&&(e.flags|=8192)):vr(e),null;case 24:return null;case 25:return null}throw Error(ye(156,e.tag))}function lB(n,e){switch(Ym(e),e.tag){case 1:return Vr(e.type)&&pd(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Wl(),ci(zr),ci(Tr),iv(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return tv(e),null;case 13:if(ci(yi),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(ye(340));Vl()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return ci(yi),null;case 4:return Wl(),null;case 10:return Qm(e.type._context),null;case 22:case 23:return fv(),null;case 24:return null;default:return null}}var bh=!1,Er=!1,cB=typeof WeakSet=="function"?WeakSet:Set,ze=null;function yl(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){Ri(n,e,i)}else t.current=null}function vg(n,e,t){try{t()}catch(i){Ri(n,e,i)}}var oy=!1;function uB(n,e){if(tg=hd,n=Fb(),jm(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var a=0,l=-1,o=-1,c=0,u=0,h=n,d=null;t:for(;;){for(var f;h!==t||r!==0&&h.nodeType!==3||(l=a+r),h!==s||i!==0&&h.nodeType!==3||(o=a+i),h.nodeType===3&&(a+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===n)break t;if(d===t&&++c===r&&(l=a),d===s&&++u===i&&(o=a),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}t=l===-1||o===-1?null:{start:l,end:o}}else t=null}t=t||{start:0,end:0}}else t=null;for(ig={focusedElem:n,selectionRange:t},hd=!1,ze=e;ze!==null;)if(e=ze,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,ze=n;else for(;ze!==null;){e=ze;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var p=_.memoizedProps,v=_.memoizedState,E=e.stateNode,g=E.getSnapshotBeforeUpdate(e.elementType===e.type?p:Rn(e.type,p),v);E.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var m=e.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ye(163))}}catch(y){Ri(e,e.return,y)}if(n=e.sibling,n!==null){n.return=e.return,ze=n;break}ze=e.return}return _=oy,oy=!1,_}function Qc(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var s=r.destroy;r.destroy=void 0,s!==void 0&&vg(e,t,s)}r=r.next}while(r!==i)}}function lf(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function Eg(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function OC(n){var e=n.alternate;e!==null&&(n.alternate=null,OC(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[es],delete e[vu],delete e[sg],delete e[X5],delete e[Y5])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function DC(n){return n.tag===5||n.tag===3||n.tag===4}function ly(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||DC(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function yg(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=_d));else if(i!==4&&(n=n.child,n!==null))for(yg(n,e,t),n=n.sibling;n!==null;)yg(n,e,t),n=n.sibling}function Tg(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(Tg(n,e,t),n=n.sibling;n!==null;)Tg(n,e,t),n=n.sibling}var dr=null,In=!1;function sa(n,e,t){for(t=t.child;t!==null;)LC(n,e,t),t=t.sibling}function LC(n,e,t){if(ss&&typeof ss.onCommitFiberUnmount=="function")try{ss.onCommitFiberUnmount(Jd,t)}catch{}switch(t.tag){case 5:Er||yl(t,e);case 6:var i=dr,r=In;dr=null,sa(n,e,t),dr=i,In=r,dr!==null&&(In?(n=dr,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):dr.removeChild(t.stateNode));break;case 18:dr!==null&&(In?(n=dr,t=t.stateNode,n.nodeType===8?K_(n.parentNode,t):n.nodeType===1&&K_(n,t),fu(n)):K_(dr,t.stateNode));break;case 4:i=dr,r=In,dr=t.stateNode.containerInfo,In=!0,sa(n,e,t),dr=i,In=r;break;case 0:case 11:case 14:case 15:if(!Er&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&vg(t,e,a),r=r.next}while(r!==i)}sa(n,e,t);break;case 1:if(!Er&&(yl(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(l){Ri(t,e,l)}sa(n,e,t);break;case 21:sa(n,e,t);break;case 22:t.mode&1?(Er=(i=Er)||t.memoizedState!==null,sa(n,e,t),Er=i):sa(n,e,t);break;default:sa(n,e,t)}}function cy(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new cB),e.forEach(function(i){var r=EB.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function bn(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var s=n,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:dr=l.stateNode,In=!1;break e;case 3:dr=l.stateNode.containerInfo,In=!0;break e;case 4:dr=l.stateNode.containerInfo,In=!0;break e}l=l.return}if(dr===null)throw Error(ye(160));LC(s,a,r),dr=null,In=!1;var o=r.alternate;o!==null&&(o.return=null),r.return=null}catch(c){Ri(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)NC(e,n),e=e.sibling}function NC(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(bn(e,n),$n(n),i&4){try{Qc(3,n,n.return),lf(3,n)}catch(p){Ri(n,n.return,p)}try{Qc(5,n,n.return)}catch(p){Ri(n,n.return,p)}}break;case 1:bn(e,n),$n(n),i&512&&t!==null&&yl(t,t.return);break;case 5:if(bn(e,n),$n(n),i&512&&t!==null&&yl(t,t.return),n.flags&32){var r=n.stateNode;try{cu(r,"")}catch(p){Ri(n,n.return,p)}}if(i&4&&(r=n.stateNode,r!=null)){var s=n.memoizedProps,a=t!==null?t.memoizedProps:s,l=n.type,o=n.updateQueue;if(n.updateQueue=null,o!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&rb(r,s),jp(l,a);var c=jp(l,s);for(a=0;a<o.length;a+=2){var u=o[a],h=o[a+1];u==="style"?lb(r,h):u==="dangerouslySetInnerHTML"?ab(r,h):u==="children"?cu(r,h):Om(r,u,h,c)}switch(l){case"input":zp(r,s);break;case"textarea":nb(r,s);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?Pl(r,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?Pl(r,!!s.multiple,s.defaultValue,!0):Pl(r,!!s.multiple,s.multiple?[]:"",!1))}r[vu]=s}catch(p){Ri(n,n.return,p)}}break;case 6:if(bn(e,n),$n(n),i&4){if(n.stateNode===null)throw Error(ye(162));r=n.stateNode,s=n.memoizedProps;try{r.nodeValue=s}catch(p){Ri(n,n.return,p)}}break;case 3:if(bn(e,n),$n(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{fu(e.containerInfo)}catch(p){Ri(n,n.return,p)}break;case 4:bn(e,n),$n(n);break;case 13:bn(e,n),$n(n),r=n.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(hv=Di())),i&4&&cy(n);break;case 22:if(u=t!==null&&t.memoizedState!==null,n.mode&1?(Er=(c=Er)||u,bn(e,n),Er=c):bn(e,n),$n(n),i&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!u&&n.mode&1)for(ze=n,u=n.child;u!==null;){for(h=ze=u;ze!==null;){switch(d=ze,f=d.child,d.tag){case 0:case 11:case 14:case 15:Qc(4,d,d.return);break;case 1:yl(d,d.return);var _=d.stateNode;if(typeof _.componentWillUnmount=="function"){i=d,t=d.return;try{e=i,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(p){Ri(i,t,p)}}break;case 5:yl(d,d.return);break;case 22:if(d.memoizedState!==null){hy(h);continue}}f!==null?(f.return=d,ze=f):hy(h)}u=u.sibling}e:for(u=null,h=n;;){if(h.tag===5){if(u===null){u=h;try{r=h.stateNode,c?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=h.stateNode,o=h.memoizedProps.style,a=o!=null&&o.hasOwnProperty("display")?o.display:null,l.style.display=ob("display",a))}catch(p){Ri(n,n.return,p)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(p){Ri(n,n.return,p)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:bn(e,n),$n(n),i&4&&cy(n);break;case 21:break;default:bn(e,n),$n(n)}}function $n(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(DC(t)){var i=t;break e}t=t.return}throw Error(ye(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(cu(r,""),i.flags&=-33);var s=ly(n);Tg(n,s,r);break;case 3:case 4:var a=i.stateNode.containerInfo,l=ly(n);yg(n,l,a);break;default:throw Error(ye(161))}}catch(o){Ri(n,n.return,o)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function hB(n,e,t){ze=n,FC(n)}function FC(n,e,t){for(var i=(n.mode&1)!==0;ze!==null;){var r=ze,s=r.child;if(r.tag===22&&i){var a=r.memoizedState!==null||bh;if(!a){var l=r.alternate,o=l!==null&&l.memoizedState!==null||Er;l=bh;var c=Er;if(bh=a,(Er=o)&&!c)for(ze=r;ze!==null;)a=ze,o=a.child,a.tag===22&&a.memoizedState!==null?dy(r):o!==null?(o.return=a,ze=o):dy(r);for(;s!==null;)ze=s,FC(s),s=s.sibling;ze=r,bh=l,Er=c}uy(n)}else r.subtreeFlags&8772&&s!==null?(s.return=r,ze=s):uy(n)}}function uy(n){for(;ze!==null;){var e=ze;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Er||lf(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Er)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:Rn(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&KE(e,s,i);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}KE(e,a,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var o=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":o.autoFocus&&t.focus();break;case"img":o.src&&(t.src=o.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&fu(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ye(163))}Er||e.flags&512&&Eg(e)}catch(d){Ri(e,e.return,d)}}if(e===n){ze=null;break}if(t=e.sibling,t!==null){t.return=e.return,ze=t;break}ze=e.return}}function hy(n){for(;ze!==null;){var e=ze;if(e===n){ze=null;break}var t=e.sibling;if(t!==null){t.return=e.return,ze=t;break}ze=e.return}}function dy(n){for(;ze!==null;){var e=ze;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{lf(4,e)}catch(o){Ri(e,t,o)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(o){Ri(e,r,o)}}var s=e.return;try{Eg(e)}catch(o){Ri(e,s,o)}break;case 5:var a=e.return;try{Eg(e)}catch(o){Ri(e,a,o)}}}catch(o){Ri(e,e.return,o)}if(e===n){ze=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ze=l;break}ze=e.return}}var dB=Math.ceil,Sd=Hs.ReactCurrentDispatcher,cv=Hs.ReactCurrentOwner,vn=Hs.ReactCurrentBatchConfig,Nt=0,cr=null,Vi=null,pr=0,Xr=0,Tl=Ga(0),Qi=0,Au=null,Po=0,cf=0,uv=0,Zc=null,Br=null,hv=0,jl=1/0,Cs=null,Rd=!1,bg=null,Ma=null,Ch=!1,Ta=null,xd=0,Jc=0,Cg=null,Wh=-1,Hh=0;function Pr(){return Nt&6?Di():Wh!==-1?Wh:Wh=Di()}function Ia(n){return n.mode&1?Nt&2&&pr!==0?pr&-pr:q5.transition!==null?(Hh===0&&(Hh=yb()),Hh):(n=Kt,n!==0||(n=window.event,n=n===void 0?16:xb(n.type)),n):1}function Nn(n,e,t,i){if(50<Jc)throw Jc=0,Cg=null,Error(ye(185));Bu(n,t,i),(!(Nt&2)||n!==cr)&&(n===cr&&(!(Nt&2)&&(cf|=t),Qi===4&&ma(n,pr)),Gr(n,i),t===1&&Nt===0&&!(e.mode&1)&&(jl=Di()+500,sf&&Wa()))}function Gr(n,e){var t=n.callbackNode;qk(n,e);var i=ud(n,n===cr?pr:0);if(i===0)t!==null&&TE(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&TE(t),e===1)n.tag===0?K5(fy.bind(null,n)):Xb(fy.bind(null,n)),H5(function(){!(Nt&6)&&Wa()}),t=null;else{switch(Tb(i)){case 1:t=km;break;case 4:t=vb;break;case 16:t=cd;break;case 536870912:t=Eb;break;default:t=cd}t=HC(t,kC.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function kC(n,e){if(Wh=-1,Hh=0,Nt&6)throw Error(ye(327));var t=n.callbackNode;if(Nl()&&n.callbackNode!==t)return null;var i=ud(n,n===cr?pr:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=Md(n,i);else{e=i;var r=Nt;Nt|=2;var s=UC();(cr!==n||pr!==e)&&(Cs=null,jl=Di()+500,bo(n,e));do try{pB();break}catch(l){BC(n,l)}while(!0);$m(),Sd.current=s,Nt=r,Vi!==null?e=0:(cr=null,pr=0,e=Qi)}if(e!==0){if(e===2&&(r=$p(n),r!==0&&(i=r,e=Ag(n,r))),e===1)throw t=Au,bo(n,0),ma(n,i),Gr(n,Di()),t;if(e===6)ma(n,i);else{if(r=n.current.alternate,!(i&30)&&!fB(r)&&(e=Md(n,i),e===2&&(s=$p(n),s!==0&&(i=s,e=Ag(n,s))),e===1))throw t=Au,bo(n,0),ma(n,i),Gr(n,Di()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(ye(345));case 2:oo(n,Br,Cs);break;case 3:if(ma(n,i),(i&130023424)===i&&(e=hv+500-Di(),10<e)){if(ud(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){Pr(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=ng(oo.bind(null,n,Br,Cs),e);break}oo(n,Br,Cs);break;case 4:if(ma(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var a=31-Ln(i);s=1<<a,a=e[a],a>r&&(r=a),i&=~s}if(i=r,i=Di()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*dB(i/1960))-i,10<i){n.timeoutHandle=ng(oo.bind(null,n,Br,Cs),i);break}oo(n,Br,Cs);break;case 5:oo(n,Br,Cs);break;default:throw Error(ye(329))}}}return Gr(n,Di()),n.callbackNode===t?kC.bind(null,n):null}function Ag(n,e){var t=Zc;return n.current.memoizedState.isDehydrated&&(bo(n,e).flags|=256),n=Md(n,e),n!==2&&(e=Br,Br=t,e!==null&&Sg(e)),n}function Sg(n){Br===null?Br=n:Br.push.apply(Br,n)}function fB(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],s=r.getSnapshot;r=r.value;try{if(!Un(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ma(n,e){for(e&=~uv,e&=~cf,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Ln(e),i=1<<t;n[t]=-1,e&=~i}}function fy(n){if(Nt&6)throw Error(ye(327));Nl();var e=ud(n,0);if(!(e&1))return Gr(n,Di()),null;var t=Md(n,e);if(n.tag!==0&&t===2){var i=$p(n);i!==0&&(e=i,t=Ag(n,i))}if(t===1)throw t=Au,bo(n,0),ma(n,e),Gr(n,Di()),t;if(t===6)throw Error(ye(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,oo(n,Br,Cs),Gr(n,Di()),null}function dv(n,e){var t=Nt;Nt|=1;try{return n(e)}finally{Nt=t,Nt===0&&(jl=Di()+500,sf&&Wa())}}function wo(n){Ta!==null&&Ta.tag===0&&!(Nt&6)&&Nl();var e=Nt;Nt|=1;var t=vn.transition,i=Kt;try{if(vn.transition=null,Kt=1,n)return n()}finally{Kt=i,vn.transition=t,Nt=e,!(Nt&6)&&Wa()}}function fv(){Xr=Tl.current,ci(Tl)}function bo(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,W5(t)),Vi!==null)for(t=Vi.return;t!==null;){var i=t;switch(Ym(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&pd();break;case 3:Wl(),ci(zr),ci(Tr),iv();break;case 5:tv(i);break;case 4:Wl();break;case 13:ci(yi);break;case 19:ci(yi);break;case 10:Qm(i.type._context);break;case 22:case 23:fv()}t=t.return}if(cr=n,Vi=n=Pa(n.current,null),pr=Xr=e,Qi=0,Au=null,uv=cf=Po=0,Br=Zc=null,_o!==null){for(e=0;e<_o.length;e++)if(t=_o[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,s=t.pending;if(s!==null){var a=s.next;s.next=r,i.next=a}t.pending=i}_o=null}return n}function BC(n,e){do{var t=Vi;try{if($m(),zh.current=Ad,Cd){for(var i=Ti.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Cd=!1}if(Io=0,sr=qi=Ti=null,$c=!1,Tu=0,cv.current=null,t===null||t.return===null){Qi=1,Au=e,Vi=null;break}e:{var s=n,a=t.return,l=t,o=e;if(e=pr,l.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){var c=o,u=l,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=ey(a);if(f!==null){f.flags&=-257,ty(f,a,l,s,e),f.mode&1&&JE(s,c,e),e=f,o=c;var _=e.updateQueue;if(_===null){var p=new Set;p.add(o),e.updateQueue=p}else _.add(o);break e}else{if(!(e&1)){JE(s,c,e),_v();break e}o=Error(ye(426))}}else if(pi&&l.mode&1){var v=ey(a);if(v!==null){!(v.flags&65536)&&(v.flags|=256),ty(v,a,l,s,e),Km(Hl(o,l));break e}}s=o=Hl(o,l),Qi!==4&&(Qi=2),Zc===null?Zc=[s]:Zc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var E=TC(s,o,e);YE(s,E);break e;case 1:l=o;var g=s.type,m=s.stateNode;if(!(s.flags&128)&&(typeof g.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Ma===null||!Ma.has(m)))){s.flags|=65536,e&=-e,s.lanes|=e;var y=bC(s,l,e);YE(s,y);break e}}s=s.return}while(s!==null)}VC(t)}catch(T){e=T,Vi===t&&t!==null&&(Vi=t=t.return);continue}break}while(!0)}function UC(){var n=Sd.current;return Sd.current=Ad,n===null?Ad:n}function _v(){(Qi===0||Qi===3||Qi===2)&&(Qi=4),cr===null||!(Po&268435455)&&!(cf&268435455)||ma(cr,pr)}function Md(n,e){var t=Nt;Nt|=2;var i=UC();(cr!==n||pr!==e)&&(Cs=null,bo(n,e));do try{_B();break}catch(r){BC(n,r)}while(!0);if($m(),Nt=t,Sd.current=i,Vi!==null)throw Error(ye(261));return cr=null,pr=0,Qi}function _B(){for(;Vi!==null;)zC(Vi)}function pB(){for(;Vi!==null&&!zk();)zC(Vi)}function zC(n){var e=WC(n.alternate,n,Xr);n.memoizedProps=n.pendingProps,e===null?VC(n):Vi=e,cv.current=null}function VC(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=lB(t,e),t!==null){t.flags&=32767,Vi=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Qi=6,Vi=null;return}}else if(t=oB(t,e,Xr),t!==null){Vi=t;return}if(e=e.sibling,e!==null){Vi=e;return}Vi=e=n}while(e!==null);Qi===0&&(Qi=5)}function oo(n,e,t){var i=Kt,r=vn.transition;try{vn.transition=null,Kt=1,gB(n,e,t,i)}finally{vn.transition=r,Kt=i}return null}function gB(n,e,t,i){do Nl();while(Ta!==null);if(Nt&6)throw Error(ye(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(ye(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if($k(n,s),n===cr&&(Vi=cr=null,pr=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Ch||(Ch=!0,HC(cd,function(){return Nl(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=vn.transition,vn.transition=null;var a=Kt;Kt=1;var l=Nt;Nt|=4,cv.current=null,uB(n,t),NC(t,n),F5(ig),hd=!!tg,ig=tg=null,n.current=t,hB(t),Vk(),Nt=l,Kt=a,vn.transition=s}else n.current=t;if(Ch&&(Ch=!1,Ta=n,xd=r),s=n.pendingLanes,s===0&&(Ma=null),Hk(t.stateNode),Gr(n,Di()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(Rd)throw Rd=!1,n=bg,bg=null,n;return xd&1&&n.tag!==0&&Nl(),s=n.pendingLanes,s&1?n===Cg?Jc++:(Jc=0,Cg=n):Jc=0,Wa(),null}function Nl(){if(Ta!==null){var n=Tb(xd),e=vn.transition,t=Kt;try{if(vn.transition=null,Kt=16>n?16:n,Ta===null)var i=!1;else{if(n=Ta,Ta=null,xd=0,Nt&6)throw Error(ye(331));var r=Nt;for(Nt|=4,ze=n.current;ze!==null;){var s=ze,a=s.child;if(ze.flags&16){var l=s.deletions;if(l!==null){for(var o=0;o<l.length;o++){var c=l[o];for(ze=c;ze!==null;){var u=ze;switch(u.tag){case 0:case 11:case 15:Qc(8,u,s)}var h=u.child;if(h!==null)h.return=u,ze=h;else for(;ze!==null;){u=ze;var d=u.sibling,f=u.return;if(OC(u),u===c){ze=null;break}if(d!==null){d.return=f,ze=d;break}ze=f}}}var _=s.alternate;if(_!==null){var p=_.child;if(p!==null){_.child=null;do{var v=p.sibling;p.sibling=null,p=v}while(p!==null)}}ze=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,ze=a;else e:for(;ze!==null;){if(s=ze,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Qc(9,s,s.return)}var E=s.sibling;if(E!==null){E.return=s.return,ze=E;break e}ze=s.return}}var g=n.current;for(ze=g;ze!==null;){a=ze;var m=a.child;if(a.subtreeFlags&2064&&m!==null)m.return=a,ze=m;else e:for(a=g;ze!==null;){if(l=ze,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:lf(9,l)}}catch(T){Ri(l,l.return,T)}if(l===a){ze=null;break e}var y=l.sibling;if(y!==null){y.return=l.return,ze=y;break e}ze=l.return}}if(Nt=r,Wa(),ss&&typeof ss.onPostCommitFiberRoot=="function")try{ss.onPostCommitFiberRoot(Jd,n)}catch{}i=!0}return i}finally{Kt=t,vn.transition=e}}return!1}function _y(n,e,t){e=Hl(t,e),e=TC(n,e,1),n=xa(n,e,1),e=Pr(),n!==null&&(Bu(n,1,e),Gr(n,e))}function Ri(n,e,t){if(n.tag===3)_y(n,n,t);else for(;e!==null;){if(e.tag===3){_y(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Ma===null||!Ma.has(i))){n=Hl(t,n),n=bC(e,n,1),e=xa(e,n,1),n=Pr(),e!==null&&(Bu(e,1,n),Gr(e,n));break}}e=e.return}}function mB(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=Pr(),n.pingedLanes|=n.suspendedLanes&t,cr===n&&(pr&t)===t&&(Qi===4||Qi===3&&(pr&130023424)===pr&&500>Di()-hv?bo(n,0):uv|=t),Gr(n,e)}function GC(n,e){e===0&&(n.mode&1?(e=fh,fh<<=1,!(fh&130023424)&&(fh=4194304)):e=1);var t=Pr();n=Us(n,e),n!==null&&(Bu(n,e,t),Gr(n,t))}function vB(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),GC(n,t)}function EB(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(ye(314))}i!==null&&i.delete(e),GC(n,t)}var WC;WC=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||zr.current)Ur=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Ur=!1,aB(n,e,t);Ur=!!(n.flags&131072)}else Ur=!1,pi&&e.flags&1048576&&Yb(e,vd,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Gh(n,e),n=e.pendingProps;var r=zl(e,Tr.current);Ll(e,t),r=nv(null,e,i,n,r,t);var s=sv();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Vr(i)?(s=!0,gd(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Jm(e),r.updater=of,e.stateNode=r,r._reactInternals=e,hg(e,i,n,t),e=_g(null,e,i,!0,s,t)):(e.tag=0,pi&&s&&Xm(e),xr(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(Gh(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=TB(i),n=Rn(i,n),r){case 0:e=fg(null,e,i,n,t);break e;case 1:e=ny(null,e,i,n,t);break e;case 11:e=iy(null,e,i,n,t);break e;case 14:e=ry(null,e,i,Rn(i.type,n),t);break e}throw Error(ye(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Rn(i,r),fg(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Rn(i,r),ny(n,e,i,r,t);case 3:e:{if(RC(e),n===null)throw Error(ye(387));i=e.pendingProps,s=e.memoizedState,r=s.element,Jb(n,e),Td(e,i,null,t);var a=e.memoizedState;if(i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Hl(Error(ye(423)),e),e=sy(n,e,i,t,r);break e}else if(i!==r){r=Hl(Error(ye(424)),e),e=sy(n,e,i,t,r);break e}else for($r=Ra(e.stateNode.containerInfo.firstChild),Jr=e,pi=!0,On=null,t=Qb(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Vl(),i===r){e=zs(n,e,t);break e}xr(n,e,i,t)}e=e.child}return e;case 5:return eC(e),n===null&&lg(e),i=e.type,r=e.pendingProps,s=n!==null?n.memoizedProps:null,a=r.children,rg(i,r)?a=null:s!==null&&rg(i,s)&&(e.flags|=32),SC(n,e),xr(n,e,a,t),e.child;case 6:return n===null&&lg(e),null;case 13:return xC(n,e,t);case 4:return ev(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=Gl(e,null,i,t):xr(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Rn(i,r),iy(n,e,i,r,t);case 7:return xr(n,e,e.pendingProps,t),e.child;case 8:return xr(n,e,e.pendingProps.children,t),e.child;case 12:return xr(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,a=r.value,ai(Ed,i._currentValue),i._currentValue=a,s!==null)if(Un(s.value,a)){if(s.children===r.children&&!zr.current){e=zs(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){a=s.child;for(var o=l.firstContext;o!==null;){if(o.context===i){if(s.tag===1){o=Os(-1,t&-t),o.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?o.next=o:(o.next=u.next,u.next=o),c.pending=o}}s.lanes|=t,o=s.alternate,o!==null&&(o.lanes|=t),cg(s.return,t,e),l.lanes|=t;break}o=o.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ye(341));a.lanes|=t,l=a.alternate,l!==null&&(l.lanes|=t),cg(a,t,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}xr(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Ll(e,t),r=En(r),i=i(r),e.flags|=1,xr(n,e,i,t),e.child;case 14:return i=e.type,r=Rn(i,e.pendingProps),r=Rn(i.type,r),ry(n,e,i,r,t);case 15:return CC(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Rn(i,r),Gh(n,e),e.tag=1,Vr(i)?(n=!0,gd(e)):n=!1,Ll(e,t),yC(e,i,r),hg(e,i,r,t),_g(null,e,i,!0,n,t);case 19:return MC(n,e,t);case 22:return AC(n,e,t)}throw Error(ye(156,e.tag))};function HC(n,e){return mb(n,e)}function yB(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gn(n,e,t,i){return new yB(n,e,t,i)}function pv(n){return n=n.prototype,!(!n||!n.isReactComponent)}function TB(n){if(typeof n=="function")return pv(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Lm)return 11;if(n===Nm)return 14}return 2}function Pa(n,e){var t=n.alternate;return t===null?(t=gn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function jh(n,e,t,i,r,s){var a=2;if(i=n,typeof n=="function")pv(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case hl:return Co(t.children,r,s,e);case Dm:a=8,r|=8;break;case Np:return n=gn(12,t,e,r|2),n.elementType=Np,n.lanes=s,n;case Fp:return n=gn(13,t,e,r),n.elementType=Fp,n.lanes=s,n;case kp:return n=gn(19,t,e,r),n.elementType=kp,n.lanes=s,n;case eb:return uf(t,r,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Z1:a=10;break e;case J1:a=9;break e;case Lm:a=11;break e;case Nm:a=14;break e;case da:a=16,i=null;break e}throw Error(ye(130,n==null?n:typeof n,""))}return e=gn(a,t,e,r),e.elementType=n,e.type=i,e.lanes=s,e}function Co(n,e,t,i){return n=gn(7,n,i,e),n.lanes=t,n}function uf(n,e,t,i){return n=gn(22,n,i,e),n.elementType=eb,n.lanes=t,n.stateNode={isHidden:!1},n}function ip(n,e,t){return n=gn(6,n,null,e),n.lanes=t,n}function rp(n,e,t){return e=gn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function bB(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=k_(0),this.expirationTimes=k_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=k_(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function gv(n,e,t,i,r,s,a,l,o){return n=new bB(n,e,t,l,o),e===1?(e=1,s===!0&&(e|=8)):e=0,s=gn(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jm(s),n}function CB(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ul,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function jC(n){if(!n)return ka;n=n._reactInternals;e:{if(No(n)!==n||n.tag!==1)throw Error(ye(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Vr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ye(171))}if(n.tag===1){var t=n.type;if(Vr(t))return jb(n,t,e)}return e}function XC(n,e,t,i,r,s,a,l,o){return n=gv(t,i,!0,n,r,s,a,l,o),n.context=jC(null),t=n.current,i=Pr(),r=Ia(t),s=Os(i,r),s.callback=e??null,xa(t,s,r),n.current.lanes=r,Bu(n,r,i),Gr(n,i),n}function hf(n,e,t,i){var r=e.current,s=Pr(),a=Ia(r);return t=jC(t),e.context===null?e.context=t:e.pendingContext=t,e=Os(s,a),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=xa(r,e,a),n!==null&&(Nn(n,r,a,s),Uh(n,r,a)),a}function Id(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function py(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function mv(n,e){py(n,e),(n=n.alternate)&&py(n,e)}function AB(){return null}var YC=typeof reportError=="function"?reportError:function(n){console.error(n)};function vv(n){this._internalRoot=n}df.prototype.render=vv.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(ye(409));hf(n,e,null,null)};df.prototype.unmount=vv.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;wo(function(){hf(null,n,null,null)}),e[Bs]=null}};function df(n){this._internalRoot=n}df.prototype.unstable_scheduleHydration=function(n){if(n){var e=Ab();n={blockedOn:null,target:n,priority:e};for(var t=0;t<ga.length&&e!==0&&e<ga[t].priority;t++);ga.splice(t,0,n),t===0&&Rb(n)}};function Ev(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function ff(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function gy(){}function SB(n,e,t,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var c=Id(a);s.call(c)}}var a=XC(e,i,n,0,null,!1,!1,"",gy);return n._reactRootContainer=a,n[Bs]=a.current,gu(n.nodeType===8?n.parentNode:n),wo(),a}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var l=i;i=function(){var c=Id(o);l.call(c)}}var o=gv(n,0,!1,null,null,!1,!1,"",gy);return n._reactRootContainer=o,n[Bs]=o.current,gu(n.nodeType===8?n.parentNode:n),wo(function(){hf(e,o,t,i)}),o}function _f(n,e,t,i,r){var s=t._reactRootContainer;if(s){var a=s;if(typeof r=="function"){var l=r;r=function(){var o=Id(a);l.call(o)}}hf(e,a,n,r)}else a=SB(t,e,n,r,i);return Id(a)}bb=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=kc(e.pendingLanes);t!==0&&(Bm(e,t|1),Gr(e,Di()),!(Nt&6)&&(jl=Di()+500,Wa()))}break;case 13:wo(function(){var i=Us(n,1);if(i!==null){var r=Pr();Nn(i,n,1,r)}}),mv(n,1)}};Um=function(n){if(n.tag===13){var e=Us(n,134217728);if(e!==null){var t=Pr();Nn(e,n,134217728,t)}mv(n,134217728)}};Cb=function(n){if(n.tag===13){var e=Ia(n),t=Us(n,e);if(t!==null){var i=Pr();Nn(t,n,e,i)}mv(n,e)}};Ab=function(){return Kt};Sb=function(n,e){var t=Kt;try{return Kt=n,e()}finally{Kt=t}};Yp=function(n,e,t){switch(e){case"input":if(zp(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=nf(i);if(!r)throw Error(ye(90));ib(i),zp(i,r)}}}break;case"textarea":nb(n,t);break;case"select":e=t.value,e!=null&&Pl(n,!!t.multiple,e,!1)}};hb=dv;db=wo;var RB={usingClientEntryPoint:!1,Events:[zu,pl,nf,cb,ub,dv]},Cc={findFiberByHostInstance:fo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},xB={bundleType:Cc.bundleType,version:Cc.version,rendererPackageName:Cc.rendererPackageName,rendererConfig:Cc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Hs.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=pb(n),n===null?null:n.stateNode},findFiberByHostInstance:Cc.findFiberByHostInstance||AB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ah.isDisabled&&Ah.supportsFiber)try{Jd=Ah.inject(xB),ss=Ah}catch{}}tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=RB;tn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ev(e))throw Error(ye(200));return CB(n,e,null,t)};tn.createRoot=function(n,e){if(!Ev(n))throw Error(ye(299));var t=!1,i="",r=YC;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=gv(n,1,!1,null,null,t,!1,i,r),n[Bs]=e.current,gu(n.nodeType===8?n.parentNode:n),new vv(e)};tn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(ye(188)):(n=Object.keys(n).join(","),Error(ye(268,n)));return n=pb(e),n=n===null?null:n.stateNode,n};tn.flushSync=function(n){return wo(n)};tn.hydrate=function(n,e,t){if(!ff(e))throw Error(ye(200));return _f(null,n,e,!0,t)};tn.hydrateRoot=function(n,e,t){if(!Ev(n))throw Error(ye(405));var i=t!=null&&t.hydratedSources||null,r=!1,s="",a=YC;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=XC(e,null,n,1,t??null,r,!1,s,a),n[Bs]=e.current,gu(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new df(e)};tn.render=function(n,e,t){if(!ff(e))throw Error(ye(200));return _f(null,n,e,!1,t)};tn.unmountComponentAtNode=function(n){if(!ff(n))throw Error(ye(40));return n._reactRootContainer?(wo(function(){_f(null,null,n,!1,function(){n._reactRootContainer=null,n[Bs]=null})}),!0):!1};tn.unstable_batchedUpdates=dv;tn.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!ff(t))throw Error(ye(200));if(n==null||n._reactInternals===void 0)throw Error(ye(38));return _f(n,e,t,!1,i)};tn.version="18.3.1-next-f1338f8080-20240426";function KC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(KC)}catch(n){console.error(n)}}KC(),K1.exports=tn;var nc=K1.exports;const MB=nm(nc),IB=UT({__proto__:null,default:MB},[nc]);var PB=function(){var e=S.useState(!1),t=yt(e,2),i=t[0],r=t[1];return S.useEffect(function(){r(X1())},[]),{isBrowser:i,isServer:!i}},my=function(e){var t=document.createElement("div");return t.setAttribute("id",e),t},yv=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:H1(),t=arguments.length>1?arguments[1]:void 0,i="geist-ui-".concat(e),r=PB(),s=r.isBrowser,a=S.useState(s?my(i):null),l=yt(a,2),o=l[0],c=l[1];return S.useEffect(function(){var u=t?t():null,h=u||document.body,d=h.querySelector("#".concat(i)),f=d||my(i);d||h.appendChild(f),c(f)},[]),o},qC=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;S.useEffect(function(){var i=function(){return e()};return t&&i(),window.addEventListener("resize",i),function(){return window.removeEventListener("resize",i)}},[])},wB=["children","className","visible","enterTime","leaveTime","clearTime","name"],OB={visible:!1,enterTime:60,leaveTime:60,clearTime:60,className:"",name:"transition"},sc=function(e){var t=e.children,i=e.className,r=e.visible,s=e.enterTime,a=e.leaveTime,l=e.clearTime,o=e.name,c=pt(e,wB),u=S.useState(""),h=yt(u,2),d=h[0],f=h[1],_=S.useState(r),p=yt(_,2),v=p[0],E=p[1];return S.useEffect(function(){var g=r?"enter":"leave",m=r?s:a;r&&!v&&E(!0),f("".concat(o,"-").concat(g));var y=setTimeout(function(){f("".concat(o,"-").concat(g," ").concat(o,"-").concat(g,"-active")),clearTimeout(y)},m),T=setTimeout(function(){r||(f(""),E(!1)),clearTimeout(T)},m+l);return function(){clearTimeout(y),clearTimeout(T)}},[r,v]),!k.isValidElement(t)||!v?null:k.cloneElement(t,Ge({},c,{className:"".concat(t.props.className," ").concat(i," ").concat(d)}))};sc.defaultProps=OB;sc.displayName="GeistCssTransition";var DB=function(e){S.useEffect(function(){var t=function(r){return e(r)};return document.addEventListener("click",t),function(){return document.removeEventListener("click",t)}},[e])},vy={},LB=function(e,t){var i=" [".concat(t,"]"),r="[Geist UI]".concat(i,": ").concat(e);typeof console>"u"||vy[r]||(vy[r]=!0,console.warn(r))},NB=["children","type","color","className","spaceRatio"],FB={type:"default",className:"",spaceRatio:1},kB=function(e,t,i){var r={default:t.accents_6,secondary:t.secondary,success:t.success,warning:t.warning,error:t.error};return i||r[e]},Tv=function(e){var t=e.children,i=e.type,r=e.color,s=e.className,a=e.spaceRatio,l=pt(e,NB),o=Lt(),c=$t(),u=c.SCALES,h=Ut("loading-container",s),d=S.useMemo(function(){return kB(i,o.palette,r)},[i,o.palette,r]);return k.createElement("div",Ge({},l,{className:Q.dynamic([["2201634259",[u.font(1),u.width(1,"100%"),u.height(1,"100%"),u.pt(0),u.pr(0),u.pb(0),u.pl(0),u.mt(0),u.mr(0),u.mb(0),u.ml(0),o.palette.accents_5,d,a]]])+" "+(l&&l.className!=null&&l.className||h||"")}),k.createElement("span",{className:Q.dynamic([["2201634259",[u.font(1),u.width(1,"100%"),u.height(1,"100%"),u.pt(0),u.pr(0),u.pb(0),u.pl(0),u.mt(0),u.mr(0),u.mb(0),u.ml(0),o.palette.accents_5,d,a]]])+" loading"},t&&k.createElement("label",{className:Q.dynamic([["2201634259",[u.font(1),u.width(1,"100%"),u.height(1,"100%"),u.pt(0),u.pr(0),u.pb(0),u.pl(0),u.mt(0),u.mr(0),u.mb(0),u.ml(0),o.palette.accents_5,d,a]]])},t),k.createElement("i",{className:Q.dynamic([["2201634259",[u.font(1),u.width(1,"100%"),u.height(1,"100%"),u.pt(0),u.pr(0),u.pb(0),u.pl(0),u.mt(0),u.mr(0),u.mb(0),u.ml(0),o.palette.accents_5,d,a]]])}),k.createElement("i",{className:Q.dynamic([["2201634259",[u.font(1),u.width(1,"100%"),u.height(1,"100%"),u.pt(0),u.pr(0),u.pb(0),u.pl(0),u.mt(0),u.mr(0),u.mb(0),u.ml(0),o.palette.accents_5,d,a]]])}),k.createElement("i",{className:Q.dynamic([["2201634259",[u.font(1),u.width(1,"100%"),u.height(1,"100%"),u.pt(0),u.pr(0),u.pb(0),u.pl(0),u.mt(0),u.mr(0),u.mb(0),u.ml(0),o.palette.accents_5,d,a]]])})),k.createElement(Q,{id:"2201634259",dynamic:[u.font(1),u.width(1,"100%"),u.height(1,"100%"),u.pt(0),u.pr(0),u.pb(0),u.pl(0),u.mt(0),u.mr(0),u.mb(0),u.ml(0),o.palette.accents_5,d,a]},".loading-container.__jsx-style-dynamic-selector{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;font-size:".concat(u.font(1),";width:").concat(u.width(1,"100%"),";height:").concat(u.height(1,"100%"),";min-height:1em;padding:").concat(u.pt(0)," ").concat(u.pr(0)," ").concat(u.pb(0)," ").concat(u.pl(0),";margin:").concat(u.mt(0)," ").concat(u.mr(0)," ").concat(u.mb(0)," ").concat(u.ml(0),";}label.__jsx-style-dynamic-selector{margin-right:0.5em;color:").concat(o.palette.accents_5,";line-height:1;}label.__jsx-style-dynamic-selector *{margin:0;}.loading.__jsx-style-dynamic-selector{position:absolute;top:50%;left:50%;width:100%;height:100%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:transparent;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}i.__jsx-style-dynamic-selector{width:0.25em;height:0.25em;border-radius:50%;background-color:").concat(d,";margin:0 calc(0.25em / 2 * ").concat(a,");display:inline-block;-webkit-animation:loading-blink-__jsx-style-dynamic-selector 1.4s infinite both;animation:loading-blink-__jsx-style-dynamic-selector 1.4s infinite both;}i.__jsx-style-dynamic-selector:nth-child(2){-webkit-animation-delay:0.2s;animation-delay:0.2s;}i.__jsx-style-dynamic-selector:nth-child(3){-webkit-animation-delay:0.4s;animation-delay:0.4s;}@-webkit-keyframes loading-blink-__jsx-style-dynamic-selector{0%{opacity:0.2;}20%{opacity:1;}100%{opacity:0.2;}}@keyframes loading-blink-__jsx-style-dynamic-selector{0%{opacity:0.2;}20%{opacity:1;}100%{opacity:0.2;}}")))};Tv.defaultProps=FB;Tv.displayName="GeistLoading";var bv=oi(Tv),Pd=function(e){var t=S.useState(function(){return typeof e=="function"?e():e}),i=yt(t,2),r=i[0],s=i[1],a=S.useRef(e);S.useEffect(function(){a.current=r},[r]);var l=function(c){var u=typeof c=="function"?c(a.current):c;a.current=u,s(u)};return[r,l,a]},BB=function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,i=e.replace(t,function(s,a,l,o){return"".concat(a).concat(a).concat(l).concat(l).concat(o).concat(o)}),r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i);if(!r)throw new Error("Geist UI: Unsupported ".concat(e," color."));return[Number.parseInt(r[1],16),Number.parseInt(r[2],16),Number.parseInt(r[3],16)]},UB=function(e){if(e.charAt(0)==="#")return BB(e);var t=e.replace(/ /g,""),i=e.substr(0,4),r=t.match(/\((.+)\)/);if(!i.startsWith("rgb")||!r)throw console.log(e),new Error('Geist UI: Only support ["RGB", "RGBA", "HEX"] color.');return r[1].split(",").map(function(s){return Number.parseFloat(s)})},Fl=function(e,t){if(!/^#|rgb|RGB/.test(e))return e;var i=UB(e),r=yt(i,3),s=r[0],a=r[1],l=r[2],o=t>1?1:t<0?0:t;return"rgba(".concat(s,", ").concat(a,", ").concat(l,", ").concat(o,")")},$C=function(){return k.createElement("svg",{viewBox:"0 0 24 24",width:"0.9375em",height:"0.9375em",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",shapeRendering:"geometricPrecision",className:"jsx-3409194595 icon"},k.createElement("path",{d:"M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6",className:"jsx-3409194595"}),k.createElement("path",{d:"M15 3h6v6",className:"jsx-3409194595"}),k.createElement("path",{d:"M10 14L21 3",className:"jsx-3409194595"}),k.createElement(Q,{id:"3409194595"},".icon.jsx-3409194595{margin:0 0 -1px 0.1875em;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;color:currentColor;}"))};$C.displayName="GeistLinkIcon";var zB=k.memo($C),VB=["href","color","underline","children","className","block","icon"],GB={href:"",color:!1,icon:!1,underline:!1,block:!1,className:""},Cv=k.forwardRef(function(n,e){var t=n.href,i=n.color,r=n.underline,s=n.children,a=n.className,l=n.block,o=n.icon,c=pt(n,VB),u=Lt(),h=$t(),d=h.SCALES,f=i||l?u.palette.link:"inherit",_=i||l?u.palette.successLight:"inherit",p=r?"underline":"none",v=Ut("link",{block:l},a);return k.createElement("a",Ge({href:t},c,{ref:e,className:Q.dynamic([["442871747",[f,l?u.layout.radius:0,d.font(1,"inherit"),d.width(1,"fit-content"),d.height(1,"auto"),d.mt(0),d.mr(0),d.mb(0),d.ml(0),d.pt(0),d.pr(0),d.pb(0),d.pl(0),d.pt(.125),d.pr(.25),d.pb(.125),d.pl(.25),d.mt(0),d.mr(-.125),d.mb(0),d.ml(-.125),p,l?Fl(u.palette.link,.1):"unset",_]]])+" "+(c&&c.className!=null&&c.className||v||"")}),s,o&&k.createElement(zB,null),k.createElement(Q,{id:"442871747",dynamic:[f,l?u.layout.radius:0,d.font(1,"inherit"),d.width(1,"fit-content"),d.height(1,"auto"),d.mt(0),d.mr(0),d.mb(0),d.ml(0),d.pt(0),d.pr(0),d.pb(0),d.pl(0),d.pt(.125),d.pr(.25),d.pb(.125),d.pl(.25),d.mt(0),d.mr(-.125),d.mb(0),d.ml(-.125),p,l?Fl(u.palette.link,.1):"unset",_]},".link.__jsx-style-dynamic-selector{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:baseline;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;line-height:inherit;color:".concat(f,";-webkit-text-decoration:none;text-decoration:none;border-radius:").concat(l?u.layout.radius:0,";-webkit-transition:color 200ms ease 0ms;transition:color 200ms ease 0ms;font-size:").concat(d.font(1,"inherit"),";width:").concat(d.width(1,"fit-content"),";height:").concat(d.height(1,"auto"),";margin:").concat(d.mt(0)," ").concat(d.mr(0)," ").concat(d.mb(0)," ").concat(d.ml(0),";padding:").concat(d.pt(0)," ").concat(d.pr(0)," ").concat(d.pb(0)," ").concat(d.pl(0),";}.block.__jsx-style-dynamic-selector{padding:").concat(d.pt(.125)," ").concat(d.pr(.25)," ").concat(d.pb(.125)," ").concat(d.pl(.25),";margin:").concat(d.mt(0)," ").concat(d.mr(-.125)," ").concat(d.mb(0)," ").concat(d.ml(-.125),";}.link.__jsx-style-dynamic-selector:hover,.link.__jsx-style-dynamic-selector:active,.link.__jsx-style-dynamic-selector:focus{-webkit-text-decoration:").concat(p,";text-decoration:").concat(p,";}.link.__jsx-style-dynamic-selector:hover{background-color:").concat(l?Fl(u.palette.link,.1):"unset",";color:").concat(_,";}")))});Cv.defaultProps=GB;Cv.displayName="GeistLink";var WB=oi(Cv),HB={x:0,y:0},Av=function(e){var t=e.x,i=e.y,r=e.color,s=e.onCompleted,a=S.useRef(null),l=Number.isNaN(+i)?0:i-10,o=Number.isNaN(+t)?0:t-10;return S.useEffect(function(){if(a.current)return a.current.addEventListener("animationend",s),function(){a.current&&a.current.removeEventListener("animationend",s)}}),k.createElement("div",{ref:a,className:"jsx-3424889537 drip"},k.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{top:l,left:o},className:"jsx-3424889537"},k.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",className:"jsx-3424889537"},k.createElement("g",{fill:r,className:"jsx-3424889537"},k.createElement("rect",{width:"100%",height:"100%",rx:"10",className:"jsx-3424889537"})))),k.createElement(Q,{id:"3424889537"},".drip.jsx-3424889537{position:absolute;left:0;right:0;top:0;bottom:0;}svg.jsx-3424889537{position:absolute;-webkit-animation:350ms ease-in expand-jsx-3424889537;animation:350ms ease-in expand-jsx-3424889537;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;width:1rem;height:1rem;}@-webkit-keyframes expand-jsx-3424889537{0%{opacity:0;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1);}30%{opacity:1;}80%{opacity:0.5;}100%{-webkit-transform:scale(28);-ms-transform:scale(28);transform:scale(28);opacity:0;}}@keyframes expand-jsx-3424889537{0%{opacity:0;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1);}30%{opacity:1;}80%{opacity:0.5;}100%{-webkit-transform:scale(28);-ms-transform:scale(28);transform:scale(28);opacity:0;}}"))};Av.defaultProps=HB;Av.displayName="GeistButtonDrip";var QC=function(e){var t=e.color;return k.createElement("div",{className:"jsx-3416748964 btn-loading"},k.createElement(bv,{color:t}),k.createElement(Q,{id:"3416748964"},".btn-loading.jsx-3416748964{position:absolute;top:0;left:0;right:0;bottom:0;z-index:2;background-color:var(--geist-ui-button-bg);}"))};QC.displayName="GeistButtonLoading";var jB=["isRight","isSingle","children","className"],XB={isRight:!1,className:""},wd=function(e){var t=e.isRight,i=e.isSingle,r=e.children,s=e.className,a=pt(e,jB),l=Ut("icon",{right:t,single:i},s);return k.createElement("span",Ge({},a,{className:"jsx-643337184 "+(a&&a.className!=null&&a.className||l||"")}),r,k.createElement(Q,{id:"643337184"},".icon.jsx-643337184{position:absolute;left:var(--geist-ui-button-icon-padding);right:auto;top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:var(--geist-ui-button-color);z-index:1;}.right.jsx-643337184{right:var(--geist-ui-button-icon-padding);left:auto;}.icon.jsx-643337184 svg{background:transparent;height:calc(var(--geist-ui-button-height) / 2.35);width:calc(var(--geist-ui-button-height) / 2.35);}.single.jsx-643337184{position:static;-webkit-transform:none;-ms-transform:none;transform:none;}"))};wd.defaultProps=XB;wd.displayName="GeistButtonIcon";var YB=function(e,t,i){var r=i.icon,s=i.iconRight,a=r||s,l=!!s,o=e?"calc(var(--geist-ui-button-height) / 2 + var(--geist-ui-button-icon-padding) * .5)":0,c=Ut("text",l?"right":"left");return a?k.Children.count(t)===0?k.createElement(wd,{isRight:l,isSingle:!0},a):k.createElement(k.Fragment,null,k.createElement(wd,{isRight:l},a),k.createElement("div",{className:Q.dynamic([["3568181479",[o,o]]])+" "+(c||"")},t,k.createElement(Q,{id:"3568181479",dynamic:[o,o]},".left.__jsx-style-dynamic-selector{padding-left:".concat(o,";}.right.__jsx-style-dynamic-selector{padding-right:").concat(o,";}")))):k.createElement("div",{className:"text"},t)},KB=function(e,t){return t.isButtonGroup?Ge({},e,{auto:!0,shadow:!1,ghost:t.ghost||e.ghost,type:t.type||e.type,disabled:t.disabled||e.disabled}):e},qB={isButtonGroup:!1,disabled:!1},$B=k.createContext(qB),QB=function(){return k.useContext($B)},ZB=function(e,t){var i={secondary:{bg:e.background,border:e.foreground,color:e.foreground},success:{bg:e.background,border:e.success,color:e.success},warning:{bg:e.background,border:e.warning,color:e.warning},error:{bg:e.background,border:e.error,color:e.error}};return i[t]||null},ZC=function(e,t){var i=t.type,r=t.disabled,s=t.ghost,a={default:{bg:e.background,border:e.border,color:e.accents_5},secondary:{bg:e.foreground,border:e.foreground,color:e.background},success:{bg:e.success,border:e.success,color:"#fff"},warning:{bg:e.warning,border:e.warning,color:"#fff"},error:{bg:e.error,border:e.error,color:"#fff"},abort:{bg:"transparent",border:"transparent",color:e.accents_5}};if(r)return{bg:e.accents_1,border:e.accents_2,color:"#ccc"};var l=i==null?void 0:i.replace("-light",""),o=a.default;return s?ZB(e,l)||o:a[l]||o},JB=function(e,t){var i={secondary:{bg:e.foreground,border:e.background,color:e.background},success:{bg:e.success,border:e.background,color:"white"},warning:{bg:e.warning,border:e.background,color:"white"},error:{bg:e.error,border:e.background,color:"white"}},r=t.replace("-light","");return i[r]||null},JC=function(e,t){var i=t.type,r=t.disabled,s=t.loading,a=t.shadow,l=t.ghost,o=ZC(e,t),c=Fl(o.bg,.85),u={default:{bg:e.background,border:e.foreground},secondary:{bg:e.background,border:e.foreground},success:{bg:e.background,border:e.success},warning:{bg:e.background,border:e.warning},error:{bg:e.background,border:e.error},abort:{bg:"transparent",border:"transparent",color:e.accents_5},"secondary-light":Ge({},o,{bg:c}),"success-light":Ge({},o,{bg:c}),"warning-light":Ge({},o,{bg:c}),"error-light":Ge({},o,{bg:c})};if(r)return{bg:e.accents_1,border:e.accents_2,color:"#ccc"};if(s)return Ge({},o,{color:"transparent"});if(a)return o;var h=(l?JB(e,i):u[i])||u.default;return Ge({},h,{color:h.color||h.border})},eU=function(e,t){return e?{cursor:"not-allowed",events:"auto"}:t?{cursor:"default",events:"none"}:{cursor:"pointer",events:"auto"}},tU=function(e,t){var i=t.type,r=i.endsWith("light"),s=JC(e,t);return Fl(r?s.bg:e.accents_2,.65)},iU=["children","disabled","type","loading","shadow","ghost","effect","onClick","auto","icon","htmlType","iconRight","className"],rU={type:"default",htmlType:"button",ghost:!1,loading:!1,shadow:!1,auto:!1,effect:!0,disabled:!1,className:""},Sv=k.forwardRef(function(n,e){var t=Lt(),i=$t(),r=i.SCALES,s=S.useRef(null);S.useImperativeHandle(e,function(){return s.current});var a=S.useState(!1),l=yt(a,2),o=l[0],c=l[1],u=S.useState(0),h=yt(u,2),d=h[0],f=h[1],_=S.useState(0),p=yt(_,2),v=p[0],E=p[1],g=QB(),m=KB(n,g),y=m.children,T=m.disabled;m.type;var b=m.loading,C=m.shadow,M=m.ghost,F=m.effect,P=m.onClick,U=m.auto,G=m.icon,K=m.htmlType,q=m.iconRight,se=m.className,Ee=pt(m,iU),Se=S.useMemo(function(){return ZC(t.palette,m)},[t.palette,m]),$=Se.bg,_e=Se.border,ae=Se.color,ce=S.useMemo(function(){return JC(t.palette,m)},[t.palette,m]),he=S.useMemo(function(){return eU(T,b)},[T,b]),je=he.cursor,Xe=he.events,Tt=S.useMemo(function(){return tU(t.palette,m)},[t.palette,m]),Ze=function(){c(!1),f(0),E(0)},W=function($e){if(!(T||b)){var bt=!C&&!M&&F;if(bt&&s.current){var Wt=s.current.getBoundingClientRect();c(!0),f($e.clientX-Wt.left),E($e.clientY-Wt.top)}P&&P($e)}},pe=S.useMemo(function(){return YB(U,y,{icon:G,iconRight:q})},[U,y,G,q]),De=U?r.pl(1.15):r.pl(1.375),ft=U?r.pr(1.15):r.pr(1.375);return k.createElement("button",Ge({ref:s,type:K,disabled:T,onClick:W},Ee,{className:Q.dynamic([["86551275",[r.height(2.5),t.layout.radius,r.font(.875),ae,$,_e,je,Xe,C?t.expressiveness.shadowSmall:"none",r.pl(.727),r.height(2.5),ae,$,U?"min-content":r.width(10.5),U?"auto":"initial",r.height(2.5),r.pt(0),ft,r.pb(0),De,r.mt(0),r.mr(0),r.mb(0),r.ml(0),ce.color,ce.color,ce.bg,ce.border,je,Xe,C?t.expressiveness.shadowMedium:"none",C?"-1px":"0px"]]])+" "+(Ee&&Ee.className!=null&&Ee.className||Ut("btn",se)||"")}),b&&k.createElement(QC,{color:ae}),pe,o&&k.createElement(Av,{x:d,y:v,color:Tt,onCompleted:Ze}),k.createElement(Q,{id:"86551275",dynamic:[r.height(2.5),t.layout.radius,r.font(.875),ae,$,_e,je,Xe,C?t.expressiveness.shadowSmall:"none",r.pl(.727),r.height(2.5),ae,$,U?"min-content":r.width(10.5),U?"auto":"initial",r.height(2.5),r.pt(0),ft,r.pb(0),De,r.mt(0),r.mr(0),r.mb(0),r.ml(0),ce.color,ce.color,ce.bg,ce.border,je,Xe,C?t.expressiveness.shadowMedium:"none",C?"-1px":"0px"]},".btn.__jsx-style-dynamic-selector{box-sizing:border-box;display:inline-block;line-height:".concat(r.height(2.5),";border-radius:").concat(t.layout.radius,";font-weight:400;font-size:").concat(r.font(.875),";-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;outline:none;text-transform:capitalize;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;text-align:center;white-space:nowrap;-webkit-transition:background-color 200ms ease 0ms,box-shadow 200ms ease 0ms, border 200ms ease 0ms,color 200ms ease 0ms;transition:background-color 200ms ease 0ms,box-shadow 200ms ease 0ms, border 200ms ease 0ms,color 200ms ease 0ms;position:relative;overflow:hidden;color:").concat(ae,";background-color:").concat($,";border:1px solid ").concat(_e,";cursor:").concat(je,";pointer-events:").concat(Xe,";box-shadow:").concat(C?t.expressiveness.shadowSmall:"none",";--geist-ui-button-icon-padding:").concat(r.pl(.727),";--geist-ui-button-height:").concat(r.height(2.5),";--geist-ui-button-color:").concat(ae,";--geist-ui-button-bg:").concat($,";min-width:").concat(U?"min-content":r.width(10.5),";width:").concat(U?"auto":"initial",";height:").concat(r.height(2.5),";padding:").concat(r.pt(0)," ").concat(ft," ").concat(r.pb(0)," ").concat(De,";margin:").concat(r.mt(0)," ").concat(r.mr(0)," ").concat(r.mb(0)," ").concat(r.ml(0),";}.btn.__jsx-style-dynamic-selector:hover,.btn.__jsx-style-dynamic-selector:focus{color:").concat(ce.color,";--geist-ui-button-color:").concat(ce.color,";background-color:").concat(ce.bg,";border-color:").concat(ce.border,";cursor:").concat(je,";pointer-events:").concat(Xe,";box-shadow:").concat(C?t.expressiveness.shadowMedium:"none",";-webkit-transform:translate3d(0px,").concat(C?"-1px":"0px",",0px);-ms-transform:translate3d(0px,").concat(C?"-1px":"0px",",0px);transform:translate3d(0px,").concat(C?"-1px":"0px",",0px);}.btn.__jsx-style-dynamic-selector .text{position:relative;z-index:1;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;text-align:center;line-height:inherit;top:-1px;}.btn.__jsx-style-dynamic-selector .text p,.btn.__jsx-style-dynamic-selector .text pre,.btn.__jsx-style-dynamic-selector .text div{margin:0;}")))});Sv.defaultProps=rU;Sv.displayName="GeistButton";var Rv=oi(Sv),eA=function(e,t){var i=S.useRef(t);S.useEffect(function(){i.current=t},[t]),S.useEffect(function(){var r=function(a){var l=e.current;!a||!l||l.contains(a.target)||i.current(a)};return document.addEventListener("click",r),function(){return document.removeEventListener("click",r)}},[e])},tA=function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r={default:{color:e.accents_5,bgColor:e.background,borderLeftColor:e.accents_2,hoverBgColor:e.accents_1,hoverBorder:e.accents_2},secondary:{color:e.background,bgColor:e.foreground,borderLeftColor:e.accents_7,hoverBgColor:e.accents_7,hoverBorder:e.accents_7},success:{color:e.background,bgColor:e.success,borderLeftColor:e.successDark,hoverBgColor:e.successDark,hoverBorder:e.successDark},warning:{color:e.background,bgColor:e.warning,borderLeftColor:e.warningDark,hoverBgColor:e.warningDark,hoverBorder:e.warningDark},error:{color:e.background,bgColor:e.error,borderLeftColor:e.errorDark,hoverBgColor:e.errorDark,hoverBorder:e.errorDark}};return i?Ge({},r.default,{bgColor:e.accents_1,color:e.accents_4}):t?r[t]:r.default},iA=function(e){var t=e.color,i=e.height;return k.createElement("svg",{stroke:t,style:{color:t},viewBox:"0 0 24 24",width:i,height:i,strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",shapeRendering:"geometricPrecision",className:"jsx-3359574434"},k.createElement("path",{d:"M6 9l6 6 6-6",className:"jsx-3359574434"}),k.createElement(Q,{id:"3359574434"},"svg.jsx-3359574434{-webkit-transform:scale(0.6);-ms-transform:scale(0.6);transform:scale(0.6);}"))};iA.displayName="GeistButtonDropdownIcon";var nU={type:"default",auto:!1,disabled:!1,loading:!1},rA=k.createContext(nU),sU=function(){return k.useContext(rA)},aU=["children","onClick","className","main","type"],oU={main:!1,type:"default",onClick:function(){},className:""},pf=function(e){var t=e.children,i=e.onClick,r=e.className,s=e.main,a=e.type,l=pt(e,aU),o=Lt(),c=sU(),u=c.type,h=c.disabled,d=c.loading,f=s?u:a,_=tA(o.palette,f,h),p=function(g){h||d||i&&i(g)},v=S.useMemo(function(){return d?"default":h?"not-allowed":"pointer"},[d,h]);return k.createElement("button",Ge({onClick:p},l,{className:Q.dynamic([["772098729",[v,_.bgColor,_.color,_.hoverBorder,_.hoverBgColor]]])+" "+(l&&l.className!=null&&l.className||r||"")}),d?k.createElement(bv,null):t,k.createElement(Q,{id:"772098729",dynamic:[v,_.bgColor,_.color,_.hoverBorder,_.hoverBgColor]},"button.__jsx-style-dynamic-selector{position:relative;-webkit-appearance:button;text-rendering:auto;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex:1;-ms-flex:1;flex:1;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;vertical-align:middle;text-align:center;cursor:".concat(v,";box-sizing:border-box;margin:0;border:none;background-color:").concat(_.bgColor,";color:").concat(_.color,";width:100%;height:var(--geist-ui-dropdown-height);min-width:var(--geist-ui-dropdown-min-width);padding:var(--geist-ui-dropdown-padding);font-size:var(--geist-ui-dropdown-font-size);}button.__jsx-style-dynamic-selector:hover{border-color:").concat(_.hoverBorder,";background-color:").concat(_.hoverBgColor,";}")))};pf.defaultProps=oU;pf.displayName="GeistButtonDropdownItem";var lU=["children","type","auto","className","disabled","loading","icon"],cU={type:"default",auto:!1,loading:!1,disabled:!1,className:""},Ey=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},xv=function(e){var t=e.children,i=e.type,r=e.auto,s=e.className,a=e.disabled,l=e.loading,o=e.icon,c=pt(e,lU),u=$t(),h=u.SCALES,d=S.useRef(null),f=Lt(),_=tA(f.palette,i),p=sd(t,pf)[1],v=_k(p,"main",!0),E=yt(v,2),g=E[0],m=E[1],y=S.useState(!1),T=yt(y,2),b=T[0],C=T[1],M=S.useCallback(function(K){K.preventDefault(),Ey(K),!(a||l)&&C(!b)},[b]),F={type:i,auto:r,disabled:a,loading:l},P=S.useMemo(function(){return a||l?f.palette.accents_1:b?_.hoverBgColor:_.bgColor},[b,_,f.palette]),U=r?h.pl(1.15):h.pl(1.375),G=r?h.pr(1.15):h.pr(1.375);return eA(d,function(){return C(!1)}),k.createElement(rA.Provider,{value:F},k.createElement("div",Ge({ref:d,onClick:Ey},c,{className:Q.dynamic([["1706659335",[f.palette.border,f.layout.radius,h.height(2.5),r?"min-content":h.width(10.5),h.pt(0),G,h.pb(0),U,h.font(.875),f.layout.radius,f.layout.radius,f.layout.radius,f.layout.radius,h.height(2.5),_.color,P,h.height(2.5),_.borderLeftColor,a||l?"not-allowed":"pointer",_.hoverBorder,_.hoverBgColor,f.layout.radius,f.expressiveness.shadowLarge,f.layout.gapHalf,f.palette.background,f.layout.radius,f.layout.radius,f.layout.radius,f.layout.radius]]])+" "+(c&&c.className!=null&&c.className||Ut("btn-dropdown",s)||"")}),m,k.createElement("details",{open:b,className:Q.dynamic([["1706659335",[f.palette.border,f.layout.radius,h.height(2.5),r?"min-content":h.width(10.5),h.pt(0),G,h.pb(0),U,h.font(.875),f.layout.radius,f.layout.radius,f.layout.radius,f.layout.radius,h.height(2.5),_.color,P,h.height(2.5),_.borderLeftColor,a||l?"not-allowed":"pointer",_.hoverBorder,_.hoverBgColor,f.layout.radius,f.expressiveness.shadowLarge,f.layout.gapHalf,f.palette.background,f.layout.radius,f.layout.radius,f.layout.radius,f.layout.radius]]])},k.createElement("summary",{onClick:M,className:Q.dynamic([["1706659335",[f.palette.border,f.layout.radius,h.height(2.5),r?"min-content":h.width(10.5),h.pt(0),G,h.pb(0),U,h.font(.875),f.layout.radius,f.layout.radius,f.layout.radius,f.layout.radius,h.height(2.5),_.color,P,h.height(2.5),_.borderLeftColor,a||l?"not-allowed":"pointer",_.hoverBorder,_.hoverBgColor,f.layout.radius,f.expressiveness.shadowLarge,f.layout.gapHalf,f.palette.background,f.layout.radius,f.layout.radius,f.layout.radius,f.layout.radius]]])},k.createElement("div",{className:Q.dynamic([["1706659335",[f.palette.border,f.layout.radius,h.height(2.5),r?"min-content":h.width(10.5),h.pt(0),G,h.pb(0),U,h.font(.875),f.layout.radius,f.layout.radius,f.layout.radius,f.layout.radius,h.height(2.5),_.color,P,h.height(2.5),_.borderLeftColor,a||l?"not-allowed":"pointer",_.hoverBorder,_.hoverBgColor,f.layout.radius,f.expressiveness.shadowLarge,f.layout.gapHalf,f.palette.background,f.layout.radius,f.layout.radius,f.layout.radius,f.layout.radius]]])+" dropdown-box"},o?k.createElement("span",{style:{color:_.color,height:h.height(2.5),width:h.height(2.5)},className:Q.dynamic([["1706659335",[f.palette.border,f.layout.radius,h.height(2.5),r?"min-content":h.width(10.5),h.pt(0),G,h.pb(0),U,h.font(.875),f.layout.radius,f.layout.radius,f.layout.radius,f.layout.radius,h.height(2.5),_.color,P,h.height(2.5),_.borderLeftColor,a||l?"not-allowed":"pointer",_.hoverBorder,_.hoverBgColor,f.layout.radius,f.expressiveness.shadowLarge,f.layout.gapHalf,f.palette.background,f.layout.radius,f.layout.radius,f.layout.radius,f.layout.radius]]])+" dropdown-icon"},o):k.createElement(iA,{color:_.color,height:h.height(2.5)}))),k.createElement("div",{className:Q.dynamic([["1706659335",[f.palette.border,f.layout.radius,h.height(2.5),r?"min-content":h.width(10.5),h.pt(0),G,h.pb(0),U,h.font(.875),f.layout.radius,f.layout.radius,f.layout.radius,f.layout.radius,h.height(2.5),_.color,P,h.height(2.5),_.borderLeftColor,a||l?"not-allowed":"pointer",_.hoverBorder,_.hoverBgColor,f.layout.radius,f.expressiveness.shadowLarge,f.layout.gapHalf,f.palette.background,f.layout.radius,f.layout.radius,f.layout.radius,f.layout.radius]]])+" content"},g)),k.createElement(Q,{id:"1706659335",dynamic:[f.palette.border,f.layout.radius,h.height(2.5),r?"min-content":h.width(10.5),h.pt(0),G,h.pb(0),U,h.font(.875),f.layout.radius,f.layout.radius,f.layout.radius,f.layout.radius,h.height(2.5),_.color,P,h.height(2.5),_.borderLeftColor,a||l?"not-allowed":"pointer",_.hoverBorder,_.hoverBgColor,f.layout.radius,f.expressiveness.shadowLarge,f.layout.gapHalf,f.palette.background,f.layout.radius,f.layout.radius,f.layout.radius,f.layout.radius]},".btn-dropdown.__jsx-style-dynamic-selector{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;position:relative;box-sizing:border-box;border:1px solid ".concat(f.palette.border,";border-radius:").concat(f.layout.radius,";--geist-ui-dropdown-height:").concat(h.height(2.5),";--geist-ui-dropdown-min-width:").concat(r?"min-content":h.width(10.5),";--geist-ui-dropdown-padding:").concat(h.pt(0)," ").concat(G," ").concat(h.pb(0)," ").concat(U,";--geist-ui-dropdown-font-size:").concat(h.font(.875),";}.btn-dropdown.__jsx-style-dynamic-selector>button{border-top-left-radius:").concat(f.layout.radius,";border-bottom-left-radius:").concat(f.layout.radius,";}details.__jsx-style-dynamic-selector{border-top-right-radius:").concat(f.layout.radius,";border-bottom-right-radius:").concat(f.layout.radius,";overflow:hidden;}.dropdown-box.__jsx-style-dynamic-selector{height:").concat(h.height(2.5),";display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:auto;}summary.__jsx-style-dynamic-selector{box-sizing:border-box;-webkit-tap-highlight-color:transparent;list-style:none;outline:none;color:").concat(_.color,";background-color:").concat(P,";height:").concat(h.height(2.5),";border-left:1px solid ").concat(_.borderLeftColor,";cursor:").concat(a||l?"not-allowed":"pointer",";display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:auto;padding:0 1px;-webkit-transition:background 0.2s ease 0s,border-color 0.2s ease 0s;transition:background 0.2s ease 0s,border-color 0.2s ease 0s;}summary.__jsx-style-dynamic-selector:hover{border-color:").concat(_.hoverBorder,";background-color:").concat(_.hoverBgColor,";}.content.__jsx-style-dynamic-selector{position:absolute;right:0;left:0;z-index:90;width:100%;border-radius:").concat(f.layout.radius,";box-shadow:").concat(f.expressiveness.shadowLarge,";-webkit-transform:translateY(").concat(f.layout.gapHalf,");-ms-transform:translateY(").concat(f.layout.gapHalf,");transform:translateY(").concat(f.layout.gapHalf,");background-color:").concat(f.palette.background,";}.content.__jsx-style-dynamic-selector>button:first-of-type{border-top-left-radius:").concat(f.layout.radius,";border-top-right-radius:").concat(f.layout.radius,";}.content.__jsx-style-dynamic-selector>button:last-of-type{border-bottom-left-radius:").concat(f.layout.radius,";border-bottom-right-radius:").concat(f.layout.radius,";}.dropdown-icon.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transform:scale(0.6);-ms-transform:scale(0.6);transform:scale(0.6);}"))))};xv.displayName="GeistButtonDropdown";xv.defaultProps=cU;var Uc=oi(xv);Uc.Item=pf;var uU=function(e,t,i){var r={default:{color:t.foreground,bgColor:t.background},dark:{color:t.background,bgColor:t.foreground},secondary:{color:t.background,bgColor:t.secondary},success:{color:t.background,bgColor:t.success},warning:{color:t.background,bgColor:t.warning},error:{color:t.background,bgColor:t.error},lite:{color:t.foreground,bgColor:t.background},alert:{color:"white",bgColor:t.alert},purple:{color:"white",bgColor:t.purple},violet:{color:"white",bgColor:t.violet},cyan:{color:"black",bgColor:t.cyan}},s=e==="default"&&!i;return Ge({},r[e],{borderColor:s?t.border:"transparent"})},hU=["children","className","disableAutoMargin"],dU={disableAutoMargin:!1,className:""},Mv=function(e){var t=e.children,i=e.className,r=e.disableAutoMargin,s=pt(e,hU),a=Lt(),l=$t(),o=l.SCALES,c=Ut({"auto-margin":!r},i);return k.createElement("footer",Ge({},s,{className:Q.dynamic([["1602358380",[o.py(.66),o.px(1.31),o.font(.875),a.palette.border,a.layout.radius,a.layout.radius,o.height(3.3),o.width(1,"auto"),o.height(1,"auto"),o.mt(0),o.mr(0),o.mb(0),o.ml(0),a.layout.gapQuarter]]])+" "+(s&&s.className!=null&&s.className||c||"")}),t,k.createElement(Q,{id:"1602358380",dynamic:[o.py(.66),o.px(1.31),o.font(.875),a.palette.border,a.layout.radius,a.layout.radius,o.height(3.3),o.width(1,"auto"),o.height(1,"auto"),o.mt(0),o.mr(0),o.mb(0),o.ml(0),a.layout.gapQuarter]},"footer.__jsx-style-dynamic-selector{padding:".concat(o.py(.66)," ").concat(o.px(1.31),";display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow:hidden;color:inherit;background-color:inherit;font-size:").concat(o.font(.875),";border-top:1px solid ").concat(a.palette.border,";border-bottom-left-radius:").concat(a.layout.radius,";border-bottom-right-radius:").concat(a.layout.radius,";min-height:").concat(o.height(3.3),";width:").concat(o.width(1,"auto"),";height:").concat(o.height(1,"auto"),";margin:").concat(o.mt(0)," ").concat(o.mr(0)," ").concat(o.mb(0)," ").concat(o.ml(0),";}.auto-margin.__jsx-style-dynamic-selector *{margin-top:0;margin-bottom:0;margin-right:").concat(a.layout.gapQuarter,";}")))};Mv.defaultProps=dU;Mv.displayName="GeistCardFooter";var Iv=oi(Mv),fU=["className","children"],_U={className:""},Pv=function(e){var t=e.className,i=e.children,r=pt(e,fU),s=$t(),a=s.SCALES;return k.createElement("div",Ge({},r,{className:Q.dynamic([["490544004",[a.width(1,"100%"),a.height(1,"auto"),a.pt(1),a.pr(1),a.pb(1),a.pl(1),a.mt(0),a.mr(0),a.mb(0),a.ml(0)]]])+" "+(r&&r.className!=null&&r.className||Ut("content",t)||"")}),i,k.createElement(Q,{id:"490544004",dynamic:[a.width(1,"100%"),a.height(1,"auto"),a.pt(1),a.pr(1),a.pb(1),a.pl(1),a.mt(0),a.mr(0),a.mb(0),a.ml(0)]},".content.__jsx-style-dynamic-selector{width:".concat(a.width(1,"100%"),";height:").concat(a.height(1,"auto"),";padding:").concat(a.pt(1)," ").concat(a.pr(1)," ").concat(a.pb(1)," ").concat(a.pl(1),";margin:").concat(a.mt(0)," ").concat(a.mr(0)," ").concat(a.mb(0)," ").concat(a.ml(0),";}.content.__jsx-style-dynamic-selector>p:first-child{margin-top:0;}.content.__jsx-style-dynamic-selector>p:last-child{margin-bottom:0;}")))};Pv.defaultProps=_U;Pv.displayName="GeistCardContent";var Od=oi(Pv),pU=["opacity"],gU={opacity:.5},wv=k.memo(function(n){var e=n.opacity,t=pt(n,pU),i=Lt();return k.createElement("div",Ge({},t,{className:Q.dynamic([["2946022605",[i.palette.accents_1,i.palette.accents_2,i.palette.accents_2,i.palette.accents_1,e]]])+" "+(t&&t.className!=null&&t.className||"skeleton")}),k.createElement(Q,{id:"2946022605",dynamic:[i.palette.accents_1,i.palette.accents_2,i.palette.accents_2,i.palette.accents_1,e]},".skeleton.__jsx-style-dynamic-selector{position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%;background-image:linear-gradient( 270deg, ".concat(i.palette.accents_1,", ").concat(i.palette.accents_2,", ").concat(i.palette.accents_2,", ").concat(i.palette.accents_1," );background-size:400% 100%;-webkit-animation:loading-__jsx-style-dynamic-selector 3s ease-in-out infinite;animation:loading-__jsx-style-dynamic-selector 3s ease-in-out infinite;opacity:").concat(e,";-webkit-transition:opacity 300ms ease-out;transition:opacity 300ms ease-out;}@-webkit-keyframes loading-__jsx-style-dynamic-selector{0%{background-position:200% 0;}to{background-position:-200% 0;}}@keyframes loading-__jsx-style-dynamic-selector{0%{background-position:200% 0;}to{background-position:-200% 0;}}")))});wv.defaultProps=gU;wv.displayName="GeistImageSkeleton";var mU=function(e){var t="".concat(e).slice(0,4);return encodeURIComponent(t)==="%3Csvg"?"data:image/svg+xml;utf8,".concat(e):e},vU=function(e){try{return new URL(e).host}catch{return e}},EU=["src","disableSkeleton","className","maxDelay"],yU={disableSkeleton:!1,className:"",maxDelay:3e3},Ov=function(e){var t=e.src,i=e.disableSkeleton,r=e.className,s=e.maxDelay,a=pt(e,EU),l=$t(),o=l.SCALES,c=l.getScaleProps,u=c(["width","w"]),h=c(["height","h"]),d=!i&&u&&h,f=Lt(),_=S.useState(!0),p=yt(_,2),v=p[0],E=p[1],g=S.useState(!0),m=yt(g,2),y=m[0],T=m[1],b=S.useRef(null),C=S.useMemo(function(){return mU(t)},[t]),M=function(){d&&E(!1)};return S.useEffect(function(){d&&b.current&&b.current.complete&&(E(!1),T(!1))}),S.useEffect(function(){var F=setTimeout(function(){d&&T(!1),clearTimeout(F)},s);return function(){return clearTimeout(F)}},[v]),k.createElement("div",{className:Q.dynamic([["4175752462",[f.layout.radius,o.width(1,"auto"),o.height(1,"auto"),o.mt(0),o.mr(0,"auto"),o.mb(0),o.ml(0,"auto"),o.pt(0),o.pr(0),o.pb(0),o.pl(0),o.width(1,"auto"),o.height(1,"auto")]]])+" "+(Ut("image",r)||"")},y&&d&&k.createElement(wv,{opacity:v?.5:0}),k.createElement("img",Ge({ref:b,onLoad:M,src:C},a,{className:Q.dynamic([["4175752462",[f.layout.radius,o.width(1,"auto"),o.height(1,"auto"),o.mt(0),o.mr(0,"auto"),o.mb(0),o.ml(0,"auto"),o.pt(0),o.pr(0),o.pb(0),o.pl(0),o.width(1,"auto"),o.height(1,"auto")]]])+" "+(a&&a.className!=null&&a.className||"")})),k.createElement(Q,{id:"4175752462",dynamic:[f.layout.radius,o.width(1,"auto"),o.height(1,"auto"),o.mt(0),o.mr(0,"auto"),o.mb(0),o.ml(0,"auto"),o.pt(0),o.pr(0),o.pb(0),o.pl(0),o.width(1,"auto"),o.height(1,"auto")]},".image.__jsx-style-dynamic-selector{position:relative;border-radius:".concat(f.layout.radius,";overflow:hidden;max-width:100%;width:").concat(o.width(1,"auto"),";height:").concat(o.height(1,"auto"),";margin:").concat(o.mt(0)," ").concat(o.mr(0,"auto")," ").concat(o.mb(0)," ").concat(o.ml(0,"auto"),";padding:").concat(o.pt(0)," ").concat(o.pr(0)," ").concat(o.pb(0)," ").concat(o.pl(0),";}img.__jsx-style-dynamic-selector{width:").concat(o.width(1,"auto"),";height:").concat(o.height(1,"auto"),";object-fit:scale-down;display:inline-block;}")))};Ov.defaultProps=yU;Ov.displayName="GeistImage";var nA=oi(Ov),TU=function(){return k.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"jsx-4165143638"},k.createElement("path",{d:"M5 10.2H19V21H5V10.2Z",className:"jsx-4165143638"}),k.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 12C13.933 12 15.5 10.3882 15.5 8.4C15.5 6.41177 13.933 4.8 12 4.8C10.067 4.8 8.5 6.41177 8.5 8.4C8.5 10.3882 10.067 12 12 12ZM12 13.8C14.8995 13.8 17.25 11.3823 17.25 8.4C17.25 5.41766 14.8995 3 12 3C9.10051 3 6.75 5.41766 6.75 8.4C6.75 11.3823 9.10051 13.8 12 13.8Z",className:"jsx-4165143638"}),k.createElement(Q,{id:"4165143638"},"svg.jsx-4165143638{width:1em;height:1em;}"))},bU=k.memo(TU),CU=function(e,t){return e?{color:t.background,barBgColor:t.foreground,inputBgColor:t.accents_8,borderColor:t.accents_7,titleColor:t.accents_2}:{color:t.foreground,barBgColor:t.background,inputBgColor:t.accents_1,borderColor:t.border,titleColor:t.accents_5}},AU=["url","title","children","showFullLink","invert","anchorProps","className"],SU={className:"",showFullLink:!1,anchorProps:{},invert:!1},RU=function(e,t){return k.createElement("div",{className:Q.dynamic([["524099755",[t.titleColor]]])+" title"},e,k.createElement(Q,{id:"524099755",dynamic:[t.titleColor]},".title.__jsx-style-dynamic-selector{color:".concat(t.titleColor,";font-size:0.75em;}")))},xU=function(e,t,i,r){return k.createElement("div",{className:Q.dynamic([["3718009574",[i.inputBgColor]]])+" address-input"},k.createElement("span",{className:Q.dynamic([["3718009574",[i.inputBgColor]]])+" https"},k.createElement(bU,null)),k.createElement(WB,Ge({href:e,title:e,target:"_blank"},r),t?e:vU(e)),k.createElement(Q,{id:"3718009574",dynamic:[i.inputBgColor]},".address-input.__jsx-style-dynamic-selector{height:1.75em;max-width:60%;min-width:40%;background-color:".concat(i.inputBgColor,";color:inherit;border-radius:3px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:0 10px;overflow:hidden;position:relative;}.address-input.__jsx-style-dynamic-selector *{font-size:0.75em;color:inherit;}.address-input.__jsx-style-dynamic-selector a{max-width:90%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:inline-block;color:inherit;}.https.__jsx-style-dynamic-selector{width:0.75em;height:0.75em;font-size:1em;margin-right:0.31em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin-top:-1px;color:inherit;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}")))},Dv=k.forwardRef(function(n,e){var t=n.url,i=n.title,r=n.children,s=n.showFullLink,a=n.invert,l=n.anchorProps,o=n.className,c=pt(n,AU),u=Lt(),h=$t(),d=h.SCALES,f=S.useMemo(function(){return CU(a,u.palette)},[a,u.palette]),_=S.useMemo(function(){return t?xU(t,s,f,l):i?RU(i,f):null},[t,s,i,f,l]);return k.createElement("div",Ge({ref:e},c,{className:Q.dynamic([["1856409351",[u.expressiveness.shadowLarge,u.layout.radius,d.font(1),d.width(1,"max-content"),d.height(1,"auto"),d.mt(0),d.mr(0,"auto"),d.mb(0),d.ml(0,"auto"),d.pt(0),d.pr(0),d.pb(0),d.pl(0),f.color,f.barBgColor,f.borderColor,u.layout.gapHalf]]])+" "+(c&&c.className!=null&&c.className||Ut("browser",o)||"")}),k.createElement("header",{className:Q.dynamic([["1856409351",[u.expressiveness.shadowLarge,u.layout.radius,d.font(1),d.width(1,"max-content"),d.height(1,"auto"),d.mt(0),d.mr(0,"auto"),d.mb(0),d.ml(0,"auto"),d.pt(0),d.pr(0),d.pb(0),d.pl(0),f.color,f.barBgColor,f.borderColor,u.layout.gapHalf]]])},k.createElement("div",{className:Q.dynamic([["1856409351",[u.expressiveness.shadowLarge,u.layout.radius,d.font(1),d.width(1,"max-content"),d.height(1,"auto"),d.mt(0),d.mr(0,"auto"),d.mb(0),d.ml(0,"auto"),d.pt(0),d.pr(0),d.pb(0),d.pl(0),f.color,f.barBgColor,f.borderColor,u.layout.gapHalf]]])+" traffic"},k.createElement("span",{className:Q.dynamic([["1856409351",[u.expressiveness.shadowLarge,u.layout.radius,d.font(1),d.width(1,"max-content"),d.height(1,"auto"),d.mt(0),d.mr(0,"auto"),d.mb(0),d.ml(0,"auto"),d.pt(0),d.pr(0),d.pb(0),d.pl(0),f.color,f.barBgColor,f.borderColor,u.layout.gapHalf]]])+" close"}),k.createElement("span",{className:Q.dynamic([["1856409351",[u.expressiveness.shadowLarge,u.layout.radius,d.font(1),d.width(1,"max-content"),d.height(1,"auto"),d.mt(0),d.mr(0,"auto"),d.mb(0),d.ml(0,"auto"),d.pt(0),d.pr(0),d.pb(0),d.pl(0),f.color,f.barBgColor,f.borderColor,u.layout.gapHalf]]])+" mini"}),k.createElement("span",{className:Q.dynamic([["1856409351",[u.expressiveness.shadowLarge,u.layout.radius,d.font(1),d.width(1,"max-content"),d.height(1,"auto"),d.mt(0),d.mr(0,"auto"),d.mb(0),d.ml(0,"auto"),d.pt(0),d.pr(0),d.pb(0),d.pl(0),f.color,f.barBgColor,f.borderColor,u.layout.gapHalf]]])+" full"})),_),r,k.createElement(Q,{id:"1856409351",dynamic:[u.expressiveness.shadowLarge,u.layout.radius,d.font(1),d.width(1,"max-content"),d.height(1,"auto"),d.mt(0),d.mr(0,"auto"),d.mb(0),d.ml(0,"auto"),d.pt(0),d.pr(0),d.pb(0),d.pl(0),f.color,f.barBgColor,f.borderColor,u.layout.gapHalf]},".browser.__jsx-style-dynamic-selector{background-color:transparent;box-shadow:".concat(u.expressiveness.shadowLarge,";max-width:100%;border-radius:").concat(u.layout.radius,";overflow:hidden;font-size:").concat(d.font(1),";width:").concat(d.width(1,"max-content"),";height:").concat(d.height(1,"auto"),";margin:").concat(d.mt(0)," ").concat(d.mr(0,"auto")," ").concat(d.mb(0)," ").concat(d.ml(0,"auto"),";padding:").concat(d.pt(0)," ").concat(d.pr(0)," ").concat(d.pb(0)," ").concat(d.pl(0),";}.browser.__jsx-style-dynamic-selector .image{border-top-left-radius:0;border-top-right-radius:0;}header.__jsx-style-dynamic-selector{height:2.5em;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:relative;color:").concat(f.color,";background-color:").concat(f.barBgColor,";border-bottom:1px solid ").concat(f.borderColor,";}.traffic.__jsx-style-dynamic-selector{width:auto;position:absolute;left:").concat(u.layout.gapHalf,";top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);bottom:0;height:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-size:inherit;}.traffic.__jsx-style-dynamic-selector span.__jsx-style-dynamic-selector{border-radius:50%;width:0.75em;height:0.75em;max-width:20px;max-height:20px;display:inline-block;margin-right:0.5em;}.close.__jsx-style-dynamic-selector{background-color:#ff5f56;}.mini.__jsx-style-dynamic-selector{background-color:#ffbd2e;}.full.__jsx-style-dynamic-selector{background-color:#27c93f;}")))});Dv.defaultProps=SU;Dv.displayName="GeistImageBrowser";var MU=oi(Dv);nA.Browser=MU;var IU=["children","hoverable","className","shadow","type"],PU={type:"default",hoverable:!1,shadow:!1,className:""},Lv=function(e){var t=e.children,i=e.hoverable,r=e.className,s=e.shadow,a=e.type,l=pt(e,IU),o=Lt(),c=$t(),u=c.SCALES,h=S.useMemo(function(){return s?o.expressiveness.shadowMedium:i?o.expressiveness.shadowSmall:"none"},[i,s,o.expressiveness]),d=S.useMemo(function(){return uU(a,o.palette,s)},[a,o.palette,s]),f=d.color,_=d.bgColor,p=d.borderColor,v=sd(t,Iv),E=yt(v,2),g=E[0],m=E[1],y=sd(g,nA),T=yt(y,2),b=T[0],C=T[1],M=j1(b,Od);return k.createElement("div",Ge({},l,{className:Q.dynamic([["4234389955",[o.palette.background,o.layout.radius,s?o.expressiveness.shadowSmall:"none",f,_,p,u.width(1,"auto"),u.height(1,"auto"),u.pt(0),u.pr(0),u.pb(0),u.pl(0),u.mt(0),u.mr(0),u.mb(0),u.ml(0),h]]])+" "+(l&&l.className!=null&&l.className||Ut("card",r)||"")}),C,M?b:k.createElement(Od,null,b),m,k.createElement(Q,{id:"4234389955",dynamic:[o.palette.background,o.layout.radius,s?o.expressiveness.shadowSmall:"none",f,_,p,u.width(1,"auto"),u.height(1,"auto"),u.pt(0),u.pr(0),u.pb(0),u.pl(0),u.mt(0),u.mr(0),u.mb(0),u.ml(0),h]},".card.__jsx-style-dynamic-selector{background:".concat(o.palette.background,";-webkit-transition:all 0.2s ease;transition:all 0.2s ease;border-radius:").concat(o.layout.radius,";box-shadow:").concat(s?o.expressiveness.shadowSmall:"none",";box-sizing:border-box;color:").concat(f,";background-color:").concat(_,";border:1px solid ").concat(p,";width:").concat(u.width(1,"auto"),";height:").concat(u.height(1,"auto"),";padding:").concat(u.pt(0)," ").concat(u.pr(0)," ").concat(u.pb(0)," ").concat(u.pl(0),";margin:").concat(u.mt(0)," ").concat(u.mr(0)," ").concat(u.mb(0)," ").concat(u.ml(0),";}.card.__jsx-style-dynamic-selector:hover{box-shadow:").concat(h,";}.card.__jsx-style-dynamic-selector img{width:100%;}.card.__jsx-style-dynamic-selector .image{border-bottom-left-radius:0;border-bottom-right-radius:0;}")))};Lv.defaultProps=PU;Lv.displayName="GeistCard";var Ds=oi(Lv);Ds.Footer=Iv;Ds.Actions=Iv;Ds.Content=Od;Ds.Body=Od;function wU(n){if(Array.isArray(n))return Dp(n)}function OU(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function DU(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nv(n){return wU(n)||OU(n)||N1(n)||DU()}var LU=function(e){var t={width:0,height:0};if(!e||typeof window>"u")return t;var i=e.getBoundingClientRect(),r=window.getComputedStyle(e),s=r.width,a=r.height,l=function(c,u){if(!c)return 0;var h=c.includes("px")?+c.split("px")[0]:c.includes("%")?+c.split("%")[0]*u*.01:c;return Number.isNaN(+h)?0:+h};return{width:l("".concat(s),i.width),height:l("".concat(a),i.height)}},sA=function(e){var t=S.useState({width:0,height:0}),i=yt(t,2),r=i[0],s=i[1],a=function(){var o=LU(e.current),c=o.width,u=o.height;s({width:c,height:u})};return S.useEffect(function(){return a()},[e.current]),[r,a]},NU={isExpanded:!1,delay:200},Fv=function(e){var t=e.isExpanded,i=e.delay,r=e.children,s=S.useState(t?"auto":"0"),a=yt(s,2),l=a[0],o=a[1],c=S.useState(t),u=yt(c,2),h=u[0],d=u[1],f=S.useState(t),_=yt(f,2),p=_[0],v=_[1],E=S.useRef(null),g=S.useRef(),m=S.useRef(),y=S.useRef(),T=sA(E),b=yt(T,2),C=b[0],M=b[1],F=Ut("container",{expanded:h});return S.useEffect(function(){return o("".concat(C.height,"px"))},[C.height]),S.useEffect(function(){return t?v(t):(M(),o("".concat(C.height,"px"))),g.current=window.setTimeout(function(){d(t),clearTimeout(g.current)},30),t?y.current=window.setTimeout(function(){o("auto"),clearTimeout(y.current)},i):m.current=window.setTimeout(function(){v(t),clearTimeout(m.current)},i/2),function(){clearTimeout(g.current),clearTimeout(m.current),clearTimeout(y.current)}},[t]),k.createElement("div",{className:Q.dynamic([["1918690829",[p?"visible":"hidden",i,l]]])+" "+(F||"")},k.createElement("div",{ref:E,className:Q.dynamic([["1918690829",[p?"visible":"hidden",i,l]]])+" content"},r),k.createElement(Q,{id:"1918690829",dynamic:[p?"visible":"hidden",i,l]},".container.__jsx-style-dynamic-selector{padding:0;margin:0;height:0;overflow:hidden;visibility:".concat(p?"visible":"hidden",";-webkit-transition:height ").concat(i,"ms ease;transition:height ").concat(i,"ms ease;}.expanded.__jsx-style-dynamic-selector{height:").concat(l,";visibility:visible;}")))};Fv.defaultProps=NU;Fv.displayName="GeistExpand";var FU=["type","align","children","className"],kU={align:"center",type:"default",className:""},BU=function(e,t){var i={default:t.border,lite:t.accents_1,success:t.successLight,warning:t.warningLight,error:t.errorLight,secondary:t.secondary,dark:t.foreground};return i[e]},kv=function(e){var t=e.type,i=e.align,r=e.children,s=e.className,a=pt(e,FU),l=Lt(),o=$t(),c=o.SCALES,u=Ut("divider",s),h=S.useMemo(function(){return BU(t,l.palette)},[t,l.palette]),d=S.useMemo(function(){return!i||i==="center"?"":i==="left"||i==="start"?"start":"end"},[i]),f=Ut("text",d),_=t==="default"?l.palette.foreground:h;return k.createElement("div",Ge({role:"separator"},a,{className:Q.dynamic([["3410666717",[h,c.font(1),c.width(1,"auto"),c.height(.0625),c.pt(0),c.pr(0),c.pb(0),c.pl(0),c.mt(.5),c.mr(0),c.mb(.5),c.ml(0),l.palette.background,_]]])+" "+(a&&a.className!=null&&a.className||u||"")}),r&&k.createElement("span",{className:Q.dynamic([["3410666717",[h,c.font(1),c.width(1,"auto"),c.height(.0625),c.pt(0),c.pr(0),c.pb(0),c.pl(0),c.mt(.5),c.mr(0),c.mb(.5),c.ml(0),l.palette.background,_]]])+" "+(f||"")},r),k.createElement(Q,{id:"3410666717",dynamic:[h,c.font(1),c.width(1,"auto"),c.height(.0625),c.pt(0),c.pr(0),c.pb(0),c.pl(0),c.mt(.5),c.mr(0),c.mb(.5),c.ml(0),l.palette.background,_]},".divider.__jsx-style-dynamic-selector{max-width:100%;background-color:".concat(h,";position:relative;font-size:").concat(c.font(1),";width:").concat(c.width(1,"auto"),";height:").concat(c.height(.0625),";padding:").concat(c.pt(0)," ").concat(c.pr(0)," ").concat(c.pb(0)," ").concat(c.pl(0),";margin:").concat(c.mt(.5)," ").concat(c.mr(0)," ").concat(c.mb(.5)," ").concat(c.ml(0),";}.text.__jsx-style-dynamic-selector{position:absolute;left:50%;top:50%;min-height:100%;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);padding:0 0.75em;font-size:inherit;font-weight:bold;text-transform:capitalize;background-color:").concat(l.palette.background,";color:").concat(_,";z-index:10;}.text.start.__jsx-style-dynamic-selector{-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);left:7%;}.text.end.__jsx-style-dynamic-selector{-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);left:auto;right:7%;}")))};kv.defaultProps=kU;kv.displayName="GeistDivider";var UU=oi(kv),zU={scrollLayer:!1,delayReset:0},Ac=new Map,VU=function(e){var t=(e==null?void 0:e.ownerDocument)||document,i=t.defaultView||window;return Number.parseInt(i.getComputedStyle(e).paddingRight,10)||0},GU=function(e){var t=(e==null?void 0:e.ownerDocument)||document;return Math.abs(window.innerWidth-t.documentElement.clientWidth)},WU=function(e,t){if(typeof document>"u")return[!1,function(c){return c}];var i=S.useRef(document.body),r=S.useState(!1),s=yt(r,2),a=s[0],l=s[1],o=Ge({},zU,t||{});return S.useEffect(function(){if(!(!i||!i.current)){var c=i.current.style.overflow;if(a){if(Ac.has(i.current))return;var u=VU(i.current),h=GU(i.current);Ac.set(i.current,{overflow:c,paddingRight:i.current.style.paddingRight}),i.current.style.overflow="hidden",i.current.style.paddingRight="".concat(u+h,"px");return}if(Ac.has(i.current))var d=function(p){var v=Ac.get(p);v&&(p.style.overflow=v.overflow,p.style.paddingRight=v.paddingRight,Ac.delete(p))},f=window.setTimeout(function(){d(i.current),window.clearTimeout(f)},o.delayReset)}},[a,i]),[a,l]},Rg;(function(n){n[n.Unknown=0]="Unknown",n[n.Backspace=8]="Backspace",n[n.Tab=9]="Tab",n[n.Enter=13]="Enter",n[n.Shift=16]="Shift",n[n.Ctrl=17]="Ctrl",n[n.Alt=18]="Alt",n[n.PauseBreak=19]="PauseBreak",n[n.CapsLock=20]="CapsLock",n[n.Escape=27]="Escape",n[n.Space=32]="Space",n[n.PageUp=33]="PageUp",n[n.PageDown=34]="PageDown",n[n.End=35]="End",n[n.Home=36]="Home",n[n.LeftArrow=37]="LeftArrow",n[n.UpArrow=38]="UpArrow",n[n.RightArrow=39]="RightArrow",n[n.DownArrow=40]="DownArrow",n[n.Insert=45]="Insert",n[n.Delete=46]="Delete",n[n.KEY_0=48]="KEY_0",n[n.KEY_1=49]="KEY_1",n[n.KEY_2=50]="KEY_2",n[n.KEY_3=51]="KEY_3",n[n.KEY_4=52]="KEY_4",n[n.KEY_5=53]="KEY_5",n[n.KEY_6=54]="KEY_6",n[n.KEY_7=55]="KEY_7",n[n.KEY_8=56]="KEY_8",n[n.KEY_9=57]="KEY_9",n[n.KEY_A=65]="KEY_A",n[n.KEY_B=66]="KEY_B",n[n.KEY_C=67]="KEY_C",n[n.KEY_D=68]="KEY_D",n[n.KEY_E=69]="KEY_E",n[n.KEY_F=70]="KEY_F",n[n.KEY_G=71]="KEY_G",n[n.KEY_H=72]="KEY_H",n[n.KEY_I=73]="KEY_I",n[n.KEY_J=74]="KEY_J",n[n.KEY_K=75]="KEY_K",n[n.KEY_L=76]="KEY_L",n[n.KEY_M=77]="KEY_M",n[n.KEY_N=78]="KEY_N",n[n.KEY_O=79]="KEY_O",n[n.KEY_P=80]="KEY_P",n[n.KEY_Q=81]="KEY_Q",n[n.KEY_R=82]="KEY_R",n[n.KEY_S=83]="KEY_S",n[n.KEY_T=84]="KEY_T",n[n.KEY_U=85]="KEY_U",n[n.KEY_V=86]="KEY_V",n[n.KEY_W=87]="KEY_W",n[n.KEY_X=88]="KEY_X",n[n.KEY_Y=89]="KEY_Y",n[n.KEY_Z=90]="KEY_Z",n[n.Meta=91]="Meta",n[n.F1=112]="F1",n[n.F2=113]="F2",n[n.F3=114]="F3",n[n.F4=115]="F4",n[n.F5=116]="F5",n[n.F6=117]="F6",n[n.F7=118]="F7",n[n.F8=119]="F8",n[n.F9=120]="F9",n[n.F10=121]="F10",n[n.F11=122]="F11",n[n.F12=123]="F12",n[n.NumLock=144]="NumLock",n[n.ScrollLock=145]="ScrollLock",n[n.Equal=187]="Equal",n[n.Minus=189]="Minus",n[n.Backquote=192]="Backquote",n[n.Backslash=220]="Backslash"})(Rg||(Rg={}));var Su;(function(n){n[n.CtrlCmd=2048]="CtrlCmd",n[n.Shift=1024]="Shift",n[n.Alt=512]="Alt",n[n.WinCtrl=256]="WinCtrl"})(Su||(Su={}));var HU=function(){return{CtrlCmd:uE()?"metaKey":"ctrlKey",WinCtrl:uE()?"ctrlKey":"metaKey"}},jU=function(e){var t=e.filter(function(r){return!!Su[r]}),i={CtrlCmd:!1,Shift:!1,Alt:!1,WinCtrl:!1};return t.forEach(function(r){var s=Su[r];i[s]=!0}),i},XU=function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=Array.isArray(t)?t:[t],s=i.disableGlobalEvent,a=s===void 0?!1:s,l=i.capture,o=l===void 0?!1:l,c=i.stopPropagation,u=c===void 0?!1:c,h=i.preventDefault,d=h===void 0?!0:h,f=i.event,_=f===void 0?"keydown":f,p=jU(r),v=r.filter(function(b){return!Su[b]}),E=HU(),g=E.CtrlCmd,m=E.WinCtrl,y=function(C){if(!(p.Shift&&!C.shiftKey)&&!(p.Alt&&!C.altKey)&&!(p.CtrlCmd&&!C[g])&&!(p.WinCtrl&&!C[m])){var M=v.find(function(F){return F===C.keyCode});v&&!M||(u&&C.stopPropagation(),d&&C.preventDefault(),e&&e(C))}};S.useEffect(function(){return a||document.addEventListener(_,y),function(){document.removeEventListener(_,y)}},[a]);var T=function(C){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return C!==_?function(){}:M!==o?function(){}:function(F){return y(F)}};return{bindings:{onKeyDown:T("keydown"),onKeyDownCapture:T("keydown",!0),onKeyPress:T("keypress"),onKeyPressCapture:T("keypress",!0),onKeyUp:T("keyup"),onKeyUpCapture:T("keyup",!0)}}},YU=["children","onClick","visible","width","onContentClick","backdropClassName","positionClassName","layerClassName"],KU={onClick:function(){},visible:!1,onContentClick:function(){},backdropClassName:"",positionClassName:"",layerClassName:""},Bv=k.memo(function(n){var e=n.children,t=n.onClick,i=n.visible,r=n.width,s=n.onContentClick,a=n.backdropClassName,l=n.positionClassName,o=n.layerClassName,c=pt(n,YU),u=Lt(),h=Pd(!1),d=yt(h,3),f=d[1],_=d[2],p=function(g){_.current||t&&t(g)},v=function(){if(_.current)var g=setTimeout(function(){f(!1),clearTimeout(g)},0)};return k.createElement(sc,{name:"backdrop-wrapper",visible:i,clearTime:300},k.createElement("div",Ge({onClick:p,onMouseUp:v},c,{className:Q.dynamic([["2021762493",[r,u.expressiveness.portalOpacity,u.expressiveness.portalOpacity,u.expressiveness.portalOpacity]]])+" "+(c&&c.className!=null&&c.className||Ut("backdrop",a)||"")}),k.createElement("div",{className:Q.dynamic([["2021762493",[r,u.expressiveness.portalOpacity,u.expressiveness.portalOpacity,u.expressiveness.portalOpacity]]])+" "+(Ut("layer",o)||"")}),k.createElement("div",{onClick:s,onMouseDown:function(){return f(!0)},className:Q.dynamic([["2021762493",[r,u.expressiveness.portalOpacity,u.expressiveness.portalOpacity,u.expressiveness.portalOpacity]]])+" "+(Ut("position",l)||"")},e),k.createElement(Q,{id:"2021762493",dynamic:[r,u.expressiveness.portalOpacity,u.expressiveness.portalOpacity,u.expressiveness.portalOpacity]},".backdrop.__jsx-style-dynamic-selector{position:fixed;top:0;left:0;right:0;bottom:0;overflow:auto;z-index:1000;-webkit-overflow-scrolling:touch;box-sizing:border-box;text-align:center;}.position.__jsx-style-dynamic-selector{position:relative;z-index:1001;outline:none;max-width:90%;width:".concat(r,";margin:20px auto;vertical-align:middle;display:inline-block;}.backdrop.__jsx-style-dynamic-selector:before{display:inline-block;width:0;height:100%;vertical-align:middle;content:'';}.layer.__jsx-style-dynamic-selector{position:fixed;top:0;left:0;right:0;bottom:0;width:100%;height:100%;opacity:").concat(u.expressiveness.portalOpacity,";background-color:black;-webkit-transition:opacity 0.35s cubic-bezier(0.4,0,0.2,1);transition:opacity 0.35s cubic-bezier(0.4,0,0.2,1);pointer-events:none;z-index:1000;}.backdrop-wrapper-enter.__jsx-style-dynamic-selector .layer.__jsx-style-dynamic-selector{opacity:0;}.backdrop-wrapper-enter-active.__jsx-style-dynamic-selector .layer.__jsx-style-dynamic-selector{opacity:").concat(u.expressiveness.portalOpacity,";}.backdrop-wrapper-leave.__jsx-style-dynamic-selector .layer.__jsx-style-dynamic-selector{opacity:").concat(u.expressiveness.portalOpacity,";}.backdrop-wrapper-leave-active.__jsx-style-dynamic-selector .layer.__jsx-style-dynamic-selector{opacity:0;}"))))});Bv.defaultProps=KU;Bv.displayName="GeistBackdrop";var qU=["className","children"],$U={className:""},Uv=function(e){var t=e.className,i=e.children,r=pt(e,qU),s=Lt(),a=$t(),l=a.SCALES;return k.createElement(k.Fragment,null,k.createElement("h2",Ge({},r,{className:Q.dynamic([["2865939188",[l.font(1.5),s.palette.foreground,l.width(1,"auto"),l.height(1,"auto"),l.pt(0),l.pr(0),l.pb(0),l.pl(0),l.mt(0),l.mr(0),l.mb(0),l.ml(0)]]])+" "+(r&&r.className!=null&&r.className||t||"")}),i),k.createElement(Q,{id:"2865939188",dynamic:[l.font(1.5),s.palette.foreground,l.width(1,"auto"),l.height(1,"auto"),l.pt(0),l.pr(0),l.pb(0),l.pl(0),l.mt(0),l.mr(0),l.mb(0),l.ml(0)]},"h2.__jsx-style-dynamic-selector{line-height:1.6;font-weight:normal;text-align:center;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;word-break:break-word;text-transform:capitalize;font-size:".concat(l.font(1.5),";color:").concat(s.palette.foreground,";width:").concat(l.width(1,"auto"),";height:").concat(l.height(1,"auto"),";padding:").concat(l.pt(0)," ").concat(l.pr(0)," ").concat(l.pb(0)," ").concat(l.pl(0),";margin:").concat(l.mt(0)," ").concat(l.mr(0)," ").concat(l.mb(0)," ").concat(l.ml(0),";}")))};Uv.defaultProps=$U;Uv.displayName="GeistModalTitle";var QU=oi(Uv),ZU=["className","children"],JU={className:""},zv=function(e){var t=e.className,i=e.children,r=pt(e,ZU),s=Lt(),a=$t(),l=a.SCALES;return k.createElement(k.Fragment,null,k.createElement("p",Ge({},r,{className:Q.dynamic([["2550488204",[s.palette.accents_5,l.font(.875),l.width(1,"auto"),l.height(1,"1.5em"),l.pt(0),l.pr(0),l.pb(0),l.pl(0),l.mt(0),l.mr(0),l.mb(0),l.ml(0)]]])+" "+(r&&r.className!=null&&r.className||t||"")}),i),k.createElement(Q,{id:"2550488204",dynamic:[s.palette.accents_5,l.font(.875),l.width(1,"auto"),l.height(1,"1.5em"),l.pt(0),l.pr(0),l.pb(0),l.pl(0),l.mt(0),l.mr(0),l.mb(0),l.ml(0)]},"p.__jsx-style-dynamic-selector{font-weight:normal;display:inline-block;text-align:center;word-break:break-word;text-transform:uppercase;color:".concat(s.palette.accents_5,";font-size:").concat(l.font(.875),";line-height:1.5em;width:").concat(l.width(1,"auto"),";height:").concat(l.height(1,"1.5em"),";padding:").concat(l.pt(0)," ").concat(l.pr(0)," ").concat(l.pb(0)," ").concat(l.pl(0),";margin:").concat(l.mt(0)," ").concat(l.mr(0)," ").concat(l.mb(0)," ").concat(l.ml(0),";}")))};zv.defaultProps=JU;zv.displayName="GeistModalSubtitle";var e6=oi(zv),t6=["className","children"],i6={className:""},Vv=function(e){var t=e.className,i=e.children,r=pt(e,t6),s=$t(),a=s.SCALES;return k.createElement(k.Fragment,null,k.createElement("div",Ge({},r,{className:Q.dynamic([["498745028",[a.font(1),a.width(1,"auto"),a.height(1,"auto"),a.pt(1.3125),a.pr(1.3125),a.pb(.6625),a.pl(1.3125),a.mt(0),a.mr(0,"calc(var(--modal-wrapper-padding-right) * -1)"),a.mb(0),a.ml(0,"calc(var(--modal-wrapper-padding-left) * -1)")]]])+" "+(r&&r.className!=null&&r.className||Ut("content",t)||"")}),i),k.createElement(Q,{id:"498745028",dynamic:[a.font(1),a.width(1,"auto"),a.height(1,"auto"),a.pt(1.3125),a.pr(1.3125),a.pb(.6625),a.pl(1.3125),a.mt(0),a.mr(0,"calc(var(--modal-wrapper-padding-right) * -1)"),a.mb(0),a.ml(0,"calc(var(--modal-wrapper-padding-left) * -1)")]},".content.__jsx-style-dynamic-selector{position:relative;text-align:left;font-size:".concat(a.font(1),";width:").concat(a.width(1,"auto"),";height:").concat(a.height(1,"auto"),";padding:").concat(a.pt(1.3125)," ").concat(a.pr(1.3125)," ").concat(a.pb(.6625)," ").concat(a.pl(1.3125),";margin:").concat(a.mt(0)," ").concat(a.mr(0,"calc(var(--modal-wrapper-padding-right) * -1)")," ").concat(a.mb(0)," ").concat(a.ml(0,"calc(var(--modal-wrapper-padding-left) * -1)"),";}.content.__jsx-style-dynamic-selector>*:first-child{margin-top:0;}.content.__jsx-style-dynamic-selector>*:last-child{margin-bottom:0;}")))};Vv.defaultProps=i6;Vv.displayName="GeistModalContent";var r6=oi(Vv),aA={padding:"12px 16px",margin:"8px 0",width:"420px",maxWidth:"90vw",maxHeight:"75px",placement:"bottomRight"},n6={toasts:[],toastLayout:aA,updateToastLayout:function(e){return e},updateToasts:function(e){return e},lastUpdateToastId:null,updateLastToastId:function(){return null}},oA=k.createContext(n6),lA=function(){return k.useContext(oA)},s6={themes:cl.getPresets()},a6=k.createContext(s6),o6=function(e){var t=e.children,i=e.themeType,r=e.themes,s=r===void 0?[]:r,a=S.useState({themes:cl.getPresets()}),l=yt(a,2),o=l[0],c=l[1],u=S.useMemo(function(){var h=o.themes.find(function(d){return d.type===i});return h||cl.getPresetStaticTheme()},[o,i]);return S.useEffect(function(){s!=null&&s.length&&c(function(h){var d=s.filter(function(_){return cl.isAvailableThemeType(_.type)}),f=cl.getPresets().concat(d);return Ge({},h,{themes:f})})},[s]),k.createElement(a6.Provider,{value:o},k.createElement(G1.Provider,{value:u},t))},l6=function(e,t){var i=function(s,a){a&&a(s,t)};return!e||!e.length?null:e.map(function(r,s){return k.createElement(Rv,{auto:!0,scale:1/3,font:"13px",type:r.passive?"default":"secondary",key:"action-".concat(s),onClick:function(l){return i(l,r.handler)}},r.name)})},c6=function(e,t){var i={default:e.background,secondary:e.secondary,success:e.success,warning:e.warning,error:e.error},r=!t||t==="default";return r?{bgColor:i.default,color:e.foreground}:{bgColor:i[t],color:"white"}};Wn("topLeft","topRight","bottomLeft","bottomRight");var u6=function(e){return"".concat(e).toLowerCase().startsWith("top")},h6=function(e){return"".concat(e).toLowerCase().endsWith("left")},d6=function(e){var t={topLeft:"translate(-60px, -60px)",topRight:"translate(60px, -60px)",bottomLeft:"translate(-60px, 60px)",bottomRight:"translate(60px, 60px)"},i={topLeft:"translate(-50px, 15px) scale(0.85)",topRight:"translate(50px, 15px) scale(0.85)",bottomLeft:"translate(-50px, -15px) scale(0.85)",bottomRight:"translate(50px, -15px) scale(0.85)"};return{enter:t[e],leave:i[e]}},f6=k.memo(function(n){var e=n.toast,t=n.layout,i=Lt(),r=S.useMemo(function(){return c6(i.palette,e.type)},[i.palette,e.type]),s=r.color,a=r.bgColor,l=typeof e.text!="string",o=t.padding,c=t.margin,u=t.maxHeight,h=t.maxWidth,d=t.width,f=t.placement,_=S.useMemo(function(){return d6(f)},[f]),p=_.enter,v=_.leave;return k.createElement(sc,{name:"toast",visible:e.visible,clearTime:350},k.createElement("div",{key:e.id,className:Q.dynamic([["1407001838",[d,h,u,i.palette.foreground,a,s,i.layout.radius,i.expressiveness.shadowSmall,i.layout.gapHalf,p,c,o,c,o,v]]])+" toast"},l?e.text:k.createElement(k.Fragment,null,k.createElement("div",{className:Q.dynamic([["1407001838",[d,h,u,i.palette.foreground,a,s,i.layout.radius,i.expressiveness.shadowSmall,i.layout.gapHalf,p,c,o,c,o,v]]])+" message"},e.text),k.createElement("div",{className:Q.dynamic([["1407001838",[d,h,u,i.palette.foreground,a,s,i.layout.radius,i.expressiveness.shadowSmall,i.layout.gapHalf,p,c,o,c,o,v]]])+" action"},l6(e.actions,e.cancel))),k.createElement(Q,{id:"1407001838",dynamic:[d,h,u,i.palette.foreground,a,s,i.layout.radius,i.expressiveness.shadowSmall,i.layout.gapHalf,p,c,o,c,o,v]},".toast.__jsx-style-dynamic-selector{width:".concat(d,";max-width:").concat(h,";max-height:").concat(u,";display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:").concat(i.palette.foreground,";background-color:").concat(a,";color:").concat(s,";border:0;border-radius:").concat(i.layout.radius,";opacity:1;box-shadow:").concat(i.expressiveness.shadowSmall,";-webkit-transition:all 350ms cubic-bezier(0.1,0.2,0.1,1);transition:all 350ms cubic-bezier(0.1,0.2,0.1,1);overflow:hidden;}.message.__jsx-style-dynamic-selector{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:100%;font-size:0.875em;display:-webkit-box;word-break:break-all;padding-right:").concat(i.layout.gapHalf,";overflow:hidden;max-height:100%;text-overflow:ellipsis;-webkit-box-orient:vertical;-webkit-line-clamp:2;line-height:1.1rem;}.toast-enter.__jsx-style-dynamic-selector{opacity:0;height:0;padding:0;margin:0;-webkit-transform:").concat(p,";-ms-transform:").concat(p,";transform:").concat(p,";}.toast-enter-active.__jsx-style-dynamic-selector{opacity:1;height:auto;margin:").concat(c,";padding:").concat(o,";-webkit-transform:translate(0,0);-ms-transform:translate(0,0);transform:translate(0,0);}.toast-leave.__jsx-style-dynamic-selector{opacity:1;-webkit-transform:translate(0,0);-ms-transform:translate(0,0);transform:translate(0,0);height:auto;margin:").concat(c,";padding:").concat(o,";}.toast-leave-active.__jsx-style-dynamic-selector{opacity:0;-webkit-transform:").concat(v,";-ms-transform:").concat(v,";transform:").concat(v,";}"))))}),_6=function(){var e=Lt(),t=yv("toast"),i=Pd(!1),r=yt(i,3),s=r[1],a=r[2],l=lA(),o=l.toasts,c=l.updateToasts,u=l.toastLayout,h=l.lastUpdateToastId,d=S.useMemo(function(){return u},[u]),f=S.useMemo(function(){return o.map(function(v){return k.createElement(f6,{toast:v,layout:d,key:v._internalIdent})})},[o,d]),_=S.useMemo(function(){return Ut("toasts",{top:u6(u.placement),left:h6(u.placement)})},[d]),p=function(E){if(s(E),E)return c(function(g){return g.map(function(m){return m.visible?(m._timeout&&window.clearTimeout(m._timeout),Ge({},m,{timeout:null})):m})});c(function(g){return g.map(function(m,y){return m.visible?(m._timeout&&window.clearTimeout(m._timeout),Ge({},m,{_timeout:function(){var T=window.setTimeout(function(){m.cancel(),window.clearTimeout(T)},m.delay+y*100);return T}()})):m})})};return S.useEffect(function(){var v=o.findIndex(function(m){return m._internalIdent===h}),E=o[v];if(!(!E||E.visible||!a.current)){var g=o.find(function(m,y){return y<v&&m.visible});g||!a.current||p(!1)}},[o,h]),S.useEffect(function(){var v=null,E=window.setInterval(function(){o.length!==0&&(v=window.setTimeout(function(){var g=!o.find(function(m){return m.visible});g&&c(function(){return[]}),v&&clearTimeout(v)},350))},5e3);return function(){E&&clearInterval(E),v&&clearTimeout(v)}},[o]),!t||!o||o.length===0?null:nc.createPortal(k.createElement("div",{onMouseEnter:function(){return p(!0)},onMouseLeave:function(){return p(!1)},className:Q.dynamic([["622610754",[e.layout.gap,e.layout.gap,e.layout.gap,e.layout.gap]]])+" "+(_||"")},f,k.createElement(Q,{id:"622610754",dynamic:[e.layout.gap,e.layout.gap,e.layout.gap,e.layout.gap]},".toasts.__jsx-style-dynamic-selector{position:fixed;width:auto;max-width:100%;right:".concat(e.layout.gap,";bottom:").concat(e.layout.gap,";z-index:2000;-webkit-transition:all 400ms ease;transition:all 400ms ease;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.top.__jsx-style-dynamic-selector{bottom:unset;-webkit-flex-direction:column-reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse;top:").concat(e.layout.gap,";}.left.__jsx-style-dynamic-selector{right:unset;left:").concat(e.layout.gap,";}"))),t)},p6=function(e){var t=e.themes,i=e.themeType,r=e.children,s=S.useState(null),a=yt(s,2),l=a[0],o=a[1],c=Pd([]),u=yt(c,3),h=u[0],d=u[1],f=u[2],_=Pd(aA),p=yt(_,3),v=p[0],E=p[1],g=p[2],m=function(M){var F=M(f.current);d(F)},y=function(M){var F=M(g.current);E(F)},T=function(M){o(M())},b=S.useMemo(function(){return{toasts:h,toastLayout:v,updateToasts:m,lastUpdateToastId:l,updateToastLayout:y,updateLastToastId:T}},[h,v,l]);return k.createElement(oA.Provider,{value:b},k.createElement(o6,{themes:t,themeType:i},r,k.createElement(_6,null)))},g6=["xs","sm","md","lg","xl","justify","direction","alignItems","alignContent","children","className"],m6={xs:!1,sm:!1,md:!1,lg:!1,xl:!1,className:""},Sc=function(e){var t=e===0?"display: none;":"display: inherit;";if(typeof e=="number"){var i=4.166666666666667*e,r=i>100?"100%":i<0?"0":"".concat(i,"%");return{grow:0,display:t,width:r,basis:r}}return{grow:1,display:t,width:"100%",basis:"0"}},gf=function(e){var t=e.xs,i=e.sm,r=e.md,s=e.lg,a=e.xl,l=e.justify,o=e.direction,c=e.alignItems,u=e.alignContent,h=e.children,d=e.className,f=pt(e,g6),_=Lt(),p=$t(),v=p.SCALES,E=S.useMemo(function(){var m={justify:l,direction:o,alignItems:c,alignContent:u,xs:t,sm:i,md:r,lg:s,xl:a},y=Object.keys(m).reduce(function(T,b){return m[b]!==void 0&&m[b]!==!1?"".concat(T," ").concat(b):T},"");return y.trim()},[l,o,c,u,t,i,r,s,a]),g=S.useMemo(function(){return{xs:Sc(t),sm:Sc(i),md:Sc(r),lg:Sc(s),xl:Sc(a)}},[t,i,r,s,a]);return k.createElement("div",Ge({},f,{className:Q.dynamic([["568430467",[v.font(1,"inherit"),v.height(1,"auto"),l,o,u,c,g.xs.grow,g.xs.width,g.xs.basis,g.xs.display,_.breakpoints.sm.min,g.sm.grow,g.sm.width,g.sm.basis,g.sm.display,_.breakpoints.md.min,g.md.grow,g.md.width,g.md.basis,g.md.display,_.breakpoints.lg.min,g.lg.grow,g.lg.width,g.lg.basis,g.lg.display,_.breakpoints.xl.min,g.xl.grow,g.xl.width,g.xl.basis,g.xl.display]]])+" "+(f&&f.className!=null&&f.className||Ut("item",E,d)||"")}),h,k.createElement(Q,{id:"568430467",dynamic:[v.font(1,"inherit"),v.height(1,"auto"),l,o,u,c,g.xs.grow,g.xs.width,g.xs.basis,g.xs.display,_.breakpoints.sm.min,g.sm.grow,g.sm.width,g.sm.basis,g.sm.display,_.breakpoints.md.min,g.md.grow,g.md.width,g.md.basis,g.md.display,_.breakpoints.lg.min,g.lg.grow,g.lg.width,g.lg.basis,g.lg.display,_.breakpoints.xl.min,g.xl.grow,g.xl.width,g.xl.basis,g.xl.display]},".item.__jsx-style-dynamic-selector{font-size:".concat(v.font(1,"inherit"),";height:").concat(v.height(1,"auto"),";}.justify.__jsx-style-dynamic-selector{-webkit-box-pack:").concat(l,";-webkit-justify-content:").concat(l,";-ms-flex-pack:").concat(l,";justify-content:").concat(l,";}.direction.__jsx-style-dynamic-selector{-webkit-flex-direction:").concat(o,";-ms-flex-direction:").concat(o,";flex-direction:").concat(o,";}.alignContent.__jsx-style-dynamic-selector{-webkit-align-content:").concat(u,";-ms-flex-line-pack:").concat(u,";align-content:").concat(u,";}.alignItems.__jsx-style-dynamic-selector{-webkit-align-items:").concat(c,";-webkit-box-align:").concat(c,";-ms-flex-align:").concat(c,";align-items:").concat(c,";}.xs.__jsx-style-dynamic-selector{-webkit-box-flex:").concat(g.xs.grow,";-webkit-flex-grow:").concat(g.xs.grow,";-ms-flex-positive:").concat(g.xs.grow,";flex-grow:").concat(g.xs.grow,";max-width:").concat(g.xs.width,";-webkit-flex-basis:").concat(g.xs.basis,";-ms-flex-preferred-size:").concat(g.xs.basis,";flex-basis:").concat(g.xs.basis,";").concat(g.xs.display,";}@media only screen and (min-width:").concat(_.breakpoints.sm.min,"){.sm.__jsx-style-dynamic-selector{-webkit-box-flex:").concat(g.sm.grow,";-webkit-flex-grow:").concat(g.sm.grow,";-ms-flex-positive:").concat(g.sm.grow,";flex-grow:").concat(g.sm.grow,";max-width:").concat(g.sm.width,";-webkit-flex-basis:").concat(g.sm.basis,";-ms-flex-preferred-size:").concat(g.sm.basis,";flex-basis:").concat(g.sm.basis,";").concat(g.sm.display,";}}@media only screen and (min-width:").concat(_.breakpoints.md.min,"){.md.__jsx-style-dynamic-selector{-webkit-box-flex:").concat(g.md.grow,";-webkit-flex-grow:").concat(g.md.grow,";-ms-flex-positive:").concat(g.md.grow,";flex-grow:").concat(g.md.grow,";max-width:").concat(g.md.width,";-webkit-flex-basis:").concat(g.md.basis,";-ms-flex-preferred-size:").concat(g.md.basis,";flex-basis:").concat(g.md.basis,";").concat(g.md.display,";}}@media only screen and (min-width:").concat(_.breakpoints.lg.min,"){.lg.__jsx-style-dynamic-selector{-webkit-box-flex:").concat(g.lg.grow,";-webkit-flex-grow:").concat(g.lg.grow,";-ms-flex-positive:").concat(g.lg.grow,";flex-grow:").concat(g.lg.grow,";max-width:").concat(g.lg.width,";-webkit-flex-basis:").concat(g.lg.basis,";-ms-flex-preferred-size:").concat(g.lg.basis,";flex-basis:").concat(g.lg.basis,";").concat(g.lg.display,";}}@media only screen and (min-width:").concat(_.breakpoints.xl.min,"){.xl.__jsx-style-dynamic-selector{-webkit-box-flex:").concat(g.xl.grow,";-webkit-flex-grow:").concat(g.xl.grow,";-ms-flex-positive:").concat(g.xl.grow,";flex-grow:").concat(g.xl.grow,";max-width:").concat(g.xl.width,";-webkit-flex-basis:").concat(g.xl.basis,";-ms-flex-preferred-size:").concat(g.xl.basis,";flex-basis:").concat(g.xl.basis,";").concat(g.xl.display,";}}")))};gf.defaultProps=m6;gf.displayName="GeistGridBasicItem";var v6=["children","className"],E6={className:""},Gv=function(e){var t=e.children,i=e.className,r=pt(e,v6),s=$t(),a=s.SCALES,l={styles:k.createElement(Q,{id:"1271839607",dynamic:[a.mt(0),a.mr(0),a.mb(0),a.ml(0),a.pt(0,"var(--grid-gap-unit)"),a.pr(0,"var(--grid-gap-unit)"),a.pb(0,"var(--grid-gap-unit)"),a.pl(0,"var(--grid-gap-unit)")]},"div.__jsx-style-dynamic-selector{margin:".concat(a.mt(0)," ").concat(a.mr(0)," ").concat(a.mb(0)," ").concat(a.ml(0),";box-sizing:border-box;padding:").concat(a.pt(0,"var(--grid-gap-unit)")," ").concat(a.pr(0,"var(--grid-gap-unit)")," ").concat(a.pb(0,"var(--grid-gap-unit)")," ").concat(a.pl(0,"var(--grid-gap-unit)"),";}")),className:Q.dynamic([["1271839607",[a.mt(0),a.mr(0),a.mb(0),a.ml(0),a.pt(0,"var(--grid-gap-unit)"),a.pr(0,"var(--grid-gap-unit)"),a.pb(0,"var(--grid-gap-unit)"),a.pl(0,"var(--grid-gap-unit)")]]])},o=l.className,c=l.styles,u=Ut(o,i);return k.createElement(gf,Ge({className:u},r),t,c)};Gv.defaultProps=E6;Gv.displayName="GeistGrid";var lr=oi(Gv),y6=["gap","wrap","children","className"],T6={gap:0,wrap:"wrap",className:""},Wv=function(e){var t=e.gap,i=e.wrap,r=e.children,s=e.className,a=pt(e,y6),l=$t(),o=l.unit,c=l.SCALES,u=S.useMemo(function(){return"calc(".concat(t," * ").concat(o," * 1/3)")},[t,o]),h={styles:k.createElement(Q,{id:"3631618093",dynamic:[u,i,c.width(1,"var(--grid-container-width)"),c.mt(0,"var(--grid-container-margin)"),c.mr(0,"var(--grid-container-margin)"),c.mb(0,"var(--grid-container-margin)"),c.ml(0,"var(--grid-container-margin)")]},"div.__jsx-style-dynamic-selector{--grid-gap-unit:".concat(u,";--grid-container-margin:calc(-1 * var(--grid-gap-unit));--grid-container-width:calc(100% + var(--grid-gap-unit) * 2);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:").concat(i,";-ms-flex-wrap:").concat(i,";flex-wrap:").concat(i,";box-sizing:border-box;width:").concat(c.width(1,"var(--grid-container-width)"),";margin:").concat(c.mt(0,"var(--grid-container-margin)")," ").concat(c.mr(0,"var(--grid-container-margin)")," ").concat(c.mb(0,"var(--grid-container-margin)")," ").concat(c.ml(0,"var(--grid-container-margin)"),";}")),className:Q.dynamic([["3631618093",[u,i,c.width(1,"var(--grid-container-width)"),c.mt(0,"var(--grid-container-margin)"),c.mr(0,"var(--grid-container-margin)"),c.mb(0,"var(--grid-container-margin)"),c.ml(0,"var(--grid-container-margin)")]]])},d=h.className,f=h.styles,_=Ut(d,s);return k.createElement(gf,Ge({className:_},a),r,f)};Wv.defaultProps=T6;Wv.displayName="GeistGridContainer";var b6=oi(Wv);lr.Container=b6;var C6=["command","shift","option","ctrl","children","className"],A6={command:!1,shift:!1,option:!1,ctrl:!1,className:""},Hv=function(e){var t=e.command,i=e.shift,r=e.option,s=e.ctrl,a=e.children,l=e.className,o=pt(e,C6),c=Lt(),u=$t(),h=u.SCALES;return k.createElement("kbd",Ge({},o,{className:Q.dynamic([["921453049",[c.palette.accents_5,c.palette.accents_1,c.font.sans,c.layout.radius,c.palette.accents_2,h.font(.875),h.width(1,"fit-content"),h.height(1,"auto"),h.pt(0),h.pr(.34),h.pb(0),h.pl(.34),h.mt(0),h.mr(0),h.mb(0),h.ml(0)]]])+" "+(o&&o.className!=null&&o.className||l||"")}),t&&k.createElement("span",{className:Q.dynamic([["921453049",[c.palette.accents_5,c.palette.accents_1,c.font.sans,c.layout.radius,c.palette.accents_2,h.font(.875),h.width(1,"fit-content"),h.height(1,"auto"),h.pt(0),h.pr(.34),h.pb(0),h.pl(.34),h.mt(0),h.mr(0),h.mb(0),h.ml(0)]]])},""),i&&k.createElement("span",{className:Q.dynamic([["921453049",[c.palette.accents_5,c.palette.accents_1,c.font.sans,c.layout.radius,c.palette.accents_2,h.font(.875),h.width(1,"fit-content"),h.height(1,"auto"),h.pt(0),h.pr(.34),h.pb(0),h.pl(.34),h.mt(0),h.mr(0),h.mb(0),h.ml(0)]]])},""),r&&k.createElement("span",{className:Q.dynamic([["921453049",[c.palette.accents_5,c.palette.accents_1,c.font.sans,c.layout.radius,c.palette.accents_2,h.font(.875),h.width(1,"fit-content"),h.height(1,"auto"),h.pt(0),h.pr(.34),h.pb(0),h.pl(.34),h.mt(0),h.mr(0),h.mb(0),h.ml(0)]]])},""),s&&k.createElement("span",{className:Q.dynamic([["921453049",[c.palette.accents_5,c.palette.accents_1,c.font.sans,c.layout.radius,c.palette.accents_2,h.font(.875),h.width(1,"fit-content"),h.height(1,"auto"),h.pt(0),h.pr(.34),h.pb(0),h.pl(.34),h.mt(0),h.mr(0),h.mb(0),h.ml(0)]]])},""),a&&k.createElement("span",{className:Q.dynamic([["921453049",[c.palette.accents_5,c.palette.accents_1,c.font.sans,c.layout.radius,c.palette.accents_2,h.font(.875),h.width(1,"fit-content"),h.height(1,"auto"),h.pt(0),h.pr(.34),h.pb(0),h.pl(.34),h.mt(0),h.mr(0),h.mb(0),h.ml(0)]]])},a),k.createElement(Q,{id:"921453049",dynamic:[c.palette.accents_5,c.palette.accents_1,c.font.sans,c.layout.radius,c.palette.accents_2,h.font(.875),h.width(1,"fit-content"),h.height(1,"auto"),h.pt(0),h.pr(.34),h.pb(0),h.pl(.34),h.mt(0),h.mr(0),h.mb(0),h.ml(0)]},"kbd.__jsx-style-dynamic-selector{line-height:2em;text-align:center;display:inline-block;color:".concat(c.palette.accents_5,";background-color:").concat(c.palette.accents_1,";font-family:").concat(c.font.sans,";border-radius:").concat(c.layout.radius,";border:1px solid ").concat(c.palette.accents_2,";font-size:").concat(h.font(.875),";width:").concat(h.width(1,"fit-content"),";height:").concat(h.height(1,"auto"),";min-width:2em;min-height:2em;padding:").concat(h.pt(0)," ").concat(h.pr(.34)," ").concat(h.pb(0)," ").concat(h.pl(.34),";margin:").concat(h.mt(0)," ").concat(h.mr(0)," ").concat(h.mb(0)," ").concat(h.ml(0),";}span.__jsx-style-dynamic-selector{line-height:2em;font-size:1em;text-align:center;}span.__jsx-style-dynamic-selector+span.__jsx-style-dynamic-selector{margin-left:0.3em;}")))};Hv.defaultProps=A6;Hv.displayName="GeistKeyboard";var S6=oi(Hv),R6=["className","children","visible"],x6={className:"",visible:!1},jv=function(e){var t=e.className,i=e.children,r=e.visible,s=pt(e,R6),a=Lt(),l=$t(),o=l.SCALES,c=S.useRef(null),u=S.useRef(null),h=S.useRef(null);S.useEffect(function(){if(r){var f=document.activeElement,_=gk(c.current,f);_||u.current&&u.current.focus()}},[r]);var d=function(_){var p=_.keyCode===9;if(!(!r||!p)){var v=document.activeElement;_.shiftKey?v===u.current&&h.current&&h.current.focus():v===h.current&&u.current&&u.current.focus()}};return k.createElement(sc,{name:"wrapper",visible:r,clearTime:300},k.createElement("div",Ge({role:"dialog",tabIndex:-1,onKeyDown:d,ref:c},s,{className:Q.dynamic([["4268738715",[a.palette.background,a.palette.foreground,a.layout.radius,a.expressiveness.shadowLarge,o.font(1),o.height(1,"auto"),o.pl(1.3125),o.pr(1.3125),o.pt(1.3125),o.pb(1.3125),o.mt(0),o.mr(0),o.mb(0),o.ml(0)]]])+" "+(s&&s.className!=null&&s.className||Ut("wrapper",t)||"")}),k.createElement("div",{tabIndex:0,"aria-hidden":"true",ref:u,className:Q.dynamic([["4268738715",[a.palette.background,a.palette.foreground,a.layout.radius,a.expressiveness.shadowLarge,o.font(1),o.height(1,"auto"),o.pl(1.3125),o.pr(1.3125),o.pt(1.3125),o.pb(1.3125),o.mt(0),o.mr(0),o.mb(0),o.ml(0)]]])+" hide-tab"}),i,k.createElement("div",{tabIndex:0,"aria-hidden":"true",ref:h,className:Q.dynamic([["4268738715",[a.palette.background,a.palette.foreground,a.layout.radius,a.expressiveness.shadowLarge,o.font(1),o.height(1,"auto"),o.pl(1.3125),o.pr(1.3125),o.pt(1.3125),o.pb(1.3125),o.mt(0),o.mr(0),o.mb(0),o.ml(0)]]])+" hide-tab"}),k.createElement(Q,{id:"4268738715",dynamic:[a.palette.background,a.palette.foreground,a.layout.radius,a.expressiveness.shadowLarge,o.font(1),o.height(1,"auto"),o.pl(1.3125),o.pr(1.3125),o.pt(1.3125),o.pb(1.3125),o.mt(0),o.mr(0),o.mb(0),o.ml(0)]},".wrapper.__jsx-style-dynamic-selector{max-width:100%;vertical-align:middle;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:relative;box-sizing:border-box;background-color:".concat(a.palette.background,";color:").concat(a.palette.foreground,";border-radius:").concat(a.layout.radius,";box-shadow:").concat(a.expressiveness.shadowLarge,";opacity:0;outline:none;-webkit-transform:translate3d(0px,-30px,0px);-ms-transform:translate3d(0px,-30px,0px);transform:translate3d(0px,-30px,0px);-webkit-transition:opacity 0.35s cubic-bezier(0.4,0,0.2,1) 0s, -webkit-transform 0.35s cubic-bezier(0.4,0,0.2,1) 0s;-webkit-transition:opacity 0.35s cubic-bezier(0.4,0,0.2,1) 0s, transform 0.35s cubic-bezier(0.4,0,0.2,1) 0s;transition:opacity 0.35s cubic-bezier(0.4,0,0.2,1) 0s, transform 0.35s cubic-bezier(0.4,0,0.2,1) 0s;width:100%;font-size:").concat(o.font(1),";height:").concat(o.height(1,"auto"),";--modal-wrapper-padding-left:").concat(o.pl(1.3125),";--modal-wrapper-padding-right:").concat(o.pr(1.3125),";padding:").concat(o.pt(1.3125)," var(--modal-wrapper-padding-right) ").concat(o.pb(1.3125)," var(--modal-wrapper-padding-left);margin:").concat(o.mt(0)," ").concat(o.mr(0)," ").concat(o.mb(0)," ").concat(o.ml(0),";}.wrapper-enter.__jsx-style-dynamic-selector{opacity:0;-webkit-transform:translate3d(0px,-30px,0px);-ms-transform:translate3d(0px,-30px,0px);transform:translate3d(0px,-30px,0px);}.wrapper-enter-active.__jsx-style-dynamic-selector{opacity:1;-webkit-transform:translate3d(0px,0px,0px);-ms-transform:translate3d(0px,0px,0px);transform:translate3d(0px,0px,0px);}.wrapper-leave.__jsx-style-dynamic-selector{opacity:1;-webkit-transform:translate3d(0px,0px,0px);-ms-transform:translate3d(0px,0px,0px);transform:translate3d(0px,0px,0px);}.wrapper-leave-active.__jsx-style-dynamic-selector{opacity:0;-webkit-transform:translate3d(0px,-30px,0px);-ms-transform:translate3d(0px,-30px,0px);transform:translate3d(0px,-30px,0px);}.hide-tab.__jsx-style-dynamic-selector{outline:none;overflow:hidden;width:0;height:0;opacity:0;}"))))};jv.defaultProps=x6;jv.displayName="GeistModalWrapper";var M6={},cA=k.createContext(M6),I6=function(){return k.useContext(cA)},P6=["className","children","onClick","passive","disabled"],w6={className:"",passive:!1,disabled:!1},Xv=k.forwardRef(function(n,e){var t=n.className,i=n.children,r=n.onClick,s=n.passive,a=n.disabled,l=pt(n,P6),o=Lt(),c=$t(),u=c.SCALES,h=S.useRef(null),d=I6(),f=d.close;S.useImperativeHandle(e,function(){return h.current});var _=function(C){if(!a){var M=Object.assign({},C,{close:function(){return f&&f()}});r&&r(M)}},p=S.useMemo(function(){return s?o.palette.accents_5:o.palette.foreground},[o.palette,s,a]),v=S.useMemo(function(){return a?o.palette.accents_1:o.palette.background},[o.palette,a]),E={styles:k.createElement(Q,{id:"930885138",dynamic:[u.font(.75),p,o.palette.background,u.height(3.5625),a?p:o.palette.foreground,a?v:o.palette.accents_1]},"button.btn.__jsx-style-dynamic-selector{font-size:".concat(u.font(.75),";border:none;color:").concat(p,";background-color:").concat(o.palette.background,";display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-flex:1;-ms-flex:1;flex:1;height:").concat(u.height(3.5625),";border-radius:0;min-width:0;}button.btn.__jsx-style-dynamic-selector:hover,button.btn.__jsx-style-dynamic-selector:focus{color:").concat(a?p:o.palette.foreground,";background-color:").concat(a?v:o.palette.accents_1,";}")),className:Q.dynamic([["930885138",[u.font(.75),p,o.palette.background,u.height(3.5625),a?p:o.palette.foreground,a?v:o.palette.accents_1]]])},g=E.className,m=E.styles,y=Ut(g,t),T=Ge({},l,{effect:!1,ref:h});return k.createElement(Rv,Ge({className:y,onClick:_,disabled:a},T),i,m)});Xv.defaultProps=w6;Xv.displayName="GeistModalAction";var uA=oi(Xv),O6=["children"],hA=function(e){var t=e.children,i=pt(e,O6),r=Lt(),s=S.useRef(null),a=S.useState("auto"),l=yt(a,2),o=l[0],c=l[1];return S.useEffect(function(){s.current&&c("".concat(s.current.clientHeight,"px"))},[s]),k.createElement(k.Fragment,null,k.createElement("div",{className:Q.dynamic([["2914444644",[r.palette.border,r.layout.radius,r.layout.radius,r.palette.border,o]]])}),k.createElement("footer",Ge({ref:s},i,{className:Q.dynamic([["2914444644",[r.palette.border,r.layout.radius,r.layout.radius,r.palette.border,o]]])+" "+(i&&i.className!=null&&i.className||"")}),t),k.createElement(Q,{id:"2914444644",dynamic:[r.palette.border,r.layout.radius,r.layout.radius,r.palette.border,o]},"footer.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;overflow:hidden;width:100%;height:auto;position:absolute;bottom:0;left:0;right:0;border-top:1px solid ".concat(r.palette.border,";border-bottom-left-radius:").concat(r.layout.radius,";border-bottom-right-radius:").concat(r.layout.radius,";}footer.__jsx-style-dynamic-selector>button.btn + button.btn{border-left:1px solid ").concat(r.palette.border,";}div.__jsx-style-dynamic-selector{height:").concat(o,";-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}")))};hA.displayName="GeistModalActions";var D6=k.memo(hA),L6={wrapClassName:"",keyboard:!0,disableBackdropClick:!1,positionClassName:"",backdropClassName:"",layerClassName:""},Yv=function(e){var t=e.visible,i=e.onClose,r=e.children,s=e.keyboard,a=e.wrapClassName,l=e.onContentClick,o=e.disableBackdropClick,c=e.positionClassName,u=e.backdropClassName,h=e.layerClassName,d=yv("modal"),f=$t(),_=f.SCALES,p=WU(null,{delayReset:300}),v=yt(p,2),E=v[1],g=S.useState(!1),m=yt(g,2),y=m[0],T=m[1],b=sd(r,uA),C=yt(b,2),M=C[0],F=C[1],P=F&&k.Children.count(F)>0,U=function(){i&&i(),T(!1),E(!1)};S.useEffect(function(){typeof t>"u"||(T(t),E(t))},[t]);var G=XU(function(){s&&U()},Rg.Escape,{disableGlobalEvent:!0}),K=G.bindings,q=function(){o||U()},se=S.useMemo(function(){return{close:U}},[]);return d?nc.createPortal(k.createElement(cA.Provider,{value:se},k.createElement(Bv,Ge({onClick:q,onContentClick:l,visible:y,width:_.width(26),positionClassName:c,backdropClassName:u,layerClassName:h},K),k.createElement(jv,{visible:y,className:a},M,P&&k.createElement(D6,null,F)))),d):null};Yv.defaultProps=L6;Yv.displayName="GeistModal";var ba=oi(Yv);ba.Title=QU;ba.Subtitle=e6;ba.Content=r6;ba.Action=uA;var N6=["className","children"],F6={className:""},Kv=function(e){var t=e.className,i=e.children,r=pt(e,N6),s=$t(),a=s.SCALES;return k.createElement("main",Ge({},r,{className:Q.dynamic([["3887979816",[a.font(1),a.width(1,"100%"),a.height(1,"100%"),a.pt(3.125),a.pr(0),a.pb(3.125),a.pl(0),a.mt(0),a.mr(0),a.mb(0),a.ml(0)]]])+" "+(r&&r.className!=null&&r.className||t||"")}),i,k.createElement(Q,{id:"3887979816",dynamic:[a.font(1),a.width(1,"100%"),a.height(1,"100%"),a.pt(3.125),a.pr(0),a.pb(3.125),a.pl(0),a.mt(0),a.mr(0),a.mb(0),a.ml(0)]},"main.__jsx-style-dynamic-selector{font-size:".concat(a.font(1),";width:").concat(a.width(1,"100%"),";height:").concat(a.height(1,"100%"),";padding:").concat(a.pt(3.125)," ").concat(a.pr(0)," ").concat(a.pb(3.125)," ").concat(a.pl(0),";margin:").concat(a.mt(0)," ").concat(a.mr(0)," ").concat(a.mb(0)," ").concat(a.ml(0),";}")))};Kv.defaultProps=F6;Kv.displayName="GeistPageContent";var Dd=oi(Kv),k6=["children","render","dotBackdrop","className","dotSize","dotSpace"];Wn("default","effect","effect-seo");var B6={render:"default",dotBackdrop:!1,dotSize:"1px",dotSpace:1},U6=function(e){var t=e.dotSpace,i=e.dotSize,r=S.useMemo(function(){return{position:"calc(".concat(t," * 25px)"),size:"calc(".concat(t," * 50px)")}},[t]);return k.createElement("span",{className:Q.dynamic([["934717826",[i,i,r.position,r.position,r.size,r.size]]])},k.createElement(Q,{id:"934717826",dynamic:[i,i,r.position,r.position,r.size,r.size]},"body{background-image:radial-gradient(#e3e3e3 ".concat(i,",transparent 0), radial-gradient(#e3e3e3 ").concat(i,",transparent 0);background-position:0 0,").concat(r.position," ").concat(r.position,";background-attachment:fixed;background-size:").concat(r.size," ").concat(r.size,";}")))},qv=function(e){var t=e.children,i=e.render,r=e.dotBackdrop,s=e.className,a=e.dotSize,l=e.dotSpace,o=pt(e,k6),c=Lt(),u=$t(),h=u.SCALES,d=S.useMemo(function(){return c.type==="dark"?!1:r},[r,c.type]),f=S.useState(i!=="default"),_=yt(f,2),p=_[0],v=_[1];if(S.useEffect(function(){v(!1)},[]),p){var E=i==="effect-seo";return E?k.createElement("div",{"aria-hidden":"true",className:"jsx-3942095687 hidden"},t,k.createElement(Q,{id:"3942095687"},".hidden.jsx-3942095687{opacity:0;display:none;}")):null}var g=j1(t,Dd);return k.createElement("section",Ge({},o,{className:Q.dynamic([["1515698274",[h.font(1),h.width(1,"calc(100% - 100pt)"),h.height(1,"auto"),h.pt(0),h.pr(1.34),h.pb(0),h.pl(1.34),h.mt(0),h.mr(0,"auto"),h.mb(0),h.ml(0,"auto")]]])+" "+(o&&o.className!=null&&o.className||s||"")}),g?t:k.createElement(Dd,null,t),d&&k.createElement(U6,{dotSize:a,dotSpace:l}),k.createElement(Q,{id:"1515698274",dynamic:[h.font(1),h.width(1,"calc(100% - 100pt)"),h.height(1,"auto"),h.pt(0),h.pr(1.34),h.pb(0),h.pl(1.34),h.mt(0),h.mr(0,"auto"),h.mb(0),h.ml(0,"auto")]},"section.__jsx-style-dynamic-selector{max-width:100vw;min-height:100vh;box-sizing:border-box;position:relative;font-size:".concat(h.font(1),";width:").concat(h.width(1,"calc(100% - 100pt)"),";height:").concat(h.height(1,"auto"),";padding:").concat(h.pt(0)," ").concat(h.pr(1.34)," ").concat(h.pb(0)," ").concat(h.pl(1.34),";margin:").concat(h.mt(0)," ").concat(h.mr(0,"auto")," ").concat(h.mb(0)," ").concat(h.ml(0,"auto"),";}")))};qv.defaultProps=B6;qv.displayName="GeistPage";var Xl=oi(qv),z6=["children","center","className"],V6={center:!1,className:""},$v=function(e){var t=e.children,i=e.center,r=e.className,s=pt(e,z6),a=$t(),l=a.SCALES,o=Ut({center:i},r);return k.createElement("header",Ge({},s,{className:Q.dynamic([["3053482948",[l.font(1),l.width(1,"100%"),l.height(1,"auto"),l.pt(0),l.pr(0),l.pb(0),l.pl(0),l.mt(0),l.mr(0),l.mb(0),l.ml(0)]]])+" "+(s&&s.className!=null&&s.className||o||"")}),t,k.createElement(Q,{id:"3053482948",dynamic:[l.font(1),l.width(1,"100%"),l.height(1,"auto"),l.pt(0),l.pr(0),l.pb(0),l.pl(0),l.mt(0),l.mr(0),l.mb(0),l.ml(0)]},"header.__jsx-style-dynamic-selector{font-size:".concat(l.font(1),";width:").concat(l.width(1,"100%"),";height:").concat(l.height(1,"auto"),";padding:").concat(l.pt(0)," ").concat(l.pr(0)," ").concat(l.pb(0)," ").concat(l.pl(0),";margin:").concat(l.mt(0)," ").concat(l.mr(0)," ").concat(l.mb(0)," ").concat(l.ml(0),";}.center.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}")))};$v.defaultProps=V6;$v.displayName="GeistPageHeader";var G6=oi($v),W6=["children"],H6={className:""},Qv=function(e){var t=e.children,i=pt(e,W6),r=$t(),s=r.SCALES;return k.createElement("footer",Ge({},i,{className:Q.dynamic([["3447440073",[s.font(1),s.width(1,"100%"),s.height(1,"auto"),s.pt(0),s.pr(0),s.pb(0),s.pl(0),s.mt(0),s.mr(0),s.mb(0),s.ml(0)]]])+" "+(i&&i.className!=null&&i.className||"")}),t,k.createElement(Q,{id:"3447440073",dynamic:[s.font(1),s.width(1,"100%"),s.height(1,"auto"),s.pt(0),s.pr(0),s.pb(0),s.pl(0),s.mt(0),s.mr(0),s.mb(0),s.ml(0)]},"footer.__jsx-style-dynamic-selector{position:absolute;bottom:0;font-size:".concat(s.font(1),";width:").concat(s.width(1,"100%"),";height:").concat(s.height(1,"auto"),";padding:").concat(s.pt(0)," ").concat(s.pr(0)," ").concat(s.pb(0)," ").concat(s.pl(0),";margin:").concat(s.mt(0)," ").concat(s.mr(0)," ").concat(s.mb(0)," ").concat(s.ml(0),";}")))};Qv.defaultProps=H6;Qv.displayName="GeistPageFooter";var j6=oi(Qv);Xl.Header=G6;Xl.Content=Dd;Xl.Body=Dd;Xl.Footer=j6;var X6=function(e,t){var i={default:t.background,success:t.success,warning:t.warning,error:t.error,secondary:t.secondary,dark:t.foreground,lite:t.background},r=e==="lite"||e==="default"?t.foreground:t.background;return{color:r,bgColor:i[e]}},Y6={top:"-1000px",left:"-1000px",transform:"none"},K6=function(e,t,i){var r={top:{top:"".concat(t.top-i,"px"),left:"".concat(t.left+t.width/2,"px"),transform:"translate(-50%, -100%)"},topStart:{top:"".concat(t.top-i,"px"),left:"".concat(t.left,"px"),transform:"translate(0, -100%)"},topEnd:{top:"".concat(t.top-i,"px"),left:"".concat(t.left+t.width,"px"),transform:"translate(-100%, -100%)"},bottom:{top:"".concat(t.bottom+i,"px"),left:"".concat(t.left+t.width/2,"px"),transform:"translate(-50%, 0)"},bottomStart:{top:"".concat(t.bottom+i,"px"),left:"".concat(t.left,"px"),transform:"translate(0, 0)"},bottomEnd:{top:"".concat(t.bottom+i,"px"),left:"".concat(t.left+t.width,"px"),transform:"translate(-100%, 0)"},left:{top:"".concat(t.top+t.height/2,"px"),left:"".concat(t.left-i,"px"),transform:"translate(-100%, -50%)"},leftStart:{top:"".concat(t.top,"px"),left:"".concat(t.left-i,"px"),transform:"translate(-100%, 0)"},leftEnd:{top:"".concat(t.top+t.height,"px"),left:"".concat(t.left-i,"px"),transform:"translate(-100%, -100%)"},right:{top:"".concat(t.top+t.height/2,"px"),left:"".concat(t.right+i,"px"),transform:"translate(0, -50%)"},rightStart:{top:"".concat(t.top,"px"),left:"".concat(t.right+i,"px"),transform:"translate(0, 0)"},rightEnd:{top:"".concat(t.top+t.height,"px"),left:"".concat(t.right+i,"px"),transform:"translate(0, -100%)"}};return r[e]||r.top},q6=function(e,t,i){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"3px",s={top:{top:"auto",right:"auto",left:"50%",bottom:"".concat(r),transform:"translate(-50%, 100%) rotate(-90deg)"},topStart:{top:"auto",right:"auto",left:"".concat(t),bottom:"".concat(r),transform:"translate(0, 100%) rotate(-90deg)"},topEnd:{top:"auto",right:"".concat(t),left:"auto",bottom:"".concat(r),transform:"translate(0, 100%) rotate(-90deg)"},bottom:{top:"".concat(r),right:"auto",left:"50%",bottom:"auto",transform:"translate(-50%, -100%) rotate(90deg)"},bottomStart:{top:"".concat(r),right:"auto",left:"".concat(t),bottom:"auto",transform:"translate(0, -100%) rotate(90deg)"},bottomEnd:{top:"".concat(r),right:"".concat(t),left:"auto",bottom:"auto",transform:"translate(0, -100%) rotate(90deg)"},left:{top:"50%",right:"0",left:"auto",bottom:"auto",transform:"translate(100%, -50%) rotate(180deg)"},leftStart:{top:"".concat(i),right:"0",left:"auto",bottom:"auto",transform:"translate(100%, -50%) rotate(180deg)"},leftEnd:{top:"auto",right:"0",left:"auto",bottom:"".concat(i),transform:"translate(100%, 50%) rotate(180deg)"},right:{top:"50%",right:"auto",left:"0",bottom:"auto",transform:"translate(-100%, -50%) rotate(0deg)"},rightStart:{top:"".concat(i),right:"auto",left:"0",bottom:"auto",transform:"translate(-100%, -50%) rotate(0deg)"},rightEnd:{top:"auto",right:"auto",left:"0",bottom:"".concat(i),transform:"translate(-100%, 50%) rotate(0deg)"}};return s[e]||s.top},$6=function(e){var t=e.placement,i=e.shadow,r=Lt(),s=S.useMemo(function(){return q6(t,"var(--tooltip-icon-offset-x)","var(--tooltip-icon-offset-y)")},[t]),a=s.transform,l=s.top,o=s.left,c=s.right,u=s.bottom,h=S.useMemo(function(){return!i||r.type!=="dark"?"var(--tooltip-content-bg)":r.palette.accents_2},[r.type,i]);return k.createElement("span",{className:Q.dynamic([["2440507693",[h,o,l,c,u,a]]])},k.createElement(Q,{id:"2440507693",dynamic:[h,o,l,c,u,a]},"span.__jsx-style-dynamic-selector{width:0;height:0;border-style:solid;border-width:6px 7px 6px 0;border-color:transparent ".concat(h," transparent transparent;position:absolute;left:").concat(o,";top:").concat(l,";right:").concat(c,";bottom:").concat(u,";-webkit-transform:").concat(a,";-ms-transform:").concat(a,";transform:").concat(a,";}")))},Q6={top:-1e3,left:-1e3,right:-1e3,bottom:-1e3,width:0,height:0},dA=function(e){if(!e||!e.current)return Q6;var t=e.current.getBoundingClientRect();return Ge({},t,{width:t.width||t.right-t.left,height:t.height||t.bottom-t.top,top:t.top+document.documentElement.scrollTop,bottom:t.bottom+document.documentElement.scrollTop,left:t.left+document.documentElement.scrollLeft,right:t.right+document.documentElement.scrollLeft})},Z6=function(e){var t=e.children,i=e.parent,r=e.visible,s=e.offset,a=e.iconOffset,l=e.placement,o=e.type,c=e.className,u=e.hideArrow,h=Lt(),d=$t(),f=d.SCALES,_=yv("tooltip"),p=S.useRef(null),v=S.useState(Y6),E=yt(v,2),g=E[0],m=E[1],y=S.useMemo(function(){return X6(o,h.palette)},[o,h.palette]),T=o==="default",b=Ut("tooltip-content",c);if(!i)return null;var C=function(){var P=K6(l,dA(i),s);m(P)};qC(C),DB(function(){return C()}),S.useEffect(function(){C()},[r]);var M=function(P){P.stopPropagation(),P.nativeEvent.stopImmediatePropagation()};return _?nc.createPortal(k.createElement(sc,{visible:r},k.createElement("div",{ref:p,onClick:M,className:Q.dynamic([["2387841858",[a.x,a.y,y.bgColor,g.top,g.left,g.transform,y.color,h.layout.radius,T?h.expressiveness.shadowMedium:"none",f.width(1,"auto"),f.height(1,"auto"),f.font(1),f.pt(.65),f.pr(.9),f.pb(.65),f.pl(.9)]]])+" "+(b||"")},k.createElement("div",{className:Q.dynamic([["2387841858",[a.x,a.y,y.bgColor,g.top,g.left,g.transform,y.color,h.layout.radius,T?h.expressiveness.shadowMedium:"none",f.width(1,"auto"),f.height(1,"auto"),f.font(1),f.pt(.65),f.pr(.9),f.pb(.65),f.pl(.9)]]])+" inner"},!u&&k.createElement($6,{placement:l,shadow:T}),t),k.createElement(Q,{id:"2387841858",dynamic:[a.x,a.y,y.bgColor,g.top,g.left,g.transform,y.color,h.layout.radius,T?h.expressiveness.shadowMedium:"none",f.width(1,"auto"),f.height(1,"auto"),f.font(1),f.pt(.65),f.pr(.9),f.pb(.65),f.pl(.9)]},".tooltip-content.__jsx-style-dynamic-selector{--tooltip-icon-offset-x:".concat(a.x,";--tooltip-icon-offset-y:").concat(a.y,";--tooltip-content-bg:").concat(y.bgColor,";box-sizing:border-box;position:absolute;top:").concat(g.top,";left:").concat(g.left,";-webkit-transform:").concat(g.transform,";-ms-transform:").concat(g.transform,";transform:").concat(g.transform,";background-color:var(--tooltip-content-bg);color:").concat(y.color,";border-radius:").concat(h.layout.radius,";padding:0;z-index:1000;box-shadow:").concat(T?h.expressiveness.shadowMedium:"none",";width:").concat(f.width(1,"auto"),";height:").concat(f.height(1,"auto"),";}.inner.__jsx-style-dynamic-selector{box-sizing:border-box;position:relative;font-size:").concat(f.font(1),";padding:").concat(f.pt(.65)," ").concat(f.pr(.9)," ").concat(f.pb(.65)," ").concat(f.pl(.9),";height:100%;}")))),_):null},J6=["children","initialVisible","text","offset","placement","portalClassName","enterDelay","leaveDelay","trigger","type","className","onVisibleChange","hideArrow","visible"],e8={initialVisible:!1,hideArrow:!1,type:"default",trigger:"hover",placement:"top",enterDelay:100,leaveDelay:150,offset:12,className:"",portalClassName:"",onVisibleChange:function(){}},Zv=function(e){var t=e.children,i=e.initialVisible,r=e.text,s=e.offset,a=e.placement,l=e.portalClassName,o=e.enterDelay,c=e.leaveDelay,u=e.trigger,h=e.type,d=e.className,f=e.onVisibleChange,_=e.hideArrow,p=e.visible,v=pt(e,J6),E=S.useRef(),g=S.useRef(null),m=S.useState(i),y=yt(m,2),T=y[0],b=y[1],C=S.useMemo(function(){if(!(g!=null&&g.current))return{x:"0.75em",y:"0.75em"};var G=dA(g);return{x:"".concat(G.width?G.width/2:0,"px"),y:"".concat(G.height?G.height/2:0,"px")}},[g==null?void 0:g.current]),M={type:h,visible:T,offset:s,placement:a,hideArrow:_,iconOffset:C,parent:g,className:l},F=function(K){var q=function(){clearTimeout(E.current),E.current=void 0},se=function($){b($),f($),q()};if(q(),K){E.current=window.setTimeout(function(){return se(!0)},o);return}var Ee=u==="click"?0:c;E.current=window.setTimeout(function(){return se(!1)},Ee)},P=function(K){return u==="hover"&&F(K)},U=function(){return u==="click"&&F(!T)};return eA(g,function(){return u==="click"&&F(!1)}),S.useEffect(function(){p!==void 0&&F(p)},[p]),k.createElement("div",Ge({ref:g,onClick:U,onMouseEnter:function(){return P(!0)},onMouseLeave:function(){return P(!1)}},v,{className:"jsx-418573366 "+(v&&v.className!=null&&v.className||Ut("tooltip",d)||"")}),t,k.createElement(Z6,M,r),k.createElement(Q,{id:"418573366"},".tooltip.jsx-418573366{width:-webkit-max-content;width:-moz-max-content;width:max-content;display:inline-block;}"))};Zv.defaultProps=e8;Zv.displayName="GeistTooltip";var Jv=oi(Zv),yy={delay:2e3,type:"default"},t8=function(e){var t=lA(),i=t.updateToasts,r=t.toasts;t.updateToastLayout;var s=t.updateLastToastId;S.useEffect(function(){},[]);var a=function(d){i(function(f){return f.map(function(_){return _._internalIdent!==d?_:Ge({},_,{visible:!1})})}),s(function(){return d})},l=function(){i(function(d){return d.map(function(f){return Ge({},f,{visible:!1})})})},o=function(d){return r.find(function(f){return f.id===d})},c=function(d){i(function(f){return f.map(function(_){return _.id!==d?_:Ge({},_,{visible:!1})})})},u=function(d){var f="toast-".concat(H1()),_=d.delay||yy.delay;if(d.id){var p=r.find(function(v){return v.id===d.id});if(p)throw new Error('Toast: Already have the same key: "ident"')}i(function(v){var E={delay:_,text:d.text,visible:!0,type:d.type||yy.type,id:d.id||f,actions:d.actions||[],_internalIdent:f,_timeout:window.setTimeout(function(){a(f),E._timeout&&(window.clearTimeout(E._timeout),E._timeout=null)},_),cancel:function(g){function m(){return g.apply(this,arguments)}return m.toString=function(){return g.toString()},m}(function(){return a(f)})};return[].concat(Nv(v),[E])})};return{toasts:r,setToast:u,removeAll:l,findToastOneByID:o,removeToastOneByID:c}},i8=["inline","className"],r8={inline:!1,className:""},e0=function(e){var t=e.inline,i=e.className,r=pt(e,i8),s=$t(),a=s.SCALES;return k.createElement("span",Ge({},r,{className:Q.dynamic([["1994396435",[t?"inline-block":"block",a.width(1),a.height(1),a.pt(0),a.pr(0),a.pb(0),a.pl(0),a.mt(0),a.mr(0),a.mb(0),a.ml(0)]]])+" "+(r&&r.className!=null&&r.className||i||"")}),k.createElement(Q,{id:"1994396435",dynamic:[t?"inline-block":"block",a.width(1),a.height(1),a.pt(0),a.pr(0),a.pb(0),a.pl(0),a.mt(0),a.mr(0),a.mb(0),a.ml(0)]},"span.__jsx-style-dynamic-selector{display:".concat(t?"inline-block":"block",";width:").concat(a.width(1),";height:").concat(a.height(1),";padding:").concat(a.pt(0)," ").concat(a.pr(0)," ").concat(a.pb(0)," ").concat(a.pl(0),";margin:").concat(a.mt(0)," ").concat(a.mr(0)," ").concat(a.mb(0)," ").concat(a.ml(0),";}")))};e0.defaultProps=r8;e0.displayName="GeistSpacer";var n8=oi(e0),s8={className:""},a8=function(e,t){var i=t.filter(function(a){return!a.width}).length,r=t.reduce(function(a,l){return l.width?a+l.width:a},0),s=(e-r)/i;return s<=0?k.createElement("colgroup",null):k.createElement("colgroup",null,t.map(function(a,l){return k.createElement("col",{key:"colgroup-".concat(l),width:a.width||s})}))},t0=function(e){var t=Lt(),i=e,r=i.columns,s=i.width,a=S.useMemo(function(){return r.find(function(o){return!!o.width})},[r]),l=S.useMemo(function(){return a?a8(s,r):k.createElement("colgroup",null)},[a,s]);return k.createElement(k.Fragment,null,l,k.createElement("thead",{className:Q.dynamic([["134865897",[t.palette.accents_5,t.palette.accents_1,t.palette.border,t.palette.border,t.palette.border,t.palette.border,t.palette.border,t.layout.radius,t.layout.radius,t.palette.border,t.palette.border,t.palette.border,t.layout.radius,t.layout.radius]]])},k.createElement("tr",{className:Q.dynamic([["134865897",[t.palette.accents_5,t.palette.accents_1,t.palette.border,t.palette.border,t.palette.border,t.palette.border,t.palette.border,t.layout.radius,t.layout.radius,t.palette.border,t.palette.border,t.palette.border,t.layout.radius,t.layout.radius]]])},r.map(function(o,c){return k.createElement("th",{key:"table-th-".concat(o.prop,"-").concat(c),className:Q.dynamic([["134865897",[t.palette.accents_5,t.palette.accents_1,t.palette.border,t.palette.border,t.palette.border,t.palette.border,t.palette.border,t.layout.radius,t.layout.radius,t.palette.border,t.palette.border,t.palette.border,t.layout.radius,t.layout.radius]]])+" "+(o.className||"")},k.createElement("div",{className:Q.dynamic([["134865897",[t.palette.accents_5,t.palette.accents_1,t.palette.border,t.palette.border,t.palette.border,t.palette.border,t.palette.border,t.layout.radius,t.layout.radius,t.palette.border,t.palette.border,t.palette.border,t.layout.radius,t.layout.radius]]])+" thead-box"},o.label))}))),k.createElement(Q,{id:"134865897",dynamic:[t.palette.accents_5,t.palette.accents_1,t.palette.border,t.palette.border,t.palette.border,t.palette.border,t.palette.border,t.layout.radius,t.layout.radius,t.palette.border,t.palette.border,t.palette.border,t.layout.radius,t.layout.radius]},"thead.__jsx-style-dynamic-selector{border-collapse:separate;border-spacing:0;font-size:inherit;}th.__jsx-style-dynamic-selector{padding:0 0.5em;font-size:calc(0.75 * var(--table-font-size));font-weight:normal;text-align:left;-webkit-letter-spacing:0;-moz-letter-spacing:0;-ms-letter-spacing:0;letter-spacing:0;vertical-align:middle;min-height:calc(2.5 * var(--table-font-size));color:".concat(t.palette.accents_5,";background:").concat(t.palette.accents_1,";border-bottom:1px solid ").concat(t.palette.border,";border-top:1px solid ").concat(t.palette.border,";border-radius:0;}th.__jsx-style-dynamic-selector:nth-child(1){border-bottom:1px solid ").concat(t.palette.border,";border-left:1px solid ").concat(t.palette.border,";border-top:1px solid ").concat(t.palette.border,";border-top-left-radius:").concat(t.layout.radius,";border-bottom-left-radius:").concat(t.layout.radius,";}th.__jsx-style-dynamic-selector:last-child{border-bottom:1px solid ").concat(t.palette.border,";border-right:1px solid ").concat(t.palette.border,";border-top:1px solid ").concat(t.palette.border,";border-top-right-radius:").concat(t.layout.radius,";border-bottom-right-radius:").concat(t.layout.radius,";}.thead-box.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-align:center;min-height:calc(2.5 * var(--table-font-size));text-transform:uppercase;}")))};t0.defaultProps=s8;t0.displayName="GeistTableHead";var o8=function(e){var t=e.columns,i=e.row,r=e.rowIndex,s=e.emptyText,a=e.onCellClick;return k.createElement(k.Fragment,null,t.map(function(l,o){var c=i[l.prop],u=c||s,h=l.renderHandler(c,i,r);return k.createElement("td",{key:"row-td-".concat(o,"-").concat(l.prop),onClick:function(){return a&&a(c,r,o)},className:l.className},k.createElement("div",{className:"cell"},h||u))}))},l8={columns:[],updateColumn:function(){}},fA=k.createContext(l8),_A=function(){return k.useContext(fA)},c8={className:""},i0=function(e){var t=e.data,i=e.hover,r=e.emptyText,s=e.onRow,a=e.onCell,l=e.rowClassName,o=Lt(),c=_A(),u=c.columns,h=function(f,_){s&&s(f,_)};return k.createElement("tbody",{className:Q.dynamic([["3433300570",[o.palette.accents_1,o.palette.border,o.palette.accents_6]]])},t.map(function(d,f){var _=l(d,f);return k.createElement("tr",{key:"tbody-row-".concat(f),onClick:function(){return h(d,f)},className:Q.dynamic([["3433300570",[o.palette.accents_1,o.palette.border,o.palette.accents_6]]])+" "+(Ut({hover:i},_)||"")},k.createElement(o8,{columns:u,row:d,rowIndex:f,emptyText:r,onCellClick:a}))}),k.createElement(Q,{id:"3433300570",dynamic:[o.palette.accents_1,o.palette.border,o.palette.accents_6]},"tr.__jsx-style-dynamic-selector{-webkit-transition:background-color 0.25s ease;transition:background-color 0.25s ease;font-size:inherit;}tr.hover.__jsx-style-dynamic-selector:hover{background-color:".concat(o.palette.accents_1,";}tr.__jsx-style-dynamic-selector td{padding:0 0.5em;border-bottom:1px solid ").concat(o.palette.border,";color:").concat(o.palette.accents_6,";font-size:calc(0.875 * var(--table-font-size));text-align:left;}tr.__jsx-style-dynamic-selector .cell{min-height:calc(3.125 * var(--table-font-size));display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-flow:row wrap;-ms-flex-flow:row wrap;flex-flow:row wrap;}")))};i0.defaultProps=c8;i0.displayName="GeistTableBody";var u8={className:"",render:function(){}},mf=function(e){var t=e,i=t.children,r=t.prop,s=t.label,a=t.width,l=t.className,o=t.render,c=_A(),u=c.updateColumn,h="".concat(r).trim();return h||LB('The props "prop" is required.',"Table.Column"),S.useEffect(function(){u({label:i||s,prop:h,width:a,className:l,renderHandler:o})},[i,s,r,a,l,o]),null};mf.defaultProps=u8;mf.displayName="GeistTableColumn";var h8=["children","data","initialData","hover","emptyText","onRow","onCell","onChange","className","rowClassName"],d8={hover:!0,initialData:[],emptyText:"",className:"",rowClassName:function(){return""}};function vf(n){var e=n,t=e.children,i=e.data,r=e.initialData,s=e.hover,a=e.emptyText,l=e.onRow,o=e.onCell;e.onChange;var c=e.className,u=e.rowClassName,h=pt(e,h8),d=$t(),f=d.SCALES,_=S.useRef(null),p=sA(_),v=yt(p,2),E=v[0].width,g=v[1],m=S.useState([]),y=yt(m,2),T=y[0],b=y[1],C=S.useState(r),M=yt(C,2),F=M[0],P=M[1],U=function(q){b(function(se){var Ee=se.find(function(Se){return Se.prop===q.prop});return Ee?se.map(function(Se){return Se.prop!==q.prop?Se:q}):[].concat(Nv(se),[q])})},G=S.useMemo(function(){return{columns:T,updateColumn:U}},[T]);return S.useEffect(function(){typeof i>"u"||P(i)},[i]),qC(function(){return g()}),k.createElement(fA.Provider,{value:G},k.createElement("table",Ge({ref:_},h,{className:Q.dynamic([["2132340556",[f.font(1),f.width(1,"100%"),f.height(1,"auto"),f.pt(0),f.pr(0),f.pb(0),f.pl(0),f.mt(0),f.mr(0),f.mb(0),f.ml(0)]]])+" "+(h&&h.className!=null&&h.className||c||"")}),k.createElement(t0,{columns:T,width:E}),k.createElement(i0,{data:F,hover:s,emptyText:a,onRow:l,onCell:o,rowClassName:u}),t,k.createElement(Q,{id:"2132340556",dynamic:[f.font(1),f.width(1,"100%"),f.height(1,"auto"),f.pt(0),f.pr(0),f.pb(0),f.pl(0),f.mt(0),f.mr(0),f.mb(0),f.ml(0)]},"table.__jsx-style-dynamic-selector{border-collapse:separate;border-spacing:0;--table-font-size:".concat(f.font(1),";font-size:var(--table-font-size);width:").concat(f.width(1,"100%"),";height:").concat(f.height(1,"auto"),";padding:").concat(f.pt(0)," ").concat(f.pr(0)," ").concat(f.pb(0)," ").concat(f.pl(0),";margin:").concat(f.mt(0)," ").concat(f.mr(0)," ").concat(f.mb(0)," ").concat(f.ml(0),";}"))))}vf.defaultProps=d8;vf.displayName="GeistTable";vf.Column=mf;var ys=oi(vf);ys.Column=mf;var f8=["children","tag","className","type"],_8={type:"default",className:""},p8=function(e,t){var i={default:"inherit",secondary:t.secondary,success:t.success,warning:t.warning,error:t.error};return i[e]||i.default},Ef=function(e){var t=e.children,i=e.tag,r=e.className,s=e.type,a=pt(e,f8),l=i,o=Lt(),c=$t(),u=c.SCALES,h=c.getScaleProps,d=h("font"),f=h(["margin","marginLeft","marginRight","mx","ml","mr"]),_=h(["margin","marginTop","marginBottom","my","mt","mb"]),p=h(["padding","paddingLeft","paddingRight","pl","pr","px"]),v=h(["padding","paddingTop","paddingBottom","pt","pb","py"]),E=S.useMemo(function(){return p8(s,o.palette)},[s,o.palette]),g=S.useMemo(function(){var m=[{value:f,className:"mx"},{value:_,className:"my"},{value:p,className:"px"},{value:v,className:"py"},{value:d,className:"font"}],y=m.reduce(function(T,b){return typeof b.value>"u"?T:"".concat(T," ").concat(b.className)},"");return"".concat(y," ").concat(r).trim()},[f,_,p,v,d,r]);return k.createElement(l,Ge({},a,{className:Q.dynamic([["3155699851",[i,E,u.width(1,"auto"),u.height(1,"auto"),u.font(1,"inherit"),u.ml(0,"revert"),u.mr(0,"revert"),u.mt(0,"revert"),u.mb(0,"revert"),u.pl(0,"revert"),u.pr(0,"revert"),u.pt(0,"revert"),u.pb(0,"revert")]]])+" "+(a&&a.className!=null&&a.className||g||"")}),t,k.createElement(Q,{id:"3155699851",dynamic:[i,E,u.width(1,"auto"),u.height(1,"auto"),u.font(1,"inherit"),u.ml(0,"revert"),u.mr(0,"revert"),u.mt(0,"revert"),u.mb(0,"revert"),u.pl(0,"revert"),u.pr(0,"revert"),u.pt(0,"revert"),u.pb(0,"revert")]},"".concat(i,".__jsx-style-dynamic-selector{color:").concat(E,";width:").concat(u.width(1,"auto"),";height:").concat(u.height(1,"auto"),";}.font.__jsx-style-dynamic-selector{font-size:").concat(u.font(1,"inherit"),";}.mx.__jsx-style-dynamic-selector{margin-left:").concat(u.ml(0,"revert"),";margin-right:").concat(u.mr(0,"revert"),";}.my.__jsx-style-dynamic-selector{margin-top:").concat(u.mt(0,"revert"),";margin-bottom:").concat(u.mb(0,"revert"),";}.px.__jsx-style-dynamic-selector{padding-left:").concat(u.pl(0,"revert"),";padding-right:").concat(u.pr(0,"revert"),";}.py.__jsx-style-dynamic-selector{padding-top:").concat(u.pt(0,"revert"),";padding-bottom:").concat(u.pb(0,"revert"),";}")))};Ef.defaultProps=_8;Ef.displayName="GeistTextChild";var g8=["h1","h2","h3","h4","h5","h6","p","b","small","i","span","del","em","blockquote","children","className"],m8={h1:!1,h2:!1,h3:!1,h4:!1,h5:!1,h6:!1,p:!1,b:!1,small:!1,i:!1,span:!1,del:!1,em:!1,blockquote:!1,className:"",type:"default"},v8=function n(e,t){if(!e.length)return t;var i=e.slice(1,e.length);return k.createElement(Ef,{tag:e[0]},n(i,t))},r0=function(e){var t=e.h1,i=e.h2,r=e.h3,s=e.h4,a=e.h5,l=e.h6,o=e.p,c=e.b,u=e.small,h=e.i,d=e.span,f=e.del,_=e.em,p=e.blockquote,v=e.children,E=e.className,g=pt(e,g8),m={h1:t,h2:i,h3:r,h4:s,h5:a,h6:l,p:o,blockquote:p},y={span:d,small:u,b:c,em:_,i:h,del:f},T=Object.keys(m).filter(function(P){return m[P]}),b=Object.keys(y).filter(function(P){return y[P]}),C=S.useMemo(function(){return T[0]?T[0]:b[0]?b[0]:"p"},[T,b]),M=b.filter(function(P){return P!==C}),F=S.useMemo(function(){return M.length?v8(M,v):v},[M,v]);return k.createElement(Ef,Ge({className:E,tag:C},g),F)};r0.defaultProps=m8;r0.displayName="GeistText";var Ru=oi(r0),E8={width:22,height:22},n0=function(e){var t=e.color,i=e.width,r=e.height,s=Lt();return k.createElement("svg",{viewBox:"0 0 24 24",width:i,height:r,stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",shapeRendering:"geometricPrecision",className:Q.dynamic([["4043754792",[t||s.palette.accents_8]]])},k.createElement("path",{d:"M13 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V9z",className:Q.dynamic([["4043754792",[t||s.palette.accents_8]]])}),k.createElement("path",{d:"M13 2v7h7",className:Q.dynamic([["4043754792",[t||s.palette.accents_8]]])}),k.createElement(Q,{id:"4043754792",dynamic:[t||s.palette.accents_8]},"svg.__jsx-style-dynamic-selector{color:".concat(t||s.palette.accents_8,";}")))};n0.defaultProps=E8;n0.displayName="GeistTreeFileIcon";var y8={initialExpand:!1,isImperative:!1},pA=k.createContext(y8),gA=function(){return k.useContext(pA)},mA=function(e){var t=e.count;return t===0?null:k.createElement(k.Fragment,null,Nv(new Array(t)).map(function(i,r){return k.createElement("span",{key:"indent-".concat(r),className:Q.dynamic([["2622387629",[r+1]]])+" indent"},k.createElement(Q,{id:"2622387629",dynamic:[r+1]},"span.indent.__jsx-style-dynamic-selector{left:calc(-1.875rem * ".concat(r+1," + 0.75rem);}")))}))},vA=function(e,t){return k.Children.toArray(e).sort(function(i,r){return!k.isValidElement(i)||!k.isValidElement(r)?0:i.type!==r.type?i.type!==t?1:-1:"".concat(i.props.name).charCodeAt(0)-"".concat(r.props.name).charCodeAt(0)})},EA=function(e,t){return t?"".concat(t,"/").concat(e):e},yA=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},T8=["name","parentPath","level","extra","className"],b8={level:0,className:"",parentPath:""},Gu=function(e){var t=e.name,i=e.parentPath,r=e.level,s=e.extra,a=e.className,l=pt(e,T8),o=Lt(),c=gA(),u=c.onFileClick,h=S.useMemo(function(){return EA(t,i)},[]),d=function(_){yA(_),u&&u(h)};return k.createElement("div",Ge({onClick:d},l,{className:Q.dynamic([["4220802947",[r,o.palette.accents_2,o.palette.accents_8,o.palette.accents_5]]])+" "+(l&&l.className!=null&&l.className||Ut("file",a)||"")}),k.createElement("div",{className:Q.dynamic([["4220802947",[r,o.palette.accents_2,o.palette.accents_8,o.palette.accents_5]]])+" names"},k.createElement(mA,{count:r}),k.createElement("span",{className:Q.dynamic([["4220802947",[r,o.palette.accents_2,o.palette.accents_8,o.palette.accents_5]]])+" icon"},k.createElement(n0,null)),k.createElement("span",{className:Q.dynamic([["4220802947",[r,o.palette.accents_2,o.palette.accents_8,o.palette.accents_5]]])+" name"},t,s&&k.createElement("span",{className:Q.dynamic([["4220802947",[r,o.palette.accents_2,o.palette.accents_8,o.palette.accents_5]]])+" extra"},s))),k.createElement(Q,{id:"4220802947",dynamic:[r,o.palette.accents_2,o.palette.accents_8,o.palette.accents_5]},".file.__jsx-style-dynamic-selector{cursor:pointer;line-height:1;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin-left:calc(1.875rem * ".concat(r,");}.names.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:1.75rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;}.names.__jsx-style-dynamic-selector>.indent{position:absolute;top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);width:1px;height:100%;background-color:").concat(o.palette.accents_2,";margin-left:-1px;}.icon.__jsx-style-dynamic-selector{width:1.5rem;height:100%;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-right:0.5rem;}.name.__jsx-style-dynamic-selector{-webkit-transition:opacity 100ms ease 0ms;transition:opacity 100ms ease 0ms;color:").concat(o.palette.accents_8,";white-space:nowrap;font-size:0.875rem;}.extra.__jsx-style-dynamic-selector{font-size:0.75rem;-webkit-align-self:baseline;-ms-flex-item-align:baseline;align-self:baseline;padding-left:4px;color:").concat(o.palette.accents_5,";}.name.__jsx-style-dynamic-selector:hover{opacity:0.7;}")))};Gu.defaultProps=b8;Gu.displayName="GeistTreeFile";var C8={width:22,height:22},s0=function(e){var t=e.color,i=e.width,r=e.height,s=Lt();return k.createElement("svg",{viewBox:"0 0 24 24",width:i,height:r,stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",shapeRendering:"geometricPrecision",className:Q.dynamic([["4043754792",[t||s.palette.accents_8]]])},k.createElement("path",{d:"M2.707 7.454V5.62C2.707 4.725 3.469 4 4.409 4h4.843c.451 0 .884.17 1.204.474l.49.467c.126.12.296.186.473.186h8.399c.94 0 1.55.695 1.55 1.59v.737m-18.661 0h-.354a.344.344 0 00-.353.35l.508 11.587c.015.34.31.609.668.609h17.283c.358 0 .652-.269.667-.61L22 7.805a.344.344 0 00-.353-.35h-.278m-18.662 0h18.662",className:Q.dynamic([["4043754792",[t||s.palette.accents_8]]])}),k.createElement(Q,{id:"4043754792",dynamic:[t||s.palette.accents_8]},"svg.__jsx-style-dynamic-selector{color:".concat(t||s.palette.accents_8,";}")))};s0.defaultProps=C8;s0.displayName="GeistTreeFolderIcon";var A8={width:12,height:12,active:!1},a0=function(e){var t=e.color,i=e.width,r=e.height,s=e.active,a=Lt();return k.createElement("svg",{viewBox:"0 0 24 24",width:i,height:r,stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",shapeRendering:"geometricPrecision",className:Q.dynamic([["4043754792",[t||a.palette.accents_8]]])},k.createElement("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2",className:Q.dynamic([["4043754792",[t||a.palette.accents_8]]])}),!s&&k.createElement("path",{d:"M12 8v8",className:Q.dynamic([["4043754792",[t||a.palette.accents_8]]])}),k.createElement("path",{d:"M8 12h8",className:Q.dynamic([["4043754792",[t||a.palette.accents_8]]])}),k.createElement(Q,{id:"4043754792",dynamic:[t||a.palette.accents_8]},"svg.__jsx-style-dynamic-selector{color:".concat(t||a.palette.accents_8,";}")))};a0.defaultProps=A8;a0.displayName="GeistTreeStatusIcon";var S8=["name","children","parentPath","level","extra","className"],R8={level:0,className:"",parentPath:""},Wu=function n(e){var t=e.name,i=e.children,r=e.parentPath,s=e.level,a=e.extra,l=e.className,o=pt(e,S8),c=Lt(),u=gA(),h=u.initialExpand,d=u.isImperative,f=S.useState(h),_=yt(f,2),p=_[0],v=_[1];S.useEffect(function(){return v(h)},[]);var E=S.useMemo(function(){return EA(t,r)},[]),g=function(){return v(!p)},m=pk(i,{parentPath:E,level:s+1},[n,Gu]),y=d?m:vA(m,n);return k.createElement("div",Ge({onClick:g},o,{className:Q.dynamic([["1983983326",[s,c.palette.accents_2,c.palette.background,c.palette.accents_8,c.palette.accents_5]]])+" "+(o&&o.className!=null&&o.className||Ut("folder",l)||"")}),k.createElement("div",{className:Q.dynamic([["1983983326",[s,c.palette.accents_2,c.palette.background,c.palette.accents_8,c.palette.accents_5]]])+" names"},k.createElement(mA,{count:s}),k.createElement("span",{className:Q.dynamic([["1983983326",[s,c.palette.accents_2,c.palette.background,c.palette.accents_8,c.palette.accents_5]]])+" status"},k.createElement(a0,{active:p})),k.createElement("span",{className:Q.dynamic([["1983983326",[s,c.palette.accents_2,c.palette.background,c.palette.accents_8,c.palette.accents_5]]])+" icon"},k.createElement(s0,null)),k.createElement("span",{className:Q.dynamic([["1983983326",[s,c.palette.accents_2,c.palette.background,c.palette.accents_8,c.palette.accents_5]]])+" name"},t,a&&k.createElement("span",{className:Q.dynamic([["1983983326",[s,c.palette.accents_2,c.palette.background,c.palette.accents_8,c.palette.accents_5]]])+" extra"},a))),k.createElement(Fv,{isExpanded:p},k.createElement("div",{onClick:yA,className:Q.dynamic([["1983983326",[s,c.palette.accents_2,c.palette.background,c.palette.accents_8,c.palette.accents_5]]])+" content"},y)),k.createElement(Q,{id:"1983983326",dynamic:[s,c.palette.accents_2,c.palette.background,c.palette.accents_8,c.palette.accents_5]},".folder.__jsx-style-dynamic-selector{cursor:pointer;line-height:1;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.names.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:1.75rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-left:calc(1.875rem * ".concat(s,");position:relative;}.names.__jsx-style-dynamic-selector>.indent{position:absolute;top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);width:1px;height:100%;background-color:").concat(c.palette.accents_2,";margin-left:-1px;}.status.__jsx-style-dynamic-selector{position:absolute;left:calc(-1.125rem);top:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:0.875rem;height:0.875rem;z-index:10;background-color:").concat(c.palette.background,";}.icon.__jsx-style-dynamic-selector{width:1.5rem;height:100%;margin-right:0.5rem;}.status.__jsx-style-dynamic-selector,.icon.__jsx-style-dynamic-selector{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}.name.__jsx-style-dynamic-selector{-webkit-transition:opacity 100ms ease 0ms;transition:opacity 100ms ease 0ms;color:").concat(c.palette.accents_8,";white-space:nowrap;font-size:0.875rem;}.extra.__jsx-style-dynamic-selector{font-size:0.75rem;-webkit-align-self:baseline;-ms-flex-item-align:baseline;align-self:baseline;padding-left:4px;color:").concat(c.palette.accents_5,";}.name.__jsx-style-dynamic-selector:hover{opacity:0.7;}.content.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:auto;}")))};Wu.defaultProps=R8;Wu.displayName="GeistTreeFolder";var x8=["children","onClick","initialExpand","value","className"],M8=Wn("directory","file"),Ty=M8[0],I8={initialExpand:!1,className:""},P8=function n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return!e||!e.length?null:e.sort(function(t,i){return t.type!==i.type?t.type!==Ty?1:-1:"".concat(t.name).charCodeAt(0)-"".concat(i.name).charCodeAt(0)}).map(function(t,i){return t.type===Ty?k.createElement(Wu,{name:t.name,extra:t.extra,key:"folder-".concat(t.name,"-").concat(i)},n(t.files)):k.createElement(Gu,{name:t.name,extra:t.extra,key:"file-".concat(t.name,"-").concat(i)})})},Hu=function(e){var t=e.children,i=e.onClick,r=e.initialExpand,s=e.value,a=e.className,l=pt(e,x8),o=!!(s&&s.length>0),c=function(f){i&&i(f)},u=S.useMemo(function(){return{onFileClick:c,initialExpand:r,isImperative:o}},[r]),h=o?P8(s):vA(t,Wu);return k.createElement(pA.Provider,{value:u},k.createElement("div",Ge({},l,{className:"jsx-2273069862 "+(l&&l.className!=null&&l.className||Ut("tree",a)||"")}),h,k.createElement(Q,{id:"2273069862"},".tree.jsx-2273069862{padding-left:1.625rem;}")))};Hu.defaultProps=I8;Hu.displayName="GeistTree";Hu.File=Gu;Hu.Folder=Wu;const{flushToHTML:w8}=xm;var O8=function(e){var t=e.children,i=Lt();return k.createElement(k.Fragment,null,t,k.createElement(Q,{id:"1357910706",dynamic:[i.palette.background,i.palette.foreground,i.palette.background,i.font.sans,i.font.sans,i.palette.link,i.expressiveness.linkStyle,i.expressiveness.linkHoverStyle,i.layout.gapHalf,i.layout.gapHalf,i.layout.gapHalf,i.layout.gap,i.palette.foreground,i.palette.accents_4,i.palette.code,i.font.mono,i.layout.gap,i.layout.gap,i.layout.gap,i.palette.accents_2,i.layout.radius,i.font.mono,i.palette.foreground,i.palette.accents_2,i.palette.accents_1,i.layout.gap,i.layout.gap,i.palette.accents_5,i.palette.accents_1,i.layout.radius,i.palette.border,i.palette.selection,i.palette.foreground]},"html,body{background-color:".concat(i.palette.background,";color:").concat(i.palette.foreground,";}html{font-size:16px;--geist-icons-background:").concat(i.palette.background,";}body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.5;margin:0;padding:0;min-height:100%;position:relative;overflow-x:hidden;font-family:").concat(i.font.sans,";}#__next{overflow-x:hidden;}*,*:before,*:after{box-sizing:inherit;text-rendering:geometricPrecision;-webkit-tap-highlight-color:transparent;}p,small{font-weight:400;color:inherit;-webkit-letter-spacing:-0.005625em;-moz-letter-spacing:-0.005625em;-ms-letter-spacing:-0.005625em;letter-spacing:-0.005625em;font-family:").concat(i.font.sans,";}p{margin:1em 0;font-size:1em;line-height:1.625em;}small{margin:0;line-height:1.5;font-size:0.875em;}b{font-weight:600;}span{font-size:inherit;color:inherit;font-weight:inherit;}img{max-width:100%;}a{cursor:pointer;font-size:inherit;-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-box-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:").concat(i.palette.link,";-webkit-text-decoration:").concat(i.expressiveness.linkStyle,";text-decoration:").concat(i.expressiveness.linkStyle,";}a:hover{-webkit-text-decoration:").concat(i.expressiveness.linkHoverStyle,";text-decoration:").concat(i.expressiveness.linkHoverStyle,";}ul,ol{padding:0;list-style-type:none;margin:").concat(i.layout.gapHalf," ").concat(i.layout.gapHalf," ").concat(i.layout.gapHalf," ").concat(i.layout.gap,";color:").concat(i.palette.foreground,";}ol{list-style-type:decimal;}li{margin-bottom:0.625em;font-size:1em;line-height:1.625em;}ul li:before{content:'';display:inline-block;color:").concat(i.palette.accents_4,";position:absolute;margin-left:-0.9375em;}h1,h2,h3,h4,h5,h6{color:inherit;margin:0 0 0.7rem 0;}h1{font-size:3rem;-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;line-height:1.5;font-weight:700;}h2{font-size:2.25rem;-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;font-weight:600;}h3{font-size:1.5rem;-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;font-weight:600;}h4{font-size:1.25rem;-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;font-weight:600;}h5{font-size:1rem;-webkit-letter-spacing:-0.01em;-moz-letter-spacing:-0.01em;-ms-letter-spacing:-0.01em;letter-spacing:-0.01em;font-weight:600;}h6{font-size:0.875rem;-webkit-letter-spacing:-0.005em;-moz-letter-spacing:-0.005em;-ms-letter-spacing:-0.005em;letter-spacing:-0.005em;font-weight:600;}button,input,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit;color:inherit;margin:0;}button:focus,input:focus,select:focus,textarea:focus{outline:none;}code{color:").concat(i.palette.code,";font-family:").concat(i.font.mono,";font-size:0.9em;white-space:pre-wrap;}code:before,code:after{content:'\\`';}pre{padding:calc(").concat(i.layout.gap," * 0.9) ").concat(i.layout.gap,";margin:").concat(i.layout.gap," 0;border:1px solid ").concat(i.palette.accents_2,";border-radius:").concat(i.layout.radius,";font-family:").concat(i.font.mono,";white-space:pre;overflow:auto;line-height:1.5;text-align:left;font-size:14px;-webkit-overflow-scrolling:touch;}pre code{color:").concat(i.palette.foreground,";font-size:1em;line-height:1.25em;white-space:pre;}pre code:before,pre code:after{display:none;}pre p{margin:0;}pre::-webkit-scrollbar{display:none;width:0;height:0;background:transparent;}hr{border-color:").concat(i.palette.accents_2,";}details{background-color:").concat(i.palette.accents_1,";border:none;}details:focus,details:hover,details:active{outline:none;}summary{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;list-style:none;outline:none;}summary::marker,summary::before,summary::-webkit-details-marker{display:none;}summary::-moz-list-bullet{font-size:0;}summary:focus,summary:hover,summary:active{outline:none;list-style:none;}blockquote{padding:calc(0.667 * ").concat(i.layout.gap,") ").concat(i.layout.gap,";color:").concat(i.palette.accents_5,";background-color:").concat(i.palette.accents_1,";border-radius:").concat(i.layout.radius,";margin:1.5em 0;border:1px solid ").concat(i.palette.border,";}blockquote *:first-child{margin-top:0;}blockquote *:last-child{margin-bottom:0;}::selection{background-color:").concat(i.palette.selection,";color:").concat(i.palette.foreground,";}")))},o0=k.memo(O8);o0.flush=xm;o0.flushToHTML=w8;var xg={},by=nc;xg.createRoot=by.createRoot,xg.hydrateRoot=by.hydrateRoot;var ju=(n=>(n.Exe="Exe",n.PackedAsset="PackedAsset",n.Texture="Texture",n.Model="Model",n.Palette="Palette",n))(ju||{});class l0{constructor(e){ge(this,"_fileHandle");ge(this,"buffer");this._fileHandle=e}get name(){return this._fileHandle.name}static async make(...e){const t=new this(...e),i=performance.now();return await t._init(),console.info(`${t.name}: ${performance.now()-i}ms`),t}async _init(){return this.read()}async read(){const e=await this._fileHandle.getFile();this.buffer=await e.arrayBuffer()}}var Vs=(n=>(n.Texture="Texture",n.Model="Model",n))(Vs||{});class TA extends l0{constructor(){super(...arguments);ge(this,"fileType",ju.PackedAsset)}}const D8=316416,L8=4517888;class bl extends l0{constructor(){super(...arguments);ge(this,"fileType",ju.Exe)}static toRawAddr(t){const i=t-L8+D8;return i<0&&console.warn(`Invalid virtual address 0x${t.toString(16)}`),i}}var Ld=(n=>(n.Directory="directory",n.File="file",n))(Ld||{});const N8="modulepreload",F8=function(n){return"/"+n},Cy={},Wr=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));r=Promise.all(t.map(l=>{if(l=F8(l),l in Cy)return;Cy[l]=!0;const o=l.endsWith(".css"),c=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":N8,o||(u.as="script",u.crossOrigin=""),u.href=l,a&&u.setAttribute("nonce",a),document.head.appendChild(u),o)return new Promise((h,d)=>{u.addEventListener("load",h),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${l}`)))})}))}return r.then(()=>e()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})},Ay=globalThis.showDirectoryPicker;async function k8(n={}){if(Ay&&!n._preferPolyfill)return Ay(n);const e=document.createElement("input");e.type="file",e.webkitdirectory=!0,e.multiple=!0,e.style.position="fixed",e.style.top="-100000px",e.style.left="-100000px",document.body.appendChild(e);const t=Wr(()=>Promise.resolve().then(()=>H8),void 0);return await new Promise(i=>{e.addEventListener("change",i),e.click()}),t.then(i=>i.getDirHandlesFromInput(e))}globalThis.DataTransferItem&&!DataTransferItem.prototype.getAsFileSystemHandle&&(DataTransferItem.prototype.getAsFileSystemHandle=async function(){const n=this.webkitGetAsEntry(),[{FileHandle:e,FolderHandle:t},{FileSystemDirectoryHandle:i},{FileSystemFileHandle:r}]=await Promise.all([Wr(()=>import("./sandbox-hERovsTM.js"),[]),Wr(()=>Promise.resolve().then(()=>h0),void 0),Wr(()=>Promise.resolve().then(()=>eu),void 0)]);return n.isFile?new r(new e(n,!1)):new i(new t(n,!1))});const B8={ReadableStream:globalThis.ReadableStream,WritableStream:globalThis.WritableStream,TransformStream:globalThis.TransformStream,DOMException:globalThis.DOMException,Blob:globalThis.Blob,File:globalThis.File},{WritableStream:U8}=B8;var Xd;const k0=class k0 extends U8{constructor(t){super(t);B0(this,Xd,void 0);U0(this,Xd,t),Object.setPrototypeOf(this,k0.prototype),this._closed=!1}async close(){this._closed=!0;const t=this.getWriter(),i=t.close();return t.releaseLock(),i}seek(t){return this.write({type:"seek",position:t})}truncate(t){return this.write({type:"truncate",size:t})}write(t){if(this._closed)return Promise.reject(new TypeError("Cannot write to a CLOSED writable stream"));const i=this.getWriter(),r=i.write(t);return i.releaseLock(),r}};Xd=new WeakMap;let Oo=k0;Object.defineProperty(Oo.prototype,Symbol.toStringTag,{value:"FileSystemWritableFileStream",writable:!1,enumerable:!1,configurable:!0});Object.defineProperties(Oo.prototype,{close:{enumerable:!0},seek:{enumerable:!0},truncate:{enumerable:!0},write:{enumerable:!0}});globalThis.FileSystemFileHandle&&!globalThis.FileSystemFileHandle.prototype.createWritable&&!globalThis.FileSystemWritableFileStream&&(globalThis.FileSystemWritableFileStream=Oo);const aa=Symbol("adapter");var VX;class c0{constructor(e){ge(this,VX);ge(this,"name");ge(this,"kind");this.kind=e.kind,this.name=e.name,this[aa]=e}async queryPermission(e={}){const{mode:t="read"}=e,i=this[aa];if(i.queryPermission)return i.queryPermission({mode:t});if(t==="read")return"granted";if(t==="readwrite")return i.writable?"granted":"denied";throw new TypeError(`Mode ${t} must be 'read' or 'readwrite'`)}async requestPermission({mode:e="read"}={}){const t=this[aa];if(t.requestPermission)return t.requestPermission({mode:e});if(e==="read")return"granted";if(e==="readwrite")return t.writable?"granted":"denied";throw new TypeError(`Mode ${e} must be 'read' or 'readwrite'`)}async remove(e={}){await this[aa].remove(e)}async isSameEntry(e){return this===e?!0:!e||typeof e!="object"||this.kind!==e.kind||!e[aa]?!1:this[aa].isSameEntry(e[aa])}}VX=aa;Object.defineProperty(c0.prototype,Symbol.toStringTag,{value:"FileSystemHandle",writable:!1,enumerable:!1,configurable:!0});var BT;globalThis.FileSystemHandle&&((BT=globalThis.FileSystemHandle.prototype).queryPermission??(BT.queryPermission=function(n){return"granted"}));const u0={INVALID:["seeking position failed.","InvalidStateError"],GONE:["A requested file or directory could not be found at the time an operation was processed.","NotFoundError"],MISMATCH:["The path supplied exists, but was not an entry of requested type.","TypeMismatchError"],MOD_ERR:["The object can not be modified in this way.","InvalidModificationError"],SYNTAX:n=>[`Failed to execute 'write' on 'UnderlyingSinkBase': Invalid params passed. ${n}`,"SyntaxError"],SECURITY:["It was determined that certain files are unsafe for access within a Web application, or that too many calls are being made on file resources.","SecurityError"],DISALLOWED:["The request is not allowed by the user agent or the platform in the current context.","NotAllowedError"]},z8={writable:globalThis.WritableStream};async function V8(n){console.warn("deprecated fromDataTransfer - use `dt.items[0].getAsFileSystemHandle()` instead");const[e,t,i]=await Promise.all([Wr(()=>import("./memory-xvIOVgxt.js"),[]),Wr(()=>import("./sandbox-hERovsTM.js"),[]),Wr(()=>Promise.resolve().then(()=>h0),void 0)]),r=new e.FolderHandle("",!1);return r._entries=n.map(s=>s.isFile?new t.FileHandle(s,!1):new t.FolderHandle(s,!1)),new i.FileSystemDirectoryHandle(r)}async function G8(n){const{FolderHandle:e,FileHandle:t}=await Wr(()=>import("./memory-xvIOVgxt.js"),[]),{FileSystemDirectoryHandle:i}=await Wr(()=>Promise.resolve().then(()=>h0),void 0),r=Array.from(n.files),s=r[0].webkitRelativePath.split("/",1)[0],a=new e(s,!1);return r.forEach(l=>{const o=l.webkitRelativePath.split("/");o.shift();const c=o.pop(),u=o.reduce((h,d)=>(h._entries[d]||(h._entries[d]=new e(d,!1)),h._entries[d]),a);u._entries[c]=new t(l.name,l,!1)}),new i(a)}async function W8(n){const{FileHandle:e}=await Wr(()=>import("./memory-xvIOVgxt.js"),[]),{FileSystemFileHandle:t}=await Wr(()=>Promise.resolve().then(()=>eu),void 0);return Array.from(n.files).map(i=>new t(new e(i.name,i,!1)))}const H8=Object.freeze(Object.defineProperty({__proto__:null,config:z8,errors:u0,fromDataTransfer:V8,getDirHandlesFromInput:G8,getFileHandlesFromInput:W8},Symbol.toStringTag,{value:"Module"})),{GONE:j8,MOD_ERR:X8}=u0,oa=Symbol("adapter");var GX;let Nd=class Xh extends c0{constructor(t){super(t);ge(this,GX);this[oa]=t}async getDirectoryHandle(t,i={}){if(t==="")throw new TypeError("Name can't be an empty string.");if(t==="."||t===".."||t.includes("/"))throw new TypeError("Name contains invalid characters.");i.create=!!i.create;const r=await this[oa].getDirectoryHandle(t,i);return new Xh(r)}async*entries(){const{FileSystemFileHandle:t}=await Wr(()=>Promise.resolve().then(()=>eu),void 0);for await(const[i,r]of this[oa].entries())yield[r.name,r.kind==="file"?new t(r):new Xh(r)]}async*getEntries(){const{FileSystemFileHandle:t}=await Wr(()=>Promise.resolve().then(()=>eu),void 0);console.warn("deprecated, use .entries() instead");for await(let i of this[oa].entries())yield i.kind==="file"?new t(i):new Xh(i)}async getFileHandle(t,i={}){const{FileSystemFileHandle:r}=await Wr(()=>Promise.resolve().then(()=>eu),void 0);if(t==="")throw new TypeError("Name can't be an empty string.");if(t==="."||t===".."||t.includes("/"))throw new TypeError("Name contains invalid characters.");i.create=!!i.create;const s=await this[oa].getFileHandle(t,i);return new r(s)}async removeEntry(t,i={}){if(t==="")throw new TypeError("Name can't be an empty string.");if(t==="."||t===".."||t.includes("/"))throw new TypeError("Name contains invalid characters.");return i.recursive=!!i.recursive,this[oa].removeEntry(t,i)}async resolve(t){if(await t.isSameEntry(this))return[];const i=[{handle:this,path:[]}];for(;i.length;){let{handle:r,path:s}=i.pop();for await(const a of r.values()){if(await a.isSameEntry(t))return[...s,a.name];a.kind==="directory"&&i.push({handle:a,path:[...s,a.name]})}}return null}async*keys(){for await(const[t]of this[oa].entries())yield t}async*values(){for await(const[t,i]of this)yield i}[(GX=oa,Symbol.asyncIterator)](){return this.entries()}};Object.defineProperty(Nd.prototype,Symbol.toStringTag,{value:"FileSystemDirectoryHandle",writable:!1,enumerable:!1,configurable:!0});Object.defineProperties(Nd.prototype,{getDirectoryHandle:{enumerable:!0},entries:{enumerable:!0},getFileHandle:{enumerable:!0},removeEntry:{enumerable:!0}});if(globalThis.FileSystemDirectoryHandle){const n=globalThis.FileSystemDirectoryHandle.prototype;n.resolve=async function(s){if(await s.isSameEntry(this))return[];const a=[{handle:this,path:[]}];for(;a.length;){let{handle:l,path:o}=a.pop();for await(const c of l.values()){if(await c.isSameEntry(s))return[...o,c.name];c.kind==="directory"&&a.push({handle:c,path:[...o,c.name]})}}return null};async function e(r){if(await(await navigator.storage.getDirectory()).resolve(r)===null)throw new DOMException(...j8)}const t=n.entries;n.entries=async function*(){await e(this),yield*t.call(this)},n[Symbol.asyncIterator]=async function*(){yield*this.entries()};const i=n.removeEntry;n.removeEntry=async function(r,s={}){return i.call(this,r,s).catch(async a=>{throw a instanceof DOMException&&a.name==="UnknownError"&&!s.recursive&&!(await t.call(this).next()).done?new DOMException(...X8):a})}}const h0=Object.freeze(Object.defineProperty({__proto__:null,FileSystemDirectoryHandle:Nd,default:Nd},Symbol.toStringTag,{value:"Module"})),{INVALID:Y8,SYNTAX:np,GONE:K8}=u0,Sh=Symbol("adapter");var WX;class Fd extends c0{constructor(t){super(t);ge(this,WX);this[Sh]=t}async createWritable(t={}){return new Oo(await this[Sh].createWritable(t))}async getFile(){return this[Sh].getFile()}}WX=Sh;Object.defineProperty(Fd.prototype,Symbol.toStringTag,{value:"FileSystemFileHandle",writable:!1,enumerable:!1,configurable:!0});Object.defineProperties(Fd.prototype,{createWritable:{enumerable:!0},getFile:{enumerable:!0}});if(globalThis.FileSystemFileHandle&&!globalThis.FileSystemFileHandle.prototype.createWritable){const n=new WeakMap;let e;const t=()=>{let r,s;onmessage=async a=>{const l=a.ports[0],o=a.data;switch(o.type){case"open":const c=o.name;let u=await navigator.storage.getDirectory();for(const h of o.path)u=await u.getDirectoryHandle(h);r=await u.getFileHandle(c),s=await r.createSyncAccessHandle();break;case"write":s.write(o.data,{at:o.position}),s.flush();break;case"truncate":s.truncate(o.size);break;case"abort":case"close":s.close();break}l.postMessage(0)}};globalThis.FileSystemFileHandle.prototype.createWritable=async function(r){if(!e){const _=`(${t.toString()})()`,p=new Blob([_],{type:"text/javascript"});e=URL.createObjectURL(p)}const s=new Worker(e,{type:"module"});let a=0;const l=new TextEncoder;let o=await this.getFile().then(_=>_.size);const c=_=>new Promise((p,v)=>{const E=new MessageChannel;E.port1.onmessage=g=>{g.data instanceof Error?v(g.data):p(g.data),E.port1.close(),E.port2.close(),E.port1.onmessage=null},s.postMessage(_,[E.port2])}),u=await navigator.storage.getDirectory(),h=await n.get(this),d=await u.resolve(h);if(d===null)throw new DOMException(...K8);return await c({type:"open",path:d,name:this.name}),(r==null?void 0:r.keepExistingData)===!1&&(await c({type:"truncate",size:0}),o=0),new Oo({start:_=>{},async write(_){if((_==null?void 0:_.constructor)===Object?_={..._}:_={type:"write",data:_,position:a},_.type==="write"){if(!("data"in _))throw await c({type:"close"}),new DOMException(...np("write requires a data argument"));if(_.position??(_.position=a),typeof _.data=="string")_.data=l.encode(_.data);else if(_.data instanceof ArrayBuffer)_.data=new Uint8Array(_.data);else if(!(_.data instanceof Uint8Array)&&ArrayBuffer.isView(_.data))_.data=new Uint8Array(_.data.buffer,_.data.byteOffset,_.data.byteLength);else if(!(_.data instanceof Uint8Array)){const v=await new Response(_.data).arrayBuffer();_.data=new Uint8Array(v)}Number.isInteger(_.position)&&_.position>=0&&(a=_.position),a+=_.data.byteLength,o+=_.data.byteLength}else if(_.type==="seek")if(Number.isInteger(_.position)&&_.position>=0){if(o<_.position)throw new DOMException(...Y8);console.log("seeking",_),a=_.position;return}else throw await c({type:"close"}),new DOMException(...np("seek requires a position argument"));else if(_.type==="truncate")if(Number.isInteger(_.size)&&_.size>=0)o=_.size,a>o&&(a=o);else throw await c({type:"close"}),new DOMException(...np("truncate requires a size argument"));await c(_)},async close(){await c({type:"close"}),s.terminate()},async abort(_){await c({type:"abort",reason:_}),s.terminate()}})};const i=FileSystemDirectoryHandle.prototype.getFileHandle;FileSystemDirectoryHandle.prototype.getFileHandle=async function(...r){const s=await i.call(this,...r);return n.set(s,this),s}}const eu=Object.freeze(Object.defineProperty({__proto__:null,FileSystemFileHandle:Fd,default:Fd},Symbol.toStringTag,{value:"Module"})),q8=bl.toRawAddr(4558800),$8=24;class Q8{constructor(e){ge(this,"_exeFile");this._exeFile=e}async _makeTexture(e,t){const i=new DataView(this._exeFile.buffer),r=bl.toRawAddr(i.getUint32(t,!0)),s=bl.toRawAddr(i.getUint32(t+4,!0)),a=bl.toRawAddr(i.getUint32(t+8,!0)),l=i.getUint8(t+12),o=i.getUint8(t+13),c=bl.toRawAddr(i.getUint32(t+16,!0)),u=i.getAscii(r,12),h=i.getAscii(s,12);try{const[d,f]=await Promise.all([await e.getFileHandle(u),await e.getFileHandle(h)]),_=i.getUint32(c,!0),p=this._exeFile.buffer.sliceAt(a,xu.byteSize*_),v=await Mg.make(f);return s7.make(d,v,_,p,l,o)}catch(d){if((d==null?void 0:d.name)==="NotFoundError"){console.info(`Skipped ${u}: ${d}`);return}throw d}}async _makeTextures(e){const t=Object.keys(kd).length,i=new Map,r=[];for(let a=0;a<t;a++)r.push(this._makeTexture(e,q8+$8*a));const s=await Promise.all(r);for(const a of s)a&&i.set(a.name,a);return i}async _makeModels(e){const t=new Map;for(const i of Object.values(f0)){const r=await e.getFileHandle(i);t.set(i,await Z8.make(r))}return t}async build(e){const[t,i]=await Promise.all([this._makeTextures(e),this._makeModels(e)]);return{[Vs.Texture]:t,[Vs.Model]:i}}}const _a=class _a{constructor(e){ge(this,"_rootDir");ge(this,"_builder");ge(this,"assets");this._rootDir=e}static get isInitialized(){return!!_a._instance}static get(){if(!_a._instance)throw new Error("GameData has not been initialized! (did you call GameData.init() ?)");return _a._instance}static async init(){if(this._instance){console.warn("Ignored: GameData has already been initialized!");return}const e=await k8();_a._instance=new _a(e)}async build(e=this._rootDir){let t;for await(const r of e.values())if(r.kind==="directory"&&r.name==="BIN")t=r;else if(r.kind==="file"&&r.name==="PPJ2DD.EXE"){const s=await e.getFileHandle(r.name);this._builder=new Q8(await bl.make(s))}const i=performance.now();this.assets=await this._builder.build(t),console.info(`All done in ${performance.now()-i}ms`)}getFileStructure(){if(!this.assets)return[];const e=[];for(const t in this.assets){const i={type:Ld.Directory,name:t,children:[]};for(const r of this.assets[t].keys()){const s={type:Ld.File,name:r};i.children.push(s)}e.push(i)}return e}};ge(_a,"_instance");let ls=_a;class d0{constructor(e,t,i){ge(this,"r");ge(this,"g");ge(this,"b");this.r=e,this.g=t,this.b=i}static fromBGR555(e){const t=((e&31744)>>10)/31,i=((e&992)>>5)/31,r=(e&31)/31;return new d0(r,i,t)}toArray(){return[this.r,this.g,this.b]}}let bA=class{constructor(e,t,i,r){ge(this,"top");ge(this,"right");ge(this,"bottom");ge(this,"left");ge(this,"width");ge(this,"height");this.top=e,this.right=t,this.bottom=i,this.left=r,this.width=this.right-this.left,this.height=this.bottom-this.top}};class Sy{constructor(e,t,i){ge(this,"x");ge(this,"y");ge(this,"z");this.x=e,this.y=t,this.z=i}toArray(){return[this.x,this.y,this.z]}}class zc{static build(e,t,i){const r=e*this.headerByteSize;let s=new DataView(i,r);const a=s.getUint32(0,!0);if(!a)return;const l=s.getUint32(4,!0),o=s.getUint32(8,!0),c=s.getUint16(12,!0),u=s.getUint8(14),h=s.getUint8(15),d=(h&240)>>4,f=h&15;s=new DataView(i);const _=[];for(let v=0;v<c;v++){const E=a+v*this._bytesPerVertex;_.push(new Sy(s.getFloat32(E,!0),s.getFloat32(E+4,!0),s.getFloat32(E+8,!0)))}const p=[];for(let v=0;v<u;v++){const E=o+v*this._bytesPerMaterial,g=l+v*this._bytesPerFace,m=new e7(s.getUint8(E),s.getUint8(E+1),s.getUint8(E+2),s.getUint8(E+3),s.getUint8(E+5),s.getUint16(E+6,!0));p.push(new J8(v,s.getUint16(g,!0),s.getUint16(g+2,!0),s.getUint16(g+4,!0),s.getUint16(g+6,!0),new Sy(s.getFloat32(g+8,!0),s.getFloat32(g+12,!0),s.getFloat32(g+16,!0)),m))}return new t7(e,r,t,_,p,d,f)}}ge(zc,"headerByteSize",16),ge(zc,"_bytesPerVertex",12),ge(zc,"_bytesPerFace",20),ge(zc,"_bytesPerMaterial",10);var f0=(n=>(n.P_COMMON="P_COMMON.BIN",n.P_STG1C="P_STG1C.BIN",n.P_STG10="P_STG10.BIN",n.P_STG11="P_STG11.BIN",n.P_STG12="P_STG12.BIN",n.P_SEL="P_SEL.BIN",n.P_STG2C="P_STG2C.BIN",n.P_STG20="P_STG20.BIN",n.P_STG21="P_STG21.BIN",n.P_STG22="P_STG22.BIN",n.P_STG3C="P_STG3C.BIN",n.P_STG30="P_STG30.BIN",n.P_STG31="P_STG31.BIN",n.P_STG32="P_STG32.BIN",n.P_FANG="P_FANG.BIN",n.P_ADV="P_ADV.BIN",n.P_NAME="P_NAME.BIN",n.P_MINI_C="P_MINI_C.BIN",n))(f0||{});class Z8 extends TA{constructor(t){super(t);ge(this,"assetType",Vs.Model);ge(this,"isStage");ge(this,"models",[]);this.isStage=t.name.startsWith("P_STG")&&!t.name.endsWith("C.BIN")}async _init(){await super._init();let t=0;for(;;){const i=zc.build(t++,this,this.buffer);if(!i)break;this.models.push(i)}}getModel(t){return this.models[t]}}class J8{constructor(e,t,i,r,s,a,l){ge(this,"id");ge(this,"v1");ge(this,"v2");ge(this,"v3");ge(this,"v4");ge(this,"normal");ge(this,"material");this.id=e,this.v1=t,this.v2=i,this.v3=r,this.v4=s,this.normal=a,this.material=l}}var ll=(n=>(n[n.Texture=2]="Texture",n[n.Color=4]="Color",n[n.InvertX=16]="InvertX",n[n.InvertY=32]="InvertY",n[n.Enabled=64]="Enabled",n))(ll||{}),CA=(n=>(n[n.Transparent=1]="Transparent",n[n.Unknown=2]="Unknown",n[n.Unknown2=16]="Unknown2",n))(CA||{});class e7{constructor(e,t,i,r,s,a){ge(this,"_materialFlags");ge(this,"_renderFlags");ge(this,"_textureFlags");ge(this,"textureId");ge(this,"texturePackId");ge(this,"paletteId");ge(this,"color");ge(this,"colorData");this._materialFlags=e,this._textureFlags=t,this.textureId=i,this.texturePackId=r,this._renderFlags=s,this.colorData=a,this.hasMaterialFlag(2)?this.paletteId=a:this.color=d0.fromBGR555(a)}hasMaterialFlag(e){return!!(this._materialFlags&e)}hasRenderFlag(e){return!!(this._renderFlags&e)}textureOffset(){return this._textureFlags==4?0:1}}class t7{constructor(e,t,i,r,s,a,l){ge(this,"id");ge(this,"headerOffset");ge(this,"parent");ge(this,"vertices");ge(this,"faces");ge(this,"depth");ge(this,"unk");this.id=e,this.headerOffset=t,this.parent=i,this.vertices=r,this.faces=s,this.depth=a,this.unk=l}getTexturePack(e){if(e===0)return kd.T_COMMON;const t=this.parent.name;return this.parent.isStage&&(this.unk||this.depth)?`T_${t.substring(2,6)}C.BIN`:t===f0.P_SEL?kd.T_SELECT:`T_${t.substring(2)}`}}const pa=class pa extends l0{constructor(){super(...arguments);ge(this,"fileType",ju.Palette)}getPixels(t,i,r){const s=new Uint8ClampedArray(t.length*pa.bytesPerColor),a=new DataView(this.buffer,i*pa.pageSize);let l=0;for(const o of t){const c=o*pa.bytesPerColor;s[l]=a.getUint8(c),s[l+1]=a.getUint8(c+1),s[l+2]=a.getUint8(c+2),s[l+3]=r&&!c?a.getUint8(c+3):255,l+=pa.bytesPerColor}return s}};ge(pa,"pageSize",64),ge(pa,"bytesPerColor",4);let Mg=pa;class i7{constructor(e,t,i){ge(this,"fileType",ju.Texture);ge(this,"id");ge(this,"info");ge(this,"pixels");this.id=e,this.info=t,this.pixels=i}}var yf=(n=>(n[n.Alpha=2]="Alpha",n[n.UI=4]="UI",n))(yf||{});const Yd=class Yd{constructor(e,t){ge(this,"width");ge(this,"height");ge(this,"paletteOffset");ge(this,"_flags");const i=new DataView(e,t,Yd.byteSize);this.width=i.getUint16(0,!0),this.height=i.getUint16(2,!0),this.paletteOffset=i.getUint32(4,!0),this._flags=i.getUint32(12,!0)}hasFlag(e){return!!(this._flags&e)}};ge(Yd,"byteSize",16);let xu=Yd;class r7 extends Error{constructor(t){super(`Could not find texture with id ${t}`);ge(this,"name","TextureNotFoundError")}}class n7 extends Error{constructor(t){super(`Could not find tile with id ${t}`);ge(this,"name","TileNotFoundError")}}const Jn=class Jn{constructor(e){ge(this,"width",Jn.pageSize);ge(this,"height");ge(this,"byteSize");ge(this,"pageCount",0);ge(this,"tileCount",0);ge(this,"pixels");ge(this,"_sortedTextures");ge(this,"_tiles",new Map);this._sortedTextures=this._sortTextures(e),this._createTileMap(e),this.height=this.width*this.pageCount,this.byteSize=this.width*this.height*4,this.pixels=this._generatePixels(e)}_generatePixels(e){const t=new Uint8ClampedArray(this.byteSize);for(const i of this){const r=e[i.textureId];if(!r)throw new Error(`Could not find texture with id ${i.textureId}`);for(let s=0;s<r.info.height;s++){const a=Jn.pageSize*(i.rect.top+s);for(let l=0;l<r.info.width;l++){const o=i.rect.left+l,c=(a+o)*4,u=(s*r.info.width+l)*4;t[c]=r.pixels[u],t[c+1]=r.pixels[u+1],t[c+2]=r.pixels[u+2],t[c+3]=r.pixels[u+3]}}}return t}[Symbol.iterator](){return this._tiles.values()}getTile(e){const t=this._tiles.get(e);if(!t)throw new n7(e);return t}_sortTextures(e){const t=new Map;for(const i of e)i.info.hasFlag(yf.UI)||(t.has(i.info.width)||t.set(i.info.width,[]),t.get(i.info.width).push(i.id),this.tileCount++);return t}_createTileMap(e){let t=this.tileCount;const i=(r,s,a)=>{if(!(s.x>=a.width))for(;s.y<a.height&&t>0;){let l=a.width-s.x,o=0;for(;o<=0;){let c=[];for(;;){if(l<=0)return;const h=this._sortedTextures.get(l);if(h){c=h;break}l--}let u=s.y;for(const h of c){if(this._tiles.has(h))continue;const d=e[h];if(!d)throw new Error(`Cannot get texture with id ${h}`);if(d.info.height>a.height-u)continue;const f=r*Jn.pageSize+u;this._tiles.set(h,{textureId:h,rect:new bA(f,s.x+d.info.width,f+d.info.height,s.x)}),u+=d.info.height,t--,o++}if(o>0){i(r,{x:s.x+l,y:s.y},{width:a.width,height:u}),i(r,{x:s.x,y:u},a);break}else l--}if(r>this.pageCount&&(this.pageCount=r),s.x||s.y||a.width!=Jn.pageSize||a.height!=Jn.pageSize||t<=0)return;r++}};i(0,{x:0,y:0},{width:Jn.pageSize,height:Jn.pageSize})}};ge(Jn,"pageSize",256);let Ig=Jn;var kd=(n=>(n.T_COMMON="T_COMMON.BIN",n.T_STG1C="T_STG1C.BIN",n.T_STG10="T_STG10.BIN",n.T_STG11="T_STG11.BIN",n.T_STG12="T_STG12.BIN",n.T_OPTION="T_OPTION.BIN",n.T_SELECT="T_SELECT.BIN",n.T_STG2C="T_STG2C.BIN",n.T_STG20="T_STG20.BIN",n.T_STG21="T_STG21.BIN",n.T_STG22="T_STG22.BIN",n.T_STG3C="T_STG3C.BIN",n.T_STG30="T_STG30.BIN",n.T_STG31="T_STG31.BIN",n.T_STG32="T_STG32.BIN",n.T_FANG="T_FANG.BIN",n.T_ADV="T_ADV.BIN",n.T_NAME="T_NAME.BIN",n.T_LOGO="T_LOGO.BIN",n.T_TITLE="T_TITLE.BIN",n.T_MINI_C="T_MINI_C.BIN",n.T_RANK="T_RANK.BIN",n))(kd||{});class s7 extends TA{constructor(t,i,r,s,a,l){super(t);ge(this,"assetType",Vs.Texture);ge(this,"count");ge(this,"pageSize");ge(this,"pageOffset");ge(this,"_palette");ge(this,"_metadata");ge(this,"tileMap");ge(this,"textures",[]);this.count=r,this.pageSize=a,this.pageOffset=l,this._palette=i,this._metadata=s}async _init(){await super._init();let t=0;for(let i=0;i<this.count;i++){const r=new xu(this._metadata,xu.byteSize*i),s=r.width*r.height,a=this.buffer.sliceAt(t,s);t+=s;const l=this._palette.getPixels(new Uint8Array(a),r.paletteOffset,r.hasFlag(yf.Alpha));this.textures.push(new i7(i,r,l))}this.tileMap=new Ig(this.textures)}getTexture(t){const i=t,r=this.textures[i];if(!r)throw console.warn(`Computed i: ${i}`),new r7(t);return r}}/**
 * @remix-run/router v1.16.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fi(){return fi=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},fi.apply(this,arguments)}var Bi;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Bi||(Bi={}));const Ry="popstate";function a7(n){n===void 0&&(n={});function e(i,r){let{pathname:s,search:a,hash:l}=i.location;return Mu("",{pathname:s,search:a,hash:l},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){return typeof r=="string"?r:Xu(r)}return l7(e,t,null,n)}function Mt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Yl(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function o7(){return Math.random().toString(36).substr(2,8)}function xy(n,e){return{usr:n.state,key:n.key,idx:e}}function Mu(n,e,t,i){return t===void 0&&(t=null),fi({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Ha(e):e,{state:t,key:e&&e.key||i||o7()})}function Xu(n){let{pathname:e="/",search:t="",hash:i=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function Ha(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substr(i),n=n.substr(0,i)),n&&(e.pathname=n)}return e}function l7(n,e,t,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:s=!1}=i,a=r.history,l=Bi.Pop,o=null,c=u();c==null&&(c=0,a.replaceState(fi({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function h(){l=Bi.Pop;let v=u(),E=v==null?null:v-c;c=v,o&&o({action:l,location:p.location,delta:E})}function d(v,E){l=Bi.Push;let g=Mu(p.location,v,E);c=u()+1;let m=xy(g,c),y=p.createHref(g);try{a.pushState(m,"",y)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;r.location.assign(y)}s&&o&&o({action:l,location:p.location,delta:1})}function f(v,E){l=Bi.Replace;let g=Mu(p.location,v,E);c=u();let m=xy(g,c),y=p.createHref(g);a.replaceState(m,"",y),s&&o&&o({action:l,location:p.location,delta:0})}function _(v){let E=r.location.origin!=="null"?r.location.origin:r.location.href,g=typeof v=="string"?v:Xu(v);return g=g.replace(/ $/,"%20"),Mt(E,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,E)}let p={get action(){return l},get location(){return n(r,a)},listen(v){if(o)throw new Error("A history only accepts one active listener");return r.addEventListener(Ry,h),o=v,()=>{r.removeEventListener(Ry,h),o=null}},createHref(v){return e(r,v)},createURL:_,encodeLocation(v){let E=_(v);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:d,replace:f,go(v){return a.go(v)}};return p}var _i;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(_i||(_i={}));const c7=new Set(["lazy","caseSensitive","path","id","index","children"]);function u7(n){return n.index===!0}function Pg(n,e,t,i){return t===void 0&&(t=[]),i===void 0&&(i={}),n.map((r,s)=>{let a=[...t,s],l=typeof r.id=="string"?r.id:a.join("-");if(Mt(r.index!==!0||!r.children,"Cannot specify children on an index route"),Mt(!i[l],'Found a route id collision on id "'+l+`".  Route id's must be globally unique within Data Router usages`),u7(r)){let o=fi({},r,e(r),{id:l});return i[l]=o,o}else{let o=fi({},r,e(r),{id:l,children:void 0});return i[l]=o,r.children&&(o.children=Pg(r.children,e,a,i)),o}})}function Cl(n,e,t){t===void 0&&(t="/");let i=typeof e=="string"?Ha(e):e,r=Yu(i.pathname||"/",t);if(r==null)return null;let s=AA(n);d7(s);let a=null;for(let l=0;a==null&&l<s.length;++l){let o=A7(r);a=T7(s[l],o)}return a}function h7(n,e){let{route:t,pathname:i,params:r}=n;return{id:t.id,pathname:i,params:r,data:e[t.id],handle:t.handle}}function AA(n,e,t,i){e===void 0&&(e=[]),t===void 0&&(t=[]),i===void 0&&(i="");let r=(s,a,l)=>{let o={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};o.relativePath.startsWith("/")&&(Mt(o.relativePath.startsWith(i),'Absolute route path "'+o.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),o.relativePath=o.relativePath.slice(i.length));let c=wa([i,o.relativePath]),u=t.concat(o);s.children&&s.children.length>0&&(Mt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),AA(s.children,e,u,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:E7(c,s.index),routesMeta:u})};return n.forEach((s,a)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))r(s,a);else for(let o of SA(s.path))r(s,a,o)}),e}function SA(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),s=t.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let a=SA(i.join("/")),l=[];return l.push(...a.map(o=>o===""?s:[s,o].join("/"))),r&&l.push(...a),l.map(o=>n.startsWith("/")&&o===""?"/":o)}function d7(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:y7(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}const f7=/^:[\w-]+$/,_7=3,p7=2,g7=1,m7=10,v7=-2,My=n=>n==="*";function E7(n,e){let t=n.split("/"),i=t.length;return t.some(My)&&(i+=v7),e&&(i+=p7),t.filter(r=>!My(r)).reduce((r,s)=>r+(f7.test(s)?_7:s===""?g7:m7),i)}function y7(n,e){return n.length===e.length&&n.slice(0,-1).every((i,r)=>i===e[r])?n[n.length-1]-e[e.length-1]:0}function T7(n,e){let{routesMeta:t}=n,i={},r="/",s=[];for(let a=0;a<t.length;++a){let l=t[a],o=a===t.length-1,c=r==="/"?e:e.slice(r.length)||"/",u=b7({path:l.relativePath,caseSensitive:l.caseSensitive,end:o},c);if(!u)return null;Object.assign(i,u.params);let h=l.route;s.push({params:i,pathname:wa([r,u.pathname]),pathnameBase:x7(wa([r,u.pathnameBase])),route:h}),u.pathnameBase!=="/"&&(r=wa([r,u.pathnameBase]))}return s}function b7(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=C7(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let s=r[0],a=s.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:i.reduce((c,u,h)=>{let{paramName:d,isOptional:f}=u;if(d==="*"){let p=l[h]||"";a=s.slice(0,s.length-p.length).replace(/(.)\/+$/,"$1")}const _=l[h];return f&&!_?c[d]=void 0:c[d]=(_||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:a,pattern:n}}function C7(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Yl(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let i=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,o)=>(i.push({paramName:l,isOptional:o!=null}),o?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function A7(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Yl(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Yu(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function S7(n,e){e===void 0&&(e="/");let{pathname:t,search:i="",hash:r=""}=typeof n=="string"?Ha(n):n;return{pathname:t?t.startsWith("/")?t:R7(t,e):e,search:M7(i),hash:I7(r)}}function R7(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function sp(n,e,t,i){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function RA(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function xA(n,e){let t=RA(n);return e?t.map((i,r)=>r===n.length-1?i.pathname:i.pathnameBase):t.map(i=>i.pathnameBase)}function MA(n,e,t,i){i===void 0&&(i=!1);let r;typeof n=="string"?r=Ha(n):(r=fi({},n),Mt(!r.pathname||!r.pathname.includes("?"),sp("?","pathname","search",r)),Mt(!r.pathname||!r.pathname.includes("#"),sp("#","pathname","hash",r)),Mt(!r.search||!r.search.includes("#"),sp("#","search","hash",r)));let s=n===""||r.pathname==="",a=s?"/":r.pathname,l;if(a==null)l=t;else{let h=e.length-1;if(!i&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),h-=1;r.pathname=d.join("/")}l=h>=0?e[h]:"/"}let o=S7(r,l),c=a&&a!=="/"&&a.endsWith("/"),u=(s||a===".")&&t.endsWith("/");return!o.pathname.endsWith("/")&&(c||u)&&(o.pathname+="/"),o}const wa=n=>n.join("/").replace(/\/\/+/g,"/"),x7=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),M7=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,I7=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,IA=function(e,t){t===void 0&&(t=302);let i=t;typeof i=="number"?i={status:i}:typeof i.status>"u"&&(i.status=302);let r=new Headers(i.headers);return r.set("Location",e),new Response(null,fi({},i,{headers:r}))};class _0{constructor(e,t,i,r){r===void 0&&(r=!1),this.status=e,this.statusText=t||"",this.internal=r,i instanceof Error?(this.data=i.toString(),this.error=i):this.data=i}}function p0(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const PA=["post","put","patch","delete"],P7=new Set(PA),w7=["get",...PA],O7=new Set(w7),D7=new Set([301,302,303,307,308]),L7=new Set([307,308]),ap={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},N7={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Rc={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},g0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,F7=n=>({hasErrorBoundary:!!n.hasErrorBoundary}),wA="remix-router-transitions";function k7(n){const e=n.window?n.window:typeof window<"u"?window:void 0,t=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",i=!t;Mt(n.routes.length>0,"You must provide a non-empty routes array to createRouter");let r;if(n.mapRouteProperties)r=n.mapRouteProperties;else if(n.detectErrorBoundary){let H=n.detectErrorBoundary;r=J=>({hasErrorBoundary:H(J)})}else r=F7;let s={},a=Pg(n.routes,r,void 0,s),l,o=n.basename||"/",c=n.unstable_dataStrategy||V7,u=fi({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,unstable_skipActionErrorRevalidation:!1},n.future),h=null,d=new Set,f=null,_=null,p=null,v=n.hydrationData!=null,E=Cl(a,n.history.location,o),g=null;if(E==null){let H=cn(404,{pathname:n.history.location.pathname}),{matches:J,route:oe}=By(a);E=J,g={[oe.id]:H}}let m,y=E.some(H=>H.route.lazy),T=E.some(H=>H.route.loader);if(y)m=!1;else if(!T)m=!0;else if(u.v7_partialHydration){let H=n.hydrationData?n.hydrationData.loaderData:null,J=n.hydrationData?n.hydrationData.errors:null,oe=Ce=>Ce.route.loader?typeof Ce.route.loader=="function"&&Ce.route.loader.hydrate===!0?!1:H&&H[Ce.route.id]!==void 0||J&&J[Ce.route.id]!==void 0:!0;if(J){let Ce=E.findIndex(Be=>J[Be.route.id]!==void 0);m=E.slice(0,Ce+1).every(oe)}else m=E.every(oe)}else m=n.hydrationData!=null;let b,C={historyAction:n.history.action,location:n.history.location,matches:E,initialized:m,navigation:ap,restoreScrollPosition:n.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:n.hydrationData&&n.hydrationData.loaderData||{},actionData:n.hydrationData&&n.hydrationData.actionData||null,errors:n.hydrationData&&n.hydrationData.errors||g,fetchers:new Map,blockers:new Map},M=Bi.Pop,F=!1,P,U=!1,G=new Map,K=null,q=!1,se=!1,Ee=[],Se=[],$=new Map,_e=0,ae=-1,ce=new Map,he=new Set,je=new Map,Xe=new Map,Tt=new Set,Ze=new Map,W=new Map,pe=!1;function De(){if(h=n.history.listen(H=>{let{action:J,location:oe,delta:Ce}=H;if(pe){pe=!1;return}Yl(W.size===0||Ce!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Be=Ko({currentLocation:C.location,nextLocation:oe,historyAction:J});if(Be&&Ce!=null){pe=!0,n.history.go(Ce*-1),Ai(Be,{state:"blocked",location:oe,proceed(){Ai(Be,{state:"proceeding",proceed:void 0,reset:void 0,location:oe}),n.history.go(Ce)},reset(){let nt=new Map(C.blockers);nt.set(Be,Rc),$e({blockers:nt})}});return}return Ht(J,oe)}),t){J7(e,G);let H=()=>ez(e,G);e.addEventListener("pagehide",H),K=()=>e.removeEventListener("pagehide",H)}return C.initialized||Ht(Bi.Pop,C.location,{initialHydration:!0}),b}function ft(){h&&h(),K&&K(),d.clear(),P&&P.abort(),C.fetchers.forEach((H,J)=>Qs(J)),C.blockers.forEach((H,J)=>Yo(J))}function st(H){return d.add(H),()=>d.delete(H)}function $e(H,J){J===void 0&&(J={}),C=fi({},C,H);let oe=[],Ce=[];u.v7_fetcherPersist&&C.fetchers.forEach((Be,nt)=>{Be.state==="idle"&&(Tt.has(nt)?Ce.push(nt):oe.push(nt))}),[...d].forEach(Be=>Be(C,{deletedFetchers:Ce,unstable_viewTransitionOpts:J.viewTransitionOpts,unstable_flushSync:J.flushSync===!0})),u.v7_fetcherPersist&&(oe.forEach(Be=>C.fetchers.delete(Be)),Ce.forEach(Be=>Qs(Be)))}function bt(H,J,oe){var Ce,Be;let{flushSync:nt}=oe===void 0?{}:oe,Ke=C.actionData!=null&&C.navigation.formMethod!=null&&Pn(C.navigation.formMethod)&&C.navigation.state==="loading"&&((Ce=H.state)==null?void 0:Ce._isRedirect)!==!0,Ve;J.actionData?Object.keys(J.actionData).length>0?Ve=J.actionData:Ve=null:Ke?Ve=C.actionData:Ve=null;let at=J.loaderData?Fy(C.loaderData,J.loaderData,J.matches||[],J.errors):C.loaderData,Je=C.blockers;Je.size>0&&(Je=new Map(Je),Je.forEach((Qe,ii)=>Je.set(ii,Rc)));let Hi=F===!0||C.navigation.formMethod!=null&&Pn(C.navigation.formMethod)&&((Be=H.state)==null?void 0:Be._isRedirect)!==!0;l&&(a=l,l=void 0),q||M===Bi.Pop||(M===Bi.Push?n.history.push(H,H.state):M===Bi.Replace&&n.history.replace(H,H.state));let ji;if(M===Bi.Pop){let Qe=G.get(C.location.pathname);Qe&&Qe.has(H.pathname)?ji={currentLocation:C.location,nextLocation:H}:G.has(H.pathname)&&(ji={currentLocation:H,nextLocation:C.location})}else if(U){let Qe=G.get(C.location.pathname);Qe?Qe.add(H.pathname):(Qe=new Set([H.pathname]),G.set(C.location.pathname,Qe)),ji={currentLocation:C.location,nextLocation:H}}$e(fi({},J,{actionData:Ve,loaderData:at,historyAction:M,location:H,initialized:!0,navigation:ap,revalidation:"idle",restoreScrollPosition:Za(H,J.matches||C.matches),preventScrollReset:Hi,blockers:Je}),{viewTransitionOpts:ji,flushSync:nt===!0}),M=Bi.Pop,F=!1,U=!1,q=!1,se=!1,Ee=[],Se=[]}async function Wt(H,J){if(typeof H=="number"){n.history.go(H);return}let oe=wg(C.location,C.matches,o,u.v7_prependBasename,H,u.v7_relativeSplatPath,J==null?void 0:J.fromRouteId,J==null?void 0:J.relative),{path:Ce,submission:Be,error:nt}=Iy(u.v7_normalizeFormMethod,!1,oe,J),Ke=C.location,Ve=Mu(C.location,Ce,J&&J.state);Ve=fi({},Ve,n.history.encodeLocation(Ve));let at=J&&J.replace!=null?J.replace:void 0,Je=Bi.Push;at===!0?Je=Bi.Replace:at===!1||Be!=null&&Pn(Be.formMethod)&&Be.formAction===C.location.pathname+C.location.search&&(Je=Bi.Replace);let Hi=J&&"preventScrollReset"in J?J.preventScrollReset===!0:void 0,ji=(J&&J.unstable_flushSync)===!0,Qe=Ko({currentLocation:Ke,nextLocation:Ve,historyAction:Je});if(Qe){Ai(Qe,{state:"blocked",location:Ve,proceed(){Ai(Qe,{state:"proceeding",proceed:void 0,reset:void 0,location:Ve}),Wt(H,J)},reset(){let ii=new Map(C.blockers);ii.set(Qe,Rc),$e({blockers:ii})}});return}return await Ht(Je,Ve,{submission:Be,pendingError:nt,preventScrollReset:Hi,replace:J&&J.replace,enableViewTransition:J&&J.unstable_viewTransition,flushSync:ji})}function rt(){if(fs(),$e({revalidation:"loading"}),C.navigation.state!=="submitting"){if(C.navigation.state==="idle"){Ht(C.historyAction,C.location,{startUninterruptedRevalidation:!0});return}Ht(M||C.historyAction,C.navigation.location,{overrideNavigation:C.navigation})}}async function Ht(H,J,oe){P&&P.abort(),P=null,M=H,q=(oe&&oe.startUninterruptedRevalidation)===!0,ta(C.location,C.matches),F=(oe&&oe.preventScrollReset)===!0,U=(oe&&oe.enableViewTransition)===!0;let Ce=l||a,Be=oe&&oe.overrideNavigation,nt=Cl(Ce,J,o),Ke=(oe&&oe.flushSync)===!0;if(!nt){let Qe=cn(404,{pathname:J.pathname}),{matches:ii,route:Fi}=By(Ce);qo(),bt(J,{matches:ii,loaderData:{},errors:{[Fi.id]:Qe}},{flushSync:Ke});return}if(C.initialized&&!se&&Y7(C.location,J)&&!(oe&&oe.submission&&Pn(oe.submission.formMethod))){bt(J,{matches:nt},{flushSync:Ke});return}P=new AbortController;let Ve=tl(n.history,J,P.signal,oe&&oe.submission),at;if(oe&&oe.pendingError)at=[tu(nt).route.id,{type:_i.error,error:oe.pendingError}];else if(oe&&oe.submission&&Pn(oe.submission.formMethod)){let Qe=await Ni(Ve,J,oe.submission,nt,{replace:oe.replace,flushSync:Ke});if(Qe.shortCircuited)return;at=Qe.pendingActionResult,Be=op(J,oe.submission),Ke=!1,Ve=tl(n.history,Ve.url,Ve.signal)}let{shortCircuited:Je,loaderData:Hi,errors:ji}=await Ar(Ve,J,nt,Be,oe&&oe.submission,oe&&oe.fetcherSubmission,oe&&oe.replace,oe&&oe.initialHydration===!0,Ke,at);Je||(P=null,bt(J,fi({matches:nt},ky(at),{loaderData:Hi,errors:ji})))}async function Ni(H,J,oe,Ce,Be){Be===void 0&&(Be={}),fs();let nt=Q7(J,oe);$e({navigation:nt},{flushSync:Be.flushSync===!0});let Ke,Ve=Dg(Ce,J);if(!Ve.route.action&&!Ve.route.lazy)Ke={type:_i.error,error:cn(405,{method:H.method,pathname:J.pathname,routeId:Ve.route.id})};else if(Ke=(await jr("action",H,[Ve],Ce))[0],H.signal.aborted)return{shortCircuited:!0};if(mo(Ke)){let at;return Be&&Be.replace!=null?at=Be.replace:at=Dy(Ke.response.headers.get("Location"),new URL(H.url),o)===C.location.pathname+C.location.search,await Hr(H,Ke,{submission:oe,replace:at}),{shortCircuited:!0}}if(go(Ke))throw cn(400,{type:"defer-action"});if(_n(Ke)){let at=tu(Ce,Ve.route.id);return(Be&&Be.replace)!==!0&&(M=Bi.Push),{pendingActionResult:[at.route.id,Ke]}}return{pendingActionResult:[Ve.route.id,Ke]}}async function Ar(H,J,oe,Ce,Be,nt,Ke,Ve,at,Je){let Hi=Ce||op(J,Be),ji=Be||nt||Vy(Hi),Qe=l||a,[ii,Fi]=Py(n.history,C,oe,ji,J,u.v7_partialHydration&&Ve===!0,u.unstable_skipActionErrorRevalidation,se,Ee,Se,Tt,je,he,Qe,o,Je);if(qo(St=>!(oe&&oe.some(hr=>hr.route.id===St))||ii&&ii.some(hr=>hr.route.id===St)),ae=++_e,ii.length===0&&Fi.length===0){let St=Zs();return bt(J,fi({matches:oe,loaderData:{},errors:Je&&_n(Je[1])?{[Je[0]]:Je[1].error}:null},ky(Je),St?{fetchers:new Map(C.fetchers)}:{}),{flushSync:at}),{shortCircuited:!0}}if(!q&&(!u.v7_partialHydration||!Ve)){Fi.forEach(hr=>{let kr=C.fetchers.get(hr.key),Xi=xc(void 0,kr?kr.data:void 0);C.fetchers.set(hr.key,Xi)});let St;Je&&!_n(Je[1])?St={[Je[0]]:Je[1].data}:C.actionData&&(Object.keys(C.actionData).length===0?St=null:St=C.actionData),$e(fi({navigation:Hi},St!==void 0?{actionData:St}:{},Fi.length>0?{fetchers:new Map(C.fetchers)}:{}),{flushSync:at})}Fi.forEach(St=>{$.has(St.key)&&ur(St.key),St.controller&&$.set(St.key,St.controller)});let Ja=()=>Fi.forEach(St=>ur(St.key));P&&P.signal.addEventListener("abort",Ja);let{loaderResults:qn,fetcherResults:ia}=await Yn(C.matches,oe,ii,Fi,H);if(H.signal.aborted)return{shortCircuited:!0};P&&P.signal.removeEventListener("abort",Ja),Fi.forEach(St=>$.delete(St.key));let ra=Uy([...qn,...ia]);if(ra){if(ra.idx>=ii.length){let St=Fi[ra.idx-ii.length].key;he.add(St)}return await Hr(H,ra.result,{replace:Ke}),{shortCircuited:!0}}let{loaderData:na,errors:sn}=Ny(C,oe,ii,qn,Je,Fi,ia,Ze);Ze.forEach((St,hr)=>{St.subscribe(kr=>{(kr||St.done)&&Ze.delete(hr)})}),u.v7_partialHydration&&Ve&&C.errors&&Object.entries(C.errors).filter(St=>{let[hr]=St;return!ii.some(kr=>kr.route.id===hr)}).forEach(St=>{let[hr,kr]=St;sn=Object.assign(sn||{},{[hr]:kr})});let $o=Zs(),Qo=Qa(ae),Zo=$o||Qo||Fi.length>0;return fi({loaderData:na,errors:sn},Zo?{fetchers:new Map(C.fetchers)}:{})}function $s(H,J,oe,Ce){if(i)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");$.has(H)&&ur(H);let Be=(Ce&&Ce.unstable_flushSync)===!0,nt=l||a,Ke=wg(C.location,C.matches,o,u.v7_prependBasename,oe,u.v7_relativeSplatPath,J,Ce==null?void 0:Ce.relative),Ve=Cl(nt,Ke,o);if(!Ve){_s(H,J,cn(404,{pathname:Ke}),{flushSync:Be});return}let{path:at,submission:Je,error:Hi}=Iy(u.v7_normalizeFormMethod,!0,Ke,Ce);if(Hi){_s(H,J,Hi,{flushSync:Be});return}let ji=Dg(Ve,at);if(F=(Ce&&Ce.preventScrollReset)===!0,Je&&Pn(Je.formMethod)){jo(H,J,at,ji,Ve,Be,Je);return}je.set(H,{routeId:J,path:at}),ds(H,J,at,ji,Ve,Be,Je)}async function jo(H,J,oe,Ce,Be,nt,Ke){if(fs(),je.delete(H),!Ce.route.action&&!Ce.route.lazy){let Xi=cn(405,{method:Ke.formMethod,pathname:oe,routeId:J});_s(H,J,Xi,{flushSync:nt});return}let Ve=C.fetchers.get(H);Fr(H,Z7(Ke,Ve),{flushSync:nt});let at=new AbortController,Je=tl(n.history,oe,at.signal,Ke);$.set(H,at);let Hi=_e,Qe=(await jr("action",Je,[Ce],Be))[0];if(Je.signal.aborted){$.get(H)===at&&$.delete(H);return}if(u.v7_fetcherPersist&&Tt.has(H)){if(mo(Qe)||_n(Qe)){Fr(H,ca(void 0));return}}else{if(mo(Qe))if($.delete(H),ae>Hi){Fr(H,ca(void 0));return}else return he.add(H),Fr(H,xc(Ke)),Hr(Je,Qe,{fetcherSubmission:Ke});if(_n(Qe)){_s(H,J,Qe.error);return}}if(go(Qe))throw cn(400,{type:"defer-action"});let ii=C.navigation.location||C.location,Fi=tl(n.history,ii,at.signal),Ja=l||a,qn=C.navigation.state!=="idle"?Cl(Ja,C.navigation.location,o):C.matches;Mt(qn,"Didn't find any matches after fetcher action");let ia=++_e;ce.set(H,ia);let ra=xc(Ke,Qe.data);C.fetchers.set(H,ra);let[na,sn]=Py(n.history,C,qn,Ke,ii,!1,u.unstable_skipActionErrorRevalidation,se,Ee,Se,Tt,je,he,Ja,o,[Ce.route.id,Qe]);sn.filter(Xi=>Xi.key!==H).forEach(Xi=>{let eo=Xi.key,rh=C.fetchers.get(eo),S_=xc(void 0,rh?rh.data:void 0);C.fetchers.set(eo,S_),$.has(eo)&&ur(eo),Xi.controller&&$.set(eo,Xi.controller)}),$e({fetchers:new Map(C.fetchers)});let $o=()=>sn.forEach(Xi=>ur(Xi.key));at.signal.addEventListener("abort",$o);let{loaderResults:Qo,fetcherResults:Zo}=await Yn(C.matches,qn,na,sn,Fi);if(at.signal.aborted)return;at.signal.removeEventListener("abort",$o),ce.delete(H),$.delete(H),sn.forEach(Xi=>$.delete(Xi.key));let St=Uy([...Qo,...Zo]);if(St){if(St.idx>=na.length){let Xi=sn[St.idx-na.length].key;he.add(Xi)}return Hr(Fi,St.result)}let{loaderData:hr,errors:kr}=Ny(C,C.matches,na,Qo,void 0,sn,Zo,Ze);if(C.fetchers.has(H)){let Xi=ca(Qe.data);C.fetchers.set(H,Xi)}Qa(ia),C.navigation.state==="loading"&&ia>ae?(Mt(M,"Expected pending action"),P&&P.abort(),bt(C.navigation.location,{matches:qn,loaderData:hr,errors:kr,fetchers:new Map(C.fetchers)})):($e({errors:kr,loaderData:Fy(C.loaderData,hr,qn,kr),fetchers:new Map(C.fetchers)}),se=!1)}async function ds(H,J,oe,Ce,Be,nt,Ke){let Ve=C.fetchers.get(H);Fr(H,xc(Ke,Ve?Ve.data:void 0),{flushSync:nt});let at=new AbortController,Je=tl(n.history,oe,at.signal);$.set(H,at);let Hi=_e,Qe=(await jr("loader",Je,[Ce],Be))[0];if(go(Qe)&&(Qe=await NA(Qe,Je.signal,!0)||Qe),$.get(H)===at&&$.delete(H),!Je.signal.aborted){if(Tt.has(H)){Fr(H,ca(void 0));return}if(mo(Qe))if(ae>Hi){Fr(H,ca(void 0));return}else{he.add(H),await Hr(Je,Qe);return}if(_n(Qe)){_s(H,J,Qe.error);return}Mt(!go(Qe),"Unhandled fetcher deferred data"),Fr(H,ca(Qe.data))}}async function Hr(H,J,oe){let{submission:Ce,fetcherSubmission:Be,replace:nt}=oe===void 0?{}:oe;J.response.headers.has("X-Remix-Revalidate")&&(se=!0);let Ke=J.response.headers.get("Location");Mt(Ke,"Expected a Location header on the redirect Response"),Ke=Dy(Ke,new URL(H.url),o);let Ve=Mu(C.location,Ke,{_isRedirect:!0});if(t){let ii=!1;if(J.response.headers.has("X-Remix-Reload-Document"))ii=!0;else if(g0.test(Ke)){const Fi=n.history.createURL(Ke);ii=Fi.origin!==e.location.origin||Yu(Fi.pathname,o)==null}if(ii){nt?e.location.replace(Ke):e.location.assign(Ke);return}}P=null;let at=nt===!0?Bi.Replace:Bi.Push,{formMethod:Je,formAction:Hi,formEncType:ji}=C.navigation;!Ce&&!Be&&Je&&Hi&&ji&&(Ce=Vy(C.navigation));let Qe=Ce||Be;if(L7.has(J.response.status)&&Qe&&Pn(Qe.formMethod))await Ht(at,Ve,{submission:fi({},Qe,{formAction:Ke}),preventScrollReset:F});else{let ii=op(Ve,Ce);await Ht(at,Ve,{overrideNavigation:ii,fetcherSubmission:Be,preventScrollReset:F})}}async function jr(H,J,oe,Ce){try{let Be=await G7(c,H,J,oe,Ce,s,r);return await Promise.all(Be.map((nt,Ke)=>{if(K7(nt)){let Ve=nt.result;return{type:_i.redirect,response:j7(Ve,J,oe[Ke].route.id,Ce,o,u.v7_relativeSplatPath)}}return H7(nt)}))}catch(Be){return oe.map(()=>({type:_i.error,error:Be}))}}async function Yn(H,J,oe,Ce,Be){let[nt,...Ke]=await Promise.all([oe.length?jr("loader",Be,oe,J):[],...Ce.map(Ve=>{if(Ve.matches&&Ve.match&&Ve.controller){let at=tl(n.history,Ve.path,Ve.controller.signal);return jr("loader",at,[Ve.match],Ve.matches).then(Je=>Je[0])}else return Promise.resolve({type:_i.error,error:cn(404,{pathname:Ve.path})})})]);return await Promise.all([zy(H,oe,nt,nt.map(()=>Be.signal),!1,C.loaderData),zy(H,Ce.map(Ve=>Ve.match),Ke,Ce.map(Ve=>Ve.controller?Ve.controller.signal:null),!0)]),{loaderResults:nt,fetcherResults:Ke}}function fs(){se=!0,Ee.push(...qo()),je.forEach((H,J)=>{$.has(J)&&(Se.push(J),ur(J))})}function Fr(H,J,oe){oe===void 0&&(oe={}),C.fetchers.set(H,J),$e({fetchers:new Map(C.fetchers)},{flushSync:(oe&&oe.flushSync)===!0})}function _s(H,J,oe,Ce){Ce===void 0&&(Ce={});let Be=tu(C.matches,J);Qs(H),$e({errors:{[Be.route.id]:oe},fetchers:new Map(C.fetchers)},{flushSync:(Ce&&Ce.flushSync)===!0})}function Xo(H){return u.v7_fetcherPersist&&(Xe.set(H,(Xe.get(H)||0)+1),Tt.has(H)&&Tt.delete(H)),C.fetchers.get(H)||N7}function Qs(H){let J=C.fetchers.get(H);$.has(H)&&!(J&&J.state==="loading"&&ce.has(H))&&ur(H),je.delete(H),ce.delete(H),he.delete(H),Tt.delete(H),C.fetchers.delete(H)}function Kn(H){if(u.v7_fetcherPersist){let J=(Xe.get(H)||0)-1;J<=0?(Xe.delete(H),Tt.add(H)):Xe.set(H,J)}else Qs(H);$e({fetchers:new Map(C.fetchers)})}function ur(H){let J=$.get(H);Mt(J,"Expected fetch controller: "+H),J.abort(),$.delete(H)}function $a(H){for(let J of H){let oe=Xo(J),Ce=ca(oe.data);C.fetchers.set(J,Ce)}}function Zs(){let H=[],J=!1;for(let oe of he){let Ce=C.fetchers.get(oe);Mt(Ce,"Expected fetcher: "+oe),Ce.state==="loading"&&(he.delete(oe),H.push(oe),J=!0)}return $a(H),J}function Qa(H){let J=[];for(let[oe,Ce]of ce)if(Ce<H){let Be=C.fetchers.get(oe);Mt(Be,"Expected fetcher: "+oe),Be.state==="loading"&&(ur(oe),ce.delete(oe),J.push(oe))}return $a(J),J.length>0}function fc(H,J){let oe=C.blockers.get(H)||Rc;return W.get(H)!==J&&W.set(H,J),oe}function Yo(H){C.blockers.delete(H),W.delete(H)}function Ai(H,J){let oe=C.blockers.get(H)||Rc;Mt(oe.state==="unblocked"&&J.state==="blocked"||oe.state==="blocked"&&J.state==="blocked"||oe.state==="blocked"&&J.state==="proceeding"||oe.state==="blocked"&&J.state==="unblocked"||oe.state==="proceeding"&&J.state==="unblocked","Invalid blocker state transition: "+oe.state+" -> "+J.state);let Ce=new Map(C.blockers);Ce.set(H,J),$e({blockers:Ce})}function Ko(H){let{currentLocation:J,nextLocation:oe,historyAction:Ce}=H;if(W.size===0)return;W.size>1&&Yl(!1,"A router only supports one blocker at a time");let Be=Array.from(W.entries()),[nt,Ke]=Be[Be.length-1],Ve=C.blockers.get(nt);if(!(Ve&&Ve.state==="proceeding")&&Ke({currentLocation:J,nextLocation:oe,historyAction:Ce}))return nt}function qo(H){let J=[];return Ze.forEach((oe,Ce)=>{(!H||H(Ce))&&(oe.cancel(),J.push(Ce),Ze.delete(Ce))}),J}function Js(H,J,oe){if(f=H,p=J,_=oe||null,!v&&C.navigation===ap){v=!0;let Ce=Za(C.location,C.matches);Ce!=null&&$e({restoreScrollPosition:Ce})}return()=>{f=null,p=null,_=null}}function ea(H,J){return _&&_(H,J.map(Ce=>h7(Ce,C.loaderData)))||H.key}function ta(H,J){if(f&&p){let oe=ea(H,J);f[oe]=p()}}function Za(H,J){if(f){let oe=ea(H,J),Ce=f[oe];if(typeof Ce=="number")return Ce}return null}function _c(H){s={},l=Pg(H,r,void 0,s)}return b={get basename(){return o},get future(){return u},get state(){return C},get routes(){return a},get window(){return e},initialize:De,subscribe:st,enableScrollRestoration:Js,navigate:Wt,fetch:$s,revalidate:rt,createHref:H=>n.history.createHref(H),encodeLocation:H=>n.history.encodeLocation(H),getFetcher:Xo,deleteFetcher:Kn,dispose:ft,getBlocker:fc,deleteBlocker:Yo,_internalFetchControllers:$,_internalActiveDeferreds:Ze,_internalSetRoutes:_c},b}function B7(n){return n!=null&&("formData"in n&&n.formData!=null||"body"in n&&n.body!==void 0)}function wg(n,e,t,i,r,s,a,l){let o,c;if(a){o=[];for(let h of e)if(o.push(h),h.route.id===a){c=h;break}}else o=e,c=e[e.length-1];let u=MA(r||".",xA(o,s),Yu(n.pathname,t)||n.pathname,l==="path");return r==null&&(u.search=n.search,u.hash=n.hash),(r==null||r===""||r===".")&&c&&c.route.index&&!m0(u.search)&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),i&&t!=="/"&&(u.pathname=u.pathname==="/"?t:wa([t,u.pathname])),Xu(u)}function Iy(n,e,t,i){if(!i||!B7(i))return{path:t};if(i.formMethod&&!$7(i.formMethod))return{path:t,error:cn(405,{method:i.formMethod})};let r=()=>({path:t,error:cn(400,{type:"invalid-body"})}),s=i.formMethod||"get",a=n?s.toUpperCase():s.toLowerCase(),l=DA(t);if(i.body!==void 0){if(i.formEncType==="text/plain"){if(!Pn(a))return r();let d=typeof i.body=="string"?i.body:i.body instanceof FormData||i.body instanceof URLSearchParams?Array.from(i.body.entries()).reduce((f,_)=>{let[p,v]=_;return""+f+p+"="+v+`
`},""):String(i.body);return{path:t,submission:{formMethod:a,formAction:l,formEncType:i.formEncType,formData:void 0,json:void 0,text:d}}}else if(i.formEncType==="application/json"){if(!Pn(a))return r();try{let d=typeof i.body=="string"?JSON.parse(i.body):i.body;return{path:t,submission:{formMethod:a,formAction:l,formEncType:i.formEncType,formData:void 0,json:d,text:void 0}}}catch{return r()}}}Mt(typeof FormData=="function","FormData is not available in this environment");let o,c;if(i.formData)o=Og(i.formData),c=i.formData;else if(i.body instanceof FormData)o=Og(i.body),c=i.body;else if(i.body instanceof URLSearchParams)o=i.body,c=Ly(o);else if(i.body==null)o=new URLSearchParams,c=new FormData;else try{o=new URLSearchParams(i.body),c=Ly(o)}catch{return r()}let u={formMethod:a,formAction:l,formEncType:i&&i.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(Pn(u.formMethod))return{path:t,submission:u};let h=Ha(t);return e&&h.search&&m0(h.search)&&o.append("index",""),h.search="?"+o,{path:Xu(h),submission:u}}function U7(n,e){let t=n;if(e){let i=n.findIndex(r=>r.route.id===e);i>=0&&(t=n.slice(0,i))}return t}function Py(n,e,t,i,r,s,a,l,o,c,u,h,d,f,_,p){let v=p?_n(p[1])?p[1].error:p[1].data:void 0,E=n.createURL(e.location),g=n.createURL(r),m=p&&_n(p[1])?p[0]:void 0,y=m?U7(t,m):t,T=p?p[1].statusCode:void 0,b=a&&T&&T>=400,C=y.filter((F,P)=>{let{route:U}=F;if(U.lazy)return!0;if(U.loader==null)return!1;if(s)return typeof U.loader!="function"||U.loader.hydrate?!0:e.loaderData[U.id]===void 0&&(!e.errors||e.errors[U.id]===void 0);if(z7(e.loaderData,e.matches[P],F)||o.some(q=>q===F.route.id))return!0;let G=e.matches[P],K=F;return wy(F,fi({currentUrl:E,currentParams:G.params,nextUrl:g,nextParams:K.params},i,{actionResult:v,unstable_actionStatus:T,defaultShouldRevalidate:b?!1:l||E.pathname+E.search===g.pathname+g.search||E.search!==g.search||OA(G,K)}))}),M=[];return h.forEach((F,P)=>{if(s||!t.some(se=>se.route.id===F.routeId)||u.has(P))return;let U=Cl(f,F.path,_);if(!U){M.push({key:P,routeId:F.routeId,path:F.path,matches:null,match:null,controller:null});return}let G=e.fetchers.get(P),K=Dg(U,F.path),q=!1;d.has(P)?q=!1:c.includes(P)?q=!0:G&&G.state!=="idle"&&G.data===void 0?q=l:q=wy(K,fi({currentUrl:E,currentParams:e.matches[e.matches.length-1].params,nextUrl:g,nextParams:t[t.length-1].params},i,{actionResult:v,unstable_actionStatus:T,defaultShouldRevalidate:b?!1:l})),q&&M.push({key:P,routeId:F.routeId,path:F.path,matches:U,match:K,controller:new AbortController})}),[C,M]}function z7(n,e,t){let i=!e||t.route.id!==e.route.id,r=n[t.route.id]===void 0;return i||r}function OA(n,e){let t=n.route.path;return n.pathname!==e.pathname||t!=null&&t.endsWith("*")&&n.params["*"]!==e.params["*"]}function wy(n,e){if(n.route.shouldRevalidate){let t=n.route.shouldRevalidate(e);if(typeof t=="boolean")return t}return e.defaultShouldRevalidate}async function Oy(n,e,t){if(!n.lazy)return;let i=await n.lazy();if(!n.lazy)return;let r=t[n.id];Mt(r,"No route found in manifest");let s={};for(let a in i){let o=r[a]!==void 0&&a!=="hasErrorBoundary";Yl(!o,'Route "'+r.id+'" has a static property "'+a+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+a+'" will be ignored.')),!o&&!c7.has(a)&&(s[a]=i[a])}Object.assign(r,s),Object.assign(r,fi({},e(r),{lazy:void 0}))}function V7(n){return Promise.all(n.matches.map(e=>e.resolve()))}async function G7(n,e,t,i,r,s,a,l){let o=i.reduce((h,d)=>h.add(d.route.id),new Set),c=new Set,u=await n({matches:r.map(h=>{let d=o.has(h.route.id);return fi({},h,{shouldLoad:d,resolve:_=>(c.add(h.route.id),d?W7(e,t,h,s,a,_,l):Promise.resolve({type:_i.data,result:void 0}))})}),request:t,params:r[0].params,context:l});return r.forEach(h=>Mt(c.has(h.route.id),'`match.resolve()` was not called for route id "'+h.route.id+'". You must call `match.resolve()` on every match passed to `dataStrategy` to ensure all routes are properly loaded.')),u.filter((h,d)=>o.has(r[d].route.id))}async function W7(n,e,t,i,r,s,a){let l,o,c=u=>{let h,d=new Promise((p,v)=>h=v);o=()=>h(),e.signal.addEventListener("abort",o);let f=p=>typeof u!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+n+'" [routeId: '+t.route.id+"]"))):u({request:e,params:t.params,context:a},...p!==void 0?[p]:[]),_;return s?_=s(p=>f(p)):_=(async()=>{try{return{type:"data",result:await f()}}catch(p){return{type:"error",result:p}}})(),Promise.race([_,d])};try{let u=t.route[n];if(t.route.lazy)if(u){let h,[d]=await Promise.all([c(u).catch(f=>{h=f}),Oy(t.route,r,i)]);if(h!==void 0)throw h;l=d}else if(await Oy(t.route,r,i),u=t.route[n],u)l=await c(u);else if(n==="action"){let h=new URL(e.url),d=h.pathname+h.search;throw cn(405,{method:e.method,pathname:d,routeId:t.route.id})}else return{type:_i.data,result:void 0};else if(u)l=await c(u);else{let h=new URL(e.url),d=h.pathname+h.search;throw cn(404,{pathname:d})}Mt(l.result!==void 0,"You defined "+(n==="action"?"an action":"a loader")+" for route "+('"'+t.route.id+"\" but didn't return anything from your `"+n+"` ")+"function. Please return a value or `null`.")}catch(u){return{type:_i.error,result:u}}finally{o&&e.signal.removeEventListener("abort",o)}return l}async function H7(n){let{result:e,type:t,status:i}=n;if(LA(e)){let a;try{let l=e.headers.get("Content-Type");l&&/\bapplication\/json\b/.test(l)?e.body==null?a=null:a=await e.json():a=await e.text()}catch(l){return{type:_i.error,error:l}}return t===_i.error?{type:_i.error,error:new _0(e.status,e.statusText,a),statusCode:e.status,headers:e.headers}:{type:_i.data,data:a,statusCode:e.status,headers:e.headers}}if(t===_i.error)return{type:_i.error,error:e,statusCode:p0(e)?e.status:i};if(q7(e)){var r,s;return{type:_i.deferred,deferredData:e,statusCode:(r=e.init)==null?void 0:r.status,headers:((s=e.init)==null?void 0:s.headers)&&new Headers(e.init.headers)}}return{type:_i.data,data:e,statusCode:i}}function j7(n,e,t,i,r,s){let a=n.headers.get("Location");if(Mt(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!g0.test(a)){let l=i.slice(0,i.findIndex(o=>o.route.id===t)+1);a=wg(new URL(e.url),l,r,!0,a,s),n.headers.set("Location",a)}return n}function Dy(n,e,t){if(g0.test(n)){let i=n,r=i.startsWith("//")?new URL(e.protocol+i):new URL(i),s=Yu(r.pathname,t)!=null;if(r.origin===e.origin&&s)return r.pathname+r.search+r.hash}return n}function tl(n,e,t,i){let r=n.createURL(DA(e)).toString(),s={signal:t};if(i&&Pn(i.formMethod)){let{formMethod:a,formEncType:l}=i;s.method=a.toUpperCase(),l==="application/json"?(s.headers=new Headers({"Content-Type":l}),s.body=JSON.stringify(i.json)):l==="text/plain"?s.body=i.text:l==="application/x-www-form-urlencoded"&&i.formData?s.body=Og(i.formData):s.body=i.formData}return new Request(r,s)}function Og(n){let e=new URLSearchParams;for(let[t,i]of n.entries())e.append(t,typeof i=="string"?i:i.name);return e}function Ly(n){let e=new FormData;for(let[t,i]of n.entries())e.append(t,i);return e}function X7(n,e,t,i,r,s){let a={},l=null,o,c=!1,u={},h=i&&_n(i[1])?i[1].error:void 0;return t.forEach((d,f)=>{let _=e[f].route.id;if(Mt(!mo(d),"Cannot handle redirect results in processLoaderData"),_n(d)){let p=d.error;h!==void 0&&(p=h,h=void 0),l=l||{};{let v=tu(n,_);l[v.route.id]==null&&(l[v.route.id]=p)}a[_]=void 0,c||(c=!0,o=p0(d.error)?d.error.status:500),d.headers&&(u[_]=d.headers)}else go(d)?(r.set(_,d.deferredData),a[_]=d.deferredData.data,d.statusCode!=null&&d.statusCode!==200&&!c&&(o=d.statusCode),d.headers&&(u[_]=d.headers)):(a[_]=d.data,d.statusCode&&d.statusCode!==200&&!c&&(o=d.statusCode),d.headers&&(u[_]=d.headers))}),h!==void 0&&i&&(l={[i[0]]:h},a[i[0]]=void 0),{loaderData:a,errors:l,statusCode:o||200,loaderHeaders:u}}function Ny(n,e,t,i,r,s,a,l){let{loaderData:o,errors:c}=X7(e,t,i,r,l);for(let u=0;u<s.length;u++){let{key:h,match:d,controller:f}=s[u];Mt(a!==void 0&&a[u]!==void 0,"Did not find corresponding fetcher result");let _=a[u];if(!(f&&f.signal.aborted))if(_n(_)){let p=tu(n.matches,d==null?void 0:d.route.id);c&&c[p.route.id]||(c=fi({},c,{[p.route.id]:_.error})),n.fetchers.delete(h)}else if(mo(_))Mt(!1,"Unhandled fetcher revalidation redirect");else if(go(_))Mt(!1,"Unhandled fetcher deferred data");else{let p=ca(_.data);n.fetchers.set(h,p)}}return{loaderData:o,errors:c}}function Fy(n,e,t,i){let r=fi({},e);for(let s of t){let a=s.route.id;if(e.hasOwnProperty(a)?e[a]!==void 0&&(r[a]=e[a]):n[a]!==void 0&&s.route.loader&&(r[a]=n[a]),i&&i.hasOwnProperty(a))break}return r}function ky(n){return n?_n(n[1])?{actionData:{}}:{actionData:{[n[0]]:n[1].data}}:{}}function tu(n,e){return(e?n.slice(0,n.findIndex(i=>i.route.id===e)+1):[...n]).reverse().find(i=>i.route.hasErrorBoundary===!0)||n[0]}function By(n){let e=n.length===1?n[0]:n.find(t=>t.index||!t.path||t.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function cn(n,e){let{pathname:t,routeId:i,method:r,type:s}=e===void 0?{}:e,a="Unknown Server Error",l="Unknown @remix-run/router error";return n===400?(a="Bad Request",r&&t&&i?l="You made a "+r+' request to "'+t+'" but '+('did not provide a `loader` for route "'+i+'", ')+"so there is no way to handle the request.":s==="defer-action"?l="defer() is not supported in actions":s==="invalid-body"&&(l="Unable to encode submission body")):n===403?(a="Forbidden",l='Route "'+i+'" does not match URL "'+t+'"'):n===404?(a="Not Found",l='No route matches URL "'+t+'"'):n===405&&(a="Method Not Allowed",r&&t&&i?l="You made a "+r.toUpperCase()+' request to "'+t+'" but '+('did not provide an `action` for route "'+i+'", ')+"so there is no way to handle the request.":r&&(l='Invalid request method "'+r.toUpperCase()+'"')),new _0(n||500,a,new Error(l),!0)}function Uy(n){for(let e=n.length-1;e>=0;e--){let t=n[e];if(mo(t))return{result:t,idx:e}}}function DA(n){let e=typeof n=="string"?Ha(n):n;return Xu(fi({},e,{hash:""}))}function Y7(n,e){return n.pathname!==e.pathname||n.search!==e.search?!1:n.hash===""?e.hash!=="":n.hash===e.hash?!0:e.hash!==""}function K7(n){return LA(n.result)&&D7.has(n.result.status)}function go(n){return n.type===_i.deferred}function _n(n){return n.type===_i.error}function mo(n){return(n&&n.type)===_i.redirect}function q7(n){let e=n;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function LA(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.headers=="object"&&typeof n.body<"u"}function $7(n){return O7.has(n.toLowerCase())}function Pn(n){return P7.has(n.toLowerCase())}async function zy(n,e,t,i,r,s){for(let a=0;a<t.length;a++){let l=t[a],o=e[a];if(!o)continue;let c=n.find(h=>h.route.id===o.route.id),u=c!=null&&!OA(c,o)&&(s&&s[o.route.id])!==void 0;if(go(l)&&(r||u)){let h=i[a];Mt(h,"Expected an AbortSignal for revalidating fetcher deferred result"),await NA(l,h,r).then(d=>{d&&(t[a]=d||t[a])})}}}async function NA(n,e,t){if(t===void 0&&(t=!1),!await n.deferredData.resolveData(e)){if(t)try{return{type:_i.data,data:n.deferredData.unwrappedData}}catch(r){return{type:_i.error,error:r}}return{type:_i.data,data:n.deferredData.data}}}function m0(n){return new URLSearchParams(n).getAll("index").some(e=>e==="")}function Dg(n,e){let t=typeof e=="string"?Ha(e).search:e.search;if(n[n.length-1].route.index&&m0(t||""))return n[n.length-1];let i=RA(n);return i[i.length-1]}function Vy(n){let{formMethod:e,formAction:t,formEncType:i,text:r,formData:s,json:a}=n;if(!(!e||!t||!i)){if(r!=null)return{formMethod:e,formAction:t,formEncType:i,formData:void 0,json:void 0,text:r};if(s!=null)return{formMethod:e,formAction:t,formEncType:i,formData:s,json:void 0,text:void 0};if(a!==void 0)return{formMethod:e,formAction:t,formEncType:i,formData:void 0,json:a,text:void 0}}}function op(n,e){return e?{state:"loading",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:n,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function Q7(n,e){return{state:"submitting",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function xc(n,e){return n?{state:"loading",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function Z7(n,e){return{state:"submitting",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e?e.data:void 0}}function ca(n){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:n}}function J7(n,e){try{let t=n.sessionStorage.getItem(wA);if(t){let i=JSON.parse(t);for(let[r,s]of Object.entries(i||{}))s&&Array.isArray(s)&&e.set(r,new Set(s||[]))}}catch{}}function ez(n,e){if(e.size>0){let t={};for(let[i,r]of e)t[i]=[...r];try{n.sessionStorage.setItem(wA,JSON.stringify(t))}catch(i){Yl(!1,"Failed to save applied view transitions in sessionStorage ("+i+").")}}}/**
 * React Router v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bd(){return Bd=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Bd.apply(this,arguments)}const Tf=S.createContext(null),FA=S.createContext(null),bf=S.createContext(null),v0=S.createContext(null),Fo=S.createContext({outlet:null,matches:[],isDataRoute:!1}),kA=S.createContext(null);function Cf(){return S.useContext(v0)!=null}function E0(){return Cf()||Mt(!1),S.useContext(v0).location}function BA(n){S.useContext(bf).static||S.useLayoutEffect(n)}function UA(){let{isDataRoute:n}=S.useContext(Fo);return n?_z():tz()}function tz(){Cf()||Mt(!1);let n=S.useContext(Tf),{basename:e,future:t,navigator:i}=S.useContext(bf),{matches:r}=S.useContext(Fo),{pathname:s}=E0(),a=JSON.stringify(xA(r,t.v7_relativeSplatPath)),l=S.useRef(!1);return BA(()=>{l.current=!0}),S.useCallback(function(c,u){if(u===void 0&&(u={}),!l.current)return;if(typeof c=="number"){i.go(c);return}let h=MA(c,JSON.parse(a),s,u.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:wa([e,h.pathname])),(u.replace?i.replace:i.push)(h,u.state,u)},[e,i,a,s,n])}const iz=S.createContext(null);function rz(n){let e=S.useContext(Fo).outlet;return e&&S.createElement(iz.Provider,{value:n},e)}function nz(n,e,t,i){Cf()||Mt(!1);let{navigator:r}=S.useContext(bf),{matches:s}=S.useContext(Fo),a=s[s.length-1],l=a?a.params:{};a&&a.pathname;let o=a?a.pathnameBase:"/";a&&a.route;let c=E0(),u;u=c;let h=u.pathname||"/",d=h;if(o!=="/"){let p=o.replace(/^\//,"").split("/");d="/"+h.replace(/^\//,"").split("/").slice(p.length).join("/")}let f=Cl(n,{pathname:d});return cz(f&&f.map(p=>Object.assign({},p,{params:Object.assign({},l,p.params),pathname:wa([o,r.encodeLocation?r.encodeLocation(p.pathname).pathname:p.pathname]),pathnameBase:p.pathnameBase==="/"?o:wa([o,r.encodeLocation?r.encodeLocation(p.pathnameBase).pathname:p.pathnameBase])})),s,t,i)}function sz(){let n=fz(),e=p0(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),t?S.createElement("pre",{style:r},t):null,null)}const az=S.createElement(sz,null);class oz extends S.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?S.createElement(Fo.Provider,{value:this.props.routeContext},S.createElement(kA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function lz(n){let{routeContext:e,match:t,children:i}=n,r=S.useContext(Tf);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),S.createElement(Fo.Provider,{value:e},i)}function cz(n,e,t,i){var r;if(e===void 0&&(e=[]),t===void 0&&(t=null),i===void 0&&(i=null),n==null){var s;if((s=t)!=null&&s.errors)n=t.matches;else return null}let a=n,l=(r=t)==null?void 0:r.errors;if(l!=null){let u=a.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);u>=0||Mt(!1),a=a.slice(0,Math.min(a.length,u+1))}let o=!1,c=-1;if(t&&i&&i.v7_partialHydration)for(let u=0;u<a.length;u++){let h=a[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:d,errors:f}=t,_=h.route.loader&&d[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||_){o=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((u,h,d)=>{let f,_=!1,p=null,v=null;t&&(f=l&&h.route.id?l[h.route.id]:void 0,p=h.route.errorElement||az,o&&(c<0&&d===0?(_=!0,v=null):c===d&&(_=!0,v=h.route.hydrateFallbackElement||null)));let E=e.concat(a.slice(0,d+1)),g=()=>{let m;return f?m=p:_?m=v:h.route.Component?m=S.createElement(h.route.Component,null):h.route.element?m=h.route.element:m=u,S.createElement(lz,{match:h,routeContext:{outlet:u,matches:E,isDataRoute:t!=null},children:m})};return t&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?S.createElement(oz,{location:t.location,revalidation:t.revalidation,component:p,error:f,children:g(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):g()},null)}var zA=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(zA||{}),Kl=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(Kl||{});function uz(n){let e=S.useContext(Tf);return e||Mt(!1),e}function VA(n){let e=S.useContext(FA);return e||Mt(!1),e}function hz(n){let e=S.useContext(Fo);return e||Mt(!1),e}function y0(n){let e=hz(),t=e.matches[e.matches.length-1];return t.route.id||Mt(!1),t.route.id}function dz(){let n=VA(Kl.UseLoaderData),e=y0(Kl.UseLoaderData);if(n.errors&&n.errors[e]!=null){console.error("You cannot `useLoaderData` in an errorElement (routeId: "+e+")");return}return n.loaderData[e]}function fz(){var n;let e=S.useContext(kA),t=VA(Kl.UseRouteError),i=y0(Kl.UseRouteError);return e!==void 0?e:(n=t.errors)==null?void 0:n[i]}function _z(){let{router:n}=uz(zA.UseNavigateStable),e=y0(Kl.UseNavigateStable),t=S.useRef(!1);return BA(()=>{t.current=!0}),S.useCallback(function(r,s){s===void 0&&(s={}),t.current&&(typeof r=="number"?n.navigate(r):n.navigate(r,Bd({fromRouteId:e},s)))},[n,e])}function pz(n){return rz(n.context)}function gz(n){let{basename:e="/",children:t=null,location:i,navigationType:r=Bi.Pop,navigator:s,static:a=!1,future:l}=n;Cf()&&Mt(!1);let o=e.replace(/^\/*/,"/"),c=S.useMemo(()=>({basename:o,navigator:s,static:a,future:Bd({v7_relativeSplatPath:!1},l)}),[o,l,s,a]);typeof i=="string"&&(i=Ha(i));let{pathname:u="/",search:h="",hash:d="",state:f=null,key:_="default"}=i,p=S.useMemo(()=>{let v=Yu(u,o);return v==null?null:{location:{pathname:v,search:h,hash:d,state:f,key:_},navigationType:r}},[o,u,h,d,f,_,r]);return p==null?null:S.createElement(bf.Provider,{value:c},S.createElement(v0.Provider,{children:t,value:p}))}new Promise(()=>{});function mz(n){let e={hasErrorBoundary:n.ErrorBoundary!=null||n.errorElement!=null};return n.Component&&Object.assign(e,{element:S.createElement(n.Component),Component:void 0}),n.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:S.createElement(n.HydrateFallback),HydrateFallback:void 0}),n.ErrorBoundary&&Object.assign(e,{errorElement:S.createElement(n.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ud(){return Ud=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Ud.apply(this,arguments)}const vz="6";try{window.__reactRouterVersion=vz}catch{}function Ez(n,e){return k7({basename:void 0,future:Ud({},void 0,{v7_prependBasename:!0}),history:a7({window:void 0}),hydrationData:yz(),routes:n,mapRouteProperties:mz,unstable_dataStrategy:void 0,window:void 0}).initialize()}function yz(){var n;let e=(n=window)==null?void 0:n.__staticRouterHydrationData;return e&&e.errors&&(e=Ud({},e,{errors:Tz(e.errors)})),e}function Tz(n){if(!n)return null;let e=Object.entries(n),t={};for(let[i,r]of e)if(r&&r.__type==="RouteErrorResponse")t[i]=new _0(r.status,r.statusText,r.data,r.internal===!0);else if(r&&r.__type==="Error"){if(r.__subType){let s=window[r.__subType];if(typeof s=="function")try{let a=new s(r.message);a.stack="",t[i]=a}catch{}}if(t[i]==null){let s=new Error(r.message);s.stack="",t[i]=s}}else t[i]=r;return t}const bz=S.createContext({isTransitioning:!1}),Cz=S.createContext(new Map),Az="startTransition",Gy=GL[Az],Sz="flushSync",Wy=IB[Sz];function Rz(n){Gy?Gy(n):n()}function Mc(n){Wy?Wy(n):n()}class xz{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=i=>{this.status==="pending"&&(this.status="resolved",e(i))},this.reject=i=>{this.status==="pending"&&(this.status="rejected",t(i))}})}}function Mz(n){let{fallbackElement:e,router:t,future:i}=n,[r,s]=S.useState(t.state),[a,l]=S.useState(),[o,c]=S.useState({isTransitioning:!1}),[u,h]=S.useState(),[d,f]=S.useState(),[_,p]=S.useState(),v=S.useRef(new Map),{v7_startTransition:E}=i||{},g=S.useCallback(C=>{E?Rz(C):C()},[E]),m=S.useCallback((C,M)=>{let{deletedFetchers:F,unstable_flushSync:P,unstable_viewTransitionOpts:U}=M;F.forEach(K=>v.current.delete(K)),C.fetchers.forEach((K,q)=>{K.data!==void 0&&v.current.set(q,K.data)});let G=t.window==null||t.window.document==null||typeof t.window.document.startViewTransition!="function";if(!U||G){P?Mc(()=>s(C)):g(()=>s(C));return}if(P){Mc(()=>{d&&(u&&u.resolve(),d.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:U.currentLocation,nextLocation:U.nextLocation})});let K=t.window.document.startViewTransition(()=>{Mc(()=>s(C))});K.finished.finally(()=>{Mc(()=>{h(void 0),f(void 0),l(void 0),c({isTransitioning:!1})})}),Mc(()=>f(K));return}d?(u&&u.resolve(),d.skipTransition(),p({state:C,currentLocation:U.currentLocation,nextLocation:U.nextLocation})):(l(C),c({isTransitioning:!0,flushSync:!1,currentLocation:U.currentLocation,nextLocation:U.nextLocation}))},[t.window,d,u,v,g]);S.useLayoutEffect(()=>t.subscribe(m),[t,m]),S.useEffect(()=>{o.isTransitioning&&!o.flushSync&&h(new xz)},[o]),S.useEffect(()=>{if(u&&a&&t.window){let C=a,M=u.promise,F=t.window.document.startViewTransition(async()=>{g(()=>s(C)),await M});F.finished.finally(()=>{h(void 0),f(void 0),l(void 0),c({isTransitioning:!1})}),f(F)}},[g,a,u,t.window]),S.useEffect(()=>{u&&a&&r.location.key===a.location.key&&u.resolve()},[u,d,r.location,a]),S.useEffect(()=>{!o.isTransitioning&&_&&(l(_.state),c({isTransitioning:!0,flushSync:!1,currentLocation:_.currentLocation,nextLocation:_.nextLocation}),p(void 0))},[o.isTransitioning,_]),S.useEffect(()=>{},[]);let y=S.useMemo(()=>({createHref:t.createHref,encodeLocation:t.encodeLocation,go:C=>t.navigate(C),push:(C,M,F)=>t.navigate(C,{state:M,preventScrollReset:F==null?void 0:F.preventScrollReset}),replace:(C,M,F)=>t.navigate(C,{replace:!0,state:M,preventScrollReset:F==null?void 0:F.preventScrollReset})}),[t]),T=t.basename||"/",b=S.useMemo(()=>({router:t,navigator:y,static:!1,basename:T}),[t,y,T]);return S.createElement(S.Fragment,null,S.createElement(Tf.Provider,{value:b},S.createElement(FA.Provider,{value:r},S.createElement(Cz.Provider,{value:v.current},S.createElement(bz.Provider,{value:o},S.createElement(gz,{basename:T,location:r.location,navigationType:r.historyAction,navigator:y,future:{v7_relativeSplatPath:t.future.v7_relativeSplatPath}},r.initialized||t.future.v7_partialHydration?S.createElement(Iz,{routes:t.routes,future:t.future,state:r}):e))))),null)}function Iz(n){let{routes:e,future:t,state:i}=n;return nz(e,void 0,i,t)}var Hy;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Hy||(Hy={}));var jy;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(jy||(jy={}));function Lg(){return fe.jsx(fe.Fragment,{children:fe.jsxs(lr.Container,{children:[fe.jsx(lr,{xs:4,children:fe.jsx("aside",{className:"sidebar",children:fe.jsx(Pz,{})})}),fe.jsx(lr.Container,{justify:"center",xs:20,children:fe.jsx(pz,{})})]})})}Lg.loader=({request:n})=>{if(!ls.isInitialized){const e=new URL(n.url);let t="/open";if(e.pathname!=="/"){const i=new URLSearchParams;i.set("redirectTo",e.pathname),t+=`?${i}`}return IA(t)}return null};function Pz(){const n=UA(),e=E0();S.useEffect(()=>{},[e]);const t=S.useMemo(()=>{const r=a=>{const l=[];for(const o of a){const c={name:o.name,type:o.type,extra:o.extra,files:[]};o.type===Ld.Directory&&(c.files=r(o.children),c.extra=o.extra),l.push(c)}return l},s=ls.get().getFileStructure();return r(s)},[]),i=S.useCallback(r=>{const s=r.split("/"),a=s[0],l=s[1];if(!a||!l){console.warn("Invalid file was clicked:",r);return}n(`/${a}/${l}`)},[n]);return fe.jsx(Hu,{className:"file-tree",value:t,onClick:i})}const Af=n=>fe.jsx(Rv,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0,placeholder:void 0,...n});function Ng(){const n=UA(),e=S.useCallback(async()=>{await ls.init(),await ls.get().build();const i=new URLSearchParams(location.search).get("redirectTo")||"/";n(i)},[n]);return fe.jsx(Af,{onClick:e,children:"Select game directory"})}Ng.loader=function(n){if(!ls.isInitialized)return null;const t=new URLSearchParams(location.search).get("redirectTo")||"/";return IA(t)};const wz=Oz(128,128);function Oz(n,e){const t=document.createElement("canvas");return t.width=n,t.height=e,new Z(t.transferControlToOffscreen())}const Dz=2;function Lz({modelPack:n}){const[e,t]=S.useState(),i=S.useMemo(()=>{const a=[];for(const l of n.models)a.push({id:l.id.toString(),offset:`0x${l.headerOffset.toString(16)}`,view:fe.jsx(BX,{engine:wz,model:l}),vertexCount:l.vertices.length,faceCount:l.faces.length,depth:`0x${l.depth.toString(16)}`,unk:`0x${l.unk.toString(16)}`});return a},[n]),r=S.useCallback((a,l,o)=>{console.log(`colIndex: ${o}, rowIndex: ${l}`),o===Dz&&t(l)},[]),s=S.useCallback(()=>{t(void 0)},[]);return fe.jsxs(fe.Fragment,{children:[fe.jsxs(lr.Container,{gap:2,children:[fe.jsxs(lr,{xs:24,alignItems:"center",direction:"column",children:[fe.jsx(Ru,{h3:!0,margin:0,children:n.name}),fe.jsxs(Ru,{p:!0,small:!0,margin:0,children:[n.models.length," model(s)"]})]}),fe.jsx(lr,{xs:24,justify:"center",children:fe.jsxs(ys,{data:i,onCell:r,className:"model-pack-table",children:[fe.jsx(ys.Column,{prop:"id",label:"id"}),fe.jsx(ys.Column,{prop:"offset",label:"offset"}),fe.jsx(ys.Column,{prop:"view",label:"preview",className:"table-preview-cell"}),fe.jsx(ys.Column,{prop:"vertexCount",label:"# vertices"}),fe.jsx(ys.Column,{prop:"faceCount",label:"# faces"}),fe.jsx(ys.Column,{prop:"depth",label:"depth"}),fe.jsx(ys.Column,{prop:"unk",label:"unknown"})]})})]}),fe.jsxs(ba,{width:3,className:"modal-preview",visible:e!==void 0,disableBackdropClick:!0,onClose:s,children:[fe.jsx(ba.Title,{children:fe.jsx(lr.Container,{justify:"flex-end",children:fe.jsx(lr,{children:fe.jsx(Af,{className:"modal-close",icon:fe.jsx(S6,{children:"Esc"}),auto:!0,scale:1,px:.6,onClick:s})})})}),fe.jsx(ba.Content,{children:fe.jsx(FX,{model:n.getModel(e)})}),fe.jsx(ba.Action,{placeholder:"",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0,passive:!0,onClick:a=>a.close(),children:"Close"})]})]})}class Nz{constructor(){this._zoomStopsAnimation=!1,this._idleRotationSpeed=.05,this._idleRotationWaitTime=2e3,this._idleRotationSpinupTime=2e3,this.targetAlpha=null,this._isPointerDown=!1,this._lastFrameTime=null,this._lastInteractionTime=-1/0,this._cameraRotationSpeed=0,this._lastFrameRadius=0}get name(){return"AutoRotation"}set zoomStopsAnimation(e){this._zoomStopsAnimation=e}get zoomStopsAnimation(){return this._zoomStopsAnimation}set idleRotationSpeed(e){this._idleRotationSpeed=e}get idleRotationSpeed(){return this._idleRotationSpeed}set idleRotationWaitTime(e){this._idleRotationWaitTime=e}get idleRotationWaitTime(){return this._idleRotationWaitTime}set idleRotationSpinupTime(e){this._idleRotationSpinupTime=e}get idleRotationSpinupTime(){return this._idleRotationSpinupTime}get rotationInProgress(){return Math.abs(this._cameraRotationSpeed)>0}init(){}attach(e){this._attachedCamera=e;const t=this._attachedCamera.getScene();this._onPrePointerObservableObserver=t.onPrePointerObservable.add(i=>{if(i.type===be.POINTERDOWN){this._isPointerDown=!0;return}i.type===be.POINTERUP&&(this._isPointerDown=!1)}),this._onAfterCheckInputsObserver=e.onAfterCheckInputsObservable.add(()=>{if(this._reachTargetAlpha())return;const i=mn.Now;let r=0;this._lastFrameTime!=null&&(r=i-this._lastFrameTime),this._lastFrameTime=i,this._applyUserInteraction();const s=i-this._lastInteractionTime-this._idleRotationWaitTime,a=Math.max(Math.min(s/this._idleRotationSpinupTime,1),0);this._cameraRotationSpeed=this._idleRotationSpeed*a,this._attachedCamera&&(this._attachedCamera.alpha-=this._cameraRotationSpeed*(r/1e3))})}detach(){if(!this._attachedCamera)return;const e=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&e.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._attachedCamera=null}resetLastInteractionTime(e){this._lastInteractionTime=e??mn.Now}_reachTargetAlpha(){return this._attachedCamera&&this.targetAlpha?Math.abs(this._attachedCamera.alpha-this.targetAlpha)<ut:!1}_userIsZooming(){return this._attachedCamera?this._attachedCamera.inertialRadiusOffset!==0:!1}_shouldAnimationStopForInteraction(){if(!this._attachedCamera)return!1;let e=!1;return this._lastFrameRadius===this._attachedCamera.radius&&this._attachedCamera.inertialRadiusOffset!==0&&(e=!0),this._lastFrameRadius=this._attachedCamera.radius,this._zoomStopsAnimation?e:this._userIsZooming()}_applyUserInteraction(){this._userIsMoving()&&!this._shouldAnimationStopForInteraction()&&(this._lastInteractionTime=mn.Now)}_userIsMoving(){return this._attachedCamera?this._attachedCamera.inertialAlphaOffset!==0||this._attachedCamera.inertialBetaOffset!==0||this._attachedCamera.inertialRadiusOffset!==0||this._attachedCamera.inertialPanningX!==0||this._attachedCamera.inertialPanningY!==0||this._isPointerDown:!1}}var Xy;(function(n){n[n.CW=0]="CW",n[n.CCW=1]="CCW"})(Xy||(Xy={}));class Fn{constructor(){this._easingMode=Fn.EASINGMODE_EASEIN}setEasingMode(e){const t=Math.min(Math.max(e,0),2);this._easingMode=t}getEasingMode(){return this._easingMode}easeInCore(e){throw new Error("You must implement this method")}ease(e){switch(this._easingMode){case Fn.EASINGMODE_EASEIN:return this.easeInCore(e);case Fn.EASINGMODE_EASEOUT:return 1-this.easeInCore(1-e)}return e>=.5?(1-this.easeInCore((1-e)*2))*.5+.5:this.easeInCore(e*2)*.5}}Fn.EASINGMODE_EASEIN=0;Fn.EASINGMODE_EASEOUT=1;Fn.EASINGMODE_EASEINOUT=2;class Fz extends Fn{constructor(e=1){super(),this.amplitude=e}easeInCore(e){const t=Math.max(0,this.amplitude);return Math.pow(e,3)-e*t*Math.sin(3.141592653589793*e)}}class kz extends Fn{constructor(e=2){super(),this.exponent=e}easeInCore(e){return this.exponent<=0?e:(Math.exp(this.exponent*e)-1)/(Math.exp(this.exponent)-1)}}var Iu;(function(n){n[n.NONE=0]="NONE",n[n.STEP=1]="STEP"})(Iu||(Iu={}));class Sf{constructor(e,t,i){this.name=e,this.from=t,this.to=i}clone(){return new Sf(this.name,this.from,this.to)}}const Bz=Object.freeze(new ue(0,0,0,0)),Uz=Object.freeze(A.Zero()),zz=Object.freeze(xe.Zero()),Vz=Object.freeze(Yr.Zero()),Gz=Object.freeze(Pe.Black()),Wz=Object.freeze(new et(0,0,0,0)),Cn={key:0,repeatCount:0,loopMode:2};let _t=class Te{static _PrepareAnimation(e,t,i,r,s,a,l,o){let c;if(!isNaN(parseFloat(s))&&isFinite(s)?c=Te.ANIMATIONTYPE_FLOAT:s instanceof ue?c=Te.ANIMATIONTYPE_QUATERNION:s instanceof A?c=Te.ANIMATIONTYPE_VECTOR3:s instanceof xe?c=Te.ANIMATIONTYPE_VECTOR2:s instanceof Pe?c=Te.ANIMATIONTYPE_COLOR3:s instanceof et?c=Te.ANIMATIONTYPE_COLOR4:s instanceof Yr&&(c=Te.ANIMATIONTYPE_SIZE),c==null)return null;const u=new Te(e,t,i,c,l),h=[{frame:0,value:s},{frame:r,value:a}];return u.setKeys(h),o!==void 0&&u.setEasingFunction(o),u}static CreateAnimation(e,t,i,r){const s=new Te(e+"Animation",e,i,t,Te.ANIMATIONLOOPMODE_CONSTANT);return s.setEasingFunction(r),s}static CreateAndStartAnimation(e,t,i,r,s,a,l,o,c,u,h){const d=Te._PrepareAnimation(e,i,r,s,a,l,o,c);return!d||(t.getScene&&(h=t.getScene()),!h)?null:h.beginDirectAnimation(t,[d],0,s,d.loopMode===1,1,u)}static CreateAndStartHierarchyAnimation(e,t,i,r,s,a,l,o,c,u,h){const d=Te._PrepareAnimation(e,r,s,a,l,o,c,u);return d?t.getScene().beginDirectHierarchyAnimation(t,i,[d],0,a,d.loopMode===1,1,h):null}static CreateMergeAndStartAnimation(e,t,i,r,s,a,l,o,c,u){const h=Te._PrepareAnimation(e,i,r,s,a,l,o,c);return h?(t.animations.push(h),t.getScene().beginAnimation(t,0,s,h.loopMode===1,1,u)):null}static MakeAnimationAdditive(e,t,i,r=!1,s){let a;typeof t=="object"?a=t:a={referenceFrame:t??0,range:i,cloneOriginalAnimation:r,clonedAnimationName:s};let l=e;if(a.cloneOriginalAnimation&&(l=e.clone(),l.name=a.clonedAnimationName||l.name),!l._keys.length)return l;const o=a.referenceFrame&&a.referenceFrame>=0?a.referenceFrame:0;let c=0;const u=l._keys[0];let h=l._keys.length-1;const d=l._keys[h],f={referenceValue:u.value,referencePosition:V.Vector3[0],referenceQuaternion:V.Quaternion[0],referenceScaling:V.Vector3[1],keyPosition:V.Vector3[2],keyQuaternion:V.Quaternion[1],keyScaling:V.Vector3[3]};let _=u.frame,p=d.frame;if(a.range){const g=l.getRange(a.range);g&&(_=g.from,p=g.to)}else _=a.fromFrame??_,p=a.toFrame??p;if(_!==u.frame&&(c=l.createKeyForFrame(_)),p!==d.frame&&(h=l.createKeyForFrame(p)),l._keys.length===1){const g=l._getKeyValue(l._keys[0]);f.referenceValue=g.clone?g.clone():g}else if(o<=u.frame){const g=l._getKeyValue(u.value);f.referenceValue=g.clone?g.clone():g}else if(o>=d.frame){const g=l._getKeyValue(d.value);f.referenceValue=g.clone?g.clone():g}else{Cn.key=0;const g=l._interpolate(o,Cn);f.referenceValue=g.clone?g.clone():g}l.dataType===Te.ANIMATIONTYPE_QUATERNION?f.referenceValue.normalize().conjugateInPlace():l.dataType===Te.ANIMATIONTYPE_MATRIX&&(f.referenceValue.decompose(f.referenceScaling,f.referenceQuaternion,f.referencePosition),f.referenceQuaternion.normalize().conjugateInPlace());let v=Number.MAX_VALUE;const E=a.clipKeys?[]:null;for(let g=c;g<=h;g++){let m=l._keys[g];if(E&&(m={frame:m.frame,value:m.value.clone?m.value.clone():m.value,inTangent:m.inTangent,outTangent:m.outTangent,interpolation:m.interpolation,lockedTangent:m.lockedTangent},v===Number.MAX_VALUE&&(v=m.frame),m.frame-=v,E.push(m)),!(g&&l.dataType!==Te.ANIMATIONTYPE_FLOAT&&m.value===u.value))switch(l.dataType){case Te.ANIMATIONTYPE_MATRIX:m.value.decompose(f.keyScaling,f.keyQuaternion,f.keyPosition),f.keyPosition.subtractInPlace(f.referencePosition),f.keyScaling.divideInPlace(f.referenceScaling),f.referenceQuaternion.multiplyToRef(f.keyQuaternion,f.keyQuaternion),z.ComposeToRef(f.keyScaling,f.keyQuaternion,f.keyPosition,m.value);break;case Te.ANIMATIONTYPE_QUATERNION:f.referenceValue.multiplyToRef(m.value,m.value);break;case Te.ANIMATIONTYPE_VECTOR2:case Te.ANIMATIONTYPE_VECTOR3:case Te.ANIMATIONTYPE_COLOR3:case Te.ANIMATIONTYPE_COLOR4:m.value.subtractToRef(f.referenceValue,m.value);break;case Te.ANIMATIONTYPE_SIZE:m.value.width-=f.referenceValue.width,m.value.height-=f.referenceValue.height;break;default:m.value-=f.referenceValue}}return E&&l.setKeys(E,!0),l}static TransitionTo(e,t,i,r,s,a,l,o=null){if(l<=0)return i[e]=t,o&&o(),null;const c=s*(l/1e3);a.setKeys([{frame:0,value:i[e].clone?i[e].clone():i[e]},{frame:c,value:t}]),i.animations||(i.animations=[]),i.animations.push(a);const u=r.beginAnimation(i,0,c,!1);return u.onAnimationEnd=o,u}get runtimeAnimations(){return this._runtimeAnimations}get hasRunningRuntimeAnimations(){for(const e of this._runtimeAnimations)if(!e.isStopped())return!0;return!1}constructor(e,t,i,r,s,a){this.name=e,this.targetProperty=t,this.framePerSecond=i,this.dataType=r,this.loopMode=s,this.enableBlending=a,this._easingFunction=null,this._runtimeAnimations=new Array,this._events=new Array,this.blendingSpeed=.01,this._ranges={},this.targetPropertyPath=t.split("."),this.dataType=r,this.loopMode=s===void 0?Te.ANIMATIONLOOPMODE_CYCLE:s,this.uniqueId=Te._UniqueIdGenerator++}toString(e){let t="Name: "+this.name+", property: "+this.targetProperty;if(t+=", datatype: "+["Float","Vector3","Quaternion","Matrix","Color3","Vector2"][this.dataType],t+=", nKeys: "+(this._keys?this._keys.length:"none"),t+=", nRanges: "+(this._ranges?Object.keys(this._ranges).length:"none"),e){t+=", Ranges: {";let i=!0;for(const r in this._ranges)i&&(t+=", ",i=!1),t+=r;t+="}"}return t}addEvent(e){this._events.push(e),this._events.sort((t,i)=>t.frame-i.frame)}removeEvents(e){for(let t=0;t<this._events.length;t++)this._events[t].frame===e&&(this._events.splice(t,1),t--)}getEvents(){return this._events}createRange(e,t,i){this._ranges[e]||(this._ranges[e]=new Sf(e,t,i))}deleteRange(e,t=!0){const i=this._ranges[e];if(i){if(t){const r=i.from,s=i.to;for(let a=this._keys.length-1;a>=0;a--)this._keys[a].frame>=r&&this._keys[a].frame<=s&&this._keys.splice(a,1)}this._ranges[e]=null}}getRange(e){return this._ranges[e]}getKeys(){return this._keys}getHighestFrame(){let e=0;for(let t=0,i=this._keys.length;t<i;t++)e<this._keys[t].frame&&(e=this._keys[t].frame);return e}getEasingFunction(){return this._easingFunction}setEasingFunction(e){this._easingFunction=e}floatInterpolateFunction(e,t,i){return dt.Lerp(e,t,i)}floatInterpolateFunctionWithTangents(e,t,i,r,s){return dt.Hermite(e,t,i,r,s)}quaternionInterpolateFunction(e,t,i){return ue.Slerp(e,t,i)}quaternionInterpolateFunctionWithTangents(e,t,i,r,s){return ue.Hermite(e,t,i,r,s).normalize()}vector3InterpolateFunction(e,t,i){return A.Lerp(e,t,i)}vector3InterpolateFunctionWithTangents(e,t,i,r,s){return A.Hermite(e,t,i,r,s)}vector2InterpolateFunction(e,t,i){return xe.Lerp(e,t,i)}vector2InterpolateFunctionWithTangents(e,t,i,r,s){return xe.Hermite(e,t,i,r,s)}sizeInterpolateFunction(e,t,i){return Yr.Lerp(e,t,i)}color3InterpolateFunction(e,t,i){return Pe.Lerp(e,t,i)}color3InterpolateFunctionWithTangents(e,t,i,r,s){return Pe.Hermite(e,t,i,r,s)}color4InterpolateFunction(e,t,i){return et.Lerp(e,t,i)}color4InterpolateFunctionWithTangents(e,t,i,r,s){return et.Hermite(e,t,i,r,s)}_getKeyValue(e){return typeof e=="function"?e():e}evaluate(e){return Cn.key=0,this._interpolate(e,Cn)}_interpolate(e,t,i=!1){if(t.loopMode===Te.ANIMATIONLOOPMODE_CONSTANT&&t.repeatCount>0)return t.highLimitValue.clone?t.highLimitValue.clone():t.highLimitValue;const r=this._keys,s=r.length;let a=t.key;for(;a>=0&&e<r[a].frame;)--a;for(;a+1<=s-1&&e>=r[a+1].frame;)++a;if(t.key=a,a<0)return i?void 0:this._getKeyValue(r[0].value);if(a+1>s-1)return i?void 0:this._getKeyValue(r[s-1].value);const l=r[a],o=r[a+1];if(i&&(e===l.frame||e===o.frame))return;const c=this._getKeyValue(l.value),u=this._getKeyValue(o.value);if(l.interpolation===Iu.STEP)return o.frame>e?c:u;const h=l.outTangent!==void 0&&o.inTangent!==void 0,d=o.frame-l.frame;let f=(e-l.frame)/d;const _=l.easingFunction||this.getEasingFunction();switch(_!==null&&(f=_.ease(f)),this.dataType){case Te.ANIMATIONTYPE_FLOAT:{const p=h?this.floatInterpolateFunctionWithTangents(c,l.outTangent*d,u,o.inTangent*d,f):this.floatInterpolateFunction(c,u,f);switch(t.loopMode){case Te.ANIMATIONLOOPMODE_CYCLE:case Te.ANIMATIONLOOPMODE_CONSTANT:case Te.ANIMATIONLOOPMODE_YOYO:return p;case Te.ANIMATIONLOOPMODE_RELATIVE:case Te.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return(t.offsetValue??0)*t.repeatCount+p}break}case Te.ANIMATIONTYPE_QUATERNION:{const p=h?this.quaternionInterpolateFunctionWithTangents(c,l.outTangent.scale(d),u,o.inTangent.scale(d),f):this.quaternionInterpolateFunction(c,u,f);switch(t.loopMode){case Te.ANIMATIONLOOPMODE_CYCLE:case Te.ANIMATIONLOOPMODE_CONSTANT:case Te.ANIMATIONLOOPMODE_YOYO:return p;case Te.ANIMATIONLOOPMODE_RELATIVE:case Te.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return p.addInPlace((t.offsetValue||Bz).scale(t.repeatCount))}return p}case Te.ANIMATIONTYPE_VECTOR3:{const p=h?this.vector3InterpolateFunctionWithTangents(c,l.outTangent.scale(d),u,o.inTangent.scale(d),f):this.vector3InterpolateFunction(c,u,f);switch(t.loopMode){case Te.ANIMATIONLOOPMODE_CYCLE:case Te.ANIMATIONLOOPMODE_CONSTANT:case Te.ANIMATIONLOOPMODE_YOYO:return p;case Te.ANIMATIONLOOPMODE_RELATIVE:case Te.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return p.add((t.offsetValue||Uz).scale(t.repeatCount))}break}case Te.ANIMATIONTYPE_VECTOR2:{const p=h?this.vector2InterpolateFunctionWithTangents(c,l.outTangent.scale(d),u,o.inTangent.scale(d),f):this.vector2InterpolateFunction(c,u,f);switch(t.loopMode){case Te.ANIMATIONLOOPMODE_CYCLE:case Te.ANIMATIONLOOPMODE_CONSTANT:case Te.ANIMATIONLOOPMODE_YOYO:return p;case Te.ANIMATIONLOOPMODE_RELATIVE:case Te.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return p.add((t.offsetValue||zz).scale(t.repeatCount))}break}case Te.ANIMATIONTYPE_SIZE:{switch(t.loopMode){case Te.ANIMATIONLOOPMODE_CYCLE:case Te.ANIMATIONLOOPMODE_CONSTANT:case Te.ANIMATIONLOOPMODE_YOYO:return this.sizeInterpolateFunction(c,u,f);case Te.ANIMATIONLOOPMODE_RELATIVE:case Te.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return this.sizeInterpolateFunction(c,u,f).add((t.offsetValue||Vz).scale(t.repeatCount))}break}case Te.ANIMATIONTYPE_COLOR3:{const p=h?this.color3InterpolateFunctionWithTangents(c,l.outTangent.scale(d),u,o.inTangent.scale(d),f):this.color3InterpolateFunction(c,u,f);switch(t.loopMode){case Te.ANIMATIONLOOPMODE_CYCLE:case Te.ANIMATIONLOOPMODE_CONSTANT:case Te.ANIMATIONLOOPMODE_YOYO:return p;case Te.ANIMATIONLOOPMODE_RELATIVE:case Te.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return p.add((t.offsetValue||Gz).scale(t.repeatCount))}break}case Te.ANIMATIONTYPE_COLOR4:{const p=h?this.color4InterpolateFunctionWithTangents(c,l.outTangent.scale(d),u,o.inTangent.scale(d),f):this.color4InterpolateFunction(c,u,f);switch(t.loopMode){case Te.ANIMATIONLOOPMODE_CYCLE:case Te.ANIMATIONLOOPMODE_CONSTANT:case Te.ANIMATIONLOOPMODE_YOYO:return p;case Te.ANIMATIONLOOPMODE_RELATIVE:case Te.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return p.add((t.offsetValue||Wz).scale(t.repeatCount))}break}case Te.ANIMATIONTYPE_MATRIX:{switch(t.loopMode){case Te.ANIMATIONLOOPMODE_CYCLE:case Te.ANIMATIONLOOPMODE_CONSTANT:case Te.ANIMATIONLOOPMODE_YOYO:return Te.AllowMatricesInterpolation?this.matrixInterpolateFunction(c,u,f,t.workValue):c;case Te.ANIMATIONLOOPMODE_RELATIVE:case Te.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return c}break}}return 0}matrixInterpolateFunction(e,t,i,r){return Te.AllowMatrixDecomposeForInterpolation?r?(z.DecomposeLerpToRef(e,t,i,r),r):z.DecomposeLerp(e,t,i):r?(z.LerpToRef(e,t,i,r),r):z.Lerp(e,t,i)}clone(){const e=new Te(this.name,this.targetPropertyPath.join("."),this.framePerSecond,this.dataType,this.loopMode);if(e.enableBlending=this.enableBlending,e.blendingSpeed=this.blendingSpeed,this._keys&&e.setKeys(this._keys),this._ranges){e._ranges={};for(const t in this._ranges){const i=this._ranges[t];i&&(e._ranges[t]=i.clone())}}return e}setKeys(e,t=!1){this._keys=t?e:e.slice(0)}createKeyForFrame(e){Cn.key=0;const t=this._interpolate(e,Cn,!0);if(!t)return this._keys[Cn.key].frame===e?Cn.key:Cn.key+1;const i={frame:e,value:t.clone?t.clone():t};return this._keys.splice(Cn.key+1,0,i),Cn.key+1}serialize(){const e={};e.name=this.name,e.property=this.targetProperty,e.framePerSecond=this.framePerSecond,e.dataType=this.dataType,e.loopBehavior=this.loopMode,e.enableBlending=this.enableBlending,e.blendingSpeed=this.blendingSpeed;const t=this.dataType;e.keys=[];const i=this.getKeys();for(let r=0;r<i.length;r++){const s=i[r],a={};switch(a.frame=s.frame,t){case Te.ANIMATIONTYPE_FLOAT:a.values=[s.value],s.inTangent!==void 0&&a.values.push(s.inTangent),s.outTangent!==void 0&&(s.inTangent===void 0&&a.values.push(void 0),a.values.push(s.outTangent)),s.interpolation!==void 0&&(s.inTangent===void 0&&a.values.push(void 0),s.outTangent===void 0&&a.values.push(void 0),a.values.push(s.interpolation));break;case Te.ANIMATIONTYPE_QUATERNION:case Te.ANIMATIONTYPE_MATRIX:case Te.ANIMATIONTYPE_VECTOR3:case Te.ANIMATIONTYPE_COLOR3:case Te.ANIMATIONTYPE_COLOR4:a.values=s.value.asArray(),s.inTangent!=null&&a.values.push(s.inTangent.asArray()),s.outTangent!=null&&(s.inTangent===void 0&&a.values.push(void 0),a.values.push(s.outTangent.asArray())),s.interpolation!==void 0&&(s.inTangent===void 0&&a.values.push(void 0),s.outTangent===void 0&&a.values.push(void 0),a.values.push(s.interpolation));break}e.keys.push(a)}e.ranges=[];for(const r in this._ranges){const s=this._ranges[r];if(!s)continue;const a={};a.name=r,a.from=s.from,a.to=s.to,e.ranges.push(a)}return e}static _UniversalLerp(e,t,i){const r=e.constructor;return r.Lerp?r.Lerp(e,t,i):r.Slerp?r.Slerp(e,t,i):e.toFixed?e*(1-i)+i*t:t}static Parse(e){const t=new Te(e.name,e.property,e.framePerSecond,e.dataType,e.loopBehavior),i=e.dataType,r=[];let s,a;for(e.enableBlending&&(t.enableBlending=e.enableBlending),e.blendingSpeed&&(t.blendingSpeed=e.blendingSpeed),a=0;a<e.keys.length;a++){const l=e.keys[a];let o,c,u;switch(i){case Te.ANIMATIONTYPE_FLOAT:s=l.values[0],l.values.length>=2&&(o=l.values[1]),l.values.length>=3&&(c=l.values[2]),l.values.length>=4&&(u=l.values[3]);break;case Te.ANIMATIONTYPE_QUATERNION:if(s=ue.FromArray(l.values),l.values.length>=8){const d=ue.FromArray(l.values.slice(4,8));d.equals(ue.Zero())||(o=d)}if(l.values.length>=12){const d=ue.FromArray(l.values.slice(8,12));d.equals(ue.Zero())||(c=d)}l.values.length>=13&&(u=l.values[12]);break;case Te.ANIMATIONTYPE_MATRIX:s=z.FromArray(l.values),l.values.length>=17&&(u=l.values[16]);break;case Te.ANIMATIONTYPE_COLOR3:s=Pe.FromArray(l.values),l.values[3]&&(o=Pe.FromArray(l.values[3])),l.values[4]&&(c=Pe.FromArray(l.values[4])),l.values[5]&&(u=l.values[5]);break;case Te.ANIMATIONTYPE_COLOR4:s=et.FromArray(l.values),l.values[4]&&(o=et.FromArray(l.values[4])),l.values[5]&&(c=et.FromArray(l.values[5])),l.values[6]&&(u=et.FromArray(l.values[6]));break;case Te.ANIMATIONTYPE_VECTOR3:default:s=A.FromArray(l.values),l.values[3]&&(o=A.FromArray(l.values[3])),l.values[4]&&(c=A.FromArray(l.values[4])),l.values[5]&&(u=l.values[5]);break}const h={};h.frame=l.frame,h.value=s,o!=null&&(h.inTangent=o),c!=null&&(h.outTangent=c),u!=null&&(h.interpolation=u),r.push(h)}if(t.setKeys(r),e.ranges)for(a=0;a<e.ranges.length;a++)s=e.ranges[a],t.createRange(s.name,s.from,s.to);return t}static AppendSerializedAnimations(e,t){Fe.AppendSerializedAnimations(e,t)}static ParseFromFileAsync(e,t){return new Promise((i,r)=>{const s=new wi;s.addEventListener("readystatechange",()=>{if(s.readyState==4)if(s.status==200){let a=JSON.parse(s.responseText);if(a.animations&&(a=a.animations),a.length){const l=[];for(const o of a)l.push(this.Parse(o));i(l)}else{const l=this.Parse(a);e&&(l.name=e),i(l)}}else r("Unable to load the animation")}),s.open("GET",t),s.send()})}static ParseFromSnippetAsync(e){return new Promise((t,i)=>{const r=new wi;r.addEventListener("readystatechange",()=>{if(r.readyState==4)if(r.status==200){const s=JSON.parse(JSON.parse(r.responseText).jsonPayload);if(s.animations){const a=JSON.parse(s.animations),l=[];for(const o of a.animations){const c=this.Parse(o);c.snippetId=e,l.push(c)}t(l)}else{const a=JSON.parse(s.animation),l=this.Parse(a);l.snippetId=e,t(l)}}else i("Unable to load the snippet "+e)}),r.open("GET",this.SnippetUrl+"/"+e.replace(/#/g,"/")),r.send()})}};_t._UniqueIdGenerator=0;_t.AllowMatricesInterpolation=!1;_t.AllowMatrixDecomposeForInterpolation=!0;_t.SnippetUrl="https://snippet.babylonjs.com";_t.ANIMATIONTYPE_FLOAT=0;_t.ANIMATIONTYPE_VECTOR3=1;_t.ANIMATIONTYPE_QUATERNION=2;_t.ANIMATIONTYPE_MATRIX=3;_t.ANIMATIONTYPE_COLOR3=4;_t.ANIMATIONTYPE_COLOR4=7;_t.ANIMATIONTYPE_VECTOR2=5;_t.ANIMATIONTYPE_SIZE=6;_t.ANIMATIONLOOPMODE_RELATIVE=0;_t.ANIMATIONLOOPMODE_CYCLE=1;_t.ANIMATIONLOOPMODE_CONSTANT=2;_t.ANIMATIONLOOPMODE_YOYO=4;_t.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT=5;_t.CreateFromSnippetAsync=_t.ParseFromSnippetAsync;Ji("BABYLON.Animation",_t);Mi._AnimationRangeFactory=(n,e,t)=>new Sf(n,e,t);class Ao{constructor(){this.transitionDuration=450,this.lowerRadiusTransitionRange=2,this.upperRadiusTransitionRange=-2,this._autoTransitionRange=!1,this._radiusIsAnimating=!1,this._radiusBounceTransition=null,this._animatables=new Array}get name(){return"Bouncing"}get autoTransitionRange(){return this._autoTransitionRange}set autoTransitionRange(e){if(this._autoTransitionRange===e)return;this._autoTransitionRange=e;const t=this._attachedCamera;t&&(e?this._onMeshTargetChangedObserver=t.onMeshTargetChangedObservable.add(i=>{if(i&&(i.computeWorldMatrix(!0),i.getBoundingInfo)){const r=i.getBoundingInfo().diagonalLength;this.lowerRadiusTransitionRange=r*.05,this.upperRadiusTransitionRange=r*.05}}):this._onMeshTargetChangedObserver&&t.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver))}init(){}attach(e){this._attachedCamera=e,this._onAfterCheckInputsObserver=e.onAfterCheckInputsObservable.add(()=>{this._attachedCamera&&(this._isRadiusAtLimit(this._attachedCamera.lowerRadiusLimit)&&this._applyBoundRadiusAnimation(this.lowerRadiusTransitionRange),this._isRadiusAtLimit(this._attachedCamera.upperRadiusLimit)&&this._applyBoundRadiusAnimation(this.upperRadiusTransitionRange))})}detach(){this._attachedCamera&&(this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null)}_isRadiusAtLimit(e){return this._attachedCamera?this._attachedCamera.radius===e&&!this._radiusIsAnimating:!1}_applyBoundRadiusAnimation(e){if(!this._attachedCamera)return;this._radiusBounceTransition||(Ao.EasingFunction.setEasingMode(Ao.EasingMode),this._radiusBounceTransition=_t.CreateAnimation("radius",_t.ANIMATIONTYPE_FLOAT,60,Ao.EasingFunction)),this._cachedWheelPrecision=this._attachedCamera.wheelPrecision,this._attachedCamera.wheelPrecision=1/0,this._attachedCamera.inertialRadiusOffset=0,this.stopAllAnimations(),this._radiusIsAnimating=!0;const t=_t.TransitionTo("radius",this._attachedCamera.radius+e,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusBounceTransition,this.transitionDuration,()=>this._clearAnimationLocks());t&&this._animatables.push(t)}_clearAnimationLocks(){this._radiusIsAnimating=!1,this._attachedCamera&&(this._attachedCamera.wheelPrecision=this._cachedWheelPrecision)}stopAllAnimations(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0].onAnimationEnd=null,this._animatables[0].stop(),this._animatables.shift()}}Ao.EasingFunction=new Fz(.3);Ao.EasingMode=Fn.EASINGMODE_EASEOUT;class Mr{constructor(){this.onTargetFramingAnimationEndObservable=new Y,this._mode=Mr.FitFrustumSidesMode,this._radiusScale=1,this._positionScale=.5,this._defaultElevation=.3,this._elevationReturnTime=1500,this._elevationReturnWaitTime=1e3,this._zoomStopsAnimation=!1,this._framingTime=1500,this.autoCorrectCameraLimitsAndSensibility=!0,this._isPointerDown=!1,this._lastInteractionTime=-1/0,this._animatables=new Array,this._betaIsAnimating=!1}get name(){return"Framing"}set mode(e){this._mode=e}get mode(){return this._mode}set radiusScale(e){this._radiusScale=e}get radiusScale(){return this._radiusScale}set positionScale(e){this._positionScale=e}get positionScale(){return this._positionScale}set defaultElevation(e){this._defaultElevation=e}get defaultElevation(){return this._defaultElevation}set elevationReturnTime(e){this._elevationReturnTime=e}get elevationReturnTime(){return this._elevationReturnTime}set elevationReturnWaitTime(e){this._elevationReturnWaitTime=e}get elevationReturnWaitTime(){return this._elevationReturnWaitTime}set zoomStopsAnimation(e){this._zoomStopsAnimation=e}get zoomStopsAnimation(){return this._zoomStopsAnimation}set framingTime(e){this._framingTime=e}get framingTime(){return this._framingTime}init(){}attach(e){this._attachedCamera=e;const t=this._attachedCamera.getScene();Mr.EasingFunction.setEasingMode(Mr.EasingMode),this._onPrePointerObservableObserver=t.onPrePointerObservable.add(i=>{if(i.type===be.POINTERDOWN){this._isPointerDown=!0;return}i.type===be.POINTERUP&&(this._isPointerDown=!1)}),this._onMeshTargetChangedObserver=e.onMeshTargetChangedObservable.add(i=>{i&&i.getBoundingInfo&&this.zoomOnMesh(i,void 0,()=>{this.onTargetFramingAnimationEndObservable.notifyObservers()})}),this._onAfterCheckInputsObserver=e.onAfterCheckInputsObservable.add(()=>{this._applyUserInteraction(),this._maintainCameraAboveGround()})}detach(){if(!this._attachedCamera)return;const e=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&e.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null}zoomOnMesh(e,t=!1,i=null){e.computeWorldMatrix(!0);const r=e.getBoundingInfo().boundingBox;this.zoomOnBoundingInfo(r.minimumWorld,r.maximumWorld,t,i)}zoomOnMeshHierarchy(e,t=!1,i=null){e.computeWorldMatrix(!0);const r=e.getHierarchyBoundingVectors(!0);this.zoomOnBoundingInfo(r.min,r.max,t,i)}zoomOnMeshesHierarchy(e,t=!1,i=null){const r=new A(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),s=new A(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let a=0;a<e.length;a++){const l=e[a].getHierarchyBoundingVectors(!0);A.CheckExtends(l.min,r,s),A.CheckExtends(l.max,r,s)}this.zoomOnBoundingInfo(r,s,t,i)}zoomOnBoundingInfo(e,t,i=!1,r=null){let s;if(!this._attachedCamera)return!1;const a=e.y,l=t.y,o=a+(l-a)*this._positionScale,c=t.subtract(e).scale(.5);if(i)s=new A(0,o,0);else{const d=e.add(c);s=new A(d.x,o,d.z)}this._vectorTransition||(this._vectorTransition=_t.CreateAnimation("target",_t.ANIMATIONTYPE_VECTOR3,60,Mr.EasingFunction)),this._betaIsAnimating=!0;let u=_t.TransitionTo("target",s,this._attachedCamera,this._attachedCamera.getScene(),60,this._vectorTransition,this._framingTime);u&&this._animatables.push(u);let h=0;if(this._mode===Mr.FitFrustumSidesMode){const d=this._calculateLowerRadiusFromModelBoundingSphere(e,t);this.autoCorrectCameraLimitsAndSensibility&&(this._attachedCamera.lowerRadiusLimit=c.length()+this._attachedCamera.minZ),h=d}else this._mode===Mr.IgnoreBoundsSizeMode&&(h=this._calculateLowerRadiusFromModelBoundingSphere(e,t),this.autoCorrectCameraLimitsAndSensibility&&this._attachedCamera.lowerRadiusLimit===null&&(this._attachedCamera.lowerRadiusLimit=this._attachedCamera.minZ));if(this.autoCorrectCameraLimitsAndSensibility){const d=t.subtract(e).length();this._attachedCamera.panningSensibility=5e3/d,this._attachedCamera.wheelPrecision=100/h}return this._radiusTransition||(this._radiusTransition=_t.CreateAnimation("radius",_t.ANIMATIONTYPE_FLOAT,60,Mr.EasingFunction)),u=_t.TransitionTo("radius",h,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusTransition,this._framingTime,()=>{this.stopAllAnimations(),r&&r(),this._attachedCamera&&this._attachedCamera.useInputToRestoreState&&this._attachedCamera.storeState()}),u&&this._animatables.push(u),!0}_calculateLowerRadiusFromModelBoundingSphere(e,t){const i=this._attachedCamera;if(!i)return 0;let r=i._calculateLowerRadiusFromModelBoundingSphere(e,t,this._radiusScale);return i.lowerRadiusLimit&&this._mode===Mr.IgnoreBoundsSizeMode&&(r=r<i.lowerRadiusLimit?i.lowerRadiusLimit:r),i.upperRadiusLimit&&(r=r>i.upperRadiusLimit?i.upperRadiusLimit:r),r}_maintainCameraAboveGround(){if(this._elevationReturnTime<0)return;const e=mn.Now-this._lastInteractionTime,t=Math.PI*.5-this._defaultElevation,i=Math.PI*.5;if(this._attachedCamera&&!this._betaIsAnimating&&this._attachedCamera.beta>i&&e>=this._elevationReturnWaitTime){this._betaIsAnimating=!0,this.stopAllAnimations(),this._betaTransition||(this._betaTransition=_t.CreateAnimation("beta",_t.ANIMATIONTYPE_FLOAT,60,Mr.EasingFunction));const r=_t.TransitionTo("beta",t,this._attachedCamera,this._attachedCamera.getScene(),60,this._betaTransition,this._elevationReturnTime,()=>{this._clearAnimationLocks(),this.stopAllAnimations()});r&&this._animatables.push(r)}}_clearAnimationLocks(){this._betaIsAnimating=!1}_applyUserInteraction(){this.isUserIsMoving&&(this._lastInteractionTime=mn.Now,this.stopAllAnimations(),this._clearAnimationLocks())}stopAllAnimations(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0]&&(this._animatables[0].onAnimationEnd=null,this._animatables[0].stop()),this._animatables.shift()}get isUserIsMoving(){return this._attachedCamera?this._attachedCamera.inertialAlphaOffset!==0||this._attachedCamera.inertialBetaOffset!==0||this._attachedCamera.inertialRadiusOffset!==0||this._attachedCamera.inertialPanningX!==0||this._attachedCamera.inertialPanningY!==0||this._isPointerDown:!1}}Mr.EasingFunction=new kz;Mr.EasingMode=Fn.EASINGMODE_EASEINOUT;Mr.IgnoreBoundsSizeMode=0;Mr.FitFrustumSidesMode=1;Mi.AddNodeConstructor("TargetCamera",(n,e)=>()=>new Si(n,A.Zero(),e));class Si extends Ie{constructor(e,t,i,r=!0){super(e,t,i,r),this._tmpUpVector=A.Zero(),this._tmpTargetVector=A.Zero(),this.cameraDirection=new A(0,0,0),this.cameraRotation=new xe(0,0),this.ignoreParentScaling=!1,this.updateUpVectorFromRotation=!1,this._tmpQuaternion=new ue,this.rotation=new A(0,0,0),this.speed=2,this.noRotationConstraint=!1,this.invertRotation=!1,this.inverseRotationSpeed=.2,this.lockedTarget=null,this._currentTarget=A.Zero(),this._initialFocalDistance=1,this._viewMatrix=z.Zero(),this._camMatrix=z.Zero(),this._cameraTransformMatrix=z.Zero(),this._cameraRotationMatrix=z.Zero(),this._referencePoint=new A(0,0,1),this._transformedReferencePoint=A.Zero(),this._deferredPositionUpdate=new A,this._deferredRotationQuaternionUpdate=new ue,this._deferredRotationUpdate=new A,this._deferredUpdated=!1,this._deferOnly=!1,this._defaultUp=A.Up(),this._cachedRotationZ=0,this._cachedQuaternionRotationZ=0}getFrontPosition(e){this.getWorldMatrix();const t=this.getTarget().subtract(this.position);return t.normalize(),t.scaleInPlace(e),this.globalPosition.add(t)}_getLockedTargetPosition(){if(!this.lockedTarget)return null;if(this.lockedTarget.absolutePosition){const e=this.lockedTarget;e.computeWorldMatrix().getTranslationToRef(e.absolutePosition)}return this.lockedTarget.absolutePosition||this.lockedTarget}storeState(){return this._storedPosition=this.position.clone(),this._storedRotation=this.rotation.clone(),this.rotationQuaternion&&(this._storedRotationQuaternion=this.rotationQuaternion.clone()),super.storeState()}_restoreStateValues(){return super._restoreStateValues()?(this.position=this._storedPosition.clone(),this.rotation=this._storedRotation.clone(),this.rotationQuaternion&&(this.rotationQuaternion=this._storedRotationQuaternion.clone()),this.cameraDirection.copyFromFloats(0,0,0),this.cameraRotation.copyFromFloats(0,0),!0):!1}_initCache(){super._initCache(),this._cache.lockedTarget=new A(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotation=new A(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotationQuaternion=new ue(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}_updateCache(e){e||super._updateCache();const t=this._getLockedTargetPosition();t?this._cache.lockedTarget?this._cache.lockedTarget.copyFrom(t):this._cache.lockedTarget=t.clone():this._cache.lockedTarget=null,this._cache.rotation.copyFrom(this.rotation),this.rotationQuaternion&&this._cache.rotationQuaternion.copyFrom(this.rotationQuaternion)}_isSynchronizedViewMatrix(){if(!super._isSynchronizedViewMatrix())return!1;const e=this._getLockedTargetPosition();return(this._cache.lockedTarget?this._cache.lockedTarget.equals(e):!e)&&(this.rotationQuaternion?this.rotationQuaternion.equals(this._cache.rotationQuaternion):this._cache.rotation.equals(this.rotation))}_computeLocalCameraSpeed(){const e=this.getEngine();return this.speed*Math.sqrt(e.getDeltaTime()/(e.getFps()*100))}setTarget(e){this.upVector.normalize(),this._initialFocalDistance=e.subtract(this.position).length(),this.position.z===e.z&&(this.position.z+=ut),this._referencePoint.normalize().scaleInPlace(this._initialFocalDistance),z.LookAtLHToRef(this.position,e,this._defaultUp,this._camMatrix),this._camMatrix.invert(),this.rotation.x=Math.atan(this._camMatrix.m[6]/this._camMatrix.m[10]);const t=e.subtract(this.position);t.x>=0?this.rotation.y=-Math.atan(t.z/t.x)+Math.PI/2:this.rotation.y=-Math.atan(t.z/t.x)-Math.PI/2,this.rotation.z=0,isNaN(this.rotation.x)&&(this.rotation.x=0),isNaN(this.rotation.y)&&(this.rotation.y=0),isNaN(this.rotation.z)&&(this.rotation.z=0),this.rotationQuaternion&&ue.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion)}get target(){return this.getTarget()}set target(e){this.setTarget(e)}getTarget(){return this._currentTarget}_decideIfNeedsToMove(){return Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0}_updatePosition(){if(this.parent){this.parent.getWorldMatrix().invertToRef(V.Matrix[0]),A.TransformNormalToRef(this.cameraDirection,V.Matrix[0],V.Vector3[0]),this._deferredPositionUpdate.addInPlace(V.Vector3[0]),this._deferOnly?this._deferredUpdated=!0:this.position.copyFrom(this._deferredPositionUpdate);return}this._deferredPositionUpdate.addInPlace(this.cameraDirection),this._deferOnly?this._deferredUpdated=!0:this.position.copyFrom(this._deferredPositionUpdate)}_checkInputs(){const e=this.invertRotation?-this.inverseRotationSpeed:1,t=this._decideIfNeedsToMove(),i=this.cameraRotation.x||this.cameraRotation.y;this._deferredUpdated=!1,this._deferredRotationUpdate.copyFrom(this.rotation),this._deferredPositionUpdate.copyFrom(this.position),this.rotationQuaternion&&this._deferredRotationQuaternionUpdate.copyFrom(this.rotationQuaternion),t&&this._updatePosition(),i&&(this.rotationQuaternion&&this.rotationQuaternion.toEulerAnglesToRef(this._deferredRotationUpdate),this._deferredRotationUpdate.x+=this.cameraRotation.x*e,this._deferredRotationUpdate.y+=this.cameraRotation.y*e,this.noRotationConstraint||(this._deferredRotationUpdate.x>1.570796&&(this._deferredRotationUpdate.x=1.570796),this._deferredRotationUpdate.x<-1.570796&&(this._deferredRotationUpdate.x=-1.570796)),this._deferOnly?this._deferredUpdated=!0:this.rotation.copyFrom(this._deferredRotationUpdate),this.rotationQuaternion&&this._deferredRotationUpdate.lengthSquared()&&(ue.RotationYawPitchRollToRef(this._deferredRotationUpdate.y,this._deferredRotationUpdate.x,this._deferredRotationUpdate.z,this._deferredRotationQuaternionUpdate),this._deferOnly?this._deferredUpdated=!0:this.rotationQuaternion.copyFrom(this._deferredRotationQuaternionUpdate))),t&&(Math.abs(this.cameraDirection.x)<this.speed*ut&&(this.cameraDirection.x=0),Math.abs(this.cameraDirection.y)<this.speed*ut&&(this.cameraDirection.y=0),Math.abs(this.cameraDirection.z)<this.speed*ut&&(this.cameraDirection.z=0),this.cameraDirection.scaleInPlace(this.inertia)),i&&(Math.abs(this.cameraRotation.x)<this.speed*ut&&(this.cameraRotation.x=0),Math.abs(this.cameraRotation.y)<this.speed*ut&&(this.cameraRotation.y=0),this.cameraRotation.scaleInPlace(this.inertia)),super._checkInputs()}_updateCameraRotationMatrix(){this.rotationQuaternion?this.rotationQuaternion.toRotationMatrix(this._cameraRotationMatrix):z.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this._cameraRotationMatrix)}_rotateUpVectorWithCameraRotationMatrix(){return A.TransformNormalToRef(this._defaultUp,this._cameraRotationMatrix,this.upVector),this}_getViewMatrix(){return this.lockedTarget&&this.setTarget(this._getLockedTargetPosition()),this._updateCameraRotationMatrix(),this.rotationQuaternion&&this._cachedQuaternionRotationZ!=this.rotationQuaternion.z?(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedQuaternionRotationZ=this.rotationQuaternion.z):this._cachedRotationZ!==this.rotation.z&&(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedRotationZ=this.rotation.z),A.TransformCoordinatesToRef(this._referencePoint,this._cameraRotationMatrix,this._transformedReferencePoint),this.position.addToRef(this._transformedReferencePoint,this._currentTarget),this.updateUpVectorFromRotation&&(this.rotationQuaternion?Ro.Y.rotateByQuaternionToRef(this.rotationQuaternion,this.upVector):(ue.FromEulerVectorToRef(this.rotation,this._tmpQuaternion),Ro.Y.rotateByQuaternionToRef(this._tmpQuaternion,this.upVector))),this._computeViewMatrix(this.position,this._currentTarget,this.upVector),this._viewMatrix}_computeViewMatrix(e,t,i){if(this.ignoreParentScaling){if(this.parent){const r=this.parent.getWorldMatrix();A.TransformCoordinatesToRef(e,r,this._globalPosition),A.TransformCoordinatesToRef(t,r,this._tmpTargetVector),A.TransformNormalToRef(i,r,this._tmpUpVector),this._markSyncedWithParent()}else this._globalPosition.copyFrom(e),this._tmpTargetVector.copyFrom(t),this._tmpUpVector.copyFrom(i);this.getScene().useRightHandedSystem?z.LookAtRHToRef(this._globalPosition,this._tmpTargetVector,this._tmpUpVector,this._viewMatrix):z.LookAtLHToRef(this._globalPosition,this._tmpTargetVector,this._tmpUpVector,this._viewMatrix);return}if(this.getScene().useRightHandedSystem?z.LookAtRHToRef(e,t,i,this._viewMatrix):z.LookAtLHToRef(e,t,i,this._viewMatrix),this.parent){const r=this.parent.getWorldMatrix();this._viewMatrix.invert(),this._viewMatrix.multiplyToRef(r,this._viewMatrix),this._viewMatrix.getTranslationToRef(this._globalPosition),this._viewMatrix.invert(),this._markSyncedWithParent()}else this._globalPosition.copyFrom(e)}createRigCamera(e,t){if(this.cameraRigMode!==Ie.RIG_MODE_NONE){const i=new Si(e,this.position.clone(),this.getScene());return i.isRigCamera=!0,i.rigParent=this,this.cameraRigMode===Ie.RIG_MODE_VR&&(this.rotationQuaternion||(this.rotationQuaternion=new ue),i._cameraRigParams={},i.rotationQuaternion=new ue),i.mode=this.mode,i.orthoLeft=this.orthoLeft,i.orthoRight=this.orthoRight,i.orthoTop=this.orthoTop,i.orthoBottom=this.orthoBottom,i}return null}_updateRigCameras(){const e=this._rigCameras[0],t=this._rigCameras[1];switch(this.computeWorldMatrix(),this.cameraRigMode){case Ie.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case Ie.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case Ie.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case Ie.RIG_MODE_STEREOSCOPIC_OVERUNDER:case Ie.RIG_MODE_STEREOSCOPIC_INTERLACED:{const i=this.cameraRigMode===Ie.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?1:-1,r=this.cameraRigMode===Ie.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?-1:1;this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*i,e),this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*r,t);break}case Ie.RIG_MODE_VR:e.rotationQuaternion?(e.rotationQuaternion.copyFrom(this.rotationQuaternion),t.rotationQuaternion.copyFrom(this.rotationQuaternion)):(e.rotation.copyFrom(this.rotation),t.rotation.copyFrom(this.rotation)),e.position.copyFrom(this.position),t.position.copyFrom(this.position);break}super._updateRigCameras()}_getRigCamPositionAndTarget(e,t){this.getTarget().subtractToRef(this.position,Si._TargetFocalPoint),Si._TargetFocalPoint.normalize().scaleInPlace(this._initialFocalDistance);const r=Si._TargetFocalPoint.addInPlace(this.position);z.TranslationToRef(-r.x,-r.y,-r.z,Si._TargetTransformMatrix),Si._TargetTransformMatrix.multiplyToRef(z.RotationAxis(t.upVector,e),Si._RigCamTransformMatrix),z.TranslationToRef(r.x,r.y,r.z,Si._TargetTransformMatrix),Si._RigCamTransformMatrix.multiplyToRef(Si._TargetTransformMatrix,Si._RigCamTransformMatrix),A.TransformCoordinatesToRef(this.position,Si._RigCamTransformMatrix,t.position),t.setTarget(r)}getClassName(){return"TargetCamera"}}Si._RigCamTransformMatrix=new z;Si._TargetTransformMatrix=new z;Si._TargetFocalPoint=new A;R([Tn()],Si.prototype,"rotation",void 0);R([I()],Si.prototype,"speed",void 0);R([h1("lockedTargetId")],Si.prototype,"lockedTarget",void 0);var zn={};class GA{constructor(e){this.attachedToElement=!1,this.attached={},this.camera=e,this.checkInputs=()=>{}}add(e){const t=e.getSimpleName();if(this.attached[t]){ee.Warn("camera input of type "+t+" already exists on camera");return}this.attached[t]=e,e.camera=this.camera,e.checkInputs&&(this.checkInputs=this._addCheckInputs(e.checkInputs.bind(e))),this.attachedToElement&&e.attachControl(this.noPreventDefault)}remove(e){for(const t in this.attached){const i=this.attached[t];if(i===e){i.detachControl(),i.camera=null,delete this.attached[t],this.rebuildInputCheck();return}}}removeByType(e){for(const t in this.attached){const i=this.attached[t];i.getClassName()===e&&(i.detachControl(),i.camera=null,delete this.attached[t],this.rebuildInputCheck())}}_addCheckInputs(e){const t=this.checkInputs;return()=>{t(),e()}}attachInput(e){this.attachedToElement&&e.attachControl(this.noPreventDefault)}attachElement(e=!1){if(!this.attachedToElement){e=Ie.ForceAttachControlToAlwaysPreventDefault?!1:e,this.attachedToElement=!0,this.noPreventDefault=e;for(const t in this.attached)this.attached[t].attachControl(e)}}detachElement(e=!1){for(const t in this.attached)this.attached[t].detachControl(),e&&(this.attached[t].camera=null);this.attachedToElement=!1}rebuildInputCheck(){this.checkInputs=()=>{};for(const e in this.attached){const t=this.attached[e];t.checkInputs&&(this.checkInputs=this._addCheckInputs(t.checkInputs.bind(t)))}}clear(){this.attachedToElement&&this.detachElement(!0),this.attached={},this.attachedToElement=!1,this.checkInputs=()=>{}}serialize(e){const t={};for(const i in this.attached){const r=this.attached[i],s=Fe.Serialize(r);t[r.getClassName()]=s}e.inputsmgr=t}parse(e){const t=e.inputsmgr;if(t){this.clear();for(const i in t){const r=zn[i];if(r){const s=t[i],a=Fe.Parse(()=>new r,s,null);this.add(a)}}}else for(const i in this.attached){const r=zn[this.attached[i].getClassName()];if(r){const s=Fe.Parse(()=>new r,e,null);this.remove(this.attached[i]),this.add(s)}}}}class WA{constructor(){this._currentActiveButton=-1,this.buttons=[0,1,2]}attachControl(e){e=X.BackCompatCameraNoPreventDefault(arguments);const t=this.camera.getEngine(),i=t.getInputElement();let r=0,s=null;this._pointA=null,this._pointB=null,this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._buttonsPressed=0,this._pointerInput=l=>{var h,d;const o=l.event,c=o.pointerType==="touch";if(l.type!==be.POINTERMOVE&&this.buttons.indexOf(o.button)===-1)return;const u=o.target;if(this._altKey=o.altKey,this._ctrlKey=o.ctrlKey,this._metaKey=o.metaKey,this._shiftKey=o.shiftKey,this._buttonsPressed=o.buttons,t.isPointerLock){const f=o.movementX,_=o.movementY;this.onTouch(null,f,_),this._pointA=null,this._pointB=null}else{if(l.type!==be.POINTERDOWN&&c&&((h=this._pointA)==null?void 0:h.pointerId)!==o.pointerId&&((d=this._pointB)==null?void 0:d.pointerId)!==o.pointerId)return;if(l.type===be.POINTERDOWN&&(this._currentActiveButton===-1||c)){try{u==null||u.setPointerCapture(o.pointerId)}catch{}if(this._pointA===null)this._pointA={x:o.clientX,y:o.clientY,pointerId:o.pointerId,type:o.pointerType};else if(this._pointB===null)this._pointB={x:o.clientX,y:o.clientY,pointerId:o.pointerId,type:o.pointerType};else return;this._currentActiveButton===-1&&!c&&(this._currentActiveButton=o.button),this.onButtonDown(o),e||(o.preventDefault(),i&&i.focus())}else if(l.type===be.POINTERDOUBLETAP)this.onDoubleTap(o.pointerType);else if(l.type===be.POINTERUP&&(this._currentActiveButton===o.button||c)){try{u==null||u.releasePointerCapture(o.pointerId)}catch{}c||(this._pointB=null),t._badOS?this._pointA=this._pointB=null:this._pointB&&this._pointA&&this._pointA.pointerId==o.pointerId?(this._pointA=this._pointB,this._pointB=null):this._pointA&&this._pointB&&this._pointB.pointerId==o.pointerId?this._pointB=null:this._pointA=this._pointB=null,(r!==0||s)&&(this.onMultiTouch(this._pointA,this._pointB,r,0,s,null),r=0,s=null),this._currentActiveButton=-1,this.onButtonUp(o),e||o.preventDefault()}else if(l.type===be.POINTERMOVE){if(e||o.preventDefault(),this._pointA&&this._pointB===null){const f=o.clientX-this._pointA.x,_=o.clientY-this._pointA.y;this.onTouch(this._pointA,f,_),this._pointA.x=o.clientX,this._pointA.y=o.clientY}else if(this._pointA&&this._pointB){const f=this._pointA.pointerId===o.pointerId?this._pointA:this._pointB;f.x=o.clientX,f.y=o.clientY;const _=this._pointA.x-this._pointB.x,p=this._pointA.y-this._pointB.y,v=_*_+p*p,E={x:(this._pointA.x+this._pointB.x)/2,y:(this._pointA.y+this._pointB.y)/2,pointerId:o.pointerId,type:l.type};this.onMultiTouch(this._pointA,this._pointB,r,v,s,E),s=E,r=v}}}},this._observer=this.camera.getScene()._inputManager._addCameraPointerObserver(this._pointerInput,be.POINTERDOWN|be.POINTERUP|be.POINTERMOVE|be.POINTERDOUBLETAP),this._onLostFocus=()=>{this._pointA=this._pointB=null,r=0,s=null,this.onLostFocus()},this._contextMenuBind=l=>this.onContextMenu(l),i&&i.addEventListener("contextmenu",this._contextMenuBind,!1);const a=this.camera.getScene().getEngine().getHostWindow();a&&X.RegisterTopRootEvents(a,[{name:"blur",handler:this._onLostFocus}])}detachControl(){if(this._onLostFocus){const e=this.camera.getScene().getEngine().getHostWindow();e&&X.UnregisterTopRootEvents(e,[{name:"blur",handler:this._onLostFocus}])}if(this._observer){if(this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer),this._observer=null,this._contextMenuBind){const e=this.camera.getScene().getEngine().getInputElement();e&&e.removeEventListener("contextmenu",this._contextMenuBind)}this._onLostFocus=null}this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._buttonsPressed=0,this._currentActiveButton=-1}getClassName(){return"BaseCameraPointersInput"}getSimpleName(){return"pointers"}onDoubleTap(e){}onTouch(e,t,i){}onMultiTouch(e,t,i,r,s,a){}onContextMenu(e){e.preventDefault()}onButtonDown(e){}onButtonUp(e){}onLostFocus(){}}R([I()],WA.prototype,"buttons",void 0);class Lr extends WA{constructor(){super(...arguments),this.buttons=[0,1,2],this.angularSensibilityX=1e3,this.angularSensibilityY=1e3,this.pinchPrecision=12,this.pinchDeltaPercentage=0,this.useNaturalPinchZoom=!1,this.pinchZoom=!0,this.panningSensibility=1e3,this.multiTouchPanning=!0,this.multiTouchPanAndZoom=!0,this.pinchInwards=!0,this._isPanClick=!1,this._twoFingerActivityCount=0,this._isPinching=!1}getClassName(){return"ArcRotateCameraPointersInput"}_computeMultiTouchPanning(e,t){if(this.panningSensibility!==0&&e&&t){const i=t.x-e.x,r=t.y-e.y;this.camera.inertialPanningX+=-i/this.panningSensibility,this.camera.inertialPanningY+=r/this.panningSensibility}}_computePinchZoom(e,t){const i=this.camera.radius||Lr.MinimumRadiusForPinch;this.useNaturalPinchZoom?this.camera.radius=i*Math.sqrt(e)/Math.sqrt(t):this.pinchDeltaPercentage?this.camera.inertialRadiusOffset+=(t-e)*.001*i*this.pinchDeltaPercentage:this.camera.inertialRadiusOffset+=(t-e)/(this.pinchPrecision*(this.pinchInwards?1:-1)*(this.angularSensibilityX+this.angularSensibilityY)/2)}onTouch(e,t,i){this.panningSensibility!==0&&(this._ctrlKey&&this.camera._useCtrlForPanning||this._isPanClick)?(this.camera.inertialPanningX+=-t/this.panningSensibility,this.camera.inertialPanningY+=i/this.panningSensibility):(this.camera.inertialAlphaOffset-=t/this.angularSensibilityX,this.camera.inertialBetaOffset-=i/this.angularSensibilityY)}onDoubleTap(){this.camera.useInputToRestoreState&&this.camera.restoreState()}onMultiTouch(e,t,i,r,s,a){i===0&&s===null||r===0&&a===null||(this.multiTouchPanAndZoom?(this._computePinchZoom(i,r),this._computeMultiTouchPanning(s,a)):this.multiTouchPanning&&this.pinchZoom?(this._twoFingerActivityCount++,this._isPinching||this._twoFingerActivityCount<20&&Math.abs(Math.sqrt(r)-Math.sqrt(i))>this.camera.pinchToPanMaxDistance?(this._computePinchZoom(i,r),this._isPinching=!0):this._computeMultiTouchPanning(s,a)):this.multiTouchPanning?this._computeMultiTouchPanning(s,a):this.pinchZoom&&this._computePinchZoom(i,r))}onButtonDown(e){this._isPanClick=e.button===this.camera._panningMouseButton}onButtonUp(e){this._twoFingerActivityCount=0,this._isPinching=!1}onLostFocus(){this._isPanClick=!1,this._twoFingerActivityCount=0,this._isPinching=!1}}Lr.MinimumRadiusForPinch=.001;R([I()],Lr.prototype,"buttons",void 0);R([I()],Lr.prototype,"angularSensibilityX",void 0);R([I()],Lr.prototype,"angularSensibilityY",void 0);R([I()],Lr.prototype,"pinchPrecision",void 0);R([I()],Lr.prototype,"pinchDeltaPercentage",void 0);R([I()],Lr.prototype,"useNaturalPinchZoom",void 0);R([I()],Lr.prototype,"pinchZoom",void 0);R([I()],Lr.prototype,"panningSensibility",void 0);R([I()],Lr.prototype,"multiTouchPanning",void 0);R([I()],Lr.prototype,"multiTouchPanAndZoom",void 0);zn.ArcRotateCameraPointersInput=Lr;class Hn{constructor(){this.keysUp=[38],this.keysDown=[40],this.keysLeft=[37],this.keysRight=[39],this.keysReset=[220],this.panningSensibility=50,this.zoomingSensibility=25,this.useAltToZoom=!0,this.angularSpeed=.01,this._keys=new Array}attachControl(e){e=X.BackCompatCameraNoPreventDefault(arguments),!this._onCanvasBlurObserver&&(this._scene=this.camera.getScene(),this._engine=this._scene.getEngine(),this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add(()=>{this._keys.length=0}),this._onKeyboardObserver=this._scene.onKeyboardObservable.add(t=>{const i=t.event;if(!i.metaKey){if(t.type===So.KEYDOWN)this._ctrlPressed=i.ctrlKey,this._altPressed=i.altKey,(this.keysUp.indexOf(i.keyCode)!==-1||this.keysDown.indexOf(i.keyCode)!==-1||this.keysLeft.indexOf(i.keyCode)!==-1||this.keysRight.indexOf(i.keyCode)!==-1||this.keysReset.indexOf(i.keyCode)!==-1)&&(this._keys.indexOf(i.keyCode)===-1&&this._keys.push(i.keyCode),i.preventDefault&&(e||i.preventDefault()));else if(this.keysUp.indexOf(i.keyCode)!==-1||this.keysDown.indexOf(i.keyCode)!==-1||this.keysLeft.indexOf(i.keyCode)!==-1||this.keysRight.indexOf(i.keyCode)!==-1||this.keysReset.indexOf(i.keyCode)!==-1){const r=this._keys.indexOf(i.keyCode);r>=0&&this._keys.splice(r,1),i.preventDefault&&(e||i.preventDefault())}}}))}detachControl(){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onKeyboardObserver=null,this._onCanvasBlurObserver=null),this._keys.length=0}checkInputs(){if(this._onKeyboardObserver){const e=this.camera;for(let t=0;t<this._keys.length;t++){const i=this._keys[t];this.keysLeft.indexOf(i)!==-1?this._ctrlPressed&&this.camera._useCtrlForPanning?e.inertialPanningX-=1/this.panningSensibility:e.inertialAlphaOffset-=this.angularSpeed:this.keysUp.indexOf(i)!==-1?this._ctrlPressed&&this.camera._useCtrlForPanning?e.inertialPanningY+=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?e.inertialRadiusOffset+=1/this.zoomingSensibility:e.inertialBetaOffset-=this.angularSpeed:this.keysRight.indexOf(i)!==-1?this._ctrlPressed&&this.camera._useCtrlForPanning?e.inertialPanningX+=1/this.panningSensibility:e.inertialAlphaOffset+=this.angularSpeed:this.keysDown.indexOf(i)!==-1?this._ctrlPressed&&this.camera._useCtrlForPanning?e.inertialPanningY-=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?e.inertialRadiusOffset-=1/this.zoomingSensibility:e.inertialBetaOffset+=this.angularSpeed:this.keysReset.indexOf(i)!==-1&&e.useInputToRestoreState&&e.restoreState()}}}getClassName(){return"ArcRotateCameraKeyboardMoveInput"}getSimpleName(){return"keyboard"}}R([I()],Hn.prototype,"keysUp",void 0);R([I()],Hn.prototype,"keysDown",void 0);R([I()],Hn.prototype,"keysLeft",void 0);R([I()],Hn.prototype,"keysRight",void 0);R([I()],Hn.prototype,"keysReset",void 0);R([I()],Hn.prototype,"panningSensibility",void 0);R([I()],Hn.prototype,"zoomingSensibility",void 0);R([I()],Hn.prototype,"useAltToZoom",void 0);R([I()],Hn.prototype,"angularSpeed",void 0);zn.ArcRotateCameraKeyboardMoveInput=Hn;const Hz=40;class Ku{constructor(){this.wheelPrecision=3,this.zoomToMouseLocation=!1,this.wheelDeltaPercentage=0,this.customComputeDeltaFromMouseWheel=null,this._viewOffset=new A(0,0,0),this._globalOffset=new A(0,0,0),this._inertialPanning=A.Zero()}_computeDeltaFromMouseWheelLegacyEvent(e,t){let i=0;const r=e*.01*this.wheelDeltaPercentage*t;return e>0?i=r/(1+this.wheelDeltaPercentage):i=r*(1+this.wheelDeltaPercentage),i}attachControl(e){e=X.BackCompatCameraNoPreventDefault(arguments),this._wheel=t=>{if(t.type!==be.POINTERWHEEL)return;const i=t.event;let r=0;const s=i.deltaMode===tc.DOM_DELTA_LINE?Hz:1,a=-(i.deltaY*s);if(this.customComputeDeltaFromMouseWheel)r=this.customComputeDeltaFromMouseWheel(a,this,i);else if(this.wheelDeltaPercentage){if(r=this._computeDeltaFromMouseWheelLegacyEvent(a,this.camera.radius),r>0){let l=this.camera.radius,o=this.camera.inertialRadiusOffset+r;for(let c=0;c<20&&Math.abs(o)>.001;c++)l-=o,o*=this.camera.inertia;l=dt.Clamp(l,0,Number.MAX_VALUE),r=this._computeDeltaFromMouseWheelLegacyEvent(a,l)}}else r=a/(this.wheelPrecision*40);r&&(this.zoomToMouseLocation?(this._hitPlane||this._updateHitPlane(),this._zoomToMouse(r)):this.camera.inertialRadiusOffset+=r),i.preventDefault&&(e||i.preventDefault())},this._observer=this.camera.getScene()._inputManager._addCameraPointerObserver(this._wheel,be.POINTERWHEEL),this.zoomToMouseLocation&&this._inertialPanning.setAll(0)}detachControl(){this._observer&&(this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer),this._observer=null,this._wheel=null)}checkInputs(){if(!this.zoomToMouseLocation)return;const e=this.camera;0+e.inertialAlphaOffset+e.inertialBetaOffset+e.inertialRadiusOffset&&(this._updateHitPlane(),e.target.addInPlace(this._inertialPanning),this._inertialPanning.scaleInPlace(e.inertia),this._zeroIfClose(this._inertialPanning))}getClassName(){return"ArcRotateCameraMouseWheelInput"}getSimpleName(){return"mousewheel"}_updateHitPlane(){const e=this.camera,t=e.target.subtract(e.position);this._hitPlane=hn.FromPositionAndNormal(e.target,t)}_getPosition(){const e=this.camera,t=e.getScene(),i=t.createPickingRay(t.pointerX,t.pointerY,z.Identity(),e,!1);(e.targetScreenOffset.x!==0||e.targetScreenOffset.y!==0)&&(this._viewOffset.set(e.targetScreenOffset.x,e.targetScreenOffset.y,0),e.getViewMatrix().invertToRef(e._cameraTransformMatrix),this._globalOffset=A.TransformNormal(this._viewOffset,e._cameraTransformMatrix),i.origin.addInPlace(this._globalOffset));let r=0;return this._hitPlane&&(r=i.intersectsPlane(this._hitPlane)??0),i.origin.addInPlace(i.direction.scaleInPlace(r))}_zoomToMouse(e){const t=this.camera,i=1-t.inertia;if(t.lowerRadiusLimit){const o=t.lowerRadiusLimit??0;t.radius-(t.inertialRadiusOffset+e)/i<o&&(e=(t.radius-o)*i-t.inertialRadiusOffset)}if(t.upperRadiusLimit){const o=t.upperRadiusLimit??0;t.radius-(t.inertialRadiusOffset+e)/i>o&&(e=(t.radius-o)*i-t.inertialRadiusOffset)}const s=e/i/t.radius,a=this._getPosition(),l=V.Vector3[6];a.subtractToRef(t.target,l),l.scaleInPlace(s),l.scaleInPlace(i),this._inertialPanning.addInPlace(l),t.inertialRadiusOffset+=e}_zeroIfClose(e){Math.abs(e.x)<ut&&(e.x=0),Math.abs(e.y)<ut&&(e.y=0),Math.abs(e.z)<ut&&(e.z=0)}}R([I()],Ku.prototype,"wheelPrecision",void 0);R([I()],Ku.prototype,"zoomToMouseLocation",void 0);R([I()],Ku.prototype,"wheelDeltaPercentage",void 0);zn.ArcRotateCameraMouseWheelInput=Ku;class HA extends GA{constructor(e){super(e)}addMouseWheel(){return this.add(new Ku),this}addPointers(){return this.add(new Lr),this}addKeyboard(){return this.add(new Hn),this}}Mi.AddNodeConstructor("ArcRotateCamera",(n,e)=>()=>new Gt(n,0,0,1,A.Zero(),e));class Gt extends Si{get target(){return this._target}set target(e){this.setTarget(e)}get targetHost(){return this._targetHost}set targetHost(e){e&&this.setTarget(e)}getTarget(){return this.target}get position(){return this._position}set position(e){this.setPosition(e)}set upVector(e){this._upToYMatrix||(this._yToUpMatrix=new z,this._upToYMatrix=new z,this._upVector=A.Zero()),e.normalize(),this._upVector.copyFrom(e),this.setMatUp()}get upVector(){return this._upVector}setMatUp(){z.RotationAlignToRef(A.UpReadOnly,this._upVector,this._yToUpMatrix),z.RotationAlignToRef(this._upVector,A.UpReadOnly,this._upToYMatrix)}get angularSensibilityX(){const e=this.inputs.attached.pointers;return e?e.angularSensibilityX:0}set angularSensibilityX(e){const t=this.inputs.attached.pointers;t&&(t.angularSensibilityX=e)}get angularSensibilityY(){const e=this.inputs.attached.pointers;return e?e.angularSensibilityY:0}set angularSensibilityY(e){const t=this.inputs.attached.pointers;t&&(t.angularSensibilityY=e)}get pinchPrecision(){const e=this.inputs.attached.pointers;return e?e.pinchPrecision:0}set pinchPrecision(e){const t=this.inputs.attached.pointers;t&&(t.pinchPrecision=e)}get pinchDeltaPercentage(){const e=this.inputs.attached.pointers;return e?e.pinchDeltaPercentage:0}set pinchDeltaPercentage(e){const t=this.inputs.attached.pointers;t&&(t.pinchDeltaPercentage=e)}get useNaturalPinchZoom(){const e=this.inputs.attached.pointers;return e?e.useNaturalPinchZoom:!1}set useNaturalPinchZoom(e){const t=this.inputs.attached.pointers;t&&(t.useNaturalPinchZoom=e)}get panningSensibility(){const e=this.inputs.attached.pointers;return e?e.panningSensibility:0}set panningSensibility(e){const t=this.inputs.attached.pointers;t&&(t.panningSensibility=e)}get keysUp(){const e=this.inputs.attached.keyboard;return e?e.keysUp:[]}set keysUp(e){const t=this.inputs.attached.keyboard;t&&(t.keysUp=e)}get keysDown(){const e=this.inputs.attached.keyboard;return e?e.keysDown:[]}set keysDown(e){const t=this.inputs.attached.keyboard;t&&(t.keysDown=e)}get keysLeft(){const e=this.inputs.attached.keyboard;return e?e.keysLeft:[]}set keysLeft(e){const t=this.inputs.attached.keyboard;t&&(t.keysLeft=e)}get keysRight(){const e=this.inputs.attached.keyboard;return e?e.keysRight:[]}set keysRight(e){const t=this.inputs.attached.keyboard;t&&(t.keysRight=e)}get wheelPrecision(){const e=this.inputs.attached.mousewheel;return e?e.wheelPrecision:0}set wheelPrecision(e){const t=this.inputs.attached.mousewheel;t&&(t.wheelPrecision=e)}get zoomToMouseLocation(){const e=this.inputs.attached.mousewheel;return e?e.zoomToMouseLocation:!1}set zoomToMouseLocation(e){const t=this.inputs.attached.mousewheel;t&&(t.zoomToMouseLocation=e)}get wheelDeltaPercentage(){const e=this.inputs.attached.mousewheel;return e?e.wheelDeltaPercentage:0}set wheelDeltaPercentage(e){const t=this.inputs.attached.mousewheel;t&&(t.wheelDeltaPercentage=e)}get bouncingBehavior(){return this._bouncingBehavior}get useBouncingBehavior(){return this._bouncingBehavior!=null}set useBouncingBehavior(e){e!==this.useBouncingBehavior&&(e?(this._bouncingBehavior=new Ao,this.addBehavior(this._bouncingBehavior)):this._bouncingBehavior&&(this.removeBehavior(this._bouncingBehavior),this._bouncingBehavior=null))}get framingBehavior(){return this._framingBehavior}get useFramingBehavior(){return this._framingBehavior!=null}set useFramingBehavior(e){e!==this.useFramingBehavior&&(e?(this._framingBehavior=new Mr,this.addBehavior(this._framingBehavior)):this._framingBehavior&&(this.removeBehavior(this._framingBehavior),this._framingBehavior=null))}get autoRotationBehavior(){return this._autoRotationBehavior}get useAutoRotationBehavior(){return this._autoRotationBehavior!=null}set useAutoRotationBehavior(e){e!==this.useAutoRotationBehavior&&(e?(this._autoRotationBehavior=new Nz,this.addBehavior(this._autoRotationBehavior)):this._autoRotationBehavior&&(this.removeBehavior(this._autoRotationBehavior),this._autoRotationBehavior=null))}constructor(e,t,i,r,s,a,l=!0){super(e,A.Zero(),a,l),this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.lowerAlphaLimit=null,this.upperAlphaLimit=null,this.lowerBetaLimit=.01,this.upperBetaLimit=Math.PI-.01,this.lowerRadiusLimit=null,this.upperRadiusLimit=null,this.inertialPanningX=0,this.inertialPanningY=0,this.pinchToPanMaxDistance=20,this.panningDistanceLimit=null,this.panningOriginTarget=A.Zero(),this.panningInertia=.9,this.zoomOnFactor=1,this.targetScreenOffset=xe.Zero(),this.allowUpsideDown=!0,this.useInputToRestoreState=!0,this._viewMatrix=new z,this.panningAxis=new A(1,1,0),this._transformedDirection=new A,this.mapPanning=!1,this.onMeshTargetChangedObservable=new Y,this.checkCollisions=!1,this.collisionRadius=new A(.5,.5,.5),this._previousPosition=A.Zero(),this._collisionVelocity=A.Zero(),this._newPosition=A.Zero(),this._computationVector=A.Zero(),this._onCollisionPositionChange=(o,c,u=null)=>{u?(this.setPosition(c),this.onCollide&&this.onCollide(u)):this._previousPosition.copyFrom(this._position);const h=Math.cos(this.alpha),d=Math.sin(this.alpha),f=Math.cos(this.beta);let _=Math.sin(this.beta);_===0&&(_=1e-4);const p=this._getTargetPosition();this._computationVector.copyFromFloats(this.radius*h*_,this.radius*f,this.radius*d*_),p.addToRef(this._computationVector,this._newPosition),this._position.copyFrom(this._newPosition);let v=this.upVector;this.allowUpsideDown&&this.beta<0&&(v=v.clone(),v=v.negate()),this._computeViewMatrix(this._position,p,v),this._viewMatrix.addAtIndex(12,this.targetScreenOffset.x),this._viewMatrix.addAtIndex(13,this.targetScreenOffset.y),this._collisionTriggered=!1},this._target=A.Zero(),s&&this.setTarget(s),this.alpha=t,this.beta=i,this.radius=r,this.getViewMatrix(),this.inputs=new HA(this),this.inputs.addKeyboard().addMouseWheel().addPointers()}_initCache(){super._initCache(),this._cache._target=new A(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.alpha=void 0,this._cache.beta=void 0,this._cache.radius=void 0,this._cache.targetScreenOffset=xe.Zero()}_updateCache(e){e||super._updateCache(),this._cache._target.copyFrom(this._getTargetPosition()),this._cache.alpha=this.alpha,this._cache.beta=this.beta,this._cache.radius=this.radius,this._cache.targetScreenOffset.copyFrom(this.targetScreenOffset)}_getTargetPosition(){if(this._targetHost&&this._targetHost.getAbsolutePosition){const t=this._targetHost.getAbsolutePosition();this._targetBoundingCenter?t.addToRef(this._targetBoundingCenter,this._target):this._target.copyFrom(t)}const e=this._getLockedTargetPosition();return e||this._target}storeState(){return this._storedAlpha=this.alpha,this._storedBeta=this.beta,this._storedRadius=this.radius,this._storedTarget=this._getTargetPosition().clone(),this._storedTargetScreenOffset=this.targetScreenOffset.clone(),super.storeState()}_restoreStateValues(){return super._restoreStateValues()?(this.setTarget(this._storedTarget.clone()),this.alpha=this._storedAlpha,this.beta=this._storedBeta,this.radius=this._storedRadius,this.targetScreenOffset=this._storedTargetScreenOffset.clone(),this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.inertialPanningX=0,this.inertialPanningY=0,!0):!1}_isSynchronizedViewMatrix(){return super._isSynchronizedViewMatrix()?this._cache._target.equals(this._getTargetPosition())&&this._cache.alpha===this.alpha&&this._cache.beta===this.beta&&this._cache.radius===this.radius&&this._cache.targetScreenOffset.equals(this.targetScreenOffset):!1}attachControl(e,t,i=!0,r=2){const s=arguments;t=X.BackCompatCameraNoPreventDefault(s),this._useCtrlForPanning=i,this._panningMouseButton=r,typeof s[0]=="boolean"&&(s.length>1&&(this._useCtrlForPanning=s[1]),s.length>2&&(this._panningMouseButton=s[2])),this.inputs.attachElement(t),this._reset=()=>{this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.inertialPanningX=0,this.inertialPanningY=0}}detachControl(){this.inputs.detachElement(),this._reset&&this._reset()}_checkInputs(){if(!this._collisionTriggered){if(this.inputs.checkInputs(),this.inertialAlphaOffset!==0||this.inertialBetaOffset!==0||this.inertialRadiusOffset!==0){const e=this.invertRotation?-1:1,t=this._calculateHandednessMultiplier();let i=this.inertialAlphaOffset*t;this.beta<0&&(i*=-1),this.alpha+=i*e,this.beta+=this.inertialBetaOffset*e,this.radius-=this.inertialRadiusOffset,this.inertialAlphaOffset*=this.inertia,this.inertialBetaOffset*=this.inertia,this.inertialRadiusOffset*=this.inertia,Math.abs(this.inertialAlphaOffset)<ut&&(this.inertialAlphaOffset=0),Math.abs(this.inertialBetaOffset)<ut&&(this.inertialBetaOffset=0),Math.abs(this.inertialRadiusOffset)<this.speed*ut&&(this.inertialRadiusOffset=0)}if(this.inertialPanningX!==0||this.inertialPanningY!==0){const e=new A(this.inertialPanningX,this.inertialPanningY,this.inertialPanningY);if(this._viewMatrix.invertToRef(this._cameraTransformMatrix),e.multiplyInPlace(this.panningAxis),A.TransformNormalToRef(e,this._cameraTransformMatrix,this._transformedDirection),this.mapPanning){const t=this.upVector,i=A.CrossToRef(this._transformedDirection,t,this._transformedDirection);A.CrossToRef(t,i,this._transformedDirection)}else this.panningAxis.y||(this._transformedDirection.y=0);if(!this._targetHost)if(this.panningDistanceLimit)this._transformedDirection.addInPlace(this._target),A.DistanceSquared(this._transformedDirection,this.panningOriginTarget)<=this.panningDistanceLimit*this.panningDistanceLimit&&this._target.copyFrom(this._transformedDirection);else{if(this.parent){const t=V.Matrix[0];this.parent.getWorldMatrix().getRotationMatrixToRef(t),t.transposeToRef(t),A.TransformCoordinatesToRef(this._transformedDirection,t,this._transformedDirection)}this._target.addInPlace(this._transformedDirection)}this.inertialPanningX*=this.panningInertia,this.inertialPanningY*=this.panningInertia,Math.abs(this.inertialPanningX)<this.speed*ut&&(this.inertialPanningX=0),Math.abs(this.inertialPanningY)<this.speed*ut&&(this.inertialPanningY=0)}this._checkLimits(),super._checkInputs()}}_checkLimits(){this.lowerBetaLimit===null||this.lowerBetaLimit===void 0?this.allowUpsideDown&&this.beta>Math.PI&&(this.beta=this.beta-2*Math.PI):this.beta<this.lowerBetaLimit&&(this.beta=this.lowerBetaLimit),this.upperBetaLimit===null||this.upperBetaLimit===void 0?this.allowUpsideDown&&this.beta<-Math.PI&&(this.beta=this.beta+2*Math.PI):this.beta>this.upperBetaLimit&&(this.beta=this.upperBetaLimit),this.lowerAlphaLimit!==null&&this.alpha<this.lowerAlphaLimit&&(this.alpha=this.lowerAlphaLimit),this.upperAlphaLimit!==null&&this.alpha>this.upperAlphaLimit&&(this.alpha=this.upperAlphaLimit),this.lowerRadiusLimit!==null&&this.radius<this.lowerRadiusLimit&&(this.radius=this.lowerRadiusLimit,this.inertialRadiusOffset=0),this.upperRadiusLimit!==null&&this.radius>this.upperRadiusLimit&&(this.radius=this.upperRadiusLimit,this.inertialRadiusOffset=0)}rebuildAnglesAndRadius(){this._position.subtractToRef(this._getTargetPosition(),this._computationVector),(this._upVector.x!==0||this._upVector.y!==1||this._upVector.z!==0)&&A.TransformCoordinatesToRef(this._computationVector,this._upToYMatrix,this._computationVector),this.radius=this._computationVector.length(),this.radius===0&&(this.radius=1e-4);const e=this.alpha;this._computationVector.x===0&&this._computationVector.z===0?this.alpha=Math.PI/2:this.alpha=Math.acos(this._computationVector.x/Math.sqrt(Math.pow(this._computationVector.x,2)+Math.pow(this._computationVector.z,2))),this._computationVector.z<0&&(this.alpha=2*Math.PI-this.alpha);const t=Math.round((e-this.alpha)/(2*Math.PI));this.alpha+=t*2*Math.PI,this.beta=Math.acos(this._computationVector.y/this.radius),this._checkLimits()}setPosition(e){this._position.equals(e)||(this._position.copyFrom(e),this.rebuildAnglesAndRadius())}setTarget(e,t=!1,i=!1,r=!1){if(r=this.overrideCloneAlphaBetaRadius??r,e.computeWorldMatrix)t&&e.getBoundingInfo?this._targetBoundingCenter=e.getBoundingInfo().boundingBox.centerWorld.clone():this._targetBoundingCenter=null,e.computeWorldMatrix(),this._targetHost=e,this._target=this._getTargetPosition(),this.onMeshTargetChangedObservable.notifyObservers(this._targetHost);else{const s=e,a=this._getTargetPosition();if(a&&!i&&a.equals(s))return;this._targetHost=null,this._target=s,this._targetBoundingCenter=null,this.onMeshTargetChangedObservable.notifyObservers(null)}r||this.rebuildAnglesAndRadius()}_getViewMatrix(){const e=Math.cos(this.alpha),t=Math.sin(this.alpha),i=Math.cos(this.beta);let r=Math.sin(this.beta);r===0&&(r=1e-4),this.radius===0&&(this.radius=1e-4);const s=this._getTargetPosition();if(this._computationVector.copyFromFloats(this.radius*e*r,this.radius*i,this.radius*t*r),(this._upVector.x!==0||this._upVector.y!==1||this._upVector.z!==0)&&A.TransformCoordinatesToRef(this._computationVector,this._yToUpMatrix,this._computationVector),s.addToRef(this._computationVector,this._newPosition),this.getScene().collisionsEnabled&&this.checkCollisions){const a=this.getScene().collisionCoordinator;this._collider||(this._collider=a.createCollider()),this._collider._radius=this.collisionRadius,this._newPosition.subtractToRef(this._position,this._collisionVelocity),this._collisionTriggered=!0,a.getNewPosition(this._position,this._collisionVelocity,this._collider,3,null,this._onCollisionPositionChange,this.uniqueId)}else{this._position.copyFrom(this._newPosition);let a=this.upVector;this.allowUpsideDown&&r<0&&(a=a.negate()),this._computeViewMatrix(this._position,s,a),this._viewMatrix.addAtIndex(12,this.targetScreenOffset.x),this._viewMatrix.addAtIndex(13,this.targetScreenOffset.y)}return this._currentTarget=s,this._viewMatrix}zoomOn(e,t=!1){e=e||this.getScene().meshes;const i=Ae.MinMax(e);let r=this._calculateLowerRadiusFromModelBoundingSphere(i.min,i.max);r=Math.max(Math.min(r,this.upperRadiusLimit||Number.MAX_VALUE),this.lowerRadiusLimit||0),this.radius=r*this.zoomOnFactor,this.focusOn({min:i.min,max:i.max,distance:r},t)}focusOn(e,t=!1){let i,r;if(e.min===void 0){const s=e||this.getScene().meshes;i=Ae.MinMax(s),r=A.Distance(i.min,i.max)}else{const s=e;i=s,r=s.distance}this._target=Ae.Center(i),t||(this.maxZ=r*2)}createRigCamera(e,t){let i=0;switch(this.cameraRigMode){case Ie.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case Ie.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case Ie.RIG_MODE_STEREOSCOPIC_OVERUNDER:case Ie.RIG_MODE_STEREOSCOPIC_INTERLACED:case Ie.RIG_MODE_VR:i=this._cameraRigParams.stereoHalfAngle*(t===0?1:-1);break;case Ie.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:i=this._cameraRigParams.stereoHalfAngle*(t===0?-1:1);break}const r=new Gt(e,this.alpha+i,this.beta,this.radius,this._target,this.getScene());return r._cameraRigParams={},r.isRigCamera=!0,r.rigParent=this,r.upVector=this.upVector,r.mode=this.mode,r.orthoLeft=this.orthoLeft,r.orthoRight=this.orthoRight,r.orthoBottom=this.orthoBottom,r.orthoTop=this.orthoTop,r}_updateRigCameras(){const e=this._rigCameras[0],t=this._rigCameras[1];switch(e.beta=t.beta=this.beta,this.cameraRigMode){case Ie.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case Ie.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case Ie.RIG_MODE_STEREOSCOPIC_OVERUNDER:case Ie.RIG_MODE_STEREOSCOPIC_INTERLACED:case Ie.RIG_MODE_VR:e.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle,t.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle;break;case Ie.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:e.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle,t.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle;break}super._updateRigCameras()}_calculateLowerRadiusFromModelBoundingSphere(e,t,i=1){const r=A.Distance(e,t),a=this.getScene().getEngine().getAspectRatio(this),l=Math.tan(this.fov/2),o=l*a,u=r*.5*i,h=u*Math.sqrt(1+1/(o*o)),d=u*Math.sqrt(1+1/(l*l));return Math.max(h,d)}dispose(){this.inputs.clear(),super.dispose()}getClassName(){return"ArcRotateCamera"}}R([I()],Gt.prototype,"alpha",void 0);R([I()],Gt.prototype,"beta",void 0);R([I()],Gt.prototype,"radius",void 0);R([I()],Gt.prototype,"overrideCloneAlphaBetaRadius",void 0);R([Tn("target")],Gt.prototype,"_target",void 0);R([h1("targetHost")],Gt.prototype,"_targetHost",void 0);R([I()],Gt.prototype,"inertialAlphaOffset",void 0);R([I()],Gt.prototype,"inertialBetaOffset",void 0);R([I()],Gt.prototype,"inertialRadiusOffset",void 0);R([I()],Gt.prototype,"lowerAlphaLimit",void 0);R([I()],Gt.prototype,"upperAlphaLimit",void 0);R([I()],Gt.prototype,"lowerBetaLimit",void 0);R([I()],Gt.prototype,"upperBetaLimit",void 0);R([I()],Gt.prototype,"lowerRadiusLimit",void 0);R([I()],Gt.prototype,"upperRadiusLimit",void 0);R([I()],Gt.prototype,"inertialPanningX",void 0);R([I()],Gt.prototype,"inertialPanningY",void 0);R([I()],Gt.prototype,"pinchToPanMaxDistance",void 0);R([I()],Gt.prototype,"panningDistanceLimit",void 0);R([Tn()],Gt.prototype,"panningOriginTarget",void 0);R([I()],Gt.prototype,"panningInertia",void 0);R([I()],Gt.prototype,"zoomToMouseLocation",null);R([I()],Gt.prototype,"zoomOnFactor",void 0);R([u1()],Gt.prototype,"targetScreenOffset",void 0);R([I()],Gt.prototype,"allowUpsideDown",void 0);R([I()],Gt.prototype,"useInputToRestoreState",void 0);const Qn=[Math.sqrt(1/(4*Math.PI)),-Math.sqrt(3/(4*Math.PI)),Math.sqrt(3/(4*Math.PI)),-Math.sqrt(3/(4*Math.PI)),Math.sqrt(15/(4*Math.PI)),-Math.sqrt(15/(4*Math.PI)),Math.sqrt(5/(16*Math.PI)),-Math.sqrt(15/(4*Math.PI)),Math.sqrt(15/(16*Math.PI))],jz=[()=>1,n=>n.y,n=>n.z,n=>n.x,n=>n.x*n.y,n=>n.y*n.z,n=>3*n.z*n.z-1,n=>n.x*n.z,n=>n.x*n.x-n.y*n.y],gs=(n,e)=>Qn[n]*jz[n](e),ms=[Math.PI,2*Math.PI/3,2*Math.PI/3,2*Math.PI/3,Math.PI/4,Math.PI/4,Math.PI/4,Math.PI/4,Math.PI/4];class Pu{constructor(){this.preScaled=!1,this.l00=A.Zero(),this.l1_1=A.Zero(),this.l10=A.Zero(),this.l11=A.Zero(),this.l2_2=A.Zero(),this.l2_1=A.Zero(),this.l20=A.Zero(),this.l21=A.Zero(),this.l22=A.Zero()}addLight(e,t,i){V.Vector3[0].set(t.r,t.g,t.b);const r=V.Vector3[0],s=V.Vector3[1];r.scaleToRef(i,s),s.scaleToRef(gs(0,e),V.Vector3[2]),this.l00.addInPlace(V.Vector3[2]),s.scaleToRef(gs(1,e),V.Vector3[2]),this.l1_1.addInPlace(V.Vector3[2]),s.scaleToRef(gs(2,e),V.Vector3[2]),this.l10.addInPlace(V.Vector3[2]),s.scaleToRef(gs(3,e),V.Vector3[2]),this.l11.addInPlace(V.Vector3[2]),s.scaleToRef(gs(4,e),V.Vector3[2]),this.l2_2.addInPlace(V.Vector3[2]),s.scaleToRef(gs(5,e),V.Vector3[2]),this.l2_1.addInPlace(V.Vector3[2]),s.scaleToRef(gs(6,e),V.Vector3[2]),this.l20.addInPlace(V.Vector3[2]),s.scaleToRef(gs(7,e),V.Vector3[2]),this.l21.addInPlace(V.Vector3[2]),s.scaleToRef(gs(8,e),V.Vector3[2]),this.l22.addInPlace(V.Vector3[2])}scaleInPlace(e){this.l00.scaleInPlace(e),this.l1_1.scaleInPlace(e),this.l10.scaleInPlace(e),this.l11.scaleInPlace(e),this.l2_2.scaleInPlace(e),this.l2_1.scaleInPlace(e),this.l20.scaleInPlace(e),this.l21.scaleInPlace(e),this.l22.scaleInPlace(e)}convertIncidentRadianceToIrradiance(){this.l00.scaleInPlace(ms[0]),this.l1_1.scaleInPlace(ms[1]),this.l10.scaleInPlace(ms[2]),this.l11.scaleInPlace(ms[3]),this.l2_2.scaleInPlace(ms[4]),this.l2_1.scaleInPlace(ms[5]),this.l20.scaleInPlace(ms[6]),this.l21.scaleInPlace(ms[7]),this.l22.scaleInPlace(ms[8])}convertIrradianceToLambertianRadiance(){this.scaleInPlace(1/Math.PI)}preScaleForRendering(){this.preScaled=!0,this.l00.scaleInPlace(Qn[0]),this.l1_1.scaleInPlace(Qn[1]),this.l10.scaleInPlace(Qn[2]),this.l11.scaleInPlace(Qn[3]),this.l2_2.scaleInPlace(Qn[4]),this.l2_1.scaleInPlace(Qn[5]),this.l20.scaleInPlace(Qn[6]),this.l21.scaleInPlace(Qn[7]),this.l22.scaleInPlace(Qn[8])}updateFromArray(e){return A.FromArrayToRef(e[0],0,this.l00),A.FromArrayToRef(e[1],0,this.l1_1),A.FromArrayToRef(e[2],0,this.l10),A.FromArrayToRef(e[3],0,this.l11),A.FromArrayToRef(e[4],0,this.l2_2),A.FromArrayToRef(e[5],0,this.l2_1),A.FromArrayToRef(e[6],0,this.l20),A.FromArrayToRef(e[7],0,this.l21),A.FromArrayToRef(e[8],0,this.l22),this}updateFromFloatsArray(e){return A.FromFloatsToRef(e[0],e[1],e[2],this.l00),A.FromFloatsToRef(e[3],e[4],e[5],this.l1_1),A.FromFloatsToRef(e[6],e[7],e[8],this.l10),A.FromFloatsToRef(e[9],e[10],e[11],this.l11),A.FromFloatsToRef(e[12],e[13],e[14],this.l2_2),A.FromFloatsToRef(e[15],e[16],e[17],this.l2_1),A.FromFloatsToRef(e[18],e[19],e[20],this.l20),A.FromFloatsToRef(e[21],e[22],e[23],this.l21),A.FromFloatsToRef(e[24],e[25],e[26],this.l22),this}static FromArray(e){return new Pu().updateFromArray(e)}static FromPolynomial(e){const t=new Pu;return t.l00=e.xx.scale(.376127).add(e.yy.scale(.376127)).add(e.zz.scale(.376126)),t.l1_1=e.y.scale(.977204),t.l10=e.z.scale(.977204),t.l11=e.x.scale(.977204),t.l2_2=e.xy.scale(1.16538),t.l2_1=e.yz.scale(1.16538),t.l20=e.zz.scale(1.34567).subtract(e.xx.scale(.672834)).subtract(e.yy.scale(.672834)),t.l21=e.zx.scale(1.16538),t.l22=e.xx.scale(1.16538).subtract(e.yy.scale(1.16538)),t.l1_1.scaleInPlace(-1),t.l11.scaleInPlace(-1),t.l2_1.scaleInPlace(-1),t.l21.scaleInPlace(-1),t.scaleInPlace(Math.PI),t}}class zd{constructor(){this.x=A.Zero(),this.y=A.Zero(),this.z=A.Zero(),this.xx=A.Zero(),this.yy=A.Zero(),this.zz=A.Zero(),this.xy=A.Zero(),this.yz=A.Zero(),this.zx=A.Zero()}get preScaledHarmonics(){return this._harmonics||(this._harmonics=Pu.FromPolynomial(this)),this._harmonics.preScaled||this._harmonics.preScaleForRendering(),this._harmonics}addAmbient(e){V.Vector3[0].copyFromFloats(e.r,e.g,e.b);const t=V.Vector3[0];this.xx.addInPlace(t),this.yy.addInPlace(t),this.zz.addInPlace(t)}scaleInPlace(e){this.x.scaleInPlace(e),this.y.scaleInPlace(e),this.z.scaleInPlace(e),this.xx.scaleInPlace(e),this.yy.scaleInPlace(e),this.zz.scaleInPlace(e),this.yz.scaleInPlace(e),this.zx.scaleInPlace(e),this.xy.scaleInPlace(e)}updateFromHarmonics(e){return this._harmonics=e,this.x.copyFrom(e.l11),this.x.scaleInPlace(1.02333).scaleInPlace(-1),this.y.copyFrom(e.l1_1),this.y.scaleInPlace(1.02333).scaleInPlace(-1),this.z.copyFrom(e.l10),this.z.scaleInPlace(1.02333),this.xx.copyFrom(e.l00),V.Vector3[0].copyFrom(e.l20).scaleInPlace(.247708),V.Vector3[1].copyFrom(e.l22).scaleInPlace(.429043),this.xx.scaleInPlace(.886277).subtractInPlace(V.Vector3[0]).addInPlace(V.Vector3[1]),this.yy.copyFrom(e.l00),this.yy.scaleInPlace(.886277).subtractInPlace(V.Vector3[0]).subtractInPlace(V.Vector3[1]),this.zz.copyFrom(e.l00),V.Vector3[0].copyFrom(e.l20).scaleInPlace(.495417),this.zz.scaleInPlace(.886277).addInPlace(V.Vector3[0]),this.yz.copyFrom(e.l2_1),this.yz.scaleInPlace(.858086).scaleInPlace(-1),this.zx.copyFrom(e.l21),this.zx.scaleInPlace(.858086).scaleInPlace(-1),this.xy.copyFrom(e.l2_2),this.xy.scaleInPlace(.858086),this.scaleInPlace(1/Math.PI),this}static FromHarmonics(e){return new zd().updateFromHarmonics(e)}static FromArray(e){const t=new zd;return A.FromArrayToRef(e[0],0,t.x),A.FromArrayToRef(e[1],0,t.y),A.FromArrayToRef(e[2],0,t.z),A.FromArrayToRef(e[3],0,t.xx),A.FromArrayToRef(e[4],0,t.yy),A.FromArrayToRef(e[5],0,t.zz),A.FromArrayToRef(e[6],0,t.yz),A.FromArrayToRef(e[7],0,t.zx),A.FromArrayToRef(e[8],0,t.xy),t}}class Ls{}Ls.COPY=1;Ls.CUT=2;Ls.PASTE=3;class lp{constructor(e,t){this.type=e,this.event=t}static GetTypeFromCharacter(e){switch(e){case 67:return Ls.COPY;case 86:return Ls.PASTE;case 88:return Ls.CUT;default:return-1}}}we.prototype.createDynamicTexture=function(n,e,t,i){const r=new Qr(this,Xt.Dynamic);return r.baseWidth=n,r.baseHeight=e,t&&(n=this.needPOTTextures?we.GetExponentOfTwo(n,this._caps.maxTextureSize):n,e=this.needPOTTextures?we.GetExponentOfTwo(e,this._caps.maxTextureSize):e),r.width=n,r.height=e,r.isReady=!1,r.generateMipMaps=t,r.samplingMode=i,this.updateTextureSamplingMode(i,r),this._internalTexturesCache.push(r),r};we.prototype.updateDynamicTexture=function(n,e,t,i=!1,r,s=!1,a=!1){if(!n)return;const l=this._gl,o=l.TEXTURE_2D,c=this._bindTextureDirectly(o,n,!0,s);this._unpackFlipY(t===void 0?n.invertY:t),i&&l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1);const u=this._getWebGLTextureType(n.type),h=this._getInternalFormat(r||n.format),d=this._getRGBABufferInternalSizedFormat(n.type,h);l.texImage2D(o,0,d,h,u,e),n.generateMipMaps&&l.generateMipmap(o),c||this._bindTextureDirectly(o,null),i&&l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),r&&(n.format=r),n._dynamicTextureSource=e,n._premulAlpha=i,n.invertY=t||!1,n.isReady=!0};class wu extends re{constructor(e,t,i=null,r=!1,s=3,a=5,l){super(null,i,!r,l,s,void 0,void 0,void 0,void 0,a),this.name=e,this.wrapU=re.CLAMP_ADDRESSMODE,this.wrapV=re.CLAMP_ADDRESSMODE,this._generateMipMaps=r;const o=this._getEngine();if(!o)return;t.getContext?(this._canvas=t,this._ownCanvas=!1,this._texture=o.createDynamicTexture(t.width,t.height,r,s)):(this._canvas=o.createCanvas(1,1),this._ownCanvas=!0,t.width||t.width===0?this._texture=o.createDynamicTexture(t.width,t.height,r,s):this._texture=o.createDynamicTexture(t,t,r,s));const c=this.getSize();this._canvas.width!==c.width&&(this._canvas.width=c.width),this._canvas.height!==c.height&&(this._canvas.height=c.height),this._context=this._canvas.getContext("2d")}getClassName(){return"DynamicTexture"}get canRescale(){return!0}_recreate(e){this._canvas.width=e.width,this._canvas.height=e.height,this.releaseInternalTexture(),this._texture=this._getEngine().createDynamicTexture(e.width,e.height,this._generateMipMaps,this.samplingMode)}scale(e){const t=this.getSize();t.width*=e,t.height*=e,this._recreate(t)}scaleTo(e,t){const i=this.getSize();i.width=e,i.height=t,this._recreate(i)}getContext(){return this._context}clear(e){const t=this.getSize();e&&(this._context.fillStyle=e),this._context.clearRect(0,0,t.width,t.height)}update(e,t=!1,i=!1){this._getEngine().updateDynamicTexture(this._texture,this._canvas,e===void 0?!0:e,t,this._format||void 0,void 0,i)}drawText(e,t,i,r,s,a,l,o=!0){const c=this.getSize();if(a&&(this._context.fillStyle=a,this._context.fillRect(0,0,c.width,c.height)),this._context.font=r,t==null){const u=this._context.measureText(e);t=(c.width-u.width)/2}if(i==null){const u=parseInt(r.replace(/\D/g,""));i=c.height/2+u/3.65}this._context.fillStyle=s||"",this._context.fillText(e,t,i),o&&this.update(l)}dispose(){var e,t;super.dispose(),this._ownCanvas&&((t=(e=this._canvas)==null?void 0:e.remove)==null||t.call(e)),this._canvas=null,this._context=null}clone(){const e=this.getScene();if(!e)return this;const t=this.getSize(),i=new wu(this.name,t,e,this._generateMipMaps);return i.hasAlpha=this.hasAlpha,i.level=this.level,i.wrapU=this.wrapU,i.wrapV=this.wrapV,i}serialize(){const e=this.getScene();e&&!e.isReady()&&ee.Warn("The scene must be ready before serializing the dynamic texture");const t=super.serialize();return wu._IsCanvasElement(this._canvas)&&(t.base64String=this._canvas.toDataURL()),t.invertY=this._invertY,t.samplingMode=this.samplingMode,t}static _IsCanvasElement(e){return e.toDataURL!==void 0}_rebuild(){this.update()}}class Xz{constructor(e){this.name=Oe.NAME_LAYER,this.scene=e||He.LastCreatedScene,this.scene&&(this._engine=this.scene.getEngine(),this.scene.layers=[])}register(){this.scene._beforeCameraDrawStage.registerStep(Oe.STEP_BEFORECAMERADRAW_LAYER,this,this._drawCameraBackground),this.scene._afterCameraDrawStage.registerStep(Oe.STEP_AFTERCAMERADRAW_LAYER,this,this._drawCameraForegroundWithPostProcessing),this.scene._afterCameraPostProcessStage.registerStep(Oe.STEP_AFTERCAMERAPOSTPROCESS_LAYER,this,this._drawCameraForegroundWithoutPostProcessing),this.scene._beforeRenderTargetDrawStage.registerStep(Oe.STEP_BEFORERENDERTARGETDRAW_LAYER,this,this._drawRenderTargetBackground),this.scene._afterRenderTargetDrawStage.registerStep(Oe.STEP_AFTERRENDERTARGETDRAW_LAYER,this,this._drawRenderTargetForegroundWithPostProcessing),this.scene._afterRenderTargetPostProcessStage.registerStep(Oe.STEP_AFTERRENDERTARGETPOSTPROCESS_LAYER,this,this._drawRenderTargetForegroundWithoutPostProcessing)}rebuild(){const e=this.scene.layers;for(const t of e)t._rebuild()}dispose(){const e=this.scene.layers;for(;e.length;)e[0].dispose()}_draw(e){const t=this.scene.layers;if(t.length){this._engine.setDepthBuffer(!1);for(const i of t)e(i)&&i.render();this._engine.setDepthBuffer(!0)}}_drawCameraPredicate(e,t,i,r){return!e.renderOnlyInRenderTargetTextures&&e.isBackground===t&&e.applyPostProcess===i&&(e.layerMask&r)!==0}_drawCameraBackground(e){this._draw(t=>this._drawCameraPredicate(t,!0,!0,e.layerMask))}_drawCameraForegroundWithPostProcessing(e){this._draw(t=>this._drawCameraPredicate(t,!1,!0,e.layerMask))}_drawCameraForegroundWithoutPostProcessing(e){this._draw(t=>this._drawCameraPredicate(t,!1,!1,e.layerMask))}_drawRenderTargetPredicate(e,t,i,r,s){return e.renderTargetTextures.length>0&&e.isBackground===t&&e.applyPostProcess===i&&e.renderTargetTextures.indexOf(s)>-1&&(e.layerMask&r)!==0}_drawRenderTargetBackground(e){this._draw(t=>this._drawRenderTargetPredicate(t,!0,!0,this.scene.activeCamera.layerMask,e))}_drawRenderTargetForegroundWithPostProcessing(e){this._draw(t=>this._drawRenderTargetPredicate(t,!1,!0,this.scene.activeCamera.layerMask,e))}_drawRenderTargetForegroundWithoutPostProcessing(e){this._draw(t=>this._drawRenderTargetPredicate(t,!1,!1,this.scene.activeCamera.layerMask,e))}addFromContainer(e){e.layers&&e.layers.forEach(t=>{this.scene.layers.push(t)})}removeFromContainer(e,t=!1){e.layers&&e.layers.forEach(i=>{const r=this.scene.layers.indexOf(i);r!==-1&&this.scene.layers.splice(r,1),t&&i.dispose()})}}const Yz="layerPixelShader",Kz=`varying vec2 vUV;uniform sampler2D textureSampler;uniform vec4 color;
#include<helperFunctions>
#define CUSTOM_FRAGMENT_DEFINITIONS
void main(void) {
#define CUSTOM_FRAGMENT_MAIN_BEGIN
vec4 baseColor=texture2D(textureSampler,vUV);
#ifdef LINEAR
baseColor.rgb=toGammaSpace(baseColor.rgb);
#endif
#ifdef ALPHATEST
if (baseColor.a<0.4)
discard;
#endif
gl_FragColor=baseColor*color;
#define CUSTOM_FRAGMENT_MAIN_END
}`;ne.ShadersStore[Yz]=Kz;const qz="layerVertexShader",$z=`attribute vec2 position;uniform vec2 scale;uniform vec2 offset;uniform mat4 textureMatrix;varying vec2 vUV;const vec2 madd=vec2(0.5,0.5);
#define CUSTOM_VERTEX_DEFINITIONS
void main(void) {
#define CUSTOM_VERTEX_MAIN_BEGIN
vec2 shiftedPosition=position*scale+offset;vUV=vec2(textureMatrix*vec4(shiftedPosition*madd+madd,1.0,0.0));gl_Position=vec4(shiftedPosition,0.0,1.0);
#define CUSTOM_VERTEX_MAIN_END
}`;ne.ShadersStore[qz]=$z;let Qz=class{set applyPostProcess(e){this._applyPostProcess=e}get applyPostProcess(){return this.isBackground||this._applyPostProcess}set onDispose(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)}set onBeforeRender(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e)}set onAfterRender(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(e)}constructor(e,t,i,r,s){this.name=e,this._applyPostProcess=!0,this.scale=new xe(1,1),this.offset=new xe(0,0),this.alphaBlendingMode=2,this.layerMask=268435455,this.renderTargetTextures=[],this.renderOnlyInRenderTargetTextures=!1,this.isEnabled=!0,this._vertexBuffers={},this.onDisposeObservable=new Y,this.onBeforeRenderObservable=new Y,this.onAfterRenderObservable=new Y,this.texture=t?new re(t,i,!0):null,this.isBackground=r===void 0?!0:r,this.color=s===void 0?new et(1,1,1,1):s,this._scene=i||He.LastCreatedScene;let a=this._scene._getComponent(Oe.NAME_LAYER);a||(a=new Xz(this._scene),this._scene._addComponent(a)),this._scene.layers.push(this);const l=this._scene.getEngine();this._drawWrapper=new ec(l);const o=[];o.push(1,1),o.push(-1,1),o.push(-1,-1),o.push(1,-1);const c=new x(l,o,x.PositionKind,!1,!1,2);this._vertexBuffers[x.PositionKind]=c,this._createIndexBuffer()}_createIndexBuffer(){const e=this._scene.getEngine(),t=[];t.push(0),t.push(1),t.push(2),t.push(0),t.push(2),t.push(3),this._indexBuffer=e.createIndexBuffer(t)}_rebuild(){const e=this._vertexBuffers[x.PositionKind];e&&e._rebuild(),this._createIndexBuffer()}isReady(){var r;const e=this._scene.getEngine();let t="";this.alphaTest&&(t="#define ALPHATEST"),this.texture&&!this.texture.gammaSpace&&(t+=`
#define LINEAR`),this._previousDefines!==t&&(this._previousDefines=t,this._drawWrapper.effect=e.createEffect("layer",[x.PositionKind],["textureMatrix","color","scale","offset"],["textureSampler"],t));const i=this._drawWrapper.effect;return(i==null?void 0:i.isReady())&&((r=this.texture)==null?void 0:r.isReady())}render(){if(!this.isEnabled)return;const e=this._scene.getEngine();if(!this.isReady())return;const t=this._drawWrapper.effect;this.onBeforeRenderObservable.notifyObservers(this),e.enableEffect(this._drawWrapper),e.setState(!1),t.setTexture("textureSampler",this.texture),t.setMatrix("textureMatrix",this.texture.getTextureMatrix()),t.setFloat4("color",this.color.r,this.color.g,this.color.b,this.color.a),t.setVector2("offset",this.offset),t.setVector2("scale",this.scale),e.bindBuffers(this._vertexBuffers,this._indexBuffer,t),this.alphaTest?e.drawElementsType(j.TriangleFillMode,0,6):(e.setAlphaMode(this.alphaBlendingMode),e.drawElementsType(j.TriangleFillMode,0,6),e.setAlphaMode(0)),this.onAfterRenderObservable.notifyObservers(this)}dispose(){const e=this._vertexBuffers[x.PositionKind];e&&(e.dispose(),this._vertexBuffers[x.PositionKind]=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null),this.texture&&(this.texture.dispose(),this.texture=null),this.renderTargetTextures=[];const t=this._scene.layers.indexOf(this);this._scene.layers.splice(t,1),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onAfterRenderObservable.clear(),this.onBeforeRenderObservable.clear()}};class xt{constructor(e,t=xt.UNITMODE_PIXEL,i=!0){this.negativeValueAllowed=i,this._value=1,this._unit=xt.UNITMODE_PIXEL,this.ignoreAdaptiveScaling=!1,this.onChangedObservable=new Y,this._value=e,this._unit=t,this._originalUnit=t}get isPercentage(){return this._unit===xt.UNITMODE_PERCENTAGE}get isPixel(){return this._unit===xt.UNITMODE_PIXEL}get internalValue(){return this._value}get value(){return this._value}set value(e){e!==this._value&&(this._value=e,this.onChangedObservable.notifyObservers())}get unit(){return this._unit}set unit(e){e!==this._unit&&(this._unit=e,this.onChangedObservable.notifyObservers())}getValueInPixel(e,t){return this.isPixel?this.getValue(e):this.getValue(e)*t}updateInPlace(e,t=xt.UNITMODE_PIXEL){return(this.value!==e||this.unit!==t)&&(this._value=e,this._unit=t,this.onChangedObservable.notifyObservers()),this}getValue(e){if(e&&!this.ignoreAdaptiveScaling&&this.unit!==xt.UNITMODE_PERCENTAGE){let t=0,i=0;if(e.idealWidth&&(t=Math.ceil(this._value*e.getSize().width/e.idealWidth)),e.idealHeight&&(i=Math.ceil(this._value*e.getSize().height/e.idealHeight)),e.useSmallestIdeal&&e.idealWidth&&e.idealHeight)return window.innerWidth<window.innerHeight?t:i;if(e.idealWidth)return t;if(e.idealHeight)return i}return this._value}toString(e,t){switch(this._unit){case xt.UNITMODE_PERCENTAGE:{const i=this.getValue(e)*100;return(t?i.toFixed(t):i)+"%"}case xt.UNITMODE_PIXEL:{const i=this.getValue(e);return(t?i.toFixed(t):i)+"px"}}return this._unit.toString()}fromString(e){const t=xt._Regex.exec(e.toString());if(!t||t.length===0)return!1;let i=parseFloat(t[1]),r=this._originalUnit;if(this.negativeValueAllowed||i<0&&(i=0),t.length===4)switch(t[3]){case"px":r=xt.UNITMODE_PIXEL;break;case"%":r=xt.UNITMODE_PERCENTAGE,i/=100;break}return i===this._value&&r===this._unit?!1:(this._value=i,this._unit=r,this.onChangedObservable.notifyObservers(),!0)}static get UNITMODE_PERCENTAGE(){return xt._UNITMODE_PERCENTAGE}static get UNITMODE_PIXEL(){return xt._UNITMODE_PIXEL}}xt._Regex=/(^-?\d*(\.\d+)?)(%|px)?/;xt._UNITMODE_PERCENTAGE=0;xt._UNITMODE_PIXEL=1;const il=[new xe(0,0),new xe(0,0),new xe(0,0),new xe(0,0)],Ic=[new xe(0,0),new xe(0,0),new xe(0,0),new xe(0,0)],vs=new xe(0,0),io=new xe(0,0);class nr{constructor(e,t,i,r){this.left=e,this.top=t,this.width=i,this.height=r}copyFrom(e){this.left=e.left,this.top=e.top,this.width=e.width,this.height=e.height}copyFromFloats(e,t,i,r){this.left=e,this.top=t,this.width=i,this.height=r}static CombineToRef(e,t,i){const r=Math.min(e.left,t.left),s=Math.min(e.top,t.top),a=Math.max(e.left+e.width,t.left+t.width),l=Math.max(e.top+e.height,t.top+t.height);i.left=r,i.top=s,i.width=a-r,i.height=l-s}addAndTransformToRef(e,t,i,r,s,a){const l=this.left+t,o=this.top+i,c=this.width+r,u=this.height+s;il[0].copyFromFloats(l,o),il[1].copyFromFloats(l+c,o),il[2].copyFromFloats(l+c,o+u),il[3].copyFromFloats(l,o+u),vs.copyFromFloats(Number.MAX_VALUE,Number.MAX_VALUE),io.copyFromFloats(0,0);for(let h=0;h<4;h++)e.transformCoordinates(il[h].x,il[h].y,Ic[h]),vs.x=Math.floor(Math.min(vs.x,Ic[h].x)),vs.y=Math.floor(Math.min(vs.y,Ic[h].y)),io.x=Math.ceil(Math.max(io.x,Ic[h].x)),io.y=Math.ceil(Math.max(io.y,Ic[h].y));a.left=vs.x,a.top=vs.y,a.width=io.x-vs.x,a.height=io.y-vs.y}transformToRef(e,t){this.addAndTransformToRef(e,0,0,0,0,t)}isEqualsTo(e){return!(this.left!==e.left||this.top!==e.top||this.width!==e.width||this.height!==e.height)}static Empty(){return new nr(0,0,0,0)}}class cp extends xe{constructor(e,t=0){super(e.x,e.y),this.buttonIndex=t}}class ht{constructor(e,t,i,r,s,a){this.m=new Float32Array(6),this.fromValues(e,t,i,r,s,a)}fromValues(e,t,i,r,s,a){return this.m[0]=e,this.m[1]=t,this.m[2]=i,this.m[3]=r,this.m[4]=s,this.m[5]=a,this}determinant(){return this.m[0]*this.m[3]-this.m[1]*this.m[2]}invertToRef(e){const t=this.m[0],i=this.m[1],r=this.m[2],s=this.m[3],a=this.m[4],l=this.m[5],o=this.determinant();if(o<ut*ut)return e.m[0]=0,e.m[1]=0,e.m[2]=0,e.m[3]=0,e.m[4]=0,e.m[5]=0,this;const c=1/o,u=r*l-s*a,h=i*a-t*l;return e.m[0]=s*c,e.m[1]=-i*c,e.m[2]=-r*c,e.m[3]=t*c,e.m[4]=u*c,e.m[5]=h*c,this}multiplyToRef(e,t){const i=this.m[0],r=this.m[1],s=this.m[2],a=this.m[3],l=this.m[4],o=this.m[5],c=e.m[0],u=e.m[1],h=e.m[2],d=e.m[3],f=e.m[4],_=e.m[5];return t.m[0]=i*c+r*h,t.m[1]=i*u+r*d,t.m[2]=s*c+a*h,t.m[3]=s*u+a*d,t.m[4]=l*c+o*h+f,t.m[5]=l*u+o*d+_,this}transformCoordinates(e,t,i){return i.x=e*this.m[0]+t*this.m[2]+this.m[4],i.y=e*this.m[1]+t*this.m[3]+this.m[5],this}static Identity(){return new ht(1,0,0,1,0,0)}static IdentityToRef(e){e.m[0]=1,e.m[1]=0,e.m[2]=0,e.m[3]=1,e.m[4]=0,e.m[5]=0}static TranslationToRef(e,t,i){i.fromValues(1,0,0,1,e,t)}static ScalingToRef(e,t,i){i.fromValues(e,0,0,t,0,0)}static RotationToRef(e,t){const i=Math.sin(e),r=Math.cos(e);t.fromValues(r,i,-i,r,0,0)}static ComposeToRef(e,t,i,r,s,a,l){ht.TranslationToRef(e,t,ht._TempPreTranslationMatrix),ht.ScalingToRef(r,s,ht._TempScalingMatrix),ht.RotationToRef(i,ht._TempRotationMatrix),ht.TranslationToRef(-e,-t,ht._TempPostTranslationMatrix),ht._TempPreTranslationMatrix.multiplyToRef(ht._TempScalingMatrix,ht._TempCompose0),ht._TempCompose0.multiplyToRef(ht._TempRotationMatrix,ht._TempCompose1),a?(ht._TempCompose1.multiplyToRef(ht._TempPostTranslationMatrix,ht._TempCompose2),ht._TempCompose2.multiplyToRef(a,l)):ht._TempCompose1.multiplyToRef(ht._TempPostTranslationMatrix,l)}}ht._TempPreTranslationMatrix=ht.Identity();ht._TempPostTranslationMatrix=ht.Identity();ht._TempRotationMatrix=ht.Identity();ht._TempScalingMatrix=ht.Identity();ht._TempCompose0=ht.Identity();ht._TempCompose1=ht.Identity();ht._TempCompose2=ht.Identity();class de{get isReadOnly(){return this._isReadOnly}set isReadOnly(e){this._isReadOnly=e}get transformedMeasure(){return this._evaluatedMeasure}set clipChildren(e){this._clipChildren=e}get clipChildren(){return this._clipChildren}set clipContent(e){this._clipContent=e}get clipContent(){return this._clipContent}get shadowOffsetX(){return this._shadowOffsetX}set shadowOffsetX(e){this._shadowOffsetX!==e&&(this._shadowOffsetX=e,this._markAsDirty())}get shadowOffsetY(){return this._shadowOffsetY}set shadowOffsetY(e){this._shadowOffsetY!==e&&(this._shadowOffsetY=e,this._markAsDirty())}get shadowBlur(){return this._shadowBlur}set shadowBlur(e){this._shadowBlur!==e&&(this._previousShadowBlur=this._shadowBlur,this._shadowBlur=e,this._markAsDirty())}get shadowColor(){return this._shadowColor}set shadowColor(e){this._shadowColor!==e&&(this._shadowColor=e,this._markAsDirty())}get typeName(){return this._getTypeName()}getClassName(){return this._getTypeName()}set accessibilityTag(e){this._accessibilityTag=e,this.onAccessibilityTagChangedObservable.notifyObservers(e)}get accessibilityTag(){return this._accessibilityTag}get host(){return this._host}get fontOffset(){return this._fontOffset}set fontOffset(e){this._fontOffset=e}get alpha(){return this._alpha}set alpha(e){this._alpha!==e&&(this._alphaSet=!0,this._alpha=e,this._markAsDirty())}get highlightLineWidth(){return this._highlightLineWidth}set highlightLineWidth(e){this._highlightLineWidth!==e&&(this._highlightLineWidth=e,this._markAsDirty())}get isHighlighted(){return this._isHighlighted}set isHighlighted(e){this._isHighlighted!==e&&(this._isHighlighted=e,this._markAsDirty())}get highlightColor(){return this._highlightColor}set highlightColor(e){this._highlightColor!==e&&(this._highlightColor=e,this._markAsDirty())}get scaleX(){return this._scaleX}set scaleX(e){this._scaleX!==e&&(this._scaleX=e,this._markAsDirty(),this._markMatrixAsDirty())}get scaleY(){return this._scaleY}set scaleY(e){this._scaleY!==e&&(this._scaleY=e,this._markAsDirty(),this._markMatrixAsDirty())}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._markAsDirty(),this._markMatrixAsDirty())}get transformCenterY(){return this._transformCenterY}set transformCenterY(e){this._transformCenterY!==e&&(this._transformCenterY=e,this._markAsDirty(),this._markMatrixAsDirty())}get transformCenterX(){return this._transformCenterX}set transformCenterX(e){this._transformCenterX!==e&&(this._transformCenterX=e,this._markAsDirty(),this._markMatrixAsDirty())}get horizontalAlignment(){return this._horizontalAlignment}set horizontalAlignment(e){this._horizontalAlignment!==e&&(this._horizontalAlignment=e,this._markAsDirty())}get verticalAlignment(){return this._verticalAlignment}set verticalAlignment(e){this._verticalAlignment!==e&&(this._verticalAlignment=e,this._markAsDirty())}set fixedRatio(e){this._fixedRatio!==e&&(this._fixedRatio=e,this._markAsDirty())}get fixedRatio(){return this._fixedRatio}set fixedRatioMasterIsWidth(e){this._fixedRatioMasterIsWidth!==e&&(this._fixedRatioMasterIsWidth=e,this._markAsDirty())}get fixedRatioMasterIsWidth(){return this._fixedRatioMasterIsWidth}get width(){return this._width.toString(this._host)}set width(e){this._fixedRatioMasterIsWidth=!0,this._width.toString(this._host)!==e&&this._width.fromString(e)&&this._markAsDirty()}get widthInPixels(){return this._width.getValueInPixel(this._host,this._cachedParentMeasure.width)}set widthInPixels(e){isNaN(e)||(this._fixedRatioMasterIsWidth=!0,this.width=e+"px")}get height(){return this._height.toString(this._host)}set height(e){this._fixedRatioMasterIsWidth=!1,this._height.toString(this._host)!==e&&this._height.fromString(e)&&this._markAsDirty()}get heightInPixels(){return this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)}set heightInPixels(e){isNaN(e)||(this._fixedRatioMasterIsWidth=!1,this.height=e+"px")}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this._resetFontCache())}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this._resetFontCache())}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this._resetFontCache())}get style(){return this._style}set style(e){this._style&&(this._style.onChangedObservable.remove(this._styleObserver),this._styleObserver=null),this._style=e,this._style&&(this._styleObserver=this._style.onChangedObservable.add(()=>{this._markAsDirty(),this._resetFontCache()})),this._markAsDirty(),this._resetFontCache()}get _isFontSizeInPercentage(){return this._fontSize.isPercentage}get fontSizeInPixels(){const e=this._style?this._style._fontSize:this._fontSize;return e.isPixel?e.getValue(this._host):e.getValueInPixel(this._host,this._tempParentMeasure.height||this._cachedParentMeasure.height)}set fontSizeInPixels(e){isNaN(e)||(this.fontSize=e+"px")}get fontSize(){return this._fontSize.toString(this._host)}set fontSize(e){this._fontSize.toString(this._host)!==e&&this._fontSize.fromString(e)&&(this._markAsDirty(),this._resetFontCache())}get color(){return this._color}set color(e){this._color!==e&&(this._color=e,this._markAsDirty())}get gradient(){return this._gradient}set gradient(e){this._gradient!==e&&(this._gradient=e,this._markAsDirty())}get zIndex(){return this._zIndex}set zIndex(e){this.zIndex!==e&&(this._zIndex=e,this.parent&&this.parent._reOrderControl(this))}get notRenderable(){return this._doNotRender}set notRenderable(e){this._doNotRender!==e&&(this._doNotRender=e,this._markAsDirty())}get isVisible(){return this._isVisible}set isVisible(e){this._isVisible!==e&&(this._isVisible=e,this._markAsDirty(!0),this.onIsVisibleChangedObservable.notifyObservers(e))}get isDirty(){return this._isDirty}get linkedMesh(){return this._linkedMesh}get descendantsOnlyPadding(){return this._descendantsOnlyPadding}set descendantsOnlyPadding(e){this._descendantsOnlyPadding!==e&&(this._descendantsOnlyPadding=e,this._markAsDirty())}get paddingLeft(){return this._paddingLeft.toString(this._host)}set paddingLeft(e){this._paddingLeft.fromString(e)&&this._markAsDirty()}get paddingLeftInPixels(){return this._paddingLeft.getValueInPixel(this._host,this._cachedParentMeasure.width)}set paddingLeftInPixels(e){isNaN(e)||(this.paddingLeft=e+"px")}get _paddingLeftInPixels(){return this._descendantsOnlyPadding?0:this.paddingLeftInPixels}get paddingRight(){return this._paddingRight.toString(this._host)}set paddingRight(e){this._paddingRight.fromString(e)&&this._markAsDirty()}get paddingRightInPixels(){return this._paddingRight.getValueInPixel(this._host,this._cachedParentMeasure.width)}set paddingRightInPixels(e){isNaN(e)||(this.paddingRight=e+"px")}get _paddingRightInPixels(){return this._descendantsOnlyPadding?0:this.paddingRightInPixels}get paddingTop(){return this._paddingTop.toString(this._host)}set paddingTop(e){this._paddingTop.fromString(e)&&this._markAsDirty()}get paddingTopInPixels(){return this._paddingTop.getValueInPixel(this._host,this._cachedParentMeasure.height)}set paddingTopInPixels(e){isNaN(e)||(this.paddingTop=e+"px")}get _paddingTopInPixels(){return this._descendantsOnlyPadding?0:this.paddingTopInPixels}get paddingBottom(){return this._paddingBottom.toString(this._host)}set paddingBottom(e){this._paddingBottom.fromString(e)&&this._markAsDirty()}get paddingBottomInPixels(){return this._paddingBottom.getValueInPixel(this._host,this._cachedParentMeasure.height)}set paddingBottomInPixels(e){isNaN(e)||(this.paddingBottom=e+"px")}get _paddingBottomInPixels(){return this._descendantsOnlyPadding?0:this.paddingBottomInPixels}get left(){return this._left.toString(this._host)}set left(e){this._left.fromString(e)&&this._markAsDirty()}get leftInPixels(){return this._left.getValueInPixel(this._host,this._cachedParentMeasure.width)}set leftInPixels(e){isNaN(e)||(this.left=e+"px")}get top(){return this._top.toString(this._host)}set top(e){this._top.fromString(e)&&this._markAsDirty()}get topInPixels(){return this._top.getValueInPixel(this._host,this._cachedParentMeasure.height)}set topInPixels(e){isNaN(e)||(this.top=e+"px")}get linkOffsetX(){return this._linkOffsetX.toString(this._host)}set linkOffsetX(e){this._linkOffsetX.fromString(e)&&this._markAsDirty()}get linkOffsetXInPixels(){return this._linkOffsetX.getValueInPixel(this._host,this._cachedParentMeasure.width)}set linkOffsetXInPixels(e){isNaN(e)||(this.linkOffsetX=e+"px")}get linkOffsetY(){return this._linkOffsetY.toString(this._host)}set linkOffsetY(e){this._linkOffsetY.fromString(e)&&this._markAsDirty()}get linkOffsetYInPixels(){return this._linkOffsetY.getValueInPixel(this._host,this._cachedParentMeasure.height)}set linkOffsetYInPixels(e){isNaN(e)||(this.linkOffsetY=e+"px")}get centerX(){return this._currentMeasure.left+this._currentMeasure.width/2}get centerY(){return this._currentMeasure.top+this._currentMeasure.height/2}get isEnabled(){return this._isEnabled}set isEnabled(e){if(this._isEnabled===e)return;this._isEnabled=e,this._markAsDirty();const t=i=>{if(i.host){for(const r in i.host._lastControlOver)i===this.host._lastControlOver[r]&&(i._onPointerOut(i,null,!0),delete i.host._lastControlOver[r]);i.children!==void 0&&i.children.forEach(t)}};t(this),this.onEnabledStateChangedObservable.notifyObservers(e)}get disabledColor(){return this._disabledColor}set disabledColor(e){this._disabledColor!==e&&(this._disabledColor=e,this._markAsDirty())}get disabledColorItem(){return this._disabledColorItem}set disabledColorItem(e){this._disabledColorItem!==e&&(this._disabledColorItem=e,this._markAsDirty())}constructor(e){this.name=e,this._alpha=1,this._alphaSet=!1,this._zIndex=0,this._currentMeasure=nr.Empty(),this._tempPaddingMeasure=nr.Empty(),this._fontFamily="",this._fontStyle="",this._fontWeight="",this._fontSize=new xt(18,xt.UNITMODE_PIXEL,!1),this._width=new xt(1,xt.UNITMODE_PERCENTAGE,!1),this._height=new xt(1,xt.UNITMODE_PERCENTAGE,!1),this._color="",this._style=null,this._horizontalAlignment=de.HORIZONTAL_ALIGNMENT_CENTER,this._verticalAlignment=de.VERTICAL_ALIGNMENT_CENTER,this._isDirty=!0,this._wasDirty=!1,this._tempParentMeasure=nr.Empty(),this._prevCurrentMeasureTransformedIntoGlobalSpace=nr.Empty(),this._cachedParentMeasure=nr.Empty(),this._descendantsOnlyPadding=!1,this._paddingLeft=new xt(0),this._paddingRight=new xt(0),this._paddingTop=new xt(0),this._paddingBottom=new xt(0),this._left=new xt(0),this._top=new xt(0),this._scaleX=1,this._scaleY=1,this._rotation=0,this._transformCenterX=.5,this._transformCenterY=.5,this._transformMatrix=ht.Identity(),this._invertTransformMatrix=ht.Identity(),this._transformedPosition=xe.Zero(),this._isMatrixDirty=!0,this._isVisible=!0,this._isHighlighted=!1,this._highlightColor="#4affff",this._highlightLineWidth=2,this._fontSet=!1,this._dummyVector2=xe.Zero(),this._downCount=0,this._enterCount=-1,this._doNotRender=!1,this._downPointerIds={},this._evaluatedMeasure=new nr(0,0,0,0),this._evaluatedParentMeasure=new nr(0,0,0,0),this._isEnabled=!0,this._disabledColor="#9a9a9a",this._disabledColorItem="#6a6a6a",this._isReadOnly=!1,this._gradient=null,this._rebuildLayout=!1,this.onEnabledStateChangedObservable=new Y,this._customData={},this._isClipped=!1,this._automaticSize=!1,this.metadata=null,this.isHitTestVisible=!0,this.isPointerBlocker=!1,this.isFocusInvisible=!1,this._clipChildren=!0,this._clipContent=!0,this.useBitmapCache=!1,this._shadowOffsetX=0,this._shadowOffsetY=0,this._shadowBlur=0,this._previousShadowBlur=0,this._shadowColor="black",this.hoverCursor="",this._linkOffsetX=new xt(0),this._linkOffsetY=new xt(0),this._accessibilityTag=null,this.onAccessibilityTagChangedObservable=new Y,this.onWheelObservable=new Y,this.onPointerMoveObservable=new Y,this.onPointerOutObservable=new Y,this.onPointerDownObservable=new Y,this.onPointerUpObservable=new Y,this.onPointerClickObservable=new Y,this.onPointerEnterObservable=new Y,this.onDirtyObservable=new Y,this.onBeforeDrawObservable=new Y,this.onAfterDrawObservable=new Y,this.onDisposeObservable=new Y,this.onIsVisibleChangedObservable=new Y,this.isSerializable=!0,this._fixedRatio=0,this._fixedRatioMasterIsWidth=!0,this.animations=null,this._tmpMeasureA=new nr(0,0,0,0)}_getTypeName(){return"Control"}getAscendantOfClass(e){return this.parent?this.parent.getClassName()===e?this.parent:this.parent.getAscendantOfClass(e):null}markAsDirty(e=!1){this._markAsDirty(e)}markAllAsDirty(){this._markAllAsDirty()}_resetFontCache(){this._fontSet=!0,this._markAsDirty()}isAscendant(e){return this.parent?this.parent===e?!0:this.parent.isAscendant(e):!1}getLocalCoordinates(e){const t=xe.Zero();return this.getLocalCoordinatesToRef(e,t),t}getLocalCoordinatesToRef(e,t){return t.x=e.x-this._currentMeasure.left,t.y=e.y-this._currentMeasure.top,this}getParentLocalCoordinates(e){const t=xe.Zero();return t.x=e.x-this._cachedParentMeasure.left,t.y=e.y-this._cachedParentMeasure.top,t}moveToVector3(e,t){if(!this._host||this.parent!==this._host._rootContainer){X.Error("Cannot move a control to a vector3 if the control is not at root level");return}this.horizontalAlignment=de.HORIZONTAL_ALIGNMENT_LEFT,this.verticalAlignment=de.VERTICAL_ALIGNMENT_TOP;const i=this._host._getGlobalViewport(),r=A.Project(e,z.IdentityReadOnly,t.getTransformMatrix(),i);if(this._moveToProjectedPosition(r),r.z<0||r.z>1){this.notRenderable=!0;return}this.notRenderable=!1}getDescendantsToRef(e,t=!1,i){}getDescendants(e,t){const i=[];return this.getDescendantsToRef(i,e,t),i}linkWithMesh(e){if(!this._host||this.parent&&this.parent!==this._host._rootContainer){e&&X.Error("Cannot link a control to a mesh if the control is not at root level");return}const t=this._host._linkedControls.indexOf(this);if(t!==-1){this._linkedMesh=e,e||this._host._linkedControls.splice(t,1);return}else if(!e)return;this.horizontalAlignment=de.HORIZONTAL_ALIGNMENT_LEFT,this.verticalAlignment=de.VERTICAL_ALIGNMENT_TOP,this._linkedMesh=e,this._host._linkedControls.push(this)}setPadding(e,t,i,r){const s=e,a=t??s,l=i??s,o=r??a;this.paddingTop=s,this.paddingRight=a,this.paddingBottom=l,this.paddingLeft=o}setPaddingInPixels(e,t,i,r){const s=e,a=t??s,l=i??s,o=r??a;this.paddingTopInPixels=s,this.paddingRightInPixels=a,this.paddingBottomInPixels=l,this.paddingLeftInPixels=o}_moveToProjectedPosition(e){var o;const t=this._left.getValue(this._host),i=this._top.getValue(this._host),r=(o=this.parent)==null?void 0:o._currentMeasure;r&&this._processMeasures(r,this._host.getContext());let s=e.x+this._linkOffsetX.getValue(this._host)-this._currentMeasure.width/2,a=e.y+this._linkOffsetY.getValue(this._host)-this._currentMeasure.height/2;const l=this._left.ignoreAdaptiveScaling&&this._top.ignoreAdaptiveScaling;l&&(Math.abs(s-t)<.5&&(s=t),Math.abs(a-i)<.5&&(a=i)),!(!l&&t===s&&i===a)&&(this.left=s+"px",this.top=a+"px",this._left.ignoreAdaptiveScaling=!0,this._top.ignoreAdaptiveScaling=!0,this._markAsDirty())}_offsetLeft(e){this._isDirty=!0,this._currentMeasure.left+=e}_offsetTop(e){this._isDirty=!0,this._currentMeasure.top+=e}_markMatrixAsDirty(){this._isMatrixDirty=!0,this._flagDescendantsAsMatrixDirty()}_flagDescendantsAsMatrixDirty(){}_intersectsRect(e,t){return this._transform(t),!(this._evaluatedMeasure.left>=e.left+e.width||this._evaluatedMeasure.top>=e.top+e.height||this._evaluatedMeasure.left+this._evaluatedMeasure.width<=e.left||this._evaluatedMeasure.top+this._evaluatedMeasure.height<=e.top)}_computeAdditionalOffsetX(){return 0}_computeAdditionalOffsetY(){return 0}invalidateRect(){if(this._transform(),this.host&&this.host.useInvalidateRectOptimization){this._currentMeasure.transformToRef(this._transformMatrix,this._tmpMeasureA),nr.CombineToRef(this._tmpMeasureA,this._prevCurrentMeasureTransformedIntoGlobalSpace,this._tmpMeasureA);const e=this.shadowOffsetX,t=this.shadowOffsetY,i=Math.max(this._previousShadowBlur,this.shadowBlur),r=Math.min(Math.min(e,0)-i*2,0),s=Math.max(Math.max(e,0)+i*2,0),a=Math.min(Math.min(t,0)-i*2,0),l=Math.max(Math.max(t,0)+i*2,0),o=this._computeAdditionalOffsetX(),c=this._computeAdditionalOffsetY();this.host.invalidateRect(Math.floor(this._tmpMeasureA.left+r-o),Math.floor(this._tmpMeasureA.top+a-c),Math.ceil(this._tmpMeasureA.left+this._tmpMeasureA.width+s+o),Math.ceil(this._tmpMeasureA.top+this._tmpMeasureA.height+l+c))}}_markAsDirty(e=!1){!this._isVisible&&!e||(this._isDirty=!0,this._markMatrixAsDirty(),this._host&&this._host.markAsDirty())}_markAllAsDirty(){this._markAsDirty(),this._font&&this._prepareFont()}_link(e){this._host=e,this._host&&(this.uniqueId=this._host.getScene().getUniqueId())}_transform(e){if(!this._isMatrixDirty&&this._scaleX===1&&this._scaleY===1&&this._rotation===0)return;const t=this._currentMeasure.width*this._transformCenterX+this._currentMeasure.left,i=this._currentMeasure.height*this._transformCenterY+this._currentMeasure.top;e&&(e.translate(t,i),e.rotate(this._rotation),e.scale(this._scaleX,this._scaleY),e.translate(-t,-i)),(this._isMatrixDirty||this._cachedOffsetX!==t||this._cachedOffsetY!==i)&&(this._cachedOffsetX=t,this._cachedOffsetY=i,this._isMatrixDirty=!1,this._flagDescendantsAsMatrixDirty(),ht.ComposeToRef(-t,-i,this._rotation,this._scaleX,this._scaleY,this.parent?this.parent._transformMatrix:null,this._transformMatrix),this._transformMatrix.invertToRef(this._invertTransformMatrix),this._currentMeasure.transformToRef(this._transformMatrix,this._evaluatedMeasure))}_renderHighlight(e){this.isHighlighted&&(e.save(),e.strokeStyle=this._highlightColor,e.lineWidth=this._highlightLineWidth,this._renderHighlightSpecific(e),e.restore())}_renderHighlightSpecific(e){e.strokeRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)}_getColor(e){return this.gradient?this.gradient.getCanvasGradient(e):this.color}_applyStates(e){this._isFontSizeInPercentage&&(this._fontSet=!0),this._host&&this._host.useSmallestIdeal&&!this._font&&(this._fontSet=!0),this._fontSet&&(this._prepareFont(),this._fontSet=!1),this._font&&(e.font=this._font),(this._color||this.gradient)&&(e.fillStyle=this._getColor(e)),de.AllowAlphaInheritance?e.globalAlpha*=this._alpha:this._alphaSet&&(e.globalAlpha=this.parent&&!this.parent.renderToIntermediateTexture?this.parent.alpha*this._alpha:this._alpha)}_layout(e,t){if(!this.isDirty&&(!this.isVisible||this.notRenderable))return!1;if(this._isDirty||!this._cachedParentMeasure.isEqualsTo(e)){this.host._numLayoutCalls++,this._currentMeasure.addAndTransformToRef(this._transformMatrix,-this._paddingLeftInPixels|0,-this._paddingTopInPixels|0,this._paddingRightInPixels|0,this._paddingBottomInPixels|0,this._prevCurrentMeasureTransformedIntoGlobalSpace),t.save(),this._applyStates(t);let i=0;do this._rebuildLayout=!1,this._processMeasures(e,t),i++;while(this._rebuildLayout&&i<3);i>=3&&ee.Error(`Layout cycle detected in GUI (Control name=${this.name}, uniqueId=${this.uniqueId})`),t.restore(),this.invalidateRect(),this._evaluateClippingState(e)}return this._wasDirty=this._isDirty,this._isDirty=!1,!0}_processMeasures(e,t){this._tempPaddingMeasure.copyFrom(e),this.parent&&this.parent.descendantsOnlyPadding&&(this._tempPaddingMeasure.left+=this.parent.paddingLeftInPixels,this._tempPaddingMeasure.top+=this.parent.paddingTopInPixels,this._tempPaddingMeasure.width-=this.parent.paddingLeftInPixels+this.parent.paddingRightInPixels,this._tempPaddingMeasure.height-=this.parent.paddingTopInPixels+this.parent.paddingBottomInPixels),this._currentMeasure.copyFrom(this._tempPaddingMeasure),this._preMeasure(this._tempPaddingMeasure,t),this._measure(),this._postMeasure(this._tempPaddingMeasure,t),this._computeAlignment(this._tempPaddingMeasure,t),this._currentMeasure.left=this._currentMeasure.left|0,this._currentMeasure.top=this._currentMeasure.top|0,this._currentMeasure.width=this._currentMeasure.width|0,this._currentMeasure.height=this._currentMeasure.height|0,this._additionalProcessing(this._tempPaddingMeasure,t),this._cachedParentMeasure.copyFrom(this._tempPaddingMeasure),this._currentMeasure.transformToRef(this._transformMatrix,this._evaluatedMeasure),this.onDirtyObservable.hasObservers()&&this.onDirtyObservable.notifyObservers(this)}_evaluateClippingState(e){if(this._transform(),this._currentMeasure.transformToRef(this._transformMatrix,this._evaluatedMeasure),this.parent&&this.parent.clipChildren){if(e.transformToRef(this.parent._transformMatrix,this._evaluatedParentMeasure),this._evaluatedMeasure.left>this._evaluatedParentMeasure.left+this._evaluatedParentMeasure.width){this._isClipped=!0;return}if(this._evaluatedMeasure.left+this._evaluatedMeasure.width<this._evaluatedParentMeasure.left){this._isClipped=!0;return}if(this._evaluatedMeasure.top>this._evaluatedParentMeasure.top+this._evaluatedParentMeasure.height){this._isClipped=!0;return}if(this._evaluatedMeasure.top+this._evaluatedMeasure.height<this._evaluatedParentMeasure.top){this._isClipped=!0;return}}this._isClipped=!1}_measure(){this._width.isPixel?this._currentMeasure.width=this._width.getValue(this._host):this._currentMeasure.width*=this._width.getValue(this._host),this._height.isPixel?this._currentMeasure.height=this._height.getValue(this._host):this._currentMeasure.height*=this._height.getValue(this._host),this._fixedRatio!==0&&(this._fixedRatioMasterIsWidth?this._currentMeasure.height=this._currentMeasure.width*this._fixedRatio:this._currentMeasure.width=this._currentMeasure.height*this._fixedRatio)}_computeAlignment(e,t){const i=this._currentMeasure.width,r=this._currentMeasure.height,s=e.width,a=e.height;let l=0,o=0;switch(this.horizontalAlignment){case de.HORIZONTAL_ALIGNMENT_LEFT:l=0;break;case de.HORIZONTAL_ALIGNMENT_RIGHT:l=s-i;break;case de.HORIZONTAL_ALIGNMENT_CENTER:l=(s-i)/2;break}switch(this.verticalAlignment){case de.VERTICAL_ALIGNMENT_TOP:o=0;break;case de.VERTICAL_ALIGNMENT_BOTTOM:o=a-r;break;case de.VERTICAL_ALIGNMENT_CENTER:o=(a-r)/2;break}this.descendantsOnlyPadding||(this._paddingLeft.isPixel?(this._currentMeasure.left+=this._paddingLeft.getValue(this._host),this._currentMeasure.width-=this._paddingLeft.getValue(this._host)):(this._currentMeasure.left+=s*this._paddingLeft.getValue(this._host),this._currentMeasure.width-=s*this._paddingLeft.getValue(this._host)),this._paddingRight.isPixel?this._currentMeasure.width-=this._paddingRight.getValue(this._host):this._currentMeasure.width-=s*this._paddingRight.getValue(this._host),this._paddingTop.isPixel?(this._currentMeasure.top+=this._paddingTop.getValue(this._host),this._currentMeasure.height-=this._paddingTop.getValue(this._host)):(this._currentMeasure.top+=a*this._paddingTop.getValue(this._host),this._currentMeasure.height-=a*this._paddingTop.getValue(this._host)),this._paddingBottom.isPixel?this._currentMeasure.height-=this._paddingBottom.getValue(this._host):this._currentMeasure.height-=a*this._paddingBottom.getValue(this._host)),this._left.isPixel?this._currentMeasure.left+=this._left.getValue(this._host):this._currentMeasure.left+=s*this._left.getValue(this._host),this._top.isPixel?this._currentMeasure.top+=this._top.getValue(this._host):this._currentMeasure.top+=a*this._top.getValue(this._host),this._currentMeasure.left+=l,this._currentMeasure.top+=o}_preMeasure(e,t){}_postMeasure(e,t){}_additionalProcessing(e,t){}_clipForChildren(e){}_clip(e,t){if(e.beginPath(),de._ClipMeasure.copyFrom(this._currentMeasure),t){t.transformToRef(this._invertTransformMatrix,this._tmpMeasureA);const i=new nr(0,0,0,0);i.left=Math.max(this._tmpMeasureA.left,this._currentMeasure.left),i.top=Math.max(this._tmpMeasureA.top,this._currentMeasure.top),i.width=Math.min(this._tmpMeasureA.left+this._tmpMeasureA.width,this._currentMeasure.left+this._currentMeasure.width)-i.left,i.height=Math.min(this._tmpMeasureA.top+this._tmpMeasureA.height,this._currentMeasure.top+this._currentMeasure.height)-i.top,de._ClipMeasure.copyFrom(i)}if(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY){const i=this.shadowOffsetX,r=this.shadowOffsetY,s=this.shadowBlur,a=Math.min(Math.min(i,0)-s*2,0),l=Math.max(Math.max(i,0)+s*2,0),o=Math.min(Math.min(r,0)-s*2,0),c=Math.max(Math.max(r,0)+s*2,0);e.rect(de._ClipMeasure.left+a,de._ClipMeasure.top+o,de._ClipMeasure.width+l-a,de._ClipMeasure.height+c-o)}else e.rect(de._ClipMeasure.left,de._ClipMeasure.top,de._ClipMeasure.width,de._ClipMeasure.height);e.clip()}_render(e,t){return!this.isVisible||this.notRenderable||this._isClipped?(this._isDirty=!1,!1):(this.host._numRenderCalls++,e.save(),this._applyStates(e),this._transform(e),this.clipContent&&this._clip(e,t),this.onBeforeDrawObservable.hasObservers()&&this.onBeforeDrawObservable.notifyObservers(this),this.useBitmapCache&&!this._wasDirty&&this._cacheData?e.putImageData(this._cacheData,this._currentMeasure.left,this._currentMeasure.top):this._draw(e,t),this.useBitmapCache&&this._wasDirty&&(this._cacheData=e.getImageData(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),this._renderHighlight(e),this.onAfterDrawObservable.hasObservers()&&this.onAfterDrawObservable.notifyObservers(this),e.restore(),!0)}_draw(e,t){}contains(e,t){return this._invertTransformMatrix.transformCoordinates(e,t,this._transformedPosition),e=this._transformedPosition.x,t=this._transformedPosition.y,e<this._currentMeasure.left||e>this._currentMeasure.left+this._currentMeasure.width||t<this._currentMeasure.top||t>this._currentMeasure.top+this._currentMeasure.height?!1:(this.isPointerBlocker&&(this._host._shouldBlockPointer=!0),!0)}_processPicking(e,t,i,r,s,a,l,o){return!this._isEnabled||!this.isHitTestVisible||!this.isVisible||this._doNotRender||!this.contains(e,t)?!1:(this._processObservables(r,e,t,i,s,a,l,o),!0)}_onPointerMove(e,t,i,r){this.onPointerMoveObservable.notifyObservers(t,-1,e,this,r)&&this.parent!=null&&!this.isPointerBlocker&&this.parent._onPointerMove(e,t,i,r)}_onPointerEnter(e,t){return!this._isEnabled||this._enterCount>0?!1:(this._enterCount===-1&&(this._enterCount=0),this._enterCount++,this.onPointerEnterObservable.notifyObservers(this,-1,e,this,t)&&this.parent!=null&&!this.isPointerBlocker&&this.parent._onPointerEnter(e,t),!0)}_onPointerOut(e,t,i=!1){if(!i&&(!this._isEnabled||e===this))return;this._enterCount=0;let r=!0;e.isAscendant(this)||(r=this.onPointerOutObservable.notifyObservers(this,-1,e,this,t)),r&&this.parent!=null&&!this.isPointerBlocker&&this.parent._onPointerOut(e,t,i)}_onPointerDown(e,t,i,r,s){return this._onPointerEnter(this,s),this._downCount!==0?!1:(this._downCount++,this._downPointerIds[i]=!0,this.onPointerDownObservable.notifyObservers(new cp(t,r),-1,e,this,s)&&this.parent!=null&&!this.isPointerBlocker&&this.parent._onPointerDown(e,t,i,r,s),s&&this.uniqueId!==this._host.rootContainer.uniqueId&&this._host._capturedPointerIds.add(s.event.pointerId),!0)}_onPointerUp(e,t,i,r,s,a){if(!this._isEnabled)return;this._downCount=0,delete this._downPointerIds[i];let l=s;s&&(this._enterCount>0||this._enterCount===-1)&&(l=this.onPointerClickObservable.notifyObservers(new cp(t,r),-1,e,this,a)),this.onPointerUpObservable.notifyObservers(new cp(t,r),-1,e,this,a)&&this.parent!=null&&!this.isPointerBlocker&&this.parent._onPointerUp(e,t,i,r,l,a),a&&this.uniqueId!==this._host.rootContainer.uniqueId&&this._host._capturedPointerIds.delete(a.event.pointerId)}_forcePointerUp(e=null){if(e!==null)this._onPointerUp(this,xe.Zero(),e,0,!0);else for(const t in this._downPointerIds)this._onPointerUp(this,xe.Zero(),+t,0,!0)}_onWheelScroll(e,t){if(!this._isEnabled)return;this.onWheelObservable.notifyObservers(new xe(e,t))&&this.parent!=null&&this.parent._onWheelScroll(e,t)}_onCanvasBlur(){}_processObservables(e,t,i,r,s,a,l,o){if(!this._isEnabled)return!1;if(this._dummyVector2.copyFromFloats(t,i),e===be.POINTERMOVE){this._onPointerMove(this,this._dummyVector2,s,r);const c=this._host._lastControlOver[s];return c&&c!==this&&c._onPointerOut(this,r),c!==this&&this._onPointerEnter(this,r),this._host._lastControlOver[s]=this,!0}return e===be.POINTERDOWN?(this._onPointerDown(this,this._dummyVector2,s,a,r),this._host._registerLastControlDown(this,s),this._host._lastPickedControl=this,!0):e===be.POINTERUP?(this._host._lastControlDown[s]&&this._host._lastControlDown[s]._onPointerUp(this,this._dummyVector2,s,a,!0,r),delete this._host._lastControlDown[s],!0):e===be.POINTERWHEEL&&this._host._lastControlOver[s]?(this._host._lastControlOver[s]._onWheelScroll(l,o),!0):!1}_getStyleProperty(e,t){const i=(this._style&&this._style[e])??this[e];return!i&&this.parent?this.parent._getStyleProperty(e,t):this.parent?i:t}_prepareFont(){!this._font&&!this._fontSet||(this._font=this._getStyleProperty("fontStyle","")+" "+this._getStyleProperty("fontWeight","")+" "+this.fontSizeInPixels+"px "+this._getStyleProperty("fontFamily","Arial"),this._fontOffset=de._GetFontOffset(this._font),this.getDescendants().forEach(e=>e._markAllAsDirty()))}isDimensionFullyDefined(e){return this.getDimension(e).isPixel}getDimension(e){return e==="width"?this._width:this._height}clone(e){const t={};this.serialize(t,!0);const i=X.Instantiate("BABYLON.GUI."+t.className),r=new i;return r.parse(t,e),r}parse(e,t){return Fe.Parse(()=>this,e,null),this.name=e.name,this._parseFromContent(e,t??this._host),this}serialize(e,t=!1){!this.isSerializable&&!t||(Fe.Serialize(this,e),e.name=this.name,e.className=this.getClassName(),this._prepareFont(),this._font&&(e.fontFamily=this._fontFamily,e.fontSize=this.fontSize,e.fontWeight=this.fontWeight,e.fontStyle=this.fontStyle),this._gradient&&(e.gradient={},this._gradient.serialize(e.gradient)),Fe.AppendSerializedAnimations(this,e))}_parseFromContent(e,t){var i;if(e.fontFamily&&(this.fontFamily=e.fontFamily),e.fontSize&&(this.fontSize=e.fontSize),e.fontWeight&&(this.fontWeight=e.fontWeight),e.fontStyle&&(this.fontStyle=e.fontStyle),e.gradient){const r=X.Instantiate("BABYLON.GUI."+e.gradient.className);this._gradient=new r,(i=this._gradient)==null||i.parse(e.gradient)}if(e.animations){this.animations=[];for(let r=0;r<e.animations.length;r++){const s=e.animations[r],a=Bn("BABYLON.Animation");a&&this.animations.push(a.Parse(s))}e.autoAnimate&&this._host&&this._host.getScene()&&this._host.getScene().beginAnimation(this,e.autoAnimateFrom,e.autoAnimateTo,e.autoAnimateLoop,e.autoAnimateSpeed||1)}this.fixedRatioMasterIsWidth=e.fixedRatioMasterIsWidth??this.fixedRatioMasterIsWidth}dispose(){this.onDirtyObservable.clear(),this.onBeforeDrawObservable.clear(),this.onAfterDrawObservable.clear(),this.onPointerDownObservable.clear(),this.onPointerEnterObservable.clear(),this.onPointerMoveObservable.clear(),this.onPointerOutObservable.clear(),this.onPointerUpObservable.clear(),this.onPointerClickObservable.clear(),this.onWheelObservable.clear(),this._styleObserver&&this._style&&(this._style.onChangedObservable.remove(this._styleObserver),this._styleObserver=null),this.parent&&(this.parent.removeControl(this),this.parent=null),this._host&&this._host._linkedControls.indexOf(this)>-1&&this.linkWithMesh(null),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear()}static get HORIZONTAL_ALIGNMENT_LEFT(){return de._HORIZONTAL_ALIGNMENT_LEFT}static get HORIZONTAL_ALIGNMENT_RIGHT(){return de._HORIZONTAL_ALIGNMENT_RIGHT}static get HORIZONTAL_ALIGNMENT_CENTER(){return de._HORIZONTAL_ALIGNMENT_CENTER}static get VERTICAL_ALIGNMENT_TOP(){return de._VERTICAL_ALIGNMENT_TOP}static get VERTICAL_ALIGNMENT_BOTTOM(){return de._VERTICAL_ALIGNMENT_BOTTOM}static get VERTICAL_ALIGNMENT_CENTER(){return de._VERTICAL_ALIGNMENT_CENTER}static _GetFontOffset(e){if(de._FontHeightSizes[e])return de._FontHeightSizes[e];const t=He.LastCreatedEngine;if(!t)throw new Error("Invalid engine. Unable to create a canvas.");const i=t.getFontOffset(e);return de._FontHeightSizes[e]=i,i}static Parse(e,t){const i=X.Instantiate("BABYLON.GUI."+e.className),r=Fe.Parse(()=>new i,e,null);return r.name=e.name,r._parseFromContent(e,t),r}static drawEllipse(e,t,i,r,s){s.translate(e,t),s.scale(i,r),s.beginPath(),s.arc(0,0,1,0,2*Math.PI),s.closePath(),s.scale(1/i,1/r),s.translate(-e,-t)}isReady(){return!0}}de.AllowAlphaInheritance=!1;de._ClipMeasure=new nr(0,0,0,0);de._HORIZONTAL_ALIGNMENT_LEFT=0;de._HORIZONTAL_ALIGNMENT_RIGHT=1;de._HORIZONTAL_ALIGNMENT_CENTER=2;de._VERTICAL_ALIGNMENT_TOP=0;de._VERTICAL_ALIGNMENT_BOTTOM=1;de._VERTICAL_ALIGNMENT_CENTER=2;de._FontHeightSizes={};de.AddHeader=()=>{};R([I()],de.prototype,"metadata",void 0);R([I()],de.prototype,"isHitTestVisible",void 0);R([I()],de.prototype,"isPointerBlocker",void 0);R([I()],de.prototype,"isFocusInvisible",void 0);R([I()],de.prototype,"clipChildren",null);R([I()],de.prototype,"clipContent",null);R([I()],de.prototype,"useBitmapCache",void 0);R([I()],de.prototype,"shadowOffsetX",null);R([I()],de.prototype,"shadowOffsetY",null);R([I()],de.prototype,"shadowBlur",null);R([I()],de.prototype,"shadowColor",null);R([I()],de.prototype,"hoverCursor",void 0);R([I()],de.prototype,"fontOffset",null);R([I()],de.prototype,"alpha",null);R([I()],de.prototype,"isSerializable",void 0);R([I()],de.prototype,"scaleX",null);R([I()],de.prototype,"scaleY",null);R([I()],de.prototype,"rotation",null);R([I()],de.prototype,"transformCenterY",null);R([I()],de.prototype,"transformCenterX",null);R([I()],de.prototype,"horizontalAlignment",null);R([I()],de.prototype,"verticalAlignment",null);R([I()],de.prototype,"fixedRatio",null);R([I()],de.prototype,"fixedRatioMasterIsWidth",null);R([I()],de.prototype,"width",null);R([I()],de.prototype,"height",null);R([I()],de.prototype,"style",null);R([I()],de.prototype,"color",null);R([I()],de.prototype,"gradient",null);R([I()],de.prototype,"zIndex",null);R([I()],de.prototype,"notRenderable",null);R([I()],de.prototype,"isVisible",null);R([I()],de.prototype,"descendantsOnlyPadding",null);R([I()],de.prototype,"paddingLeft",null);R([I()],de.prototype,"paddingRight",null);R([I()],de.prototype,"paddingTop",null);R([I()],de.prototype,"paddingBottom",null);R([I()],de.prototype,"left",null);R([I()],de.prototype,"top",null);R([I()],de.prototype,"linkOffsetX",null);R([I()],de.prototype,"linkOffsetY",null);R([I()],de.prototype,"isEnabled",null);R([I()],de.prototype,"disabledColor",null);R([I()],de.prototype,"disabledColorItem",null);R([I()],de.prototype,"overlapGroup",void 0);R([I()],de.prototype,"overlapDeltaMultiplier",void 0);Ji("BABYLON.GUI.Control",de);class B{}B.ALPHA_DISABLE=0;B.ALPHA_ADD=1;B.ALPHA_COMBINE=2;B.ALPHA_SUBTRACT=3;B.ALPHA_MULTIPLY=4;B.ALPHA_MAXIMIZED=5;B.ALPHA_ONEONE=6;B.ALPHA_PREMULTIPLIED=7;B.ALPHA_PREMULTIPLIED_PORTERDUFF=8;B.ALPHA_INTERPOLATE=9;B.ALPHA_SCREENMODE=10;B.ALPHA_ONEONE_ONEONE=11;B.ALPHA_ALPHATOCOLOR=12;B.ALPHA_REVERSEONEMINUS=13;B.ALPHA_SRC_DSTONEMINUSSRCALPHA=14;B.ALPHA_ONEONE_ONEZERO=15;B.ALPHA_EXCLUSION=16;B.ALPHA_LAYER_ACCUMULATE=17;B.ALPHA_EQUATION_ADD=0;B.ALPHA_EQUATION_SUBSTRACT=1;B.ALPHA_EQUATION_REVERSE_SUBTRACT=2;B.ALPHA_EQUATION_MAX=3;B.ALPHA_EQUATION_MIN=4;B.ALPHA_EQUATION_DARKEN=5;B.DELAYLOADSTATE_NONE=0;B.DELAYLOADSTATE_LOADED=1;B.DELAYLOADSTATE_LOADING=2;B.DELAYLOADSTATE_NOTLOADED=4;B.NEVER=512;B.ALWAYS=519;B.LESS=513;B.EQUAL=514;B.LEQUAL=515;B.GREATER=516;B.GEQUAL=518;B.NOTEQUAL=517;B.KEEP=7680;B.ZERO=0;B.REPLACE=7681;B.INCR=7682;B.DECR=7683;B.INVERT=5386;B.INCR_WRAP=34055;B.DECR_WRAP=34056;B.TEXTURE_CLAMP_ADDRESSMODE=0;B.TEXTURE_WRAP_ADDRESSMODE=1;B.TEXTURE_MIRROR_ADDRESSMODE=2;B.TEXTURE_CREATIONFLAG_STORAGE=1;B.TEXTUREFORMAT_ALPHA=0;B.TEXTUREFORMAT_LUMINANCE=1;B.TEXTUREFORMAT_LUMINANCE_ALPHA=2;B.TEXTUREFORMAT_RGB=4;B.TEXTUREFORMAT_RGBA=5;B.TEXTUREFORMAT_RED=6;B.TEXTUREFORMAT_R=6;B.TEXTUREFORMAT_RG=7;B.TEXTUREFORMAT_RED_INTEGER=8;B.TEXTUREFORMAT_R_INTEGER=8;B.TEXTUREFORMAT_RG_INTEGER=9;B.TEXTUREFORMAT_RGB_INTEGER=10;B.TEXTUREFORMAT_RGBA_INTEGER=11;B.TEXTUREFORMAT_BGRA=12;B.TEXTUREFORMAT_DEPTH24_STENCIL8=13;B.TEXTUREFORMAT_DEPTH32_FLOAT=14;B.TEXTUREFORMAT_DEPTH16=15;B.TEXTUREFORMAT_DEPTH24=16;B.TEXTUREFORMAT_DEPTH24UNORM_STENCIL8=17;B.TEXTUREFORMAT_DEPTH32FLOAT_STENCIL8=18;B.TEXTUREFORMAT_STENCIL8=19;B.TEXTUREFORMAT_UNDEFINED=4294967295;B.TEXTUREFORMAT_COMPRESSED_RGBA_BPTC_UNORM=36492;B.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_BPTC_UNORM=36493;B.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT=36495;B.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_SIGNED_FLOAT=36494;B.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT5=33779;B.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919;B.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT3=33778;B.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918;B.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT1=33777;B.TEXTUREFORMAT_COMPRESSED_RGB_S3TC_DXT1=33776;B.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917;B.TEXTUREFORMAT_COMPRESSED_SRGB_S3TC_DXT1_EXT=35916;B.TEXTUREFORMAT_COMPRESSED_RGBA_ASTC_4x4=37808;B.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840;B.TEXTUREFORMAT_COMPRESSED_RGB_ETC1_WEBGL=36196;B.TEXTUREFORMAT_COMPRESSED_RGB8_ETC2=37492;B.TEXTUREFORMAT_COMPRESSED_SRGB8_ETC2=37493;B.TEXTUREFORMAT_COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494;B.TEXTUREFORMAT_COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495;B.TEXTUREFORMAT_COMPRESSED_RGBA8_ETC2_EAC=37496;B.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497;B.TEXTURETYPE_UNSIGNED_BYTE=0;B.TEXTURETYPE_UNSIGNED_INT=0;B.TEXTURETYPE_FLOAT=1;B.TEXTURETYPE_HALF_FLOAT=2;B.TEXTURETYPE_BYTE=3;B.TEXTURETYPE_SHORT=4;B.TEXTURETYPE_UNSIGNED_SHORT=5;B.TEXTURETYPE_INT=6;B.TEXTURETYPE_UNSIGNED_INTEGER=7;B.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8;B.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9;B.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10;B.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11;B.TEXTURETYPE_UNSIGNED_INT_24_8=12;B.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13;B.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14;B.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15;B.TEXTURETYPE_UNDEFINED=16;B.TEXTURE_2D=3553;B.TEXTURE_2D_ARRAY=35866;B.TEXTURE_CUBE_MAP=34067;B.TEXTURE_CUBE_MAP_ARRAY=3735928559;B.TEXTURE_3D=32879;B.TEXTURE_NEAREST_SAMPLINGMODE=1;B.TEXTURE_NEAREST_NEAREST=1;B.TEXTURE_BILINEAR_SAMPLINGMODE=2;B.TEXTURE_LINEAR_LINEAR=2;B.TEXTURE_TRILINEAR_SAMPLINGMODE=3;B.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3;B.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4;B.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5;B.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6;B.TEXTURE_NEAREST_LINEAR=7;B.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8;B.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9;B.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10;B.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11;B.TEXTURE_LINEAR_NEAREST=12;B.TEXTURE_EXPLICIT_MODE=0;B.TEXTURE_SPHERICAL_MODE=1;B.TEXTURE_PLANAR_MODE=2;B.TEXTURE_CUBIC_MODE=3;B.TEXTURE_PROJECTION_MODE=4;B.TEXTURE_SKYBOX_MODE=5;B.TEXTURE_INVCUBIC_MODE=6;B.TEXTURE_EQUIRECTANGULAR_MODE=7;B.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8;B.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9;B.TEXTURE_FILTERING_QUALITY_OFFLINE=4096;B.TEXTURE_FILTERING_QUALITY_HIGH=64;B.TEXTURE_FILTERING_QUALITY_MEDIUM=16;B.TEXTURE_FILTERING_QUALITY_LOW=8;B.SCALEMODE_FLOOR=1;B.SCALEMODE_NEAREST=2;B.SCALEMODE_CEILING=3;B.MATERIAL_TextureDirtyFlag=1;B.MATERIAL_LightDirtyFlag=2;B.MATERIAL_FresnelDirtyFlag=4;B.MATERIAL_AttributesDirtyFlag=8;B.MATERIAL_MiscDirtyFlag=16;B.MATERIAL_PrePassDirtyFlag=32;B.MATERIAL_AllDirtyFlag=63;B.MATERIAL_TriangleFillMode=0;B.MATERIAL_WireFrameFillMode=1;B.MATERIAL_PointFillMode=2;B.MATERIAL_PointListDrawMode=3;B.MATERIAL_LineListDrawMode=4;B.MATERIAL_LineLoopDrawMode=5;B.MATERIAL_LineStripDrawMode=6;B.MATERIAL_TriangleStripDrawMode=7;B.MATERIAL_TriangleFanDrawMode=8;B.MATERIAL_ClockWiseSideOrientation=0;B.MATERIAL_CounterClockWiseSideOrientation=1;B.ACTION_NothingTrigger=0;B.ACTION_OnPickTrigger=1;B.ACTION_OnLeftPickTrigger=2;B.ACTION_OnRightPickTrigger=3;B.ACTION_OnCenterPickTrigger=4;B.ACTION_OnPickDownTrigger=5;B.ACTION_OnDoublePickTrigger=6;B.ACTION_OnPickUpTrigger=7;B.ACTION_OnPickOutTrigger=16;B.ACTION_OnLongPressTrigger=8;B.ACTION_OnPointerOverTrigger=9;B.ACTION_OnPointerOutTrigger=10;B.ACTION_OnEveryFrameTrigger=11;B.ACTION_OnIntersectionEnterTrigger=12;B.ACTION_OnIntersectionExitTrigger=13;B.ACTION_OnKeyDownTrigger=14;B.ACTION_OnKeyUpTrigger=15;B.PARTICLES_BILLBOARDMODE_Y=2;B.PARTICLES_BILLBOARDMODE_ALL=7;B.PARTICLES_BILLBOARDMODE_STRETCHED=8;B.PARTICLES_BILLBOARDMODE_STRETCHED_LOCAL=9;B.MESHES_CULLINGSTRATEGY_STANDARD=0;B.MESHES_CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1;B.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2;B.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3;B.SCENELOADER_NO_LOGGING=0;B.SCENELOADER_MINIMAL_LOGGING=1;B.SCENELOADER_SUMMARY_LOGGING=2;B.SCENELOADER_DETAILED_LOGGING=3;B.PREPASS_IRRADIANCE_TEXTURE_TYPE=0;B.PREPASS_POSITION_TEXTURE_TYPE=1;B.PREPASS_VELOCITY_TEXTURE_TYPE=2;B.PREPASS_REFLECTIVITY_TEXTURE_TYPE=3;B.PREPASS_COLOR_TEXTURE_TYPE=4;B.PREPASS_DEPTH_TEXTURE_TYPE=5;B.PREPASS_NORMAL_TEXTURE_TYPE=6;B.PREPASS_ALBEDO_SQRT_TEXTURE_TYPE=7;B.BUFFER_CREATIONFLAG_READ=1;B.BUFFER_CREATIONFLAG_WRITE=2;B.BUFFER_CREATIONFLAG_READWRITE=3;B.BUFFER_CREATIONFLAG_UNIFORM=4;B.BUFFER_CREATIONFLAG_VERTEX=8;B.BUFFER_CREATIONFLAG_INDEX=16;B.BUFFER_CREATIONFLAG_STORAGE=32;B.RENDERPASS_MAIN=0;B.INPUT_ALT_KEY=18;B.INPUT_CTRL_KEY=17;B.INPUT_META_KEY1=91;B.INPUT_META_KEY2=92;B.INPUT_META_KEY3=93;B.INPUT_SHIFT_KEY=16;B.SNAPSHOTRENDERING_STANDARD=0;B.SNAPSHOTRENDERING_FAST=1;B.PERSPECTIVE_CAMERA=0;B.ORTHOGRAPHIC_CAMERA=1;B.FOVMODE_VERTICAL_FIXED=0;B.FOVMODE_HORIZONTAL_FIXED=1;B.RIG_MODE_NONE=0;B.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10;B.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11;B.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12;B.RIG_MODE_STEREOSCOPIC_OVERUNDER=13;B.RIG_MODE_STEREOSCOPIC_INTERLACED=14;B.RIG_MODE_VR=20;B.RIG_MODE_CUSTOM=22;B.MAX_SUPPORTED_UV_SETS=6;B.GL_ALPHA_EQUATION_ADD=32774;B.GL_ALPHA_EQUATION_MIN=32775;B.GL_ALPHA_EQUATION_MAX=32776;B.GL_ALPHA_EQUATION_SUBTRACT=32778;B.GL_ALPHA_EQUATION_REVERSE_SUBTRACT=32779;B.GL_ALPHA_FUNCTION_SRC=768;B.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_COLOR=769;B.GL_ALPHA_FUNCTION_SRC_ALPHA=770;B.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_ALPHA=771;B.GL_ALPHA_FUNCTION_DST_ALPHA=772;B.GL_ALPHA_FUNCTION_ONE_MINUS_DST_ALPHA=773;B.GL_ALPHA_FUNCTION_DST_COLOR=774;B.GL_ALPHA_FUNCTION_ONE_MINUS_DST_COLOR=775;B.GL_ALPHA_FUNCTION_SRC_ALPHA_SATURATED=776;B.GL_ALPHA_FUNCTION_CONSTANT_COLOR=32769;B.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_COLOR=32770;B.GL_ALPHA_FUNCTION_CONSTANT_ALPHA=32771;B.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_ALPHA=32772;B.SnippetUrl="https://snippet.babylonjs.com";B.FOGMODE_NONE=0;B.FOGMODE_EXP=1;B.FOGMODE_EXP2=2;B.FOGMODE_LINEAR=3;B.BYTE=5120;B.UNSIGNED_BYTE=5121;B.SHORT=5122;B.UNSIGNED_SHORT=5123;B.INT=5124;B.UNSIGNED_INT=5125;B.FLOAT=5126;B.PositionKind="position";B.NormalKind="normal";B.TangentKind="tangent";B.UVKind="uv";B.UV2Kind="uv2";B.UV3Kind="uv3";B.UV4Kind="uv4";B.UV5Kind="uv5";B.UV6Kind="uv6";B.ColorKind="color";B.ColorInstanceKind="instanceColor";B.MatricesIndicesKind="matricesIndices";B.MatricesWeightsKind="matricesWeights";B.MatricesIndicesExtraKind="matricesIndicesExtra";B.MatricesWeightsExtraKind="matricesWeightsExtra";let js=class extends de{get renderToIntermediateTexture(){return this._renderToIntermediateTexture}set renderToIntermediateTexture(e){this._renderToIntermediateTexture!==e&&(this._renderToIntermediateTexture=e,this._markAsDirty())}get adaptHeightToChildren(){return this._adaptHeightToChildren}set adaptHeightToChildren(e){this._adaptHeightToChildren!==e&&(this._adaptHeightToChildren=e,e&&(this.height="100%"),this._markAsDirty())}get adaptWidthToChildren(){return this._adaptWidthToChildren}set adaptWidthToChildren(e){this._adaptWidthToChildren!==e&&(this._adaptWidthToChildren=e,e&&(this.width="100%"),this._markAsDirty())}get background(){return this._background}set background(e){this._background!==e&&(this._background=e,this._markAsDirty())}get backgroundGradient(){return this._backgroundGradient}set backgroundGradient(e){this._backgroundGradient!==e&&(this._backgroundGradient=e,this._markAsDirty())}get children(){return this._children}get isReadOnly(){return this._isReadOnly}set isReadOnly(e){this._isReadOnly=e;for(const t of this._children)t.isReadOnly=e}constructor(e){super(e),this.name=e,this._children=new Array,this._measureForChildren=nr.Empty(),this._background="",this._backgroundGradient=null,this._adaptWidthToChildren=!1,this._adaptHeightToChildren=!1,this._renderToIntermediateTexture=!1,this._intermediateTexture=null,this.delegatePickingToChildren=!1,this.logLayoutCycleErrors=!1,this.maxLayoutCycle=3,this.onControlAddedObservable=new Y,this.onControlRemovedObservable=new Y,this._inverseTransformMatrix=ht.Identity(),this._inverseMeasure=new nr(0,0,0,0)}_getTypeName(){return"Container"}_flagDescendantsAsMatrixDirty(){for(const e of this.children)e._isClipped=!1,e._markMatrixAsDirty()}getChildByName(e){for(const t of this.children)if(t.name===e)return t;return null}getChildByType(e,t){for(const i of this.children)if(i.typeName===t)return i;return null}containsControl(e){return this.children.indexOf(e)!==-1}addControl(e){return e?this._children.indexOf(e)!==-1?this:(e._link(this._host),e._markAllAsDirty(),this._reOrderControl(e),this._markAsDirty(),this.onControlAddedObservable.notifyObservers(e),this):this}clearControls(){const e=this.children.slice();for(const t of e)this.removeControl(t);return this}removeControl(e){const t=this._children.indexOf(e);return t!==-1&&(this._children.splice(t,1),e.parent=null),e.linkWithMesh(null),this._host&&this._host._cleanControlAfterRemoval(e),this._markAsDirty(),this.onControlRemovedObservable.notifyObservers(e),this}_reOrderControl(e){const t=e.linkedMesh;this.removeControl(e);let i=!1;for(let r=0;r<this._children.length;r++)if(this._children[r].zIndex>e.zIndex){this._children.splice(r,0,e),i=!0;break}i||this._children.push(e),e.parent=this,t&&e.linkWithMesh(t),this._markAsDirty()}_offsetLeft(e){super._offsetLeft(e);for(const t of this._children)t._offsetLeft(e)}_offsetTop(e){super._offsetTop(e);for(const t of this._children)t._offsetTop(e)}_markAllAsDirty(){super._markAllAsDirty();for(let e=0;e<this._children.length;e++)this._children[e]._markAllAsDirty()}_getBackgroundColor(e){return this._backgroundGradient?this._backgroundGradient.getCanvasGradient(e):this._background}_localDraw(e){(this._background||this._backgroundGradient)&&(e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),e.fillStyle=this._getBackgroundColor(e),e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height),e.restore())}_link(e){super._link(e);for(const t of this._children)t._link(e)}_beforeLayout(){}_processMeasures(e,t){(this._isDirty||!this._cachedParentMeasure.isEqualsTo(e))&&(super._processMeasures(e,t),this._evaluateClippingState(e),this._renderToIntermediateTexture&&(this._intermediateTexture&&this._host.getScene()!=this._intermediateTexture.getScene()&&(this._intermediateTexture.dispose(),this._intermediateTexture=null),this._intermediateTexture?this._intermediateTexture.scaleTo(this._currentMeasure.width,this._currentMeasure.height):(this._intermediateTexture=new wu("",{width:this._currentMeasure.width,height:this._currentMeasure.height},this._host.getScene(),!1,re.NEAREST_SAMPLINGMODE,B.TEXTUREFORMAT_RGBA,!1),this._intermediateTexture.hasAlpha=!0)))}_layout(e,t){var r,s;if(!this.isDirty&&(!this.isVisible||this.notRenderable))return!1;this.host._numLayoutCalls++,this._isDirty&&this._currentMeasure.transformToRef(this._transformMatrix,this._prevCurrentMeasureTransformedIntoGlobalSpace);let i=0;t.save(),this._applyStates(t),this._beforeLayout();do{let a=-1,l=-1;if(this._rebuildLayout=!1,this._processMeasures(e,t),!this._isClipped){for(const o of this._children)o._tempParentMeasure.copyFrom(this._measureForChildren),o._layout(this._measureForChildren,t)&&o.isVisible&&!o.notRenderable&&(this.adaptWidthToChildren&&o._width.isPixel&&(a=Math.max(a,o._currentMeasure.width+o._paddingLeftInPixels+o._paddingRightInPixels)),this.adaptHeightToChildren&&o._height.isPixel&&(l=Math.max(l,o._currentMeasure.height+o._paddingTopInPixels+o._paddingBottomInPixels)));this.adaptWidthToChildren&&a>=0&&(a+=this.paddingLeftInPixels+this.paddingRightInPixels,this.width!==a+"px"&&((r=this.parent)==null||r._markAsDirty(),this.width=a+"px",this._width.ignoreAdaptiveScaling=!0,this._rebuildLayout=!0)),this.adaptHeightToChildren&&l>=0&&(l+=this.paddingTopInPixels+this.paddingBottomInPixels,this.height!==l+"px"&&((s=this.parent)==null||s._markAsDirty(),this.height=l+"px",this._height.ignoreAdaptiveScaling=!0,this._rebuildLayout=!0)),this._postMeasure()}i++}while(this._rebuildLayout&&i<this.maxLayoutCycle);return i>=3&&this.logLayoutCycleErrors&&ee.Error(`Layout cycle detected in GUI (Container name=${this.name}, uniqueId=${this.uniqueId})`),t.restore(),this._isDirty&&(this.invalidateRect(),this._isDirty=!1),!0}_postMeasure(){}_draw(e,t){const i=this._renderToIntermediateTexture&&this._intermediateTexture,r=i?this._intermediateTexture.getContext():e;i&&(r.save(),r.translate(-this._currentMeasure.left,-this._currentMeasure.top),t?(this._transformMatrix.invertToRef(this._inverseTransformMatrix),t.transformToRef(this._inverseTransformMatrix,this._inverseMeasure),r.clearRect(this._inverseMeasure.left,this._inverseMeasure.top,this._inverseMeasure.width,this._inverseMeasure.height)):r.clearRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),this._localDraw(r),e.save(),this.clipChildren&&this._clipForChildren(r);for(const s of this._children)t&&!s._intersectsRect(t)||s._render(r,t);i&&(r.restore(),e.save(),e.globalAlpha=this.alpha,e.drawImage(r.canvas,this._currentMeasure.left,this._currentMeasure.top),e.restore()),e.restore()}getDescendantsToRef(e,t=!1,i){if(this.children)for(let r=0;r<this.children.length;r++){const s=this.children[r];(!i||i(s))&&e.push(s),t||s.getDescendantsToRef(e,!1,i)}}_processPicking(e,t,i,r,s,a,l,o){if(!this._isEnabled||!this.isVisible||this.notRenderable)return!1;const c=super.contains(e,t);if(!c&&this.clipChildren)return!1;if(this.delegatePickingToChildren){let u=!1;for(let h=this._children.length-1;h>=0;h--){const d=this._children[h];if(d.isEnabled&&d.isHitTestVisible&&d.isVisible&&!d.notRenderable&&d.contains(e,t)){u=!0;break}}if(!u)return!1}for(let u=this._children.length-1;u>=0;u--){const h=this._children[u];if(h._processPicking(e,t,i,r,s,a,l,o))return h.hoverCursor&&this._host._changeCursor(h.hoverCursor),!0}return!c||!this.isHitTestVisible?!1:this._processObservables(r,e,t,i,s,a,l,o)}_additionalProcessing(e,t){super._additionalProcessing(e,t),this._measureForChildren.copyFrom(this._currentMeasure)}_getAdaptDimTo(e){return e==="width"?this.adaptWidthToChildren:this.adaptHeightToChildren}isDimensionFullyDefined(e){if(this._getAdaptDimTo(e)){for(const t of this.children)if(!t.isDimensionFullyDefined(e))return!1;return!0}return super.isDimensionFullyDefined(e)}serialize(e,t=!1){if(super.serialize(e,t),!(!this.isSerializable&&!t)&&(this.backgroundGradient&&(e.backgroundGradient={},this.backgroundGradient.serialize(e.backgroundGradient)),!!this.children.length)){e.children=[];for(const i of this.children)if(i.isSerializable||t){const r={};i.serialize(r),e.children.push(r)}}}dispose(){var e;super.dispose();for(let t=this.children.length-1;t>=0;t--)this.children[t].dispose();(e=this._intermediateTexture)==null||e.dispose()}_parseFromContent(e,t){var i;if(super._parseFromContent(e,t),this._link(t),e.backgroundGradient){const r=X.Instantiate("BABYLON.GUI."+e.backgroundGradient.className);this._backgroundGradient=new r,(i=this._backgroundGradient)==null||i.parse(e.backgroundGradient)}if(e.children)for(const r of e.children)this.addControl(de.Parse(r,t))}isReady(){for(const e of this.children)if(!e.isReady())return!1;return!0}};R([I()],js.prototype,"delegatePickingToChildren",void 0);R([I()],js.prototype,"renderToIntermediateTexture",null);R([I()],js.prototype,"maxLayoutCycle",void 0);R([I()],js.prototype,"adaptHeightToChildren",null);R([I()],js.prototype,"adaptWidthToChildren",null);R([I()],js.prototype,"background",null);R([I()],js.prototype,"backgroundGradient",null);Ji("BABYLON.GUI.Container",js);class Zz{constructor(e){this._fontFamily="Arial",this._fontStyle="",this._fontWeight="",this._fontSize=new xt(18,xt.UNITMODE_PIXEL,!1),this.onChangedObservable=new Y,this._host=e}get fontSize(){return this._fontSize.toString(this._host)}set fontSize(e){this._fontSize.toString(this._host)!==e&&this._fontSize.fromString(e)&&this.onChangedObservable.notifyObservers(this)}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.onChangedObservable.notifyObservers(this))}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.onChangedObservable.notifyObservers(this))}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.onChangedObservable.notifyObservers(this))}dispose(){this.onChangedObservable.clear()}}class Yi extends wu{get numLayoutCalls(){return this._numLayoutCalls}get numRenderCalls(){return this._numRenderCalls}get renderScale(){return this._renderScale}set renderScale(e){e!==this._renderScale&&(this._renderScale=e,this._onResize())}get background(){return this._background}set background(e){this._background!==e&&(this._background=e,this.markAsDirty())}get idealWidth(){return this._idealWidth}set idealWidth(e){this._idealWidth!==e&&(this._idealWidth=e,this.markAsDirty(),this._rootContainer._markAllAsDirty())}get idealHeight(){return this._idealHeight}set idealHeight(e){this._idealHeight!==e&&(this._idealHeight=e,this.markAsDirty(),this._rootContainer._markAllAsDirty())}get useSmallestIdeal(){return this._useSmallestIdeal}set useSmallestIdeal(e){this._useSmallestIdeal!==e&&(this._useSmallestIdeal=e,this.markAsDirty(),this._rootContainer._markAllAsDirty())}get renderAtIdealSize(){return this._renderAtIdealSize}set renderAtIdealSize(e){this._renderAtIdealSize!==e&&(this._renderAtIdealSize=e,this._onResize())}get idealRatio(){let e=0,t=0;return this._idealWidth&&(e=this.getSize().width/this._idealWidth),this._idealHeight&&(t=this.getSize().height/this._idealHeight),this._useSmallestIdeal&&this._idealWidth&&this._idealHeight?window.innerWidth<window.innerHeight?e:t:this._idealWidth?e:this._idealHeight?t:1}get layer(){return this._layerToDispose}get rootContainer(){return this._rootContainer}getChildren(){return[this._rootContainer]}getDescendants(e,t){return this._rootContainer.getDescendants(e,t)}getControlsByType(e){return this._rootContainer.getDescendants(!1,t=>t.typeName===e)}getControlByName(e){return this._getControlByKey("name",e)}_getControlByKey(e,t){return this._rootContainer.getDescendants().find(i=>i[e]===t)||null}get focusedControl(){return this._focusedControl}set focusedControl(e){this._focusedControl!=e&&(this._focusedControl&&this._focusedControl.onBlur(),e&&e.onFocus(),this._focusedControl=e)}get isForeground(){return this.layer?!this.layer.isBackground:!0}set isForeground(e){this.layer&&this.layer.isBackground!==!e&&(this.layer.isBackground=!e)}get clipboardData(){return this._clipboardData}set clipboardData(e){this._clipboardData=e}constructor(e,t=0,i=0,r,s=!1,a=re.NEAREST_SAMPLINGMODE,l=!0){super(e,{width:t,height:i},r,s,a,B.TEXTUREFORMAT_RGBA,l),this.onGuiReadyObservable=new Y,this._isDirty=!1,this._rootContainer=new js("root"),this._lastControlOver={},this._lastControlDown={},this._capturingControl={},this._linkedControls=new Array,this._isFullscreen=!1,this._fullscreenViewport=new Ms(0,0,1,1),this._idealWidth=0,this._idealHeight=0,this._useSmallestIdeal=!1,this._renderAtIdealSize=!1,this._blockNextFocusCheck=!1,this._renderScale=1,this._cursorChanged=!1,this._defaultMousePointerId=0,this._rootChildrenHaveChanged=!1,this._capturedPointerIds=new Set,this._numLayoutCalls=0,this._numRenderCalls=0,this._clipboardData="",this.onClipboardObservable=new Y,this.onControlPickedObservable=new Y,this.onBeginLayoutObservable=new Y,this.onEndLayoutObservable=new Y,this.onBeginRenderObservable=new Y,this.onEndRenderObservable=new Y,this.premulAlpha=!1,this.applyYInversionOnUpdate=!0,this.skipBlockEvents=0,this.checkPointerEveryFrame=!1,this._useInvalidateRectOptimization=!0,this._invalidatedRectangle=null,this._clearMeasure=new nr(0,0,0,0),this._onClipboardCopy=o=>{const c=o,u=new lp(Ls.COPY,c);this.onClipboardObservable.notifyObservers(u),c.preventDefault()},this._onClipboardCut=o=>{const c=o,u=new lp(Ls.CUT,c);this.onClipboardObservable.notifyObservers(u),c.preventDefault()},this._onClipboardPaste=o=>{const c=o,u=new lp(Ls.PASTE,c);this.onClipboardObservable.notifyObservers(u),c.preventDefault()},this.parseContent=this.parseSerializedObject,r=this.getScene(),!(!r||!this._texture)&&(this.applyYInversionOnUpdate=l,this._rootElement=r.getEngine().getInputElement(),this._renderObserver=r.onBeforeCameraRenderObservable.add(o=>this._checkUpdate(o)),this._controlAddedObserver=this._rootContainer.onControlAddedObservable.add(o=>{o&&(this._rootChildrenHaveChanged=!0)}),this._controlRemovedObserver=this._rootContainer.onControlRemovedObservable.add(o=>{o&&(this._rootChildrenHaveChanged=!0)}),this._preKeyboardObserver=r.onPreKeyboardObservable.add(o=>{this._focusedControl&&(o.type===So.KEYDOWN&&this._focusedControl.processKeyboard(o.event),o.skipOnPointerObservable=!0)}),this._rootContainer._link(this),this.hasAlpha=!0,(!t||!i)&&(this._resizeObserver=r.getEngine().onResizeObservable.add(()=>this._onResize()),this._onResize()),this._texture.isReady=!0)}getClassName(){return"AdvancedDynamicTexture"}executeOnAllControls(e,t){t||(t=this._rootContainer),e(t);for(const i of t.children){if(i.children){this.executeOnAllControls(e,i);continue}e(i)}}get useInvalidateRectOptimization(){return this._useInvalidateRectOptimization}set useInvalidateRectOptimization(e){this._useInvalidateRectOptimization=e}invalidateRect(e,t,i,r){if(this._useInvalidateRectOptimization)if(!this._invalidatedRectangle)this._invalidatedRectangle=new nr(e,t,i-e+1,r-t+1);else{const s=Math.ceil(Math.max(this._invalidatedRectangle.left+this._invalidatedRectangle.width-1,i)),a=Math.ceil(Math.max(this._invalidatedRectangle.top+this._invalidatedRectangle.height-1,r));this._invalidatedRectangle.left=Math.floor(Math.min(this._invalidatedRectangle.left,e)),this._invalidatedRectangle.top=Math.floor(Math.min(this._invalidatedRectangle.top,t)),this._invalidatedRectangle.width=s-this._invalidatedRectangle.left+1,this._invalidatedRectangle.height=a-this._invalidatedRectangle.top+1}}markAsDirty(){this._isDirty=!0}createStyle(){return new Zz(this)}addControl(e){return this._rootContainer.addControl(e),this}removeControl(e){return this._rootContainer.removeControl(e),this}moveToNonOverlappedPosition(e,t=1,i=1){let r;if(Array.isArray(e))r=e;else{const s=this.getDescendants(!0);r=e===void 0?s.filter(a=>a.overlapGroup!==void 0):s.filter(a=>a.overlapGroup===e)}r.forEach(s=>{let a=xe.Zero();const l=new xe(s.centerX,s.centerY);r.forEach(o=>{if(s!==o&&Yi._Overlaps(s,o)){const c=l.subtract(new xe(o.centerX,o.centerY)),u=c.length();u>0&&(a=a.add(c.normalize().scale(i/u)))}}),a.length()>0&&(a=a.normalize().scale(t*(s.overlapDeltaMultiplier??1)),s.linkOffsetXInPixels+=a.x,s.linkOffsetYInPixels+=a.y)})}dispose(){const e=this.getScene();e&&(this._rootElement=null,e.onBeforeCameraRenderObservable.remove(this._renderObserver),this._resizeObserver&&e.getEngine().onResizeObservable.remove(this._resizeObserver),this._prePointerObserver&&e.onPrePointerObservable.remove(this._prePointerObserver),this._sceneRenderObserver&&e.onBeforeRenderObservable.remove(this._sceneRenderObserver),this._pointerObserver&&e.onPointerObservable.remove(this._pointerObserver),this._preKeyboardObserver&&e.onPreKeyboardObservable.remove(this._preKeyboardObserver),this._canvasPointerOutObserver&&e.getEngine().onCanvasPointerOutObservable.remove(this._canvasPointerOutObserver),this._canvasBlurObserver&&e.getEngine().onCanvasBlurObservable.remove(this._canvasBlurObserver),this._controlAddedObserver&&this._rootContainer.onControlAddedObservable.remove(this._controlAddedObserver),this._controlRemovedObserver&&this._rootContainer.onControlRemovedObservable.remove(this._controlRemovedObserver),this._layerToDispose&&(this._layerToDispose.texture=null,this._layerToDispose.dispose(),this._layerToDispose=null),this._rootContainer.dispose(),this.onClipboardObservable.clear(),this.onControlPickedObservable.clear(),this.onBeginRenderObservable.clear(),this.onEndRenderObservable.clear(),this.onBeginLayoutObservable.clear(),this.onEndLayoutObservable.clear(),this.onGuiReadyObservable.clear(),super.dispose())}_onResize(){const e=this.getScene();if(!e)return;const t=e.getEngine(),i=this.getSize();let r=t.getRenderWidth()*this._renderScale,s=t.getRenderHeight()*this._renderScale;this._renderAtIdealSize&&(this._idealWidth?(s=s*this._idealWidth/r,r=this._idealWidth):this._idealHeight&&(r=r*this._idealHeight/s,s=this._idealHeight)),(i.width!==r||i.height!==s)&&(this.scaleTo(r,s),this.markAsDirty(),(this._idealWidth||this._idealHeight)&&this._rootContainer._markAllAsDirty()),this.invalidateRect(0,0,i.width-1,i.height-1)}_getGlobalViewport(){const e=this.getSize(),t=this._fullscreenViewport.toGlobal(e.width,e.height),i=Math.round(t.width*(1/this.rootContainer.scaleX)),r=Math.round(t.height*(1/this.rootContainer.scaleY));return t.x+=(t.width-i)/2,t.y+=(t.height-r)/2,t.width=i,t.height=r,t}getProjectedPosition(e,t){const i=this.getProjectedPositionWithZ(e,t);return new xe(i.x,i.y)}getProjectedPositionWithZ(e,t){const i=this.getScene();if(!i)return A.Zero();const r=this._getGlobalViewport(),s=A.Project(e,t,i.getTransformMatrix(),r);return new A(s.x,s.y,s.z)}_checkUpdate(e,t){if(!(this._layerToDispose&&!(e.layerMask&this._layerToDispose.layerMask))){if(this._isFullscreen&&this._linkedControls.length){const i=this.getScene();if(!i)return;const r=this._getGlobalViewport();for(const s of this._linkedControls){if(!s.isVisible)continue;const a=s._linkedMesh;if(!a||a.isDisposed()){X.SetImmediate(()=>{s.linkWithMesh(null)});continue}const l=a.getBoundingInfo?a.getBoundingInfo().boundingSphere.center:A.ZeroReadOnly,o=A.Project(l,a.getWorldMatrix(),i.getTransformMatrix(),r);if(o.z<0||o.z>1){s.notRenderable=!0;continue}s.notRenderable=!1,this.useInvalidateRectOptimization&&s.invalidateRect(),s._moveToProjectedPosition(o)}}!this._isDirty&&!this._rootContainer.isDirty||(this._isDirty=!1,this._render(t),t||this.update(this.applyYInversionOnUpdate,this.premulAlpha,Yi.AllowGPUOptimizations))}}_render(e){var l;const t=this.getSize(),i=t.width,r=t.height,s=this.getContext();if(s.font="18px Arial",s.strokeStyle="white",this.onGuiReadyObservable.hasObservers()&&this._checkGuiIsReady(),this._rootChildrenHaveChanged){const o=(l=this.getScene())==null?void 0:l.activeCamera;o&&(this._rootChildrenHaveChanged=!1,this._checkUpdate(o,!0))}this.onBeginLayoutObservable.notifyObservers(this);const a=new nr(0,0,i,r);this._numLayoutCalls=0,this._rootContainer._layout(a,s),this.onEndLayoutObservable.notifyObservers(this),this._isDirty=!1,!e&&(this._invalidatedRectangle?this._clearMeasure.copyFrom(this._invalidatedRectangle):this._clearMeasure.copyFromFloats(0,0,i,r),s.clearRect(this._clearMeasure.left,this._clearMeasure.top,this._clearMeasure.width,this._clearMeasure.height),this._background&&(s.save(),s.fillStyle=this._background,s.fillRect(this._clearMeasure.left,this._clearMeasure.top,this._clearMeasure.width,this._clearMeasure.height),s.restore()),this.onBeginRenderObservable.notifyObservers(this),this._numRenderCalls=0,this._rootContainer._render(s,this._invalidatedRectangle),this.onEndRenderObservable.notifyObservers(this),this._invalidatedRectangle=null)}_changeCursor(e){this._rootElement&&(this._rootElement.style.cursor=e,this._cursorChanged=!0)}_registerLastControlDown(e,t){this._lastControlDown[t]=e,this.onControlPickedObservable.notifyObservers(e)}_doPicking(e,t,i,r,s,a,l,o){const c=this.getScene();if(!c)return;const u=c.getEngine(),h=this.getSize();if(this._isFullscreen){const d=c.cameraToUseForPointers||c.activeCamera;if(!d)return;const f=d.viewport;e=e*(h.width/(u.getRenderWidth()*f.width)),t=t*(h.height/(u.getRenderHeight()*f.height))}if(this._capturingControl[s]){this._capturingControl[s].isPointerBlocker&&(this._shouldBlockPointer=!0),this._capturingControl[s]._processObservables(r,e,t,i,s,a);return}this._cursorChanged=!1,this._rootContainer._processPicking(e,t,i,r,s,a,l,o)||(c.doNotHandleCursors||this._changeCursor(""),r===be.POINTERMOVE&&this._lastControlOver[s]&&(this._lastControlOver[s]._onPointerOut(this._lastControlOver[s],i),delete this._lastControlOver[s])),!this._cursorChanged&&!c.doNotHandleCursors&&this._changeCursor(""),this._manageFocus()}_cleanControlAfterRemovalFromList(e,t){for(const i in e){if(!Object.prototype.hasOwnProperty.call(e,i))continue;e[i]===t&&delete e[i]}}_cleanControlAfterRemoval(e){this._cleanControlAfterRemovalFromList(this._lastControlDown,e),this._cleanControlAfterRemovalFromList(this._lastControlOver,e)}pick(e,t,i=null){this._isFullscreen&&this._scene&&this._translateToPicking(this._scene,new Ms(0,0,0,0),i,e,t)}_translateToPicking(e,t,i,r=e.pointerX,s=e.pointerY){const a=e.cameraToUseForPointers||e.activeCamera,l=e.getEngine(),o=e.cameraToUseForPointers;if(!a)t.x=0,t.y=0,t.width=l.getRenderWidth(),t.height=l.getRenderHeight();else if(a.rigCameras.length){const h=new Ms(0,0,1,1);a.rigCameras.forEach(d=>{d.viewport.toGlobalToRef(l.getRenderWidth(),l.getRenderHeight(),h);const f=r/l.getHardwareScalingLevel()-h.x,_=s/l.getHardwareScalingLevel()-(l.getRenderHeight()-h.y-h.height);f<0||_<0||r>h.width||s>h.height||(e.cameraToUseForPointers=d,t.x=h.x,t.y=h.y,t.width=h.width,t.height=h.height)})}else a.viewport.toGlobalToRef(l.getRenderWidth(),l.getRenderHeight(),t);const c=r/l.getHardwareScalingLevel()-t.x,u=s/l.getHardwareScalingLevel()-(l.getRenderHeight()-t.y-t.height);if(this._shouldBlockPointer=!1,i){const h=i.event.pointerId||this._defaultMousePointerId;this._doPicking(c,u,i,i.type,h,i.event.button,i.event.deltaX,i.event.deltaY),(this._shouldBlockPointer&&!(i.type&this.skipBlockEvents)||this._capturingControl[h])&&(i.skipOnPointerObservable=!0)}else this._doPicking(c,u,null,be.POINTERMOVE,this._defaultMousePointerId,0);e.cameraToUseForPointers=o}attach(){const e=this.getScene();if(!e)return;const t=new Ms(0,0,0,0);this._prePointerObserver=e.onPrePointerObservable.add(i=>{if(!(e.isPointerCaptured(i.event.pointerId)&&i.type===be.POINTERUP&&!this._capturedPointerIds.has(i.event.pointerId))&&!(i.type!==be.POINTERMOVE&&i.type!==be.POINTERUP&&i.type!==be.POINTERDOWN&&i.type!==be.POINTERWHEEL)){if(i.type===be.POINTERMOVE){if(e.isPointerCaptured(i.event.pointerId))return;i.event.pointerId&&(this._defaultMousePointerId=i.event.pointerId)}this._translateToPicking(e,t,i)}}),this._attachPickingToSceneRender(e,()=>this._translateToPicking(e,t,null),!1),this._attachToOnPointerOut(e),this._attachToOnBlur(e)}registerClipboardEvents(){self.addEventListener("copy",this._onClipboardCopy,!1),self.addEventListener("cut",this._onClipboardCut,!1),self.addEventListener("paste",this._onClipboardPaste,!1)}unRegisterClipboardEvents(){self.removeEventListener("copy",this._onClipboardCopy),self.removeEventListener("cut",this._onClipboardCut),self.removeEventListener("paste",this._onClipboardPaste)}_transformUvs(e){const t=this.getTextureMatrix();let i;if(t.isIdentityAs3x2())i=e;else{const r=V.Matrix[0];t.getRowToRef(0,V.Vector4[0]),t.getRowToRef(1,V.Vector4[1]),t.getRowToRef(2,V.Vector4[2]);const s=V.Vector4[0],a=V.Vector4[1],l=V.Vector4[2];r.setRowFromFloats(0,s.x,s.y,0,0),r.setRowFromFloats(1,a.x,a.y,0,0),r.setRowFromFloats(2,0,0,1,0),r.setRowFromFloats(3,l.x,l.y,0,1),i=V.Vector2[0],xe.TransformToRef(e,r,i)}if((this.wrapU===re.WRAP_ADDRESSMODE||this.wrapU===re.MIRROR_ADDRESSMODE)&&i.x>1){let r=i.x-Math.trunc(i.x);this.wrapU===re.MIRROR_ADDRESSMODE&&Math.trunc(i.x)%2===1&&(r=1-r),i.x=r}if((this.wrapV===re.WRAP_ADDRESSMODE||this.wrapV===re.MIRROR_ADDRESSMODE)&&i.y>1){let r=i.y-Math.trunc(i.y);this.wrapV===re.MIRROR_ADDRESSMODE&&Math.trunc(i.x)%2===1&&(r=1-r),i.y=r}return i}attachToMesh(e,t=!0){const i=this.getScene();i&&(this._pointerObserver&&i.onPointerObservable.remove(this._pointerObserver),this._pointerObserver=i.onPointerObservable.add(r=>{if(r.type!==be.POINTERMOVE&&r.type!==be.POINTERUP&&r.type!==be.POINTERDOWN&&r.type!==be.POINTERWHEEL)return;r.type===be.POINTERMOVE&&r.event.pointerId&&(this._defaultMousePointerId=r.event.pointerId);const s=r.event.pointerId||this._defaultMousePointerId;if(r.pickInfo&&r.pickInfo.hit&&r.pickInfo.pickedMesh===e){let a=r.pickInfo.getTextureCoordinates();if(a){a=this._transformUvs(a);const l=this.getSize();this._doPicking(a.x*l.width,(this.applyYInversionOnUpdate?1-a.y:a.y)*l.height,r,r.type,s,r.event.button,r.event.deltaX,r.event.deltaY)}}else if(r.type===be.POINTERUP){if(this._lastControlDown[s]&&this._lastControlDown[s]._forcePointerUp(s),delete this._lastControlDown[s],this.focusedControl){const a=this.focusedControl.keepsFocusWith();let l=!0;if(a)for(const o of a){if(this===o._host)continue;const c=o._host;if(c._lastControlOver[s]&&c._lastControlOver[s].isAscendant(o)){l=!1;break}}l&&(this.focusedControl=null)}}else r.type===be.POINTERMOVE&&(this._lastControlOver[s]&&this._lastControlOver[s]._onPointerOut(this._lastControlOver[s],r,!0),delete this._lastControlOver[s])}),e.enablePointerMoveEvents=t,this._attachPickingToSceneRender(i,()=>{const r=this._defaultMousePointerId,s=i==null?void 0:i.pick(i.pointerX,i.pointerY);if(s&&s.hit&&s.pickedMesh===e){let a=s.getTextureCoordinates();if(a){a=this._transformUvs(a);const l=this.getSize();this._doPicking(a.x*l.width,(this.applyYInversionOnUpdate?1-a.y:a.y)*l.height,null,be.POINTERMOVE,r,0)}}else this._lastControlOver[r]&&this._lastControlOver[r]._onPointerOut(this._lastControlOver[r],null,!0),delete this._lastControlOver[r]},!0),this._attachToOnPointerOut(i),this._attachToOnBlur(i))}moveFocusToControl(e){this.focusedControl=e,this._lastPickedControl=e,this._blockNextFocusCheck=!0}_manageFocus(){if(this._blockNextFocusCheck){this._blockNextFocusCheck=!1,this._lastPickedControl=this._focusedControl;return}if(this._focusedControl&&this._focusedControl!==this._lastPickedControl){if(this._lastPickedControl.isFocusInvisible)return;this.focusedControl=null}}_attachPickingToSceneRender(e,t,i){this._sceneRenderObserver=e.onBeforeRenderObservable.add(()=>{this.checkPointerEveryFrame&&(this._linkedControls.length>0||i)&&t()})}_attachToOnPointerOut(e){this._canvasPointerOutObserver=e.getEngine().onCanvasPointerOutObservable.add(t=>{this._lastControlOver[t.pointerId]&&this._lastControlOver[t.pointerId]._onPointerOut(this._lastControlOver[t.pointerId],null),delete this._lastControlOver[t.pointerId],this._lastControlDown[t.pointerId]&&this._lastControlDown[t.pointerId]!==this._capturingControl[t.pointerId]&&(this._lastControlDown[t.pointerId]._forcePointerUp(t.pointerId),delete this._lastControlDown[t.pointerId])})}_attachToOnBlur(e){this._canvasBlurObserver=e.getEngine().onCanvasBlurObservable.add(()=>{Object.entries(this._lastControlDown).forEach(([,t])=>{t._onCanvasBlur()}),this.focusedControl=null,this._lastControlDown={}})}serializeContent(){const e=this.getSize(),t={root:{},width:e.width,height:e.height};return this._rootContainer.serialize(t.root),t}parseSerializedObject(e,t){if(this._rootContainer=de.Parse(e.root,this),t){const i=e.width,r=e.height;typeof i=="number"&&typeof r=="number"&&i>=0&&r>=0?this.scaleTo(i,r):this.scaleTo(1920,1080)}}clone(e,t){const i=this.getScene();if(!i)return this;const r=this.getSize(),s=this.serializeContent();let a;return this._isFullscreen?a=Yi.CreateFullscreenUI(e??"Clone of "+this.name):t?a=Yi.CreateForMesh(t,r.width,r.height):a=new Yi(e??"Clone of "+this.name,r.width,r.height,i,!this.noMipmap,this.samplingMode),a.parseSerializedObject(s),a}static async ParseFromSnippetAsync(e,t,i){const r=i??Yi.CreateFullscreenUI("ADT from snippet");if(e==="_BLANK")return r;const s=await Yi._LoadURLContentAsync(Yi.SnippetUrl+"/"+e.replace(/#/g,"/"),!0);return r.parseSerializedObject(s,t),r}parseFromSnippetAsync(e,t){return Yi.ParseFromSnippetAsync(e,t,this)}static async ParseFromFileAsync(e,t,i){const r=i??Yi.CreateFullscreenUI("ADT from URL"),s=await Yi._LoadURLContentAsync(e);return r.parseSerializedObject(s,t),r}parseFromURLAsync(e,t){return Yi.ParseFromFileAsync(e,t,this)}static _LoadURLContentAsync(e,t=!1){return e===""?Promise.reject("No URL provided"):new Promise((i,r)=>{const s=new wi;s.addEventListener("readystatechange",()=>{if(s.readyState==4)if(s.status==200){let a;if(t){const o=JSON.parse(JSON.parse(s.responseText).jsonPayload);a=o.encodedGui?new TextDecoder("utf-8").decode(n1(o.encodedGui)):o.gui}else a=s.responseText;const l=JSON.parse(a);i(l)}else r("Unable to load")}),s.open("GET",e),s.send()})}static _Overlaps(e,t){return!(e.centerX>t.centerX+t.widthInPixels||e.centerX+e.widthInPixels<t.centerX||e.centerY+e.heightInPixels<t.centerY||e.centerY>t.centerY+t.heightInPixels)}static CreateForMesh(e,t=1024,i=1024,r=!0,s=!1,a,l=this._CreateMaterial){const o=$d(),c=new Yi(`AdvancedDynamicTexture for ${e.name} [${o}]`,t,i,e.getScene(),!0,re.TRILINEAR_SAMPLINGMODE,a);return l(e,o,c,s),c.attachToMesh(e,r),c}static _CreateMaterial(e,t,i,r){const s=Bn("BABYLON.StandardMaterial");if(!s)throw"StandardMaterial needs to be imported before as it contains a side-effect required by your code.";const a=new s(`AdvancedDynamicTextureMaterial for ${e.name} [${t}]`,e.getScene());a.backFaceCulling=!1,a.diffuseColor=Pe.Black(),a.specularColor=Pe.Black(),r?(a.diffuseTexture=i,a.emissiveTexture=i,i.hasAlpha=!0):(a.emissiveTexture=i,a.opacityTexture=i),e.material=a}static CreateForMeshTexture(e,t=1024,i=1024,r=!0,s){const a=new Yi(e.name+" AdvancedDynamicTexture",t,i,e.getScene(),!0,re.TRILINEAR_SAMPLINGMODE,s);return a.attachToMesh(e,r),a}static CreateFullscreenUI(e,t=!0,i=null,r=re.BILINEAR_SAMPLINGMODE,s=!1){const a=new Yi(e,0,0,i,!1,r),l=a.getScene(),o=new Qz(e+"_layer",null,l,!t);if(o.texture=a,a._layerToDispose=o,a._isFullscreen=!0,s&&l){const c=1/l.getEngine().getHardwareScalingLevel();a._rootContainer.scaleX=c,a._rootContainer.scaleY=c}return a.attach(),a}scale(e){super.scale(e),this.markAsDirty()}scaleTo(e,t){super.scaleTo(e,t),this.markAsDirty()}_checkGuiIsReady(){this.guiIsReady()&&(this.onGuiReadyObservable.notifyObservers(this),this.onGuiReadyObservable.clear())}guiIsReady(){return this._rootContainer.isReady()}}Yi.SnippetUrl=B.SnippetUrl;Yi.AllowGPUOptimizations=!0;var ho;(function(n){n[n.Clip=0]="Clip",n[n.WordWrap=1]="WordWrap",n[n.Ellipsis=2]="Ellipsis",n[n.WordWrapEllipsis=3]="WordWrapEllipsis"})(ho||(ho={}));class Nr extends de{get lines(){return this._lines}get resizeToFit(){return this._resizeToFit}set resizeToFit(e){this._resizeToFit!==e&&(this._resizeToFit=e,this._resizeToFit&&(this._width.ignoreAdaptiveScaling=!0,this._height.ignoreAdaptiveScaling=!0),this._markAsDirty())}get textWrapping(){return this._textWrapping}set textWrapping(e){this._textWrapping!==e&&(this._textWrapping=+e,this._markAsDirty())}get text(){return this._text}set text(e){this._text!==e&&(this._text=e+"",this._markAsDirty(),this.onTextChangedObservable.notifyObservers(this))}get textHorizontalAlignment(){return this._textHorizontalAlignment}set textHorizontalAlignment(e){this._textHorizontalAlignment!==e&&(this._textHorizontalAlignment=e,this._markAsDirty())}get textVerticalAlignment(){return this._textVerticalAlignment}set textVerticalAlignment(e){this._textVerticalAlignment!==e&&(this._textVerticalAlignment=e,this._markAsDirty())}set lineSpacing(e){this._lineSpacing.fromString(e)&&this._markAsDirty()}get lineSpacing(){return this._lineSpacing.toString(this._host)}get outlineWidth(){return this._outlineWidth}set outlineWidth(e){this._outlineWidth!==e&&(this._outlineWidth=e,this._markAsDirty())}get underline(){return this._underline}set underline(e){this._underline!==e&&(this._underline=e,this._markAsDirty())}get lineThrough(){return this._lineThrough}set lineThrough(e){this._lineThrough!==e&&(this._lineThrough=e,this._markAsDirty())}get applyOutlineToUnderline(){return this._applyOutlineToUnderline}set applyOutlineToUnderline(e){this._applyOutlineToUnderline!==e&&(this._applyOutlineToUnderline=e,this._markAsDirty())}get outlineColor(){return this._outlineColor}set outlineColor(e){this._outlineColor!==e&&(this._outlineColor=e,this._markAsDirty())}get wordDivider(){return this._wordDivider}set wordDivider(e){this._wordDivider!==e&&(this._wordDivider=e,this._markAsDirty())}get forceResizeWidth(){return this._forceResizeWidth}set forceResizeWidth(e){this._forceResizeWidth!==e&&(this._forceResizeWidth=e,this._markAsDirty())}constructor(e,t=""){super(e),this.name=e,this._text="",this._textWrapping=ho.Clip,this._textHorizontalAlignment=de.HORIZONTAL_ALIGNMENT_CENTER,this._textVerticalAlignment=de.VERTICAL_ALIGNMENT_CENTER,this._resizeToFit=!1,this._lineSpacing=new xt(0),this._outlineWidth=0,this._outlineColor="white",this._underline=!1,this._lineThrough=!1,this._wordDivider=" ",this._forceResizeWidth=!1,this._applyOutlineToUnderline=!1,this.onTextChangedObservable=new Y,this.onLinesReadyObservable=new Y,this._linesTemp=[],this.text=t}_getTypeName(){return"TextBlock"}_processMeasures(e,t){(!this._fontOffset||this.isDirty)&&(this._fontOffset=de._GetFontOffset(t.font)),super._processMeasures(e,t),this._lines=this._breakLines(this._currentMeasure.width,this._currentMeasure.height,t),this.onLinesReadyObservable.notifyObservers(this);let i=0;for(let r=0;r<this._lines.length;r++){const s=this._lines[r];s.width>i&&(i=s.width)}if(this._resizeToFit){if(this._textWrapping===ho.Clip||this._forceResizeWidth){const s=Math.ceil(this._paddingLeftInPixels)+Math.ceil(this._paddingRightInPixels)+Math.ceil(i);s!==this._width.getValueInPixel(this._host,this._tempParentMeasure.width)&&(this._width.updateInPlace(s,xt.UNITMODE_PIXEL),this._rebuildLayout=!0)}let r=this._paddingTopInPixels+this._paddingBottomInPixels+this._fontOffset.height*this._lines.length|0;if(this._lines.length>0&&this._lineSpacing.internalValue!==0){let s=0;this._lineSpacing.isPixel?s=this._lineSpacing.getValue(this._host):s=this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),r+=(this._lines.length-1)*s}r!==this._height.internalValue&&(this._height.updateInPlace(r,xt.UNITMODE_PIXEL),this._rebuildLayout=!0)}}_drawText(e,t,i,r){const s=this._currentMeasure.width;let a=0;switch(this._textHorizontalAlignment){case de.HORIZONTAL_ALIGNMENT_LEFT:a=0;break;case de.HORIZONTAL_ALIGNMENT_RIGHT:a=s-t;break;case de.HORIZONTAL_ALIGNMENT_CENTER:a=(s-t)/2;break}(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(r.shadowColor=this.shadowColor,r.shadowBlur=this.shadowBlur,r.shadowOffsetX=this.shadowOffsetX,r.shadowOffsetY=this.shadowOffsetY),this.outlineWidth&&r.strokeText(e,this._currentMeasure.left+a,i),r.fillText(e,this._currentMeasure.left+a,i),this._underline&&this._drawLine(this._currentMeasure.left+a,i+3,this._currentMeasure.left+a+t,i+3,r),this._lineThrough&&this._drawLine(this._currentMeasure.left+a,i-this.fontSizeInPixels/3,this._currentMeasure.left+a+t,i-this.fontSizeInPixels/3,r)}_drawLine(e,t,i,r,s){if(s.beginPath(),s.lineWidth=Math.round(this.fontSizeInPixels*.05),s.moveTo(e,t),s.lineTo(i,r),this.outlineWidth&&this.applyOutlineToUnderline)s.stroke(),s.fill();else{const a=s.strokeStyle;s.strokeStyle=s.fillStyle,s.stroke(),s.strokeStyle=a}s.closePath()}_draw(e){e.save(),this._applyStates(e),this._renderLines(e),e.restore()}_applyStates(e){super._applyStates(e),this.outlineWidth&&(e.lineWidth=this.outlineWidth,e.strokeStyle=this.outlineColor,e.lineJoin="miter",e.miterLimit=2)}_breakLines(e,t,i){this._linesTemp.length=0;const r=this.text.split(`
`);if(this._textWrapping===ho.Ellipsis)for(const s of r)this._linesTemp.push(this._parseLineEllipsis(s,e,i));else if(this._textWrapping===ho.WordWrap)for(const s of r)this._linesTemp.push(...this._parseLineWordWrap(s,e,i));else if(this._textWrapping===ho.WordWrapEllipsis)for(const s of r)this._linesTemp.push(...this._parseLineWordWrapEllipsis(s,e,t,i));else for(const s of r)this._linesTemp.push(this._parseLine(s,i));return this._linesTemp}_parseLine(e="",t){return{text:e,width:this._getTextMetricsWidth(t.measureText(e))}}_getCharsToRemove(e,t,i){const r=e>t?e-t:0,s=e/i;return Math.max(Math.floor(r/s),1)}_parseLineEllipsis(e="",t,i){let r=this._getTextMetricsWidth(i.measureText(e)),s=this._getCharsToRemove(r,t,e.length);const a=Array.from&&Array.from(e);if(a)for(;a.length&&r>t;)a.splice(a.length-s,s),e=`${a.join("")}`,r=this._getTextMetricsWidth(i.measureText(e)),s=this._getCharsToRemove(r,t,e.length);else{for(;e.length>2&&r>t;)e=e.slice(0,-s),r=this._getTextMetricsWidth(i.measureText(e+"")),s=this._getCharsToRemove(r,t,e.length);e+=""}return{text:e,width:r}}_getTextMetricsWidth(e){return e.actualBoundingBoxLeft!==void 0?Math.abs(e.actualBoundingBoxLeft)+Math.abs(e.actualBoundingBoxRight):e.width}_parseLineWordWrap(e="",t,i){const r=[],s=this.wordSplittingFunction?this.wordSplittingFunction(e):e.split(this._wordDivider);let a=this._getTextMetricsWidth(i.measureText(e));for(let l=0;l<s.length;l++){const o=l>0?e+this._wordDivider+s[l]:s[0],c=this._getTextMetricsWidth(i.measureText(o));c>t&&l>0?(r.push({text:e,width:a}),e=s[l],a=this._getTextMetricsWidth(i.measureText(e))):(a=c,e=o)}return r.push({text:e,width:a}),r}_parseLineWordWrapEllipsis(e="",t,i,r){const s=this._parseLineWordWrap(e,t,r);for(let a=1;a<=s.length;a++)if(this._computeHeightForLinesOf(a)>i&&a>1){const o=s[a-2],c=s[a-1];s[a-2]=this._parseLineEllipsis(o.text+this._wordDivider+c.text,t,r);const u=s.length-a+1;for(let h=0;h<u;h++)s.pop();return s}return s}_renderLines(e){if(!this._fontOffset||!this._lines)return;const t=this._currentMeasure.height;let i=0;switch(this._textVerticalAlignment){case de.VERTICAL_ALIGNMENT_TOP:i=this._fontOffset.ascent;break;case de.VERTICAL_ALIGNMENT_BOTTOM:i=t-this._fontOffset.height*(this._lines.length-1)-this._fontOffset.descent;break;case de.VERTICAL_ALIGNMENT_CENTER:i=this._fontOffset.ascent+(t-this._fontOffset.height*this._lines.length)/2;break}i+=this._currentMeasure.top;for(let r=0;r<this._lines.length;r++){const s=this._lines[r];r!==0&&this._lineSpacing.internalValue!==0&&(this._lineSpacing.isPixel?i+=this._lineSpacing.getValue(this._host):i=i+this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)),this._drawText(s.text,s.width,i,e),i+=this._fontOffset.height}}_computeHeightForLinesOf(e){let t=this._paddingTopInPixels+this._paddingBottomInPixels+this._fontOffset.height*e;if(e>0&&this._lineSpacing.internalValue!==0){let i=0;this._lineSpacing.isPixel?i=this._lineSpacing.getValue(this._host):i=this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),t+=(e-1)*i}return t}isDimensionFullyDefined(e){return this.resizeToFit?!0:super.isDimensionFullyDefined(e)}computeExpectedHeight(){var e;if(this.text&&this.widthInPixels){const t=(e=He.LastCreatedEngine)==null?void 0:e.createCanvas(0,0).getContext("2d");if(t){this._applyStates(t),this._fontOffset||(this._fontOffset=de._GetFontOffset(t.font));const i=this._lines?this._lines:this._breakLines(this.widthInPixels-this._paddingLeftInPixels-this._paddingRightInPixels,this.heightInPixels-this._paddingTopInPixels-this._paddingBottomInPixels,t);return this._computeHeightForLinesOf(i.length)}}return 0}dispose(){super.dispose(),this.onTextChangedObservable.clear()}}R([I()],Nr.prototype,"resizeToFit",null);R([I()],Nr.prototype,"textWrapping",null);R([I()],Nr.prototype,"text",null);R([I()],Nr.prototype,"textHorizontalAlignment",null);R([I()],Nr.prototype,"textVerticalAlignment",null);R([I()],Nr.prototype,"lineSpacing",null);R([I()],Nr.prototype,"outlineWidth",null);R([I()],Nr.prototype,"underline",null);R([I()],Nr.prototype,"lineThrough",null);R([I()],Nr.prototype,"applyOutlineToUnderline",null);R([I()],Nr.prototype,"outlineColor",null);R([I()],Nr.prototype,"wordDivider",null);R([I()],Nr.prototype,"forceResizeWidth",null);Ji("BABYLON.GUI.TextBlock",Nr);we.prototype.updateRawTexture=function(n,e,t,i,r=null,s=0,a=!1){if(!n)return;const l=this._getRGBABufferInternalSizedFormat(s,t,a),o=this._getInternalFormat(t),c=this._getWebGLTextureType(s);this._bindTextureDirectly(this._gl.TEXTURE_2D,n,!0),this._unpackFlipY(i===void 0?!0:!!i),this._doNotHandleContextLost||(n._bufferView=e,n.format=t,n.type=s,n.invertY=i,n._compression=r),n.width%4!==0&&this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,1),r&&e?this._gl.compressedTexImage2D(this._gl.TEXTURE_2D,0,this.getCaps().s3tc[r],n.width,n.height,0,e):this._gl.texImage2D(this._gl.TEXTURE_2D,0,l,n.width,n.height,0,o,c,e),n.generateMipMaps&&this._gl.generateMipmap(this._gl.TEXTURE_2D),this._bindTextureDirectly(this._gl.TEXTURE_2D,null),n.isReady=!0};we.prototype.createRawTexture=function(n,e,t,i,r,s,a,l=null,o=0,c=0,u=!1){const h=new Qr(this,Xt.Raw);h.baseWidth=e,h.baseHeight=t,h.width=e,h.height=t,h.format=i,h.generateMipMaps=r,h.samplingMode=a,h.invertY=s,h._compression=l,h.type=o,h._useSRGBBuffer=this._getUseSRGBBuffer(u,!r),this._doNotHandleContextLost||(h._bufferView=n),this.updateRawTexture(h,n,i,s,l,o,h._useSRGBBuffer),this._bindTextureDirectly(this._gl.TEXTURE_2D,h,!0);const d=this._getSamplingParameters(a,r);return this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,d.mag),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,d.min),r&&this._gl.generateMipmap(this._gl.TEXTURE_2D),this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._internalTexturesCache.push(h),h};we.prototype.createRawCubeTexture=function(n,e,t,i,r,s,a,l=null){const o=this._gl,c=new Qr(this,Xt.CubeRaw);c.isCube=!0,c.format=t,c.type=i,this._doNotHandleContextLost||(c._bufferViewArray=n);const u=this._getWebGLTextureType(i);let h=this._getInternalFormat(t);h===o.RGB&&(h=o.RGBA),u===o.FLOAT&&!this._caps.textureFloatLinearFiltering?(r=!1,a=1,ee.Warn("Float texture filtering is not supported. Mipmap generation and sampling mode are forced to false and TEXTURE_NEAREST_SAMPLINGMODE, respectively.")):u===this._gl.HALF_FLOAT_OES&&!this._caps.textureHalfFloatLinearFiltering?(r=!1,a=1,ee.Warn("Half float texture filtering is not supported. Mipmap generation and sampling mode are forced to false and TEXTURE_NEAREST_SAMPLINGMODE, respectively.")):u===o.FLOAT&&!this._caps.textureFloatRender?(r=!1,ee.Warn("Render to float textures is not supported. Mipmap generation forced to false.")):u===o.HALF_FLOAT&&!this._caps.colorBufferFloat&&(r=!1,ee.Warn("Render to half float textures is not supported. Mipmap generation forced to false."));const d=e,f=d;if(c.width=d,c.height=f,c.invertY=s,c._compression=l,!this.needPOTTextures||au(c.width)&&au(c.height)||(r=!1),n)this.updateRawCubeTexture(c,n,t,i,s,l);else{const v=this._getRGBABufferInternalSizedFormat(i),E=0;this._bindTextureDirectly(o.TEXTURE_CUBE_MAP,c,!0);for(let g=0;g<6;g++)l?o.compressedTexImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+g,E,this.getCaps().s3tc[l],c.width,c.height,0,void 0):o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+g,E,v,c.width,c.height,0,h,u,null);this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null)}this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,c,!0),n&&r&&this._gl.generateMipmap(this._gl.TEXTURE_CUBE_MAP);const p=this._getSamplingParameters(a,r);return o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MAG_FILTER,p.mag),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MIN_FILTER,p.min),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),this._bindTextureDirectly(o.TEXTURE_CUBE_MAP,null),c.generateMipMaps=r,c.samplingMode=a,c.isReady=!0,c};we.prototype.updateRawCubeTexture=function(n,e,t,i,r,s=null,a=0){n._bufferViewArray=e,n.format=t,n.type=i,n.invertY=r,n._compression=s;const l=this._gl,o=this._getWebGLTextureType(i);let c=this._getInternalFormat(t);const u=this._getRGBABufferInternalSizedFormat(i);let h=!1;c===l.RGB&&(c=l.RGBA,h=!0),this._bindTextureDirectly(l.TEXTURE_CUBE_MAP,n,!0),this._unpackFlipY(r===void 0?!0:!!r),n.width%4!==0&&l.pixelStorei(l.UNPACK_ALIGNMENT,1);for(let f=0;f<6;f++){let _=e[f];s?l.compressedTexImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+f,a,this.getCaps().s3tc[s],n.width,n.height,0,_):(h&&(_=jA(_,n.width,n.height,i)),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+f,a,u,n.width,n.height,0,c,o,_))}(!this.needPOTTextures||au(n.width)&&au(n.height))&&n.generateMipMaps&&a===0&&this._gl.generateMipmap(this._gl.TEXTURE_CUBE_MAP),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),n.isReady=!0};we.prototype.createRawCubeTextureFromUrl=function(n,e,t,i,r,s,a,l,o=null,c=null,u=3,h=!1){const d=this._gl,f=this.createRawCubeTexture(null,t,i,r,!s,h,u,null);e==null||e.addPendingData(f),f.url=n,f.isReady=!1,this._internalTexturesCache.push(f);const _=(v,E)=>{e==null||e.removePendingData(f),c&&v&&c(v.status+" "+v.statusText,E)},p=v=>{const E=f.width,g=a(v);if(g){if(l){const m=this._getWebGLTextureType(r);let y=this._getInternalFormat(i);const T=this._getRGBABufferInternalSizedFormat(r);let b=!1;y===d.RGB&&(y=d.RGBA,b=!0),this._bindTextureDirectly(d.TEXTURE_CUBE_MAP,f,!0),this._unpackFlipY(!1);const C=l(g);for(let M=0;M<C.length;M++){const F=E>>M;for(let P=0;P<6;P++){let U=C[M][P];b&&(U=jA(U,F,F,r)),d.texImage2D(P,M,T,F,F,0,y,m,U)}}this._bindTextureDirectly(d.TEXTURE_CUBE_MAP,null)}else this.updateRawCubeTexture(f,g,i,r,h);f.isReady=!0,e==null||e.removePendingData(f),f.onLoadedObservable.notifyObservers(f),f.onLoadedObservable.clear(),o&&o()}};return this._loadFile(n,v=>{p(v)},void 0,e==null?void 0:e.offlineProvider,!0,_),f};function jA(n,e,t,i){let r,s=1;i===1?r=new Float32Array(e*t*4):i===2?(r=new Uint16Array(e*t*4),s=15360):i===7?r=new Uint32Array(e*t*4):r=new Uint8Array(e*t*4);for(let a=0;a<e;a++)for(let l=0;l<t;l++){const o=(l*e+a)*3,c=(l*e+a)*4;r[c+0]=n[o+0],r[c+1]=n[o+1],r[c+2]=n[o+2],r[c+3]=s}return r}function XA(n){return function(e,t,i,r,s,a,l,o,c=null,u=0){const h=n?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D_ARRAY,d=n?Xt.Raw3D:Xt.Raw2DArray,f=new Qr(this,d);f.baseWidth=t,f.baseHeight=i,f.baseDepth=r,f.width=t,f.height=i,f.depth=r,f.format=s,f.type=u,f.generateMipMaps=a,f.samplingMode=o,n?f.is3D=!0:f.is2DArray=!0,this._doNotHandleContextLost||(f._bufferView=e),n?this.updateRawTexture3D(f,e,s,l,c,u):this.updateRawTexture2DArray(f,e,s,l,c,u),this._bindTextureDirectly(h,f,!0);const _=this._getSamplingParameters(o,a);return this._gl.texParameteri(h,this._gl.TEXTURE_MAG_FILTER,_.mag),this._gl.texParameteri(h,this._gl.TEXTURE_MIN_FILTER,_.min),a&&this._gl.generateMipmap(h),this._bindTextureDirectly(h,null),this._internalTexturesCache.push(f),f}}we.prototype.createRawTexture2DArray=XA(!1);we.prototype.createRawTexture3D=XA(!0);function YA(n){return function(e,t,i,r,s=null,a=0){const l=n?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D_ARRAY,o=this._getWebGLTextureType(a),c=this._getInternalFormat(i),u=this._getRGBABufferInternalSizedFormat(a,i);this._bindTextureDirectly(l,e,!0),this._unpackFlipY(r===void 0?!0:!!r),this._doNotHandleContextLost||(e._bufferView=t,e.format=i,e.invertY=r,e._compression=s),e.width%4!==0&&this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,1),s&&t?this._gl.compressedTexImage3D(l,0,this.getCaps().s3tc[s],e.width,e.height,e.depth,0,t):this._gl.texImage3D(l,0,u,e.width,e.height,e.depth,0,c,o,t),e.generateMipMaps&&this._gl.generateMipmap(l),this._bindTextureDirectly(l,null),e.isReady=!0}}we.prototype.updateRawTexture2DArray=YA(!1);we.prototype.updateRawTexture3D=YA(!0);class xn extends re{constructor(e,t,i,r,s,a=!0,l=!1,o=3,c=0,u,h){super(null,s,!a,l,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,u),this.format=r,this._engine&&(!this._engine._caps.textureFloatLinearFiltering&&c===1&&(o=1),!this._engine._caps.textureHalfFloatLinearFiltering&&c===2&&(o=1),this._texture=this._engine.createRawTexture(e,t,i,r,a,l,o,null,c,u??0,h??!1),this.wrapU=re.CLAMP_ADDRESSMODE,this.wrapV=re.CLAMP_ADDRESSMODE)}update(e){this._getEngine().updateRawTexture(this._texture,e,this._texture.format,this._texture.invertY,null,this._texture.type,this._texture._useSRGBBuffer)}static CreateLuminanceTexture(e,t,i,r,s=!0,a=!1,l=3){return new xn(e,t,i,1,r,s,a,l)}static CreateLuminanceAlphaTexture(e,t,i,r,s=!0,a=!1,l=3){return new xn(e,t,i,2,r,s,a,l)}static CreateAlphaTexture(e,t,i,r,s=!0,a=!1,l=3){return new xn(e,t,i,0,r,s,a,l)}static CreateRGBTexture(e,t,i,r,s=!0,a=!1,l=3,o=0,c=0,u=!1){return new xn(e,t,i,4,r,s,a,l,o,c,u)}static CreateRGBATexture(e,t,i,r,s=!0,a=!1,l=3,o=0,c=0,u=!1){return new xn(e,t,i,5,r,s,a,l,o,c,u)}static CreateRGBAStorageTexture(e,t,i,r,s=!0,a=!1,l=3,o=0,c=!1){return new xn(e,t,i,5,r,s,a,l,o,1,c)}static CreateRTexture(e,t,i,r,s=!0,a=!1,l=re.TRILINEAR_SAMPLINGMODE,o=1){return new xn(e,t,i,6,r,s,a,l,o)}static CreateRStorageTexture(e,t,i,r,s=!0,a=!1,l=re.TRILINEAR_SAMPLINGMODE,o=1){return new xn(e,t,i,6,r,s,a,l,o,1)}}class KA{static _findTexturePack(e,t){const i=e.getTexturePack(t);if(!i)throw new Error(`Cannot find texture pack with id ${t}`);const r=ls.get().assets[Vs.Texture].get(i);if(!r)throw new Error(`Cannot find texture pack ${i}`);return r}static _createTexturedMaterial(e,t,i,r){let s,a;try{a=this._findTexturePack(e,t.material.texturePackId);const u=t.material.texturePackId-a.pageOffset,h=u>0?u:u+1,d=t.material.textureId+256*u-h*a.pageSize;s=a.getTexture(d)}catch(u){console.warn(e,t,u);const h=new le("fallbackMaterial",i);return h.emissiveColor=Pe.Red(),h}const l=`${a.name}/${t.material.textureId}`;let o=r.get(l);o||(o=xn.CreateRGBATexture(s.pixels,s.info.width,s.info.height,i,!0,!1,re.NEAREST_SAMPLINGMODE),r.set(l,o));const c=new le("texturedMaterial",i);return c.diffuseTexture=o,c.emissiveColor=Pe.White(),s.info.hasFlag(yf.Alpha)&&(c.diffuseTexture.hasAlpha=!0,c.useAlphaFromDiffuseTexture=!0),c}static _createUVs(e){const t=new bA(0,1,1,0),i=Array(8);return e.material.hasMaterialFlag(ll.InvertX)?(i[0]=t.right,i[2]=t.left,i[4]=t.left,i[6]=t.right):(i[0]=t.left,i[2]=t.right,i[4]=t.right,i[6]=t.left),e.material.hasMaterialFlag(ll.InvertY)?(i[1]=t.bottom,i[3]=t.bottom,i[5]=t.top,i[7]=t.top):(i[1]=t.top,i[3]=t.top,i[5]=t.bottom,i[7]=t.bottom),i}static _createColorMaterial(e,t){var r;const i=new le("colorMaterial",t);return i.diffuseColor=Pe.FromArray(((r=e.material.color)==null?void 0:r.toArray())||[]),i.emissiveColor=i.diffuseColor,i}static CreateMesh(e,t){const i=[],r=new Map;for(const a of e.faces){if(!a.material.hasMaterialFlag(ll.Enabled))continue;const l=[e.vertices[a.v1],e.vertices[a.v2],e.vertices[a.v3],e.vertices[a.v4]].flatMap(h=>[-h.x,h.y,h.z]),o=new Ue;o.positions=l,o.indices=[0,1,2,0,2,3],e.depth&&(o.indices=[0,2,1,0,3,2]),o.normals=[...a.normal.toArray(),...a.normal.toArray(),...a.normal.toArray(),...a.normal.toArray()];let c;a.material.hasMaterialFlag(ll.Texture)?(c=this._createTexturedMaterial(e,a,t,r),o.uvs=this._createUVs(a)):a.material.hasMaterialFlag(ll.Color)?(c=this._createColorMaterial(a,t),o.uvs=new Array(8)):(c=new le("fallbackMaterial",t),c.emissiveColor=Pe.Red()),a.material.hasRenderFlag(CA.Transparent)&&(c.alpha=.5),c.disableLighting=!0,c.backFaceCulling=!1;const u=new Ae(a.id.toString());if(u.material=c,!u){console.warn(`Face ${a.id}: Mesh was not created!`);continue}o.applyToMesh(u),i.push(u)}const s=Ae.MergeMeshes(i,!0,void 0,void 0,void 0,!0);if(!s)throw new Error("Final mesh could not be created");return s.id=e.id.toString(),s.name=`Model ${e.id}`,e.depth&15?s.renderingGroupId=0:s.renderingGroupId=1,s}}const Jz={showFPSCounter:!1,controllableCamera:!0,highlightHoveredFace:!1,logClickedFace:!1},Kd=class Kd{constructor(e,t=Jz){ge(this,"engine");ge(this,"scene");ge(this,"camera");ge(this,"onFaceClicked");ge(this,"_model");ge(this,"_modelMesh");ge(this,"_highlightedSubMesh");ge(this,"_fpsCounterIntervalId");ge(this,"_options");this._options=t,this.engine=e,this.scene=new Pt(e),this.scene.clearColor=new et(.12,.12,.12,1),this._options.highlightHoveredFace&&(this.scene.onPointerMove=this._onPointerMove.bind(this)),this._options.logClickedFace&&(this.scene.onPointerUp=this._onPointerUp.bind(this)),this.camera=new Gt(Kd.cameraName,Math.PI/1.2,Math.PI/2.5,5,new A(0,0,0),this.scene),this.camera.minZ=0,this.camera.lowerRadiusLimit=.15,this._options.controllableCamera&&(this.camera.wheelPrecision=100,this.camera.attachControl(void 0,!1),this.scene.attachControl(!0,!0,!0)),this._options.showFPSCounter&&this._setupFPSCounter()}set backfaceCulling(e){if(this._modelMesh)for(const t of this._modelMesh.subMeshes){const i=t.getMaterial();i&&(i.backFaceCulling=e)}}destroy(){this._fpsCounterIntervalId!==void 0&&clearInterval(this._fpsCounterIntervalId),this.scene.dispose()}_setupFPSCounter(){const e=Yi.CreateFullscreenUI("UI"),t=new Nr;t.resizeToFit=!0,t.color="#888",t.fontSize=16,t.horizontalAlignment=de.HORIZONTAL_ALIGNMENT_RIGHT,t.verticalAlignment=de.VERTICAL_ALIGNMENT_TOP,e.addControl(t),this._fpsCounterIntervalId=setInterval(()=>{t.text=this.engine.getFps().toFixed(0)},500)}_toggleFaceHighlight(e,t){var a;const i=(a=this._modelMesh)==null?void 0:a.subMeshes[e];if(!i)return;const r=i.getMaterial(),s=r.emissiveColor;return r.emissiveColor=t,s}_onPointerUp(e,t){var r,s;if(!this._model||!(t!=null&&t.hit)||t.subMeshId===-1)return;const i=(r=this._model)==null?void 0:r.faces[t.subMeshId];console.log(i),i&&((s=this.onFaceClicked)==null||s.call(this,i))}_onPointerMove(e,t){var r;if(!t.hit){this._highlightedSubMesh&&(this._toggleFaceHighlight(this._highlightedSubMesh.subMeshId,this._highlightedSubMesh.originalColor),this._highlightedSubMesh=void 0);return}if(t.subMeshId===((r=this._highlightedSubMesh)==null?void 0:r.subMeshId))return;this._highlightedSubMesh&&this._toggleFaceHighlight(this._highlightedSubMesh.subMeshId,this._highlightedSubMesh.originalColor);const i=this._toggleFaceHighlight(t.subMeshId,Pe.Red());this._highlightedSubMesh={subMeshId:t.subMeshId,originalColor:i||Pe.Black()}}setModel(e){this._model=e,this._modelMesh=KA.CreateMesh(e,this.scene),this._options.highlightHoveredFace&&(this._modelMesh.enablePointerMoveEvents=!0),this.center()}center(){this._modelMesh&&(this.camera.focusOn([this._modelMesh],!0),this.camera.zoomOn([this._modelMesh],!0))}render(){this.scene.render()}};ge(Kd,"cameraName","mainCamera");let Vd=Kd;class nn{constructor(){this.keysUp=[38],this.keysUpward=[33],this.keysDown=[40],this.keysDownward=[34],this.keysLeft=[37],this.keysRight=[39],this.rotationSpeed=.5,this.keysRotateLeft=[],this.keysRotateRight=[],this.keysRotateUp=[],this.keysRotateDown=[],this._keys=new Array}attachControl(e){e=X.BackCompatCameraNoPreventDefault(arguments),!this._onCanvasBlurObserver&&(this._scene=this.camera.getScene(),this._engine=this._scene.getEngine(),this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add(()=>{this._keys.length=0}),this._onKeyboardObserver=this._scene.onKeyboardObservable.add(t=>{const i=t.event;if(!i.metaKey){if(t.type===So.KEYDOWN)(this.keysUp.indexOf(i.keyCode)!==-1||this.keysDown.indexOf(i.keyCode)!==-1||this.keysLeft.indexOf(i.keyCode)!==-1||this.keysRight.indexOf(i.keyCode)!==-1||this.keysUpward.indexOf(i.keyCode)!==-1||this.keysDownward.indexOf(i.keyCode)!==-1||this.keysRotateLeft.indexOf(i.keyCode)!==-1||this.keysRotateRight.indexOf(i.keyCode)!==-1||this.keysRotateUp.indexOf(i.keyCode)!==-1||this.keysRotateDown.indexOf(i.keyCode)!==-1)&&(this._keys.indexOf(i.keyCode)===-1&&this._keys.push(i.keyCode),e||i.preventDefault());else if(this.keysUp.indexOf(i.keyCode)!==-1||this.keysDown.indexOf(i.keyCode)!==-1||this.keysLeft.indexOf(i.keyCode)!==-1||this.keysRight.indexOf(i.keyCode)!==-1||this.keysUpward.indexOf(i.keyCode)!==-1||this.keysDownward.indexOf(i.keyCode)!==-1||this.keysRotateLeft.indexOf(i.keyCode)!==-1||this.keysRotateRight.indexOf(i.keyCode)!==-1||this.keysRotateUp.indexOf(i.keyCode)!==-1||this.keysRotateDown.indexOf(i.keyCode)!==-1){const r=this._keys.indexOf(i.keyCode);r>=0&&this._keys.splice(r,1),e||i.preventDefault()}}}))}detachControl(){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onKeyboardObserver=null,this._onCanvasBlurObserver=null),this._keys.length=0}checkInputs(){if(this._onKeyboardObserver){const e=this.camera;for(let t=0;t<this._keys.length;t++){const i=this._keys[t],r=e._computeLocalCameraSpeed();this.keysLeft.indexOf(i)!==-1?e._localDirection.copyFromFloats(-r,0,0):this.keysUp.indexOf(i)!==-1?e._localDirection.copyFromFloats(0,0,r):this.keysRight.indexOf(i)!==-1?e._localDirection.copyFromFloats(r,0,0):this.keysDown.indexOf(i)!==-1?e._localDirection.copyFromFloats(0,0,-r):this.keysUpward.indexOf(i)!==-1?e._localDirection.copyFromFloats(0,r,0):this.keysDownward.indexOf(i)!==-1?e._localDirection.copyFromFloats(0,-r,0):this.keysRotateLeft.indexOf(i)!==-1?(e._localDirection.copyFromFloats(0,0,0),e.cameraRotation.y-=this._getLocalRotation()):this.keysRotateRight.indexOf(i)!==-1?(e._localDirection.copyFromFloats(0,0,0),e.cameraRotation.y+=this._getLocalRotation()):this.keysRotateUp.indexOf(i)!==-1?(e._localDirection.copyFromFloats(0,0,0),e.cameraRotation.x-=this._getLocalRotation()):this.keysRotateDown.indexOf(i)!==-1&&(e._localDirection.copyFromFloats(0,0,0),e.cameraRotation.x+=this._getLocalRotation()),e.getScene().useRightHandedSystem&&(e._localDirection.z*=-1),e.getViewMatrix().invertToRef(e._cameraTransformMatrix),A.TransformNormalToRef(e._localDirection,e._cameraTransformMatrix,e._transformedDirection),e.cameraDirection.addInPlace(e._transformedDirection)}}}getClassName(){return"FreeCameraKeyboardMoveInput"}_onLostFocus(){this._keys.length=0}getSimpleName(){return"keyboard"}_getLocalRotation(){const e=this.camera._calculateHandednessMultiplier();return this.rotationSpeed*this._engine.getDeltaTime()/1e3*e}}R([I()],nn.prototype,"keysUp",void 0);R([I()],nn.prototype,"keysUpward",void 0);R([I()],nn.prototype,"keysDown",void 0);R([I()],nn.prototype,"keysDownward",void 0);R([I()],nn.prototype,"keysLeft",void 0);R([I()],nn.prototype,"keysRight",void 0);R([I()],nn.prototype,"rotationSpeed",void 0);R([I()],nn.prototype,"keysRotateLeft",void 0);R([I()],nn.prototype,"keysRotateRight",void 0);R([I()],nn.prototype,"keysRotateUp",void 0);R([I()],nn.prototype,"keysRotateDown",void 0);zn.FreeCameraKeyboardMoveInput=nn;class Rf{constructor(e=!0){this.touchEnabled=e,this.buttons=[0,1,2],this.angularSensibility=2e3,this._previousPosition=null,this.onPointerMovedObservable=new Y,this._allowCameraRotation=!0,this._currentActiveButton=-1,this._activePointerId=-1}attachControl(e){e=X.BackCompatCameraNoPreventDefault(arguments);const t=this.camera.getEngine(),i=t.getInputElement();this._pointerInput||(this._pointerInput=r=>{const s=r.event,a=s.pointerType==="touch";if(!this.touchEnabled&&a||r.type!==be.POINTERMOVE&&this.buttons.indexOf(s.button)===-1)return;const l=s.target;if(r.type===be.POINTERDOWN){if(a&&this._activePointerId!==-1||!a&&this._currentActiveButton!==-1)return;this._activePointerId=s.pointerId;try{l==null||l.setPointerCapture(s.pointerId)}catch{}this._currentActiveButton===-1&&(this._currentActiveButton=s.button),this._previousPosition={x:s.clientX,y:s.clientY},e||(s.preventDefault(),i&&i.focus()),t.isPointerLock&&this._onMouseMove&&this._onMouseMove(r.event)}else if(r.type===be.POINTERUP){if(a&&this._activePointerId!==s.pointerId||!a&&this._currentActiveButton!==s.button)return;try{l==null||l.releasePointerCapture(s.pointerId)}catch{}this._currentActiveButton=-1,this._previousPosition=null,e||s.preventDefault(),this._activePointerId=-1}else if(r.type===be.POINTERMOVE&&(this._activePointerId===s.pointerId||!a)){if(t.isPointerLock&&this._onMouseMove)this._onMouseMove(r.event);else if(this._previousPosition){const o=this.camera._calculateHandednessMultiplier(),c=(s.clientX-this._previousPosition.x)*o,u=s.clientY-this._previousPosition.y;this._allowCameraRotation&&(this.camera.cameraRotation.y+=c/this.angularSensibility,this.camera.cameraRotation.x+=u/this.angularSensibility),this.onPointerMovedObservable.notifyObservers({offsetX:c,offsetY:u}),this._previousPosition={x:s.clientX,y:s.clientY},e||s.preventDefault()}}}),this._onMouseMove=r=>{if(!t.isPointerLock)return;const s=this.camera._calculateHandednessMultiplier(),a=r.movementX*s;this.camera.cameraRotation.y+=a/this.angularSensibility;const l=r.movementY;this.camera.cameraRotation.x+=l/this.angularSensibility,this._previousPosition=null,e||r.preventDefault()},this._observer=this.camera.getScene()._inputManager._addCameraPointerObserver(this._pointerInput,be.POINTERDOWN|be.POINTERUP|be.POINTERMOVE),i&&(this._contextMenuBind=r=>this.onContextMenu(r),i.addEventListener("contextmenu",this._contextMenuBind,!1))}onContextMenu(e){e.preventDefault()}detachControl(){if(this._observer){if(this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer),this._contextMenuBind){const t=this.camera.getEngine().getInputElement();t&&t.removeEventListener("contextmenu",this._contextMenuBind)}this.onPointerMovedObservable&&this.onPointerMovedObservable.clear(),this._observer=null,this._onMouseMove=null,this._previousPosition=null}this._activePointerId=-1,this._currentActiveButton=-1}getClassName(){return"FreeCameraMouseInput"}getSimpleName(){return"mouse"}}R([I()],Rf.prototype,"buttons",void 0);R([I()],Rf.prototype,"angularSensibility",void 0);zn.FreeCameraMouseInput=Rf;class xf{constructor(){this.wheelPrecisionX=3,this.wheelPrecisionY=3,this.wheelPrecisionZ=3,this.onChangedObservable=new Y,this._wheelDeltaX=0,this._wheelDeltaY=0,this._wheelDeltaZ=0,this._ffMultiplier=12,this._normalize=120}attachControl(e){e=X.BackCompatCameraNoPreventDefault(arguments),this._wheel=t=>{if(t.type!==be.POINTERWHEEL)return;const i=t.event,r=i.deltaMode===tc.DOM_DELTA_LINE?this._ffMultiplier:1;this._wheelDeltaX+=this.wheelPrecisionX*r*i.deltaX/this._normalize,this._wheelDeltaY-=this.wheelPrecisionY*r*i.deltaY/this._normalize,this._wheelDeltaZ+=this.wheelPrecisionZ*r*i.deltaZ/this._normalize,i.preventDefault&&(e||i.preventDefault())},this._observer=this.camera.getScene()._inputManager._addCameraPointerObserver(this._wheel,be.POINTERWHEEL)}detachControl(){this._observer&&(this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer),this._observer=null,this._wheel=null),this.onChangedObservable&&this.onChangedObservable.clear()}checkInputs(){this.onChangedObservable.notifyObservers({wheelDeltaX:this._wheelDeltaX,wheelDeltaY:this._wheelDeltaY,wheelDeltaZ:this._wheelDeltaZ}),this._wheelDeltaX=0,this._wheelDeltaY=0,this._wheelDeltaZ=0}getClassName(){return"BaseCameraMouseWheelInput"}getSimpleName(){return"mousewheel"}}R([I()],xf.prototype,"wheelPrecisionX",void 0);R([I()],xf.prototype,"wheelPrecisionY",void 0);R([I()],xf.prototype,"wheelPrecisionZ",void 0);var Ot;(function(n){n[n.MoveRelative=0]="MoveRelative",n[n.RotateRelative=1]="RotateRelative",n[n.MoveScene=2]="MoveScene"})(Ot||(Ot={}));class jn extends xf{constructor(){super(...arguments),this._moveRelative=A.Zero(),this._rotateRelative=A.Zero(),this._moveScene=A.Zero(),this._wheelXAction=Ot.MoveRelative,this._wheelXActionCoordinate=uo.X,this._wheelYAction=Ot.MoveRelative,this._wheelYActionCoordinate=uo.Z,this._wheelZAction=null,this._wheelZActionCoordinate=null}getClassName(){return"FreeCameraMouseWheelInput"}set wheelXMoveRelative(e){e===null&&this._wheelXAction!==Ot.MoveRelative||(this._wheelXAction=Ot.MoveRelative,this._wheelXActionCoordinate=e)}get wheelXMoveRelative(){return this._wheelXAction!==Ot.MoveRelative?null:this._wheelXActionCoordinate}set wheelYMoveRelative(e){e===null&&this._wheelYAction!==Ot.MoveRelative||(this._wheelYAction=Ot.MoveRelative,this._wheelYActionCoordinate=e)}get wheelYMoveRelative(){return this._wheelYAction!==Ot.MoveRelative?null:this._wheelYActionCoordinate}set wheelZMoveRelative(e){e===null&&this._wheelZAction!==Ot.MoveRelative||(this._wheelZAction=Ot.MoveRelative,this._wheelZActionCoordinate=e)}get wheelZMoveRelative(){return this._wheelZAction!==Ot.MoveRelative?null:this._wheelZActionCoordinate}set wheelXRotateRelative(e){e===null&&this._wheelXAction!==Ot.RotateRelative||(this._wheelXAction=Ot.RotateRelative,this._wheelXActionCoordinate=e)}get wheelXRotateRelative(){return this._wheelXAction!==Ot.RotateRelative?null:this._wheelXActionCoordinate}set wheelYRotateRelative(e){e===null&&this._wheelYAction!==Ot.RotateRelative||(this._wheelYAction=Ot.RotateRelative,this._wheelYActionCoordinate=e)}get wheelYRotateRelative(){return this._wheelYAction!==Ot.RotateRelative?null:this._wheelYActionCoordinate}set wheelZRotateRelative(e){e===null&&this._wheelZAction!==Ot.RotateRelative||(this._wheelZAction=Ot.RotateRelative,this._wheelZActionCoordinate=e)}get wheelZRotateRelative(){return this._wheelZAction!==Ot.RotateRelative?null:this._wheelZActionCoordinate}set wheelXMoveScene(e){e===null&&this._wheelXAction!==Ot.MoveScene||(this._wheelXAction=Ot.MoveScene,this._wheelXActionCoordinate=e)}get wheelXMoveScene(){return this._wheelXAction!==Ot.MoveScene?null:this._wheelXActionCoordinate}set wheelYMoveScene(e){e===null&&this._wheelYAction!==Ot.MoveScene||(this._wheelYAction=Ot.MoveScene,this._wheelYActionCoordinate=e)}get wheelYMoveScene(){return this._wheelYAction!==Ot.MoveScene?null:this._wheelYActionCoordinate}set wheelZMoveScene(e){e===null&&this._wheelZAction!==Ot.MoveScene||(this._wheelZAction=Ot.MoveScene,this._wheelZActionCoordinate=e)}get wheelZMoveScene(){return this._wheelZAction!==Ot.MoveScene?null:this._wheelZActionCoordinate}checkInputs(){if(this._wheelDeltaX===0&&this._wheelDeltaY===0&&this._wheelDeltaZ==0)return;this._moveRelative.setAll(0),this._rotateRelative.setAll(0),this._moveScene.setAll(0),this._updateCamera(),this.camera.getScene().useRightHandedSystem&&(this._moveRelative.z*=-1);const e=z.Zero();this.camera.getViewMatrix().invertToRef(e);const t=A.Zero();A.TransformNormalToRef(this._moveRelative,e,t),this.camera.cameraRotation.x+=this._rotateRelative.x/200,this.camera.cameraRotation.y+=this._rotateRelative.y/200,this.camera.cameraDirection.addInPlace(t),this.camera.cameraDirection.addInPlace(this._moveScene),super.checkInputs()}_updateCamera(){this._updateCameraProperty(this._wheelDeltaX,this._wheelXAction,this._wheelXActionCoordinate),this._updateCameraProperty(this._wheelDeltaY,this._wheelYAction,this._wheelYActionCoordinate),this._updateCameraProperty(this._wheelDeltaZ,this._wheelZAction,this._wheelZActionCoordinate)}_updateCameraProperty(e,t,i){if(e===0||t===null||i===null)return;let r=null;switch(t){case Ot.MoveRelative:r=this._moveRelative;break;case Ot.RotateRelative:r=this._rotateRelative;break;case Ot.MoveScene:r=this._moveScene;break}switch(i){case uo.X:r.set(e,0,0);break;case uo.Y:r.set(0,e,0);break;case uo.Z:r.set(0,0,e);break}}}R([I()],jn.prototype,"wheelXMoveRelative",null);R([I()],jn.prototype,"wheelYMoveRelative",null);R([I()],jn.prototype,"wheelZMoveRelative",null);R([I()],jn.prototype,"wheelXRotateRelative",null);R([I()],jn.prototype,"wheelYRotateRelative",null);R([I()],jn.prototype,"wheelZRotateRelative",null);R([I()],jn.prototype,"wheelXMoveScene",null);R([I()],jn.prototype,"wheelYMoveScene",null);R([I()],jn.prototype,"wheelZMoveScene",null);zn.FreeCameraMouseWheelInput=jn;class Mf{constructor(e=!1){this.allowMouse=e,this.touchAngularSensibility=2e5,this.touchMoveSensibility=250,this.singleFingerRotate=!1,this._offsetX=null,this._offsetY=null,this._pointerPressed=new Array,this._isSafari=X.IsSafari()}attachControl(e){e=X.BackCompatCameraNoPreventDefault(arguments);let t=null;if(this._pointerInput===void 0&&(this._onLostFocus=()=>{this._offsetX=null,this._offsetY=null},this._pointerInput=i=>{const r=i.event,s=r.pointerType==="mouse"||this._isSafari&&typeof r.pointerType>"u";if(!(!this.allowMouse&&s)){if(i.type===be.POINTERDOWN){if(e||r.preventDefault(),this._pointerPressed.push(r.pointerId),this._pointerPressed.length!==1)return;t={x:r.clientX,y:r.clientY}}else if(i.type===be.POINTERUP){e||r.preventDefault();const a=this._pointerPressed.indexOf(r.pointerId);if(a===-1||(this._pointerPressed.splice(a,1),a!=0))return;t=null,this._offsetX=null,this._offsetY=null}else if(i.type===be.POINTERMOVE){if(e||r.preventDefault(),!t||this._pointerPressed.indexOf(r.pointerId)!=0)return;this._offsetX=r.clientX-t.x,this._offsetY=-(r.clientY-t.y)}}}),this._observer=this.camera.getScene()._inputManager._addCameraPointerObserver(this._pointerInput,be.POINTERDOWN|be.POINTERUP|be.POINTERMOVE),this._onLostFocus){const r=this.camera.getEngine().getInputElement();r&&r.addEventListener("blur",this._onLostFocus)}}detachControl(){if(this._pointerInput){if(this._observer&&(this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer),this._observer=null),this._onLostFocus){const t=this.camera.getEngine().getInputElement();t&&t.removeEventListener("blur",this._onLostFocus),this._onLostFocus=null}this._pointerPressed.length=0,this._offsetX=null,this._offsetY=null}}checkInputs(){if(this._offsetX===null||this._offsetY===null||this._offsetX===0&&this._offsetY===0)return;const e=this.camera,t=e._calculateHandednessMultiplier();if(e.cameraRotation.y=t*this._offsetX/this.touchAngularSensibility,this.singleFingerRotate&&this._pointerPressed.length===1||!this.singleFingerRotate&&this._pointerPressed.length>1)e.cameraRotation.x=-this._offsetY/this.touchAngularSensibility;else{const r=e._computeLocalCameraSpeed(),s=new A(0,0,this.touchMoveSensibility!==0?r*this._offsetY/this.touchMoveSensibility:0);z.RotationYawPitchRollToRef(e.rotation.y,e.rotation.x,0,e._cameraRotationMatrix),e.cameraDirection.addInPlace(A.TransformCoordinates(s,e._cameraRotationMatrix))}}getClassName(){return"FreeCameraTouchInput"}getSimpleName(){return"touch"}}R([I()],Mf.prototype,"touchAngularSensibility",void 0);R([I()],Mf.prototype,"touchMoveSensibility",void 0);zn.FreeCameraTouchInput=Mf;class qA extends GA{constructor(e){super(e),this._mouseInput=null,this._mouseWheelInput=null}addKeyboard(){return this.add(new nn),this}addMouse(e=!0){return this._mouseInput||(this._mouseInput=new Rf(e),this.add(this._mouseInput)),this}removeMouse(){return this._mouseInput&&this.remove(this._mouseInput),this}addMouseWheel(){return this._mouseWheelInput||(this._mouseWheelInput=new jn,this.add(this._mouseWheelInput)),this}removeMouseWheel(){return this._mouseWheelInput&&this.remove(this._mouseWheelInput),this}addTouch(){return this.add(new Mf),this}clear(){super.clear(),this._mouseInput=null}}class qu extends Si{get angularSensibility(){const e=this.inputs.attached.mouse;return e?e.angularSensibility:0}set angularSensibility(e){const t=this.inputs.attached.mouse;t&&(t.angularSensibility=e)}get keysUp(){const e=this.inputs.attached.keyboard;return e?e.keysUp:[]}set keysUp(e){const t=this.inputs.attached.keyboard;t&&(t.keysUp=e)}get keysUpward(){const e=this.inputs.attached.keyboard;return e?e.keysUpward:[]}set keysUpward(e){const t=this.inputs.attached.keyboard;t&&(t.keysUpward=e)}get keysDown(){const e=this.inputs.attached.keyboard;return e?e.keysDown:[]}set keysDown(e){const t=this.inputs.attached.keyboard;t&&(t.keysDown=e)}get keysDownward(){const e=this.inputs.attached.keyboard;return e?e.keysDownward:[]}set keysDownward(e){const t=this.inputs.attached.keyboard;t&&(t.keysDownward=e)}get keysLeft(){const e=this.inputs.attached.keyboard;return e?e.keysLeft:[]}set keysLeft(e){const t=this.inputs.attached.keyboard;t&&(t.keysLeft=e)}get keysRight(){const e=this.inputs.attached.keyboard;return e?e.keysRight:[]}set keysRight(e){const t=this.inputs.attached.keyboard;t&&(t.keysRight=e)}get keysRotateLeft(){const e=this.inputs.attached.keyboard;return e?e.keysRotateLeft:[]}set keysRotateLeft(e){const t=this.inputs.attached.keyboard;t&&(t.keysRotateLeft=e)}get keysRotateRight(){const e=this.inputs.attached.keyboard;return e?e.keysRotateRight:[]}set keysRotateRight(e){const t=this.inputs.attached.keyboard;t&&(t.keysRotateRight=e)}get keysRotateUp(){const e=this.inputs.attached.keyboard;return e?e.keysRotateUp:[]}set keysRotateUp(e){const t=this.inputs.attached.keyboard;t&&(t.keysRotateUp=e)}get keysRotateDown(){const e=this.inputs.attached.keyboard;return e?e.keysRotateDown:[]}set keysRotateDown(e){const t=this.inputs.attached.keyboard;t&&(t.keysRotateDown=e)}constructor(e,t,i,r=!0){super(e,t,i,r),this.ellipsoid=new A(.5,1,.5),this.ellipsoidOffset=new A(0,0,0),this.checkCollisions=!1,this.applyGravity=!1,this._needMoveForGravity=!1,this._oldPosition=A.Zero(),this._diffPosition=A.Zero(),this._newPosition=A.Zero(),this._collisionMask=-1,this._onCollisionPositionChange=(s,a,l=null)=>{this._newPosition.copyFrom(a),this._newPosition.subtractToRef(this._oldPosition,this._diffPosition),this._diffPosition.length()>Z.CollisionsEpsilon&&(this.position.addToRef(this._diffPosition,this._deferredPositionUpdate),this._deferOnly?this._deferredUpdated=!0:this.position.copyFrom(this._deferredPositionUpdate),this.onCollide&&l&&this.onCollide(l))},this.inputs=new qA(this),this.inputs.addKeyboard().addMouse()}attachControl(e,t){t=X.BackCompatCameraNoPreventDefault(arguments),this.inputs.attachElement(t)}detachControl(){this.inputs.detachElement(),this.cameraDirection=new A(0,0,0),this.cameraRotation=new xe(0,0)}get collisionMask(){return this._collisionMask}set collisionMask(e){this._collisionMask=isNaN(e)?-1:e}_collideWithWorld(e){let t;this.parent?t=A.TransformCoordinates(this.position,this.parent.getWorldMatrix()):t=this.position,t.subtractFromFloatsToRef(0,this.ellipsoid.y,0,this._oldPosition),this._oldPosition.addInPlace(this.ellipsoidOffset);const i=this.getScene().collisionCoordinator;this._collider||(this._collider=i.createCollider()),this._collider._radius=this.ellipsoid,this._collider.collisionMask=this._collisionMask;let r=e;this.applyGravity&&(r=e.add(this.getScene().gravity)),i.getNewPosition(this._oldPosition,r,this._collider,3,null,this._onCollisionPositionChange,this.uniqueId)}_checkInputs(){this._localDirection||(this._localDirection=A.Zero(),this._transformedDirection=A.Zero()),this.inputs.checkInputs(),super._checkInputs()}set needMoveForGravity(e){this._needMoveForGravity=e}get needMoveForGravity(){return this._needMoveForGravity}_decideIfNeedsToMove(){return this._needMoveForGravity||Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0}_updatePosition(){this.checkCollisions&&this.getScene().collisionsEnabled?this._collideWithWorld(this.cameraDirection):super._updatePosition()}dispose(){this.inputs.clear(),super.dispose()}getClassName(){return"FreeCamera"}}R([Tn()],qu.prototype,"ellipsoid",void 0);R([Tn()],qu.prototype,"ellipsoidOffset",void 0);R([I()],qu.prototype,"checkCollisions",void 0);R([I()],qu.prototype,"applyGravity",void 0);Mi.AddNodeConstructor("TouchCamera",(n,e)=>()=>new $A(n,A.Zero(),e));class $A extends qu{get touchAngularSensibility(){const e=this.inputs.attached.touch;return e?e.touchAngularSensibility:0}set touchAngularSensibility(e){const t=this.inputs.attached.touch;t&&(t.touchAngularSensibility=e)}get touchMoveSensibility(){const e=this.inputs.attached.touch;return e?e.touchMoveSensibility:0}set touchMoveSensibility(e){const t=this.inputs.attached.touch;t&&(t.touchMoveSensibility=e)}constructor(e,t,i){super(e,t,i),this.inputs.addTouch(),this._setupInputs()}getClassName(){return"TouchCamera"}_setupInputs(){const e=this.inputs.attached.touch,t=this.inputs.attached.mouse;t?t.touchEnabled=!1:e.allowMouse=!0}}class Gi{get isConnected(){return this._isConnected}constructor(e,t,i,r=0,s=1,a=2,l=3){this.id=e,this.index=t,this.browserGamepad=i,this._leftStick={x:0,y:0},this._rightStick={x:0,y:0},this._isConnected=!0,this._invertLeftStickY=!1,this.type=Gi.GAMEPAD,this._leftStickAxisX=r,this._leftStickAxisY=s,this._rightStickAxisX=a,this._rightStickAxisY=l,this.browserGamepad.axes.length>=2&&(this._leftStick={x:this.browserGamepad.axes[this._leftStickAxisX],y:this.browserGamepad.axes[this._leftStickAxisY]}),this.browserGamepad.axes.length>=4&&(this._rightStick={x:this.browserGamepad.axes[this._rightStickAxisX],y:this.browserGamepad.axes[this._rightStickAxisY]})}onleftstickchanged(e){this._onleftstickchanged=e}onrightstickchanged(e){this._onrightstickchanged=e}get leftStick(){return this._leftStick}set leftStick(e){this._onleftstickchanged&&(this._leftStick.x!==e.x||this._leftStick.y!==e.y)&&this._onleftstickchanged(e),this._leftStick=e}get rightStick(){return this._rightStick}set rightStick(e){this._onrightstickchanged&&(this._rightStick.x!==e.x||this._rightStick.y!==e.y)&&this._onrightstickchanged(e),this._rightStick=e}update(){this._leftStick&&(this.leftStick={x:this.browserGamepad.axes[this._leftStickAxisX],y:this.browserGamepad.axes[this._leftStickAxisY]},this._invertLeftStickY&&(this.leftStick.y*=-1)),this._rightStick&&(this.rightStick={x:this.browserGamepad.axes[this._rightStickAxisX],y:this.browserGamepad.axes[this._rightStickAxisY]})}dispose(){}}Gi.GAMEPAD=0;Gi.GENERIC=1;Gi.XBOX=2;Gi.POSE_ENABLED=3;Gi.DUALSHOCK=4;class e9 extends Gi{onbuttondown(e){this._onbuttondown=e}onbuttonup(e){this._onbuttonup=e}constructor(e,t,i){super(e,t,i),this.onButtonDownObservable=new Y,this.onButtonUpObservable=new Y,this.type=Gi.GENERIC,this._buttons=new Array(i.buttons.length)}_setButtonValue(e,t,i){return e!==t&&(e===1&&(this._onbuttondown&&this._onbuttondown(i),this.onButtonDownObservable.notifyObservers(i)),e===0&&(this._onbuttonup&&this._onbuttonup(i),this.onButtonUpObservable.notifyObservers(i))),e}update(){super.update();for(let e=0;e<this._buttons.length;e++)this._buttons[e]=this._setButtonValue(this.browserGamepad.buttons[e].value,this._buttons[e],e)}dispose(){super.dispose(),this.onButtonDownObservable.clear(),this.onButtonUpObservable.clear()}}var on;(function(n){n[n.A=0]="A",n[n.B=1]="B",n[n.X=2]="X",n[n.Y=3]="Y",n[n.LB=4]="LB",n[n.RB=5]="RB",n[n.Back=8]="Back",n[n.Start=9]="Start",n[n.LeftStick=10]="LeftStick",n[n.RightStick=11]="RightStick"})(on||(on={}));var Al;(function(n){n[n.Up=12]="Up",n[n.Down=13]="Down",n[n.Left=14]="Left",n[n.Right=15]="Right"})(Al||(Al={}));class t9 extends Gi{constructor(e,t,i,r=!1){super(e,t,i,0,1,2,3),this._leftTrigger=0,this._rightTrigger=0,this.onButtonDownObservable=new Y,this.onButtonUpObservable=new Y,this.onPadDownObservable=new Y,this.onPadUpObservable=new Y,this._buttonA=0,this._buttonB=0,this._buttonX=0,this._buttonY=0,this._buttonBack=0,this._buttonStart=0,this._buttonLB=0,this._buttonRB=0,this._buttonLeftStick=0,this._buttonRightStick=0,this._dPadUp=0,this._dPadDown=0,this._dPadLeft=0,this._dPadRight=0,this._isXboxOnePad=!1,this.type=Gi.XBOX,this._isXboxOnePad=r}onlefttriggerchanged(e){this._onlefttriggerchanged=e}onrighttriggerchanged(e){this._onrighttriggerchanged=e}get leftTrigger(){return this._leftTrigger}set leftTrigger(e){this._onlefttriggerchanged&&this._leftTrigger!==e&&this._onlefttriggerchanged(e),this._leftTrigger=e}get rightTrigger(){return this._rightTrigger}set rightTrigger(e){this._onrighttriggerchanged&&this._rightTrigger!==e&&this._onrighttriggerchanged(e),this._rightTrigger=e}onbuttondown(e){this._onbuttondown=e}onbuttonup(e){this._onbuttonup=e}ondpaddown(e){this._ondpaddown=e}ondpadup(e){this._ondpadup=e}_setButtonValue(e,t,i){return e!==t&&(e===1&&(this._onbuttondown&&this._onbuttondown(i),this.onButtonDownObservable.notifyObservers(i)),e===0&&(this._onbuttonup&&this._onbuttonup(i),this.onButtonUpObservable.notifyObservers(i))),e}_setDPadValue(e,t,i){return e!==t&&(e===1&&(this._ondpaddown&&this._ondpaddown(i),this.onPadDownObservable.notifyObservers(i)),e===0&&(this._ondpadup&&this._ondpadup(i),this.onPadUpObservable.notifyObservers(i))),e}get buttonA(){return this._buttonA}set buttonA(e){this._buttonA=this._setButtonValue(e,this._buttonA,on.A)}get buttonB(){return this._buttonB}set buttonB(e){this._buttonB=this._setButtonValue(e,this._buttonB,on.B)}get buttonX(){return this._buttonX}set buttonX(e){this._buttonX=this._setButtonValue(e,this._buttonX,on.X)}get buttonY(){return this._buttonY}set buttonY(e){this._buttonY=this._setButtonValue(e,this._buttonY,on.Y)}get buttonStart(){return this._buttonStart}set buttonStart(e){this._buttonStart=this._setButtonValue(e,this._buttonStart,on.Start)}get buttonBack(){return this._buttonBack}set buttonBack(e){this._buttonBack=this._setButtonValue(e,this._buttonBack,on.Back)}get buttonLB(){return this._buttonLB}set buttonLB(e){this._buttonLB=this._setButtonValue(e,this._buttonLB,on.LB)}get buttonRB(){return this._buttonRB}set buttonRB(e){this._buttonRB=this._setButtonValue(e,this._buttonRB,on.RB)}get buttonLeftStick(){return this._buttonLeftStick}set buttonLeftStick(e){this._buttonLeftStick=this._setButtonValue(e,this._buttonLeftStick,on.LeftStick)}get buttonRightStick(){return this._buttonRightStick}set buttonRightStick(e){this._buttonRightStick=this._setButtonValue(e,this._buttonRightStick,on.RightStick)}get dPadUp(){return this._dPadUp}set dPadUp(e){this._dPadUp=this._setDPadValue(e,this._dPadUp,Al.Up)}get dPadDown(){return this._dPadDown}set dPadDown(e){this._dPadDown=this._setDPadValue(e,this._dPadDown,Al.Down)}get dPadLeft(){return this._dPadLeft}set dPadLeft(e){this._dPadLeft=this._setDPadValue(e,this._dPadLeft,Al.Left)}get dPadRight(){return this._dPadRight}set dPadRight(e){this._dPadRight=this._setDPadValue(e,this._dPadRight,Al.Right)}update(){super.update(),this._isXboxOnePad?(this.buttonA=this.browserGamepad.buttons[0].value,this.buttonB=this.browserGamepad.buttons[1].value,this.buttonX=this.browserGamepad.buttons[2].value,this.buttonY=this.browserGamepad.buttons[3].value,this.buttonLB=this.browserGamepad.buttons[4].value,this.buttonRB=this.browserGamepad.buttons[5].value,this.leftTrigger=this.browserGamepad.buttons[6].value,this.rightTrigger=this.browserGamepad.buttons[7].value,this.buttonBack=this.browserGamepad.buttons[8].value,this.buttonStart=this.browserGamepad.buttons[9].value,this.buttonLeftStick=this.browserGamepad.buttons[10].value,this.buttonRightStick=this.browserGamepad.buttons[11].value,this.dPadUp=this.browserGamepad.buttons[12].value,this.dPadDown=this.browserGamepad.buttons[13].value,this.dPadLeft=this.browserGamepad.buttons[14].value,this.dPadRight=this.browserGamepad.buttons[15].value):(this.buttonA=this.browserGamepad.buttons[0].value,this.buttonB=this.browserGamepad.buttons[1].value,this.buttonX=this.browserGamepad.buttons[2].value,this.buttonY=this.browserGamepad.buttons[3].value,this.buttonLB=this.browserGamepad.buttons[4].value,this.buttonRB=this.browserGamepad.buttons[5].value,this.leftTrigger=this.browserGamepad.buttons[6].value,this.rightTrigger=this.browserGamepad.buttons[7].value,this.buttonBack=this.browserGamepad.buttons[8].value,this.buttonStart=this.browserGamepad.buttons[9].value,this.buttonLeftStick=this.browserGamepad.buttons[10].value,this.buttonRightStick=this.browserGamepad.buttons[11].value,this.dPadUp=this.browserGamepad.buttons[12].value,this.dPadDown=this.browserGamepad.buttons[13].value,this.dPadLeft=this.browserGamepad.buttons[14].value,this.dPadRight=this.browserGamepad.buttons[15].value)}dispose(){super.dispose(),this.onButtonDownObservable.clear(),this.onButtonUpObservable.clear(),this.onPadDownObservable.clear(),this.onPadUpObservable.clear()}}var ln;(function(n){n[n.Cross=0]="Cross",n[n.Circle=1]="Circle",n[n.Square=2]="Square",n[n.Triangle=3]="Triangle",n[n.L1=4]="L1",n[n.R1=5]="R1",n[n.Share=8]="Share",n[n.Options=9]="Options",n[n.LeftStick=10]="LeftStick",n[n.RightStick=11]="RightStick"})(ln||(ln={}));var Sl;(function(n){n[n.Up=12]="Up",n[n.Down=13]="Down",n[n.Left=14]="Left",n[n.Right=15]="Right"})(Sl||(Sl={}));class i9 extends Gi{constructor(e,t,i){super(e.replace("STANDARD GAMEPAD","SONY PLAYSTATION DUALSHOCK"),t,i,0,1,2,3),this._leftTrigger=0,this._rightTrigger=0,this.onButtonDownObservable=new Y,this.onButtonUpObservable=new Y,this.onPadDownObservable=new Y,this.onPadUpObservable=new Y,this._buttonCross=0,this._buttonCircle=0,this._buttonSquare=0,this._buttonTriangle=0,this._buttonShare=0,this._buttonOptions=0,this._buttonL1=0,this._buttonR1=0,this._buttonLeftStick=0,this._buttonRightStick=0,this._dPadUp=0,this._dPadDown=0,this._dPadLeft=0,this._dPadRight=0,this.type=Gi.DUALSHOCK}onlefttriggerchanged(e){this._onlefttriggerchanged=e}onrighttriggerchanged(e){this._onrighttriggerchanged=e}get leftTrigger(){return this._leftTrigger}set leftTrigger(e){this._onlefttriggerchanged&&this._leftTrigger!==e&&this._onlefttriggerchanged(e),this._leftTrigger=e}get rightTrigger(){return this._rightTrigger}set rightTrigger(e){this._onrighttriggerchanged&&this._rightTrigger!==e&&this._onrighttriggerchanged(e),this._rightTrigger=e}onbuttondown(e){this._onbuttondown=e}onbuttonup(e){this._onbuttonup=e}ondpaddown(e){this._ondpaddown=e}ondpadup(e){this._ondpadup=e}_setButtonValue(e,t,i){return e!==t&&(e===1&&(this._onbuttondown&&this._onbuttondown(i),this.onButtonDownObservable.notifyObservers(i)),e===0&&(this._onbuttonup&&this._onbuttonup(i),this.onButtonUpObservable.notifyObservers(i))),e}_setDPadValue(e,t,i){return e!==t&&(e===1&&(this._ondpaddown&&this._ondpaddown(i),this.onPadDownObservable.notifyObservers(i)),e===0&&(this._ondpadup&&this._ondpadup(i),this.onPadUpObservable.notifyObservers(i))),e}get buttonCross(){return this._buttonCross}set buttonCross(e){this._buttonCross=this._setButtonValue(e,this._buttonCross,ln.Cross)}get buttonCircle(){return this._buttonCircle}set buttonCircle(e){this._buttonCircle=this._setButtonValue(e,this._buttonCircle,ln.Circle)}get buttonSquare(){return this._buttonSquare}set buttonSquare(e){this._buttonSquare=this._setButtonValue(e,this._buttonSquare,ln.Square)}get buttonTriangle(){return this._buttonTriangle}set buttonTriangle(e){this._buttonTriangle=this._setButtonValue(e,this._buttonTriangle,ln.Triangle)}get buttonOptions(){return this._buttonOptions}set buttonOptions(e){this._buttonOptions=this._setButtonValue(e,this._buttonOptions,ln.Options)}get buttonShare(){return this._buttonShare}set buttonShare(e){this._buttonShare=this._setButtonValue(e,this._buttonShare,ln.Share)}get buttonL1(){return this._buttonL1}set buttonL1(e){this._buttonL1=this._setButtonValue(e,this._buttonL1,ln.L1)}get buttonR1(){return this._buttonR1}set buttonR1(e){this._buttonR1=this._setButtonValue(e,this._buttonR1,ln.R1)}get buttonLeftStick(){return this._buttonLeftStick}set buttonLeftStick(e){this._buttonLeftStick=this._setButtonValue(e,this._buttonLeftStick,ln.LeftStick)}get buttonRightStick(){return this._buttonRightStick}set buttonRightStick(e){this._buttonRightStick=this._setButtonValue(e,this._buttonRightStick,ln.RightStick)}get dPadUp(){return this._dPadUp}set dPadUp(e){this._dPadUp=this._setDPadValue(e,this._dPadUp,Sl.Up)}get dPadDown(){return this._dPadDown}set dPadDown(e){this._dPadDown=this._setDPadValue(e,this._dPadDown,Sl.Down)}get dPadLeft(){return this._dPadLeft}set dPadLeft(e){this._dPadLeft=this._setDPadValue(e,this._dPadLeft,Sl.Left)}get dPadRight(){return this._dPadRight}set dPadRight(e){this._dPadRight=this._setDPadValue(e,this._dPadRight,Sl.Right)}update(){super.update(),this.buttonCross=this.browserGamepad.buttons[0].value,this.buttonCircle=this.browserGamepad.buttons[1].value,this.buttonSquare=this.browserGamepad.buttons[2].value,this.buttonTriangle=this.browserGamepad.buttons[3].value,this.buttonL1=this.browserGamepad.buttons[4].value,this.buttonR1=this.browserGamepad.buttons[5].value,this.leftTrigger=this.browserGamepad.buttons[6].value,this.rightTrigger=this.browserGamepad.buttons[7].value,this.buttonShare=this.browserGamepad.buttons[8].value,this.buttonOptions=this.browserGamepad.buttons[9].value,this.buttonLeftStick=this.browserGamepad.buttons[10].value,this.buttonRightStick=this.browserGamepad.buttons[11].value,this.dPadUp=this.browserGamepad.buttons[12].value,this.dPadDown=this.browserGamepad.buttons[13].value,this.dPadLeft=this.browserGamepad.buttons[14].value,this.dPadRight=this.browserGamepad.buttons[15].value}dispose(){super.dispose(),this.onButtonDownObservable.clear(),this.onButtonUpObservable.clear(),this.onPadDownObservable.clear(),this.onPadUpObservable.clear()}}class r9{constructor(e){if(this._scene=e,this._babylonGamepads=[],this._oneGamepadConnected=!1,this._isMonitoring=!1,this.onGamepadDisconnectedObservable=new Y,Ui()?(this._gamepadEventSupported="GamepadEvent"in window,this._gamepadSupport=navigator&&navigator.getGamepads):this._gamepadEventSupported=!1,this.onGamepadConnectedObservable=new Y(t=>{for(const i in this._babylonGamepads){const r=this._babylonGamepads[i];r&&r._isConnected&&this.onGamepadConnectedObservable.notifyObserver(t,r)}}),this._onGamepadConnectedEvent=t=>{const i=t.gamepad;if(i.index in this._babylonGamepads&&this._babylonGamepads[i.index].isConnected)return;let r;this._babylonGamepads[i.index]?(r=this._babylonGamepads[i.index],r.browserGamepad=i,r._isConnected=!0):r=this._addNewGamepad(i),this.onGamepadConnectedObservable.notifyObservers(r),this._startMonitoringGamepads()},this._onGamepadDisconnectedEvent=t=>{const i=t.gamepad;for(const r in this._babylonGamepads)if(this._babylonGamepads[r].index===i.index){const s=this._babylonGamepads[r];s._isConnected=!1,this.onGamepadDisconnectedObservable.notifyObservers(s),s.dispose&&s.dispose();break}},this._gamepadSupport)if(this._updateGamepadObjects(),this._babylonGamepads.length&&this._startMonitoringGamepads(),this._gamepadEventSupported){const t=this._scene?this._scene.getEngine().getHostWindow():window;t&&(t.addEventListener("gamepadconnected",this._onGamepadConnectedEvent,!1),t.addEventListener("gamepaddisconnected",this._onGamepadDisconnectedEvent,!1))}else this._startMonitoringGamepads()}get gamepads(){return this._babylonGamepads}getGamepadByType(e=Gi.XBOX){for(const t of this._babylonGamepads)if(t&&t.type===e)return t;return null}dispose(){this._gamepadEventSupported&&(this._onGamepadConnectedEvent&&window.removeEventListener("gamepadconnected",this._onGamepadConnectedEvent),this._onGamepadDisconnectedEvent&&window.removeEventListener("gamepaddisconnected",this._onGamepadDisconnectedEvent),this._onGamepadConnectedEvent=null,this._onGamepadDisconnectedEvent=null),this._babylonGamepads.forEach(e=>{e.dispose()}),this.onGamepadConnectedObservable.clear(),this.onGamepadDisconnectedObservable.clear(),this._oneGamepadConnected=!1,this._stopMonitoringGamepads(),this._babylonGamepads=[]}_addNewGamepad(e){this._oneGamepadConnected||(this._oneGamepadConnected=!0);let t;const i=e.id.search("054c")!==-1&&e.id.search("0ce6")===-1,r=e.id.search("Xbox One")!==-1;return r||e.id.search("Xbox 360")!==-1||e.id.search("xinput")!==-1||e.id.search("045e")!==-1&&e.id.search("Surface Dock")===-1?t=new t9(e.id,e.index,e,r):i?t=new i9(e.id,e.index,e):t=new e9(e.id,e.index,e),this._babylonGamepads[t.index]=t,t}_startMonitoringGamepads(){this._isMonitoring||(this._isMonitoring=!0,this._checkGamepadsStatus())}_stopMonitoringGamepads(){this._isMonitoring=!1}_checkGamepadsStatus(){this._updateGamepadObjects();for(const e in this._babylonGamepads){const t=this._babylonGamepads[e];if(!(!t||!t.isConnected))try{t.update()}catch{this._loggedErrors.indexOf(t.index)===-1&&(X.Warn(`Error updating gamepad ${t.id}`),this._loggedErrors.push(t.index))}}this._isMonitoring&&Z.QueueNewFrame(()=>{this._checkGamepadsStatus()})}_updateGamepadObjects(){const e=navigator.getGamepads?navigator.getGamepads():[];for(let t=0;t<e.length;t++){const i=e[t];if(i)if(this._babylonGamepads[i.index])this._babylonGamepads[t].browserGamepad=i,this._babylonGamepads[t].isConnected||(this._babylonGamepads[t]._isConnected=!0,this.onGamepadConnectedObservable.notifyObservers(this._babylonGamepads[t]));else{const r=this._addNewGamepad(i);this.onGamepadConnectedObservable.notifyObservers(r)}}}}class If{constructor(){this.gamepadAngularSensibility=200,this.gamepadMoveSensibility=40,this.deadzoneDelta=.1,this._yAxisScale=1,this._cameraTransform=z.Identity(),this._deltaTransform=A.Zero(),this._vector3=A.Zero(),this._vector2=xe.Zero()}get invertYAxis(){return this._yAxisScale!==1}set invertYAxis(e){this._yAxisScale=e?-1:1}attachControl(){const e=this.camera.getScene().gamepadManager;this._onGamepadConnectedObserver=e.onGamepadConnectedObservable.add(t=>{t.type!==Gi.POSE_ENABLED&&(!this.gamepad||t.type===Gi.XBOX)&&(this.gamepad=t)}),this._onGamepadDisconnectedObserver=e.onGamepadDisconnectedObservable.add(t=>{this.gamepad===t&&(this.gamepad=null)}),this.gamepad=e.getGamepadByType(Gi.XBOX),!this.gamepad&&e.gamepads.length&&(this.gamepad=e.gamepads[0])}detachControl(){this.camera.getScene().gamepadManager.onGamepadConnectedObservable.remove(this._onGamepadConnectedObserver),this.camera.getScene().gamepadManager.onGamepadDisconnectedObservable.remove(this._onGamepadDisconnectedObserver),this.gamepad=null}checkInputs(){if(this.gamepad&&this.gamepad.leftStick){const e=this.camera,t=this.gamepad.leftStick;this.gamepadMoveSensibility!==0&&(t.x=Math.abs(t.x)>this.deadzoneDelta?t.x/this.gamepadMoveSensibility:0,t.y=Math.abs(t.y)>this.deadzoneDelta?t.y/this.gamepadMoveSensibility:0);let i=this.gamepad.rightStick;i&&this.gamepadAngularSensibility!==0?(i.x=Math.abs(i.x)>this.deadzoneDelta?i.x/this.gamepadAngularSensibility:0,i.y=(Math.abs(i.y)>this.deadzoneDelta?i.y/this.gamepadAngularSensibility:0)*this._yAxisScale):i={x:0,y:0},e.rotationQuaternion?e.rotationQuaternion.toRotationMatrix(this._cameraTransform):z.RotationYawPitchRollToRef(e.rotation.y,e.rotation.x,0,this._cameraTransform);const r=e._computeLocalCameraSpeed()*50;this._vector3.copyFromFloats(t.x*r,0,-t.y*r),A.TransformCoordinatesToRef(this._vector3,this._cameraTransform,this._deltaTransform),e.cameraDirection.addInPlace(this._deltaTransform),this._vector2.copyFromFloats(i.y,i.x),e.cameraRotation.addInPlace(this._vector2)}}getClassName(){return"FreeCameraGamepadInput"}getSimpleName(){return"gamepad"}}R([I()],If.prototype,"gamepadAngularSensibility",void 0);R([I()],If.prototype,"gamepadMoveSensibility",void 0);zn.FreeCameraGamepadInput=If;class Pf{constructor(){this.gamepadRotationSensibility=80,this.gamepadMoveSensibility=40,this._yAxisScale=1}get invertYAxis(){return this._yAxisScale!==1}set invertYAxis(e){this._yAxisScale=e?-1:1}attachControl(){const e=this.camera.getScene().gamepadManager;this._onGamepadConnectedObserver=e.onGamepadConnectedObservable.add(t=>{t.type!==Gi.POSE_ENABLED&&(!this.gamepad||t.type===Gi.XBOX)&&(this.gamepad=t)}),this._onGamepadDisconnectedObserver=e.onGamepadDisconnectedObservable.add(t=>{this.gamepad===t&&(this.gamepad=null)}),this.gamepad=e.getGamepadByType(Gi.XBOX),!this.gamepad&&e.gamepads.length&&(this.gamepad=e.gamepads[0])}detachControl(){this.camera.getScene().gamepadManager.onGamepadConnectedObservable.remove(this._onGamepadConnectedObserver),this.camera.getScene().gamepadManager.onGamepadDisconnectedObservable.remove(this._onGamepadDisconnectedObserver),this.gamepad=null}checkInputs(){if(this.gamepad){const e=this.camera,t=this.gamepad.rightStick;if(t){if(t.x!=0){const r=t.x/this.gamepadRotationSensibility;r!=0&&Math.abs(r)>.005&&(e.inertialAlphaOffset+=r)}if(t.y!=0){const r=t.y/this.gamepadRotationSensibility*this._yAxisScale;r!=0&&Math.abs(r)>.005&&(e.inertialBetaOffset+=r)}}const i=this.gamepad.leftStick;if(i&&i.y!=0){const r=i.y/this.gamepadMoveSensibility;r!=0&&Math.abs(r)>.005&&(this.camera.inertialRadiusOffset-=r)}}}getClassName(){return"ArcRotateCameraGamepadInput"}getSimpleName(){return"gamepad"}}R([I()],Pf.prototype,"gamepadRotationSensibility",void 0);R([I()],Pf.prototype,"gamepadMoveSensibility",void 0);zn.ArcRotateCameraGamepadInput=Pf;Object.defineProperty(Pt.prototype,"gamepadManager",{get:function(){if(!this._gamepadManager){this._gamepadManager=new r9(this);let n=this._getComponent(Oe.NAME_GAMEPAD);n||(n=new n9(this),this._addComponent(n))}return this._gamepadManager},enumerable:!0,configurable:!0});qA.prototype.addGamepad=function(){return this.add(new If),this};HA.prototype.addGamepad=function(){return this.add(new Pf),this};class n9{constructor(e){this.name=Oe.NAME_GAMEPAD,this.scene=e}register(){this.scene._beforeCameraUpdateStage.registerStep(Oe.STEP_BEFORECAMERAUPDATE_GAMEPAD,this,this._beforeCameraUpdate)}rebuild(){}dispose(){const e=this.scene._gamepadManager;e&&(e.dispose(),this.scene._gamepadManager=null)}_beforeCameraUpdate(){const e=this.scene._gamepadManager;e&&e._isMonitoring&&e._checkGamepadsStatus()}}Mi.AddNodeConstructor("FreeCamera",(n,e)=>()=>new T0(n,A.Zero(),e));class T0 extends $A{get gamepadAngularSensibility(){const e=this.inputs.attached.gamepad;return e?e.gamepadAngularSensibility:0}set gamepadAngularSensibility(e){const t=this.inputs.attached.gamepad;t&&(t.gamepadAngularSensibility=e)}get gamepadMoveSensibility(){const e=this.inputs.attached.gamepad;return e?e.gamepadMoveSensibility:0}set gamepadMoveSensibility(e){const t=this.inputs.attached.gamepad;t&&(t.gamepadMoveSensibility=e)}constructor(e,t,i){super(e,t,i),this.inputs.addGamepad()}getClassName(){return"UniversalCamera"}}Ie._CreateDefaultParsedCamera=(n,e)=>new T0(n,A.Zero(),e);class s9{constructor(e,t){ge(this,"engine");ge(this,"scene");ge(this,"camera");ge(this,"_models",new Map);this.engine=e,this.scene=new Pt(e),this.scene.clearColor=Pe.Black().toColor4(1),this.scene.onPointerDown=this._onPointerDown.bind(this),this.camera=new T0("universalCamera",new A(0,5,0),this.scene),this.camera.fov=1,this.camera.keysUpward.push(69),this.camera.keysDownward.push(81),this.camera.keysUp.push(87),this.camera.keysDown.push(83),this.camera.keysLeft.push(65),this.camera.keysRight.push(68),this.camera.inertia=0,this.camera.angularSensibility=500,this.camera.target=new A(0,0,0),this.camera.minZ=0,this.camera.maxZ=100,this.camera.speed=10,this.camera.attachControl(t,!0)}_onPointerDown(e,t){if(t.hit&&t.pickedMesh){const i=this._models.get(Number(t.pickedMesh.id));console.log("Mesh",t.pickedMesh.getPositionData()),console.log("Model",i),console.log("Face",i==null?void 0:i.faces[t.subMeshId])}}async loadStage(e,t=void 0,i=void 0){const r=[];for(const s of e.models)if(!(s.id<(t||-1))){if(s.id===i)break;r.push(KA.CreateMesh(s,this.scene)),this._models.set(s.id,s)}}}function a9({modelPack:n}){const e=S.useRef(null);return S.useEffect(()=>{if(!e.current||!n)return;const t=new Z(e.current,!1),i=new s9(t,e.current);i.camera.position.fromArray(JSON.parse(sessionStorage.getItem("camPos")||"[0, 0, 0]")),i.camera.rotation.fromArray(JSON.parse(sessionStorage.getItem("camRot")||"[0, 0, 0]")),i.loadStage(n),console.info(`Active textures: ${i.scene.textures.length}`),t.runRenderLoop(function(){i.scene.render()});const r=setInterval(()=>{sessionStorage.setItem("camPos",JSON.stringify(i.camera.position.asArray())),sessionStorage.setItem("camRot",JSON.stringify(i.camera.rotation.asArray()))},1e3);return()=>{clearInterval(r),t.dispose()}},[n]),fe.jsx(fe.Fragment,{children:fe.jsx("canvas",{className:"stage-viewer",ref:e,onClick:t=>{t.currentTarget.requestPointerLock()}})})}var b0={exports:{}},wf={},QA={},gt={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n._registerNode=n.Konva=n.glob=void 0;const e=Math.PI/180;function t(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}n.glob=typeof z0<"u"?z0:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},n.Konva={_global:n.glob,version:"9.3.8",isBrowser:t(),isUnminified:/param/.test((function(r){}).toString()),dblClickWindow:400,getAngle(r){return n.Konva.angleDeg?r*e:r},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return n.Konva.DD.isDragging},isTransforming(){var r;return(r=n.Konva.Transformer)===null||r===void 0?void 0:r.isTransforming()},isDragReady(){return!!n.Konva.DD.node},releaseCanvasOnDestroy:!0,document:n.glob.document,_injectGlobal(r){n.glob.Konva=r}};const i=r=>{n.Konva[r.prototype.getClassName()]=r};n._registerNode=i,n.Konva._injectGlobal(n.Konva)})(gt);var Ci={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Util=n.Transform=void 0;const e=gt;class t{constructor(y=[1,0,0,1,0,0]){this.dirty=!1,this.m=y&&y.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new t(this.m)}copyInto(y){y.m[0]=this.m[0],y.m[1]=this.m[1],y.m[2]=this.m[2],y.m[3]=this.m[3],y.m[4]=this.m[4],y.m[5]=this.m[5]}point(y){var T=this.m;return{x:T[0]*y.x+T[2]*y.y+T[4],y:T[1]*y.x+T[3]*y.y+T[5]}}translate(y,T){return this.m[4]+=this.m[0]*y+this.m[2]*T,this.m[5]+=this.m[1]*y+this.m[3]*T,this}scale(y,T){return this.m[0]*=y,this.m[1]*=y,this.m[2]*=T,this.m[3]*=T,this}rotate(y){var T=Math.cos(y),b=Math.sin(y),C=this.m[0]*T+this.m[2]*b,M=this.m[1]*T+this.m[3]*b,F=this.m[0]*-b+this.m[2]*T,P=this.m[1]*-b+this.m[3]*T;return this.m[0]=C,this.m[1]=M,this.m[2]=F,this.m[3]=P,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(y,T){var b=this.m[0]+this.m[2]*T,C=this.m[1]+this.m[3]*T,M=this.m[2]+this.m[0]*y,F=this.m[3]+this.m[1]*y;return this.m[0]=b,this.m[1]=C,this.m[2]=M,this.m[3]=F,this}multiply(y){var T=this.m[0]*y.m[0]+this.m[2]*y.m[1],b=this.m[1]*y.m[0]+this.m[3]*y.m[1],C=this.m[0]*y.m[2]+this.m[2]*y.m[3],M=this.m[1]*y.m[2]+this.m[3]*y.m[3],F=this.m[0]*y.m[4]+this.m[2]*y.m[5]+this.m[4],P=this.m[1]*y.m[4]+this.m[3]*y.m[5]+this.m[5];return this.m[0]=T,this.m[1]=b,this.m[2]=C,this.m[3]=M,this.m[4]=F,this.m[5]=P,this}invert(){var y=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),T=this.m[3]*y,b=-this.m[1]*y,C=-this.m[2]*y,M=this.m[0]*y,F=y*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),P=y*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=T,this.m[1]=b,this.m[2]=C,this.m[3]=M,this.m[4]=F,this.m[5]=P,this}getMatrix(){return this.m}decompose(){var y=this.m[0],T=this.m[1],b=this.m[2],C=this.m[3],M=this.m[4],F=this.m[5],P=y*C-T*b;let U={x:M,y:F,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(y!=0||T!=0){var G=Math.sqrt(y*y+T*T);U.rotation=T>0?Math.acos(y/G):-Math.acos(y/G),U.scaleX=G,U.scaleY=P/G,U.skewX=(y*b+T*C)/P,U.skewY=0}else if(b!=0||C!=0){var K=Math.sqrt(b*b+C*C);U.rotation=Math.PI/2-(C>0?Math.acos(-b/K):-Math.acos(b/K)),U.scaleX=P/K,U.scaleY=K,U.skewX=0,U.skewY=(y*b+T*C)/P}return U.rotation=n.Util._getRotation(U.rotation),U}}n.Transform=t;var i="[object Array]",r="[object Number]",s="[object String]",a="[object Boolean]",l=Math.PI/180,o=180/Math.PI,c="#",u="",h="0",d="Konva warning: ",f="Konva error: ",_="rgb(",p={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},v=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,E=[];const g=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(m){setTimeout(m,60)};n.Util={_isElement(m){return!!(m&&m.nodeType==1)},_isFunction(m){return!!(m&&m.constructor&&m.call&&m.apply)},_isPlainObject(m){return!!m&&m.constructor===Object},_isArray(m){return Object.prototype.toString.call(m)===i},_isNumber(m){return Object.prototype.toString.call(m)===r&&!isNaN(m)&&isFinite(m)},_isString(m){return Object.prototype.toString.call(m)===s},_isBoolean(m){return Object.prototype.toString.call(m)===a},isObject(m){return m instanceof Object},isValidSelector(m){if(typeof m!="string")return!1;var y=m[0];return y==="#"||y==="."||y===y.toUpperCase()},_sign(m){return m===0||m>0?1:-1},requestAnimFrame(m){E.push(m),E.length===1&&g(function(){const y=E;E=[],y.forEach(function(T){T()})})},createCanvasElement(){var m=document.createElement("canvas");try{m.style=m.style||{}}catch{}return m},createImageElement(){return document.createElement("img")},_isInDocument(m){for(;m=m.parentNode;)if(m==document)return!0;return!1},_urlToImage(m,y){var T=n.Util.createImageElement();T.onload=function(){y(T)},T.src=m},_rgbToHex(m,y,T){return((1<<24)+(m<<16)+(y<<8)+T).toString(16).slice(1)},_hexToRgb(m){m=m.replace(c,u);var y=parseInt(m,16);return{r:y>>16&255,g:y>>8&255,b:y&255}},getRandomColor(){for(var m=(Math.random()*16777215<<0).toString(16);m.length<6;)m=h+m;return c+m},getRGB(m){var y;return m in p?(y=p[m],{r:y[0],g:y[1],b:y[2]}):m[0]===c?this._hexToRgb(m.substring(1)):m.substr(0,4)===_?(y=v.exec(m.replace(/ /g,"")),{r:parseInt(y[1],10),g:parseInt(y[2],10),b:parseInt(y[3],10)}):{r:0,g:0,b:0}},colorToRGBA(m){return m=m||"black",n.Util._namedColorToRBA(m)||n.Util._hex3ColorToRGBA(m)||n.Util._hex4ColorToRGBA(m)||n.Util._hex6ColorToRGBA(m)||n.Util._hex8ColorToRGBA(m)||n.Util._rgbColorToRGBA(m)||n.Util._rgbaColorToRGBA(m)||n.Util._hslColorToRGBA(m)},_namedColorToRBA(m){var y=p[m.toLowerCase()];return y?{r:y[0],g:y[1],b:y[2],a:1}:null},_rgbColorToRGBA(m){if(m.indexOf("rgb(")===0){m=m.match(/rgb\(([^)]+)\)/)[1];var y=m.split(/ *, */).map(Number);return{r:y[0],g:y[1],b:y[2],a:1}}},_rgbaColorToRGBA(m){if(m.indexOf("rgba(")===0){m=m.match(/rgba\(([^)]+)\)/)[1];var y=m.split(/ *, */).map((T,b)=>T.slice(-1)==="%"?b===3?parseInt(T)/100:parseInt(T)/100*255:Number(T));return{r:y[0],g:y[1],b:y[2],a:y[3]}}},_hex8ColorToRGBA(m){if(m[0]==="#"&&m.length===9)return{r:parseInt(m.slice(1,3),16),g:parseInt(m.slice(3,5),16),b:parseInt(m.slice(5,7),16),a:parseInt(m.slice(7,9),16)/255}},_hex6ColorToRGBA(m){if(m[0]==="#"&&m.length===7)return{r:parseInt(m.slice(1,3),16),g:parseInt(m.slice(3,5),16),b:parseInt(m.slice(5,7),16),a:1}},_hex4ColorToRGBA(m){if(m[0]==="#"&&m.length===5)return{r:parseInt(m[1]+m[1],16),g:parseInt(m[2]+m[2],16),b:parseInt(m[3]+m[3],16),a:parseInt(m[4]+m[4],16)/255}},_hex3ColorToRGBA(m){if(m[0]==="#"&&m.length===4)return{r:parseInt(m[1]+m[1],16),g:parseInt(m[2]+m[2],16),b:parseInt(m[3]+m[3],16),a:1}},_hslColorToRGBA(m){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(m)){const[y,...T]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(m),b=Number(T[0])/360,C=Number(T[1])/100,M=Number(T[2])/100;let F,P,U;if(C===0)return U=M*255,{r:Math.round(U),g:Math.round(U),b:Math.round(U),a:1};M<.5?F=M*(1+C):F=M+C-M*C;const G=2*M-F,K=[0,0,0];for(let q=0;q<3;q++)P=b+1/3*-(q-1),P<0&&P++,P>1&&P--,6*P<1?U=G+(F-G)*6*P:2*P<1?U=F:3*P<2?U=G+(F-G)*(2/3-P)*6:U=G,K[q]=U*255;return{r:Math.round(K[0]),g:Math.round(K[1]),b:Math.round(K[2]),a:1}}},haveIntersection(m,y){return!(y.x>m.x+m.width||y.x+y.width<m.x||y.y>m.y+m.height||y.y+y.height<m.y)},cloneObject(m){var y={};for(var T in m)this._isPlainObject(m[T])?y[T]=this.cloneObject(m[T]):this._isArray(m[T])?y[T]=this.cloneArray(m[T]):y[T]=m[T];return y},cloneArray(m){return m.slice(0)},degToRad(m){return m*l},radToDeg(m){return m*o},_degToRad(m){return n.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),n.Util.degToRad(m)},_radToDeg(m){return n.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),n.Util.radToDeg(m)},_getRotation(m){return e.Konva.angleDeg?n.Util.radToDeg(m):m},_capitalize(m){return m.charAt(0).toUpperCase()+m.slice(1)},throw(m){throw new Error(f+m)},error(m){console.error(f+m)},warn(m){e.Konva.showWarnings&&console.warn(d+m)},each(m,y){for(var T in m)y(T,m[T])},_inRange(m,y,T){return y<=m&&m<T},_getProjectionToSegment(m,y,T,b,C,M){var F,P,U,G=(m-T)*(m-T)+(y-b)*(y-b);if(G==0)F=m,P=y,U=(C-T)*(C-T)+(M-b)*(M-b);else{var K=((C-m)*(T-m)+(M-y)*(b-y))/G;K<0?(F=m,P=y,U=(m-C)*(m-C)+(y-M)*(y-M)):K>1?(F=T,P=b,U=(T-C)*(T-C)+(b-M)*(b-M)):(F=m+K*(T-m),P=y+K*(b-y),U=(F-C)*(F-C)+(P-M)*(P-M))}return[F,P,U]},_getProjectionToLine(m,y,T){var b=n.Util.cloneObject(m),C=Number.MAX_VALUE;return y.forEach(function(M,F){if(!(!T&&F===y.length-1)){var P=y[(F+1)%y.length],U=n.Util._getProjectionToSegment(M.x,M.y,P.x,P.y,m.x,m.y),G=U[0],K=U[1],q=U[2];q<C&&(b.x=G,b.y=K,C=q)}}),b},_prepareArrayForTween(m,y,T){var b,C=[],M=[];if(m.length>y.length){var F=y;y=m,m=F}for(b=0;b<m.length;b+=2)C.push({x:m[b],y:m[b+1]});for(b=0;b<y.length;b+=2)M.push({x:y[b],y:y[b+1]});var P=[];return M.forEach(function(U){var G=n.Util._getProjectionToLine(U,C,T);P.push(G.x),P.push(G.y)}),P},_prepareToStringify(m){var y;m.visitedByCircularReferenceRemoval=!0;for(var T in m)if(m.hasOwnProperty(T)&&m[T]&&typeof m[T]=="object"){if(y=Object.getOwnPropertyDescriptor(m,T),m[T].visitedByCircularReferenceRemoval||n.Util._isElement(m[T]))if(y.configurable)delete m[T];else return null;else if(n.Util._prepareToStringify(m[T])===null)if(y.configurable)delete m[T];else return null}return delete m.visitedByCircularReferenceRemoval,m},_assign(m,y){for(var T in y)m[T]=y[T];return m},_getFirstPointerId(m){return m.touches?m.changedTouches[0].identifier:m.pointerId||999},releaseCanvas(...m){e.Konva.releaseCanvasOnDestroy&&m.forEach(y=>{y.width=0,y.height=0})},drawRoundedRectPath(m,y,T,b){let C=0,M=0,F=0,P=0;typeof b=="number"?C=M=F=P=Math.min(b,y/2,T/2):(C=Math.min(b[0]||0,y/2,T/2),M=Math.min(b[1]||0,y/2,T/2),P=Math.min(b[2]||0,y/2,T/2),F=Math.min(b[3]||0,y/2,T/2)),m.moveTo(C,0),m.lineTo(y-M,0),m.arc(y-M,M,M,Math.PI*3/2,0,!1),m.lineTo(y,T-P),m.arc(y-P,T-P,P,0,Math.PI/2,!1),m.lineTo(F,T),m.arc(F,T-F,F,Math.PI/2,Math.PI,!1),m.lineTo(0,C),m.arc(C,C,C,Math.PI,Math.PI*3/2,!1)}}})(Ci);var gi={},mt={},We={};Object.defineProperty(We,"__esModule",{value:!0});We.getComponentValidator=We.getBooleanValidator=We.getNumberArrayValidator=We.getFunctionValidator=We.getStringOrGradientValidator=We.getStringValidator=We.getNumberOrAutoValidator=We.getNumberOrArrayOfNumbersValidator=We.getNumberValidator=We.alphaComponent=We.RGBComponent=void 0;const Xs=gt,xi=Ci;function Ys(n){return xi.Util._isString(n)?'"'+n+'"':Object.prototype.toString.call(n)==="[object Number]"||xi.Util._isBoolean(n)?n:Object.prototype.toString.call(n)}function o9(n){return n>255?255:n<0?0:Math.round(n)}We.RGBComponent=o9;function l9(n){return n>1?1:n<1e-4?1e-4:n}We.alphaComponent=l9;function c9(){if(Xs.Konva.isUnminified)return function(n,e){return xi.Util._isNumber(n)||xi.Util.warn(Ys(n)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),n}}We.getNumberValidator=c9;function u9(n){if(Xs.Konva.isUnminified)return function(e,t){let i=xi.Util._isNumber(e),r=xi.Util._isArray(e)&&e.length==n;return!i&&!r&&xi.Util.warn(Ys(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or Array<number>('+n+")"),e}}We.getNumberOrArrayOfNumbersValidator=u9;function h9(){if(Xs.Konva.isUnminified)return function(n,e){var t=xi.Util._isNumber(n),i=n==="auto";return t||i||xi.Util.warn(Ys(n)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),n}}We.getNumberOrAutoValidator=h9;function d9(){if(Xs.Konva.isUnminified)return function(n,e){return xi.Util._isString(n)||xi.Util.warn(Ys(n)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),n}}We.getStringValidator=d9;function f9(){if(Xs.Konva.isUnminified)return function(n,e){const t=xi.Util._isString(n),i=Object.prototype.toString.call(n)==="[object CanvasGradient]"||n&&n.addColorStop;return t||i||xi.Util.warn(Ys(n)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),n}}We.getStringOrGradientValidator=f9;function _9(){if(Xs.Konva.isUnminified)return function(n,e){return xi.Util._isFunction(n)||xi.Util.warn(Ys(n)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),n}}We.getFunctionValidator=_9;function p9(){if(Xs.Konva.isUnminified)return function(n,e){const t=Int8Array?Object.getPrototypeOf(Int8Array):null;return t&&n instanceof t||(xi.Util._isArray(n)?n.forEach(function(i){xi.Util._isNumber(i)||xi.Util.warn('"'+e+'" attribute has non numeric element '+i+". Make sure that all elements are numbers.")}):xi.Util.warn(Ys(n)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),n}}We.getNumberArrayValidator=p9;function g9(){if(Xs.Konva.isUnminified)return function(n,e){var t=n===!0||n===!1;return t||xi.Util.warn(Ys(n)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),n}}We.getBooleanValidator=g9;function m9(n){if(Xs.Konva.isUnminified)return function(e,t){return e==null||xi.Util.isObject(e)||xi.Util.warn(Ys(e)+' is a not valid value for "'+t+'" attribute. The value should be an object with properties '+n),e}}We.getComponentValidator=m9;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Factory=void 0;const e=Ci,t=We;var i="get",r="set";n.Factory={addGetterSetter(s,a,l,o,c){n.Factory.addGetter(s,a,l),n.Factory.addSetter(s,a,o,c),n.Factory.addOverloadedGetterSetter(s,a)},addGetter(s,a,l){var o=i+e.Util._capitalize(a);s.prototype[o]=s.prototype[o]||function(){var c=this.attrs[a];return c===void 0?l:c}},addSetter(s,a,l,o){var c=r+e.Util._capitalize(a);s.prototype[c]||n.Factory.overWriteSetter(s,a,l,o)},overWriteSetter(s,a,l,o){var c=r+e.Util._capitalize(a);s.prototype[c]=function(u){return l&&u!==void 0&&u!==null&&(u=l.call(this,u,a)),this._setAttr(a,u),o&&o.call(this),this}},addComponentsGetterSetter(s,a,l,o,c){var u=l.length,h=e.Util._capitalize,d=i+h(a),f=r+h(a),_,p;s.prototype[d]=function(){var E={};for(_=0;_<u;_++)p=l[_],E[p]=this.getAttr(a+h(p));return E};var v=(0,t.getComponentValidator)(l);s.prototype[f]=function(E){var g=this.attrs[a],m;o&&(E=o.call(this,E)),v&&v.call(this,E,a);for(m in E)E.hasOwnProperty(m)&&this._setAttr(a+h(m),E[m]);return E||l.forEach(y=>{this._setAttr(a+h(y),void 0)}),this._fireChangeEvent(a,g,E),c&&c.call(this),this},n.Factory.addOverloadedGetterSetter(s,a)},addOverloadedGetterSetter(s,a){var l=e.Util._capitalize(a),o=r+l,c=i+l;s.prototype[a]=function(){return arguments.length?(this[o](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(s,a,l,o){e.Util.error("Adding deprecated "+a);var c=i+e.Util._capitalize(a),u=a+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[c]=function(){e.Util.error(u);var h=this.attrs[a];return h===void 0?l:h},n.Factory.addSetter(s,a,o,function(){e.Util.error(u)}),n.Factory.addOverloadedGetterSetter(s,a)},backCompat(s,a){e.Util.each(a,function(l,o){var c=s.prototype[o],u=i+e.Util._capitalize(l),h=r+e.Util._capitalize(l);function d(){c.apply(this,arguments),e.Util.error('"'+l+'" method is deprecated and will be removed soon. Use ""'+o+'" instead.')}s.prototype[l]=d,s.prototype[u]=d,s.prototype[h]=d})},afterSetFilter(){this._filterUpToDate=!1}}})(mt);var kn={},Ns={};Object.defineProperty(Ns,"__esModule",{value:!0});Ns.HitContext=Ns.SceneContext=Ns.Context=void 0;const ZA=Ci,v9=gt;function E9(n){var e=[],t=n.length,i=ZA.Util,r,s;for(r=0;r<t;r++)s=n[r],i._isNumber(s)?s=Math.round(s*1e3)/1e3:i._isString(s)||(s=s+""),e.push(s);return e}var Yy=",",y9="(",T9=")",b9="([",C9="])",A9=";",S9="()",R9="=",Ky=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],x9=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const M9=100;class Of{constructor(e){this.canvas=e,v9.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,t){var i=this.traceArr,r=i.length,s="",a,l,o,c;for(a=0;a<r;a++)l=i[a],o=l.method,o?(c=l.args,s+=o,e?s+=S9:ZA.Util._isArray(c[0])?s+=b9+c.join(Yy)+C9:(t&&(c=c.map(u=>typeof u=="number"?Math.floor(u):u)),s+=y9+c.join(Yy)+T9)):(s+=l.property,e||(s+=R9+l.val)),s+=A9;return s}clearTrace(){this.traceArr=[]}_trace(e){var t=this.traceArr,i;t.push(e),i=t.length,i>=M9&&t.shift()}reset(){var e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){var t=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)}_applyLineCap(e){const t=e.attrs.lineCap;t&&this.setAttr("lineCap",t)}_applyOpacity(e){var t=e.getAbsoluteOpacity();t!==1&&this.setAttr("globalAlpha",t)}_applyLineJoin(e){const t=e.attrs.lineJoin;t&&this.setAttr("lineJoin",t)}setAttr(e,t){this._context[e]=t}arc(e,t,i,r,s,a){this._context.arc(e,t,i,r,s,a)}arcTo(e,t,i,r,s){this._context.arcTo(e,t,i,r,s)}beginPath(){this._context.beginPath()}bezierCurveTo(e,t,i,r,s,a){this._context.bezierCurveTo(e,t,i,r,s,a)}clearRect(e,t,i,r){this._context.clearRect(e,t,i,r)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,t){var i=arguments;if(i.length===2)return this._context.createImageData(e,t);if(i.length===1)return this._context.createImageData(e)}createLinearGradient(e,t,i,r){return this._context.createLinearGradient(e,t,i,r)}createPattern(e,t){return this._context.createPattern(e,t)}createRadialGradient(e,t,i,r,s,a){return this._context.createRadialGradient(e,t,i,r,s,a)}drawImage(e,t,i,r,s,a,l,o,c){var u=arguments,h=this._context;u.length===3?h.drawImage(e,t,i):u.length===5?h.drawImage(e,t,i,r,s):u.length===9&&h.drawImage(e,t,i,r,s,a,l,o,c)}ellipse(e,t,i,r,s,a,l,o){this._context.ellipse(e,t,i,r,s,a,l,o)}isPointInPath(e,t,i,r){return i?this._context.isPointInPath(i,e,t,r):this._context.isPointInPath(e,t,r)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,t,i,r){this._context.fillRect(e,t,i,r)}strokeRect(e,t,i,r){this._context.strokeRect(e,t,i,r)}fillText(e,t,i,r){r?this._context.fillText(e,t,i,r):this._context.fillText(e,t,i)}measureText(e){return this._context.measureText(e)}getImageData(e,t,i,r){return this._context.getImageData(e,t,i,r)}lineTo(e,t){this._context.lineTo(e,t)}moveTo(e,t){this._context.moveTo(e,t)}rect(e,t,i,r){this._context.rect(e,t,i,r)}roundRect(e,t,i,r,s){this._context.roundRect(e,t,i,r,s)}putImageData(e,t,i){this._context.putImageData(e,t,i)}quadraticCurveTo(e,t,i,r){this._context.quadraticCurveTo(e,t,i,r)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,t){this._context.scale(e,t)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,t,i,r,s,a){this._context.setTransform(e,t,i,r,s,a)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,t,i,r){this._context.strokeText(e,t,i,r)}transform(e,t,i,r,s,a){this._context.transform(e,t,i,r,s,a)}translate(e,t){this._context.translate(e,t)}_enableTrace(){var e=this,t=Ky.length,i=this.setAttr,r,s,a=function(l){var o=e[l],c;e[l]=function(){return s=E9(Array.prototype.slice.call(arguments,0)),c=o.apply(e,arguments),e._trace({method:l,args:s}),c}};for(r=0;r<t;r++)a(Ky[r]);e.setAttr=function(){i.apply(e,arguments);var l=arguments[0],o=arguments[1];(l==="shadowOffsetX"||l==="shadowOffsetY"||l==="shadowBlur")&&(o=o/this.canvas.getPixelRatio()),e._trace({property:l,val:o})}}_applyGlobalCompositeOperation(e){const t=e.attrs.globalCompositeOperation;var i=!t||t==="source-over";i||this.setAttr("globalCompositeOperation",t)}}Ns.Context=Of;x9.forEach(function(n){Object.defineProperty(Of.prototype,n,{get(){return this._context[n]},set(e){this._context[n]=e}})});class I9 extends Of{constructor(e,{willReadFrequently:t=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:t})}_fillColor(e){var t=e.fill();this.setAttr("fillStyle",t),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){var t=e._getLinearGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fillRadialGradient(e){const t=e._getRadialGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fill(e){const t=e.fill(),i=e.getFillPriority();if(t&&i==="color"){this._fillColor(e);return}const r=e.getFillPatternImage();if(r&&i==="pattern"){this._fillPattern(e);return}const s=e.getFillLinearGradientColorStops();if(s&&i==="linear-gradient"){this._fillLinearGradient(e);return}const a=e.getFillRadialGradientColorStops();if(a&&i==="radial-gradient"){this._fillRadialGradient(e);return}t?this._fillColor(e):r?this._fillPattern(e):s?this._fillLinearGradient(e):a&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const t=e.getStrokeLinearGradientStartPoint(),i=e.getStrokeLinearGradientEndPoint(),r=e.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(t.x,t.y,i.x,i.y);if(r){for(var a=0;a<r.length;a+=2)s.addColorStop(r[a],r[a+1]);this.setAttr("strokeStyle",s)}}_stroke(e){var t=e.dash(),i=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!i){this.save();var r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(e),t&&e.dashEnabled()&&(this.setLineDash(t),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var s=e.getStrokeLinearGradientColorStops();s?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),i||this.restore()}}_applyShadow(e){var t,i,r,s=(t=e.getShadowRGBA())!==null&&t!==void 0?t:"black",a=(i=e.getShadowBlur())!==null&&i!==void 0?i:5,l=(r=e.getShadowOffset())!==null&&r!==void 0?r:{x:0,y:0},o=e.getAbsoluteScale(),c=this.canvas.getPixelRatio(),u=o.x*c,h=o.y*c;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",a*Math.min(Math.abs(u),Math.abs(h))),this.setAttr("shadowOffsetX",l.x*u),this.setAttr("shadowOffsetY",l.y*h)}}Ns.SceneContext=I9;class P9 extends Of{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const s=e.getStrokeScaleEnabled();if(!s){this.save();var t=this.getCanvas().getPixelRatio();this.setTransform(t,0,0,t,0,0)}this._applyLineCap(e);var i=e.hitStrokeWidth(),r=i==="auto"?e.strokeWidth():i;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),s||this.restore()}}}Ns.HitContext=P9;Object.defineProperty(kn,"__esModule",{value:!0});kn.HitCanvas=kn.SceneCanvas=kn.Canvas=void 0;const Gd=Ci,JA=Ns,eS=gt,w9=mt,O9=We;var Rh;function D9(){if(Rh)return Rh;var n=Gd.Util.createCanvasElement(),e=n.getContext("2d");return Rh=function(){var t=eS.Konva._global.devicePixelRatio||1,i=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/i}(),Gd.Util.releaseCanvas(n),Rh}class Df{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var t=e||{},i=t.pixelRatio||eS.Konva.pixelRatio||D9();this.pixelRatio=i,this._canvas=Gd.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){var t=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/t,this.getHeight()/t)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";var t=this.pixelRatio,i=this.getContext()._context;i.scale(t,t)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";var t=this.pixelRatio,i=this.getContext()._context;i.scale(t,t)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,t){this.setWidth(e||0),this.setHeight(t||0)}toDataURL(e,t){try{return this._canvas.toDataURL(e,t)}catch{try{return this._canvas.toDataURL()}catch(r){return Gd.Util.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}kn.Canvas=Df;w9.Factory.addGetterSetter(Df,"pixelRatio",void 0,(0,O9.getNumberValidator)());class L9 extends Df{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new JA.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}kn.SceneCanvas=L9;class N9 extends Df{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new JA.HitContext(this),this.setSize(e.width,e.height)}}kn.HitCanvas=N9;var Lf={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DD=void 0;const e=gt,t=Ci;n.DD={get isDragging(){var i=!1;return n.DD._dragElements.forEach(r=>{r.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){var i;return n.DD._dragElements.forEach(r=>{i=r.node}),i},_dragElements:new Map,_drag(i){const r=[];n.DD._dragElements.forEach((s,a)=>{const{node:l}=s,o=l.getStage();o.setPointersPositions(i),s.pointerId===void 0&&(s.pointerId=t.Util._getFirstPointerId(i));const c=o._changedPointerPositions.find(d=>d.id===s.pointerId);if(c){if(s.dragStatus!=="dragging"){var u=l.dragDistance(),h=Math.max(Math.abs(c.x-s.startPointerPos.x),Math.abs(c.y-s.startPointerPos.y));if(h<u||(l.startDrag({evt:i}),!l.isDragging()))return}l._setDragPosition(i,s),r.push(l)}}),r.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:i},!0)})},_endDragBefore(i){const r=[];n.DD._dragElements.forEach(s=>{const{node:a}=s,l=a.getStage();if(i&&l.setPointersPositions(i),!l._changedPointerPositions.find(u=>u.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(n.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const c=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;c&&r.indexOf(c)===-1&&r.push(c)}),r.forEach(s=>{s.draw()})},_endDragAfter(i){n.DD._dragElements.forEach((r,s)=>{r.dragStatus==="stopped"&&r.node.fire("dragend",{type:"dragend",target:r.node,evt:i},!0),r.dragStatus!=="dragging"&&n.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",n.DD._endDragBefore,!0),window.addEventListener("touchend",n.DD._endDragBefore,!0),window.addEventListener("mousemove",n.DD._drag),window.addEventListener("touchmove",n.DD._drag),window.addEventListener("mouseup",n.DD._endDragAfter,!1),window.addEventListener("touchend",n.DD._endDragAfter,!1))})(Lf);Object.defineProperty(gi,"__esModule",{value:!0});gi.Node=void 0;const Rt=Ci,$u=mt,Pc=kn,la=gt,an=Lf,Li=We;var Yh="absoluteOpacity",xh="allEventListeners",Ts="absoluteTransform",qy="absoluteScale",ro="canvas",F9="Change",k9="children",B9="konva",Fg="listening",$y="mouseenter",Qy="mouseleave",Zy="set",Jy="Shape",Kh=" ",eT="stage",ua="transform",U9="Stage",kg="visible",z9=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Kh);let V9=1;class tt{constructor(e){this._id=V9++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===ua||e===Ts)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,t){var i=this._cache.get(e),r=e===ua||e===Ts,s=i===void 0||r&&i.dirty===!0;return s&&(i=t.call(this),this._cache.set(e,i)),i}_calculate(e,t,i){if(!this._attachedDepsListeners.get(e)){const r=t.map(s=>s+"Change.konva").join(Kh);this.on(r,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,i)}_getCanvasCache(){return this._cache.get(ro)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Ts&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(ro)){const{scene:e,filter:t,hit:i}=this._cache.get(ro);Rt.Util.releaseCanvas(e,t,i),this._cache.delete(ro)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){var t=e||{},i={};(t.x===void 0||t.y===void 0||t.width===void 0||t.height===void 0)&&(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));var r=Math.ceil(t.width||i.width),s=Math.ceil(t.height||i.height),a=t.pixelRatio,l=t.x===void 0?Math.floor(i.x):t.x,o=t.y===void 0?Math.floor(i.y):t.y,c=t.offset||0,u=t.drawBorder||!1,h=t.hitCanvasPixelRatio||1;if(!r||!s){Rt.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const d=Math.abs(Math.round(i.x)-l)>.5?1:0,f=Math.abs(Math.round(i.y)-o)>.5?1:0;r+=c*2+d,s+=c*2+f,l-=c,o-=c;var _=new Pc.SceneCanvas({pixelRatio:a,width:r,height:s}),p=new Pc.SceneCanvas({pixelRatio:a,width:0,height:0,willReadFrequently:!0}),v=new Pc.HitCanvas({pixelRatio:h,width:r,height:s}),E=_.getContext(),g=v.getContext();return v.isCache=!0,_.isCache=!0,this._cache.delete(ro),this._filterUpToDate=!1,t.imageSmoothingEnabled===!1&&(_.getContext()._context.imageSmoothingEnabled=!1,p.getContext()._context.imageSmoothingEnabled=!1),E.save(),g.save(),E.translate(-l,-o),g.translate(-l,-o),this._isUnderCache=!0,this._clearSelfAndDescendantCache(Yh),this._clearSelfAndDescendantCache(qy),this.drawScene(_,this),this.drawHit(v,this),this._isUnderCache=!1,E.restore(),g.restore(),u&&(E.save(),E.beginPath(),E.rect(0,0,r,s),E.closePath(),E.setAttr("strokeStyle","red"),E.setAttr("lineWidth",5),E.stroke(),E.restore()),this._cache.set(ro,{scene:_,filter:p,hit:v,x:l,y:o}),this._requestDraw(),this}isCached(){return this._cache.has(ro)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,t){var i=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],r=1/0,s=1/0,a=-1/0,l=-1/0,o=this.getAbsoluteTransform(t);return i.forEach(function(c){var u=o.point(c);r===void 0&&(r=a=u.x,s=l=u.y),r=Math.min(r,u.x),s=Math.min(s,u.y),a=Math.max(a,u.x),l=Math.max(l,u.y)}),{x:r,y:s,width:a-r,height:l-s}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const t=this._getCanvasCache();e.translate(t.x,t.y);var i=this._getCachedSceneCanvas(),r=i.pixelRatio;e.drawImage(i._canvas,0,0,i.width/r,i.height/r),e.restore()}_drawCachedHitCanvas(e){var t=this._getCanvasCache(),i=t.hit;e.save(),e.translate(t.x,t.y),e.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),e.restore()}_getCachedSceneCanvas(){var e=this.filters(),t=this._getCanvasCache(),i=t.scene,r=t.filter,s=r.getContext(),a,l,o,c;if(e){if(!this._filterUpToDate){var u=i.pixelRatio;r.setSize(i.width/i.pixelRatio,i.height/i.pixelRatio);try{for(a=e.length,s.clear(),s.drawImage(i._canvas,0,0,i.getWidth()/u,i.getHeight()/u),l=s.getImageData(0,0,r.getWidth(),r.getHeight()),o=0;o<a;o++){if(c=e[o],typeof c!="function"){Rt.Util.error("Filter should be type of function, but got "+typeof c+" instead. Please check correct filters");continue}c.call(this,l),s.putImageData(l,0,0)}}catch(h){Rt.Util.error("Unable to apply filter. "+h.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return r}return i}on(e,t){if(this._cache&&this._cache.delete(xh),arguments.length===3)return this._delegate.apply(this,arguments);var i=e.split(Kh),r=i.length,s,a,l,o,c;for(s=0;s<r;s++)a=i[s],l=a.split("."),o=l[0],c=l[1]||"",this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:c,handler:t});return this}off(e,t){var i=(e||"").split(Kh),r=i.length,s,a,l,o,c,u;if(this._cache&&this._cache.delete(xh),!e)for(a in this.eventListeners)this._off(a);for(s=0;s<r;s++)if(l=i[s],o=l.split("."),c=o[0],u=o[1],c)this.eventListeners[c]&&this._off(c,u,t);else for(a in this.eventListeners)this._off(a,u,t);return this}dispatchEvent(e){var t={target:this,type:e.type,evt:e};return this.fire(e.type,t),this}addEventListener(e,t){return this.on(e,function(i){t.call(this,i.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,t,i){var r=this;this.on(e,function(s){for(var a=s.target.findAncestors(t,!0,r),l=0;l<a.length;l++)s=Rt.Util.cloneObject(s),s.currentTarget=a[l],i.call(a[l],s)})}remove(){return this.isDragging()&&this.stopDrag(),an.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Ts),this._clearSelfAndDescendantCache(Yh),this._clearSelfAndDescendantCache(qy),this._clearSelfAndDescendantCache(eT),this._clearSelfAndDescendantCache(kg),this._clearSelfAndDescendantCache(Fg)}_remove(){this._clearCaches();var e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){var t="get"+Rt.Util._capitalize(e);return Rt.Util._isFunction(this[t])?this[t]():this.attrs[e]}getAncestors(){for(var e=this.getParent(),t=[];e;)t.push(e),e=e.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{var t,i;if(!e)return this;for(t in e)t!==k9&&(i=Zy+Rt.Util._capitalize(t),Rt.Util._isFunction(this[i])?this[i](e[t]):this._setAttr(t,e[t]))}),this}isListening(){return this._getCache(Fg,this._isListening)}_isListening(e){if(!this.listening())return!1;const i=this.getParent();return i&&i!==e&&this!==e?i._isListening(e):!0}isVisible(){return this._getCache(kg,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const i=this.getParent();return i&&i!==e&&this!==e?i._isVisible(e):!0}shouldDrawHit(e,t=!1){if(e)return this._isVisible(e)&&this._isListening(e);var i=this.getLayer(),r=!1;an.DD._dragElements.forEach(a=>{a.dragStatus==="dragging"&&(a.node.nodeType==="Stage"||a.node.getLayer()===i)&&(r=!0)});var s=!t&&!la.Konva.hitOnDragEnabled&&(r||la.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var e=this.getDepth(),t=this,i=0,r,s,a,l;function o(u){for(r=[],s=u.length,a=0;a<s;a++)l=u[a],i++,l.nodeType!==Jy&&(r=r.concat(l.getChildren().slice())),l._id===t._id&&(a=s);r.length>0&&r[0].getDepth()<=e&&o(r)}const c=this.getStage();return t.nodeType!==U9&&c&&o(c.getChildren()),i}getDepth(){for(var e=0,t=this.parent;t;)e++,t=t.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(ua),this._clearSelfAndDescendantCache(Ts)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;var t=e.getPointerPosition();if(!t)return null;var i=this.getAbsoluteTransform().copy();return i.invert(),i.point(t)}getAbsolutePosition(e){let t=!1,i=this.parent;for(;i;){if(i.isCached()){t=!0;break}i=i.parent}t&&!e&&(e=!0);var r=this.getAbsoluteTransform(e).getMatrix(),s=new Rt.Transform,a=this.offset();return s.m=r.slice(),s.translate(a.x,a.y),s.getTranslation()}setAbsolutePosition(e){const{x:t,y:i,...r}=this._clearTransform();this.attrs.x=t,this.attrs.y=i,this._clearCache(ua);var s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(e.x,e.y),e={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(r),this.setPosition({x:e.x,y:e.y}),this._clearCache(ua),this._clearSelfAndDescendantCache(Ts),this}_setTransform(e){var t;for(t in e)this.attrs[t]=e[t]}_clearTransform(){var e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){var t=e.x,i=e.y,r=this.x(),s=this.y();return t!==void 0&&(r+=t),i!==void 0&&(s+=i),this.setPosition({x:r,y:s}),this}_eachAncestorReverse(e,t){var i=[],r=this.getParent(),s,a;if(!(t&&t._id===this._id)){for(i.unshift(this);r&&(!t||r._id!==t._id);)i.unshift(r),r=r.parent;for(s=i.length,a=0;a<s;a++)e(i[a])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return Rt.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return Rt.Util.warn("Node has no parent. moveUp function is ignored."),!1;var e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return Rt.Util.warn("Node has no parent. moveDown function is ignored."),!1;var e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return Rt.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return Rt.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&Rt.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var t=this.index;return this.parent.children.splice(t,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Yh,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var e=this.opacity(),t=this.getParent();return t&&!t._isUnderCache&&(e*=t.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){var e=this.getAttrs(),t,i,r,s,a;const l={attrs:{},className:this.getClassName()};for(t in e)i=e[t],a=Rt.Util.isObject(i)&&!Rt.Util._isPlainObject(i)&&!Rt.Util._isArray(i),!a&&(r=typeof this[t]=="function"&&this[t],delete e[t],s=r?r.call(this):null,e[t]=i,s!==i&&(l.attrs[t]=i));return Rt.Util._prepareToStringify(l)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,t,i){var r=[];t&&this._isMatch(e)&&r.push(this);for(var s=this.parent;s;){if(s===i)return r;s._isMatch(e)&&r.push(s),s=s.parent}return r}isAncestorOf(e){return!1}findAncestor(e,t,i){return this.findAncestors(e,t,i)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);var t=e.replace(/ /g,"").split(","),i=t.length,r,s;for(r=0;r<i;r++)if(s=t[r],Rt.Util.isValidSelector(s)||(Rt.Util.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),Rt.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),Rt.Util.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){var e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(eT,this._getStage)}_getStage(){var e=this.getParent();return e?e.getStage():null}fire(e,t={},i){return t.target=t.target||this,i?this._fireAndBubble(e,t):this._fire(e,t),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Ts,this._getAbsoluteTransform)}_getAbsoluteTransform(e){var t;if(e)return t=new Rt.Transform,this._eachAncestorReverse(function(r){var s=r.transformsEnabled();s==="all"?t.multiply(r.getTransform()):s==="position"&&t.translate(r.x()-r.offsetX(),r.y()-r.offsetY())},e),t;t=this._cache.get(Ts)||new Rt.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();var i=this.transformsEnabled();if(i==="all")t.multiply(this.getTransform());else if(i==="position"){const r=this.attrs.x||0,s=this.attrs.y||0,a=this.attrs.offsetX||0,l=this.attrs.offsetY||0;t.translate(r-a,s-l)}return t.dirty=!1,t}getAbsoluteScale(e){for(var t=this;t;)t._isUnderCache&&(e=t),t=t.getParent();const r=this.getAbsoluteTransform(e).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(ua,this._getTransform)}_getTransform(){var e,t,i=this._cache.get(ua)||new Rt.Transform;i.reset();var r=this.x(),s=this.y(),a=la.Konva.getAngle(this.rotation()),l=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,o=(t=this.attrs.scaleY)!==null&&t!==void 0?t:1,c=this.attrs.skewX||0,u=this.attrs.skewY||0,h=this.attrs.offsetX||0,d=this.attrs.offsetY||0;return(r!==0||s!==0)&&i.translate(r,s),a!==0&&i.rotate(a),(c!==0||u!==0)&&i.skew(c,u),(l!==1||o!==1)&&i.scale(l,o),(h!==0||d!==0)&&i.translate(-1*h,-1*d),i.dirty=!1,i}clone(e){var t=Rt.Util.cloneObject(this.attrs),i,r,s,a,l;for(i in e)t[i]=e[i];var o=new this.constructor(t);for(i in this.eventListeners)for(r=this.eventListeners[i],s=r.length,a=0;a<s;a++)l=r[a],l.name.indexOf(B9)<0&&(o.eventListeners[i]||(o.eventListeners[i]=[]),o.eventListeners[i].push(l));return o}_toKonvaCanvas(e){e=e||{};var t=this.getClientRect(),i=this.getStage(),r=e.x!==void 0?e.x:Math.floor(t.x),s=e.y!==void 0?e.y:Math.floor(t.y),a=e.pixelRatio||1,l=new Pc.SceneCanvas({width:e.width||Math.ceil(t.width)||(i?i.width():0),height:e.height||Math.ceil(t.height)||(i?i.height():0),pixelRatio:a}),o=l.getContext();const c=new Pc.SceneCanvas({width:l.width/l.pixelRatio+Math.abs(r),height:l.height/l.pixelRatio+Math.abs(s),pixelRatio:l.pixelRatio});return e.imageSmoothingEnabled===!1&&(o._context.imageSmoothingEnabled=!1),o.save(),(r||s)&&o.translate(-1*r,-1*s),this.drawScene(l,void 0,c),o.restore(),l}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};var t=e.mimeType||null,i=e.quality||null,r=this._toKonvaCanvas(e).toDataURL(t,i);return e.callback&&e.callback(r),r}toImage(e){return new Promise((t,i)=>{try{const r=e==null?void 0:e.callback;r&&delete e.callback,Rt.Util._urlToImage(this.toDataURL(e),function(s){t(s),r==null||r(s)})}catch(r){i(r)}})}toBlob(e){return new Promise((t,i)=>{try{const r=e==null?void 0:e.callback;r&&delete e.callback,this.toCanvas(e).toBlob(s=>{t(s),r==null||r(s)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(r){i(r)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():la.Konva.dragDistance}_off(e,t,i){var r=this.eventListeners[e],s,a,l;for(s=0;s<r.length;s++)if(a=r[s].name,l=r[s].handler,(a!=="konva"||t==="konva")&&(!t||a===t)&&(!i||i===l)){if(r.splice(s,1),r.length===0){delete this.eventListeners[e];break}s--}}_fireChangeEvent(e,t,i){this._fire(e+F9,{oldVal:t,newVal:i})}addName(e){if(!this.hasName(e)){var t=this.name(),i=t?t+" "+e:e;this.name(i)}return this}hasName(e){if(!e)return!1;const t=this.name();if(!t)return!1;var i=(t||"").split(/\s/g);return i.indexOf(e)!==-1}removeName(e){var t=(this.name()||"").split(/\s/g),i=t.indexOf(e);return i!==-1&&(t.splice(i,1),this.name(t.join(" "))),this}setAttr(e,t){var i=this[Zy+Rt.Util._capitalize(e)];return Rt.Util._isFunction(i)?i.call(this,t):this._setAttr(e,t),this}_requestDraw(){if(la.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,t){var i=this.attrs[e];i===t&&!Rt.Util.isObject(t)||(t==null?delete this.attrs[e]:this.attrs[e]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(e,i,t),this._requestDraw())}_setComponentAttr(e,t,i){var r;i!==void 0&&(r=this.attrs[e],r||(this.attrs[e]=this.getAttr(e)),this.attrs[e][t]=i,this._fireChangeEvent(e,r,i))}_fireAndBubble(e,t,i){t&&this.nodeType===Jy&&(t.target=this);var r=(e===$y||e===Qy)&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||this.nodeType==="Stage"&&!i);if(!r){this._fire(e,t);var s=(e===$y||e===Qy)&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!s&&(i&&i.parent?this._fireAndBubble.call(this.parent,e,t,i):this._fireAndBubble.call(this.parent,e,t))}}_getProtoListeners(e){var t,i,r;const s=(t=this._cache.get(xh))!==null&&t!==void 0?t:{};let a=s==null?void 0:s[e];if(a===void 0){a=[];let l=Object.getPrototypeOf(this);for(;l;){const o=(r=(i=l.eventListeners)===null||i===void 0?void 0:i[e])!==null&&r!==void 0?r:[];a.push(...o),l=Object.getPrototypeOf(l)}s[e]=a,this._cache.set(xh,s)}return a}_fire(e,t){t=t||{},t.currentTarget=this,t.type=e;const i=this._getProtoListeners(e);if(i)for(var r=0;r<i.length;r++)i[r].handler.call(this,t);const s=this.eventListeners[e];if(s)for(var r=0;r<s.length;r++)s[r].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){var t=e?e.pointerId:void 0,i=this.getStage(),r=this.getAbsolutePosition();if(i){var s=i._getPointerById(t)||i._changedPointerPositions[0]||r;an.DD._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-r.x,y:s.y-r.y},dragStatus:"ready",pointerId:t})}}startDrag(e,t=!0){an.DD._dragElements.has(this._id)||this._createDragElement(e);const i=an.DD._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},t)}_setDragPosition(e,t){const i=this.getStage()._getPointerById(t.pointerId);if(i){var r={x:i.x-t.offset.x,y:i.y-t.offset.y},s=this.dragBoundFunc();if(s!==void 0){const a=s.call(this,r,e);a?r=a:Rt.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}}stopDrag(e){const t=an.DD._dragElements.get(this._id);t&&(t.dragStatus="stopped"),an.DD._endDragBefore(e),an.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=an.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){var t=e.evt.button!==void 0,i=!t||la.Konva.dragButtons.indexOf(e.evt.button)>=0;if(i&&!this.isDragging()){var r=!1;an.DD._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(r=!0)}),r||this._createDragElement(e)}})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var e=this.getStage();if(!e)return;const t=an.DD._dragElements.get(this._id),i=t&&t.dragStatus==="dragging",r=t&&t.dragStatus==="ready";i?this.stopDrag():r&&an.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const t=this.getStage();if(!t)return!1;const i={x:-e.x,y:-e.y,width:t.width()+2*e.x,height:t.height()+2*e.y};return Rt.Util.haveIntersection(i,this.getClientRect())}static create(e,t){return Rt.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,t)}static _createNode(e,t){var i=tt.prototype.getClassName.call(e),r=e.children,s,a,l;t&&(e.attrs.container=t),la.Konva[i]||(Rt.Util.warn('Can not find a node with class name "'+i+'". Fallback to "Shape".'),i="Shape");const o=la.Konva[i];if(s=new o(e.attrs),r)for(a=r.length,l=0;l<a;l++)s.add(tt._createNode(r[l]));return s}}gi.Node=tt;tt.prototype.nodeType="Node";tt.prototype._attrsAffectingSize=[];tt.prototype.eventListeners={};tt.prototype.on.call(tt.prototype,z9,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(ua),this._clearSelfAndDescendantCache(Ts)});tt.prototype.on.call(tt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(kg)});tt.prototype.on.call(tt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Fg)});tt.prototype.on.call(tt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Yh)});const ti=$u.Factory.addGetterSetter;ti(tt,"zIndex");ti(tt,"absolutePosition");ti(tt,"position");ti(tt,"x",0,(0,Li.getNumberValidator)());ti(tt,"y",0,(0,Li.getNumberValidator)());ti(tt,"globalCompositeOperation","source-over",(0,Li.getStringValidator)());ti(tt,"opacity",1,(0,Li.getNumberValidator)());ti(tt,"name","",(0,Li.getStringValidator)());ti(tt,"id","",(0,Li.getStringValidator)());ti(tt,"rotation",0,(0,Li.getNumberValidator)());$u.Factory.addComponentsGetterSetter(tt,"scale",["x","y"]);ti(tt,"scaleX",1,(0,Li.getNumberValidator)());ti(tt,"scaleY",1,(0,Li.getNumberValidator)());$u.Factory.addComponentsGetterSetter(tt,"skew",["x","y"]);ti(tt,"skewX",0,(0,Li.getNumberValidator)());ti(tt,"skewY",0,(0,Li.getNumberValidator)());$u.Factory.addComponentsGetterSetter(tt,"offset",["x","y"]);ti(tt,"offsetX",0,(0,Li.getNumberValidator)());ti(tt,"offsetY",0,(0,Li.getNumberValidator)());ti(tt,"dragDistance",null,(0,Li.getNumberValidator)());ti(tt,"width",0,(0,Li.getNumberValidator)());ti(tt,"height",0,(0,Li.getNumberValidator)());ti(tt,"listening",!0,(0,Li.getBooleanValidator)());ti(tt,"preventDefault",!0,(0,Li.getBooleanValidator)());ti(tt,"filters",null,function(n){return this._filterUpToDate=!1,n});ti(tt,"visible",!0,(0,Li.getBooleanValidator)());ti(tt,"transformsEnabled","all",(0,Li.getStringValidator)());ti(tt,"size");ti(tt,"dragBoundFunc");ti(tt,"draggable",!1,(0,Li.getBooleanValidator)());$u.Factory.backCompat(tt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var ko={};Object.defineProperty(ko,"__esModule",{value:!0});ko.Container=void 0;const ac=mt,up=gi,Nf=We;class Bo extends up.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){if(!e)return this.children||[];const t=this.children||[];var i=[];return t.forEach(function(r){e(r)&&i.push(r)}),i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(var t=0;t<e.length;t++)this.add(e[t]);return this}const i=e[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){var t=this._generalFind(e,!0);return t.length>0?t[0]:void 0}_generalFind(e,t){var i=[];return this._descendants(r=>{const s=r._isMatch(e);return s&&i.push(r),!!(s&&t)}),i}_descendants(e){let t=!1;const i=this.getChildren();for(const r of i){if(t=e(r),t)return!0;if(r.hasChildren()&&(t=r._descendants(e),t))return!0}return!1}toObject(){var e=up.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(t=>{e.children.push(t.toObject())}),e}isAncestorOf(e){for(var t=e.getParent();t;){if(t._id===this._id)return!0;t=t.getParent()}return!1}clone(e){var t=up.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(i){t.add(i.clone())}),t}getAllIntersections(e){var t=[];return this.find("Shape").forEach(i=>{i.isVisible()&&i.intersects(e)&&t.push(i)}),t}_clearSelfAndDescendantCache(e){var t;super._clearSelfAndDescendantCache(e),!this.isCached()&&((t=this.children)===null||t===void 0||t.forEach(function(i){i._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(t,i){t.index=i}),this._requestDraw()}drawScene(e,t,i){var r=this.getLayer(),s=e||r&&r.getCanvas(),a=s&&s.getContext(),l=this._getCanvasCache(),o=l&&l.scene,c=s&&s.isCache;if(!this.isVisible()&&!c)return this;if(o){a.save();var u=this.getAbsoluteTransform(t).getMatrix();a.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedSceneCanvas(a),a.restore()}else this._drawChildren("drawScene",s,t,i);return this}drawHit(e,t){if(!this.shouldDrawHit(t))return this;var i=this.getLayer(),r=e||i&&i.hitCanvas,s=r&&r.getContext(),a=this._getCanvasCache(),l=a&&a.hit;if(l){s.save();var o=this.getAbsoluteTransform(t).getMatrix();s.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",r,t);return this}_drawChildren(e,t,i,r){var s,a=t&&t.getContext(),l=this.clipWidth(),o=this.clipHeight(),c=this.clipFunc(),u=typeof l=="number"&&typeof o=="number"||c;const h=i===this;if(u){a.save();var d=this.getAbsoluteTransform(i),f=d.getMatrix();a.transform(f[0],f[1],f[2],f[3],f[4],f[5]),a.beginPath();let E;if(c)E=c.call(this,a,this);else{var _=this.clipX(),p=this.clipY();a.rect(_||0,p||0,l,o)}a.clip.apply(a,E),f=d.copy().invert().getMatrix(),a.transform(f[0],f[1],f[2],f[3],f[4],f[5])}var v=!h&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";v&&(a.save(),a._applyGlobalCompositeOperation(this)),(s=this.children)===null||s===void 0||s.forEach(function(E){E[e](t,i,r)}),v&&a.restore(),u&&a.restore()}getClientRect(e={}){var t,i=e.skipTransform,r=e.relativeTo,s,a,l,o,c={x:1/0,y:1/0,width:0,height:0},u=this;(t=this.children)===null||t===void 0||t.forEach(function(p){if(p.visible()){var v=p.getClientRect({relativeTo:u,skipShadow:e.skipShadow,skipStroke:e.skipStroke});v.width===0&&v.height===0||(s===void 0?(s=v.x,a=v.y,l=v.x+v.width,o=v.y+v.height):(s=Math.min(s,v.x),a=Math.min(a,v.y),l=Math.max(l,v.x+v.width),o=Math.max(o,v.y+v.height)))}});for(var h=this.find("Shape"),d=!1,f=0;f<h.length;f++){var _=h[f];if(_._isVisible(this)){d=!0;break}}return d&&s!==void 0?c={x:s,y:a,width:l-s,height:o-a}:c={x:0,y:0,width:0,height:0},i?c:this._transformedRect(c,r)}}ko.Container=Bo;ac.Factory.addComponentsGetterSetter(Bo,"clip",["x","y","width","height"]);ac.Factory.addGetterSetter(Bo,"clipX",void 0,(0,Nf.getNumberValidator)());ac.Factory.addGetterSetter(Bo,"clipY",void 0,(0,Nf.getNumberValidator)());ac.Factory.addGetterSetter(Bo,"clipWidth",void 0,(0,Nf.getNumberValidator)());ac.Factory.addGetterSetter(Bo,"clipHeight",void 0,(0,Nf.getNumberValidator)());ac.Factory.addGetterSetter(Bo,"clipFunc");var tS={},qr={};Object.defineProperty(qr,"__esModule",{value:!0});qr.releaseCapture=qr.setPointerCapture=qr.hasPointerCapture=qr.createEvent=qr.getCapturedShape=void 0;const G9=gt,Ou=new Map,iS=G9.Konva._global.PointerEvent!==void 0;function W9(n){return Ou.get(n)}qr.getCapturedShape=W9;function C0(n){return{evt:n,pointerId:n.pointerId}}qr.createEvent=C0;function H9(n,e){return Ou.get(n)===e}qr.hasPointerCapture=H9;function j9(n,e){rS(n),e.getStage()&&(Ou.set(n,e),iS&&e._fire("gotpointercapture",C0(new PointerEvent("gotpointercapture"))))}qr.setPointerCapture=j9;function rS(n,e){const t=Ou.get(n);if(!t)return;const i=t.getStage();i&&i.content,Ou.delete(n),iS&&t._fire("lostpointercapture",C0(new PointerEvent("lostpointercapture")))}qr.releaseCapture=rS;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Stage=n.stages=void 0;const e=Ci,t=mt,i=ko,r=gt,s=kn,a=Lf,l=gt,o=qr;var c="Stage",u="string",h="px",d="mouseout",f="mouseleave",_="mouseover",p="mouseenter",v="mousemove",E="mousedown",g="mouseup",m="pointermove",y="pointerdown",T="pointerup",b="pointercancel",C="lostpointercapture",M="pointerout",F="pointerleave",P="pointerover",U="pointerenter",G="contextmenu",K="touchstart",q="touchend",se="touchmove",Ee="touchcancel",Se="wheel",$=5,_e=[[p,"_pointerenter"],[E,"_pointerdown"],[v,"_pointermove"],[g,"_pointerup"],[f,"_pointerleave"],[K,"_pointerdown"],[se,"_pointermove"],[q,"_pointerup"],[Ee,"_pointercancel"],[_,"_pointerover"],[Se,"_wheel"],[G,"_contextmenu"],[y,"_pointerdown"],[m,"_pointermove"],[T,"_pointerup"],[b,"_pointercancel"],[C,"_lostpointercapture"]];const ae={mouse:{[M]:d,[F]:f,[P]:_,[U]:p,[m]:v,[y]:E,[T]:g,[b]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[M]:"touchout",[F]:"touchleave",[P]:"touchover",[U]:"touchenter",[m]:se,[y]:K,[T]:q,[b]:Ee,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[M]:M,[F]:F,[P]:P,[U]:U,[m]:m,[y]:y,[T]:T,[b]:b,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ce=Ze=>Ze.indexOf("pointer")>=0?"pointer":Ze.indexOf("touch")>=0?"touch":"mouse",he=Ze=>{const W=ce(Ze);if(W==="pointer")return r.Konva.pointerEventsEnabled&&ae.pointer;if(W==="touch")return ae.touch;if(W==="mouse")return ae.mouse};function je(Ze={}){return(Ze.clipFunc||Ze.clipWidth||Ze.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),Ze}const Xe="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";n.stages=[];class Tt extends i.Container{constructor(W){super(je(W)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),n.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{je(this.attrs)}),this._checkVisibility()}_validateAdd(W){const pe=W.getType()==="Layer",De=W.getType()==="FastLayer";pe||De||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const W=this.visible()?"":"none";this.content.style.display=W}setContainer(W){if(typeof W===u){if(W.charAt(0)==="."){var pe=W.slice(1);W=document.getElementsByClassName(pe)[0]}else{var De;W.charAt(0)!=="#"?De=W:De=W.slice(1),W=document.getElementById(De)}if(!W)throw"Can not find container in document with id "+De}return this._setAttr("container",W),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),W.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var W=this.children,pe=W.length,De;for(De=0;De<pe;De++)W[De].clear();return this}clone(W){return W||(W={}),W.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,W)}destroy(){super.destroy();var W=this.content;W&&e.Util._isInDocument(W)&&this.container().removeChild(W);var pe=n.stages.indexOf(this);return pe>-1&&n.stages.splice(pe,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const W=this._pointerPositions[0]||this._changedPointerPositions[0];return W?{x:W.x,y:W.y}:(e.Util.warn(Xe),null)}_getPointerById(W){return this._pointerPositions.find(pe=>pe.id===W)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(W){W=W||{},W.x=W.x||0,W.y=W.y||0,W.width=W.width||this.width(),W.height=W.height||this.height();var pe=new s.SceneCanvas({width:W.width,height:W.height,pixelRatio:W.pixelRatio||1}),De=pe.getContext()._context,ft=this.children;return(W.x||W.y)&&De.translate(-1*W.x,-1*W.y),ft.forEach(function(st){if(st.isVisible()){var $e=st._toKonvaCanvas(W);De.drawImage($e._canvas,W.x,W.y,$e.getWidth()/$e.getPixelRatio(),$e.getHeight()/$e.getPixelRatio())}}),pe}getIntersection(W){if(!W)return null;var pe=this.children,De=pe.length,ft=De-1,st;for(st=ft;st>=0;st--){const $e=pe[st].getIntersection(W);if($e)return $e}return null}_resizeDOM(){var W=this.width(),pe=this.height();this.content&&(this.content.style.width=W+h,this.content.style.height=pe+h),this.bufferCanvas.setSize(W,pe),this.bufferHitCanvas.setSize(W,pe),this.children.forEach(De=>{De.setSize({width:W,height:pe}),De.draw()})}add(W,...pe){if(arguments.length>1){for(var De=0;De<arguments.length;De++)this.add(arguments[De]);return this}super.add(W);var ft=this.children.length;return ft>$&&e.Util.warn("The stage has "+ft+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),W.setSize({width:this.width(),height:this.height()}),W.draw(),r.Konva.isBrowser&&this.content.appendChild(W.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(W){return o.hasPointerCapture(W,this)}setPointerCapture(W){o.setPointerCapture(W,this)}releaseCapture(W){o.releaseCapture(W,this)}getLayers(){return this.children}_bindContentEvents(){r.Konva.isBrowser&&_e.forEach(([W,pe])=>{this.content.addEventListener(W,De=>{this[pe](De)},{passive:!1})})}_pointerenter(W){this.setPointersPositions(W);const pe=he(W.type);pe&&this._fire(pe.pointerenter,{evt:W,target:this,currentTarget:this})}_pointerover(W){this.setPointersPositions(W);const pe=he(W.type);pe&&this._fire(pe.pointerover,{evt:W,target:this,currentTarget:this})}_getTargetShape(W){let pe=this[W+"targetShape"];return pe&&!pe.getStage()&&(pe=null),pe}_pointerleave(W){const pe=he(W.type),De=ce(W.type);if(pe){this.setPointersPositions(W);var ft=this._getTargetShape(De),st=!(r.Konva.isDragging()||r.Konva.isTransforming())||r.Konva.hitOnDragEnabled;ft&&st?(ft._fireAndBubble(pe.pointerout,{evt:W}),ft._fireAndBubble(pe.pointerleave,{evt:W}),this._fire(pe.pointerleave,{evt:W,target:this,currentTarget:this}),this[De+"targetShape"]=null):st&&(this._fire(pe.pointerleave,{evt:W,target:this,currentTarget:this}),this._fire(pe.pointerout,{evt:W,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}}_pointerdown(W){const pe=he(W.type),De=ce(W.type);if(pe){this.setPointersPositions(W);var ft=!1;this._changedPointerPositions.forEach(st=>{var $e=this.getIntersection(st);if(a.DD.justDragged=!1,r.Konva["_"+De+"ListenClick"]=!0,!$e||!$e.isListening()){this[De+"ClickStartShape"]=void 0;return}r.Konva.capturePointerEventsEnabled&&$e.setPointerCapture(st.id),this[De+"ClickStartShape"]=$e,$e._fireAndBubble(pe.pointerdown,{evt:W,pointerId:st.id}),ft=!0;const bt=W.type.indexOf("touch")>=0;$e.preventDefault()&&W.cancelable&&bt&&W.preventDefault()}),ft||this._fire(pe.pointerdown,{evt:W,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(W){const pe=he(W.type),De=ce(W.type);if(!pe)return;r.Konva.isDragging()&&a.DD.node.preventDefault()&&W.cancelable&&W.preventDefault(),this.setPointersPositions(W);var ft=!(r.Konva.isDragging()||r.Konva.isTransforming())||r.Konva.hitOnDragEnabled;if(!ft)return;var st={};let $e=!1;var bt=this._getTargetShape(De);this._changedPointerPositions.forEach(Wt=>{const rt=o.getCapturedShape(Wt.id)||this.getIntersection(Wt),Ht=Wt.id,Ni={evt:W,pointerId:Ht};var Ar=bt!==rt;if(Ar&&bt&&(bt._fireAndBubble(pe.pointerout,{...Ni},rt),bt._fireAndBubble(pe.pointerleave,{...Ni},rt)),rt){if(st[rt._id])return;st[rt._id]=!0}rt&&rt.isListening()?($e=!0,Ar&&(rt._fireAndBubble(pe.pointerover,{...Ni},bt),rt._fireAndBubble(pe.pointerenter,{...Ni},bt),this[De+"targetShape"]=rt),rt._fireAndBubble(pe.pointermove,{...Ni})):bt&&(this._fire(pe.pointerover,{evt:W,target:this,currentTarget:this,pointerId:Ht}),this[De+"targetShape"]=null)}),$e||this._fire(pe.pointermove,{evt:W,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(W){const pe=he(W.type),De=ce(W.type);if(!pe)return;this.setPointersPositions(W);const ft=this[De+"ClickStartShape"],st=this[De+"ClickEndShape"];var $e={};let bt=!1;this._changedPointerPositions.forEach(Wt=>{const rt=o.getCapturedShape(Wt.id)||this.getIntersection(Wt);if(rt){if(rt.releaseCapture(Wt.id),$e[rt._id])return;$e[rt._id]=!0}const Ht=Wt.id,Ni={evt:W,pointerId:Ht};let Ar=!1;r.Konva["_"+De+"InDblClickWindow"]?(Ar=!0,clearTimeout(this[De+"DblTimeout"])):a.DD.justDragged||(r.Konva["_"+De+"InDblClickWindow"]=!0,clearTimeout(this[De+"DblTimeout"])),this[De+"DblTimeout"]=setTimeout(function(){r.Konva["_"+De+"InDblClickWindow"]=!1},r.Konva.dblClickWindow),rt&&rt.isListening()?(bt=!0,this[De+"ClickEndShape"]=rt,rt._fireAndBubble(pe.pointerup,{...Ni}),r.Konva["_"+De+"ListenClick"]&&ft&&ft===rt&&(rt._fireAndBubble(pe.pointerclick,{...Ni}),Ar&&st&&st===rt&&rt._fireAndBubble(pe.pointerdblclick,{...Ni}))):(this[De+"ClickEndShape"]=null,r.Konva["_"+De+"ListenClick"]&&this._fire(pe.pointerclick,{evt:W,target:this,currentTarget:this,pointerId:Ht}),Ar&&this._fire(pe.pointerdblclick,{evt:W,target:this,currentTarget:this,pointerId:Ht}))}),bt||this._fire(pe.pointerup,{evt:W,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),r.Konva["_"+De+"ListenClick"]=!1,W.cancelable&&De!=="touch"&&W.preventDefault()}_contextmenu(W){this.setPointersPositions(W);var pe=this.getIntersection(this.getPointerPosition());pe&&pe.isListening()?pe._fireAndBubble(G,{evt:W}):this._fire(G,{evt:W,target:this,currentTarget:this})}_wheel(W){this.setPointersPositions(W);var pe=this.getIntersection(this.getPointerPosition());pe&&pe.isListening()?pe._fireAndBubble(Se,{evt:W}):this._fire(Se,{evt:W,target:this,currentTarget:this})}_pointercancel(W){this.setPointersPositions(W);const pe=o.getCapturedShape(W.pointerId)||this.getIntersection(this.getPointerPosition());pe&&pe._fireAndBubble(T,o.createEvent(W)),o.releaseCapture(W.pointerId)}_lostpointercapture(W){o.releaseCapture(W.pointerId)}setPointersPositions(W){var pe=this._getContentPosition(),De=null,ft=null;W=W||window.event,W.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(W.touches,st=>{this._pointerPositions.push({id:st.identifier,x:(st.clientX-pe.left)/pe.scaleX,y:(st.clientY-pe.top)/pe.scaleY})}),Array.prototype.forEach.call(W.changedTouches||W.touches,st=>{this._changedPointerPositions.push({id:st.identifier,x:(st.clientX-pe.left)/pe.scaleX,y:(st.clientY-pe.top)/pe.scaleY})})):(De=(W.clientX-pe.left)/pe.scaleX,ft=(W.clientY-pe.top)/pe.scaleY,this.pointerPos={x:De,y:ft},this._pointerPositions=[{x:De,y:ft,id:e.Util._getFirstPointerId(W)}],this._changedPointerPositions=[{x:De,y:ft,id:e.Util._getFirstPointerId(W)}])}_setPointerPosition(W){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(W)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var W=this.content.getBoundingClientRect();return{top:W.top,left:W.left,scaleX:W.width/this.content.clientWidth||1,scaleY:W.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!!r.Konva.isBrowser){var W=this.container();if(!W)throw"Stage has no container. A container is required.";W.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),W.appendChild(this.content),this._resizeDOM()}}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(W){W.batchDraw()}),this}}n.Stage=Tt,Tt.prototype.nodeType=c,(0,l._registerNode)(Tt),t.Factory.addGetterSetter(Tt,"container")})(tS);var Qu={},er={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Shape=n.shapes=void 0;const e=gt,t=Ci,i=mt,r=gi,s=We,a=gt,l=qr;var o="hasShadow",c="shadowRGBA",u="patternImage",h="linearGradient",d="radialGradient";let f;function _(){return f||(f=t.Util.createCanvasElement().getContext("2d"),f)}n.shapes={};function p(F){const P=this.attrs.fillRule;P?F.fill(P):F.fill()}function v(F){F.stroke()}function E(F){F.fill()}function g(F){F.stroke()}function m(){this._clearCache(o)}function y(){this._clearCache(c)}function T(){this._clearCache(u)}function b(){this._clearCache(h)}function C(){this._clearCache(d)}class M extends r.Node{constructor(P){super(P);let U;for(;U=t.Util.getRandomColor(),!(U&&!(U in n.shapes)););this.colorKey=U,n.shapes[U]=this}getContext(){return t.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return t.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(o,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(u,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var P=_();const U=P.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(U&&U.setTransform){const G=new t.Transform;G.translate(this.fillPatternX(),this.fillPatternY()),G.rotate(e.Konva.getAngle(this.fillPatternRotation())),G.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),G.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const K=G.getMatrix(),q=typeof DOMMatrix>"u"?{a:K[0],b:K[1],c:K[2],d:K[3],e:K[4],f:K[5]}:new DOMMatrix(K);U.setTransform(q)}return U}}_getLinearGradient(){return this._getCache(h,this.__getLinearGradient)}__getLinearGradient(){var P=this.fillLinearGradientColorStops();if(P){for(var U=_(),G=this.fillLinearGradientStartPoint(),K=this.fillLinearGradientEndPoint(),q=U.createLinearGradient(G.x,G.y,K.x,K.y),se=0;se<P.length;se+=2)q.addColorStop(P[se],P[se+1]);return q}}_getRadialGradient(){return this._getCache(d,this.__getRadialGradient)}__getRadialGradient(){var P=this.fillRadialGradientColorStops();if(P){for(var U=_(),G=this.fillRadialGradientStartPoint(),K=this.fillRadialGradientEndPoint(),q=U.createRadialGradient(G.x,G.y,this.fillRadialGradientStartRadius(),K.x,K.y,this.fillRadialGradientEndRadius()),se=0;se<P.length;se+=2)q.addColorStop(P[se],P[se+1]);return q}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var P=t.Util.colorToRGBA(this.shadowColor());if(P)return"rgba("+P.r+","+P.g+","+P.b+","+P.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const P=this.hitStrokeWidth();return P==="auto"?this.hasStroke():this.strokeEnabled()&&!!P}intersects(P){var U=this.getStage();if(!U)return!1;const G=U.bufferHitCanvas;return G.getContext().clear(),this.drawHit(G,void 0,!0),G.context.getImageData(Math.round(P.x),Math.round(P.y),1,1).data[3]>0}destroy(){return r.Node.prototype.destroy.call(this),delete n.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(P){var U;if(!((U=this.attrs.perfectDrawEnabled)!==null&&U!==void 0?U:!0))return!1;const K=P||this.hasFill(),q=this.hasStroke(),se=this.getAbsoluteOpacity()!==1;if(K&&q&&se)return!0;const Ee=this.hasShadow(),Se=this.shadowForStrokeEnabled();return!!(K&&q&&Ee&&Se)}setStrokeHitEnabled(P){t.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),P?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){var P=this.size();return{x:this._centroid?-P.width/2:0,y:this._centroid?-P.height/2:0,width:P.width,height:P.height}}getClientRect(P={}){const U=P.skipTransform,G=P.relativeTo,K=this.getSelfRect(),se=!P.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,Ee=K.width+se,Se=K.height+se,$=!P.skipShadow&&this.hasShadow(),_e=$?this.shadowOffsetX():0,ae=$?this.shadowOffsetY():0,ce=Ee+Math.abs(_e),he=Se+Math.abs(ae),je=$&&this.shadowBlur()||0,Xe=ce+je*2,Tt=he+je*2,Ze={width:Xe,height:Tt,x:-(se/2+je)+Math.min(_e,0)+K.x,y:-(se/2+je)+Math.min(ae,0)+K.y};return U?Ze:this._transformedRect(Ze,G)}drawScene(P,U,G){var K=this.getLayer(),q=P||K.getCanvas(),se=q.getContext(),Ee=this._getCanvasCache(),Se=this.getSceneFunc(),$=this.hasShadow(),_e,ae,ce=q.isCache,he=U===this;if(!this.isVisible()&&!he)return this;if(Ee){se.save();var je=this.getAbsoluteTransform(U).getMatrix();return se.transform(je[0],je[1],je[2],je[3],je[4],je[5]),this._drawCachedSceneCanvas(se),se.restore(),this}if(!Se)return this;if(se.save(),this._useBufferCanvas()&&!ce){_e=this.getStage();const Ze=G||_e.bufferCanvas;ae=Ze.getContext(),ae.clear(),ae.save(),ae._applyLineJoin(this);var Xe=this.getAbsoluteTransform(U).getMatrix();ae.transform(Xe[0],Xe[1],Xe[2],Xe[3],Xe[4],Xe[5]),Se.call(this,ae,this),ae.restore();var Tt=Ze.pixelRatio;$&&se._applyShadow(this),se._applyOpacity(this),se._applyGlobalCompositeOperation(this),se.drawImage(Ze._canvas,0,0,Ze.width/Tt,Ze.height/Tt)}else{if(se._applyLineJoin(this),!he){var Xe=this.getAbsoluteTransform(U).getMatrix();se.transform(Xe[0],Xe[1],Xe[2],Xe[3],Xe[4],Xe[5]),se._applyOpacity(this),se._applyGlobalCompositeOperation(this)}$&&se._applyShadow(this),Se.call(this,se,this)}return se.restore(),this}drawHit(P,U,G=!1){if(!this.shouldDrawHit(U,G))return this;var K=this.getLayer(),q=P||K.hitCanvas,se=q&&q.getContext(),Ee=this.hitFunc()||this.sceneFunc(),Se=this._getCanvasCache(),$=Se&&Se.hit;if(this.colorKey||t.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),$){se.save();var _e=this.getAbsoluteTransform(U).getMatrix();return se.transform(_e[0],_e[1],_e[2],_e[3],_e[4],_e[5]),this._drawCachedHitCanvas(se),se.restore(),this}if(!Ee)return this;if(se.save(),se._applyLineJoin(this),!(this===U)){var ce=this.getAbsoluteTransform(U).getMatrix();se.transform(ce[0],ce[1],ce[2],ce[3],ce[4],ce[5])}return Ee.call(this,se,this),se.restore(),this}drawHitFromCache(P=0){var U=this._getCanvasCache(),G=this._getCachedSceneCanvas(),K=U.hit,q=K.getContext(),se=K.getWidth(),Ee=K.getHeight(),Se,$,_e,ae,ce,he;q.clear(),q.drawImage(G._canvas,0,0,se,Ee);try{for(Se=q.getImageData(0,0,se,Ee),$=Se.data,_e=$.length,ae=t.Util._hexToRgb(this.colorKey),ce=0;ce<_e;ce+=4)he=$[ce+3],he>P?($[ce]=ae.r,$[ce+1]=ae.g,$[ce+2]=ae.b,$[ce+3]=255):$[ce+3]=0;q.putImageData(Se,0,0)}catch(je){t.Util.error("Unable to draw hit graph from cached scene canvas. "+je.message)}return this}hasPointerCapture(P){return l.hasPointerCapture(P,this)}setPointerCapture(P){l.setPointerCapture(P,this)}releaseCapture(P){l.releaseCapture(P,this)}}n.Shape=M,M.prototype._fillFunc=p,M.prototype._strokeFunc=v,M.prototype._fillFuncHit=E,M.prototype._strokeFuncHit=g,M.prototype._centroid=!1,M.prototype.nodeType="Shape",(0,a._registerNode)(M),M.prototype.eventListeners={},M.prototype.on.call(M.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",m),M.prototype.on.call(M.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",y),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",T),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",b),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",C),i.Factory.addGetterSetter(M,"stroke",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(M,"strokeWidth",2,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(M,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(M,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(M,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(M,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(M,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(M,"lineJoin"),i.Factory.addGetterSetter(M,"lineCap"),i.Factory.addGetterSetter(M,"sceneFunc"),i.Factory.addGetterSetter(M,"hitFunc"),i.Factory.addGetterSetter(M,"dash"),i.Factory.addGetterSetter(M,"dashOffset",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(M,"shadowColor",void 0,(0,s.getStringValidator)()),i.Factory.addGetterSetter(M,"shadowBlur",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(M,"shadowOpacity",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(M,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(M,"shadowOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(M,"shadowOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(M,"fillPatternImage"),i.Factory.addGetterSetter(M,"fill",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(M,"fillPatternX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(M,"fillPatternY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(M,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(M,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(M,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(M,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(M,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(M,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(M,"fillEnabled",!0),i.Factory.addGetterSetter(M,"strokeEnabled",!0),i.Factory.addGetterSetter(M,"shadowEnabled",!0),i.Factory.addGetterSetter(M,"dashEnabled",!0),i.Factory.addGetterSetter(M,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(M,"fillPriority","color"),i.Factory.addComponentsGetterSetter(M,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(M,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(M,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(M,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(M,"fillPatternScaleX",1,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(M,"fillPatternScaleY",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(M,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(M,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(M,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(M,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(M,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(M,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(M,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(M,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(M,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(M,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(M,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(M,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(M,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(M,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(M,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(M,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(M,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(M,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(M,"fillPatternRotation",0),i.Factory.addGetterSetter(M,"fillRule",void 0,(0,s.getStringValidator)()),i.Factory.backCompat(M,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(er);Object.defineProperty(Qu,"__esModule",{value:!0});Qu.Layer=void 0;const Es=Ci,hp=ko,rl=gi,A0=mt,tT=kn,X9=We,Y9=er,K9=gt;var q9="#",$9="beforeDraw",Q9="draw",nS=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],Z9=nS.length;class oc extends hp.Container{constructor(e){super(e),this.canvas=new tT.SceneCanvas,this.hitCanvas=new tT.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),e<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[e+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){rl.Node.prototype.moveToTop.call(this);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var e=rl.Node.prototype.moveUp.call(this);if(!e)return!1;var t=this.getStage();return!t||!t.content?!1:(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(rl.Node.prototype.moveDown.call(this)){var e=this.getStage();if(e){var t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(rl.Node.prototype.moveToBottom.call(this)){var e=this.getStage();if(e){var t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var e=this.getNativeCanvasElement();return rl.Node.prototype.remove.call(this),e&&e.parentNode&&Es.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:t}){return this.canvas.setSize(e,t),this.hitCanvas.setSize(e,t),this._setSmoothEnabled(),this}_validateAdd(e){var t=e.getType();t!=="Group"&&t!=="Shape"&&Es.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),rl.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Es.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Es.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Es.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;for(var t=1,i=!1;;){for(let r=0;r<Z9;r++){const s=nS[r],a=this._getIntersection({x:e.x+s.x*t,y:e.y+s.y*t}),l=a.shape;if(l)return l;if(i=!!a.antialiased,!a.antialiased)break}if(i)t+=1;else return null}}_getIntersection(e){const t=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(e.x*t),Math.round(e.y*t),1,1).data,r=i[3];if(r===255){const s=Es.Util._rgbToHex(i[0],i[1],i[2]),a=Y9.shapes[q9+s];return a?{shape:a}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(e,t){var i=this.getLayer(),r=e||i&&i.getCanvas();return this._fire($9,{node:this}),this.clearBeforeDraw()&&r.getContext().clear(),hp.Container.prototype.drawScene.call(this,r,t),this._fire(Q9,{node:this}),this}drawHit(e,t){var i=this.getLayer(),r=e||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),hp.Container.prototype.drawHit.call(this,r,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Es.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Es.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!(!this.parent||!this.parent.content)){var e=this.parent,t=!!this.hitCanvas._canvas.parentNode;t?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}}destroy(){return Es.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}Qu.Layer=oc;oc.prototype.nodeType="Layer";(0,K9._registerNode)(oc);A0.Factory.addGetterSetter(oc,"imageSmoothingEnabled",!0);A0.Factory.addGetterSetter(oc,"clearBeforeDraw",!0);A0.Factory.addGetterSetter(oc,"hitGraphEnabled",!0,(0,X9.getBooleanValidator)());var Ff={};Object.defineProperty(Ff,"__esModule",{value:!0});Ff.FastLayer=void 0;const J9=Ci,eV=Qu,tV=gt;class S0 extends eV.Layer{constructor(e){super(e),this.listening(!1),J9.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}Ff.FastLayer=S0;S0.prototype.nodeType="FastLayer";(0,tV._registerNode)(S0);var lc={};Object.defineProperty(lc,"__esModule",{value:!0});lc.Group=void 0;const iV=Ci,rV=ko,nV=gt;class R0 extends rV.Container{_validateAdd(e){var t=e.getType();t!=="Group"&&t!=="Shape"&&iV.Util.throw("You may only add groups and shapes to groups.")}}lc.Group=R0;R0.prototype.nodeType="Group";(0,nV._registerNode)(R0);var cc={};Object.defineProperty(cc,"__esModule",{value:!0});cc.Animation=void 0;const dp=gt,iT=Ci,fp=function(){return dp.glob.performance&&dp.glob.performance.now?function(){return dp.glob.performance.now()}:function(){return new Date().getTime()}}();class ts{constructor(e,t){this.id=ts.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:fp(),frameRate:0},this.func=e,this.setLayers(t)}setLayers(e){let t=[];return e&&(t=Array.isArray(e)?e:[e]),this.layers=t,this}getLayers(){return this.layers}addLayer(e){const t=this.layers,i=t.length;for(let r=0;r<i;r++)if(t[r]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const t=ts.animations,i=t.length;for(let r=0;r<i;r++)if(t[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=fp(),ts._addAnimation(this),this}stop(){return ts._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const t=e.id,i=this.animations,r=i.length;for(let s=0;s<r;s++)if(i[s].id===t){this.animations.splice(s,1);break}}static _runFrames(){const e={},t=this.animations;for(let i=0;i<t.length;i++){const r=t[i],s=r.layers,a=r.func;r._updateFrameObject(fp());const l=s.length;let o;if(a?o=a.call(r,r.frame)!==!1:o=!0,!!o)for(let c=0;c<l;c++){const u=s[c];u._id!==void 0&&(e[u._id]=u)}}for(let i in e)e.hasOwnProperty(i)&&e[i].batchDraw()}static _animationLoop(){const e=ts;e.animations.length?(e._runFrames(),iT.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,iT.Util.requestAnimFrame(this._animationLoop))}}cc.Animation=ts;ts.animations=[];ts.animIdCounter=0;ts.animRunning=!1;var sS={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Easings=n.Tween=void 0;const e=Ci,t=cc,i=gi,r=gt;var s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},a=1,l=2,o=3,c=0,u=["fill","stroke","shadowColor"];class h{constructor(_,p,v,E,g,m,y){this.prop=_,this.propFunc=p,this.begin=E,this._pos=E,this.duration=m,this._change=0,this.prevPos=0,this.yoyo=y,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=v,this._change=g-this.begin,this.pause()}fire(_){var p=this[_];p&&p()}setTime(_){_>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():_<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=_,this.update())}getTime(){return this._time}setPosition(_){this.prevPos=this._pos,this.propFunc(_),this._pos=_}getPosition(_){return _===void 0&&(_=this._time),this.func(_,this.begin,this._change,this.duration)}play(){this.state=l,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=o,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(_){this.pause(),this._time=_,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var _=this.getTimer()-this._startTime;this.state===l?this.setTime(_):this.state===o&&this.setTime(this.duration-_)}pause(){this.state=a,this.fire("onPause")}getTimer(){return new Date().getTime()}}class d{constructor(_){var p=this,v=_.node,E=v._id,g,m=_.easing||n.Easings.Linear,y=!!_.yoyo,T;typeof _.duration>"u"?g=.3:_.duration===0?g=.001:g=_.duration,this.node=v,this._id=c++;var b=v.getLayer()||(v instanceof r.Konva.Stage?v.getLayers():null);b||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new t.Animation(function(){p.tween.onEnterFrame()},b),this.tween=new h(T,function(C){p._tweenFunc(C)},m,0,1,g*1e3,y),this._addListeners(),d.attrs[E]||(d.attrs[E]={}),d.attrs[E][this._id]||(d.attrs[E][this._id]={}),d.tweens[E]||(d.tweens[E]={});for(T in _)s[T]===void 0&&this._addAttr(T,_[T]);this.reset(),this.onFinish=_.onFinish,this.onReset=_.onReset,this.onUpdate=_.onUpdate}_addAttr(_,p){var v=this.node,E=v._id,g,m,y,T,b,C,M,F;if(y=d.tweens[E][_],y&&delete d.attrs[E][y][_],g=v.getAttr(_),e.Util._isArray(p))if(m=[],b=Math.max(p.length,g.length),_==="points"&&p.length!==g.length&&(p.length>g.length?(M=g,g=e.Util._prepareArrayForTween(g,p,v.closed())):(C=p,p=e.Util._prepareArrayForTween(p,g,v.closed()))),_.indexOf("fill")===0)for(T=0;T<b;T++)if(T%2===0)m.push(p[T]-g[T]);else{var P=e.Util.colorToRGBA(g[T]);F=e.Util.colorToRGBA(p[T]),g[T]=P,m.push({r:F.r-P.r,g:F.g-P.g,b:F.b-P.b,a:F.a-P.a})}else for(T=0;T<b;T++)m.push(p[T]-g[T]);else u.indexOf(_)!==-1?(g=e.Util.colorToRGBA(g),F=e.Util.colorToRGBA(p),m={r:F.r-g.r,g:F.g-g.g,b:F.b-g.b,a:F.a-g.a}):m=p-g;d.attrs[E][this._id][_]={start:g,diff:m,end:p,trueEnd:C,trueStart:M},d.tweens[E][_]=this._id}_tweenFunc(_){var p=this.node,v=d.attrs[p._id][this._id],E,g,m,y,T,b,C,M;for(E in v){if(g=v[E],m=g.start,y=g.diff,M=g.end,e.Util._isArray(m))if(T=[],C=Math.max(m.length,M.length),E.indexOf("fill")===0)for(b=0;b<C;b++)b%2===0?T.push((m[b]||0)+y[b]*_):T.push("rgba("+Math.round(m[b].r+y[b].r*_)+","+Math.round(m[b].g+y[b].g*_)+","+Math.round(m[b].b+y[b].b*_)+","+(m[b].a+y[b].a*_)+")");else for(b=0;b<C;b++)T.push((m[b]||0)+y[b]*_);else u.indexOf(E)!==-1?T="rgba("+Math.round(m.r+y.r*_)+","+Math.round(m.g+y.g*_)+","+Math.round(m.b+y.b*_)+","+(m.a+y.a*_)+")":T=m+y*_;p.setAttr(E,T)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var _=this.node,p=d.attrs[_._id][this._id];p.points&&p.points.trueEnd&&_.setAttr("points",p.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var _=this.node,p=d.attrs[_._id][this._id];p.points&&p.points.trueStart&&_.points(p.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(_){return this.tween.seek(_*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var _=this.node._id,p=this._id,v=d.tweens[_],E;this.pause();for(E in v)delete d.tweens[_][E];delete d.attrs[_][p]}}n.Tween=d,d.attrs={},d.tweens={},i.Node.prototype.to=function(f){var _=f.onFinish;f.node=this,f.onFinish=function(){this.destroy(),_&&_()};var p=new d(f);p.play()},n.Easings={BackEaseIn(f,_,p,v){var E=1.70158;return p*(f/=v)*f*((E+1)*f-E)+_},BackEaseOut(f,_,p,v){var E=1.70158;return p*((f=f/v-1)*f*((E+1)*f+E)+1)+_},BackEaseInOut(f,_,p,v){var E=1.70158;return(f/=v/2)<1?p/2*(f*f*(((E*=1.525)+1)*f-E))+_:p/2*((f-=2)*f*(((E*=1.525)+1)*f+E)+2)+_},ElasticEaseIn(f,_,p,v,E,g){var m=0;return f===0?_:(f/=v)===1?_+p:(g||(g=v*.3),!E||E<Math.abs(p)?(E=p,m=g/4):m=g/(2*Math.PI)*Math.asin(p/E),-(E*Math.pow(2,10*(f-=1))*Math.sin((f*v-m)*(2*Math.PI)/g))+_)},ElasticEaseOut(f,_,p,v,E,g){var m=0;return f===0?_:(f/=v)===1?_+p:(g||(g=v*.3),!E||E<Math.abs(p)?(E=p,m=g/4):m=g/(2*Math.PI)*Math.asin(p/E),E*Math.pow(2,-10*f)*Math.sin((f*v-m)*(2*Math.PI)/g)+p+_)},ElasticEaseInOut(f,_,p,v,E,g){var m=0;return f===0?_:(f/=v/2)===2?_+p:(g||(g=v*(.3*1.5)),!E||E<Math.abs(p)?(E=p,m=g/4):m=g/(2*Math.PI)*Math.asin(p/E),f<1?-.5*(E*Math.pow(2,10*(f-=1))*Math.sin((f*v-m)*(2*Math.PI)/g))+_:E*Math.pow(2,-10*(f-=1))*Math.sin((f*v-m)*(2*Math.PI)/g)*.5+p+_)},BounceEaseOut(f,_,p,v){return(f/=v)<1/2.75?p*(7.5625*f*f)+_:f<2/2.75?p*(7.5625*(f-=1.5/2.75)*f+.75)+_:f<2.5/2.75?p*(7.5625*(f-=2.25/2.75)*f+.9375)+_:p*(7.5625*(f-=2.625/2.75)*f+.984375)+_},BounceEaseIn(f,_,p,v){return p-n.Easings.BounceEaseOut(v-f,0,p,v)+_},BounceEaseInOut(f,_,p,v){return f<v/2?n.Easings.BounceEaseIn(f*2,0,p,v)*.5+_:n.Easings.BounceEaseOut(f*2-v,0,p,v)*.5+p*.5+_},EaseIn(f,_,p,v){return p*(f/=v)*f+_},EaseOut(f,_,p,v){return-p*(f/=v)*(f-2)+_},EaseInOut(f,_,p,v){return(f/=v/2)<1?p/2*f*f+_:-p/2*(--f*(f-2)-1)+_},StrongEaseIn(f,_,p,v){return p*(f/=v)*f*f*f*f+_},StrongEaseOut(f,_,p,v){return p*((f=f/v-1)*f*f*f*f+1)+_},StrongEaseInOut(f,_,p,v){return(f/=v/2)<1?p/2*f*f*f*f*f+_:p/2*((f-=2)*f*f*f*f+2)+_},Linear(f,_,p,v){return p*f/v+_}}})(sS);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Konva=void 0;const e=gt,t=Ci,i=gi,r=ko,s=tS,a=Qu,l=Ff,o=lc,c=Lf,u=er,h=cc,d=sS,f=Ns,_=kn;n.Konva=t.Util._assign(e.Konva,{Util:t.Util,Transform:t.Transform,Node:i.Node,Container:r.Container,Stage:s.Stage,stages:s.stages,Layer:a.Layer,FastLayer:l.FastLayer,Group:o.Group,DD:c.DD,Shape:u.Shape,shapes:u.shapes,Animation:h.Animation,Tween:d.Tween,Easings:d.Easings,Context:f.Context,Canvas:_.Canvas}),n.default=n.Konva})(QA);var kf={};Object.defineProperty(kf,"__esModule",{value:!0});kf.Arc=void 0;const Bf=mt,sV=er,rT=gt,Uf=We,aV=gt;class Ks extends sV.Shape{_sceneFunc(e){var t=rT.Konva.getAngle(this.angle()),i=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,t,i),e.arc(0,0,this.innerRadius(),t,0,!i),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),t=this.outerRadius(),i=this.clockwise(),r=rT.Konva.getAngle(i?360-this.angle():this.angle()),s=Math.cos(Math.min(r,Math.PI)),a=1,l=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),o=Math.sin(Math.min(r,Math.PI/2)),c=s*(s>0?e:t),u=a*t,h=l*(l>0?e:t),d=o*(o>0?t:e);return{x:c,y:i?-1*d:h,width:u-c,height:d-h}}}kf.Arc=Ks;Ks.prototype._centroid=!0;Ks.prototype.className="Arc";Ks.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,aV._registerNode)(Ks);Bf.Factory.addGetterSetter(Ks,"innerRadius",0,(0,Uf.getNumberValidator)());Bf.Factory.addGetterSetter(Ks,"outerRadius",0,(0,Uf.getNumberValidator)());Bf.Factory.addGetterSetter(Ks,"angle",0,(0,Uf.getNumberValidator)());Bf.Factory.addGetterSetter(Ks,"clockwise",!1,(0,Uf.getBooleanValidator)());var zf={},Zu={};Object.defineProperty(Zu,"__esModule",{value:!0});Zu.Line=void 0;const Vf=mt,oV=er,aS=We,lV=gt;function Bg(n,e,t,i,r,s,a){var l=Math.sqrt(Math.pow(t-n,2)+Math.pow(i-e,2)),o=Math.sqrt(Math.pow(r-t,2)+Math.pow(s-i,2)),c=a*l/(l+o),u=a*o/(l+o),h=t-c*(r-n),d=i-c*(s-e),f=t+u*(r-n),_=i+u*(s-e);return[h,d,f,_]}function nT(n,e){var t=n.length,i=[],r,s;for(r=2;r<t-2;r+=2)s=Bg(n[r-2],n[r-1],n[r],n[r+1],n[r+2],n[r+3],e),!isNaN(s[0])&&(i.push(s[0]),i.push(s[1]),i.push(n[r]),i.push(n[r+1]),i.push(s[2]),i.push(s[3]));return i}class ja extends oV.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){var t=this.points(),i=t.length,r=this.tension(),s=this.closed(),a=this.bezier(),l,o,c;if(i){if(e.beginPath(),e.moveTo(t[0],t[1]),r!==0&&i>4){for(l=this.getTensionPoints(),o=l.length,c=s?0:4,s||e.quadraticCurveTo(l[0],l[1],l[2],l[3]);c<o-2;)e.bezierCurveTo(l[c++],l[c++],l[c++],l[c++],l[c++],l[c++]);s||e.quadraticCurveTo(l[o-2],l[o-1],t[i-2],t[i-1])}else if(a)for(c=2;c<i;)e.bezierCurveTo(t[c++],t[c++],t[c++],t[c++],t[c++],t[c++]);else for(c=2;c<i;c+=2)e.lineTo(t[c],t[c+1]);s?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():nT(this.points(),this.tension())}_getTensionPointsClosed(){var e=this.points(),t=e.length,i=this.tension(),r=Bg(e[t-2],e[t-1],e[0],e[1],e[2],e[3],i),s=Bg(e[t-4],e[t-3],e[t-2],e[t-1],e[0],e[1],i),a=nT(e,i),l=[r[2],r[3]].concat(a).concat([s[0],s[1],e[t-2],e[t-1],s[2],s[3],r[0],r[1],e[0],e[1]]);return l}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();for(var t=e[0],i=e[0],r=e[1],s=e[1],a,l,o=0;o<e.length/2;o++)a=e[o*2],l=e[o*2+1],t=Math.min(t,a),i=Math.max(i,a),r=Math.min(r,l),s=Math.max(s,l);return{x:t,y:r,width:i-t,height:s-r}}}Zu.Line=ja;ja.prototype.className="Line";ja.prototype._attrsAffectingSize=["points","bezier","tension"];(0,lV._registerNode)(ja);Vf.Factory.addGetterSetter(ja,"closed",!1);Vf.Factory.addGetterSetter(ja,"bezier",!1);Vf.Factory.addGetterSetter(ja,"tension",0,(0,aS.getNumberValidator)());Vf.Factory.addGetterSetter(ja,"points",[],(0,aS.getNumberArrayValidator)());var uc={},oS={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.t2length=n.getQuadraticArcLength=n.getCubicArcLength=n.binomialCoefficients=n.cValues=n.tValues=void 0,n.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],n.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],n.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(a,l,o)=>{let c,u,h;c=o/2,u=0;for(let f=0;f<20;f++)h=c*n.tValues[20][f]+c,u+=n.cValues[20][f]*i(a,l,h);return c*u};n.getCubicArcLength=e;const t=(a,l,o)=>{o===void 0&&(o=1);const c=a[0]-2*a[1]+a[2],u=l[0]-2*l[1]+l[2],h=2*a[1]-2*a[0],d=2*l[1]-2*l[0],f=4*(c*c+u*u),_=4*(c*h+u*d),p=h*h+d*d;if(f===0)return o*Math.sqrt(Math.pow(a[2]-a[0],2)+Math.pow(l[2]-l[0],2));const v=_/(2*f),E=p/f,g=o+v,m=E-v*v,y=g*g+m>0?Math.sqrt(g*g+m):0,T=v*v+m>0?Math.sqrt(v*v+m):0,b=v+Math.sqrt(v*v+m)!==0?m*Math.log(Math.abs((g+y)/(v+T))):0;return Math.sqrt(f)/2*(g*y-v*T+b)};n.getQuadraticArcLength=t;function i(a,l,o){const c=r(1,o,a),u=r(1,o,l),h=c*c+u*u;return Math.sqrt(h)}const r=(a,l,o)=>{const c=o.length-1;let u,h;if(c===0)return 0;if(a===0){h=0;for(let d=0;d<=c;d++)h+=n.binomialCoefficients[c][d]*Math.pow(1-l,c-d)*Math.pow(l,d)*o[d];return h}else{u=new Array(c);for(let d=0;d<c;d++)u[d]=c*(o[d+1]-o[d]);return r(a-1,l,u)}},s=(a,l,o)=>{let c=1,u=a/l,h=(a-o(u))/l,d=0;for(;c>.001;){const f=o(u+h),_=Math.abs(a-f)/l;if(_<c)c=_,u+=h;else{const p=o(u-h),v=Math.abs(a-p)/l;v<c?(c=v,u-=h):h/=2}if(d++,d>500)break}return u};n.t2length=s})(oS);Object.defineProperty(uc,"__esModule",{value:!0});uc.Path=void 0;const cV=mt,uV=er,hV=gt,nl=oS;class Ki extends uV.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Ki.parsePathData(this.data()),this.pathLength=Ki.getPathLength(this.dataArray)}_sceneFunc(e){var t=this.dataArray;e.beginPath();for(var i=!1,r=0;r<t.length;r++){var s=t[r].command,a=t[r].points;switch(s){case"L":e.lineTo(a[0],a[1]);break;case"M":e.moveTo(a[0],a[1]);break;case"C":e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"Q":e.quadraticCurveTo(a[0],a[1],a[2],a[3]);break;case"A":var l=a[0],o=a[1],c=a[2],u=a[3],h=a[4],d=a[5],f=a[6],_=a[7],p=c>u?c:u,v=c>u?1:c/u,E=c>u?u/c:1;e.translate(l,o),e.rotate(f),e.scale(v,E),e.arc(0,0,p,h,h+d,1-_),e.scale(1/v,1/E),e.rotate(-f),e.translate(-l,-o);break;case"z":i=!0,e.closePath();break}}!i&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){var e=[];this.dataArray.forEach(function(c){if(c.command==="A"){var u=c.points[4],h=c.points[5],d=c.points[4]+h,f=Math.PI/180;if(Math.abs(u-d)<f&&(f=Math.abs(u-d)),h<0)for(let _=u-f;_>d;_-=f){const p=Ki.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],_,0);e.push(p.x,p.y)}else for(let _=u+f;_<d;_+=f){const p=Ki.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],_,0);e.push(p.x,p.y)}}else if(c.command==="C")for(let _=0;_<=1;_+=.01){const p=Ki.getPointOnCubicBezier(_,c.start.x,c.start.y,c.points[0],c.points[1],c.points[2],c.points[3],c.points[4],c.points[5]);e.push(p.x,p.y)}else e=e.concat(c.points)});for(var t=e[0],i=e[0],r=e[1],s=e[1],a,l,o=0;o<e.length/2;o++)a=e[o*2],l=e[o*2+1],isNaN(a)||(t=Math.min(t,a),i=Math.max(i,a)),isNaN(l)||(r=Math.min(r,l),s=Math.max(s,l));return{x:t,y:r,width:i-t,height:s-r}}getLength(){return this.pathLength}getPointAtLength(e){return Ki.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,t,i,r){return Math.sqrt((i-e)*(i-e)+(r-t)*(r-t))}static getPathLength(e){let t=0;for(var i=0;i<e.length;++i)t+=e[i].pathLength;return t}static getPointAtLengthOfDataArray(e,t){var i,r=0,s=t.length;if(!s)return null;for(;r<s&&e>t[r].pathLength;)e-=t[r].pathLength,++r;if(r===s)return i=t[r-1].points.slice(-2),{x:i[0],y:i[1]};if(e<.01)return i=t[r].points.slice(0,2),{x:i[0],y:i[1]};var a=t[r],l=a.points;switch(a.command){case"L":return Ki.getPointOnLine(e,a.start.x,a.start.y,l[0],l[1]);case"C":return Ki.getPointOnCubicBezier((0,nl.t2length)(e,Ki.getPathLength(t),p=>(0,nl.getCubicArcLength)([a.start.x,l[0],l[2],l[4]],[a.start.y,l[1],l[3],l[5]],p)),a.start.x,a.start.y,l[0],l[1],l[2],l[3],l[4],l[5]);case"Q":return Ki.getPointOnQuadraticBezier((0,nl.t2length)(e,Ki.getPathLength(t),p=>(0,nl.getQuadraticArcLength)([a.start.x,l[0],l[2]],[a.start.y,l[1],l[3]],p)),a.start.x,a.start.y,l[0],l[1],l[2],l[3]);case"A":var o=l[0],c=l[1],u=l[2],h=l[3],d=l[4],f=l[5],_=l[6];return d+=f*e/a.pathLength,Ki.getPointOnEllipticalArc(o,c,u,h,d,_)}return null}static getPointOnLine(e,t,i,r,s,a,l){a===void 0&&(a=t),l===void 0&&(l=i);var o=(s-i)/(r-t+1e-8),c=Math.sqrt(e*e/(1+o*o));r<t&&(c*=-1);var u=o*c,h;if(r===t)h={x:a,y:l+u};else if((l-i)/(a-t+1e-8)===o)h={x:a+c,y:l+u};else{var d,f,_=this.getLineLength(t,i,r,s),p=(a-t)*(r-t)+(l-i)*(s-i);p=p/(_*_),d=t+p*(r-t),f=i+p*(s-i);var v=this.getLineLength(a,l,d,f),E=Math.sqrt(e*e-v*v);c=Math.sqrt(E*E/(1+o*o)),r<t&&(c*=-1),u=o*c,h={x:d+c,y:f+u}}return h}static getPointOnCubicBezier(e,t,i,r,s,a,l,o,c){function u(v){return v*v*v}function h(v){return 3*v*v*(1-v)}function d(v){return 3*v*(1-v)*(1-v)}function f(v){return(1-v)*(1-v)*(1-v)}var _=o*u(e)+a*h(e)+r*d(e)+t*f(e),p=c*u(e)+l*h(e)+s*d(e)+i*f(e);return{x:_,y:p}}static getPointOnQuadraticBezier(e,t,i,r,s,a,l){function o(f){return f*f}function c(f){return 2*f*(1-f)}function u(f){return(1-f)*(1-f)}var h=a*o(e)+r*c(e)+t*u(e),d=l*o(e)+s*c(e)+i*u(e);return{x:h,y:d}}static getPointOnEllipticalArc(e,t,i,r,s,a){var l=Math.cos(a),o=Math.sin(a),c={x:i*Math.cos(s),y:r*Math.sin(s)};return{x:e+(c.x*l-c.y*o),y:t+(c.x*o+c.y*l)}}static parsePathData(e){if(!e)return[];var t=e,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(var r=0;r<i.length;r++)t=t.replace(new RegExp(i[r],"g"),"|"+i[r]);var s=t.split("|"),a=[],l=[],o=0,c=0,u=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,h;for(r=1;r<s.length;r++){var d=s[r],f=d.charAt(0);for(d=d.slice(1),l.length=0;h=u.exec(d);)l.push(h[0]);for(var _=[],p=0,v=l.length;p<v;p++){if(l[p]==="00"){_.push(0,0);continue}var E=parseFloat(l[p]);isNaN(E)?_.push(0):_.push(E)}for(;_.length>0&&!isNaN(_[0]);){var g="",m=[],y=o,T=c,b,C,M,F,P,U,G,K,q,se;switch(f){case"l":o+=_.shift(),c+=_.shift(),g="L",m.push(o,c);break;case"L":o=_.shift(),c=_.shift(),m.push(o,c);break;case"m":var Ee=_.shift(),Se=_.shift();if(o+=Ee,c+=Se,g="M",a.length>2&&a[a.length-1].command==="z"){for(var $=a.length-2;$>=0;$--)if(a[$].command==="M"){o=a[$].points[0]+Ee,c=a[$].points[1]+Se;break}}m.push(o,c),f="l";break;case"M":o=_.shift(),c=_.shift(),g="M",m.push(o,c),f="L";break;case"h":o+=_.shift(),g="L",m.push(o,c);break;case"H":o=_.shift(),g="L",m.push(o,c);break;case"v":c+=_.shift(),g="L",m.push(o,c);break;case"V":c=_.shift(),g="L",m.push(o,c);break;case"C":m.push(_.shift(),_.shift(),_.shift(),_.shift()),o=_.shift(),c=_.shift(),m.push(o,c);break;case"c":m.push(o+_.shift(),c+_.shift(),o+_.shift(),c+_.shift()),o+=_.shift(),c+=_.shift(),g="C",m.push(o,c);break;case"S":C=o,M=c,b=a[a.length-1],b.command==="C"&&(C=o+(o-b.points[2]),M=c+(c-b.points[3])),m.push(C,M,_.shift(),_.shift()),o=_.shift(),c=_.shift(),g="C",m.push(o,c);break;case"s":C=o,M=c,b=a[a.length-1],b.command==="C"&&(C=o+(o-b.points[2]),M=c+(c-b.points[3])),m.push(C,M,o+_.shift(),c+_.shift()),o+=_.shift(),c+=_.shift(),g="C",m.push(o,c);break;case"Q":m.push(_.shift(),_.shift()),o=_.shift(),c=_.shift(),m.push(o,c);break;case"q":m.push(o+_.shift(),c+_.shift()),o+=_.shift(),c+=_.shift(),g="Q",m.push(o,c);break;case"T":C=o,M=c,b=a[a.length-1],b.command==="Q"&&(C=o+(o-b.points[0]),M=c+(c-b.points[1])),o=_.shift(),c=_.shift(),g="Q",m.push(C,M,o,c);break;case"t":C=o,M=c,b=a[a.length-1],b.command==="Q"&&(C=o+(o-b.points[0]),M=c+(c-b.points[1])),o+=_.shift(),c+=_.shift(),g="Q",m.push(C,M,o,c);break;case"A":F=_.shift(),P=_.shift(),U=_.shift(),G=_.shift(),K=_.shift(),q=o,se=c,o=_.shift(),c=_.shift(),g="A",m=this.convertEndpointToCenterParameterization(q,se,o,c,G,K,F,P,U);break;case"a":F=_.shift(),P=_.shift(),U=_.shift(),G=_.shift(),K=_.shift(),q=o,se=c,o+=_.shift(),c+=_.shift(),g="A",m=this.convertEndpointToCenterParameterization(q,se,o,c,G,K,F,P,U);break}a.push({command:g||f,points:m,start:{x:y,y:T},pathLength:this.calcLength(y,T,g||f,m)})}(f==="z"||f==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(e,t,i,r){var s,a,l,o,c=Ki;switch(i){case"L":return c.getLineLength(e,t,r[0],r[1]);case"C":return(0,nl.getCubicArcLength)([e,r[0],r[2],r[4]],[t,r[1],r[3],r[5]],1);case"Q":return(0,nl.getQuadraticArcLength)([e,r[0],r[2]],[t,r[1],r[3]],1);case"A":s=0;var u=r[4],h=r[5],d=r[4]+h,f=Math.PI/180;if(Math.abs(u-d)<f&&(f=Math.abs(u-d)),a=c.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],u,0),h<0)for(o=u-f;o>d;o-=f)l=c.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],o,0),s+=c.getLineLength(a.x,a.y,l.x,l.y),a=l;else for(o=u+f;o<d;o+=f)l=c.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],o,0),s+=c.getLineLength(a.x,a.y,l.x,l.y),a=l;return l=c.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],d,0),s+=c.getLineLength(a.x,a.y,l.x,l.y),s}return 0}static convertEndpointToCenterParameterization(e,t,i,r,s,a,l,o,c){var u=c*(Math.PI/180),h=Math.cos(u)*(e-i)/2+Math.sin(u)*(t-r)/2,d=-1*Math.sin(u)*(e-i)/2+Math.cos(u)*(t-r)/2,f=h*h/(l*l)+d*d/(o*o);f>1&&(l*=Math.sqrt(f),o*=Math.sqrt(f));var _=Math.sqrt((l*l*(o*o)-l*l*(d*d)-o*o*(h*h))/(l*l*(d*d)+o*o*(h*h)));s===a&&(_*=-1),isNaN(_)&&(_=0);var p=_*l*d/o,v=_*-o*h/l,E=(e+i)/2+Math.cos(u)*p-Math.sin(u)*v,g=(t+r)/2+Math.sin(u)*p+Math.cos(u)*v,m=function(P){return Math.sqrt(P[0]*P[0]+P[1]*P[1])},y=function(P,U){return(P[0]*U[0]+P[1]*U[1])/(m(P)*m(U))},T=function(P,U){return(P[0]*U[1]<P[1]*U[0]?-1:1)*Math.acos(y(P,U))},b=T([1,0],[(h-p)/l,(d-v)/o]),C=[(h-p)/l,(d-v)/o],M=[(-1*h-p)/l,(-1*d-v)/o],F=T(C,M);return y(C,M)<=-1&&(F=Math.PI),y(C,M)>=1&&(F=0),a===0&&F>0&&(F=F-2*Math.PI),a===1&&F<0&&(F=F+2*Math.PI),[E,g,l,o,b,F,u,a]}}uc.Path=Ki;Ki.prototype.className="Path";Ki.prototype._attrsAffectingSize=["data"];(0,hV._registerNode)(Ki);cV.Factory.addGetterSetter(Ki,"data");Object.defineProperty(zf,"__esModule",{value:!0});zf.Arrow=void 0;const Gf=mt,dV=Zu,lS=We,fV=gt,sT=uc;class Uo extends dV.Line{_sceneFunc(e){super._sceneFunc(e);var t=Math.PI*2,i=this.points(),r=i,s=this.tension()!==0&&i.length>4;s&&(r=this.getTensionPoints());var a=this.pointerLength(),l=i.length,o,c;if(s){const d=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],i[l-2],i[l-1]],f=sT.Path.calcLength(r[r.length-4],r[r.length-3],"C",d),_=sT.Path.getPointOnQuadraticBezier(Math.min(1,1-a/f),d[0],d[1],d[2],d[3],d[4],d[5]);o=i[l-2]-_.x,c=i[l-1]-_.y}else o=i[l-2]-i[l-4],c=i[l-1]-i[l-3];var u=(Math.atan2(c,o)+t)%t,h=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(i[l-2],i[l-1]),e.rotate(u),e.moveTo(0,0),e.lineTo(-a,h/2),e.lineTo(-a,-h/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(i[0],i[1]),s?(o=(r[0]+r[2])/2-i[0],c=(r[1]+r[3])/2-i[1]):(o=i[2]-i[0],c=i[3]-i[1]),e.rotate((Math.atan2(-c,-o)+t)%t),e.moveTo(0,0),e.lineTo(-a,h/2),e.lineTo(-a,-h/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){var t=this.dashEnabled();t&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),t&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),t=this.pointerWidth()/2;return{x:e.x-t,y:e.y-t,width:e.width+t*2,height:e.height+t*2}}}zf.Arrow=Uo;Uo.prototype.className="Arrow";(0,fV._registerNode)(Uo);Gf.Factory.addGetterSetter(Uo,"pointerLength",10,(0,lS.getNumberValidator)());Gf.Factory.addGetterSetter(Uo,"pointerWidth",10,(0,lS.getNumberValidator)());Gf.Factory.addGetterSetter(Uo,"pointerAtBeginning",!1);Gf.Factory.addGetterSetter(Uo,"pointerAtEnding",!0);var Wf={};Object.defineProperty(Wf,"__esModule",{value:!0});Wf.Circle=void 0;const _V=mt,pV=er,gV=We,mV=gt;class hc extends pV.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}Wf.Circle=hc;hc.prototype._centroid=!0;hc.prototype.className="Circle";hc.prototype._attrsAffectingSize=["radius"];(0,mV._registerNode)(hc);_V.Factory.addGetterSetter(hc,"radius",0,(0,gV.getNumberValidator)());var Hf={};Object.defineProperty(Hf,"__esModule",{value:!0});Hf.Ellipse=void 0;const x0=mt,vV=er,cS=We,EV=gt;class Xa extends vV.Shape{_sceneFunc(e){var t=this.radiusX(),i=this.radiusY();e.beginPath(),e.save(),t!==i&&e.scale(1,i/t),e.arc(0,0,t,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}Hf.Ellipse=Xa;Xa.prototype.className="Ellipse";Xa.prototype._centroid=!0;Xa.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,EV._registerNode)(Xa);x0.Factory.addComponentsGetterSetter(Xa,"radius",["x","y"]);x0.Factory.addGetterSetter(Xa,"radiusX",0,(0,cS.getNumberValidator)());x0.Factory.addGetterSetter(Xa,"radiusY",0,(0,cS.getNumberValidator)());var jf={};Object.defineProperty(jf,"__esModule",{value:!0});jf.Image=void 0;const _p=Ci,zo=mt,yV=er,TV=gt,Ju=We;let cs=class uS extends yV.Shape{constructor(e){super(e),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(e){const t=this.getWidth(),i=this.getHeight(),r=this.cornerRadius(),s=this.attrs.image;let a;if(s){const l=this.attrs.cropWidth,o=this.attrs.cropHeight;l&&o?a=[s,this.cropX(),this.cropY(),l,o,0,0,t,i]:a=[s,0,0,t,i]}(this.hasFill()||this.hasStroke()||r)&&(e.beginPath(),r?_p.Util.drawRoundedRectPath(e,t,i,r):e.rect(0,0,t,i),e.closePath(),e.fillStrokeShape(this)),s&&(r&&e.clip(),e.drawImage.apply(e,a))}_hitFunc(e){var t=this.width(),i=this.height(),r=this.cornerRadius();e.beginPath(),r?_p.Util.drawRoundedRectPath(e,t,i,r):e.rect(0,0,t,i),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,t;return(e=this.attrs.width)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.width}getHeight(){var e,t;return(e=this.attrs.height)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.height}static fromURL(e,t,i=null){var r=_p.Util.createImageElement();r.onload=function(){var s=new uS({image:r});t(s)},r.onerror=i,r.crossOrigin="Anonymous",r.src=e}};jf.Image=cs;cs.prototype.className="Image";(0,TV._registerNode)(cs);zo.Factory.addGetterSetter(cs,"cornerRadius",0,(0,Ju.getNumberOrArrayOfNumbersValidator)(4));zo.Factory.addGetterSetter(cs,"image");zo.Factory.addComponentsGetterSetter(cs,"crop",["x","y","width","height"]);zo.Factory.addGetterSetter(cs,"cropX",0,(0,Ju.getNumberValidator)());zo.Factory.addGetterSetter(cs,"cropY",0,(0,Ju.getNumberValidator)());zo.Factory.addGetterSetter(cs,"cropWidth",0,(0,Ju.getNumberValidator)());zo.Factory.addGetterSetter(cs,"cropHeight",0,(0,Ju.getNumberValidator)());var ql={};Object.defineProperty(ql,"__esModule",{value:!0});ql.Tag=ql.Label=void 0;const Xf=mt,bV=er,CV=lc,M0=We,hS=gt;var dS=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],AV="Change.konva",SV="none",Ug="up",zg="right",Vg="down",Gg="left",RV=dS.length;class I0 extends CV.Group{constructor(e){super(e),this.on("add.konva",function(t){this._addListeners(t.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){var t=this,i,r=function(){t._sync()};for(i=0;i<RV;i++)e.on(dS[i]+AV,r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var e=this.getText(),t=this.getTag(),i,r,s,a,l,o,c;if(e&&t){switch(i=e.width(),r=e.height(),s=t.pointerDirection(),a=t.pointerWidth(),c=t.pointerHeight(),l=0,o=0,s){case Ug:l=i/2,o=-1*c;break;case zg:l=i+a,o=r/2;break;case Vg:l=i/2,o=r+c;break;case Gg:l=-1*a,o=r/2;break}t.setAttrs({x:-1*l,y:-1*o,width:i,height:r}),e.setAttrs({x:-1*l,y:-1*o})}}}ql.Label=I0;I0.prototype.className="Label";(0,hS._registerNode)(I0);class Vo extends bV.Shape{_sceneFunc(e){var t=this.width(),i=this.height(),r=this.pointerDirection(),s=this.pointerWidth(),a=this.pointerHeight(),l=this.cornerRadius();let o=0,c=0,u=0,h=0;typeof l=="number"?o=c=u=h=Math.min(l,t/2,i/2):(o=Math.min(l[0]||0,t/2,i/2),c=Math.min(l[1]||0,t/2,i/2),h=Math.min(l[2]||0,t/2,i/2),u=Math.min(l[3]||0,t/2,i/2)),e.beginPath(),e.moveTo(o,0),r===Ug&&(e.lineTo((t-s)/2,0),e.lineTo(t/2,-1*a),e.lineTo((t+s)/2,0)),e.lineTo(t-c,0),e.arc(t-c,c,c,Math.PI*3/2,0,!1),r===zg&&(e.lineTo(t,(i-a)/2),e.lineTo(t+s,i/2),e.lineTo(t,(i+a)/2)),e.lineTo(t,i-h),e.arc(t-h,i-h,h,0,Math.PI/2,!1),r===Vg&&(e.lineTo((t+s)/2,i),e.lineTo(t/2,i+a),e.lineTo((t-s)/2,i)),e.lineTo(u,i),e.arc(u,i-u,u,Math.PI/2,Math.PI,!1),r===Gg&&(e.lineTo(0,(i+a)/2),e.lineTo(-1*s,i/2),e.lineTo(0,(i-a)/2)),e.lineTo(0,o),e.arc(o,o,o,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){var e=0,t=0,i=this.pointerWidth(),r=this.pointerHeight(),s=this.pointerDirection(),a=this.width(),l=this.height();return s===Ug?(t-=r,l+=r):s===Vg?l+=r:s===Gg?(e-=i*1.5,a+=i):s===zg&&(a+=i*1.5),{x:e,y:t,width:a,height:l}}}ql.Tag=Vo;Vo.prototype.className="Tag";(0,hS._registerNode)(Vo);Xf.Factory.addGetterSetter(Vo,"pointerDirection",SV);Xf.Factory.addGetterSetter(Vo,"pointerWidth",0,(0,M0.getNumberValidator)());Xf.Factory.addGetterSetter(Vo,"pointerHeight",0,(0,M0.getNumberValidator)());Xf.Factory.addGetterSetter(Vo,"cornerRadius",0,(0,M0.getNumberOrArrayOfNumbersValidator)(4));var eh={};Object.defineProperty(eh,"__esModule",{value:!0});eh.Rect=void 0;const xV=mt,MV=er,IV=gt,PV=Ci,wV=We;class Yf extends MV.Shape{_sceneFunc(e){var t=this.cornerRadius(),i=this.width(),r=this.height();e.beginPath(),t?PV.Util.drawRoundedRectPath(e,i,r,t):e.rect(0,0,i,r),e.closePath(),e.fillStrokeShape(this)}}eh.Rect=Yf;Yf.prototype.className="Rect";(0,IV._registerNode)(Yf);xV.Factory.addGetterSetter(Yf,"cornerRadius",0,(0,wV.getNumberOrArrayOfNumbersValidator)(4));var Kf={};Object.defineProperty(Kf,"__esModule",{value:!0});Kf.RegularPolygon=void 0;const fS=mt,OV=er,_S=We,DV=gt;class Go extends OV.Shape{_sceneFunc(e){const t=this._getPoints();e.beginPath(),e.moveTo(t[0].x,t[0].y);for(var i=1;i<t.length;i++)e.lineTo(t[i].x,t[i].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,t=this.attrs.radius||0,i=[];for(var r=0;r<e;r++)i.push({x:t*Math.sin(r*2*Math.PI/e),y:-1*t*Math.cos(r*2*Math.PI/e)});return i}getSelfRect(){const e=this._getPoints();var t=e[0].x,i=e[0].y,r=e[0].x,s=e[0].y;return e.forEach(a=>{t=Math.min(t,a.x),i=Math.max(i,a.x),r=Math.min(r,a.y),s=Math.max(s,a.y)}),{x:t,y:r,width:i-t,height:s-r}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}Kf.RegularPolygon=Go;Go.prototype.className="RegularPolygon";Go.prototype._centroid=!0;Go.prototype._attrsAffectingSize=["radius"];(0,DV._registerNode)(Go);fS.Factory.addGetterSetter(Go,"radius",0,(0,_S.getNumberValidator)());fS.Factory.addGetterSetter(Go,"sides",0,(0,_S.getNumberValidator)());var qf={};Object.defineProperty(qf,"__esModule",{value:!0});qf.Ring=void 0;const pS=mt,LV=er,gS=We,NV=gt;var aT=Math.PI*2;class Wo extends LV.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,aT,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),aT,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}qf.Ring=Wo;Wo.prototype.className="Ring";Wo.prototype._centroid=!0;Wo.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,NV._registerNode)(Wo);pS.Factory.addGetterSetter(Wo,"innerRadius",0,(0,gS.getNumberValidator)());pS.Factory.addGetterSetter(Wo,"outerRadius",0,(0,gS.getNumberValidator)());var $f={};Object.defineProperty($f,"__esModule",{value:!0});$f.Sprite=void 0;const Ho=mt,FV=er,kV=cc,mS=We,BV=gt;class us extends FV.Shape{constructor(e){super(e),this._updated=!0,this.anim=new kV.Animation(()=>{var t=this._updated;return this._updated=!1,t}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){var t=this.animation(),i=this.frameIndex(),r=i*4,s=this.animations()[t],a=this.frameOffsets(),l=s[r+0],o=s[r+1],c=s[r+2],u=s[r+3],h=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,c,u),e.closePath(),e.fillStrokeShape(this)),h)if(a){var d=a[t],f=i*2;e.drawImage(h,l,o,c,u,d[f+0],d[f+1],c,u)}else e.drawImage(h,l,o,c,u,0,0,c,u)}_hitFunc(e){var t=this.animation(),i=this.frameIndex(),r=i*4,s=this.animations()[t],a=this.frameOffsets(),l=s[r+2],o=s[r+3];if(e.beginPath(),a){var c=a[t],u=i*2;e.rect(c[u+0],c[u+1],l,o)}else e.rect(0,0,l,o);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(!this.isRunning()){var e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var e=this.frameIndex(),t=this.animation(),i=this.animations(),r=i[t],s=r.length/4;e<s-1?this.frameIndex(e+1):this.frameIndex(0)}}$f.Sprite=us;us.prototype.className="Sprite";(0,BV._registerNode)(us);Ho.Factory.addGetterSetter(us,"animation");Ho.Factory.addGetterSetter(us,"animations");Ho.Factory.addGetterSetter(us,"frameOffsets");Ho.Factory.addGetterSetter(us,"image");Ho.Factory.addGetterSetter(us,"frameIndex",0,(0,mS.getNumberValidator)());Ho.Factory.addGetterSetter(us,"frameRate",17,(0,mS.getNumberValidator)());Ho.Factory.backCompat(us,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Qf={};Object.defineProperty(Qf,"__esModule",{value:!0});Qf.Star=void 0;const P0=mt,UV=er,w0=We,zV=gt;class Ya extends UV.Shape{_sceneFunc(e){var t=this.innerRadius(),i=this.outerRadius(),r=this.numPoints();e.beginPath(),e.moveTo(0,0-i);for(var s=1;s<r*2;s++){var a=s%2===0?i:t,l=a*Math.sin(s*Math.PI/r),o=-1*a*Math.cos(s*Math.PI/r);e.lineTo(l,o)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Qf.Star=Ya;Ya.prototype.className="Star";Ya.prototype._centroid=!0;Ya.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,zV._registerNode)(Ya);P0.Factory.addGetterSetter(Ya,"numPoints",5,(0,w0.getNumberValidator)());P0.Factory.addGetterSetter(Ya,"innerRadius",0,(0,w0.getNumberValidator)());P0.Factory.addGetterSetter(Ya,"outerRadius",0,(0,w0.getNumberValidator)());var Do={};Object.defineProperty(Do,"__esModule",{value:!0});Do.Text=Do.stringToArray=void 0;const Wg=Ci,Cr=mt,VV=er,GV=gt,Ka=We,WV=gt;function vS(n){return Array.from(n)}Do.stringToArray=vS;var sl="auto",HV="center",ES="inherit",wc="justify",jV="Change.konva",XV="2d",oT="-",yS="left",YV="text",KV="Text",qV="top",$V="bottom",lT="middle",TS="normal",QV="px ",Mh=" ",ZV="right",cT="rtl",JV="word",eG="char",uT="none",pp="",bS=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],tG=bS.length;function iG(n){return n.split(",").map(e=>{e=e.trim();const t=e.indexOf(" ")>=0,i=e.indexOf('"')>=0||e.indexOf("'")>=0;return t&&!i&&(e=`"${e}"`),e}).join(", ")}var Ih;function gp(){return Ih||(Ih=Wg.Util.createCanvasElement().getContext(XV),Ih)}function rG(n){n.fillText(this._partialText,this._partialTextX,this._partialTextY)}function nG(n){n.setAttr("miterLimit",2),n.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function sG(n){return n=n||{},!n.fillLinearGradientColorStops&&!n.fillRadialGradientColorStops&&!n.fillPatternImage&&(n.fill=n.fill||"black"),n}class Ii extends VV.Shape{constructor(e){super(sG(e)),this._partialTextX=0,this._partialTextY=0;for(var t=0;t<tG;t++)this.on(bS[t]+jV,this._setTextData);this._setTextData()}_sceneFunc(e){var t=this.textArr,i=t.length;if(this.text()){var r=this.padding(),s=this.fontSize(),a=this.lineHeight()*s,l=this.verticalAlign(),o=this.direction(),c=0,u=this.align(),h=this.getWidth(),d=this.letterSpacing(),f=this.fill(),_=this.textDecoration(),p=_.indexOf("underline")!==-1,v=_.indexOf("line-through")!==-1,E;o=o===ES?e.direction:o;var g=a/2,m=lT;if(GV.Konva._fixTextRendering){var y=this.measureSize("M");m="alphabetic",g=(y.fontBoundingBoxAscent-y.fontBoundingBoxDescent)/2+a/2}var T=0,b=0;for(o===cT&&e.setAttr("direction",o),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",m),e.setAttr("textAlign",yS),l===lT?c=(this.getHeight()-i*a-r*2)/2:l===$V&&(c=this.getHeight()-i*a-r*2),e.translate(r,c+r),E=0;E<i;E++){var T=0,b=0,C=t[E],M=C.text,F=C.width,P=C.lastInParagraph,U,G,K;if(e.save(),u===ZV?T+=h-F-r*2:u===HV&&(T+=(h-F-r*2)/2),p){e.save(),e.beginPath(),e.moveTo(T,g+b+Math.round(s/2)),U=M.split(" ").length-1,G=U===0,K=u===wc&&!P?h-r*2:F,e.lineTo(T+Math.round(K),g+b+Math.round(s/2)),e.lineWidth=s/15;const _e=this._getLinearGradient();e.strokeStyle=_e||f,e.stroke(),e.restore()}if(v){e.save(),e.beginPath(),e.moveTo(T,g+b),U=M.split(" ").length-1,G=U===0,K=u===wc&&P&&!G?h-r*2:F,e.lineTo(T+Math.round(K),g+b),e.lineWidth=s/15;const _e=this._getLinearGradient();e.strokeStyle=_e||f,e.stroke(),e.restore()}if(o!==cT&&(d!==0||u===wc)){U=M.split(" ").length-1;for(var q=vS(M),se=0;se<q.length;se++){var Ee=q[se];Ee===" "&&!P&&u===wc&&(T+=(h-r*2-F)/U),this._partialTextX=T,this._partialTextY=g+b,this._partialText=Ee,e.fillStrokeShape(this),T+=this.measureSize(Ee).width+d}}else d!==0&&e.setAttr("letterSpacing",`${d}px`),this._partialTextX=T,this._partialTextY=g+b,this._partialText=M,e.fillStrokeShape(this);e.restore(),i>1&&(g+=a)}}}_hitFunc(e){var t=this.getWidth(),i=this.getHeight();e.beginPath(),e.rect(0,0,t,i),e.closePath(),e.fillStrokeShape(this)}setText(e){var t=Wg.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(YV,t),this}getWidth(){var e=this.attrs.width===sl||this.attrs.width===void 0;return e?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){var e=this.attrs.height===sl||this.attrs.height===void 0;return e?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return Wg.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var t=gp(),i=this.fontSize(),r;return t.save(),t.font=this._getContextFont(),r=t.measureText(e),t.restore(),{actualBoundingBoxAscent:r.actualBoundingBoxAscent,actualBoundingBoxDescent:r.actualBoundingBoxDescent,actualBoundingBoxLeft:r.actualBoundingBoxLeft,actualBoundingBoxRight:r.actualBoundingBoxRight,alphabeticBaseline:r.alphabeticBaseline,emHeightAscent:r.emHeightAscent,emHeightDescent:r.emHeightDescent,fontBoundingBoxAscent:r.fontBoundingBoxAscent,fontBoundingBoxDescent:r.fontBoundingBoxDescent,hangingBaseline:r.hangingBaseline,ideographicBaseline:r.ideographicBaseline,width:r.width,height:i}}_getContextFont(){return this.fontStyle()+Mh+this.fontVariant()+Mh+(this.fontSize()+QV)+iG(this.fontFamily())}_addTextLine(e){this.align()===wc&&(e=e.trim());var i=this._getTextWidth(e);return this.textArr.push({text:e,width:i,lastInParagraph:!1})}_getTextWidth(e){var t=this.letterSpacing(),i=e.length;return gp().measureText(e).width+(i?t*(i-1):0)}_setTextData(){var e=this.text().split(`
`),t=+this.fontSize(),i=0,r=this.lineHeight()*t,s=this.attrs.width,a=this.attrs.height,l=s!==sl&&s!==void 0,o=a!==sl&&a!==void 0,c=this.padding(),u=s-c*2,h=a-c*2,d=0,f=this.wrap(),_=f!==uT,p=f!==eG&&_,v=this.ellipsis();this.textArr=[],gp().font=this._getContextFont();for(var E=v?this._getTextWidth(pp):0,g=0,m=e.length;g<m;++g){var y=e[g],T=this._getTextWidth(y);if(l&&T>u)for(;y.length>0;){for(var b=0,C=y.length,M="",F=0;b<C;){var P=b+C>>>1,U=y.slice(0,P+1),G=this._getTextWidth(U)+E;G<=u?(b=P+1,M=U,F=G):C=P}if(M){if(p){var K,q=y[M.length],se=q===Mh||q===oT;se&&F<=u?K=M.length:K=Math.max(M.lastIndexOf(Mh),M.lastIndexOf(oT))+1,K>0&&(b=K,M=M.slice(0,b),F=this._getTextWidth(M))}M=M.trimRight(),this._addTextLine(M),i=Math.max(i,F),d+=r;var Ee=this._shouldHandleEllipsis(d);if(Ee){this._tryToAddEllipsisToLastLine();break}if(y=y.slice(b),y=y.trimLeft(),y.length>0&&(T=this._getTextWidth(y),T<=u)){this._addTextLine(y),d+=r,i=Math.max(i,T);break}}else break}else this._addTextLine(y),d+=r,i=Math.max(i,T),this._shouldHandleEllipsis(d)&&g<m-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),o&&d+r>h)break}this.textHeight=t,this.textWidth=i}_shouldHandleEllipsis(e){var t=+this.fontSize(),i=this.lineHeight()*t,r=this.attrs.height,s=r!==sl&&r!==void 0,a=this.padding(),l=r-a*2,o=this.wrap(),c=o!==uT;return!c||s&&e+i>l}_tryToAddEllipsisToLastLine(){var e=this.attrs.width,t=e!==sl&&e!==void 0,i=this.padding(),r=e-i*2,s=this.ellipsis(),a=this.textArr[this.textArr.length-1];if(!(!a||!s)){if(t){var l=this._getTextWidth(a.text+pp)<r;l||(a.text=a.text.slice(0,a.text.length-3))}this.textArr.splice(this.textArr.length-1,1),this._addTextLine(a.text+pp)}}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,t=this.hasShadow();return e&&t?!0:super._useBufferCanvas()}}Do.Text=Ii;Ii.prototype._fillFunc=rG;Ii.prototype._strokeFunc=nG;Ii.prototype.className=KV;Ii.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,WV._registerNode)(Ii);Cr.Factory.overWriteSetter(Ii,"width",(0,Ka.getNumberOrAutoValidator)());Cr.Factory.overWriteSetter(Ii,"height",(0,Ka.getNumberOrAutoValidator)());Cr.Factory.addGetterSetter(Ii,"direction",ES);Cr.Factory.addGetterSetter(Ii,"fontFamily","Arial");Cr.Factory.addGetterSetter(Ii,"fontSize",12,(0,Ka.getNumberValidator)());Cr.Factory.addGetterSetter(Ii,"fontStyle",TS);Cr.Factory.addGetterSetter(Ii,"fontVariant",TS);Cr.Factory.addGetterSetter(Ii,"padding",0,(0,Ka.getNumberValidator)());Cr.Factory.addGetterSetter(Ii,"align",yS);Cr.Factory.addGetterSetter(Ii,"verticalAlign",qV);Cr.Factory.addGetterSetter(Ii,"lineHeight",1,(0,Ka.getNumberValidator)());Cr.Factory.addGetterSetter(Ii,"wrap",JV);Cr.Factory.addGetterSetter(Ii,"ellipsis",!1,(0,Ka.getBooleanValidator)());Cr.Factory.addGetterSetter(Ii,"letterSpacing",0,(0,Ka.getNumberValidator)());Cr.Factory.addGetterSetter(Ii,"text","",(0,Ka.getStringValidator)());Cr.Factory.addGetterSetter(Ii,"textDecoration","");var Zf={};Object.defineProperty(Zf,"__esModule",{value:!0});Zf.TextPath=void 0;const mp=Ci,Xn=mt,aG=er,Oc=uc,vp=Do,CS=We,oG=gt;var lG="",AS="normal";function SS(n){n.fillText(this.partialText,0,0)}function RS(n){n.strokeText(this.partialText,0,0)}class tr extends aG.Shape{constructor(e){super(e),this.dummyCanvas=mp.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Oc.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const t=this.pathLength;return e-1>t?null:Oc.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=Oc.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();var t=this.textDecoration(),i=this.fill(),r=this.fontSize(),s=this.glyphInfo;t==="underline"&&e.beginPath();for(var a=0;a<s.length;a++){e.save();var l=s[a].p0;e.translate(l.x,l.y),e.rotate(s[a].rotation),this.partialText=s[a].text,e.fillStrokeShape(this),t==="underline"&&(a===0&&e.moveTo(0,r/2+1),e.lineTo(r,r/2+1)),e.restore()}t==="underline"&&(e.strokeStyle=i,e.lineWidth=r/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();var t=this.glyphInfo;if(t.length>=1){var i=t[0].p0;e.moveTo(i.x,i.y)}for(var r=0;r<t.length;r++){var s=t[r].p1;e.lineTo(s.x,s.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return mp.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return vp.Text.prototype.setText.call(this,e)}_getContextFont(){return vp.Text.prototype._getContextFont.call(this)}_getTextSize(e){var t=this.dummyCanvas,i=t.getContext("2d");i.save(),i.font=this._getContextFont();var r=i.measureText(e);return i.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:t}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=t,this.glyphInfo=[],!this.attrs.data)return null;const i=this.letterSpacing(),r=this.align(),s=this.kerningFunc(),a=Math.max(this.textWidth+((this.attrs.text||"").length-1)*i,0);let l=0;r==="center"&&(l=Math.max(0,this.pathLength/2-a/2)),r==="right"&&(l=Math.max(0,this.pathLength-a));const o=(0,vp.stringToArray)(this.text());let c=l;for(var u=0;u<o.length;u++){const h=this._getPointAtLength(c);if(!h)return;let d=this._getTextSize(o[u]).width+i;if(o[u]===" "&&r==="justify"){const g=this.text().split(" ").length-1;d+=(this.pathLength-a)/g}const f=this._getPointAtLength(c+d);if(!f)return;const _=Oc.Path.getLineLength(h.x,h.y,f.x,f.y);let p=0;if(s)try{p=s(o[u-1],o[u])*this.fontSize()}catch{p=0}h.x+=p,f.x+=p,this.textWidth+=p;const v=Oc.Path.getPointOnLine(p+_/2,h.x,h.y,f.x,f.y),E=Math.atan2(f.y-h.y,f.x-h.x);this.glyphInfo.push({transposeX:v.x,transposeY:v.y,text:o[u],rotation:E,p0:h,p1:f}),c+=d}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var e=[];this.glyphInfo.forEach(function(u){e.push(u.p0.x),e.push(u.p0.y),e.push(u.p1.x),e.push(u.p1.y)});for(var t=e[0]||0,i=e[0]||0,r=e[1]||0,s=e[1]||0,a,l,o=0;o<e.length/2;o++)a=e[o*2],l=e[o*2+1],t=Math.min(t,a),i=Math.max(i,a),r=Math.min(r,l),s=Math.max(s,l);var c=this.fontSize();return{x:t-c/2,y:r-c/2,width:i-t+c,height:s-r+c}}destroy(){return mp.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}Zf.TextPath=tr;tr.prototype._fillFunc=SS;tr.prototype._strokeFunc=RS;tr.prototype._fillFuncHit=SS;tr.prototype._strokeFuncHit=RS;tr.prototype.className="TextPath";tr.prototype._attrsAffectingSize=["text","fontSize","data"];(0,oG._registerNode)(tr);Xn.Factory.addGetterSetter(tr,"data");Xn.Factory.addGetterSetter(tr,"fontFamily","Arial");Xn.Factory.addGetterSetter(tr,"fontSize",12,(0,CS.getNumberValidator)());Xn.Factory.addGetterSetter(tr,"fontStyle",AS);Xn.Factory.addGetterSetter(tr,"align","left");Xn.Factory.addGetterSetter(tr,"letterSpacing",0,(0,CS.getNumberValidator)());Xn.Factory.addGetterSetter(tr,"textBaseline","middle");Xn.Factory.addGetterSetter(tr,"fontVariant",AS);Xn.Factory.addGetterSetter(tr,"text",lG);Xn.Factory.addGetterSetter(tr,"textDecoration",null);Xn.Factory.addGetterSetter(tr,"kerningFunc",null);var Jf={};Object.defineProperty(Jf,"__esModule",{value:!0});Jf.Transformer=void 0;const qt=Ci,Vt=mt,hT=gi,cG=er,uG=eh,dT=lc,An=gt,qa=We,hG=gt;var xS="tr-konva",dG=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(n=>n+`.${xS}`).join(" "),fT="nodesRect",fG=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],_G={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const pG="ontouchstart"in An.Konva._global;function gG(n,e,t){if(n==="rotater")return t;e+=qt.Util.degToRad(_G[n]||0);var i=(qt.Util.radToDeg(e)%360+360)%360;return qt.Util._inRange(i,315+22.5,360)||qt.Util._inRange(i,0,22.5)?"ns-resize":qt.Util._inRange(i,45-22.5,45+22.5)?"nesw-resize":qt.Util._inRange(i,90-22.5,90+22.5)?"ew-resize":qt.Util._inRange(i,135-22.5,135+22.5)?"nwse-resize":qt.Util._inRange(i,180-22.5,180+22.5)?"ns-resize":qt.Util._inRange(i,225-22.5,225+22.5)?"nesw-resize":qt.Util._inRange(i,270-22.5,270+22.5)?"ew-resize":qt.Util._inRange(i,315-22.5,315+22.5)?"nwse-resize":(qt.Util.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}var Wd=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],_T=1e8;function mG(n){return{x:n.x+n.width/2*Math.cos(n.rotation)+n.height/2*Math.sin(-n.rotation),y:n.y+n.height/2*Math.cos(n.rotation)+n.width/2*Math.sin(n.rotation)}}function MS(n,e,t){const i=t.x+(n.x-t.x)*Math.cos(e)-(n.y-t.y)*Math.sin(e),r=t.y+(n.x-t.x)*Math.sin(e)+(n.y-t.y)*Math.cos(e);return{...n,rotation:n.rotation+e,x:i,y:r}}function vG(n,e){const t=mG(n);return MS(n,e,t)}function EG(n,e,t){let i=e;for(let r=0;r<n.length;r++){const s=An.Konva.getAngle(n[r]),a=Math.abs(s-e)%(Math.PI*2);Math.min(a,Math.PI*2-a)<t&&(i=s)}return i}let Hg=0;class wt extends dT.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(dG,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return qt.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return xS+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const t=e.filter(r=>r.isAncestorOf(this)?(qt.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);this._nodes=e=t,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(r=>{const s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},a=r._attrsAffectingSize.map(l=>l+"Change."+this._getEventNamespace()).join(" ");r.on(a,s),r.on(fG.map(l=>l+`.${this._getEventNamespace()}`).join(" "),s),r.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(r)}),this._resetTransformCache();var i=!!this.findOne(".top-left");return i&&this.update(),this}_proxyDrag(e){let t;e.on(`dragstart.${this._getEventNamespace()}`,i=>{t=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(i,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,i=>{if(!t)return;const r=e.getAbsolutePosition(),s=r.x-t.x,a=r.y-t.y;this.nodes().forEach(l=>{if(l===e||l.isDragging())return;const o=l.getAbsolutePosition();l.setAbsolutePosition({x:o.x+s,y:o.y+a}),l.startDrag(i)}),t=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(fT),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(fT,this.__getNodeRect)}__getNodeShape(e,t=this.rotation(),i){var r=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=e.getAbsoluteScale(i),a=e.getAbsolutePosition(i),l=r.x*s.x-e.offsetX()*s.x,o=r.y*s.y-e.offsetY()*s.y;const c=(An.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),u={x:a.x+l*Math.cos(c)+o*Math.sin(-c),y:a.y+o*Math.cos(c)+l*Math.sin(c),width:r.width*s.x,height:r.height*s.y,rotation:c};return MS(u,-An.Konva.getAngle(t),{x:0,y:0})}__getNodeRect(){var e=this.getNode();if(!e)return{x:-_T,y:-_T,width:0,height:0,rotation:0};const t=[];this.nodes().map(c=>{const u=c.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var h=[{x:u.x,y:u.y},{x:u.x+u.width,y:u.y},{x:u.x+u.width,y:u.y+u.height},{x:u.x,y:u.y+u.height}],d=c.getAbsoluteTransform();h.forEach(function(f){var _=d.point(f);t.push(_)})});const i=new qt.Transform;i.rotate(-An.Konva.getAngle(this.rotation()));var r=1/0,s=1/0,a=-1/0,l=-1/0;t.forEach(function(c){var u=i.point(c);r===void 0&&(r=a=u.x,s=l=u.y),r=Math.min(r,u.x),s=Math.min(s,u.y),a=Math.max(a,u.x),l=Math.max(l,u.y)}),i.invert();const o=i.point({x:r,y:s});return{x:o.x,y:o.y,width:a-r,height:l-s,rotation:An.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Wd.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){var t=new uG.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:pG?10:"auto"}),i=this;t.on("mousedown touchstart",function(r){i._handleMouseDown(r)}),t.on("dragstart",r=>{t.stopDrag(),r.cancelBubble=!0}),t.on("dragend",r=>{r.cancelBubble=!0}),t.on("mouseenter",()=>{var r=An.Konva.getAngle(this.rotation()),s=this.rotateAnchorCursor(),a=gG(e,r,s);t.getStage().content&&(t.getStage().content.style.cursor=a),this._cursorChange=!0}),t.on("mouseout",()=>{t.getStage().content&&(t.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(t)}_createBack(){var e=new cG.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(t,i){var r=i.getParent(),s=r.padding();t.beginPath(),t.rect(-s,-s,i.width()+s*2,i.height()+s*2),t.moveTo(i.width()/2,-s),r.rotateEnabled()&&r.rotateLineVisible()&&t.lineTo(i.width()/2,-r.rotateAnchorOffset()*qt.Util._sign(i.height())-s),t.fillStrokeShape(i)},hitFunc:(t,i)=>{if(this.shouldOverdrawWholeArea()){var r=this.padding();t.beginPath(),t.rect(-r,-r,i.width()+r*2,i.height()+r*2),t.fillStrokeShape(i)}}});this.add(e),this._proxyDrag(e),e.on("dragstart",t=>{t.cancelBubble=!0}),e.on("dragmove",t=>{t.cancelBubble=!0}),e.on("dragend",t=>{t.cancelBubble=!0}),this.on("dragmove",t=>{this.update()})}_handleMouseDown(e){this._movingAnchorName=e.target.name().split(" ")[0];var t=this._getNodeRect(),i=t.width,r=t.height,s=Math.sqrt(Math.pow(i,2)+Math.pow(r,2));this.sin=Math.abs(r/s),this.cos=Math.abs(i/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var a=e.target.getAbsolutePosition(),l=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:l.x-a.x,y:l.y-a.y},Hg++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(o=>{o._fire("transformstart",{evt:e.evt,target:o})})}_handleMouseMove(e){var t,i,r,s=this.findOne("."+this._movingAnchorName),a=s.getStage();a.setPointersPositions(e);const l=a.getPointerPosition();let o={x:l.x-this._anchorDragOffset.x,y:l.y-this._anchorDragOffset.y};const c=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(o=this.anchorDragBoundFunc()(c,o,e)),s.setAbsolutePosition(o);const u=s.getAbsolutePosition();if(!(c.x===u.x&&c.y===u.y)){if(this._movingAnchorName==="rotater"){var h=this._getNodeRect();t=s.x()-h.width/2,i=-s.y()+h.height/2;let K=Math.atan2(-i,t)+Math.PI/2;h.height<0&&(K-=Math.PI);var d=An.Konva.getAngle(this.rotation());const q=d+K,se=An.Konva.getAngle(this.rotationSnapTolerance()),Se=EG(this.rotationSnaps(),q,se)-h.rotation,$=vG(h,Se);this._fitNodesInto($,e);return}var f=this.shiftBehavior(),_;f==="inverted"?_=this.keepRatio()&&!e.shiftKey:f==="none"?_=this.keepRatio():_=this.keepRatio()||e.shiftKey;var m=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(_){var p=m?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(p.x-s.x(),2)+Math.pow(p.y-s.y(),2));var v=this.findOne(".top-left").x()>p.x?-1:1,E=this.findOne(".top-left").y()>p.y?-1:1;t=r*this.cos*v,i=r*this.sin*E,this.findOne(".top-left").x(p.x-t),this.findOne(".top-left").y(p.y-i)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(_){var p=m?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(s.x()-p.x,2)+Math.pow(p.y-s.y(),2));var v=this.findOne(".top-right").x()<p.x?-1:1,E=this.findOne(".top-right").y()>p.y?-1:1;t=r*this.cos*v,i=r*this.sin*E,this.findOne(".top-right").x(p.x+t),this.findOne(".top-right").y(p.y-i)}var g=s.position();this.findOne(".top-left").y(g.y),this.findOne(".bottom-right").x(g.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(_){var p=m?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(p.x-s.x(),2)+Math.pow(s.y()-p.y,2));var v=p.x<s.x()?-1:1,E=s.y()<p.y?-1:1;t=r*this.cos*v,i=r*this.sin*E,s.x(p.x-t),s.y(p.y+i)}g=s.position(),this.findOne(".top-left").x(g.x),this.findOne(".bottom-right").y(g.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(_){var p=m?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(s.x()-p.x,2)+Math.pow(s.y()-p.y,2));var v=this.findOne(".bottom-right").x()<p.x?-1:1,E=this.findOne(".bottom-right").y()<p.y?-1:1;t=r*this.cos*v,i=r*this.sin*E,this.findOne(".bottom-right").x(p.x+t),this.findOne(".bottom-right").y(p.y+i)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var m=this.centeredScaling()||e.altKey;if(m){var y=this.findOne(".top-left"),T=this.findOne(".bottom-right"),b=y.x(),C=y.y(),M=this.getWidth()-T.x(),F=this.getHeight()-T.y();T.move({x:-b,y:-C}),y.move({x:M,y:F})}var P=this.findOne(".top-left").getAbsolutePosition();t=P.x,i=P.y;var U=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),G=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:t,y:i,width:U,height:G,rotation:An.Konva.getAngle(this.rotation())},e)}}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var t;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var i=this.getNode();Hg--,this._fire("transformend",{evt:e,target:i}),(t=this.getLayer())===null||t===void 0||t.batchDraw(),i&&this._nodes.forEach(r=>{var s;r._fire("transformend",{evt:e,target:r}),(s=r.getLayer())===null||s===void 0||s.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,t){var i=this._getNodeRect();const r=1;if(qt.Util._inRange(e.width,-this.padding()*2-r,r)){this.update();return}if(qt.Util._inRange(e.height,-this.padding()*2-r,r)){this.update();return}var s=new qt.Transform;if(s.rotate(An.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const d=s.point({x:-this.padding()*2,y:0});e.x+=d.x,e.y+=d.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const d=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const d=s.point({x:0,y:-this.padding()*2});e.x+=d.x,e.y+=d.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const d=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const d=this.boundBoxFunc()(i,e);d?e=d:qt.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const a=1e7,l=new qt.Transform;l.translate(i.x,i.y),l.rotate(i.rotation),l.scale(i.width/a,i.height/a);const o=new qt.Transform,c=e.width/a,u=e.height/a;this.flipEnabled()===!1?(o.translate(e.x,e.y),o.rotate(e.rotation),o.translate(e.width<0?e.width:0,e.height<0?e.height:0),o.scale(Math.abs(c),Math.abs(u))):(o.translate(e.x,e.y),o.rotate(e.rotation),o.scale(c,u));const h=o.multiply(l.invert());this._nodes.forEach(d=>{var f;const _=d.getParent().getAbsoluteTransform(),p=d.getTransform().copy();p.translate(d.offsetX(),d.offsetY());const v=new qt.Transform;v.multiply(_.copy().invert()).multiply(h).multiply(_).multiply(p);const E=v.decompose();d.setAttrs(E),(f=d.getLayer())===null||f===void 0||f.batchDraw()}),this.rotation(qt.Util._getRotation(e.rotation)),this._nodes.forEach(d=>{this._fire("transform",{evt:t,target:d}),d._fire("transform",{evt:t,target:d})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,t){this.findOne(e).setAttrs(t)}update(){var e,t=this._getNodeRect();this.rotation(qt.Util._getRotation(t.rotation));var i=t.width,r=t.height,s=this.enabledAnchors(),a=this.resizeEnabled(),l=this.padding(),o=this.anchorSize();const c=this.find("._anchor");c.forEach(h=>{h.setAttrs({width:o,height:o,offsetX:o/2,offsetY:o/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:o/2+l,offsetY:o/2+l,visible:a&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:o/2+l,visible:a&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:o/2-l,offsetY:o/2+l,visible:a&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:o/2+l,visible:a&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:r/2,offsetX:o/2-l,visible:a&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:o/2+l,offsetY:o/2-l,visible:a&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:r,offsetY:o/2-l,visible:a&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:r,offsetX:o/2-l,offsetY:o/2-l,visible:a&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:i/2,y:-this.rotateAnchorOffset()*qt.Util._sign(r)-l,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const u=this.anchorStyleFunc();u&&c.forEach(h=>{u(h)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),dT.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return hT.Node.prototype.toObject.call(this)}clone(e){var t=hT.Node.prototype.clone.call(this,e);return t}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Jf.Transformer=wt;wt.isTransforming=()=>Hg>0;function yG(n){return n instanceof Array||qt.Util.warn("enabledAnchors value should be an array"),n instanceof Array&&n.forEach(function(e){Wd.indexOf(e)===-1&&qt.Util.warn("Unknown anchor name: "+e+". Available names are: "+Wd.join(", "))}),n||[]}wt.prototype.className="Transformer";(0,hG._registerNode)(wt);Vt.Factory.addGetterSetter(wt,"enabledAnchors",Wd,yG);Vt.Factory.addGetterSetter(wt,"flipEnabled",!0,(0,qa.getBooleanValidator)());Vt.Factory.addGetterSetter(wt,"resizeEnabled",!0);Vt.Factory.addGetterSetter(wt,"anchorSize",10,(0,qa.getNumberValidator)());Vt.Factory.addGetterSetter(wt,"rotateEnabled",!0);Vt.Factory.addGetterSetter(wt,"rotateLineVisible",!0);Vt.Factory.addGetterSetter(wt,"rotationSnaps",[]);Vt.Factory.addGetterSetter(wt,"rotateAnchorOffset",50,(0,qa.getNumberValidator)());Vt.Factory.addGetterSetter(wt,"rotateAnchorCursor","crosshair");Vt.Factory.addGetterSetter(wt,"rotationSnapTolerance",5,(0,qa.getNumberValidator)());Vt.Factory.addGetterSetter(wt,"borderEnabled",!0);Vt.Factory.addGetterSetter(wt,"anchorStroke","rgb(0, 161, 255)");Vt.Factory.addGetterSetter(wt,"anchorStrokeWidth",1,(0,qa.getNumberValidator)());Vt.Factory.addGetterSetter(wt,"anchorFill","white");Vt.Factory.addGetterSetter(wt,"anchorCornerRadius",0,(0,qa.getNumberValidator)());Vt.Factory.addGetterSetter(wt,"borderStroke","rgb(0, 161, 255)");Vt.Factory.addGetterSetter(wt,"borderStrokeWidth",1,(0,qa.getNumberValidator)());Vt.Factory.addGetterSetter(wt,"borderDash");Vt.Factory.addGetterSetter(wt,"keepRatio",!0);Vt.Factory.addGetterSetter(wt,"shiftBehavior","default");Vt.Factory.addGetterSetter(wt,"centeredScaling",!1);Vt.Factory.addGetterSetter(wt,"ignoreStroke",!1);Vt.Factory.addGetterSetter(wt,"padding",0,(0,qa.getNumberValidator)());Vt.Factory.addGetterSetter(wt,"node");Vt.Factory.addGetterSetter(wt,"nodes");Vt.Factory.addGetterSetter(wt,"boundBoxFunc");Vt.Factory.addGetterSetter(wt,"anchorDragBoundFunc");Vt.Factory.addGetterSetter(wt,"anchorStyleFunc");Vt.Factory.addGetterSetter(wt,"shouldOverdrawWholeArea",!1);Vt.Factory.addGetterSetter(wt,"useSingleNodeRotation",!0);Vt.Factory.backCompat(wt,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var e_={};Object.defineProperty(e_,"__esModule",{value:!0});e_.Wedge=void 0;const t_=mt,TG=er,bG=gt,IS=We,CG=gt;class qs extends TG.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,bG.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}e_.Wedge=qs;qs.prototype.className="Wedge";qs.prototype._centroid=!0;qs.prototype._attrsAffectingSize=["radius"];(0,CG._registerNode)(qs);t_.Factory.addGetterSetter(qs,"radius",0,(0,IS.getNumberValidator)());t_.Factory.addGetterSetter(qs,"angle",0,(0,IS.getNumberValidator)());t_.Factory.addGetterSetter(qs,"clockwise",!1);t_.Factory.backCompat(qs,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var i_={};Object.defineProperty(i_,"__esModule",{value:!0});i_.Blur=void 0;const pT=mt,AG=gi,SG=We;function gT(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var RG=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],xG=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function MG(n,e){var t=n.data,i=n.width,r=n.height,s,a,l,o,c,u,h,d,f,_,p,v,E,g,m,y,T,b,C,M,F,P,U,G,K=e+e+1,q=i-1,se=r-1,Ee=e+1,Se=Ee*(Ee+1)/2,$=new gT,_e=null,ae=$,ce=null,he=null,je=RG[e],Xe=xG[e];for(l=1;l<K;l++)ae=ae.next=new gT,l===Ee&&(_e=ae);for(ae.next=$,h=u=0,a=0;a<r;a++){for(y=T=b=C=d=f=_=p=0,v=Ee*(M=t[u]),E=Ee*(F=t[u+1]),g=Ee*(P=t[u+2]),m=Ee*(U=t[u+3]),d+=Se*M,f+=Se*F,_+=Se*P,p+=Se*U,ae=$,l=0;l<Ee;l++)ae.r=M,ae.g=F,ae.b=P,ae.a=U,ae=ae.next;for(l=1;l<Ee;l++)o=u+((q<l?q:l)<<2),d+=(ae.r=M=t[o])*(G=Ee-l),f+=(ae.g=F=t[o+1])*G,_+=(ae.b=P=t[o+2])*G,p+=(ae.a=U=t[o+3])*G,y+=M,T+=F,b+=P,C+=U,ae=ae.next;for(ce=$,he=_e,s=0;s<i;s++)t[u+3]=U=p*je>>Xe,U!==0?(U=255/U,t[u]=(d*je>>Xe)*U,t[u+1]=(f*je>>Xe)*U,t[u+2]=(_*je>>Xe)*U):t[u]=t[u+1]=t[u+2]=0,d-=v,f-=E,_-=g,p-=m,v-=ce.r,E-=ce.g,g-=ce.b,m-=ce.a,o=h+((o=s+e+1)<q?o:q)<<2,y+=ce.r=t[o],T+=ce.g=t[o+1],b+=ce.b=t[o+2],C+=ce.a=t[o+3],d+=y,f+=T,_+=b,p+=C,ce=ce.next,v+=M=he.r,E+=F=he.g,g+=P=he.b,m+=U=he.a,y-=M,T-=F,b-=P,C-=U,he=he.next,u+=4;h+=i}for(s=0;s<i;s++){for(T=b=C=y=f=_=p=d=0,u=s<<2,v=Ee*(M=t[u]),E=Ee*(F=t[u+1]),g=Ee*(P=t[u+2]),m=Ee*(U=t[u+3]),d+=Se*M,f+=Se*F,_+=Se*P,p+=Se*U,ae=$,l=0;l<Ee;l++)ae.r=M,ae.g=F,ae.b=P,ae.a=U,ae=ae.next;for(c=i,l=1;l<=e;l++)u=c+s<<2,d+=(ae.r=M=t[u])*(G=Ee-l),f+=(ae.g=F=t[u+1])*G,_+=(ae.b=P=t[u+2])*G,p+=(ae.a=U=t[u+3])*G,y+=M,T+=F,b+=P,C+=U,ae=ae.next,l<se&&(c+=i);for(u=s,ce=$,he=_e,a=0;a<r;a++)o=u<<2,t[o+3]=U=p*je>>Xe,U>0?(U=255/U,t[o]=(d*je>>Xe)*U,t[o+1]=(f*je>>Xe)*U,t[o+2]=(_*je>>Xe)*U):t[o]=t[o+1]=t[o+2]=0,d-=v,f-=E,_-=g,p-=m,v-=ce.r,E-=ce.g,g-=ce.b,m-=ce.a,o=s+((o=a+Ee)<se?o:se)*i<<2,d+=y+=ce.r=t[o],f+=T+=ce.g=t[o+1],_+=b+=ce.b=t[o+2],p+=C+=ce.a=t[o+3],ce=ce.next,v+=M=he.r,E+=F=he.g,g+=P=he.b,m+=U=he.a,y-=M,T-=F,b-=P,C-=U,he=he.next,u+=i}}const IG=function(e){var t=Math.round(this.blurRadius());t>0&&MG(e,t)};i_.Blur=IG;pT.Factory.addGetterSetter(AG.Node,"blurRadius",0,(0,SG.getNumberValidator)(),pT.Factory.afterSetFilter);var r_={};Object.defineProperty(r_,"__esModule",{value:!0});r_.Brighten=void 0;const mT=mt,PG=gi,wG=We,OG=function(n){var e=this.brightness()*255,t=n.data,i=t.length,r;for(r=0;r<i;r+=4)t[r]+=e,t[r+1]+=e,t[r+2]+=e};r_.Brighten=OG;mT.Factory.addGetterSetter(PG.Node,"brightness",0,(0,wG.getNumberValidator)(),mT.Factory.afterSetFilter);var n_={};Object.defineProperty(n_,"__esModule",{value:!0});n_.Contrast=void 0;const vT=mt,DG=gi,LG=We,NG=function(n){var e=Math.pow((this.contrast()+100)/100,2),t=n.data,i=t.length,r=150,s=150,a=150,l;for(l=0;l<i;l+=4)r=t[l],s=t[l+1],a=t[l+2],r/=255,r-=.5,r*=e,r+=.5,r*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,a/=255,a-=.5,a*=e,a+=.5,a*=255,r=r<0?0:r>255?255:r,s=s<0?0:s>255?255:s,a=a<0?0:a>255?255:a,t[l]=r,t[l+1]=s,t[l+2]=a};n_.Contrast=NG;vT.Factory.addGetterSetter(DG.Node,"contrast",0,(0,LG.getNumberValidator)(),vT.Factory.afterSetFilter);var s_={};Object.defineProperty(s_,"__esModule",{value:!0});s_.Emboss=void 0;const Ba=mt,a_=gi,FG=Ci,PS=We,kG=function(n){var e=this.embossStrength()*10,t=this.embossWhiteLevel()*255,i=this.embossDirection(),r=this.embossBlend(),s=0,a=0,l=n.data,o=n.width,c=n.height,u=o*4,h=c;switch(i){case"top-left":s=-1,a=-1;break;case"top":s=-1,a=0;break;case"top-right":s=-1,a=1;break;case"right":s=0,a=1;break;case"bottom-right":s=1,a=1;break;case"bottom":s=1,a=0;break;case"bottom-left":s=1,a=-1;break;case"left":s=0,a=-1;break;default:FG.Util.error("Unknown emboss direction: "+i)}do{var d=(h-1)*u,f=s;h+f<1&&(f=0),h+f>c&&(f=0);var _=(h-1+f)*o*4,p=o;do{var v=d+(p-1)*4,E=a;p+E<1&&(E=0),p+E>o&&(E=0);var g=_+(p-1+E)*4,m=l[v]-l[g],y=l[v+1]-l[g+1],T=l[v+2]-l[g+2],b=m,C=b>0?b:-b,M=y>0?y:-y,F=T>0?T:-T;if(M>C&&(b=y),F>C&&(b=T),b*=e,r){var P=l[v]+b,U=l[v+1]+b,G=l[v+2]+b;l[v]=P>255?255:P<0?0:P,l[v+1]=U>255?255:U<0?0:U,l[v+2]=G>255?255:G<0?0:G}else{var K=t-b;K<0?K=0:K>255&&(K=255),l[v]=l[v+1]=l[v+2]=K}}while(--p)}while(--h)};s_.Emboss=kG;Ba.Factory.addGetterSetter(a_.Node,"embossStrength",.5,(0,PS.getNumberValidator)(),Ba.Factory.afterSetFilter);Ba.Factory.addGetterSetter(a_.Node,"embossWhiteLevel",.5,(0,PS.getNumberValidator)(),Ba.Factory.afterSetFilter);Ba.Factory.addGetterSetter(a_.Node,"embossDirection","top-left",null,Ba.Factory.afterSetFilter);Ba.Factory.addGetterSetter(a_.Node,"embossBlend",!1,null,Ba.Factory.afterSetFilter);var o_={};Object.defineProperty(o_,"__esModule",{value:!0});o_.Enhance=void 0;const ET=mt,BG=gi,UG=We;function Ep(n,e,t,i,r){var s=t-e,a=r-i,l;return s===0?i+a/2:a===0?i:(l=(n-e)/s,l=a*l+i,l)}const zG=function(n){var e=n.data,t=e.length,i=e[0],r=i,s,a=e[1],l=a,o,c=e[2],u=c,h,d,f=this.enhance();if(f!==0){for(d=0;d<t;d+=4)s=e[d+0],s<i?i=s:s>r&&(r=s),o=e[d+1],o<a?a=o:o>l&&(l=o),h=e[d+2],h<c?c=h:h>u&&(u=h);r===i&&(r=255,i=0),l===a&&(l=255,a=0),u===c&&(u=255,c=0);var _,p,v,E,g,m,y,T,b;for(f>0?(p=r+f*(255-r),v=i-f*(i-0),g=l+f*(255-l),m=a-f*(a-0),T=u+f*(255-u),b=c-f*(c-0)):(_=(r+i)*.5,p=r+f*(r-_),v=i+f*(i-_),E=(l+a)*.5,g=l+f*(l-E),m=a+f*(a-E),y=(u+c)*.5,T=u+f*(u-y),b=c+f*(c-y)),d=0;d<t;d+=4)e[d+0]=Ep(e[d+0],i,r,v,p),e[d+1]=Ep(e[d+1],a,l,m,g),e[d+2]=Ep(e[d+2],c,u,b,T)}};o_.Enhance=zG;ET.Factory.addGetterSetter(BG.Node,"enhance",0,(0,UG.getNumberValidator)(),ET.Factory.afterSetFilter);var l_={};Object.defineProperty(l_,"__esModule",{value:!0});l_.Grayscale=void 0;const VG=function(n){var e=n.data,t=e.length,i,r;for(i=0;i<t;i+=4)r=.34*e[i]+.5*e[i+1]+.16*e[i+2],e[i]=r,e[i+1]=r,e[i+2]=r};l_.Grayscale=VG;var c_={};Object.defineProperty(c_,"__esModule",{value:!0});c_.HSL=void 0;const $l=mt,O0=gi,D0=We;$l.Factory.addGetterSetter(O0.Node,"hue",0,(0,D0.getNumberValidator)(),$l.Factory.afterSetFilter);$l.Factory.addGetterSetter(O0.Node,"saturation",0,(0,D0.getNumberValidator)(),$l.Factory.afterSetFilter);$l.Factory.addGetterSetter(O0.Node,"luminance",0,(0,D0.getNumberValidator)(),$l.Factory.afterSetFilter);const GG=function(n){var e=n.data,t=e.length,i=1,r=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,a=this.luminance()*127,l,o=i*r*Math.cos(s*Math.PI/180),c=i*r*Math.sin(s*Math.PI/180),u=.299*i+.701*o+.167*c,h=.587*i-.587*o+.33*c,d=.114*i-.114*o-.497*c,f=.299*i-.299*o-.328*c,_=.587*i+.413*o+.035*c,p=.114*i-.114*o+.293*c,v=.299*i-.3*o+1.25*c,E=.587*i-.586*o-1.05*c,g=.114*i+.886*o-.2*c,m,y,T,b;for(l=0;l<t;l+=4)m=e[l+0],y=e[l+1],T=e[l+2],b=e[l+3],e[l+0]=u*m+h*y+d*T+a,e[l+1]=f*m+_*y+p*T+a,e[l+2]=v*m+E*y+g*T+a,e[l+3]=b};c_.HSL=GG;var u_={};Object.defineProperty(u_,"__esModule",{value:!0});u_.HSV=void 0;const Ql=mt,L0=gi,N0=We,WG=function(n){var e=n.data,t=e.length,i=Math.pow(2,this.value()),r=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,a,l=i*r*Math.cos(s*Math.PI/180),o=i*r*Math.sin(s*Math.PI/180),c=.299*i+.701*l+.167*o,u=.587*i-.587*l+.33*o,h=.114*i-.114*l-.497*o,d=.299*i-.299*l-.328*o,f=.587*i+.413*l+.035*o,_=.114*i-.114*l+.293*o,p=.299*i-.3*l+1.25*o,v=.587*i-.586*l-1.05*o,E=.114*i+.886*l-.2*o,g,m,y,T;for(a=0;a<t;a+=4)g=e[a+0],m=e[a+1],y=e[a+2],T=e[a+3],e[a+0]=c*g+u*m+h*y,e[a+1]=d*g+f*m+_*y,e[a+2]=p*g+v*m+E*y,e[a+3]=T};u_.HSV=WG;Ql.Factory.addGetterSetter(L0.Node,"hue",0,(0,N0.getNumberValidator)(),Ql.Factory.afterSetFilter);Ql.Factory.addGetterSetter(L0.Node,"saturation",0,(0,N0.getNumberValidator)(),Ql.Factory.afterSetFilter);Ql.Factory.addGetterSetter(L0.Node,"value",0,(0,N0.getNumberValidator)(),Ql.Factory.afterSetFilter);var h_={};Object.defineProperty(h_,"__esModule",{value:!0});h_.Invert=void 0;const HG=function(n){var e=n.data,t=e.length,i;for(i=0;i<t;i+=4)e[i]=255-e[i],e[i+1]=255-e[i+1],e[i+2]=255-e[i+2]};h_.Invert=HG;var d_={};Object.defineProperty(d_,"__esModule",{value:!0});d_.Kaleidoscope=void 0;const Hd=mt,wS=gi,yT=Ci,OS=We;var jG=function(n,e,t){var i=n.data,r=e.data,s=n.width,a=n.height,l=t.polarCenterX||s/2,o=t.polarCenterY||a/2,c,u,h,d=0,f=0,_=0,p=0,v,E=Math.sqrt(l*l+o*o);u=s-l,h=a-o,v=Math.sqrt(u*u+h*h),E=v>E?v:E;var g=a,m=s,y,T,b=360/m*Math.PI/180,C,M;for(T=0;T<m;T+=1)for(C=Math.sin(T*b),M=Math.cos(T*b),y=0;y<g;y+=1)u=Math.floor(l+E*y/g*M),h=Math.floor(o+E*y/g*C),c=(h*s+u)*4,d=i[c+0],f=i[c+1],_=i[c+2],p=i[c+3],c=(T+y*s)*4,r[c+0]=d,r[c+1]=f,r[c+2]=_,r[c+3]=p},XG=function(n,e,t){var i=n.data,r=e.data,s=n.width,a=n.height,l=t.polarCenterX||s/2,o=t.polarCenterY||a/2,c,u,h,d,f,_=0,p=0,v=0,E=0,g,m=Math.sqrt(l*l+o*o);u=s-l,h=a-o,g=Math.sqrt(u*u+h*h),m=g>m?g:m;var y=a,T=s,b,C,M=0,F,P;for(u=0;u<s;u+=1)for(h=0;h<a;h+=1)d=u-l,f=h-o,b=Math.sqrt(d*d+f*f)*y/m,C=(Math.atan2(f,d)*180/Math.PI+360+M)%360,C=C*T/360,F=Math.floor(C),P=Math.floor(b),c=(P*s+F)*4,_=i[c+0],p=i[c+1],v=i[c+2],E=i[c+3],c=(h*s+u)*4,r[c+0]=_,r[c+1]=p,r[c+2]=v,r[c+3]=E};const YG=function(n){var e=n.width,t=n.height,i,r,s,a,l,o,c,u,h,d,f=Math.round(this.kaleidoscopePower()),_=Math.round(this.kaleidoscopeAngle()),p=Math.floor(e*(_%360)/360);if(!(f<1)){var v=yT.Util.createCanvasElement();v.width=e,v.height=t;var E=v.getContext("2d").getImageData(0,0,e,t);yT.Util.releaseCanvas(v),jG(n,E,{polarCenterX:e/2,polarCenterY:t/2});for(var g=e/Math.pow(2,f);g<=8;)g=g*2,f-=1;g=Math.ceil(g);var m=g,y=0,T=m,b=1;for(p+g>e&&(y=m,T=0,b=-1),r=0;r<t;r+=1)for(i=y;i!==T;i+=b)s=Math.round(i+p)%e,h=(e*r+s)*4,l=E.data[h+0],o=E.data[h+1],c=E.data[h+2],u=E.data[h+3],d=(e*r+i)*4,E.data[d+0]=l,E.data[d+1]=o,E.data[d+2]=c,E.data[d+3]=u;for(r=0;r<t;r+=1)for(m=Math.floor(g),a=0;a<f;a+=1){for(i=0;i<m+1;i+=1)h=(e*r+i)*4,l=E.data[h+0],o=E.data[h+1],c=E.data[h+2],u=E.data[h+3],d=(e*r+m*2-i-1)*4,E.data[d+0]=l,E.data[d+1]=o,E.data[d+2]=c,E.data[d+3]=u;m*=2}XG(E,n,{polarRotation:0})}};d_.Kaleidoscope=YG;Hd.Factory.addGetterSetter(wS.Node,"kaleidoscopePower",2,(0,OS.getNumberValidator)(),Hd.Factory.afterSetFilter);Hd.Factory.addGetterSetter(wS.Node,"kaleidoscopeAngle",0,(0,OS.getNumberValidator)(),Hd.Factory.afterSetFilter);var f_={};Object.defineProperty(f_,"__esModule",{value:!0});f_.Mask=void 0;const TT=mt,KG=gi,qG=We;function Ph(n,e,t){var i=(t*n.width+e)*4,r=[];return r.push(n.data[i++],n.data[i++],n.data[i++],n.data[i++]),r}function Dc(n,e){return Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)+Math.pow(n[2]-e[2],2))}function $G(n){for(var e=[0,0,0],t=0;t<n.length;t++)e[0]+=n[t][0],e[1]+=n[t][1],e[2]+=n[t][2];return e[0]/=n.length,e[1]/=n.length,e[2]/=n.length,e}function QG(n,e){var t=Ph(n,0,0),i=Ph(n,n.width-1,0),r=Ph(n,0,n.height-1),s=Ph(n,n.width-1,n.height-1),a=e||10;if(Dc(t,i)<a&&Dc(i,s)<a&&Dc(s,r)<a&&Dc(r,t)<a){for(var l=$G([i,t,s,r]),o=[],c=0;c<n.width*n.height;c++){var u=Dc(l,[n.data[c*4],n.data[c*4+1],n.data[c*4+2]]);o[c]=u<a?0:255}return o}}function ZG(n,e){for(var t=0;t<n.width*n.height;t++)n.data[4*t+3]=e[t]}function JG(n,e,t){for(var i=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(i.length)),s=Math.floor(r/2),a=[],l=0;l<t;l++)for(var o=0;o<e;o++){for(var c=l*e+o,u=0,h=0;h<r;h++)for(var d=0;d<r;d++){var f=l+h-s,_=o+d-s;if(f>=0&&f<t&&_>=0&&_<e){var p=f*e+_,v=i[h*r+d];u+=n[p]*v}}a[c]=u===255*8?255:0}return a}function eW(n,e,t){for(var i=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(i.length)),s=Math.floor(r/2),a=[],l=0;l<t;l++)for(var o=0;o<e;o++){for(var c=l*e+o,u=0,h=0;h<r;h++)for(var d=0;d<r;d++){var f=l+h-s,_=o+d-s;if(f>=0&&f<t&&_>=0&&_<e){var p=f*e+_,v=i[h*r+d];u+=n[p]*v}}a[c]=u>=255*4?255:0}return a}function tW(n,e,t){for(var i=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],r=Math.round(Math.sqrt(i.length)),s=Math.floor(r/2),a=[],l=0;l<t;l++)for(var o=0;o<e;o++){for(var c=l*e+o,u=0,h=0;h<r;h++)for(var d=0;d<r;d++){var f=l+h-s,_=o+d-s;if(f>=0&&f<t&&_>=0&&_<e){var p=f*e+_,v=i[h*r+d];u+=n[p]*v}}a[c]=u}return a}const iW=function(n){var e=this.threshold(),t=QG(n,e);return t&&(t=JG(t,n.width,n.height),t=eW(t,n.width,n.height),t=tW(t,n.width,n.height),ZG(n,t)),n};f_.Mask=iW;TT.Factory.addGetterSetter(KG.Node,"threshold",0,(0,qG.getNumberValidator)(),TT.Factory.afterSetFilter);var __={};Object.defineProperty(__,"__esModule",{value:!0});__.Noise=void 0;const bT=mt,rW=gi,nW=We,sW=function(n){var e=this.noise()*255,t=n.data,i=t.length,r=e/2,s;for(s=0;s<i;s+=4)t[s+0]+=r-2*r*Math.random(),t[s+1]+=r-2*r*Math.random(),t[s+2]+=r-2*r*Math.random()};__.Noise=sW;bT.Factory.addGetterSetter(rW.Node,"noise",.2,(0,nW.getNumberValidator)(),bT.Factory.afterSetFilter);var p_={};Object.defineProperty(p_,"__esModule",{value:!0});p_.Pixelate=void 0;const CT=mt,aW=Ci,oW=gi,lW=We,cW=function(n){var e=Math.ceil(this.pixelSize()),t=n.width,i=n.height,r,s,a,l,o,c,u,h=Math.ceil(t/e),d=Math.ceil(i/e),f,_,p,v,E,g,m,y=n.data;if(e<=0){aW.Util.error("pixelSize value can not be <= 0");return}for(E=0;E<h;E+=1)for(g=0;g<d;g+=1){for(l=0,o=0,c=0,u=0,f=E*e,_=f+e,p=g*e,v=p+e,m=0,r=f;r<_;r+=1)if(!(r>=t))for(s=p;s<v;s+=1)s>=i||(a=(t*s+r)*4,l+=y[a+0],o+=y[a+1],c+=y[a+2],u+=y[a+3],m+=1);for(l=l/m,o=o/m,c=c/m,u=u/m,r=f;r<_;r+=1)if(!(r>=t))for(s=p;s<v;s+=1)s>=i||(a=(t*s+r)*4,y[a+0]=l,y[a+1]=o,y[a+2]=c,y[a+3]=u)}};p_.Pixelate=cW;CT.Factory.addGetterSetter(oW.Node,"pixelSize",8,(0,lW.getNumberValidator)(),CT.Factory.afterSetFilter);var g_={};Object.defineProperty(g_,"__esModule",{value:!0});g_.Posterize=void 0;const AT=mt,uW=gi,hW=We,dW=function(n){var e=Math.round(this.levels()*254)+1,t=n.data,i=t.length,r=255/e,s;for(s=0;s<i;s+=1)t[s]=Math.floor(t[s]/r)*r};g_.Posterize=dW;AT.Factory.addGetterSetter(uW.Node,"levels",.5,(0,hW.getNumberValidator)(),AT.Factory.afterSetFilter);var m_={};Object.defineProperty(m_,"__esModule",{value:!0});m_.RGB=void 0;const jd=mt,F0=gi,fW=We,_W=function(n){var e=n.data,t=e.length,i=this.red(),r=this.green(),s=this.blue(),a,l;for(a=0;a<t;a+=4)l=(.34*e[a]+.5*e[a+1]+.16*e[a+2])/255,e[a]=l*i,e[a+1]=l*r,e[a+2]=l*s,e[a+3]=e[a+3]};m_.RGB=_W;jd.Factory.addGetterSetter(F0.Node,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});jd.Factory.addGetterSetter(F0.Node,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});jd.Factory.addGetterSetter(F0.Node,"blue",0,fW.RGBComponent,jd.Factory.afterSetFilter);var v_={};Object.defineProperty(v_,"__esModule",{value:!0});v_.RGBA=void 0;const Du=mt,E_=gi,pW=We,gW=function(n){var e=n.data,t=e.length,i=this.red(),r=this.green(),s=this.blue(),a=this.alpha(),l,o;for(l=0;l<t;l+=4)o=1-a,e[l]=i*a+e[l]*o,e[l+1]=r*a+e[l+1]*o,e[l+2]=s*a+e[l+2]*o};v_.RGBA=gW;Du.Factory.addGetterSetter(E_.Node,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Du.Factory.addGetterSetter(E_.Node,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Du.Factory.addGetterSetter(E_.Node,"blue",0,pW.RGBComponent,Du.Factory.afterSetFilter);Du.Factory.addGetterSetter(E_.Node,"alpha",1,function(n){return this._filterUpToDate=!1,n>1?1:n<0?0:n});var y_={};Object.defineProperty(y_,"__esModule",{value:!0});y_.Sepia=void 0;const mW=function(n){var e=n.data,t=e.length,i,r,s,a;for(i=0;i<t;i+=4)r=e[i+0],s=e[i+1],a=e[i+2],e[i+0]=Math.min(255,r*.393+s*.769+a*.189),e[i+1]=Math.min(255,r*.349+s*.686+a*.168),e[i+2]=Math.min(255,r*.272+s*.534+a*.131)};y_.Sepia=mW;var T_={};Object.defineProperty(T_,"__esModule",{value:!0});T_.Solarize=void 0;const vW=function(n){var e=n.data,t=n.width,i=n.height,r=t*4,s=i;do{var a=(s-1)*r,l=t;do{var o=a+(l-1)*4,c=e[o],u=e[o+1],h=e[o+2];c>127&&(c=255-c),u>127&&(u=255-u),h>127&&(h=255-h),e[o]=c,e[o+1]=u,e[o+2]=h}while(--l)}while(--s)};T_.Solarize=vW;var b_={};Object.defineProperty(b_,"__esModule",{value:!0});b_.Threshold=void 0;const ST=mt,EW=gi,yW=We,TW=function(n){var e=this.threshold()*255,t=n.data,i=t.length,r;for(r=0;r<i;r+=1)t[r]=t[r]<e?0:255};b_.Threshold=TW;ST.Factory.addGetterSetter(EW.Node,"threshold",.5,(0,yW.getNumberValidator)(),ST.Factory.afterSetFilter);Object.defineProperty(wf,"__esModule",{value:!0});wf.Konva=void 0;const RT=QA,bW=kf,CW=zf,AW=Wf,SW=Hf,RW=jf,xT=ql,xW=Zu,MW=uc,IW=eh,PW=Kf,wW=qf,OW=$f,DW=Qf,LW=Do,NW=Zf,FW=Jf,kW=e_,BW=i_,UW=r_,zW=n_,VW=s_,GW=o_,WW=l_,HW=c_,jW=u_,XW=h_,YW=d_,KW=f_,qW=__,$W=p_,QW=g_,ZW=m_,JW=v_,eH=y_,tH=T_,iH=b_;wf.Konva=RT.Konva.Util._assign(RT.Konva,{Arc:bW.Arc,Arrow:CW.Arrow,Circle:AW.Circle,Ellipse:SW.Ellipse,Image:RW.Image,Label:xT.Label,Tag:xT.Tag,Line:xW.Line,Path:MW.Path,Rect:IW.Rect,RegularPolygon:PW.RegularPolygon,Ring:wW.Ring,Sprite:OW.Sprite,Star:DW.Star,Text:LW.Text,TextPath:NW.TextPath,Transformer:FW.Transformer,Wedge:kW.Wedge,Filters:{Blur:BW.Blur,Brighten:UW.Brighten,Contrast:zW.Contrast,Emboss:VW.Emboss,Enhance:GW.Enhance,Grayscale:WW.Grayscale,HSL:HW.HSL,HSV:jW.HSV,Invert:XW.Invert,Kaleidoscope:YW.Kaleidoscope,Mask:KW.Mask,Noise:qW.Noise,Pixelate:$W.Pixelate,Posterize:QW.Posterize,RGB:ZW.RGB,RGBA:JW.RGBA,Sepia:eH.Sepia,Solarize:tH.Solarize,Threshold:iH.Threshold}});var rH=b0.exports;Object.defineProperty(rH,"__esModule",{value:!0});const nH=wf;b0.exports=nH.Konva;var sH=b0.exports;const iu=nm(sH);function aH(){return fe.jsxs(Ds.Content,{className:"no-tile-selected",height:"90%",children:[fe.jsx(Ru,{type:"secondary",span:!0,h4:!0,children:"No tile selected..."}),fe.jsx(Ru,{type:"secondary",span:!0,small:!0,children:"Select a tile to get more information about it"})]})}function MT({children:n}){return fe.jsxs(Ds,{width:"100%",children:[fe.jsx(Ds.Content,{children:fe.jsx(Ru,{b:!0,children:"Tile Info"})}),fe.jsx(UU,{h:"1px",my:0}),fe.jsx(Ds.Content,{className:"tile-viewer-main-content",children:n})]})}function oH({textureFileName:n,tile:e}){const t=S.useRef(null);return S.useEffect(()=>{const i=ls.get();if(!(t!=null&&t.current)||!e||!i.assets){console.error("err");return}t.current.width=e.rect.width,t.current.height=e.rect.height;const r=i.assets[Vs.Texture].get(n);if(!r){console.error("No texture file");return}const s=t.current.getContext("2d");if(!s){console.error("no ctx");return}const a=r.getTexture(e.textureId),l=s.createImageData(e.rect.width,e.rect.height);l.data.set(a.pixels),s.putImageData(l,0,0)},[n,e]),e?fe.jsx(MT,{children:fe.jsx("canvas",{ref:t,className:"tile-canvas"})}):fe.jsx(MT,{children:fe.jsx(aH,{})})}function lH(n,e,t){if(!n.tileMap){console.warn("tileMap is not set!");return}const i=new iu.Group,r=document.createElement("canvas"),s=r.getContext("2d");if(!s){console.error("Cannot get context...");return}const a=new iu.Rect({stroke:"#ff00007c",strokeScaleEnabled:!0,listening:!1});for(const l of n.tileMap){const o=n.textures[l.textureId];r.width=o.info.width,r.height=o.info.height;const c=new ImageData(o.pixels,o.info.width,o.info.height);s.putImageData(c,0,0),iu.Image.fromURL(r.toDataURL(),function(u){u.setAttrs({x:l.rect.left,y:l.rect.top}),u.on("mouseover",function(){a.setAttrs({visible:!0,x:l.rect.left-1,y:l.rect.top-1,width:l.rect.width+2,height:l.rect.height+2})}),u.on("mouseout",function(){a.visible(!1)}),u.on("click",function(){t(l)}),i.add(u)})}e.add(i),e.add(a)}function cH(n){const e=new iu.Stage({container:n,width:n.clientWidth,height:n.clientHeight,draggable:!0,scale:{x:3,y:3}});return e.on("wheel",t=>{if(t.evt.preventDefault(),!t.evt.deltaY)return;const i=e.scale()||{x:1,y:1},r=e.getPointerPosition(),s={x:(r.x-e.x())/i.x,y:(r.y-e.y())/i.y};t.evt.deltaY>0?(i.x=Math.max(.5,i.x-.5),i.y=Math.max(.5,i.y-.5)):(i.x=Math.max(.5,i.x+.5),i.y=Math.max(.5,i.y+.5)),e.scale(i),e.position({x:r.x-s.x*i.x,y:r.y-s.y*i.y})}),e}function uH(n){const e=n.container();n.size({width:e.clientWidth,height:e.clientHeight})}function hH({textureFile:n}){const e=S.useRef(null),[t,i]=S.useState(),r=S.useCallback(s=>{i(s)},[]);return S.useEffect(()=>{if(!e.current)return;const s=cH(e.current),a=()=>uH(s),l=new iu.Layer({imageSmoothingEnabled:!1});return s.add(l),lH(n,l,r),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[r,n]),fe.jsxs(lr.Container,{gap:8,children:[fe.jsx(lr,{xs:17,children:fe.jsx(Ds,{width:"100%",children:fe.jsx("div",{className:"tilemap-container",ref:e})})}),fe.jsx(lr,{xs:7,width:"100%",children:fe.jsx(oH,{textureFileName:n.name,tile:t})})]})}function jg(){const n=dz();switch(n==null?void 0:n.assetType){case Vs.Texture:return fe.jsx(hH,{textureFile:n});case Vs.Model:{const e=n;return e.isStage?fe.jsx(a9,{modelPack:e}):fe.jsx(Lz,{modelPack:n})}default:return}}jg.loader=function({params:n}){const e=n.assetType,t=n.assetName;if(!e||!t)return console.error(`Unable to find ${e}/${t}`),null;const i=ls.get();if(!i.assets)return console.error("No assets in game data. (did you call init?)"),null;const r=i.assets[e].get(t);return r||(console.warn(`Unable to find ${t} in game data`),null)};class Oa{get influence(){return this._influence}set influence(e){if(this._influence===e)return;const t=this._influence;this._influence=e,this.onInfluenceChanged.hasObservers()&&this.onInfluenceChanged.notifyObservers(t===0||e===0)}get animationPropertiesOverride(){return!this._animationPropertiesOverride&&this._scene?this._scene.animationPropertiesOverride:this._animationPropertiesOverride}set animationPropertiesOverride(e){this._animationPropertiesOverride=e}constructor(e,t=0,i=null){this.name=e,this.animations=[],this._positions=null,this._normals=null,this._tangents=null,this._uvs=null,this._uniqueId=0,this.onInfluenceChanged=new Y,this._onDataLayoutChanged=new Y,this._animationPropertiesOverride=null,this._scene=i||He.LastCreatedScene,this.influence=t,this._scene&&(this._uniqueId=this._scene.getUniqueId())}get uniqueId(){return this._uniqueId}get hasPositions(){return!!this._positions}get hasNormals(){return!!this._normals}get hasTangents(){return!!this._tangents}get hasUVs(){return!!this._uvs}setPositions(e){const t=this.hasPositions;this._positions=e,t!==this.hasPositions&&this._onDataLayoutChanged.notifyObservers(void 0)}getPositions(){return this._positions}setNormals(e){const t=this.hasNormals;this._normals=e,t!==this.hasNormals&&this._onDataLayoutChanged.notifyObservers(void 0)}getNormals(){return this._normals}setTangents(e){const t=this.hasTangents;this._tangents=e,t!==this.hasTangents&&this._onDataLayoutChanged.notifyObservers(void 0)}getTangents(){return this._tangents}setUVs(e){const t=this.hasUVs;this._uvs=e,t!==this.hasUVs&&this._onDataLayoutChanged.notifyObservers(void 0)}getUVs(){return this._uvs}clone(){const e=Fe.Clone(()=>new Oa(this.name,this.influence,this._scene),this);return e._positions=this._positions,e._normals=this._normals,e._tangents=this._tangents,e._uvs=this._uvs,e}serialize(){const e={};return e.name=this.name,e.influence=this.influence,e.positions=Array.prototype.slice.call(this.getPositions()),this.id!=null&&(e.id=this.id),this.hasNormals&&(e.normals=Array.prototype.slice.call(this.getNormals())),this.hasTangents&&(e.tangents=Array.prototype.slice.call(this.getTangents())),this.hasUVs&&(e.uvs=Array.prototype.slice.call(this.getUVs())),Fe.AppendSerializedAnimations(this,e),e}getClassName(){return"MorphTarget"}static Parse(e,t){const i=new Oa(e.name,e.influence);if(i.setPositions(e.positions),e.id!=null&&(i.id=e.id),e.normals&&i.setNormals(e.normals),e.tangents&&i.setTangents(e.tangents),e.uvs&&i.setUVs(e.uvs),e.animations){for(let r=0;r<e.animations.length;r++){const s=e.animations[r],a=Bn("BABYLON.Animation");a&&i.animations.push(a.Parse(s))}e.autoAnimate&&t&&t.beginAnimation(i,e.autoAnimateFrom,e.autoAnimateTo,e.autoAnimateLoop,e.autoAnimateSpeed||1)}return i}static FromMesh(e,t,i){t||(t=e.name);const r=new Oa(t,i,e.getScene());return r.setPositions(e.getVerticesData(x.PositionKind)),e.isVerticesDataPresent(x.NormalKind)&&r.setNormals(e.getVerticesData(x.NormalKind)),e.isVerticesDataPresent(x.TangentKind)&&r.setTangents(e.getVerticesData(x.TangentKind)),e.isVerticesDataPresent(x.UVKind)&&r.setUVs(e.getVerticesData(x.UVKind)),r}}R([I()],Oa.prototype,"id",void 0);class mi{static _CreateBufferView(e,t,i,r,s){const a={buffer:e,byteLength:i};return t&&(a.byteOffset=t),s&&(a.name=s),r&&(a.byteStride=r),a}static _CreateAccessor(e,t,i,r,s,a,l,o){const c={name:t,bufferView:e,componentType:r,count:s,type:i};return l!=null&&(c.min=l),o!=null&&(c.max=o),a!=null&&(c.byteOffset=a),c}static _CalculateMinMaxPositions(e,t,i){const r=[1/0,1/0,1/0],s=[-1/0,-1/0,-1/0],a=3;let l,o,c;if(i)for(let u=t,h=t+i;u<h;++u){l=a*u,o=A.FromArray(e,l),c=o.asArray();for(let d=0;d<a;++d){const f=c[d];f<r[d]&&(r[d]=f),f>s[d]&&(s[d]=f),++l}}return{min:r,max:s}}static _NormalizeTangentFromRef(e){const t=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);t>0&&(e.x/=t,e.y/=t,e.z/=t)}static _GetDataAccessorElementCount(e){switch(e){case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16;case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":return 4}}}var ru;(function(n){n[n.INTANGENT=0]="INTANGENT",n[n.OUTTANGENT=1]="OUTTANGENT"})(ru||(ru={}));class Zt{static _IsTransformable(e){return e&&(e instanceof Ne||e instanceof Ie||e instanceof Ye)}static _CreateNodeAnimation(e,t,i,r,s){if(this._IsTransformable(e)){const a=[],l=[],o=t.getKeys(),c=Zt._CalculateMinMaxKeyFrames(o),u=Zt._DeduceInterpolation(o,i,r),h=u.interpolationType,d=u.shouldBakeAnimation;if(d?Zt._CreateBakedAnimation(e,t,i,c.min,c.max,t.framePerSecond,s,a,l,c,r):h==="LINEAR"||h==="STEP"?Zt._CreateLinearOrStepAnimation(e,t,i,a,l,r):h==="CUBICSPLINE"?Zt._CreateCubicSplineAnimation(e,t,i,a,l,r):Zt._CreateBakedAnimation(e,t,i,c.min,c.max,t.framePerSecond,s,a,l,c,r),a.length&&l.length)return{inputs:a,outputs:l,samplerInterpolation:h,inputsMin:d?c.min:X.FloatRound(c.min/t.framePerSecond),inputsMax:d?c.max:X.FloatRound(c.max/t.framePerSecond)}}return null}static _DeduceAnimationInfo(e){let t=null,i="VEC3",r=!1;const s=e.targetProperty.split(".");switch(s[0]){case"scaling":{t="scale";break}case"position":{t="translation";break}case"rotation":{i="VEC4",t="rotation";break}case"rotationQuaternion":{i="VEC4",r=!0,t="rotation";break}case"influence":{i="SCALAR",t="weights";break}default:X.Error(`Unsupported animatable property ${s[0]}`)}return t?{animationChannelTargetPath:t,dataAccessorType:i,useQuaternion:r}:(X.Error("animation channel target path and data accessor type could be deduced"),null)}static _CreateNodeAnimationFromNodeAnimations(e,t,i,r,s,a,l,o,c,u){let h;if(Zt._IsTransformable(e)&&e.animations)for(const d of e.animations){if(u&&!u(d))continue;const f=Zt._DeduceAnimationInfo(d);f&&(h={name:d.name,samplers:[],channels:[]},Zt._AddAnimation(`${d.name}`,d.hasRunningRuntimeAnimations?t:h,e,d,f.dataAccessorType,f.animationChannelTargetPath,r,a,l,o,f.useQuaternion,c),h.samplers.length&&h.channels.length&&i.push(h))}}static _CreateMorphTargetAnimationFromMorphTargetAnimations(e,t,i,r,s,a,l,o,c,u){let h;if(e instanceof Ae){const d=e.morphTargetManager;if(d)for(let f=0;f<d.numTargets;++f){const _=d.getTarget(f);for(const p of _.animations){if(u&&!u(p))continue;const v=new _t(`${p.name}`,"influence",p.framePerSecond,p.dataType,p.loopMode,p.enableBlending),E=[],g=p.getKeys();for(let y=0;y<g.length;++y){const T=g[y];for(let b=0;b<d.numTargets;++b)b==f?E.push(T):E.push({frame:T.frame,value:0})}v.setKeys(E);const m=Zt._DeduceAnimationInfo(v);m&&(h={name:v.name,samplers:[],channels:[]},Zt._AddAnimation(p.name,p.hasRunningRuntimeAnimations?t:h,e,v,m.dataAccessorType,m.animationChannelTargetPath,r,a,l,o,m.useQuaternion,c,d.numTargets),h.samplers.length&&h.channels.length&&i.push(h))}}}}static _CreateNodeAndMorphAnimationFromAnimationGroups(e,t,i,r,s,a,l,o){var u;let c;if(e.animationGroups){const h=e.animationGroups;for(const d of h){const f=new Map,_=new Map,p=new Set,v=d.to-d.from;c={name:d.name,channels:[],samplers:[]};for(let E=0;E<d.targetedAnimations.length;++E){const g=d.targetedAnimations[E],m=g.target,y=g.animation;if(!(o&&!o(y))){if(this._IsTransformable(m)||m.length===1&&this._IsTransformable(m[0])){const T=Zt._DeduceAnimationInfo(g.animation);if(T){const b=this._IsTransformable(m)?m:this._IsTransformable(m[0])?m[0]:null;b&&Zt._AddAnimation(`${y.name}`,c,b,y,T.dataAccessorType,T.animationChannelTargetPath,i,r,s,a,T.useQuaternion,l)}}else if((m instanceof Oa||m.length===1&&m[0]instanceof Oa)&&Zt._DeduceAnimationInfo(g.animation)){const b=m instanceof Oa?m:m[0];if(b){const C=e.morphTargetManagers.find(M=>{for(let F=0;F<M.numTargets;++F)if(M.getTarget(F)===b)return!0;return!1});if(C){const M=e.meshes.find(F=>F.morphTargetManager===C);M&&(f.has(M)||f.set(M,new Map),(u=f.get(M))==null||u.set(b,y),p.add(M),_.set(M,y))}}}}}p.forEach(E=>{const g=E.morphTargetManager;let m=null;const y=[],b=_.get(E).getKeys(),C=b.length;for(let F=0;F<C;++F)for(let P=0;P<g.numTargets;++P){const U=g.getTarget(P),G=f.get(E);if(G){const K=G.get(U);K?(m||(m=new _t(`${d.name}_${E.name}_MorphWeightAnimation`,"influence",K.framePerSecond,_t.ANIMATIONTYPE_FLOAT,K.loopMode,K.enableBlending)),y.push(K.getKeys()[F])):y.push({frame:d.from+v/C*F,value:U.influence,inTangent:b[0].inTangent?0:void 0,outTangent:b[0].outTangent?0:void 0})}}m.setKeys(y);const M=Zt._DeduceAnimationInfo(m);M&&Zt._AddAnimation(`${d.name}_${E.name}_MorphWeightAnimation`,c,E,m,M.dataAccessorType,M.animationChannelTargetPath,i,r,s,a,M.useQuaternion,l,g==null?void 0:g.numTargets)}),c.channels.length&&c.samplers.length&&t.push(c)}}}static _AddAnimation(e,t,i,r,s,a,l,o,c,u,h,d,f){const _=Zt._CreateNodeAnimation(i,r,a,h,d);let p,v,E,g,m,y,T;if(_){if(f){let M=0,F=0;const P=[];for(;_.inputs.length>0;)F=_.inputs.shift(),M%f==0&&P.push(F),M++;_.inputs=P}const b=l[i.uniqueId];let C=_.inputs.length*4;p=mi._CreateBufferView(0,o.getByteOffset(),C,void 0,`${e}  keyframe data view`),c.push(p),_.inputs.forEach(function(M){o.setFloat32(M)}),v=mi._CreateAccessor(c.length-1,`${e}  keyframes`,"SCALAR",5126,_.inputs.length,null,[_.inputsMin],[_.inputsMax]),u.push(v),E=u.length-1,m=_.outputs.length,C=mi._GetDataAccessorElementCount(s)*4*_.outputs.length,p=mi._CreateBufferView(0,o.getByteOffset(),C,void 0,`${e}  data view`),c.push(p),_.outputs.forEach(function(M){M.forEach(function(F){o.setFloat32(F)})}),v=mi._CreateAccessor(c.length-1,`${e}  data`,s,5126,m,null,null,null),u.push(v),g=u.length-1,y={interpolation:_.samplerInterpolation,input:E,output:g},t.samplers.push(y),T={sampler:t.samplers.length-1,target:{node:b,path:a}},t.channels.push(T)}}static _CreateBakedAnimation(e,t,i,r,s,a,l,o,c,u,h){let d;const f=ue.Identity();let _=null,p,v=null,E=null,g=null,m=null,y=null;u.min=X.FloatRound(r/a);const T=t.getKeys();for(let b=0,C=T.length;b<C;++b){if(y=null,E=T[b],b+1<C)if(g=T[b+1],E.value.equals&&E.value.equals(g.value)||E.value===g.value)if(b===0)y=E.frame;else continue;else y=g.frame;else{if(m=T[b-1],E.value.equals&&E.value.equals(m.value)||E.value===m.value)continue;y=s}if(y)for(let M=E.frame;M<=y;M+=l){if(p=X.FloatRound(M/a),p===_)continue;_=p,v=p;const F={key:0,repeatCount:0,loopMode:t.loopMode};d=t._interpolate(M,F),Zt._SetInterpolatedValue(e,d,p,t,i,f,o,c,h)}}v&&(u.max=v)}static _ConvertFactorToVector3OrQuaternion(e,t,i,r,s){const a=Zt._GetBasePositionRotationOrScale(t,r,s),l=i.targetProperty.split("."),o=l?l[1]:"",c=s?ue.FromArray(a).normalize():A.FromArray(a);switch(o){case"x":case"y":case"z":{c[o]=e;break}case"w":{c.w=e;break}default:X.Error(`glTFAnimation: Unsupported component name "${o}"!`)}return c}static _SetInterpolatedValue(e,t,i,r,s,a,l,o,c){let u;if(l.push(i),s==="weights"){o.push([t]);return}r.dataType===_t.ANIMATIONTYPE_FLOAT&&(t=this._ConvertFactorToVector3OrQuaternion(t,e,r,s,c)),s==="rotation"?(c?a=t:(u=t,ue.RotationYawPitchRollToRef(u.y,u.x,u.z,a)),o.push(a.asArray())):(u=t,o.push(u.asArray()))}static _CreateLinearOrStepAnimation(e,t,i,r,s,a){for(const l of t.getKeys())r.push(l.frame/t.framePerSecond),Zt._AddKeyframeValue(l,t,s,i,e,a)}static _CreateCubicSplineAnimation(e,t,i,r,s,a){t.getKeys().forEach(function(l){r.push(l.frame/t.framePerSecond),Zt._AddSplineTangent(ru.INTANGENT,s,i,"CUBICSPLINE",l,a),Zt._AddKeyframeValue(l,t,s,i,e,a),Zt._AddSplineTangent(ru.OUTTANGENT,s,i,"CUBICSPLINE",l,a)})}static _GetBasePositionRotationOrScale(e,t,i){let r;return t==="rotation"?i?r=(e.rotationQuaternion??ue.Identity()).asArray():r=(e.rotation??A.Zero()).asArray():t==="translation"?r=(e.position??A.Zero()).asArray():r=(e.scaling??A.One()).asArray(),r}static _AddKeyframeValue(e,t,i,r,s,a){let l;const o=t.dataType;if(o===_t.ANIMATIONTYPE_VECTOR3){let c=e.value.asArray();if(r==="rotation"){const u=A.FromArray(c);c=ue.RotationYawPitchRoll(u.y,u.x,u.z).asArray()}i.push(c)}else if(o===_t.ANIMATIONTYPE_FLOAT){if(r==="weights")i.push([e.value]);else if(l=this._ConvertFactorToVector3OrQuaternion(e.value,s,t,r,a),l){if(r==="rotation"){const c=a?l:ue.RotationYawPitchRoll(l.y,l.x,l.z).normalize();i.push(c.asArray())}i.push(l.asArray())}}else o===_t.ANIMATIONTYPE_QUATERNION?i.push(e.value.normalize().asArray()):X.Error("glTFAnimation: Unsupported key frame values for animation!")}static _DeduceInterpolation(e,t,i){let r,s=!1,a;if(t==="rotation"&&!i)return{interpolationType:"LINEAR",shouldBakeAnimation:!0};for(let l=0,o=e.length;l<o;++l)if(a=e[l],a.inTangent||a.outTangent)if(r){if(r!=="CUBICSPLINE"){r="LINEAR",s=!0;break}}else r="CUBICSPLINE";else if(r){if(r==="CUBICSPLINE"||a.interpolation&&a.interpolation===Iu.STEP&&r!=="STEP"){r="LINEAR",s=!0;break}}else a.interpolation&&a.interpolation===Iu.STEP?r="STEP":r="LINEAR";return r||(r="LINEAR"),{interpolationType:r,shouldBakeAnimation:s}}static _AddSplineTangent(e,t,i,r,s,a){let l;const o=e===ru.INTANGENT?s.inTangent:s.outTangent;if(r==="CUBICSPLINE"){if(i==="rotation")if(o)if(a)l=o.asArray();else{const c=o;l=ue.RotationYawPitchRoll(c.y,c.x,c.z).asArray()}else l=[0,0,0,0];else i==="weights"?o?l=[o]:l=[0]:o?l=o.asArray():l=[0,0,0];t.push(l)}}static _CalculateMinMaxKeyFrames(e){let t=1/0,i=-1/0;return e.forEach(function(r){t=Math.min(t,r.frame),i=Math.max(i,r.frame)}),{min:t,max:i}}}class IT{constructor(){this.glTFFiles={}}downloadFiles(){function e(t,i){return t.indexOf(i,t.length-i.length)!==-1}for(const t in this.glTFFiles){const i=document.createElement("a");document.body.appendChild(i),i.setAttribute("type","hidden"),i.download=t;const r=this.glTFFiles[t];let s;e(t,".glb")?s={type:"model/gltf-binary"}:e(t,".bin")?s={type:"application/octet-stream"}:e(t,".gltf")?s={type:"model/gltf+json"}:e(t,".jpeg")||e(t,".jpg")?s={type:"image/jpeg"}:e(t,".png")&&(s={type:"image/png"}),i.href=window.URL.createObjectURL(new Blob([r],s)),i.click()}}}const yp={effect:null,subMesh:null};class Ua extends Sm{constructor(e,t,i,r={},s=!0){super(e,t,s),this._textures={},this._textureArrays={},this._externalTextures={},this._floats={},this._ints={},this._uints={},this._floatsArrays={},this._colors3={},this._colors3Arrays={},this._colors4={},this._colors4Arrays={},this._vectors2={},this._vectors3={},this._vectors4={},this._quaternions={},this._quaternionsArrays={},this._matrices={},this._matrixArrays={},this._matrices3x3={},this._matrices2x2={},this._vectors2Arrays={},this._vectors3Arrays={},this._vectors4Arrays={},this._uniformBuffers={},this._textureSamplers={},this._storageBuffers={},this._cachedWorldViewMatrix=new z,this._cachedWorldViewProjectionMatrix=new z,this._multiview=!1,this._materialHelperNeedsPreviousMatrices=!1,this._shaderPath=i,this._options={needAlphaBlending:!1,needAlphaTesting:!1,attributes:["position","normal","uv"],uniforms:["worldViewProjection"],uniformBuffers:[],samplers:[],externalTextures:[],samplerObjects:[],storageBuffers:[],defines:[],useClipPlane:!1,...r}}get shaderPath(){return this._shaderPath}set shaderPath(e){this._shaderPath=e}get options(){return this._options}get isMultiview(){return this._multiview}getClassName(){return"ShaderMaterial"}needAlphaBlending(){return this.alpha<1||this._options.needAlphaBlending}needAlphaTesting(){return this._options.needAlphaTesting}_checkUniform(e){this._options.uniforms.indexOf(e)===-1&&this._options.uniforms.push(e)}setTexture(e,t){return this._options.samplers.indexOf(e)===-1&&this._options.samplers.push(e),this._textures[e]=t,this}setTextureArray(e,t){return this._options.samplers.indexOf(e)===-1&&this._options.samplers.push(e),this._checkUniform(e),this._textureArrays[e]=t,this}setExternalTexture(e,t){return this._options.externalTextures.indexOf(e)===-1&&this._options.externalTextures.push(e),this._externalTextures[e]=t,this}setFloat(e,t){return this._checkUniform(e),this._floats[e]=t,this}setInt(e,t){return this._checkUniform(e),this._ints[e]=t,this}setUInt(e,t){return this._checkUniform(e),this._uints[e]=t,this}setFloats(e,t){return this._checkUniform(e),this._floatsArrays[e]=t,this}setColor3(e,t){return this._checkUniform(e),this._colors3[e]=t,this}setColor3Array(e,t){return this._checkUniform(e),this._colors3Arrays[e]=t.reduce((i,r)=>(r.toArray(i,i.length),i),[]),this}setColor4(e,t){return this._checkUniform(e),this._colors4[e]=t,this}setColor4Array(e,t){return this._checkUniform(e),this._colors4Arrays[e]=t.reduce((i,r)=>(r.toArray(i,i.length),i),[]),this}setVector2(e,t){return this._checkUniform(e),this._vectors2[e]=t,this}setVector3(e,t){return this._checkUniform(e),this._vectors3[e]=t,this}setVector4(e,t){return this._checkUniform(e),this._vectors4[e]=t,this}setQuaternion(e,t){return this._checkUniform(e),this._quaternions[e]=t,this}setQuaternionArray(e,t){return this._checkUniform(e),this._quaternionsArrays[e]=t.reduce((i,r)=>(r.toArray(i,i.length),i),[]),this}setMatrix(e,t){return this._checkUniform(e),this._matrices[e]=t,this}setMatrices(e,t){this._checkUniform(e);const i=new Float32Array(t.length*16);for(let r=0;r<t.length;r++)t[r].copyToArray(i,r*16);return this._matrixArrays[e]=i,this}setMatrix3x3(e,t){return this._checkUniform(e),this._matrices3x3[e]=t,this}setMatrix2x2(e,t){return this._checkUniform(e),this._matrices2x2[e]=t,this}setArray2(e,t){return this._checkUniform(e),this._vectors2Arrays[e]=t,this}setArray3(e,t){return this._checkUniform(e),this._vectors3Arrays[e]=t,this}setArray4(e,t){return this._checkUniform(e),this._vectors4Arrays[e]=t,this}setUniformBuffer(e,t){return this._options.uniformBuffers.indexOf(e)===-1&&this._options.uniformBuffers.push(e),this._uniformBuffers[e]=t,this}setTextureSampler(e,t){return this._options.samplerObjects.indexOf(e)===-1&&this._options.samplerObjects.push(e),this._textureSamplers[e]=t,this}setStorageBuffer(e,t){return this._options.storageBuffers.indexOf(e)===-1&&this._options.storageBuffers.push(e),this._storageBuffers[e]=t,this}setDefine(e,t){const i=e.trimEnd()+" ",r=this.options.defines.findIndex(s=>s===e||s.startsWith(i));return r>=0&&this.options.defines.splice(r,1),(typeof t!="boolean"||t)&&this.options.defines.push(i+t),this}isReadyForSubMesh(e,t,i){return this.isReady(e,i,t)}isReady(e,t,i){const r=i&&this._storeEffectOnSubMeshes;if(this.isFrozen){const T=r?i._drawWrapper:this._drawWrapper;if(T.effect&&T._wasPreviouslyReady&&T._wasPreviouslyUsingInstances===t)return!0}const s=this.getScene(),a=s.getEngine(),l=[],o=[],c=new Rm;let u=this._shaderPath,h=this._options.uniforms,d=this._options.uniformBuffers,f=this._options.samplers;a.getCaps().multiview&&s.activeCamera&&s.activeCamera.outputRenderTarget&&s.activeCamera.outputRenderTarget.getViewCount()>1&&(this._multiview=!0,l.push("#define MULTIVIEW"),h.indexOf("viewProjection")!==-1&&h.indexOf("viewProjectionR")===-1&&h.push("viewProjectionR"));for(let T=0;T<this._options.defines.length;T++){const b=this._options.defines[T].indexOf("#define")===0?this._options.defines[T]:`#define ${this._options.defines[T]}`;l.push(b)}for(let T=0;T<this._options.attributes.length;T++)o.push(this._options.attributes[T]);if(e&&e.isVerticesDataPresent(x.ColorKind)&&(o.indexOf(x.ColorKind)===-1&&o.push(x.ColorKind),l.push("#define VERTEXCOLOR")),t&&(l.push("#define INSTANCES"),y1(o,this._materialHelperNeedsPreviousMatrices),e!=null&&e.hasThinInstances&&(l.push("#define THIN_INSTANCES"),e&&e.isVerticesDataPresent(x.ColorInstanceKind)&&(o.push(x.ColorInstanceKind),l.push("#define INSTANCESCOLOR")))),e&&e.useBones&&e.computeBonesUsingShaders&&e.skeleton){o.push(x.MatricesIndicesKind),o.push(x.MatricesWeightsKind),e.numBoneInfluencers>4&&(o.push(x.MatricesIndicesExtraKind),o.push(x.MatricesWeightsExtraKind));const T=e.skeleton;l.push("#define NUM_BONE_INFLUENCERS "+e.numBoneInfluencers),c.addCPUSkinningFallback(0,e),T.isUsingTextureForMatrices?(l.push("#define BONETEXTURE"),h.indexOf("boneTextureWidth")===-1&&h.push("boneTextureWidth"),this._options.samplers.indexOf("boneSampler")===-1&&this._options.samplers.push("boneSampler")):(l.push("#define BonesPerMesh "+(T.bones.length+1)),h.indexOf("mBones")===-1&&h.push("mBones"))}else l.push("#define NUM_BONE_INFLUENCERS 0");let _=0;const p=e?e.morphTargetManager:null;if(p){const T=p.supportsUVs&&l.indexOf("#define UV1")!==-1,b=p.supportsTangents&&l.indexOf("#define TANGENT")!==-1,C=p.supportsNormals&&l.indexOf("#define NORMAL")!==-1;_=p.numMaxInfluencers||p.numInfluencers,T&&l.push("#define MORPHTARGETS_UV"),b&&l.push("#define MORPHTARGETS_TANGENT"),C&&l.push("#define MORPHTARGETS_NORMAL"),_>0&&l.push("#define MORPHTARGETS"),p.isUsingTextureForTargets&&(l.push("#define MORPHTARGETS_TEXTURE"),h.indexOf("morphTargetTextureIndices")===-1&&h.push("morphTargetTextureIndices"),this._options.samplers.indexOf("morphTargets")===-1&&this._options.samplers.push("morphTargets")),l.push("#define NUM_MORPH_INFLUENCERS "+_);for(let M=0;M<_;M++)o.push(x.PositionKind+M),C&&o.push(x.NormalKind+M),b&&o.push(x.TangentKind+M),T&&o.push(x.UVKind+"_"+M);_>0&&(h=h.slice(),h.push("morphTargetInfluences"),h.push("morphTargetCount"),h.push("morphTargetTextureInfo"),h.push("morphTargetTextureIndices"))}else l.push("#define NUM_MORPH_INFLUENCERS 0");if(e){const T=e.bakedVertexAnimationManager;T&&T.isEnabled&&(l.push("#define BAKED_VERTEX_ANIMATION_TEXTURE"),h.indexOf("bakedVertexAnimationSettings")===-1&&h.push("bakedVertexAnimationSettings"),h.indexOf("bakedVertexAnimationTextureSizeInverted")===-1&&h.push("bakedVertexAnimationTextureSizeInverted"),h.indexOf("bakedVertexAnimationTime")===-1&&h.push("bakedVertexAnimationTime"),this._options.samplers.indexOf("bakedVertexAnimationTexture")===-1&&this._options.samplers.push("bakedVertexAnimationTexture")),bm(o,e,l)}for(const T in this._textures)if(!this._textures[T].isReady())return!1;e&&this._shouldTurnAlphaTestOn(e)&&l.push("#define ALPHATEST"),this._options.useClipPlane!==!1&&(mm(h),QN(this,s,l)),s.fogEnabled&&(e!=null&&e.applyFog)&&s.fogMode!==Pt.FOGMODE_NONE&&(l.push("#define FOG"),h.indexOf("view")===-1&&h.push("view"),h.indexOf("vFogInfos")===-1&&h.push("vFogInfos"),h.indexOf("vFogColor")===-1&&h.push("vFogColor")),this._useLogarithmicDepth&&(l.push("#define LOGARITHMICDEPTH"),h.indexOf("logarithmicDepthConstant")===-1&&h.push("logarithmicDepthConstant")),this.customShaderNameResolve&&(h=h.slice(),d=d.slice(),f=f.slice(),u=this.customShaderNameResolve(u,h,d,f,l,o));const v=r?i._getDrawWrapper(void 0,!0):this._drawWrapper,E=(v==null?void 0:v.effect)??null,g=(v==null?void 0:v.defines)??null,m=l.join(`
`);let y=E;return g!==m&&(y=a.createEffect(u,{attributes:o,uniformsNames:h,uniformBuffersNames:d,samplers:f,defines:m,fallbacks:c,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousMorphTargets:_},shaderLanguage:this._options.shaderLanguage},a),r?i.setEffect(y,m,this._materialContext):v&&v.setEffect(y,m),this._onEffectCreatedObservable&&(yp.effect=y,yp.subMesh=i??(e==null?void 0:e.subMeshes[0])??null,this._onEffectCreatedObservable.notifyObservers(yp))),v._wasPreviouslyUsingInstances=!!t,y!=null&&y.isReady()?(E!==y&&s.resetCachedMaterial(),v._wasPreviouslyReady=!0,!0):!1}bindOnlyWorldMatrix(e,t){const i=this.getScene(),r=t??this.getEffect();r&&(this._options.uniforms.indexOf("world")!==-1&&r.setMatrix("world",e),this._options.uniforms.indexOf("worldView")!==-1&&(e.multiplyToRef(i.getViewMatrix(),this._cachedWorldViewMatrix),r.setMatrix("worldView",this._cachedWorldViewMatrix)),this._options.uniforms.indexOf("worldViewProjection")!==-1&&(e.multiplyToRef(i.getTransformMatrix(),this._cachedWorldViewProjectionMatrix),r.setMatrix("worldViewProjection",this._cachedWorldViewProjectionMatrix)),this._options.uniforms.indexOf("view")!==-1&&r.setMatrix("view",i.getViewMatrix()))}bindForSubMesh(e,t,i){var r;this.bind(e,t,(r=i._drawWrapperOverride)==null?void 0:r.effect,i)}bind(e,t,i,r){var h;const s=r&&this._storeEffectOnSubMeshes,a=i??(s?r.effect:this.getEffect());if(!a)return;const l=this.getScene();this._activeEffect=a,this.bindOnlyWorldMatrix(e,i);const o=this._options.uniformBuffers;let c=!1;if(a&&o&&o.length>0&&l.getEngine().supportsUniformBuffers)for(let d=0;d<o.length;++d)switch(o[d]){case"Mesh":t&&(t.getMeshUniformBuffer().bindToEffect(a,"Mesh"),t.transferToEffect(e));break;case"Scene":T1(a,l.getSceneUniformBuffer()),l.finalizeSceneUbo(),c=!0;break}const u=t&&s?this._mustRebind(l,a,r,t.visibility):l.getCachedMaterial()!==this;if(a&&u){!c&&this._options.uniforms.indexOf("view")!==-1&&a.setMatrix("view",l.getViewMatrix()),!c&&this._options.uniforms.indexOf("projection")!==-1&&a.setMatrix("projection",l.getProjectionMatrix()),!c&&this._options.uniforms.indexOf("viewProjection")!==-1&&(a.setMatrix("viewProjection",l.getTransformMatrix()),this._multiview&&a.setMatrix("viewProjectionR",l._transformMatrixR)),l.activeCamera&&this._options.uniforms.indexOf("cameraPosition")!==-1&&a.setVector3("cameraPosition",l.activeCamera.globalPosition),Cm(t,a),vm(a,this,l),this._useLogarithmicDepth&&Em(s?r.materialDefines:a.defines,a,l),t&&ym(l,t,a);let d;for(d in this._textures)a.setTexture(d,this._textures[d]);for(d in this._textureArrays)a.setTextureArray(d,this._textureArrays[d]);for(d in this._externalTextures)a.setExternalTexture(d,this._externalTextures[d]);for(d in this._ints)a.setInt(d,this._ints[d]);for(d in this._uints)a.setUInt(d,this._uints[d]);for(d in this._floats)a.setFloat(d,this._floats[d]);for(d in this._floatsArrays)a.setArray(d,this._floatsArrays[d]);for(d in this._colors3)a.setColor3(d,this._colors3[d]);for(d in this._colors3Arrays)a.setArray3(d,this._colors3Arrays[d]);for(d in this._colors4){const f=this._colors4[d];a.setFloat4(d,f.r,f.g,f.b,f.a)}for(d in this._colors4Arrays)a.setArray4(d,this._colors4Arrays[d]);for(d in this._vectors2)a.setVector2(d,this._vectors2[d]);for(d in this._vectors3)a.setVector3(d,this._vectors3[d]);for(d in this._vectors4)a.setVector4(d,this._vectors4[d]);for(d in this._quaternions)a.setQuaternion(d,this._quaternions[d]);for(d in this._matrices)a.setMatrix(d,this._matrices[d]);for(d in this._matrixArrays)a.setMatrices(d,this._matrixArrays[d]);for(d in this._matrices3x3)a.setMatrix3x3(d,this._matrices3x3[d]);for(d in this._matrices2x2)a.setMatrix2x2(d,this._matrices2x2[d]);for(d in this._vectors2Arrays)a.setArray2(d,this._vectors2Arrays[d]);for(d in this._vectors3Arrays)a.setArray3(d,this._vectors3Arrays[d]);for(d in this._vectors4Arrays)a.setArray4(d,this._vectors4Arrays[d]);for(d in this._quaternionsArrays)a.setArray4(d,this._quaternionsArrays[d]);for(d in this._uniformBuffers){const f=this._uniformBuffers[d].getBuffer();f&&a.bindUniformBuffer(f,d)}for(d in this._textureSamplers)a.setTextureSampler(d,this._textureSamplers[d]);for(d in this._storageBuffers)a.setStorageBuffer(d,this._storageBuffers[d])}if(a&&t&&(u||!this.isFrozen)){const d=t.morphTargetManager;d&&d.numInfluencers>0&&Tm(t,a);const f=t.bakedVertexAnimationManager;if(f&&f.isEnabled){const _=s?r._drawWrapper:this._drawWrapper;(h=t.bakedVertexAnimationManager)==null||h.bind(a,!!_._wasPreviouslyUsingInstances)}}this._afterBind(t,a,r)}getActiveTextures(){const e=super.getActiveTextures();for(const t in this._textures)e.push(this._textures[t]);for(const t in this._textureArrays){const i=this._textureArrays[t];for(let r=0;r<i.length;r++)e.push(i[r])}return e}hasTexture(e){if(super.hasTexture(e))return!0;for(const t in this._textures)if(this._textures[t]===e)return!0;for(const t in this._textureArrays){const i=this._textureArrays[t];for(let r=0;r<i.length;r++)if(i[r]===e)return!0}return!1}clone(e){const t=Fe.Clone(()=>new Ua(e,this.getScene(),this._shaderPath,this._options,this._storeEffectOnSubMeshes),this);t.name=e,t.id=e,typeof t._shaderPath=="object"&&(t._shaderPath={...t._shaderPath}),this._options={...this._options},Object.keys(this._options).forEach(i=>{const r=this._options[i];Array.isArray(r)&&(this._options[i]=r.slice(0))}),this.stencil.copyTo(t.stencil);for(const i in this._textures)t.setTexture(i,this._textures[i]);for(const i in this._textureArrays)t.setTextureArray(i,this._textureArrays[i]);for(const i in this._externalTextures)t.setExternalTexture(i,this._externalTextures[i]);for(const i in this._ints)t.setInt(i,this._ints[i]);for(const i in this._uints)t.setUInt(i,this._uints[i]);for(const i in this._floats)t.setFloat(i,this._floats[i]);for(const i in this._floatsArrays)t.setFloats(i,this._floatsArrays[i]);for(const i in this._colors3)t.setColor3(i,this._colors3[i]);for(const i in this._colors3Arrays)t._colors3Arrays[i]=this._colors3Arrays[i];for(const i in this._colors4)t.setColor4(i,this._colors4[i]);for(const i in this._colors4Arrays)t._colors4Arrays[i]=this._colors4Arrays[i];for(const i in this._vectors2)t.setVector2(i,this._vectors2[i]);for(const i in this._vectors3)t.setVector3(i,this._vectors3[i]);for(const i in this._vectors4)t.setVector4(i,this._vectors4[i]);for(const i in this._quaternions)t.setQuaternion(i,this._quaternions[i]);for(const i in this._quaternionsArrays)t._quaternionsArrays[i]=this._quaternionsArrays[i];for(const i in this._matrices)t.setMatrix(i,this._matrices[i]);for(const i in this._matrixArrays)t._matrixArrays[i]=this._matrixArrays[i].slice();for(const i in this._matrices3x3)t.setMatrix3x3(i,this._matrices3x3[i]);for(const i in this._matrices2x2)t.setMatrix2x2(i,this._matrices2x2[i]);for(const i in this._vectors2Arrays)t.setArray2(i,this._vectors2Arrays[i]);for(const i in this._vectors3Arrays)t.setArray3(i,this._vectors3Arrays[i]);for(const i in this._vectors4Arrays)t.setArray4(i,this._vectors4Arrays[i]);for(const i in this._uniformBuffers)t.setUniformBuffer(i,this._uniformBuffers[i]);for(const i in this._textureSamplers)t.setTextureSampler(i,this._textureSamplers[i]);for(const i in this._storageBuffers)t.setStorageBuffer(i,this._storageBuffers[i]);return t}dispose(e,t,i){if(t){let r;for(r in this._textures)this._textures[r].dispose();for(r in this._textureArrays){const s=this._textureArrays[r];for(let a=0;a<s.length;a++)s[a].dispose()}}this._textures={},super.dispose(e,t,i)}serialize(){const e=Fe.Serialize(this);e.customType="BABYLON.ShaderMaterial",e.uniqueId=this.uniqueId,e.options=this._options,e.shaderPath=this._shaderPath,e.storeEffectOnSubMeshes=this._storeEffectOnSubMeshes;let t;e.stencil=this.stencil.serialize(),e.textures={};for(t in this._textures)e.textures[t]=this._textures[t].serialize();e.textureArrays={};for(t in this._textureArrays){e.textureArrays[t]=[];const i=this._textureArrays[t];for(let r=0;r<i.length;r++)e.textureArrays[t].push(i[r].serialize())}e.ints={};for(t in this._ints)e.ints[t]=this._ints[t];e.uints={};for(t in this._uints)e.uints[t]=this._uints[t];e.floats={};for(t in this._floats)e.floats[t]=this._floats[t];e.floatsArrays={};for(t in this._floatsArrays)e.floatsArrays[t]=this._floatsArrays[t];e.colors3={};for(t in this._colors3)e.colors3[t]=this._colors3[t].asArray();e.colors3Arrays={};for(t in this._colors3Arrays)e.colors3Arrays[t]=this._colors3Arrays[t];e.colors4={};for(t in this._colors4)e.colors4[t]=this._colors4[t].asArray();e.colors4Arrays={};for(t in this._colors4Arrays)e.colors4Arrays[t]=this._colors4Arrays[t];e.vectors2={};for(t in this._vectors2)e.vectors2[t]=this._vectors2[t].asArray();e.vectors3={};for(t in this._vectors3)e.vectors3[t]=this._vectors3[t].asArray();e.vectors4={};for(t in this._vectors4)e.vectors4[t]=this._vectors4[t].asArray();e.quaternions={};for(t in this._quaternions)e.quaternions[t]=this._quaternions[t].asArray();e.matrices={};for(t in this._matrices)e.matrices[t]=this._matrices[t].asArray();e.matrixArray={};for(t in this._matrixArrays)e.matrixArray[t]=this._matrixArrays[t];e.matrices3x3={};for(t in this._matrices3x3)e.matrices3x3[t]=this._matrices3x3[t];e.matrices2x2={};for(t in this._matrices2x2)e.matrices2x2[t]=this._matrices2x2[t];e.vectors2Arrays={};for(t in this._vectors2Arrays)e.vectors2Arrays[t]=this._vectors2Arrays[t];e.vectors3Arrays={};for(t in this._vectors3Arrays)e.vectors3Arrays[t]=this._vectors3Arrays[t];e.vectors4Arrays={};for(t in this._vectors4Arrays)e.vectors4Arrays[t]=this._vectors4Arrays[t];e.quaternionsArrays={};for(t in this._quaternionsArrays)e.quaternionsArrays[t]=this._quaternionsArrays[t];return e}static Parse(e,t,i){const r=Fe.Parse(()=>new Ua(e.name,t,e.shaderPath,e.options,e.storeEffectOnSubMeshes),e,t,i);let s;e.stencil&&r.stencil.parse(e.stencil,t,i);for(s in e.textures)r.setTexture(s,re.Parse(e.textures[s],t,i));for(s in e.textureArrays){const a=e.textureArrays[s],l=[];for(let o=0;o<a.length;o++)l.push(re.Parse(a[o],t,i));r.setTextureArray(s,l)}for(s in e.ints)r.setInt(s,e.ints[s]);for(s in e.uints)r.setUInt(s,e.uints[s]);for(s in e.floats)r.setFloat(s,e.floats[s]);for(s in e.floatsArrays)r.setFloats(s,e.floatsArrays[s]);for(s in e.colors3)r.setColor3(s,Pe.FromArray(e.colors3[s]));for(s in e.colors3Arrays){const a=e.colors3Arrays[s].reduce((l,o,c)=>(c%3===0?l.push([o]):l[l.length-1].push(o),l),[]).map(l=>Pe.FromArray(l));r.setColor3Array(s,a)}for(s in e.colors4)r.setColor4(s,et.FromArray(e.colors4[s]));for(s in e.colors4Arrays){const a=e.colors4Arrays[s].reduce((l,o,c)=>(c%4===0?l.push([o]):l[l.length-1].push(o),l),[]).map(l=>et.FromArray(l));r.setColor4Array(s,a)}for(s in e.vectors2)r.setVector2(s,xe.FromArray(e.vectors2[s]));for(s in e.vectors3)r.setVector3(s,A.FromArray(e.vectors3[s]));for(s in e.vectors4)r.setVector4(s,qe.FromArray(e.vectors4[s]));for(s in e.quaternions)r.setQuaternion(s,ue.FromArray(e.quaternions[s]));for(s in e.matrices)r.setMatrix(s,z.FromArray(e.matrices[s]));for(s in e.matrixArray)r._matrixArrays[s]=new Float32Array(e.matrixArray[s]);for(s in e.matrices3x3)r.setMatrix3x3(s,e.matrices3x3[s]);for(s in e.matrices2x2)r.setMatrix2x2(s,e.matrices2x2[s]);for(s in e.vectors2Arrays)r.setArray2(s,e.vectors2Arrays[s]);for(s in e.vectors3Arrays)r.setArray3(s,e.vectors3Arrays[s]);for(s in e.vectors4Arrays)r.setArray4(s,e.vectors4Arrays[s]);for(s in e.quaternionsArrays)r.setArray4(s,e.quaternionsArrays[s]);return r}static ParseFromFileAsync(e,t,i,r=""){return new Promise((s,a)=>{const l=new wi;l.addEventListener("readystatechange",()=>{if(l.readyState==4)if(l.status==200){const o=JSON.parse(l.responseText),c=this.Parse(o,i||He.LastCreatedScene,r);e&&(c.name=e),s(c)}else a("Unable to load the ShaderMaterial")}),l.open("GET",t),l.send()})}static ParseFromSnippetAsync(e,t,i=""){return new Promise((r,s)=>{const a=new wi;a.addEventListener("readystatechange",()=>{if(a.readyState==4)if(a.status==200){const l=JSON.parse(JSON.parse(a.responseText).jsonPayload),o=JSON.parse(l.shaderMaterial),c=this.Parse(o,t||He.LastCreatedScene,i);c.snippetId=e,r(c)}else s("Unable to load the snippet "+e)}),a.open("GET",this.SnippetUrl+"/"+e.replace(/#/g,"/")),a.send()})}}Ua.SnippetUrl="https://snippet.babylonjs.com";Ua.CreateFromSnippetAsync=Ua.ParseFromSnippetAsync;Ji("BABYLON.ShaderMaterial",Ua);const dH="colorPixelShader",fH=`#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)
#define VERTEXCOLOR
varying vec4 vColor;
#else
uniform vec4 color;
#endif
#include<clipPlaneFragmentDeclaration>
#include<fogFragmentDeclaration>
#define CUSTOM_FRAGMENT_DEFINITIONS
void main(void) {
#define CUSTOM_FRAGMENT_MAIN_BEGIN
#include<clipPlaneFragment>
#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)
gl_FragColor=vColor;
#else
gl_FragColor=color;
#endif
#include<fogFragment>(color,gl_FragColor)
#define CUSTOM_FRAGMENT_MAIN_END
}`;ne.ShadersStore[dH]=fH;const _H="colorVertexShader",pH=`attribute vec3 position;
#ifdef VERTEXCOLOR
attribute vec4 color;
#endif
#include<bonesDeclaration>
#include<bakedVertexAnimationDeclaration>
#include<clipPlaneVertexDeclaration>
#include<fogVertexDeclaration>
#ifdef FOG
uniform mat4 view;
#endif
#include<instancesDeclaration>
uniform mat4 viewProjection;
#ifdef MULTIVIEW
uniform mat4 viewProjectionR;
#endif
#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)
varying vec4 vColor;
#endif
#define CUSTOM_VERTEX_DEFINITIONS
void main(void) {
#define CUSTOM_VERTEX_MAIN_BEGIN
#include<instancesVertex>
#include<bonesVertex>
#include<bakedVertexAnimation>
vec4 worldPos=finalWorld*vec4(position,1.0);
#ifdef MULTIVIEW
if (gl_ViewID_OVR==0u) {gl_Position=viewProjection*worldPos;} else {gl_Position=viewProjectionR*worldPos;}
#else
gl_Position=viewProjection*worldPos;
#endif
#include<clipPlaneVertex>
#include<fogVertex>
#include<vertexColorMixing>
#define CUSTOM_VERTEX_MAIN_END
}`;ne.ShadersStore[_H]=pH;Ae._LinesMeshParser=(n,e)=>Zl.Parse(n,e);class Zl extends Ae{_isShaderMaterial(e){return e.getClassName()==="ShaderMaterial"}constructor(e,t=null,i=null,r=null,s,a,l,o){super(e,t,i,r,s),this.useVertexColor=a,this.useVertexAlpha=l,this.color=new Pe(1,1,1),this.alpha=1,r&&(this.color=r.color.clone(),this.alpha=r.alpha,this.useVertexColor=r.useVertexColor,this.useVertexAlpha=r.useVertexAlpha),this.intersectionThreshold=.1;const c=[],u={attributes:[x.PositionKind],uniforms:["world","viewProjection"],needAlphaBlending:!0,defines:c,useClipPlane:null};l===!1?u.needAlphaBlending=!1:u.defines.push("#define VERTEXALPHA"),a?(u.defines.push("#define VERTEXCOLOR"),u.attributes.push(x.ColorKind)):(u.uniforms.push("color"),this._color4=new et),o?this.material=o:(this.material=new Ua("colorShader",this.getScene(),"color",u,!1),this.material.doNotSerialize=!0)}isReady(){return this._lineMaterial.isReady(this,!!this._userInstancedBuffersStorage||this.hasThinInstances)?super.isReady():!1}getClassName(){return"LinesMesh"}get material(){return this._lineMaterial}set material(e){this._lineMaterial=e,this._lineMaterial.fillMode=j.LineListDrawMode}get checkCollisions(){return!1}set checkCollisions(e){}_bind(e,t){if(!this._geometry)return this;const i=this.isUnIndexed?null:this._geometry.getIndexBuffer();if(!this._userInstancedBuffersStorage||this.hasThinInstances?this._geometry._bind(t,i):this._geometry._bind(t,i,this._userInstancedBuffersStorage.vertexBuffers,this._userInstancedBuffersStorage.vertexArrayObjects),!this.useVertexColor&&this._isShaderMaterial(this._lineMaterial)){const{r,g:s,b:a}=this.color;this._color4.set(r,s,a,this.alpha),this._lineMaterial.setColor4("color",this._color4)}return this}_draw(e,t,i){if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;const r=this.getScene().getEngine();return this._unIndexed?r.drawArraysType(j.LineListDrawMode,e.verticesStart,e.verticesCount,i):r.drawElementsType(j.LineListDrawMode,e.indexStart,e.indexCount,i),this}dispose(e,t=!1,i){i||this._lineMaterial.dispose(!1,!1,!0),super.dispose(e)}clone(e,t=null,i){return new Zl(e,this.getScene(),t,this,i)}createInstance(e){const t=new gH(e,this);if(this.instancedBuffers){t.instancedBuffers={};for(const i in this.instancedBuffers)t.instancedBuffers[i]=this.instancedBuffers[i]}return t}serialize(e){super.serialize(e),e.color=this.color.asArray(),e.alpha=this.alpha}static Parse(e,t){const i=new Zl(e.name,t);return i.color=Pe.FromArray(e.color),i.alpha=e.alpha,i}}class gH extends yo{constructor(e,t){super(e,t),this.intersectionThreshold=t.intersectionThreshold}getClassName(){return"InstancedLinesMesh"}}class mH{get depthStencilTexture(){return this._depthStencilTexture}get depthStencilTextureWithStencil(){return this._depthStencilTextureWithStencil}get isCube(){return this._isCube}get isMulti(){return this._isMulti}get is2DArray(){return this.layers>0}get size(){return this.width}get width(){return this._size.width||this._size}get height(){return this._size.height||this._size}get layers(){return this._size.layers||0}get texture(){var e;return((e=this._textures)==null?void 0:e[0])??null}get textures(){return this._textures}get faceIndices(){return this._faceIndices}get layerIndices(){return this._layerIndices}get samples(){return this._samples}setSamples(e,t=!0,i=!1){if(this.samples===e&&!i)return e;const r=this._isMulti?this._engine.updateMultipleRenderTargetTextureSampleCount(this,e,t):this._engine.updateRenderTargetTextureSampleCount(this,e);return this._samples=e,r}constructor(e,t,i,r,s){this._textures=null,this._faceIndices=null,this._layerIndices=null,this._samples=1,this._attachments=null,this._generateStencilBuffer=!1,this._generateDepthBuffer=!1,this._depthStencilTextureWithStencil=!1,this._isMulti=e,this._isCube=t,this._size=i,this._engine=r,this._depthStencilTexture=null,this.label=s}setTextures(e){Array.isArray(e)?this._textures=e:e?this._textures=[e]:this._textures=null}setTexture(e,t=0,i=!0){this._textures||(this._textures=[]),this._textures[t]!==e&&(this._textures[t]&&i&&this._textures[t].dispose(),this._textures[t]=e)}setLayerAndFaceIndices(e,t){this._layerIndices=e,this._faceIndices=t}setLayerAndFaceIndex(e=0,t,i){this._layerIndices||(this._layerIndices=[]),this._faceIndices||(this._faceIndices=[]),t!==void 0&&t>=0&&(this._layerIndices[e]=t),i!==void 0&&i>=0&&(this._faceIndices[e]=i)}createDepthStencilTexture(e=0,t=!0,i=!1,r=1,s=14,a){var l;return(l=this._depthStencilTexture)==null||l.dispose(),this._depthStencilTextureWithStencil=i,this._depthStencilTextureLabel=a,this._depthStencilTexture=this._engine.createDepthStencilTexture(this._size,{bilinearFiltering:t,comparisonFunction:e,generateStencil:i,isCube:this._isCube,samples:r,depthTextureFormat:s,label:a},this),this._depthStencilTexture}_shareDepth(e){this._depthStencilTexture&&(e._depthStencilTexture&&e._depthStencilTexture.dispose(),e._depthStencilTexture=this._depthStencilTexture,this._depthStencilTexture.incrementReferences())}_swapAndDie(e){this.texture&&this.texture._swapAndDie(e),this._textures=null,this.dispose(!0)}_cloneRenderTargetWrapper(){var t,i,r,s,a;let e=null;if(this._isMulti){const l=this.textures;if(l&&l.length>0){let o=!1,c=l.length,u=-1;const h=l[l.length-1]._source;(h===Xt.Depth||h===Xt.DepthStencil)&&(o=!0,u=l[l.length-1].format,c--);const d=[],f=[],_=[],p=[],v=[],E=[],g=[],m={};for(let b=0;b<c;++b){const C=l[b];d.push(C.samplingMode),f.push(C.type),_.push(C.format),m[C.uniqueId]!==void 0?(p.push(-1),g.push(0)):(m[C.uniqueId]=b,C.is2DArray?(p.push(35866),g.push(C.depth)):C.isCube?(p.push(34067),g.push(0)):C.is3D?(p.push(32879),g.push(C.depth)):(p.push(3553),g.push(0))),this._faceIndices&&v.push(this._faceIndices[b]??0),this._layerIndices&&E.push(this._layerIndices[b]??0)}const y={samplingModes:d,generateMipMaps:l[0].generateMipMaps,generateDepthBuffer:this._generateDepthBuffer,generateStencilBuffer:this._generateStencilBuffer,generateDepthTexture:o,depthTextureFormat:u,types:f,formats:_,textureCount:c,targetTypes:p,faceIndex:v,layerIndex:E,layerCounts:g,label:this.label},T={width:this.width,height:this.height};e=this._engine.createMultipleRenderTarget(T,y);for(let b=0;b<c;++b){if(p[b]!==-1)continue;const C=m[l[b].uniqueId];e.setTexture(e.textures[C],b)}}}else{const l={};if(l.generateDepthBuffer=this._generateDepthBuffer,l.generateMipMaps=((t=this.texture)==null?void 0:t.generateMipMaps)??!1,l.generateStencilBuffer=this._generateStencilBuffer,l.samplingMode=(i=this.texture)==null?void 0:i.samplingMode,l.type=(r=this.texture)==null?void 0:r.type,l.format=(s=this.texture)==null?void 0:s.format,l.noColorAttachment=!this._textures,l.label=this.label,this.isCube)e=this._engine.createRenderTargetCubeTexture(this.width,l);else{const o={width:this.width,height:this.height,layers:this.is2DArray?(a=this.texture)==null?void 0:a.depth:void 0};e=this._engine.createRenderTargetTexture(o,l)}e.texture&&(e.texture.isReady=!0)}return e}_swapRenderTargetWrapper(e){if(this._textures&&e._textures)for(let t=0;t<this._textures.length;++t)this._textures[t]._swapAndDie(e._textures[t],!1),e._textures[t].isReady=!0;this._depthStencilTexture&&e._depthStencilTexture&&(this._depthStencilTexture._swapAndDie(e._depthStencilTexture),e._depthStencilTexture.isReady=!0),this._textures=null,this._depthStencilTexture=null}_rebuild(){const e=this._cloneRenderTargetWrapper();if(e){if(this._depthStencilTexture){const t=this._depthStencilTexture.samplingMode,i=this._depthStencilTexture.format,r=t===2||t===3||t===11;e.createDepthStencilTexture(this._depthStencilTexture._comparisonFunction,r,this._depthStencilTextureWithStencil,this._depthStencilTexture.samples,i,this._depthStencilTextureLabel)}this.samples>1&&e.setSamples(this.samples),e._swapRenderTargetWrapper(this),e.dispose()}}releaseTextures(){var e;if(this._textures)for(let t=0;t<((e=this._textures)==null?void 0:e.length);++t)this._textures[t].dispose();this._textures=null}dispose(e=!1){var t;e||((t=this._depthStencilTexture)==null||t.dispose(),this._depthStencilTexture=null,this.releaseTextures()),this._engine._releaseRenderTargetWrapper(this)}}class vH extends mH{constructor(e,t,i,r,s){super(e,t,i,r),this._framebuffer=null,this._depthStencilBuffer=null,this._MSAAFramebuffer=null,this._colorTextureArray=null,this._depthStencilTextureArray=null,this._disposeOnlyFramebuffers=!1,this._currentLOD=0,this._context=s}_cloneRenderTargetWrapper(){let e=null;return this._colorTextureArray&&this._depthStencilTextureArray?(e=this._engine.createMultiviewRenderTargetTexture(this.width,this.height),e.texture.isReady=!0):e=super._cloneRenderTargetWrapper(),e}_swapRenderTargetWrapper(e){super._swapRenderTargetWrapper(e),e._framebuffer=this._framebuffer,e._depthStencilBuffer=this._depthStencilBuffer,e._MSAAFramebuffer=this._MSAAFramebuffer,e._colorTextureArray=this._colorTextureArray,e._depthStencilTextureArray=this._depthStencilTextureArray,this._framebuffer=this._depthStencilBuffer=this._MSAAFramebuffer=this._colorTextureArray=this._depthStencilTextureArray=null}createDepthStencilTexture(e=0,t=!0,i=!1,r=1,s=14,a){if(this._depthStencilBuffer){const l=this._engine._currentFramebuffer,o=this._context;this._engine._bindUnboundFramebuffer(this._framebuffer),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,null),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,null),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.STENCIL_ATTACHMENT,o.RENDERBUFFER,null),this._engine._bindUnboundFramebuffer(l),o.deleteRenderbuffer(this._depthStencilBuffer),this._depthStencilBuffer=null}return super.createDepthStencilTexture(e,t,i,r,s,a)}_shareDepth(e){super._shareDepth(e);const t=this._context,i=this._depthStencilBuffer,r=e._MSAAFramebuffer||e._framebuffer;e._depthStencilBuffer&&e._depthStencilBuffer!==i&&t.deleteRenderbuffer(e._depthStencilBuffer),e._depthStencilBuffer=i;const s=e._generateStencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;this._engine._bindUnboundFramebuffer(r),t.framebufferRenderbuffer(t.FRAMEBUFFER,s,t.RENDERBUFFER,i),this._engine._bindUnboundFramebuffer(null)}_bindTextureRenderTarget(e,t=0,i,r=0){var l,o;if(!e._hardwareTexture)return;const s=this._framebuffer,a=this._engine._currentFramebuffer;if(this._engine._bindUnboundFramebuffer(s),this._engine.webGLVersion>1){const c=this._context,u=c["COLOR_ATTACHMENT"+t];e.is2DArray||e.is3D?(i=i??((l=this.layerIndices)==null?void 0:l[t])??0,c.framebufferTextureLayer(c.FRAMEBUFFER,u,e._hardwareTexture.underlyingResource,r,i)):e.isCube?(i=i??((o=this.faceIndices)==null?void 0:o[t])??0,c.framebufferTexture2D(c.FRAMEBUFFER,u,c.TEXTURE_CUBE_MAP_POSITIVE_X+i,e._hardwareTexture.underlyingResource,r)):c.framebufferTexture2D(c.FRAMEBUFFER,u,c.TEXTURE_2D,e._hardwareTexture.underlyingResource,r)}else{const c=this._context,u=c["COLOR_ATTACHMENT"+t+"_WEBGL"],h=i!==void 0?c.TEXTURE_CUBE_MAP_POSITIVE_X+i:c.TEXTURE_2D;c.framebufferTexture2D(c.FRAMEBUFFER,u,h,e._hardwareTexture.underlyingResource,r)}this._engine._bindUnboundFramebuffer(a)}setTexture(e,t=0,i=!0){super.setTexture(e,t,i),this._bindTextureRenderTarget(e,t)}setLayerAndFaceIndices(e,t){var r;if(super.setLayerAndFaceIndices(e,t),!this.textures||!this.layerIndices||!this.faceIndices)return;const i=((r=this._attachments)==null?void 0:r.length)??this.textures.length;for(let s=0;s<i;s++){const a=this.textures[s];a&&(a.is2DArray||a.is3D?this._bindTextureRenderTarget(a,s,this.layerIndices[s]):a.isCube?this._bindTextureRenderTarget(a,s,this.faceIndices[s]):this._bindTextureRenderTarget(a,s))}}setLayerAndFaceIndex(e=0,t,i){if(super.setLayerAndFaceIndex(e,t,i),!this.textures||!this.layerIndices||!this.faceIndices)return;const r=this.textures[e];r.is2DArray||r.is3D?this._bindTextureRenderTarget(this.textures[e],e,this.layerIndices[e]):r.isCube&&this._bindTextureRenderTarget(this.textures[e],e,this.faceIndices[e])}dispose(e=this._disposeOnlyFramebuffers){const t=this._context;e||(this._colorTextureArray&&(this._context.deleteTexture(this._colorTextureArray),this._colorTextureArray=null),this._depthStencilTextureArray&&(this._context.deleteTexture(this._depthStencilTextureArray),this._depthStencilTextureArray=null)),this._framebuffer&&(t.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._depthStencilBuffer&&(t.deleteRenderbuffer(this._depthStencilBuffer),this._depthStencilBuffer=null),this._MSAAFramebuffer&&(t.deleteFramebuffer(this._MSAAFramebuffer),this._MSAAFramebuffer=null),super.dispose(e)}}we.prototype._createHardwareRenderTargetWrapper=function(n,e,t){const i=new vH(n,e,t,this,this._gl);return this._renderTargetWrapperCache.push(i),i};we.prototype.createRenderTargetTexture=function(n,e){const t=this._createHardwareRenderTargetWrapper(!1,!1,n);let i=!0,r=!1,s=!1,a,l=1,o;e!==void 0&&typeof e=="object"&&(i=e.generateDepthBuffer??!0,r=!!e.generateStencilBuffer,s=!!e.noColorAttachment,a=e.colorAttachment,l=e.samples??1,o=e.label);const c=a||(s?null:this._createInternalTexture(n,e,!0,Xt.RenderTarget)),u=n.width||n,h=n.height||n,d=this._currentFramebuffer,f=this._gl,_=f.createFramebuffer();return this._bindUnboundFramebuffer(_),t._depthStencilBuffer=this._setupFramebufferDepthAttachments(r,i,u,h),c&&!c.is2DArray&&f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,c._hardwareTexture.underlyingResource,0),this._bindUnboundFramebuffer(d),t.label=o??"RenderTargetWrapper",t._framebuffer=_,t._generateDepthBuffer=i,t._generateStencilBuffer=r,t.setTextures(c),this.updateRenderTargetTextureSampleCount(t,l),t};we.prototype.createDepthStencilTexture=function(n,e,t){if(e.isCube){const i=n.width||n;return this._createDepthStencilCubeTexture(i,e)}else return this._createDepthStencilTexture(n,e,t)};we.prototype._createDepthStencilTexture=function(n,e){const t=this._gl,i=n.layers||0,r=i!==0?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D,s=new Qr(this,Xt.DepthStencil);if(s.label=e.label,!this._caps.depthTextureExtension)return ee.Error("Depth texture is not supported by your browser or hardware."),s;const a={bilinearFiltering:!1,comparisonFunction:0,generateStencil:!1,...e};if(this._bindTextureDirectly(r,s,!0),this._setupDepthStencilTexture(s,n,a.generateStencil,a.comparisonFunction===0?!1:a.bilinearFiltering,a.comparisonFunction,a.samples),a.depthTextureFormat!==void 0){if(a.depthTextureFormat!==15&&a.depthTextureFormat!==16&&a.depthTextureFormat!==17&&a.depthTextureFormat!==13&&a.depthTextureFormat!==14&&a.depthTextureFormat!==18)return ee.Error("Depth texture format is not supported."),s;s.format=a.depthTextureFormat}else s.format=a.generateStencil?13:16;const l=s.format===17||s.format===13||s.format===18;let o=t.UNSIGNED_INT;s.format===15?o=t.UNSIGNED_SHORT:s.format===17||s.format===13?o=t.UNSIGNED_INT_24_8:s.format===14?o=t.FLOAT:s.format===18&&(o=t.FLOAT_32_UNSIGNED_INT_24_8_REV);const c=l?t.DEPTH_STENCIL:t.DEPTH_COMPONENT;let u=c;return this.webGLVersion>1&&(s.format===15?u=t.DEPTH_COMPONENT16:s.format===16?u=t.DEPTH_COMPONENT24:s.format===17||s.format===13?u=t.DEPTH24_STENCIL8:s.format===14?u=t.DEPTH_COMPONENT32F:s.format===18&&(u=t.DEPTH32F_STENCIL8)),s.is2DArray?t.texImage3D(r,0,u,s.width,s.height,i,0,c,o,null):t.texImage2D(r,0,u,s.width,s.height,0,c,o,null),this._bindTextureDirectly(r,null),this._internalTexturesCache.push(s),s};we.prototype.updateRenderTargetTextureSampleCount=function(n,e){if(this.webGLVersion<2||!n||!n.texture)return 1;if(n.samples===e)return e;const t=this._gl;e=Math.min(e,this.getCaps().maxMSAASamples),n._depthStencilBuffer&&(t.deleteRenderbuffer(n._depthStencilBuffer),n._depthStencilBuffer=null),n._MSAAFramebuffer&&(t.deleteFramebuffer(n._MSAAFramebuffer),n._MSAAFramebuffer=null);const i=n.texture._hardwareTexture;if(i.releaseMSAARenderBuffers(),e>1&&typeof t.renderbufferStorageMultisample=="function"){const r=t.createFramebuffer();if(!r)throw new Error("Unable to create multi sampled framebuffer");n._MSAAFramebuffer=r,this._bindUnboundFramebuffer(n._MSAAFramebuffer);const s=this._createRenderBuffer(n.texture.width,n.texture.height,e,-1,this._getRGBABufferInternalSizedFormat(n.texture.type,n.texture.format,n.texture._useSRGBBuffer),t.COLOR_ATTACHMENT0,!1);if(!s)throw new Error("Unable to create multi sampled framebuffer");i.addMSAARenderBuffer(s)}else this._bindUnboundFramebuffer(n._framebuffer);return n.texture.samples=e,n._samples=e,n._depthStencilBuffer=this._setupFramebufferDepthAttachments(n._generateStencilBuffer,n._generateDepthBuffer,n.texture.width,n.texture.height,e),this._bindUnboundFramebuffer(null),e};we.prototype.createRenderTargetCubeTexture=function(n,e){const t=this._createHardwareRenderTargetWrapper(!1,!0,n),i={generateMipMaps:!0,generateDepthBuffer:!0,generateStencilBuffer:!1,type:0,samplingMode:3,format:5,...e};i.generateStencilBuffer=i.generateDepthBuffer&&i.generateStencilBuffer,(i.type===1&&!this._caps.textureFloatLinearFiltering||i.type===2&&!this._caps.textureHalfFloatLinearFiltering)&&(i.samplingMode=1);const r=this._gl,s=new Qr(this,Xt.RenderTarget);this._bindTextureDirectly(r.TEXTURE_CUBE_MAP,s,!0);const a=this._getSamplingParameters(i.samplingMode,i.generateMipMaps);i.type===1&&!this._caps.textureFloat&&(i.type=0,ee.Warn("Float textures are not supported. Cube render target forced to TEXTURETYPE_UNESIGNED_BYTE type")),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_MAG_FILTER,a.mag),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_MIN_FILTER,a.min),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);for(let o=0;o<6;o++)r.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,this._getRGBABufferInternalSizedFormat(i.type,i.format),n,n,0,this._getInternalFormat(i.format),this._getWebGLTextureType(i.type),null);const l=r.createFramebuffer();return this._bindUnboundFramebuffer(l),t._depthStencilBuffer=this._setupFramebufferDepthAttachments(i.generateStencilBuffer,i.generateDepthBuffer,n,n),i.generateMipMaps&&r.generateMipmap(r.TEXTURE_CUBE_MAP),this._bindTextureDirectly(r.TEXTURE_CUBE_MAP,null),this._bindUnboundFramebuffer(null),t._framebuffer=l,t._generateDepthBuffer=i.generateDepthBuffer,t._generateStencilBuffer=i.generateStencilBuffer,s.width=n,s.height=n,s.isReady=!0,s.isCube=!0,s.samples=1,s.generateMipMaps=i.generateMipMaps,s.samplingMode=i.samplingMode,s.type=i.type,s.format=i.format,this._internalTexturesCache.push(s),t.setTextures(s),t};const EH="postprocessVertexShader",yH=`attribute vec2 position;uniform vec2 scale;varying vec2 vUV;const vec2 madd=vec2(0.5,0.5);
#define CUSTOM_VERTEX_DEFINITIONS
void main(void) {
#define CUSTOM_VERTEX_MAIN_BEGIN
vUV=(position*madd+madd)*scale;gl_Position=vec4(position,0.0,1.0);
#define CUSTOM_VERTEX_MAIN_END
}`;ne.ShadersStore[EH]=yH;const Tp={positions:[1,1,-1,1,-1,-1,1,-1],indices:[0,1,2,0,2,3]};class TH{constructor(e,t=Tp){this._fullscreenViewport=new Ms(0,0,1,1);const i=t.positions??Tp.positions,r=t.indices??Tp.indices;this.engine=e,this._vertexBuffers={[x.PositionKind]:new x(e,i,x.PositionKind,!1,!1,2)},this._indexBuffer=e.createIndexBuffer(r),this._onContextRestoredObserver=e.onContextRestoredObservable.add(()=>{this._indexBuffer=e.createIndexBuffer(r);for(const s in this._vertexBuffers)this._vertexBuffers[s]._rebuild()})}setViewport(e=this._fullscreenViewport){this.engine.setViewport(e)}bindBuffers(e){this.engine.bindBuffers(this._vertexBuffers,this._indexBuffer,e)}applyEffectWrapper(e){this.engine.setState(!0),this.engine.depthCullingState.depthTest=!1,this.engine.stencilState.stencilTest=!1,this.engine.enableEffect(e._drawWrapper),this.bindBuffers(e.effect),e.onApplyObservable.notifyObservers({})}saveStates(){this._savedStateDepthTest=this.engine.depthCullingState.depthTest,this._savedStateStencilTest=this.engine.stencilState.stencilTest}restoreStates(){this.engine.depthCullingState.depthTest=this._savedStateDepthTest,this.engine.stencilState.stencilTest=this._savedStateStencilTest}draw(){this.engine.drawElementsType(0,0,6)}_isRenderTargetTexture(e){return e.renderTarget!==void 0}render(e,t=null){if(!e.effect.isReady())return;this.saveStates(),this.setViewport();const i=t===null?null:this._isRenderTargetTexture(t)?t.renderTarget:t;i&&this.engine.bindFramebuffer(i),this.applyEffectWrapper(e),this.draw(),i&&this.engine.unBindFramebuffer(i),this.restoreStates()}dispose(){const e=this._vertexBuffers[x.PositionKind];e&&(e.dispose(),delete this._vertexBuffers[x.PositionKind]),this._indexBuffer&&this.engine._releaseBuffer(this._indexBuffer),this._onContextRestoredObserver&&(this.engine.onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null)}}class bH{get effect(){return this._drawWrapper.effect}set effect(e){this._drawWrapper.effect=e}constructor(e){this.onApplyObservable=new Y;let t;const i=e.uniformNames||[];e.vertexShader?t={fragmentSource:e.fragmentShader,vertexSource:e.vertexShader,spectorName:e.name||"effectWrapper"}:(i.push("scale"),t={fragmentSource:e.fragmentShader,vertex:"postprocess",spectorName:e.name||"effectWrapper"},this.onApplyObservable.add(()=>{this.effect.setFloat2("scale",1,1)}));const r=e.defines?e.defines.join(`
`):"";this._drawWrapper=new ec(e.engine),e.useShaderStore?(t.fragment=t.fragmentSource,t.vertex||(t.vertex=t.vertexSource),delete t.fragmentSource,delete t.vertexSource,this.effect=e.engine.createEffect(t,e.attributeNames||["position"],i,e.samplerNames,r,void 0,e.onCompiled,void 0,void 0,e.shaderLanguage)):(this.effect=new _r(t,e.attributeNames||["position"],i,e.samplerNames,e.engine,r,void 0,e.onCompiled,void 0,void 0,void 0,e.shaderLanguage),this._onContextRestoredObserver=e.engine.onContextRestoredObservable.add(()=>{this.effect._pipelineContext=null,this.effect._prepareEffect()}))}dispose(){this._onContextRestoredObserver&&(this.effect.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null),this.effect.dispose()}}const DS="passPixelShader",LS=`varying vec2 vUV;uniform sampler2D textureSampler;
#define CUSTOM_FRAGMENT_DEFINITIONS
void main(void) 
{gl_FragColor=texture2D(textureSampler,vUV);}`;ne.ShadersStore[DS]=LS;const PT={name:DS,shader:LS};class fr{static _CreateDumpRenderer(){if(!fr._DumpToolsEngine){let e,t=null;const i={preserveDrawingBuffer:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};try{e=new OffscreenCanvas(100,100),t=new we(e,!1,i)}catch{e=document.createElement("canvas"),t=new we(e,!1,i)}t.getCaps().parallelShaderCompile=void 0;const r=new TH(t),s=new bH({engine:t,name:PT.name,fragmentShader:PT.shader,samplerNames:["textureSampler"]});fr._DumpToolsEngine={canvas:e,engine:t,renderer:r,wrapper:s}}return fr._DumpToolsEngine}static async DumpFramebuffer(e,t,i,r,s="image/png",a,l){const o=await i.readPixels(0,0,e,t),c=new Uint8Array(o.buffer);fr.DumpData(e,t,c,r,s,a,!0,void 0,l)}static DumpDataAsync(e,t,i,r="image/png",s,a=!1,l=!1,o){return new Promise(c=>{fr.DumpData(e,t,i,u=>c(u),r,s,a,l,o)})}static DumpData(e,t,i,r,s="image/png",a,l=!1,o=!1,c){const u=fr._CreateDumpRenderer();if(u.engine.setSize(e,t,!0),i instanceof Float32Array){const d=new Uint8Array(i.length);let f=i.length;for(;f--;){const _=i[f];d[f]=Math.round(dt.Clamp(_)*255)}i=d}const h=u.engine.createRawTexture(i,e,t,5,!1,!l,1);u.renderer.setViewport(),u.renderer.applyEffectWrapper(u.wrapper),u.wrapper.effect._bindTexture("textureSampler",h),u.renderer.draw(),o?X.ToBlob(u.canvas,d=>{const f=new FileReader;f.onload=_=>{const p=_.target.result;r&&r(p)},f.readAsArrayBuffer(d)},s,c):X.EncodeScreenshotCanvasData(u.canvas,r,s,a,c),h.dispose()}static Dispose(){fr._DumpToolsEngine&&(fr._DumpToolsEngine.wrapper.dispose(),fr._DumpToolsEngine.renderer.dispose(),fr._DumpToolsEngine.engine.dispose()),fr._DumpToolsEngine=null}}const CH=()=>{X.DumpData=fr.DumpData,X.DumpDataAsync=fr.DumpDataAsync,X.DumpFramebuffer=fr.DumpFramebuffer};CH();class os extends re{get renderList(){return this._renderList}set renderList(e){this._unObserveRenderList&&(this._unObserveRenderList(),this._unObserveRenderList=null),e&&(this._unObserveRenderList=QT(e,this._renderListHasChanged)),this._renderList=e}get postProcesses(){return this._postProcesses}get _prePassEnabled(){return!!this._prePassRenderTarget&&this._prePassRenderTarget.enabled}set onAfterUnbind(e){this._onAfterUnbindObserver&&this.onAfterUnbindObservable.remove(this._onAfterUnbindObserver),this._onAfterUnbindObserver=this.onAfterUnbindObservable.add(e)}set onBeforeRender(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e)}set onAfterRender(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(e)}set onClear(e){this._onClearObserver&&this.onClearObservable.remove(this._onClearObserver),this._onClearObserver=this.onClearObservable.add(e)}get renderPassIds(){return this._renderPassIds}get currentRefreshId(){return this._currentRefreshId}setMaterialForRendering(e,t){let i;Array.isArray(e)?i=e:i=[e];for(let r=0;r<i.length;++r)for(let s=0;s<this._renderPassIds.length;++s)i[r].setMaterialForRenderPass(this._renderPassIds[s],t!==void 0?Array.isArray(t)?t[s]:t:void 0)}get isMulti(){var e;return((e=this._renderTarget)==null?void 0:e.isMulti)??!1}get renderTargetOptions(){return this._renderTargetOptions}get renderTarget(){return this._renderTarget}_onRatioRescale(){this._sizeRatio&&this.resize(this._initialSizeParameter)}set boundingBoxSize(e){if(this._boundingBoxSize&&this._boundingBoxSize.equals(e))return;this._boundingBoxSize=e;const t=this.getScene();t&&t.markAllMaterialsAsDirty(1)}get boundingBoxSize(){return this._boundingBoxSize}get depthStencilTexture(){var e;return((e=this._renderTarget)==null?void 0:e._depthStencilTexture)??null}constructor(e,t,i,r=!1,s=!0,a=0,l=!1,o=re.TRILINEAR_SAMPLINGMODE,c=!0,u=!1,h=!1,d=5,f=!1,_,p,v=!1,E=!1){let g,m=!0;if(typeof r=="object"){const T=r;r=!!T.generateMipMaps,s=T.doNotChangeAspectRatio??!0,a=T.type??0,l=!!T.isCube,o=T.samplingMode??re.TRILINEAR_SAMPLINGMODE,c=T.generateDepthBuffer??!0,u=!!T.generateStencilBuffer,h=!!T.isMulti,d=T.format??5,f=!!T.delayAllocation,_=T.samples,p=T.creationFlags,v=!!T.noColorAttachment,E=!!T.useSRGBBuffer,g=T.colorAttachment,m=T.gammaSpace??m}if(super(null,i,!r,void 0,o,void 0,void 0,void 0,void 0,d),this._unObserveRenderList=null,this._renderListHasChanged=(T,b)=>{var M;const C=this._renderList?this._renderList.length:0;(b===0&&C>0||C===0)&&((M=this.getScene())==null||M.meshes.forEach(F=>{F._markSubMeshesAsLightDirty()}))},this.renderParticles=!0,this.renderSprites=!1,this.forceLayerMaskCheck=!1,this.ignoreCameraViewport=!1,this.onBeforeBindObservable=new Y,this.onAfterUnbindObservable=new Y,this.onBeforeRenderObservable=new Y,this.onAfterRenderObservable=new Y,this.onClearObservable=new Y,this.onResizeObservable=new Y,this._cleared=!1,this.skipInitialClear=!1,this._currentRefreshId=-1,this._refreshRate=1,this._samples=1,this._canRescale=!0,this._renderTarget=null,this.boundingBoxPosition=A.Zero(),i=this.getScene(),!i)return;const y=this.getScene().getEngine();this._gammaSpace=m,this._coordinatesMode=re.PROJECTION_MODE,this.renderList=[],this.name=e,this.isRenderTarget=!0,this._initialSizeParameter=t,this._renderPassIds=[],this._isCubeData=l,this._processSizeParameter(t),this.renderPassId=this._renderPassIds[0],this._resizeObserver=y.onResizeObservable.add(()=>{}),this._generateMipMaps=!!r,this._doNotChangeAspectRatio=s,this._renderingManager=new ir(i),this._renderingManager._useSceneAutoClearSetup=!0,!h&&(this._renderTargetOptions={generateMipMaps:r,type:a,format:this._format??void 0,samplingMode:this.samplingMode,generateDepthBuffer:c,generateStencilBuffer:u,samples:_,creationFlags:p,noColorAttachment:v,useSRGBBuffer:E,colorAttachment:g,label:this.name},this.samplingMode===re.NEAREST_SAMPLINGMODE&&(this.wrapU=re.CLAMP_ADDRESSMODE,this.wrapV=re.CLAMP_ADDRESSMODE),f||(l?(this._renderTarget=i.getEngine().createRenderTargetCubeTexture(this.getRenderSize(),this._renderTargetOptions),this.coordinatesMode=re.INVCUBIC_MODE,this._textureMatrix=z.Identity()):this._renderTarget=i.getEngine().createRenderTargetTexture(this._size,this._renderTargetOptions),this._texture=this._renderTarget.texture,_!==void 0&&(this.samples=_)))}createDepthStencilTexture(e=0,t=!0,i=!1,r=1,s=14){var a;(a=this._renderTarget)==null||a.createDepthStencilTexture(e,t,i,r,s)}_releaseRenderPassId(){if(this._scene){const e=this._scene.getEngine();for(let t=0;t<this._renderPassIds.length;++t)e.releaseRenderPassId(this._renderPassIds[t])}this._renderPassIds=[]}_createRenderPassId(){this._releaseRenderPassId();const e=this._scene.getEngine(),t=this._isCubeData?6:this.getRenderLayers()||1;for(let i=0;i<t;++i)this._renderPassIds[i]=e.createRenderPassId(`RenderTargetTexture - ${this.name}#${i}`)}_processSizeParameter(e,t=!0){if(e.ratio){this._sizeRatio=e.ratio;const i=this._getEngine();this._size={width:this._bestReflectionRenderTargetDimension(i.getRenderWidth(),this._sizeRatio),height:this._bestReflectionRenderTargetDimension(i.getRenderHeight(),this._sizeRatio)}}else this._size=e;t&&this._createRenderPassId()}get samples(){var e;return((e=this._renderTarget)==null?void 0:e.samples)??this._samples}set samples(e){this._renderTarget&&(this._samples=this._renderTarget.setSamples(e))}resetRefreshCounter(){this._currentRefreshId=-1}get refreshRate(){return this._refreshRate}set refreshRate(e){this._refreshRate=e,this.resetRefreshCounter()}addPostProcess(e){if(!this._postProcessManager){const t=this.getScene();if(!t)return;this._postProcessManager=new Mp(t),this._postProcesses=new Array}this._postProcesses.push(e),this._postProcesses[0].autoClear=!1}clearPostProcesses(e=!1){if(this._postProcesses){if(e)for(const t of this._postProcesses)t.dispose();this._postProcesses=[]}}removePostProcess(e){if(!this._postProcesses)return;const t=this._postProcesses.indexOf(e);t!==-1&&(this._postProcesses.splice(t,1),this._postProcesses.length>0&&(this._postProcesses[0].autoClear=!1))}_shouldRender(){return this._currentRefreshId===-1?(this._currentRefreshId=1,!0):this.refreshRate===this._currentRefreshId?(this._currentRefreshId=1,!0):(this._currentRefreshId++,!1)}getRenderSize(){return this.getRenderWidth()}getRenderWidth(){return this._size.width?this._size.width:this._size}getRenderHeight(){return this._size.width?this._size.height:this._size}getRenderLayers(){const e=this._size.layers;return e||0}disableRescaling(){this._canRescale=!1}get canRescale(){return this._canRescale}scale(e){const t=Math.max(1,this.getRenderSize()*e);this.resize(t)}getReflectionTextureMatrix(){return this.isCube?this._textureMatrix:super.getReflectionTextureMatrix()}resize(e){var r;const t=this.isCube;(r=this._renderTarget)==null||r.dispose(),this._renderTarget=null;const i=this.getScene();i&&(this._processSizeParameter(e,!1),t?this._renderTarget=i.getEngine().createRenderTargetCubeTexture(this.getRenderSize(),this._renderTargetOptions):this._renderTarget=i.getEngine().createRenderTargetTexture(this._size,this._renderTargetOptions),this._texture=this._renderTarget.texture,this._renderTargetOptions.samples!==void 0&&(this.samples=this._renderTargetOptions.samples),this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this))}render(e=!1,t=!1){this._render(e,t)}isReadyForRendering(){return this._render(!1,!1,!0)}_render(e=!1,t=!1,i=!1){const r=this.getScene();if(!r)return i;const s=r.getEngine();if(this.useCameraPostProcesses!==void 0&&(e=this.useCameraPostProcesses),this._waitingRenderList){if(!this.renderListPredicate){this.renderList=[];for(let u=0;u<this._waitingRenderList.length;u++){const h=this._waitingRenderList[u],d=r.getMeshById(h);d&&this.renderList.push(d)}}this._waitingRenderList=void 0}if(this.renderListPredicate){this.renderList?this.renderList.length=0:this.renderList=[];const u=this.getScene();if(!u)return i;const h=u.meshes;for(let d=0;d<h.length;d++){const f=h[d];this.renderListPredicate(f)&&this.renderList.push(f)}}const a=s.currentRenderPassId;this.onBeforeBindObservable.notifyObservers(this);const l=this.activeCamera??r.activeCamera,o=r.activeCamera;l&&(l!==r.activeCamera&&(r.setTransformMatrix(l.getViewMatrix(),l.getProjectionMatrix(!0)),r.activeCamera=l),s.setViewport(l.rigParent?l.rigParent.viewport:l.viewport,this.getRenderWidth(),this.getRenderHeight())),this._defaultRenderListPrepared=!1;let c=i;if(i){r.getViewMatrix()||r.updateTransformMatrix();const u=this.is2DArray?this.getRenderLayers():this.isCube?6:1;for(let h=0;h<u&&c;h++){let d=null;const f=this.renderList?this.renderList:r.getActiveMeshes().data,_=this.renderList?this.renderList.length:r.getActiveMeshes().length;s.currentRenderPassId=this._renderPassIds[h],this.onBeforeRenderObservable.notifyObservers(h),this.getCustomRenderList&&(d=this.getCustomRenderList(h,f,_)),d||(d=f),this._doNotChangeAspectRatio||r.updateTransformMatrix(!0);for(let p=0;p<d.length&&c;++p){const v=d[p];if(!(!v.isEnabled()||v.isBlocked||!v.isVisible||!v.subMeshes)){if(this.customIsReadyFunction){if(!this.customIsReadyFunction(v,this.refreshRate,i)){c=!1;continue}}else if(!v.isReady(!0)){c=!1;continue}}}this.onAfterRenderObservable.notifyObservers(h),(this.is2DArray||this.isCube)&&(r.incrementRenderId(),r.resetCachedMaterial())}}else if(this.is2DArray&&!this.isMulti)for(let u=0;u<this.getRenderLayers();u++)this._renderToTarget(0,e,t,u,l),r.incrementRenderId(),r.resetCachedMaterial();else if(this.isCube&&!this.isMulti)for(let u=0;u<6;u++)this._renderToTarget(u,e,t,void 0,l),r.incrementRenderId(),r.resetCachedMaterial();else this._renderToTarget(0,e,t,void 0,l);return this.onAfterUnbindObservable.notifyObservers(this),s.currentRenderPassId=a,o&&(r.activeCamera=o,this.activeCamera&&this.activeCamera!==r.activeCamera&&r.setTransformMatrix(r.activeCamera.getViewMatrix(),r.activeCamera.getProjectionMatrix(!0)),s.setViewport(r.activeCamera.viewport)),r.resetCachedMaterial(),c}_bestReflectionRenderTargetDimension(e,t){const r=e*t,s=Z.NearestPOT(r+128*128/(128+r));return Math.min(Z.FloorPOT(e),s)}_prepareRenderingManager(e,t,i,r){const s=this.getScene();if(!s)return;this._renderingManager.reset();const a=s.getRenderId();for(let l=0;l<t;l++){const o=e[l];if(o&&!o.isBlocked){if(this.customIsReadyFunction){if(!this.customIsReadyFunction(o,this.refreshRate,!1)){this.resetRefreshCounter();continue}}else if(!o.isReady(this.refreshRate===0)){this.resetRefreshCounter();continue}if(!o._internalAbstractMeshDataInfo._currentLODIsUpToDate&&s.activeCamera&&(o._internalAbstractMeshDataInfo._currentLOD=s.customLODSelector?s.customLODSelector(o,this.activeCamera||s.activeCamera):o.getLOD(this.activeCamera||s.activeCamera),o._internalAbstractMeshDataInfo._currentLODIsUpToDate=!0),!o._internalAbstractMeshDataInfo._currentLOD)continue;let c=o._internalAbstractMeshDataInfo._currentLOD;c._preActivateForIntermediateRendering(a);let u;if(r&&i?u=(o.layerMask&i.layerMask)===0:u=!1,o.isEnabled()&&o.isVisible&&o.subMeshes&&!u&&(c!==o&&c._activate(a,!0),o._activate(a,!0)&&o.subMeshes.length)){o.isAnInstance?o._internalAbstractMeshDataInfo._actAsRegularMesh&&(c=o):c._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!1,c._internalAbstractMeshDataInfo._isActiveIntermediate=!0;for(let h=0;h<c.subMeshes.length;h++){const d=c.subMeshes[h];this._renderingManager.dispatch(d,c)}}}}for(let l=0;l<s.particleSystems.length;l++){const o=s.particleSystems[l],c=o.emitter;!o.isStarted()||!c||c.position&&!c.isEnabled()||this._renderingManager.dispatchParticles(o)}}_bindFrameBuffer(e=0,t=0){const i=this.getScene();if(!i)return;const r=i.getEngine();this._renderTarget&&r.bindFramebuffer(this._renderTarget,this.isCube?e:void 0,void 0,void 0,this.ignoreCameraViewport,0,t)}_unbindFrameBuffer(e,t){this._renderTarget&&e.unBindFramebuffer(this._renderTarget,this.isCube,()=>{this.onAfterRenderObservable.notifyObservers(t)})}_prepareFrame(e,t,i,r){this._postProcessManager?this._prePassEnabled||this._postProcessManager._prepareFrame(this._texture,this._postProcesses):(!r||!e.postProcessManager._prepareFrame(this._texture))&&this._bindFrameBuffer(t,i)}_renderToTarget(e,t,i,r=0,s=null){var c,u,h;const a=this.getScene();if(!a)return;const l=a.getEngine();if((c=l._debugPushGroup)==null||c.call(l,`render to face #${e} layer #${r}`,1),this._prepareFrame(a,e,r,t),this.is2DArray?(l.currentRenderPassId=this._renderPassIds[r],this.onBeforeRenderObservable.notifyObservers(r)):(l.currentRenderPassId=this._renderPassIds[e],this.onBeforeRenderObservable.notifyObservers(e)),l.snapshotRendering&&l.snapshotRenderingMode===1)this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(l):this.skipInitialClear||l.clear(this.clearColor||a.clearColor,!0,!0,!0);else{let d=null;const f=this.renderList?this.renderList:a.getActiveMeshes().data,_=this.renderList?this.renderList.length:a.getActiveMeshes().length;this.getCustomRenderList&&(d=this.getCustomRenderList(this.is2DArray?r:e,f,_)),d?this._prepareRenderingManager(d,d.length,s,this.forceLayerMaskCheck):(this._defaultRenderListPrepared||(this._prepareRenderingManager(f,_,s,!this.renderList||this.forceLayerMaskCheck),this._defaultRenderListPrepared=!0),d=f);for(const v of a._beforeRenderTargetClearStage)v.action(this,e,r);this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(l):this.skipInitialClear||l.clear(this.clearColor||a.clearColor,!0,!0,!0),this._doNotChangeAspectRatio||a.updateTransformMatrix(!0);for(const v of a._beforeRenderTargetDrawStage)v.action(this,e,r);this._renderingManager.render(this.customRenderFunction,d,this.renderParticles,this.renderSprites);for(const v of a._afterRenderTargetDrawStage)v.action(this,e,r);const p=((u=this._texture)==null?void 0:u.generateMipMaps)??!1;this._texture&&(this._texture.generateMipMaps=!1),this._postProcessManager?this._postProcessManager._finalizeFrame(!1,this._renderTarget??void 0,e,this._postProcesses,this.ignoreCameraViewport):t&&a.postProcessManager._finalizeFrame(!1,this._renderTarget??void 0,e);for(const v of a._afterRenderTargetPostProcessStage)v.action(this,e,r);this._texture&&(this._texture.generateMipMaps=p),this._doNotChangeAspectRatio||a.updateTransformMatrix(!0),i&&fr.DumpFramebuffer(this.getRenderWidth(),this.getRenderHeight(),l)}this._unbindFrameBuffer(l,e),this._texture&&this.isCube&&e===5&&l.generateMipMapsForCubemap(this._texture),(h=l._debugPopGroup)==null||h.call(l,1)}setRenderingOrder(e,t=null,i=null,r=null){this._renderingManager.setRenderingOrder(e,t,i,r)}setRenderingAutoClearDepthStencil(e,t){this._renderingManager.setRenderingAutoClearDepthStencil(e,t),this._renderingManager._useSceneAutoClearSetup=!1}clone(){const e=this.getSize(),t=new os(this.name,e,this.getScene(),this._renderTargetOptions.generateMipMaps,this._doNotChangeAspectRatio,this._renderTargetOptions.type,this.isCube,this._renderTargetOptions.samplingMode,this._renderTargetOptions.generateDepthBuffer,this._renderTargetOptions.generateStencilBuffer,void 0,this._renderTargetOptions.format,void 0,this._renderTargetOptions.samples);return t.hasAlpha=this.hasAlpha,t.level=this.level,t.coordinatesMode=this.coordinatesMode,this.renderList&&(t.renderList=this.renderList.slice(0)),t}serialize(){if(!this.name)return null;const e=super.serialize();if(e.renderTargetSize=this.getRenderSize(),e.renderList=[],this.renderList)for(let t=0;t<this.renderList.length;t++)e.renderList.push(this.renderList[t].id);return e}disposeFramebufferObjects(){var e;(e=this._renderTarget)==null||e.dispose(!0)}releaseInternalTexture(){var e;(e=this._renderTarget)==null||e.releaseTextures(),this._texture=null}dispose(){var i;this.onResizeObservable.clear(),this.onClearObservable.clear(),this.onAfterRenderObservable.clear(),this.onAfterUnbindObservable.clear(),this.onBeforeBindObservable.clear(),this.onBeforeRenderObservable.clear(),this._postProcessManager&&(this._postProcessManager.dispose(),this._postProcessManager=null),this._prePassRenderTarget&&this._prePassRenderTarget.dispose(),this._releaseRenderPassId(),this.clearPostProcesses(!0),this._resizeObserver&&(this.getScene().getEngine().onResizeObservable.remove(this._resizeObserver),this._resizeObserver=null),this.renderList=null;const e=this.getScene();if(!e)return;let t=e.customRenderTargets.indexOf(this);t>=0&&e.customRenderTargets.splice(t,1);for(const r of e.cameras)t=r.customRenderTargets.indexOf(this),t>=0&&r.customRenderTargets.splice(t,1);(i=this._renderTarget)==null||i.dispose(),this._renderTarget=null,this._texture=null,super.dispose()}_rebuild(){this.refreshRate===os.REFRESHRATE_RENDER_ONCE&&(this.refreshRate=os.REFRESHRATE_RENDER_ONCE),this._postProcessManager&&this._postProcessManager._rebuild()}freeRenderingGroups(){this._renderingManager&&this._renderingManager.freeRenderingGroups()}getViewCount(){return 1}}os.REFRESHRATE_RENDER_ONCE=0;os.REFRESHRATE_RENDER_ONEVERYFRAME=1;os.REFRESHRATE_RENDER_ONEVERYTWOFRAMES=2;re._CreateRenderTargetTexture=(n,e,t,i,r)=>new os(n,e,t,i);class kt{static RegisterShaderCodeProcessing(e,t){if(!t){delete kt._CustomShaderCodeProcessing[e??""];return}kt._CustomShaderCodeProcessing[e??""]=t}static _GetShaderCodeProcessing(e){return kt._CustomShaderCodeProcessing[e]??kt._CustomShaderCodeProcessing[""]}get samples(){return this._samples}set samples(e){this._samples=Math.min(e,this._engine.getCaps().maxMSAASamples),this._textures.forEach(t=>{t.setSamples(this._samples)})}getEffectName(){return this._fragmentUrl}set onActivate(e){this._onActivateObserver&&this.onActivateObservable.remove(this._onActivateObserver),e&&(this._onActivateObserver=this.onActivateObservable.add(e))}set onSizeChanged(e){this._onSizeChangedObserver&&this.onSizeChangedObservable.remove(this._onSizeChangedObserver),this._onSizeChangedObserver=this.onSizeChangedObservable.add(e)}set onApply(e){this._onApplyObserver&&this.onApplyObservable.remove(this._onApplyObserver),this._onApplyObserver=this.onApplyObservable.add(e)}set onBeforeRender(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e)}set onAfterRender(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(e)}get inputTexture(){return this._textures.data[this._currentRenderTextureInd]}set inputTexture(e){this._forcedOutputTexture=e}restoreDefaultInputTexture(){this._forcedOutputTexture&&(this._forcedOutputTexture=null,this.markTextureDirty())}getCamera(){return this._camera}get texelSize(){return this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.texelSize:(this._forcedOutputTexture&&this._texelSize.copyFromFloats(1/this._forcedOutputTexture.width,1/this._forcedOutputTexture.height),this._texelSize)}constructor(e,t,i,r,s,a,l=1,o,c,u=null,h=0,d="postprocess",f,_=!1,p=5,v=Oi.GLSL){this._parentContainer=null,this.width=-1,this.height=-1,this.nodeMaterialSource=null,this._outputTexture=null,this.autoClear=!0,this.forceAutoClearInAlphaMode=!1,this.alphaMode=0,this.animations=[],this.enablePixelPerfectMode=!1,this.forceFullscreenViewport=!0,this.scaleMode=1,this.alwaysForcePOT=!1,this._samples=1,this.adaptScaleToCurrentViewport=!1,this._reusable=!1,this._renderId=0,this.externalTextureSamplerBinding=!1,this._textures=new or(2),this._textureCache=[],this._currentRenderTextureInd=0,this._scaleRatio=new xe(1,1),this._texelSize=xe.Zero(),this.onActivateObservable=new Y,this.onSizeChangedObservable=new Y,this.onApplyObservable=new Y,this.onBeforeRenderObservable=new Y,this.onAfterRenderObservable=new Y,this.name=e;let E=1,g=null;if(i&&!Array.isArray(i)){const m=i;i=m.uniforms??null,r=m.samplers??null,E=m.size??1,a=m.camera??null,l=m.samplingMode??1,o=m.engine,c=m.reusable,u=m.defines??null,h=m.textureType??0,d=m.vertexUrl??"postprocess",f=m.indexParameters,_=m.blockCompilation??!1,p=m.textureFormat??5,v=m.shaderLanguage??Oi.GLSL,g=m.uniformBuffers??null}else s&&(typeof s=="number"?E=s:E={width:s.width,height:s.height});a!=null?(this._camera=a,this._scene=a.getScene(),a.attachPostProcess(this),this._engine=this._scene.getEngine(),this._scene.postProcesses.push(this),this.uniqueId=this._scene.getUniqueId()):o&&(this._engine=o,this._engine.postProcesses.push(this)),this._options=E,this.renderTargetSamplingMode=l||1,this._reusable=c||!1,this._textureType=h,this._textureFormat=p,this._shaderLanguage=v,this._samplers=r||[],this._samplers.push("textureSampler"),this._fragmentUrl=t,this._vertexUrl=d,this._parameters=i||[],this._parameters.push("scale"),this._uniformBuffers=g||[],this._indexParameters=f,this._drawWrapper=new ec(this._engine),_||this.updateEffect(u)}getClassName(){return"PostProcess"}getEngine(){return this._engine}getEffect(){return this._drawWrapper.effect}shareOutputWith(e){return this._disposeTextures(),this._shareOutputWithPostProcess=e,this}useOwnOutput(){this._textures.length==0&&(this._textures=new or(2)),this._shareOutputWithPostProcess=null}updateEffect(e=null,t=null,i=null,r,s,a,l,o){const c=kt._GetShaderCodeProcessing(this.name);if(c!=null&&c.defineCustomBindings){const u=(t==null?void 0:t.slice())??[];u.push(...this._parameters);const h=(i==null?void 0:i.slice())??[];h.push(...this._samplers),e=c.defineCustomBindings(this.name,e,u,h),t=u,i=h}this._postProcessDefines=e,this._drawWrapper.effect=this._engine.createEffect({vertex:l??this._vertexUrl,fragment:o??this._fragmentUrl},{attributes:["position"],uniformsNames:t||this._parameters,uniformBuffersNames:this._uniformBuffers,samplers:i||this._samplers,defines:e!==null?e:"",fallbacks:null,onCompiled:s??null,onError:a??null,indexParameters:r||this._indexParameters,processCodeAfterIncludes:c!=null&&c.processCodeAfterIncludes?(u,h)=>c.processCodeAfterIncludes(this.name,u,h):null,processFinalCode:c!=null&&c.processFinalCode?(u,h)=>c.processFinalCode(this.name,u,h):null,shaderLanguage:this._shaderLanguage},this._engine)}isReusable(){return this._reusable}markTextureDirty(){this.width=-1}_createRenderTargetTexture(e,t,i=0){for(let s=0;s<this._textureCache.length;s++)if(this._textureCache[s].texture.width===e.width&&this._textureCache[s].texture.height===e.height&&this._textureCache[s].postProcessChannel===i&&this._textureCache[s].texture._generateDepthBuffer===t.generateDepthBuffer&&this._textureCache[s].texture.samples===t.samples)return this._textureCache[s].texture;const r=this._engine.createRenderTargetTexture(e,t);return this._textureCache.push({texture:r,postProcessChannel:i,lastUsedRenderId:-1}),r}_flushTextureCache(){const e=this._renderId;for(let t=this._textureCache.length-1;t>=0;t--)if(e-this._textureCache[t].lastUsedRenderId>100){let i=!1;for(let r=0;r<this._textures.length;r++)if(this._textures.data[r]===this._textureCache[t].texture){i=!0;break}i||(this._textureCache[t].texture.dispose(),this._textureCache.splice(t,1))}}resize(e,t,i=null,r=!1,s=!1){this._textures.length>0&&this._textures.reset(),this.width=e,this.height=t;let a=null;if(i){for(let c=0;c<i._postProcesses.length;c++)if(i._postProcesses[c]!==null){a=i._postProcesses[c];break}}const l={width:this.width,height:this.height},o={generateMipMaps:r,generateDepthBuffer:s||a===this,generateStencilBuffer:(s||a===this)&&this._engine.isStencilEnable,samplingMode:this.renderTargetSamplingMode,type:this._textureType,format:this._textureFormat,samples:this._samples,label:"PostProcessRTT-"+this.name};this._textures.push(this._createRenderTargetTexture(l,o,0)),this._reusable&&this._textures.push(this._createRenderTargetTexture(l,o,1)),this._texelSize.copyFromFloats(1/this.width,1/this.height),this.onSizeChangedObservable.notifyObservers(this)}_getTarget(){let e;if(this._shareOutputWithPostProcess)e=this._shareOutputWithPostProcess.inputTexture;else if(this._forcedOutputTexture)e=this._forcedOutputTexture,this.width=this._forcedOutputTexture.width,this.height=this._forcedOutputTexture.height;else{e=this.inputTexture;let t;for(let i=0;i<this._textureCache.length;i++)if(this._textureCache[i].texture===e){t=this._textureCache[i];break}t&&(t.lastUsedRenderId=this._renderId)}return e}activate(e,t=null,i){var f,_;e=e||this._camera;const r=e.getScene(),s=r.getEngine(),a=s.getCaps().maxTextureSize,l=(t?t.width:this._engine.getRenderWidth(!0))*this._options|0,o=(t?t.height:this._engine.getRenderHeight(!0))*this._options|0;let c=this._options.width||l,u=this._options.height||o;const h=this.renderTargetSamplingMode!==7&&this.renderTargetSamplingMode!==1&&this.renderTargetSamplingMode!==2;let d=null;if(!this._shareOutputWithPostProcess&&!this._forcedOutputTexture){if(this.adaptScaleToCurrentViewport){const p=s.currentViewport;p&&(c*=p.width,u*=p.height)}(h||this.alwaysForcePOT)&&(this._options.width||(c=s.needPOTTextures?Z.GetExponentOfTwo(c,a,this.scaleMode):c),this._options.height||(u=s.needPOTTextures?Z.GetExponentOfTwo(u,a,this.scaleMode):u)),(this.width!==c||this.height!==u||!(d=this._getTarget()))&&this.resize(c,u,e,h,i),this._textures.forEach(p=>{p.samples!==this.samples&&this._engine.updateRenderTargetTextureSampleCount(p,this.samples)}),this._flushTextureCache(),this._renderId++}return d||(d=this._getTarget()),this.enablePixelPerfectMode?(this._scaleRatio.copyFromFloats(l/c,o/u),this._engine.bindFramebuffer(d,0,l,o,this.forceFullscreenViewport)):(this._scaleRatio.copyFromFloats(1,1),this._engine.bindFramebuffer(d,0,void 0,void 0,this.forceFullscreenViewport)),(_=(f=this._engine)._debugInsertMarker)==null||_.call(f,`post process ${this.name} input`),this.onActivateObservable.notifyObservers(e),this.autoClear&&(this.alphaMode===0||this.forceAutoClearInAlphaMode)&&this._engine.clear(this.clearColor?this.clearColor:r.clearColor,r._allowPostProcessClearColor,!0,!0),this._reusable&&(this._currentRenderTextureInd=(this._currentRenderTextureInd+1)%2),d}get isSupported(){return this._drawWrapper.effect.isSupported}get aspectRatio(){return this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.aspectRatio:this._forcedOutputTexture?this._forcedOutputTexture.width/this._forcedOutputTexture.height:this.width/this.height}isReady(){var e;return((e=this._drawWrapper.effect)==null?void 0:e.isReady())??!1}apply(){var t,i,r;if(!((t=this._drawWrapper.effect)!=null&&t.isReady()))return null;this._engine.enableEffect(this._drawWrapper),this._engine.setState(!1),this._engine.setDepthBuffer(!1),this._engine.setDepthWrite(!1),this._engine.setAlphaMode(this.alphaMode),this.alphaConstants&&this.getEngine().setAlphaConstants(this.alphaConstants.r,this.alphaConstants.g,this.alphaConstants.b,this.alphaConstants.a);let e;return this._shareOutputWithPostProcess?e=this._shareOutputWithPostProcess.inputTexture:this._forcedOutputTexture?e=this._forcedOutputTexture:e=this.inputTexture,this.externalTextureSamplerBinding||this._drawWrapper.effect._bindTexture("textureSampler",e==null?void 0:e.texture),this._drawWrapper.effect.setVector2("scale",this._scaleRatio),this.onApplyObservable.notifyObservers(this._drawWrapper.effect),(r=(i=kt._GetShaderCodeProcessing(this.name))==null?void 0:i.bindCustomBindings)==null||r.call(i,this.name,this._drawWrapper.effect),this._drawWrapper.effect}_disposeTextures(){if(this._shareOutputWithPostProcess||this._forcedOutputTexture){this._disposeTextureCache();return}this._disposeTextureCache(),this._textures.dispose()}_disposeTextureCache(){for(let e=this._textureCache.length-1;e>=0;e--)this._textureCache[e].texture.dispose();this._textureCache.length=0}setPrePassRenderer(e){return this._prePassEffectConfiguration?(this._prePassEffectConfiguration=e.addEffectConfiguration(this._prePassEffectConfiguration),this._prePassEffectConfiguration.enabled=!0,!0):!1}dispose(e){e=e||this._camera,this._disposeTextures();let t;if(this._scene&&(t=this._scene.postProcesses.indexOf(this),t!==-1&&this._scene.postProcesses.splice(t,1)),this._parentContainer){const i=this._parentContainer.postProcesses.indexOf(this);i>-1&&this._parentContainer.postProcesses.splice(i,1),this._parentContainer=null}if(t=this._engine.postProcesses.indexOf(this),t!==-1&&this._engine.postProcesses.splice(t,1),!!e){if(e.detachPostProcess(this),t=e._postProcesses.indexOf(this),t===0&&e._postProcesses.length>0){const i=this._camera._getFirstPostProcess();i&&i.markTextureDirty()}this.onActivateObservable.clear(),this.onAfterRenderObservable.clear(),this.onApplyObservable.clear(),this.onBeforeRenderObservable.clear(),this.onSizeChangedObservable.clear()}}serialize(){const e=Fe.Serialize(this),t=this.getCamera()||this._scene&&this._scene.activeCamera;return e.customType="BABYLON."+this.getClassName(),e.cameraId=t?t.id:null,e.reusable=this._reusable,e.textureType=this._textureType,e.fragmentUrl=this._fragmentUrl,e.parameters=this._parameters,e.samplers=this._samplers,e.options=this._options,e.defines=this._postProcessDefines,e.textureFormat=this._textureFormat,e.vertexUrl=this._vertexUrl,e.indexParameters=this._indexParameters,e}clone(){const e=this.serialize();e._engine=this._engine,e.cameraId=null;const t=kt.Parse(e,this._scene,"");return t?(t.onActivateObservable=this.onActivateObservable.clone(),t.onSizeChangedObservable=this.onSizeChangedObservable.clone(),t.onApplyObservable=this.onApplyObservable.clone(),t.onBeforeRenderObservable=this.onBeforeRenderObservable.clone(),t.onAfterRenderObservable=this.onAfterRenderObservable.clone(),t._prePassEffectConfiguration=this._prePassEffectConfiguration,t):null}static Parse(e,t,i){const r=Bn(e.customType);if(!r||!r._Parse)return null;const s=t?t.getCameraById(e.cameraId):null;return r._Parse(e,s,t,i)}static _Parse(e,t,i,r){return Fe.Parse(()=>new kt(e.name,e.fragmentUrl,e.parameters,e.samplers,e.options,t,e.renderTargetSamplingMode,e._engine,e.reusable,e.defines,e.textureType,e.vertexUrl,e.indexParameters,!1,e.textureFormat),e,i,r)}}kt._CustomShaderCodeProcessing={};R([I()],kt.prototype,"uniqueId",void 0);R([I()],kt.prototype,"name",void 0);R([I()],kt.prototype,"width",void 0);R([I()],kt.prototype,"height",void 0);R([I()],kt.prototype,"renderTargetSamplingMode",void 0);R([d1()],kt.prototype,"clearColor",void 0);R([I()],kt.prototype,"autoClear",void 0);R([I()],kt.prototype,"forceAutoClearInAlphaMode",void 0);R([I()],kt.prototype,"alphaMode",void 0);R([I()],kt.prototype,"alphaConstants",void 0);R([I()],kt.prototype,"enablePixelPerfectMode",void 0);R([I()],kt.prototype,"forceFullscreenViewport",void 0);R([I()],kt.prototype,"scaleMode",void 0);R([I()],kt.prototype,"alwaysForcePOT",void 0);R([I("samples")],kt.prototype,"_samples",void 0);R([I()],kt.prototype,"adaptScaleToCurrentViewport",void 0);Ji("BABYLON.PostProcess",kt);const AH="passCubePixelShader",SH=`varying vec2 vUV;uniform samplerCube textureSampler;
#define CUSTOM_FRAGMENT_DEFINITIONS
void main(void) 
{vec2 uv=vUV*2.0-1.0;
#ifdef POSITIVEX
gl_FragColor=textureCube(textureSampler,vec3(1.001,uv.y,uv.x));
#endif
#ifdef NEGATIVEX
gl_FragColor=textureCube(textureSampler,vec3(-1.001,uv.y,uv.x));
#endif
#ifdef POSITIVEY
gl_FragColor=textureCube(textureSampler,vec3(uv.y,1.001,uv.x));
#endif
#ifdef NEGATIVEY
gl_FragColor=textureCube(textureSampler,vec3(uv.y,-1.001,uv.x));
#endif
#ifdef POSITIVEZ
gl_FragColor=textureCube(textureSampler,vec3(uv,1.001));
#endif
#ifdef NEGATIVEZ
gl_FragColor=textureCube(textureSampler,vec3(uv,-1.001));
#endif
}`;ne.ShadersStore[AH]=SH;class th extends kt{getClassName(){return"PassPostProcess"}constructor(e,t,i=null,r,s,a,l=0,o=!1){super(e,"pass",null,null,t,i,r,s,a,void 0,l,void 0,null,o)}static _Parse(e,t,i,r){return Fe.Parse(()=>new th(e.name,e.options,t,e.renderTargetSamplingMode,e._engine,e.reusable),e,i,r)}}Ji("BABYLON.PassPostProcess",th);Z._RescalePostProcessFactory=n=>new th("rescale",1,null,2,n,!1,0);function RH(n,e,t,i=!0){const r=n.getScene(),s=r.getEngine(),a=new os("resized"+n.name,{width:e,height:t},r,!n.noMipmap,!0,n._texture.type,!1,n.samplingMode,!1);a.wrapU=n.wrapU,a.wrapV=n.wrapV,a.uOffset=n.uOffset,a.vOffset=n.vOffset,a.uScale=n.uScale,a.vScale=n.vScale,a.uAng=n.uAng,a.vAng=n.vAng,a.wAng=n.wAng,a.coordinatesIndex=n.coordinatesIndex,a.level=n.level,a.anisotropicFilteringLevel=n.anisotropicFilteringLevel,a._texture.isReady=!1,n.wrapU=re.CLAMP_ADDRESSMODE,n.wrapV=re.CLAMP_ADDRESSMODE;const l=new th("pass",1,null,i?re.BILINEAR_SAMPLINGMODE:re.NEAREST_SAMPLINGMODE,s,!1,0);return l.externalTextureSamplerBinding=!0,l.getEffect().executeWhenCompiled(()=>{l.onApply=function(c){c.setTexture("textureSampler",n)};const o=a.renderTarget;o&&(r.postProcessManager.directRender([l],o),s.unBindFramebuffer(o),a.disposeFramebufferObjects(),l.dispose(),a.getInternalTexture().isReady=!0)}),a}function NS(n,e,t,i,r,s,a,l){const o=e.getEngine();return e.isReady=!1,r=r??e.samplingMode,i=i??e.type,s=s??e.format,a=a??e.width,l=l??e.height,i===-1&&(i=0),new Promise(c=>{const u=new kt("postprocess",n,null,null,1,null,r,o,!1,void 0,i,void 0,null,!1,s);u.externalTextureSamplerBinding=!0;const h=o.createRenderTargetTexture({width:a,height:l},{generateDepthBuffer:!1,generateMipMaps:!1,generateStencilBuffer:!1,samplingMode:r,type:i,format:s});u.getEffect().executeWhenCompiled(()=>{u.onApply=d=>{d._bindTexture("textureSampler",e),d.setFloat2("scale",1,1)},t.postProcessManager.directRender([u],h,!0),o.restoreDefaultFramebuffer(),o._releaseTexture(e),u&&u.dispose(),h._swapAndDie(e),e.type=i,e.format=5,e.isReady=!0,c(e)})})}let wh,wT;function xH(n){wh||(wh=new Float32Array(1),wT=new Int32Array(wh.buffer)),wh[0]=n;const e=wT[0];let t=e>>16&32768,i=e>>12&2047;const r=e>>23&255;return r<103?t:r>142?(t|=31744,t|=(r==255?0:1)&&e&8388607,t):r<113?(i|=2048,t|=(i>>114-r)+(i>>113-r&1),t):(t|=r-112<<10|i>>1,t+=i&1,t)}function MH(n){const e=(n&32768)>>15,t=(n&31744)>>10,i=n&1023;return t===0?(e?-1:1)*Math.pow(2,-14)*(i/Math.pow(2,10)):t==31?i?NaN:(e?-1:1)*(1/0):(e?-1:1)*Math.pow(2,t-15)*(1+i/Math.pow(2,10))}const IH=async(n,e,t,i,r)=>{const s=n.getScene(),a=s.getEngine();let l;if(!n.isCube)l=new kt("lod","lod",["lod","gamma"],null,1,null,re.NEAREST_NEAREST_MIPNEAREST,a);else{const u=["#define POSITIVEX","#define NEGATIVEX","#define POSITIVEY","#define NEGATIVEY","#define POSITIVEZ","#define NEGATIVEZ"];l=new kt("lodCube","lodCube",["lod","gamma"],null,1,null,re.NEAREST_NEAREST_MIPNEAREST,a,!1,u[i])}await new Promise(u=>{l.getEffect().executeWhenCompiled(()=>{u(0)})});const o=new os("temp",{width:e,height:t},s,!1);l.onApply=function(u){u.setTexture("textureSampler",n),u.setFloat("lod",r),u.setBool("gamma",n.gammaSpace)};const c=n.getInternalTexture();try{if(o.renderTarget&&c){const u=c.samplingMode;r!==0?n.updateSamplingMode(re.NEAREST_NEAREST_MIPNEAREST):n.updateSamplingMode(re.NEAREST_NEAREST),s.postProcessManager.directRender([l],o.renderTarget,!0),n.updateSamplingMode(u);const h=await a.readPixels(0,0,e,t),d=new Uint8Array(h.buffer,0,h.byteLength);return a.unBindFramebuffer(o.renderTarget),d}else throw Error("Render to texture failed.")}finally{o.dispose(),l.dispose()}};async function PH(n,e,t,i=0,r=0){return!n.isReady()&&n._texture&&await new Promise((s,a)=>{if(n._texture===null){a(0);return}n._texture.onLoadedObservable.addOnce(()=>{s(0)})}),await IH(n,e,t,i,r)}const bp={CreateResizedCopy:RH,ApplyPostProcess:NS,ToHalfFloat:xH,FromHalfFloat:MH,GetTextureDataAsync:PH};function wH(n){switch(n){case"image/jpeg":return".jpg";case"image/png":return".png";case"image/webp":return".webp"}}class jt{constructor(e){this._textureMap={},this._internalTextureToImage={},this._textureMap={},this._exporter=e}static _FuzzyEquals(e,t,i){return dt.WithinEpsilon(e.r,t.r,i)&&dt.WithinEpsilon(e.g,t.g,i)&&dt.WithinEpsilon(e.b,t.b,i)}_convertMaterialsToGLTFAsync(e,t,i){const r=[];return e.forEach(s=>{s.getClassName()==="StandardMaterial"?r.push(this._convertStandardMaterialAsync(s,t,i)):s.getClassName().indexOf("PBR")!==-1?r.push(this._convertPBRMaterialAsync(s,t,i)):X.Warn(`Unsupported material type: ${s.name}`)}),Promise.all(r).then(()=>{})}_stripTexturesFromMaterial(e){const t={};if(e){t.name=e.name,t.doubleSided=e.doubleSided,t.alphaMode=e.alphaMode,t.alphaCutoff=e.alphaCutoff,t.emissiveFactor=e.emissiveFactor;const i=e.pbrMetallicRoughness;i&&(t.pbrMetallicRoughness={},t.pbrMetallicRoughness.baseColorFactor=i.baseColorFactor,t.pbrMetallicRoughness.metallicFactor=i.metallicFactor,t.pbrMetallicRoughness.roughnessFactor=i.roughnessFactor)}return t}_hasTexturesPresent(e){var i;if(e.emissiveTexture||e.normalTexture||e.occlusionTexture)return!0;const t=e.pbrMetallicRoughness;if(t&&(t.baseColorTexture||t.metallicRoughnessTexture))return!0;if(e.extensions)for(const r in e.extensions){const s=e.extensions[r];if(s)return(i=s.hasTextures)==null?void 0:i.call(s)}return!1}_getTextureInfo(e){if(e){const t=e.uid;if(t in this._textureMap)return this._textureMap[t]}return null}_convertToGLTFPBRMetallicRoughness(e){const t=new xe(0,1),i=new xe(0,.1),r=new xe(0,.1),s=new xe(1300,.1);function a(f,_,p,v,E){return(1-f)*(1-f)*(1-f)*_+3*(1-f)*(1-f)*f*p+3*(1-f)*f*f*v+f*f*f*E}function l(f){const _=Math.pow(f/s.x,.333333);return a(_,t.y,i.y,r.y,s.y)}const o=e.diffuseColor.toLinearSpace(e.getScene().getEngine().useExactSrgbConversions).scale(.5),c=e.alpha,u=dt.Clamp(e.specularPower,0,jt._MaxSpecularPower),h=l(u);return{baseColorFactor:[o.r,o.g,o.b,c],metallicFactor:0,roughnessFactor:h}}static _SolveMetallic(e,t,i){if(t<this._DielectricSpecular.r)return this._DielectricSpecular,0;const r=this._DielectricSpecular.r,s=e*i/(1-this._DielectricSpecular.r)+t-2*this._DielectricSpecular.r,a=this._DielectricSpecular.r-t,l=s*s-4*r*a;return dt.Clamp((-s+Math.sqrt(l))/(2*r),0,1)}static _SetAlphaMode(e,t){t.needAlphaBlending()?e.alphaMode="BLEND":t.needAlphaTesting()&&(e.alphaMode="MASK",e.alphaCutoff=t.alphaCutOff)}_convertStandardMaterialAsync(e,t,i){const r=this._exporter._materialMap,s=this._exporter._materials,a=[],l=this._convertToGLTFPBRMetallicRoughness(e),o={name:e.name};if(e.backFaceCulling!=null&&!e.backFaceCulling&&(e.twoSidedLighting||X.Warn(e.name+": Back-face culling disabled and two-sided lighting disabled is not supported in glTF."),o.doubleSided=!0),i){e.diffuseTexture&&a.push(this._exportTextureAsync(e.diffuseTexture,t).then(u=>{u&&(l.baseColorTexture=u)}));const c=e.bumpTexture;c&&a.push(this._exportTextureAsync(c,t).then(u=>{u&&(o.normalTexture=u,c.level!==1&&(o.normalTexture.scale=c.level))})),e.emissiveTexture&&(o.emissiveFactor=[1,1,1],a.push(this._exportTextureAsync(e.emissiveTexture,t).then(u=>{u&&(o.emissiveTexture=u)}))),e.ambientTexture&&a.push(this._exportTextureAsync(e.ambientTexture,t).then(u=>{if(u){const h={index:u.index};o.occlusionTexture=h}}))}return(e.alpha<1||e.opacityTexture)&&(e.alphaMode===B.ALPHA_COMBINE?o.alphaMode="BLEND":X.Warn(e.name+": glTF 2.0 does not support alpha mode: "+e.alphaMode.toString())),e.emissiveColor&&!jt._FuzzyEquals(e.emissiveColor,Pe.Black(),jt._Epsilon)&&(o.emissiveFactor=e.emissiveColor.asArray()),o.pbrMetallicRoughness=l,jt._SetAlphaMode(o,e),s.push(o),r[e.uniqueId]=s.length-1,this._finishMaterial(a,o,e,t)}_finishMaterial(e,t,i,r){return Promise.all(e).then(()=>{const s=this._exporter._extensionsPostExportMaterialAdditionalTextures("exportMaterial",t,i);let a=null;for(const l of s)a||(a=[]),a.push(this._exportTextureAsync(l,r));return a||(a=[Promise.resolve(null)]),Promise.all(a).then(()=>{const l=this._exporter._extensionsPostExportMaterialAsync("exportMaterial",t,i);return l?l.then(()=>t):t})})}async _getImageDataAsync(e,t,i,r){const s=B.TEXTURETYPE_UNSIGNED_INT,a=this._exporter._babylonScene,l=a.getEngine(),o=l.createRawTexture(e,t,i,B.TEXTUREFORMAT_RGBA,!1,!0,re.NEAREST_SAMPLINGMODE,null,s);await bp.ApplyPostProcess("pass",o,a,s,B.TEXTURE_NEAREST_SAMPLINGMODE,B.TEXTUREFORMAT_RGBA);const c=await l._readTexturePixels(o,t,i);return await fr.DumpDataAsync(t,i,c,r,void 0,!0,!0)}_createWhiteTexture(e,t,i){const r=new Uint8Array(e*t*4);for(let a=0;a<r.length;a=a+4)r[a]=r[a+1]=r[a+2]=r[a+3]=255;return xn.CreateRGBATexture(r,e,t,i)}_resizeTexturesToSameDimensions(e,t,i){const r=e?e.getSize():{width:0,height:0},s=t?t.getSize():{width:0,height:0};let a,l;return r.width<s.width?(e&&e instanceof re?a=bp.CreateResizedCopy(e,s.width,s.height,!0):a=this._createWhiteTexture(s.width,s.height,i),l=t):r.width>s.width?(t&&t instanceof re?l=bp.CreateResizedCopy(t,r.width,r.height,!0):l=this._createWhiteTexture(r.width,r.height,i),a=e):(a=e,l=t),{texture1:a,texture2:l}}_convertPixelArrayToFloat32(e){if(e instanceof Uint8Array){const t=e.length,i=new Float32Array(e.length);for(let r=0;r<t;++r)i[r]=e[r]/255;return i}else{if(e instanceof Float32Array)return e;throw new Error("Unsupported pixel format!")}}async _convertSpecularGlossinessTexturesToMetallicRoughnessAsync(e,t,i,r){var l;const s=new Array;if(!(e||t))return Promise.reject("_ConvertSpecularGlosinessTexturesToMetallicRoughness: diffuse and specular glossiness textures are not defined!");const a=e?e.getScene():t?t.getScene():null;if(a){const o=this._resizeTexturesToSameDimensions(e,t,a),c=(l=o.texture1)==null?void 0:l.getSize();let u,h;const d=c.width,f=c.height,_=await o.texture1.readPixels(),p=await o.texture2.readPixels();if(_)u=this._convertPixelArrayToFloat32(_);else return Promise.reject("Failed to retrieve pixels from diffuse texture!");if(p)h=this._convertPixelArrayToFloat32(p);else return Promise.reject("Failed to retrieve pixels from specular glossiness texture!");const v=h.byteLength,E=new Uint8Array(v),g=new Uint8Array(v),m=4,y=Pe.Black();let T=0,b=0;for(let P=0;P<f;++P)for(let U=0;U<d;++U){const G=(d*P+U)*m,K=new Pe(u[G],u[G+1],u[G+2]).toLinearSpace(a.getEngine().useExactSrgbConversions).multiply(i.diffuseColor),q=new Pe(h[G],h[G+1],h[G+2]).toLinearSpace(a.getEngine().useExactSrgbConversions).multiply(i.specularColor),se=h[G+3]*i.glossiness,Ee={diffuseColor:K,specularColor:q,glossiness:se},Se=this._convertSpecularGlossinessToMetallicRoughness(Ee);y.r=Math.max(y.r,Se.baseColor.r),y.g=Math.max(y.g,Se.baseColor.g),y.b=Math.max(y.b,Se.baseColor.b),T=Math.max(T,Se.metallic),b=Math.max(b,Se.roughness),g[G]=Se.baseColor.r*255,g[G+1]=Se.baseColor.g*255,g[G+2]=Se.baseColor.b*255,g[G+3]=o.texture1.hasAlpha?u[G+3]*255:255,E[G]=0,E[G+1]=Se.roughness*255,E[G+2]=Se.metallic*255,E[G+3]=255}const C={baseColor:y,metallic:T,roughness:b};let M=!1,F=!1;for(let P=0;P<f;++P)for(let U=0;U<d;++U){const G=(d*P+U)*m;g[G]/=C.baseColor.r>jt._Epsilon?C.baseColor.r:1,g[G+1]/=C.baseColor.g>jt._Epsilon?C.baseColor.g:1,g[G+2]/=C.baseColor.b>jt._Epsilon?C.baseColor.b:1;const q=Pe.FromInts(g[G],g[G+1],g[G+2]).toGammaSpace(a.getEngine().useExactSrgbConversions);g[G]=q.r*255,g[G+1]=q.g*255,g[G+2]=q.b*255,jt._FuzzyEquals(q,Pe.White(),jt._Epsilon)||(F=!0),E[G+1]/=C.roughness>jt._Epsilon?C.roughness:1,E[G+2]/=C.metallic>jt._Epsilon?C.metallic:1;const se=Pe.FromInts(255,E[G+1],E[G+2]);jt._FuzzyEquals(se,Pe.White(),jt._Epsilon)||(M=!0)}return M&&s.push(this._getImageDataAsync(E,d,f,r).then(P=>{C.metallicRoughnessTextureData=P})),F&&s.push(this._getImageDataAsync(g,d,f,r).then(P=>{C.baseColorTextureData=P})),Promise.all(s).then(()=>C)}else return Promise.reject("_ConvertSpecularGlossinessTexturesToMetallicRoughness: Scene from textures is missing!")}_convertSpecularGlossinessToMetallicRoughness(e){const t=this._getPerceivedBrightness(e.diffuseColor),i=this._getPerceivedBrightness(e.specularColor),r=1-this._getMaxComponent(e.specularColor),s=jt._SolveMetallic(t,i,r),a=e.diffuseColor.scale(r/(1-jt._DielectricSpecular.r)/Math.max(1-s,jt._Epsilon)),l=e.specularColor.subtract(jt._DielectricSpecular.scale(1-s)).scale(1/Math.max(s,jt._Epsilon));let o=Pe.Lerp(a,l,s*s);return o=o.clampToRef(0,1,o),{baseColor:o,metallic:s,roughness:1-e.glossiness}}_getPerceivedBrightness(e){return e?Math.sqrt(.299*e.r*e.r+.587*e.g*e.g+.114*e.b*e.b):0}_getMaxComponent(e){return e?Math.max(e.r,Math.max(e.g,e.b)):0}_convertMetalRoughFactorsToMetallicRoughnessAsync(e,t,i,r){const s=[],a=e._albedoColor,l=e._metallic,o=e._roughness,c={baseColor:a,metallic:l,roughness:o};if(r){e._albedoTexture&&s.push(this._exportTextureAsync(e._albedoTexture,t).then(d=>{d&&(i.baseColorTexture=d)}));const h=e._metallicTexture;h&&s.push(this._exportTextureAsync(h,t).then(d=>{d&&(i.metallicRoughnessTexture=d)}))}return Promise.all(s).then(()=>c)}_getTextureSampler(e){const t={};if(!e||!(e instanceof re))return t;const i=this._getGLTFTextureWrapMode(e.wrapU);i!==10497&&(t.wrapS=i);const r=this._getGLTFTextureWrapMode(e.wrapV);switch(r!==10497&&(t.wrapT=r),e.samplingMode){case re.LINEAR_LINEAR:{t.magFilter=9729,t.minFilter=9729;break}case re.LINEAR_NEAREST:{t.magFilter=9729,t.minFilter=9728;break}case re.NEAREST_LINEAR:{t.magFilter=9728,t.minFilter=9729;break}case re.NEAREST_LINEAR_MIPLINEAR:{t.magFilter=9728,t.minFilter=9987;break}case re.NEAREST_NEAREST:{t.magFilter=9728,t.minFilter=9728;break}case re.NEAREST_LINEAR_MIPNEAREST:{t.magFilter=9728,t.minFilter=9985;break}case re.LINEAR_NEAREST_MIPNEAREST:{t.magFilter=9729,t.minFilter=9984;break}case re.LINEAR_NEAREST_MIPLINEAR:{t.magFilter=9729,t.minFilter=9986;break}case re.NEAREST_NEAREST_MIPLINEAR:{t.magFilter=9728,t.minFilter=9986;break}case re.LINEAR_LINEAR_MIPLINEAR:{t.magFilter=9729,t.minFilter=9987;break}case re.LINEAR_LINEAR_MIPNEAREST:{t.magFilter=9729,t.minFilter=9985;break}case re.NEAREST_NEAREST_MIPNEAREST:{t.magFilter=9728,t.minFilter=9984;break}}return t}_getGLTFTextureWrapMode(e){switch(e){case re.WRAP_ADDRESSMODE:return 10497;case re.CLAMP_ADDRESSMODE:return 33071;case re.MIRROR_ADDRESSMODE:return 33648;default:return X.Error(`Unsupported Texture Wrap Mode ${e}!`),10497}}_convertSpecGlossFactorsToMetallicRoughnessAsync(e,t,i,r){return Promise.resolve().then(()=>{const s={diffuseColor:e._albedoColor,specularColor:e._reflectivityColor,glossiness:e._microSurface},a=e._albedoTexture,l=e._reflectivityTexture,o=e._useMicroSurfaceFromReflectivityMapAlpha;if(l&&!o)return Promise.reject("_ConvertPBRMaterial: Glossiness values not included in the reflectivity texture are currently not supported");if((a||l)&&r){const c=this._exportTextureSampler(a||l);return this._convertSpecularGlossinessTexturesToMetallicRoughnessAsync(a,l,s,t).then(u=>{const h=this._exporter._textures;if(u.baseColorTextureData){const d=this._exportImage(`baseColor${h.length}`,t,u.baseColorTextureData);i.baseColorTexture=this._exportTextureInfo(d,c,a==null?void 0:a.coordinatesIndex)}if(u.metallicRoughnessTextureData){const d=this._exportImage(`metallicRoughness${h.length}`,t,u.metallicRoughnessTextureData);i.metallicRoughnessTexture=this._exportTextureInfo(d,c,l==null?void 0:l.coordinatesIndex)}return u})}else return this._convertSpecularGlossinessToMetallicRoughness(s)})}_convertPBRMaterialAsync(e,t,i){const r={},s={name:e.name};if(e.isMetallicWorkflow()){const l=e._albedoColor,o=e.alpha;return l&&(r.baseColorFactor=[l.r,l.g,l.b,o]),this._convertMetalRoughFactorsToMetallicRoughnessAsync(e,t,r,i).then(c=>this._setMetallicRoughnessPbrMaterial(c,e,s,r,t,i))}else return this._convertSpecGlossFactorsToMetallicRoughnessAsync(e,t,r,i).then(l=>this._setMetallicRoughnessPbrMaterial(l,e,s,r,t,i))}_setMetallicRoughnessPbrMaterial(e,t,i,r,s,a){const l=this._exporter._materialMap,o=this._exporter._materials,c=[];if(e){if(jt._SetAlphaMode(i,t),jt._FuzzyEquals(e.baseColor,Pe.White(),jt._Epsilon)&&t.alpha>=jt._Epsilon||(r.baseColorFactor=[e.baseColor.r,e.baseColor.g,e.baseColor.b,t.alpha]),e.metallic!=null&&e.metallic!==1&&(r.metallicFactor=e.metallic),e.roughness!=null&&e.roughness!==1&&(r.roughnessFactor=e.roughness),t.backFaceCulling!=null&&!t.backFaceCulling&&(t._twoSidedLighting||X.Warn(t.name+": Back-face culling disabled and two-sided lighting disabled is not supported in glTF."),i.doubleSided=!0),a){const h=t._bumpTexture;if(h){const _=this._exportTextureAsync(h,s).then(p=>{p&&(i.normalTexture=p,h.level!==1&&(i.normalTexture.scale=h.level))});c.push(_)}const d=t._ambientTexture;if(d){const _=this._exportTextureAsync(d,s).then(p=>{if(p){const v={index:p.index,texCoord:p.texCoord,extensions:p.extensions};i.occlusionTexture=v;const E=t._ambientTextureStrength;E&&(v.strength=E)}});c.push(_)}const f=t._emissiveTexture;if(f){const _=this._exportTextureAsync(f,s).then(p=>{p&&(i.emissiveTexture=p)});c.push(_)}}const u=t._emissiveColor;jt._FuzzyEquals(u,Pe.Black(),jt._Epsilon)||(i.emissiveFactor=u.asArray()),i.pbrMetallicRoughness=r,o.push(i),l[t.uniqueId]=o.length-1}return this._finishMaterial(c,i,t,s)}_getPixelsFromTexture(e){return e.textureType===B.TEXTURETYPE_UNSIGNED_INT,e.readPixels()}_exportTextureAsync(e,t){const i=this._exporter._extensionsPreExportTextureAsync("exporter",e,t);return i?i.then(r=>r?this._exportTextureInfoAsync(r,t):this._exportTextureInfoAsync(e,t)):this._exportTextureInfoAsync(e,t)}async _exportTextureInfoAsync(e,t){const i=e.uid;if(!(i in this._textureMap)){const r=await this._getPixelsFromTexture(e);if(!r)return null;const s=this._exportTextureSampler(e),a=e.mimeType;if(a)switch(a){case"image/jpeg":case"image/png":case"image/webp":t=a;break;default:X.Warn(`Unsupported media type: ${a}`);break}const l=this._internalTextureToImage,o=e.getInternalTexture().uniqueId;l[o]||(l[o]={});let c=l[o][t];if(c===void 0){const h=e.getSize();c=(async()=>{const d=await this._getImageDataAsync(r,h.width,h.height,t);return this._exportImage(e.name,t,d)})(),l[o][t]=c}const u=this._exportTextureInfo(await c,s,e.coordinatesIndex);this._textureMap[i]=u,this._exporter._extensionsPostExportTextures("exporter",this._textureMap[i],e)}return this._textureMap[i]}_exportImage(e,t,i){const r=this._exporter._imageData,s=e.replace(/\.\/|\/|\.\\|\\/g,"_"),a=wH(t);let l=s+a;l in r&&(l=`${s}_${X.RandomId()}${a}`),r[l]={data:i,mimeType:t};const o=this._exporter._images;return o.push({name:e,uri:l}),o.length-1}_exportTextureInfo(e,t,i){const r=this._exporter._textures;let s=r.findIndex(l=>l.sampler==t&&l.source===e);s===-1&&(s=r.length,r.push({source:e,sampler:t}));const a={index:s};return i&&(a.texCoord=i),a}_exportTextureSampler(e){const t=this._getTextureSampler(e),i=this._exporter._samplers,r=i.findIndex(s=>s.minFilter===t.minFilter&&s.magFilter===t.magFilter&&s.wrapS===t.wrapS&&s.wrapT===t.wrapT);return r!==-1?r:(i.push(t),i.length-1)}}jt._DielectricSpecular=new Pe(.04,.04,.04);jt._MaxSpecularPower=1024;jt._Epsilon=1e-6;const FS=z.Compose(new A(-1,1,1),ue.Identity(),A.Zero()),OH=new ue(0,1,0,0);function DH(n,e){if(!(n instanceof Ne))return!1;if(e){if(!n.getWorldMatrix().isIdentity())return!1}else if(!n.getWorldMatrix().multiplyToRef(FS,V.Matrix[0]).isIdentity())return!1;return!(n instanceof Ae&&n.geometry||n instanceof yo&&n.sourceMesh.geometry)}function LH(n){const e=A.FromArrayToRef(n.translation||[0,0,0],0,V.Vector3[0]),t=ue.FromArrayToRef(n.rotation||[0,0,0,1],0,V.Quaternion[0]),i=A.FromArrayToRef(n.scale||[1,1,1],0,V.Vector3[1]);z.ComposeToRef(i,t,e,V.Matrix[0]).multiplyToRef(FS,V.Matrix[0]).decompose(i,t,e),e.equalsToFloats(0,0,0)?delete n.translation:n.translation=e.asArray(),ue.IsIdentity(t)?delete n.rotation:n.rotation=t.asArray(),i.equalsToFloats(1,1,1)?delete n.scale:n.scale=i.asArray()}class Ft{_applyExtension(e,t,i,r){if(i>=t.length)return Promise.resolve(e);const s=r(t[i],e);return s?s.then(a=>this._applyExtension(a,t,i+1,r)):this._applyExtension(e,t,i+1,r)}_applyExtensions(e,t){const i=[];for(const r of Ft._ExtensionNames)i.push(this._extensions[r]);return this._applyExtension(e,i,0,t)}_extensionsPreExportTextureAsync(e,t,i){return this._applyExtensions(t,(r,s)=>r.preExportTextureAsync&&r.preExportTextureAsync(e,s,i))}_extensionsPostExportMeshPrimitiveAsync(e,t,i,r){return this._applyExtensions(t,(s,a)=>s.postExportMeshPrimitiveAsync&&s.postExportMeshPrimitiveAsync(e,a,i,r))}_extensionsPostExportNodeAsync(e,t,i,r,s){return this._applyExtensions(t,(a,l)=>a.postExportNodeAsync&&a.postExportNodeAsync(e,l,i,r,s))}_extensionsPostExportMaterialAsync(e,t,i){return this._applyExtensions(t,(r,s)=>r.postExportMaterialAsync&&r.postExportMaterialAsync(e,s,i))}_extensionsPostExportMaterialAdditionalTextures(e,t,i){const r=[];for(const s of Ft._ExtensionNames){const a=this._extensions[s];a.postExportMaterialAdditionalTextures&&r.push(...a.postExportMaterialAdditionalTextures(e,t,i))}return r}_extensionsPostExportTextures(e,t,i){for(const r of Ft._ExtensionNames){const s=this._extensions[r];s.postExportTexture&&s.postExportTexture(e,t,i)}}_forEachExtensions(e){for(const t of Ft._ExtensionNames){const i=this._extensions[t];i.enabled&&e(i)}}_extensionsOnExporting(){this._forEachExtensions(e=>{e.wasUsed&&(this._glTF.extensionsUsed==null&&(this._glTF.extensionsUsed=[]),this._glTF.extensionsUsed.indexOf(e.name)===-1&&this._glTF.extensionsUsed.push(e.name),e.required&&(this._glTF.extensionsRequired==null&&(this._glTF.extensionsRequired=[]),this._glTF.extensionsRequired.indexOf(e.name)===-1&&this._glTF.extensionsRequired.push(e.name)),this._glTF.extensions==null&&(this._glTF.extensions={}),e.onExporting&&e.onExporting())})}_loadExtensions(){for(const e of Ft._ExtensionNames){const t=Ft._ExtensionFactories[e](this);this._extensions[e]=t}}constructor(e,t){this._extensions={},this._glTF={asset:{generator:`Babylon.js v${Z.Version}`,version:"2.0"}},e=e||He.LastCreatedScene,e&&(this._babylonScene=e,this._bufferViews=[],this._accessors=[],this._meshes=[],this._scenes=[],this._cameras=[],this._nodes=[],this._images=[],this._materials=[],this._materialMap=[],this._textures=[],this._samplers=[],this._skins=[],this._animations=[],this._imageData={},this._orderedImageData=[],this._options=t||{},this._animationSampleRate=this._options.animationSampleRate||1/60,this._glTFMaterialExporter=new jt(this),this._loadExtensions())}dispose(){for(const e in this._extensions)this._extensions[e].dispose()}get options(){return this._options}static RegisterExtension(e,t){Ft.UnregisterExtension(e)&&X.Warn(`Extension with the name ${e} already exists`),Ft._ExtensionFactories[e]=t,Ft._ExtensionNames.push(e)}static UnregisterExtension(e){if(!Ft._ExtensionFactories[e])return!1;delete Ft._ExtensionFactories[e];const t=Ft._ExtensionNames.indexOf(e);return t!==-1&&Ft._ExtensionNames.splice(t,1),!0}_reorderIndicesBasedOnPrimitiveMode(e,t,i,r,s){switch(t){case j.TriangleFillMode:{r||(r=0);for(let a=e.indexStart,l=e.indexStart+e.indexCount;a<l;a=a+3){const o=r+a*4,c=s.getUInt32(o+4),u=s.getUInt32(o+8);s.setUInt32(u,o+4),s.setUInt32(c,o+8)}break}case j.TriangleFanDrawMode:{for(let a=e.indexStart+e.indexCount-1,l=e.indexStart;a>=l;--a)s.setUInt32(i[a],r),r+=4;break}case j.TriangleStripDrawMode:{e.indexCount>=3&&(s.setUInt32(i[e.indexStart+2],r+4),s.setUInt32(i[e.indexStart+1],r+8));break}}}_reorderVertexAttributeDataBasedOnPrimitiveMode(e,t,i,r,s,a){switch(t){case j.TriangleFillMode:{this._reorderTriangleFillMode(e,i,r,s,a);break}case j.TriangleStripDrawMode:{this._reorderTriangleStripDrawMode(e,i,r,s,a);break}case j.TriangleFanDrawMode:{this._reorderTriangleFanMode(e,i,r,s,a);break}}}_reorderTriangleFillMode(e,t,i,r,s){const a=this._getVertexBufferFromMesh(t,e.getMesh());if(a){const l=a.byteStride/x.GetTypeByteLength(a.type);if(e.verticesCount%3!==0)X.Error("The submesh vertices for the triangle fill mode is not divisible by 3!");else{const o=[];let c=0;switch(t){case x.PositionKind:case x.NormalKind:{for(let u=e.verticesStart;u<e.verticesStart+e.verticesCount;u=u+3)c=u*l,o.push(A.FromArray(i,c)),o.push(A.FromArray(i,c+2*l)),o.push(A.FromArray(i,c+l));break}case x.TangentKind:{for(let u=e.verticesStart;u<e.verticesStart+e.verticesCount;u=u+3)c=u*l,o.push(qe.FromArray(i,c)),o.push(qe.FromArray(i,c+2*l)),o.push(qe.FromArray(i,c+l));break}case x.ColorKind:{const u=a.getSize();for(let h=e.verticesStart;h<e.verticesStart+e.verticesCount;h=h+u)c=h*l,u===4?(o.push(qe.FromArray(i,c)),o.push(qe.FromArray(i,c+2*l)),o.push(qe.FromArray(i,c+l))):(o.push(A.FromArray(i,c)),o.push(A.FromArray(i,c+2*l)),o.push(A.FromArray(i,c+l)));break}case x.UVKind:case x.UV2Kind:{for(let u=e.verticesStart;u<e.verticesStart+e.verticesCount;u=u+3)c=u*l,o.push(xe.FromArray(i,c)),o.push(xe.FromArray(i,c+2*l)),o.push(xe.FromArray(i,c+l));break}default:X.Error(`Unsupported Vertex Buffer type: ${t}`)}this._writeVertexAttributeData(o,r,t,s)}}else X.Warn(`reorderTriangleFillMode: Vertex Buffer Kind ${t} not present!`)}_reorderTriangleStripDrawMode(e,t,i,r,s){const a=this._getVertexBufferFromMesh(t,e.getMesh());if(a){const l=a.byteStride/x.GetTypeByteLength(a.type),o=[];let c=0;switch(t){case x.PositionKind:case x.NormalKind:{c=e.verticesStart,o.push(A.FromArray(i,c+2*l)),o.push(A.FromArray(i,c+l));break}case x.TangentKind:{for(let u=e.verticesStart+e.verticesCount-1;u>=e.verticesStart;--u)c=u*l,o.push(qe.FromArray(i,c));break}case x.ColorKind:{for(let u=e.verticesStart+e.verticesCount-1;u>=e.verticesStart;--u)c=u*l,a.getSize()===4?o.push(qe.FromArray(i,c)):o.push(A.FromArray(i,c));break}case x.UVKind:case x.UV2Kind:{for(let u=e.verticesStart+e.verticesCount-1;u>=e.verticesStart;--u)c=u*l,o.push(xe.FromArray(i,c));break}default:X.Error(`Unsupported Vertex Buffer type: ${t}`)}this._writeVertexAttributeData(o,r+12,t,s)}else X.Warn(`reorderTriangleStripDrawMode: Vertex buffer kind ${t} not present!`)}_reorderTriangleFanMode(e,t,i,r,s){const a=this._getVertexBufferFromMesh(t,e.getMesh());if(a){const l=a.byteStride/x.GetTypeByteLength(a.type),o=[];let c=0;switch(t){case x.PositionKind:case x.NormalKind:{for(let u=e.verticesStart+e.verticesCount-1;u>=e.verticesStart;--u)c=u*l,o.push(A.FromArray(i,c));break}case x.TangentKind:{for(let u=e.verticesStart+e.verticesCount-1;u>=e.verticesStart;--u)c=u*l,o.push(qe.FromArray(i,c));break}case x.ColorKind:{for(let u=e.verticesStart+e.verticesCount-1;u>=e.verticesStart;--u)c=u*l,o.push(qe.FromArray(i,c)),a.getSize()===4?o.push(qe.FromArray(i,c)):o.push(A.FromArray(i,c));break}case x.UVKind:case x.UV2Kind:{for(let u=e.verticesStart+e.verticesCount-1;u>=e.verticesStart;--u)c=u*l,o.push(xe.FromArray(i,c));break}default:X.Error(`Unsupported Vertex Buffer type: ${t}`)}this._writeVertexAttributeData(o,r,t,s)}else X.Warn(`reorderTriangleFanMode: Vertex buffer kind ${t} not present!`)}_writeVertexAttributeData(e,t,i,r){for(const s of e){i===x.NormalKind?s.normalize():i===x.TangentKind&&s instanceof qe&&mi._NormalizeTangentFromRef(s);for(const a of s.asArray())r.setFloat32(a,t),t+=4}}_writeAttributeData(e,t,i,r,s,a){let l=[],o;switch(e){case x.PositionKind:{for(let u=0,h=i.length/r;u<h;++u){o=u*r;const d=A.FromArray(i,o);l.push(d.asArray())}break}case x.NormalKind:{for(let u=0,h=i.length/r;u<h;++u){o=u*r;const d=A.FromArray(i,o);l.push(d.normalize().asArray())}break}case x.TangentKind:{for(let u=0,h=i.length/r;u<h;++u){o=u*r;const d=qe.FromArray(i,o);mi._NormalizeTangentFromRef(d),l.push(d.asArray())}break}case x.ColorKind:{const u=a.material,h=u?u.getClassName()==="StandardMaterial":!0,d=r===3?new Pe:new et,f=this._babylonScene.getEngine().useExactSrgbConversions;for(let _=0,p=i.length/r;_<p;++_)o=_*r,r===3?(Pe.FromArrayToRef(i,o,d),h&&d.toLinearSpaceToRef(d,f)):(et.FromArrayToRef(i,o,d),h&&d.toLinearSpaceToRef(d,f)),l.push(d.asArray());break}case x.UVKind:case x.UV2Kind:{for(let u=0,h=i.length/r;u<h;++u){o=u*r;const d=xe.FromArray(i,o);l.push(d.asArray())}break}case x.MatricesIndicesKind:case x.MatricesIndicesExtraKind:{for(let u=0,h=i.length/r;u<h;++u){o=u*r;const d=qe.FromArray(i,o);l.push(d.asArray())}break}case x.MatricesWeightsKind:case x.MatricesWeightsExtraKind:{for(let u=0,h=i.length/r;u<h;++u){o=u*r;const d=qe.FromArray(i,o);l.push(d.asArray())}break}default:X.Warn("Unsupported Vertex Buffer Type: "+e),l=[]}let c;switch(t){case 5121:{c=s.setUInt8.bind(s);break}case 5123:{c=s.setUInt16.bind(s);break}case 5125:{c=s.setUInt32.bind(s);break}case 5126:{c=s.setFloat32.bind(s);break}default:{X.Warn("Unsupported Attribute Component kind: "+t);return}}for(const u of l)for(const h of u)c(h)}writeMorphTargetAttributeData(e,t,i,r,s,a,l,o){let c=[],u,h=new A,d=new qe(0,0,0,0);switch(e){case x.PositionKind:{for(let _=i.verticesStart;_<i.verticesCount;++_){u=i.indexStart+_*a;const p=A.FromArray(r,u);h=A.FromArray(s,u).subtractToRef(p,h),o&&(o.min.copyFromFloats(Math.min(h.x,o.min.x),Math.min(h.y,o.min.y),Math.min(h.z,o.min.z)),o.max.copyFromFloats(Math.max(h.x,o.max.x),Math.max(h.y,o.max.y),Math.max(h.z,o.max.z))),c.push(h.asArray())}break}case x.NormalKind:{for(let _=i.verticesStart;_<i.verticesCount;++_){u=i.indexStart+_*a;const p=A.FromArray(r,u).normalize();h=A.FromArray(s,u).normalize().subtractToRef(p,h),c.push(h.asArray())}break}case x.TangentKind:{for(let _=i.verticesStart;_<i.verticesCount;++_){u=i.indexStart+_*(a+1);const p=qe.FromArray(r,u);mi._NormalizeTangentFromRef(p);const v=qe.FromArray(s,u);mi._NormalizeTangentFromRef(v),d=v.subtractToRef(p,d),c.push([d.x,d.y,d.z])}break}default:X.Warn("Unsupported Vertex Buffer Type: "+e),c=[]}let f;switch(t){case 5121:{f=l.setUInt8.bind(l);break}case 5123:{f=l.setUInt16.bind(l);break}case 5125:{f=l.setUInt32.bind(l);break}case 5126:{f=l.setFloat32.bind(l);break}default:{X.Warn("Unsupported Attribute Component kind: "+t);return}}for(const _ of c)for(const p of _)f(p)}_generateJSON(e,t,i){const r={byteLength:this._totalByteLength};let s,a,l,o=this._totalByteLength;return r.byteLength&&(this._glTF.buffers=[r]),this._nodes&&this._nodes.length&&(this._glTF.nodes=this._nodes),this._meshes&&this._meshes.length&&(this._glTF.meshes=this._meshes),this._scenes&&this._scenes.length&&(this._glTF.scenes=this._scenes,this._glTF.scene=0),this._cameras&&this._cameras.length&&(this._glTF.cameras=this._cameras),this._bufferViews&&this._bufferViews.length&&(this._glTF.bufferViews=this._bufferViews),this._accessors&&this._accessors.length&&(this._glTF.accessors=this._accessors),this._animations&&this._animations.length&&(this._glTF.animations=this._animations),this._materials&&this._materials.length&&(this._glTF.materials=this._materials),this._textures&&this._textures.length&&(this._glTF.textures=this._textures),this._samplers&&this._samplers.length&&(this._glTF.samplers=this._samplers),this._skins&&this._skins.length&&(this._glTF.skins=this._skins),this._images&&this._images.length&&(e?(this._glTF.images=[],this._images.forEach(u=>{u.uri&&(a=this._imageData[u.uri],this._orderedImageData.push(a),s=u.uri.split(".")[0]+" image",l=mi._CreateBufferView(0,o,a.data.byteLength,void 0,s),o+=a.data.byteLength,this._bufferViews.push(l),u.bufferView=this._bufferViews.length-1,u.name=s,u.mimeType=a.mimeType,u.uri=void 0,this._glTF.images||(this._glTF.images=[]),this._glTF.images.push(u))}),r.byteLength=o):this._glTF.images=this._images),e||(r.uri=t+".bin"),i?JSON.stringify(this._glTF,null,2):JSON.stringify(this._glTF)}_generateGLTFAsync(e,t=!0){return this._generateBinaryAsync().then(i=>{this._extensionsOnExporting();const r=this._generateJSON(!1,e,!0),s=new Blob([i],{type:"application/octet-stream"}),a=e+".gltf",l=e+".bin",o=new IT;if(o.glTFFiles[a]=r,o.glTFFiles[l]=s,this._imageData)for(const c in this._imageData)o.glTFFiles[c]=new Blob([this._imageData[c].data],{type:this._imageData[c].mimeType});return t&&this.dispose(),o})}_generateBinaryAsync(){const e=new NH(4);return this._createSceneAsync(e).then(()=>(this._localEngine&&this._localEngine.dispose(),e.getArrayBuffer()))}_getPadding(e){const t=e%4;return t===0?t:4-t}_generateGLBAsync(e,t=!0){return this._generateBinaryAsync().then(i=>{this._extensionsOnExporting();const r=this._generateJSON(!0),s=e+".glb",a=12,l=8;let o=r.length,c,u=0;typeof TextEncoder<"u"&&(c=new TextEncoder().encode(r),o=c.length);for(let q=0;q<this._orderedImageData.length;++q)u+=this._orderedImageData[q].data.byteLength;const h=this._getPadding(o),d=this._getPadding(i.byteLength),f=this._getPadding(u),_=a+2*l+o+h+i.byteLength+d+u+f,p=new ArrayBuffer(a),v=new DataView(p);v.setUint32(0,1179937895,!0),v.setUint32(4,2,!0),v.setUint32(8,_,!0);const E=new ArrayBuffer(l+o+h),g=new DataView(E);g.setUint32(0,o+h,!0),g.setUint32(4,1313821514,!0);const m=new Uint8Array(E,l);if(c)m.set(c);else for(let se=0;se<o;++se){const Ee=r.charCodeAt(se);Ee!=r.codePointAt(se)?m[se]=95:m[se]=Ee}const y=new Uint8Array(E,l+o);for(let q=0;q<h;++q)y[q]=32;const T=new ArrayBuffer(l),b=new DataView(T);b.setUint32(0,i.byteLength+u+f,!0),b.setUint32(4,5130562,!0);const C=new ArrayBuffer(d),M=new Uint8Array(C);for(let q=0;q<d;++q)M[q]=0;const F=new ArrayBuffer(f),P=new Uint8Array(F);for(let q=0;q<f;++q)P[q]=0;const U=[p,E,T,i];for(let q=0;q<this._orderedImageData.length;++q)U.push(this._orderedImageData[q].data);U.push(C),U.push(F);const G=new Blob(U,{type:"application/octet-stream"}),K=new IT;return K.glTFFiles[s]=G,this._localEngine!=null&&this._localEngine.dispose(),t&&this.dispose(),K})}_setNodeTransformation(e,t){t.getPivotPoint().equalsToFloats(0,0,0)||X.Warn("Pivot points are not supported in the glTF serializer"),t.position.equalsToFloats(0,0,0)||(e.translation=t.position.asArray()),t.scaling.equalsToFloats(1,1,1)||(e.scale=t.scaling.asArray());const i=ue.FromEulerAngles(t.rotation.x,t.rotation.y,t.rotation.z);t.rotationQuaternion&&i.multiplyInPlace(t.rotationQuaternion),ue.IsIdentity(i)||(e.rotation=i.normalize().asArray())}_setCameraTransformation(e,t){const i=V.Vector3[0],r=V.Quaternion[0];t.getWorldMatrix().decompose(void 0,r,i),i.equalsToFloats(0,0,0)||(e.translation=i.asArray()),r.multiplyInPlace(OH),ue.IsIdentity(r)||(e.rotation=r.asArray())}_getVertexBufferFromMesh(e,t){if(t.isVerticesDataPresent(e,!0)){const i=t.getVertexBuffer(e,!0);if(i)return i}return null}_createBufferViewKind(e,t,i,r,s){const a=i instanceof Ae?i:i instanceof yo?i.sourceMesh:null;if(a){const l=a.getVertexBuffer(e,!0),o=a.getVerticesData(e,void 0,void 0,!0);if(l&&o){const c=x.GetTypeByteLength(t),u=o.length*c,h=mi._CreateBufferView(0,r.getByteOffset(),u,s,e+" - "+a.name);this._bufferViews.push(h),this._writeAttributeData(e,t,o,s/c,r,i)}}}_setMorphTargetAttributes(e,t,i,r){if(i){t.targets||(t.targets=[]);const s={},a=e.getMesh();if(i.hasNormals){const l=a.getVerticesData(x.NormalKind,void 0,void 0,!0),o=i.getNormals(),c=e.verticesCount,u=12,h=c*u,d=mi._CreateBufferView(0,r.getByteOffset(),h,u,i.name+"_NORMAL");this._bufferViews.push(d);const f=this._bufferViews.length-1,_=mi._CreateAccessor(f,i.name+" - NORMAL","VEC3",5126,c,0,null,null);this._accessors.push(_),s.NORMAL=this._accessors.length-1,this.writeMorphTargetAttributeData(x.NormalKind,5126,e,l,o,u/4,r)}if(i.hasPositions){const l=a.getVerticesData(x.PositionKind,void 0,void 0,!0),o=i.getPositions(),c=e.verticesCount,u=12,h=c*u,d=mi._CreateBufferView(0,r.getByteOffset(),h,u,i.name+"_POSITION");this._bufferViews.push(d);const f=this._bufferViews.length-1,_={min:new A(1/0,1/0,1/0),max:new A(-1/0,-1/0,-1/0)},p=mi._CreateAccessor(f,i.name+" - POSITION","VEC3",5126,c,0,null,null);this._accessors.push(p),s.POSITION=this._accessors.length-1,this.writeMorphTargetAttributeData(x.PositionKind,5126,e,l,o,u/4,r,_),p.min=_.min.asArray(),p.max=_.max.asArray()}if(i.hasTangents){const l=a.getVerticesData(x.TangentKind,void 0,void 0,!0),o=i.getTangents(),c=e.verticesCount,u=12,h=c*u,d=mi._CreateBufferView(0,r.getByteOffset(),h,u,i.name+"_NORMAL");this._bufferViews.push(d);const f=this._bufferViews.length-1,_=mi._CreateAccessor(f,i.name+" - TANGENT","VEC3",5126,c,0,null,null);this._accessors.push(_),s.TANGENT=this._accessors.length-1,this.writeMorphTargetAttributeData(x.TangentKind,5126,e,l,o,u/4,r)}t.targets.push(s)}}_getMeshPrimitiveMode(e){if(e instanceof Zl)return j.LineListDrawMode;if(e instanceof yo||e instanceof Ae){const t=e instanceof Ae?e:e.sourceMesh;if(typeof t.overrideRenderingFillMode=="number")return t.overrideRenderingFillMode}return e.material?e.material.fillMode:j.TriangleFillMode}_setPrimitiveMode(e,t){switch(t){case j.TriangleFillMode:break;case j.TriangleStripDrawMode:{e.mode=5;break}case j.TriangleFanDrawMode:{e.mode=6;break}case j.PointListDrawMode:{e.mode=0;break}case j.PointFillMode:{e.mode=0;break}case j.LineLoopDrawMode:{e.mode=2;break}case j.LineListDrawMode:{e.mode=1;break}case j.LineStripDrawMode:{e.mode=3;break}}}_setAttributeKind(e,t){switch(t){case x.PositionKind:{e.attributes.POSITION=this._accessors.length-1;break}case x.NormalKind:{e.attributes.NORMAL=this._accessors.length-1;break}case x.ColorKind:{e.attributes.COLOR_0=this._accessors.length-1;break}case x.TangentKind:{e.attributes.TANGENT=this._accessors.length-1;break}case x.UVKind:{e.attributes.TEXCOORD_0=this._accessors.length-1;break}case x.UV2Kind:{e.attributes.TEXCOORD_1=this._accessors.length-1;break}case x.MatricesIndicesKind:{e.attributes.JOINTS_0=this._accessors.length-1;break}case x.MatricesIndicesExtraKind:{e.attributes.JOINTS_1=this._accessors.length-1;break}case x.MatricesWeightsKind:{e.attributes.WEIGHTS_0=this._accessors.length-1;break}case x.MatricesWeightsExtraKind:{e.attributes.WEIGHTS_1=this._accessors.length-1;break}default:X.Warn("Unsupported Vertex Buffer Type: "+t)}}_setPrimitiveAttributesAsync(e,t,i){const r=[];let s=null,a,l;t instanceof Ae?s=t:t instanceof yo&&(s=t.sourceMesh);const o=[{kind:x.PositionKind,accessorType:"VEC3",accessorComponentType:5126,byteStride:12},{kind:x.NormalKind,accessorType:"VEC3",accessorComponentType:5126,byteStride:12},{kind:x.ColorKind,accessorType:"VEC4",accessorComponentType:5126,byteStride:16},{kind:x.TangentKind,accessorType:"VEC4",accessorComponentType:5126,byteStride:16},{kind:x.UVKind,accessorType:"VEC2",accessorComponentType:5126,byteStride:8},{kind:x.UV2Kind,accessorType:"VEC2",accessorComponentType:5126,byteStride:8},{kind:x.MatricesIndicesKind,accessorType:"VEC4",accessorComponentType:5123,byteStride:8},{kind:x.MatricesIndicesExtraKind,accessorType:"VEC4",accessorComponentType:5123,byteStride:8},{kind:x.MatricesWeightsKind,accessorType:"VEC4",accessorComponentType:5126,byteStride:16},{kind:x.MatricesWeightsExtraKind,accessorType:"VEC4",accessorComponentType:5126,byteStride:16}];if(s){let c=null;const u=this._getMeshPrimitiveMode(s),h={},d=s.morphTargetManager;for(const f of o){const _=f.kind,p=f.accessorComponentType;if(s.isVerticesDataPresent(_,!0)){const v=this._getVertexBufferFromMesh(_,s);f.byteStride=v?v.getSize()*x.GetTypeByteLength(f.accessorComponentType):x.DeduceStride(_)*4,f.byteStride===12&&(f.accessorType="VEC3"),this._createBufferViewKind(_,p,t,i,f.byteStride),f.bufferViewIndex=this._bufferViews.length-1,h[_]=f.bufferViewIndex}}if(s.getTotalIndices()){const f=s.getIndices();if(f){const _=f.length*4;a=mi._CreateBufferView(0,i.getByteOffset(),_,void 0,"Indices - "+s.name),this._bufferViews.push(a),c=this._bufferViews.length-1;for(let p=0,v=f.length;p<v;++p)i.setUInt32(f[p])}}if(s.subMeshes)for(const f of s.subMeshes){let _=f.getMaterial()||s.getScene().defaultMaterial,p=null;if(_)if(s instanceof Zl){const g={name:s.name+" material"};(!s.color.equals(Pe.White())||s.alpha<1)&&(g.pbrMetallicRoughness={baseColorFactor:s.color.asArray().concat([s.alpha])}),this._materials.push(g),p=this._materials.length-1}else if(_ instanceof Na){const g=_.subMaterials[f.materialIndex];g&&(_=g,p=this._materialMap[_.uniqueId])}else p=this._materialMap[_.uniqueId];const v=p!=null?this._materials[p]:null,E={attributes:{}};this._setPrimitiveMode(E,u);for(const g of o){const m=g.kind;if((m===x.UVKind||m===x.UV2Kind)&&!this._options.exportUnusedUVs&&(!v||!this._glTFMaterialExporter._hasTexturesPresent(v)))continue;const y=s.getVerticesData(m,void 0,void 0,!0);if(y){const T=this._getVertexBufferFromMesh(m,s);if(T){const b=T.getSize(),C=g.bufferViewIndex;if(C!=null){l={min:null,max:null},m==x.PositionKind&&(l=mi._CalculateMinMaxPositions(y,0,y.length/b));const M=mi._CreateAccessor(C,m+" - "+t.name,g.accessorType,g.accessorComponentType,y.length/b,0,l.min,l.max);this._accessors.push(M),this._setAttributeKind(E,m)}}}}if(c){const g=mi._CreateAccessor(c,"indices - "+t.name,"SCALAR",5125,f.indexCount,f.indexStart*4,null,null);this._accessors.push(g),E.indices=this._accessors.length-1}if(Object.keys(E.attributes).length>0){if((s.overrideMaterialSideOrientation!==null?s.overrideMaterialSideOrientation:_.sideOrientation)===(this._babylonScene.useRightHandedSystem?j.ClockWiseSideOrientation:j.CounterClockWiseSideOrientation)){let m=c!=null?this._bufferViews[c].byteOffset:null;m==null&&(m=0);let y=null;if(c!=null&&(y=s.getIndices()),y)this._reorderIndicesBasedOnPrimitiveMode(f,u,y,m,i);else for(const T of o){const b=s.getVerticesData(T.kind,void 0,void 0,!0);if(b){const C=this._bufferViews[h[T.kind]].byteOffset||0;this._reorderVertexAttributeDataBasedOnPrimitiveMode(f,u,T.kind,b,C,i)}}}p!=null&&(E.material=p)}if(d){e.extras||(e.extras={}),e.extras.targetNames=[];for(let g=0;g<d.numTargets;++g){const m=d.getTarget(g);this._setMorphTargetAttributes(f,E,m,i),e.extras.targetNames.push(m.name)}}e.primitives.push(E),this._extensionsPostExportMeshPrimitiveAsync("postExport",E,f,i),r.push()}}return Promise.all(r).then(()=>{})}_createSceneAsync(e){const t={nodes:[]};let i,r,s;const a=[...this._babylonScene.transformNodes,...this._babylonScene.meshes,...this._babylonScene.lights,...this._babylonScene.cameras],l=new Set;if(this._babylonScene.metadata&&(this._options.metadataSelector?t.extras=this._options.metadataSelector(this._babylonScene.metadata):this._babylonScene.metadata.gltf&&(t.extras=this._babylonScene.metadata.gltf.extras)),(this._options.removeNoopRootNodes??!0)&&!this._options.includeCoordinateSystemConversionNodes)for(const h of this._babylonScene.rootNodes)DH(h,this._babylonScene.useRightHandedSystem)&&(l.add(h),a.splice(a.indexOf(h),1));const o=new Map;this._babylonScene.cameras.forEach(h=>{if(this._options.shouldExportNode&&!this._options.shouldExportNode(h))return;const d={type:h.mode===Ie.PERSPECTIVE_CAMERA?"perspective":"orthographic"};if(h.name&&(d.name=h.name),d.type==="perspective")d.perspective={aspectRatio:h.getEngine().getAspectRatio(h),yfov:h.fovMode===Ie.FOVMODE_VERTICAL_FIXED?h.fov:h.fov*h.getEngine().getAspectRatio(h),znear:h.minZ,zfar:h.maxZ};else if(d.type==="orthographic"){const f=h.orthoLeft&&h.orthoRight?.5*(h.orthoRight-h.orthoLeft):h.getEngine().getRenderWidth()*.5,_=h.orthoBottom&&h.orthoTop?.5*(h.orthoTop-h.orthoBottom):h.getEngine().getRenderHeight()*.5;d.orthographic={xmag:f,ymag:_,znear:h.minZ,zfar:h.maxZ}}o.set(h,this._cameras.length),this._cameras.push(d)});const[c,u]=this._getExportNodes(a);return this._glTFMaterialExporter._convertMaterialsToGLTFAsync(u,"image/png",!0).then(()=>this._createNodeMapAndAnimationsAsync(c,e).then(h=>this._createSkinsAsync(h,e).then(d=>{if(this._nodeMap=h,this._totalByteLength=e.getByteOffset(),this._totalByteLength==null)throw new Error("undefined byte length!");for(const f of a)if(i=this._nodeMap[f.uniqueId],i!==void 0&&(r=this._nodes[i],f.metadata&&(this._options.metadataSelector?r.extras=this._options.metadataSelector(f.metadata):f.metadata.gltf&&(r.extras=f.metadata.gltf.extras)),f instanceof Ie&&(r.camera=o.get(f)),this._options.shouldExportNode&&!this._options.shouldExportNode(f)?X.Log("Omitting "+f.name+" from scene."):(!f.parent&&!this._babylonScene.useRightHandedSystem&&LH(r),(!f.parent||l.has(f.parent))&&t.nodes.push(i)),f instanceof Ae&&f.skeleton&&(r.skin=d[f.skeleton.uniqueId]),s=f.getDescendants(!0),!r.children&&s&&s.length)){const _=[];for(const p of s)this._nodeMap[p.uniqueId]!=null&&_.push(this._nodeMap[p.uniqueId]);_.length&&(r.children=_)}t.nodes.length&&this._scenes.push(t)})))}_getExportNodes(e){const t=[],i=new Set;for(const r of e)if(!this._options.shouldExportNode||this._options.shouldExportNode(r)){t.push(r);const s=r;if(s.subMeshes&&s.subMeshes.length>0){const a=s.material||s.getScene().defaultMaterial;if(a instanceof Na)for(const l of a.subMaterials)l&&i.add(l);else i.add(a)}}else`${r.name}`;return[t,i]}_createNodeMapAndAnimationsAsync(e,t){let i=Promise.resolve();const r={};let s;const a={name:"runtime animations",channels:[],samplers:[]},l=[];for(const o of e)i=i.then(()=>this._createNodeAsync(o,t).then(c=>{const u=this._extensionsPostExportNodeAsync("createNodeAsync",c,o,r,t);return u==null?(X.Warn(`Not exporting node ${o.name}`),Promise.resolve()):u.then(h=>{h&&(this._nodes.push(h),s=this._nodes.length-1,r[o.uniqueId]=s,this._babylonScene.animationGroups.length||(Zt._CreateMorphTargetAnimationFromMorphTargetAnimations(o,a,l,r,this._nodes,t,this._bufferViews,this._accessors,this._animationSampleRate,this._options.shouldExportAnimation),o.animations.length&&Zt._CreateNodeAnimationFromNodeAnimations(o,a,l,r,this._nodes,t,this._bufferViews,this._accessors,this._animationSampleRate,this._options.shouldExportAnimation)))})}));return i.then(()=>(a.channels.length&&a.samplers.length&&this._animations.push(a),l.forEach(o=>{o.channels.length&&o.samplers.length&&this._animations.push(o)}),this._babylonScene.animationGroups.length&&Zt._CreateNodeAndMorphAnimationFromAnimationGroups(this._babylonScene,this._animations,r,t,this._bufferViews,this._accessors,this._animationSampleRate,this._options.shouldExportAnimation),r))}_createNodeAsync(e,t){return Promise.resolve().then(()=>{const i={},r={primitives:[]};if(e.name&&(i.name=e.name),e instanceof Ne){if(this._setNodeTransformation(i,e),e instanceof Ae){const s=e.morphTargetManager;if(s&&s.numTargets>0){r.weights=[];for(let a=0;a<s.numTargets;++a)r.weights.push(s.getTarget(a).influence)}}return this._setPrimitiveAttributesAsync(r,e,t).then(()=>(r.primitives.length&&(this._meshes.push(r),i.mesh=this._meshes.length-1),i))}else return e instanceof Ie&&this._setCameraTransformation(i,e),i})}_createSkinsAsync(e,t){const i=Promise.resolve(),r={};for(const s of this._babylonScene.skeletons){if(s.bones.length<=0)continue;const a={joints:[]},l=[],o={};let c=-1;for(let u=0;u<s.bones.length;++u){const h=s.bones[u],d=h.getIndex()??u;d!==-1&&(o[d]=h,d>c&&(c=d))}for(let u=0;u<=c;++u){const h=o[u];l.push(h.getInvertedAbsoluteTransform());const d=h.getTransformNode();d&&e[d.uniqueId]!==null&&e[d.uniqueId]!==void 0?a.joints.push(e[d.uniqueId]):X.Warn("Exporting a bone without a linked transform node is currently unsupported")}if(a.joints.length>0){const h=l.length*64,d=t.getByteOffset(),f=mi._CreateBufferView(0,d,h,void 0,"InverseBindMatrices - "+s.name);this._bufferViews.push(f);const _=this._bufferViews.length-1,p=mi._CreateAccessor(_,"InverseBindMatrices - "+s.name,"MAT4",5126,l.length,null,null,null),v=this._accessors.push(p)-1;a.inverseBindMatrices=v,this._skins.push(a),r[s.uniqueId]=this._skins.length-1,l.forEach(E=>{E.m.forEach(g=>{t.setFloat32(g)})})}}return i.then(()=>r)}}Ft._ExtensionNames=new Array;Ft._ExtensionFactories={};class NH{constructor(e){this._arrayBuffer=new ArrayBuffer(e),this._dataView=new DataView(this._arrayBuffer),this._byteOffset=0}_resizeBuffer(e){const t=new ArrayBuffer(e),i=Math.min(this._arrayBuffer.byteLength,e),r=new Uint8Array(this._arrayBuffer,0,i);return new Uint8Array(t).set(r,0),this._arrayBuffer=t,this._dataView=new DataView(this._arrayBuffer),t}getArrayBuffer(){return this._resizeBuffer(this.getByteOffset())}getByteOffset(){if(this._byteOffset==null)throw new Error("Byte offset is undefined!");return this._byteOffset}setUInt8(e,t){t!=null?t<this._byteOffset?this._dataView.setUint8(t,e):X.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(this._byteOffset+1>this._arrayBuffer.byteLength&&this._resizeBuffer(this._arrayBuffer.byteLength*2),this._dataView.setUint8(this._byteOffset,e),this._byteOffset+=1)}setUInt16(e,t){t!=null?t<this._byteOffset?this._dataView.setUint16(t,e,!0):X.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(this._byteOffset+2>this._arrayBuffer.byteLength&&this._resizeBuffer(this._arrayBuffer.byteLength*2),this._dataView.setUint16(this._byteOffset,e,!0),this._byteOffset+=2)}getUInt32(e){if(e<this._byteOffset)return this._dataView.getUint32(e,!0);throw X.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"),new Error("BinaryWriter: byteoffset is greater than the current binary buffer length!")}getVector3Float32FromRef(e,t){t+8>this._byteOffset?X.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(e.x=this._dataView.getFloat32(t,!0),e.y=this._dataView.getFloat32(t+4,!0),e.z=this._dataView.getFloat32(t+8,!0))}setVector3Float32FromRef(e,t){t+8>this._byteOffset?X.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(this._dataView.setFloat32(t,e.x,!0),this._dataView.setFloat32(t+4,e.y,!0),this._dataView.setFloat32(t+8,e.z,!0))}getVector4Float32FromRef(e,t){t+12>this._byteOffset?X.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(e.x=this._dataView.getFloat32(t,!0),e.y=this._dataView.getFloat32(t+4,!0),e.z=this._dataView.getFloat32(t+8,!0),e.w=this._dataView.getFloat32(t+12,!0))}setVector4Float32FromRef(e,t){t+12>this._byteOffset?X.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(this._dataView.setFloat32(t,e.x,!0),this._dataView.setFloat32(t+4,e.y,!0),this._dataView.setFloat32(t+8,e.z,!0),this._dataView.setFloat32(t+12,e.w,!0))}setFloat32(e,t){isNaN(e)&&X.Error("Invalid data being written!"),t!=null&&(t<this._byteOffset?this._dataView.setFloat32(t,e,!0):X.Error("BinaryWriter: byteoffset is greater than the current binary length!")),this._byteOffset+4>this._arrayBuffer.byteLength&&this._resizeBuffer(this._arrayBuffer.byteLength*2),this._dataView.setFloat32(this._byteOffset,e,!0),this._byteOffset+=4}setUInt32(e,t){t!=null?t<this._byteOffset?this._dataView.setUint32(t,e,!0):X.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(this._byteOffset+4>this._arrayBuffer.byteLength&&this._resizeBuffer(this._arrayBuffer.byteLength*2),this._dataView.setUint32(this._byteOffset,e,!0),this._byteOffset+=4)}setInt16(e,t){t!=null?t<this._byteOffset?this._dataView.setInt16(t,e,!0):X.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(this._byteOffset+2>this._arrayBuffer.byteLength&&this._resizeBuffer(this._arrayBuffer.byteLength*2),this._dataView.setInt16(this._byteOffset,e,!0),this._byteOffset+=2)}setByte(e,t){t!=null?t<this._byteOffset?this._dataView.setInt8(t,e):X.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(this._byteOffset+1>this._arrayBuffer.byteLength&&this._resizeBuffer(this._arrayBuffer.byteLength*2),this._dataView.setInt8(this._byteOffset,e),this._byteOffset++)}}class OT{static GLTFAsync(e,t,i){return e.whenReadyAsync().then(()=>{const r=t.replace(/\.[^/.]+$/,"");return new Ft(e,i)._generateGLTFAsync(r)})}static _PreExportAsync(e,t){return Promise.resolve().then(()=>t&&t.exportWithoutWaitingForScene?Promise.resolve():e.whenReadyAsync())}static _PostExportAsync(e,t,i){return Promise.resolve().then(()=>(i&&i.exportWithoutWaitingForScene,t))}static GLBAsync(e,t,i){return this._PreExportAsync(e,i).then(()=>{const r=t.replace(/\.[^/.]+$/,"");return new Ft(e,i)._generateGLBAsync(r).then(a=>this._PostExportAsync(e,a,i))})}}const qh="KHR_texture_transform";class FH{constructor(){this.name=qh,this.enabled=!0,this.required=!1,this._wasUsed=!1}dispose(){}get wasUsed(){return this._wasUsed}postExportTexture(e,t,i){if(i&&(i.uAng===0&&i.wAng===0&&i.vAng===0||i.uRotationCenter===0&&i.vRotationCenter===0)){const s={};let a=!1;if((i.uOffset!==0||i.vOffset!==0)&&(s.offset=[i.uOffset,i.vOffset],a=!0),(i.uScale!==1||i.vScale!==1)&&(s.scale=[i.uScale,i.vScale],a=!0),i.wAng!==0&&(s.rotation=-i.wAng,a=!0),i.coordinatesIndex!==0&&(s.texCoord=i.coordinatesIndex,a=!0),!a)return;this._wasUsed=!0,t.extensions||(t.extensions={}),t.extensions[qh]=s}}preExportTextureAsync(e,t){return new Promise((i,r)=>{if(!t.getScene()){r(`${e}: "scene" is not defined for Babylon texture ${t.name}!`);return}t.uAng!==0||t.vAng!==0?(X.Warn(`${e}: Texture ${t.name} with rotation in the u or v axis is not supported in glTF.`),i(null)):t.wAng!==0&&(t.uRotationCenter!==0||t.vRotationCenter!==0)?(X.Warn(`${e}: Texture ${t.name} with rotation not centered at the origin cannot be exported with ${qh}`),i(null)):i(t)})}}Ft.RegisterExtension(qh,()=>new FH);class ih extends Ye{constructor(){super(...arguments),this._needProjectionMatrixCompute=!0,this._viewMatrix=z.Identity(),this._projectionMatrix=z.Identity()}_setPosition(e){this._position=e}get position(){return this._position}set position(e){this._setPosition(e)}_setDirection(e){this._direction=e}get direction(){return this._direction}set direction(e){this._setDirection(e)}get shadowMinZ(){return this._shadowMinZ}set shadowMinZ(e){this._shadowMinZ=e,this.forceProjectionMatrixCompute()}get shadowMaxZ(){return this._shadowMaxZ}set shadowMaxZ(e){this._shadowMaxZ=e,this.forceProjectionMatrixCompute()}computeTransformedInformation(){return this.parent&&this.parent.getWorldMatrix?(this.transformedPosition||(this.transformedPosition=A.Zero()),A.TransformCoordinatesToRef(this.position,this.parent.getWorldMatrix(),this.transformedPosition),this.direction&&(this.transformedDirection||(this.transformedDirection=A.Zero()),A.TransformNormalToRef(this.direction,this.parent.getWorldMatrix(),this.transformedDirection)),!0):!1}getDepthScale(){return 50}getShadowDirection(e){return this.transformedDirection?this.transformedDirection:this.direction}getAbsolutePosition(){return this.transformedPosition?this.transformedPosition:this.position}setDirectionToTarget(e){return this.direction=A.Normalize(e.subtract(this.position)),this.direction}getRotation(){this.direction.normalize();const e=A.Cross(this.direction,Ro.Y),t=A.Cross(e,this.direction);return A.RotationFromAxis(e,t,this.direction)}needCube(){return!1}needProjectionMatrixCompute(){return this._needProjectionMatrixCompute}forceProjectionMatrixCompute(){this._needProjectionMatrixCompute=!0}_initCache(){super._initCache(),this._cache.position=A.Zero()}_isSynchronized(){return!!this._cache.position.equals(this.position)}computeWorldMatrix(e){return!e&&this.isSynchronized()?(this._currentRenderId=this.getScene().getRenderId(),this._worldMatrix):(this._updateCache(),this._cache.position.copyFrom(this.position),this._worldMatrix||(this._worldMatrix=z.Identity()),z.TranslationToRef(this.position.x,this.position.y,this.position.z,this._worldMatrix),this.parent&&this.parent.getWorldMatrix&&(this._worldMatrix.multiplyToRef(this.parent.getWorldMatrix(),this._worldMatrix),this._markSyncedWithParent()),this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix)}getDepthMinZ(e){return this.shadowMinZ!==void 0?this.shadowMinZ:e.minZ}getDepthMaxZ(e){return this.shadowMaxZ!==void 0?this.shadowMaxZ:e.maxZ}setShadowProjectionMatrix(e,t,i){return this.customProjectionMatrixBuilder?this.customProjectionMatrixBuilder(t,i,e):this._setDefaultShadowProjectionMatrix(e,t,i),this}_syncParentEnabledState(){super._syncParentEnabledState(),(!this.parent||!this.parent.getWorldMatrix)&&(this.transformedPosition=null,this.transformedDirection=null)}getViewMatrix(e){const t=V.Vector3[0];let i=this.position;this.computeTransformedInformation()&&(i=this.transformedPosition),A.NormalizeToRef(this.getShadowDirection(e),t),Math.abs(A.Dot(t,A.Up()))===1&&(t.z=1e-13);const r=V.Vector3[1];return i.addToRef(t,r),z.LookAtLHToRef(i,r,A.Up(),this._viewMatrix),this._viewMatrix}getProjectionMatrix(e,t){return this.setShadowProjectionMatrix(this._projectionMatrix,e??this._viewMatrix,t??[]),this._projectionMatrix}}R([Tn()],ih.prototype,"position",null);R([Tn()],ih.prototype,"direction",null);R([I()],ih.prototype,"shadowMinZ",null);R([I()],ih.prototype,"shadowMaxZ",null);const lo="KHR_lights_punctual";class kH{constructor(e){this.name=lo,this.enabled=!0,this.required=!1,this._exporter=e}dispose(){this._lights=null}get wasUsed(){return!!this._lights}onExporting(){this._exporter._glTF.extensions[lo]=this._lights}postExportNodeAsync(e,t,i,r){return new Promise(s=>{if(t&&i instanceof ih){let a;const l=i.getTypeID()==Ye.LIGHTTYPEID_POINTLIGHT?"point":i.getTypeID()==Ye.LIGHTTYPEID_DIRECTIONALLIGHT?"directional":i.getTypeID()==Ye.LIGHTTYPEID_SPOTLIGHT?"spot":null;if(l==null)ee.Warn(`${e}: Light ${i.name} is not supported in ${lo}`);else{if(i.position.equalsToFloats(0,0,0)||(t.translation=i.position.asArray()),l!=="point"){const u=i.direction,h=-Math.atan2(u.z,u.x)+Math.PI/2,d=Math.sqrt(u.x*u.x+u.z*u.z),f=-Math.atan2(u.y,d),_=ue.RotationYawPitchRoll(h+Math.PI,f,0);ue.IsIdentity(_)||(t.rotation=_.asArray())}if(i.falloffType!==Ye.FALLOFF_GLTF&&ee.Warn(`${e}: Light falloff for ${i.name} does not match the ${lo} specification!`),a={type:l},i.diffuse.equals(Pe.White())||(a.color=i.diffuse.asArray()),i.intensity!==1&&(a.intensity=i.intensity),i.range!==Number.MAX_VALUE&&(a.range=i.range),l==="spot"){const u=i;u.angle!==Math.PI/2&&(a.spot==null&&(a.spot={}),a.spot.outerConeAngle=u.angle/2),u.innerAngle!==0&&(a.spot==null&&(a.spot={}),a.spot.innerConeAngle=u.innerAngle/2)}this._lights||(this._lights={lights:[]}),this._lights.lights.push(a);const o={light:this._lights.lights.length-1},c=i.parent;if(c&&c.getChildren().length==1){const u=this._exporter._nodes[r[c.uniqueId]];if(u){const h=A.FromArrayToRef(u.translation||[0,0,0],0,V.Vector3[0]),d=ue.FromArrayToRef(u.rotation||[0,0,0,1],0,V.Quaternion[0]),f=A.FromArrayToRef(u.scale||[1,1,1],0,V.Vector3[1]),_=z.ComposeToRef(f,d,h,V.Matrix[0]),p=A.FromArrayToRef(t.translation||[0,0,0],0,V.Vector3[2]),v=ue.FromArrayToRef(t.rotation||[0,0,0,1],0,V.Quaternion[1]),E=z.ComposeToRef(A.OneReadOnly,v,p,V.Matrix[1]);_.multiplyToRef(E,E),E.decompose(f,d,h),h.equalsToFloats(0,0,0)?delete u.translation:u.translation=h.asArray(),ue.IsIdentity(d)?delete u.rotation:u.rotation=d.asArray(),f.equalsToFloats(1,1,1)?delete u.scale:u.scale=f.asArray(),u.extensions||(u.extensions={}),u.extensions[lo]=o,s(null);return}}t.extensions||(t.extensions={}),t.extensions[lo]=o}}s(t)})}}Ft.RegisterExtension(lo,n=>new kH(n));const BH="rgbdDecodePixelShader",UH=`varying vec2 vUV;uniform sampler2D textureSampler;
#include<helperFunctions>
#define CUSTOM_FRAGMENT_DEFINITIONS
void main(void) 
{gl_FragColor=vec4(fromRGBD(texture2D(textureSampler,vUV)),1.0);}`;ne.ShadersStore[BH]=UH;class DT{static ExpandRGBDTexture(e){const t=e._texture;if(!t||!e.isRGBD)return;const i=t.getEngine(),r=i.getCaps(),s=t.isReady;let a=!1;r.textureHalfFloatRender&&r.textureHalfFloatLinearFiltering?(a=!0,t.type=2):r.textureFloatRender&&r.textureFloatLinearFiltering&&(a=!0,t.type=1),a&&(t.isReady=!1,t._isRGBD=!1,t.invertY=!1);const l=()=>{const o=new kt("rgbdDecode","rgbdDecode",null,null,1,null,3,i,!1,void 0,t.type,void 0,null,!1);o.externalTextureSamplerBinding=!0;const c=i.createRenderTargetTexture(t.width,{generateDepthBuffer:!1,generateMipMaps:!1,generateStencilBuffer:!1,samplingMode:t.samplingMode,type:t.type,format:5});o.getEffect().executeWhenCompiled(()=>{o.onApply=u=>{u._bindTexture("textureSampler",t),u.setFloat2("scale",1,1)},e.getScene().postProcessManager.directRender([o],c,!0),i.restoreDefaultFramebuffer(),i._releaseTexture(t),o&&o.dispose(),c._swapAndDie(t),t.isReady=!0})};a&&(s?l():e.onLoadObservable.addOnce(l))}static EncodeTextureToRGBD(e,t,i=0){return NS("rgbdEncode",e,t,i,1,5)}}const zH="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAgAElEQVR42u29yY5tWXIlZnbuiSaTbZFUkZRKrCKhElASQA0EoQABgn6hJvoXzfUP+gP9hWb6Bg00IgRoQJaKqUxmZmTEe8/v0uB2u7Fm2T7HIyIrnz88uPvt3f2a2WrMbOvf/u3PvvzP/sUf/N6//i8vf/lv/3v5H//d//Sb//Uq/5u8yf8hV/m/5Cp/L1f5hVzlG7nKJ7mKyJuIXN/hPwqXI/g++zq6rPI5u8z+WqfLre+zy7PrVv9L8brsMiGvk8XLmM/sdfHXal4e3ad6GXPdyu2ij8u/+uv/5cuf/OSLfdtEfvUr+dnf/d0X//t3H/7bf/hP//N/928h/0Yg/4VA/kogfyGQP5Wr/IFAvhbIlwK5CGQTPP+9z5uPeePJSW+yo2+s/GtN30Rnv1E+f5zxof9R/lSXv/nr//mrr3+i+5dfyX7ZZQP07Tffys//8R/l/9TtX7790T/7r/8G8pdy+/8XAvnnAvkzgfwzgfyxQP5AIL8vkJ8K5KsmMVzu1U7p5PA5AXxOAJ8TwPf7sX/51ZeXfcemqnp9w/W77/S7X/6T/vzf/7383RWCX3/z05/9i3/13/0PX//eX/2FyP8tIv+PiPy9iPy/IvIzEfm5iPxCRH4lIt/c/393//9BRD6KyKf7f488fP74/PH544dJAF9cLl98IZfLBZtuqterXr/7Dt9982v95S9+Lv+gF/3i7Spv/8lf/vnf/vGf/dF/JfKnIvLnIvLvReQ/NEngn0TklyLy6/v/34jIt00iGJOBlxAsdvv54/PH5493SQCXy9t2ueh2ueimKorrFbjq9eNH+fDtb+TXv/ol/vHyhX4Fxfbx7euPf/Lnf/PfiPyeiPyhiPxxkwB+fk8AvxzQgJcIrGTwFsiAEXH4/PH54/PHUgLY7whgu2C7bLqpQgHB2xvePn6SDx8+6G9+84384vKF/IPu8iVU9Y/+7C/+jWxffiHytYj8VER+X0T+oEEBvxqQwCMJeIngo5EI3goIwVMIPn98/vj8ESaAbbtu2ybbvl8u2ybbdtluSECA65u8ffqIDx8+6G++/VZ/efkV/sO261dQXP7wT/7kX8vl8qXIFyLylbySwe/dE0CLAr65B/9vGn0gQwRMMqgmhM/J4fPH548eAezbZd/lsm3YtssNAYiqiogAAkCvb5/k46cP8u2HD/rrb7+R/2/b9Wu9yJe//8d/9Ney6S5yEZFdRL68/38khG/uKOCnAwoYkcCoEXwkEgGDDq7CeQfyOTl8/vhd1QCum26ybZtu2yabbrKpQvXue1yvuF6v+vbpTT5+/CDffviAX1++1V9sO77WXb/66R/+4V/dgkbllQi+aBLBV/dE8LWRALwkYCWCNyMZXElkwLTMeMkga/P4/PH547ccAVwuctkvdxSw6bbdtYDbTfSZBN7e8PHTR/3u4wf55vKd/nL7DX6mu3791U9//5+/gkNFZGuSgZUQvnKowKgLWLTAQgRtEniTuEfwaELw0MJvf3LQzynud+53uG+X6y3gN9kul+2y6XVT1U27JCDAFVc8ksAn/e7jR/nN5YP+avtWfq6Xy9f7Vz/9w1dgRYngiyYhfNkkgzYBWHTg44AEMmqQUYQKOmDaiCIa8TmsfmzB+DnZDQjgcpGLbti2y3bZHjRAdRMVvb/dcYU8kcDbPQlsH/CrbddfbF98+RPZfvLFnAQeieCRDC5DMvju/vmD4JkEvjRQgKULeGggowdHkAHTYxihg89vu88I5UeGAPSOAFTlrgPopiqbKPSmCKreUoAAkCcSePukHz590m8vH+WbD9/JP335k6/+tA86KxFchv8jMvhiogE4JQm8XhfKqOAqx5qRPyeGzx8/cgSwbXcUoLJtim27C4Oi93+4v6VxQwKAvl2v+Hj9pB8+fZJvt4/yzfbF9lPdv/wJnsE2BogmyeCRED40tGFvksIXiSbgiYSRRpDNDZ6BDI6ghM+J4fPHeyKAO+zX7cb9t4tedMMNAQju5V+f1uAtBSiu1zsduMrHy5t8ePsk3376KN98sX/xE5FPAnm7/782o0DiUINXMkCXCB7/P94/e87AWUmARQWVvgMuKej9t1RLBp+Tw+ePgwngsutFFdu26WXbbl+rSvdfbnqAiuA23QcBgCugV1zl7e1NPm5v+LC96XfbJ/1W9y++fgXjA3bDYXV+MuhRwSPwL3JLMFYC+HS/LU8HYrGwIhwyNOF12SvgM4SgztdifP85MXz+KGsA2C6X7aJ6bXSAOwrY5OYIqGy3d5uq4P5GhABXuV6veLvRAf10fZMPb2/y3b7vX7+g+9v98/WOBq7GG7RNAlYy+Dgkhhb+Xxp0sE8IAC4SGAP/TbgVJK/PoJPBnAiwPKxsXfbbnRg+i3s/JAK4Q/4b9NfLtomBAqCickMBjy7BuywAUVyv8na94tMjCVzf9KNcLl/0SeA6oAEYb1i9g+FtSALb/bKL8/+t+wxXFMyswqiHoK4ToIgKqslgpg1qUC0QoYbvJZg/B/q5v4szHmPX7YEAsD0CX25OwEUVm9xag1+agKg+nxQArnKjAtDr9U0+Xd/k4/UqH7bL5YsewrcBBiMJZPRAp6TwQgWfjM9vgRbgUYGL8AvLWH2gqhesCokeUmCSwPsnhs8fP2YNYMO2XeSmAWxy2VQaXeDmDIhApf33rD4PTUCuV+DtCn27XuXT5ir8VmCJ2G5BpBM8/r/dEcJb8/0lEQMtJHA5TAlqNuLRhJChhEpSqFabH3di+G1AGj+W1/dyAR4IYJNNnuLf6+tWC9CHHiAtFhAIFLjK2/Uqn65X+SS67aK+3QeTDoy/IG2ogQ7fb/dAtz5vBgrYGqrwNtCHsVfgIvwK07OTQBURVNCBFpKCOjqCHn5L/67TgTN+fpySAC56nwSUi256kXsSuFGAVyLoUIDo8/Pz7fdoErr/v17lk162HbgHvFpIYDfoAJJfW4sGPjkU4VNAF8ZEcLmLhdc7kljdY1y1Dq9yLiI4IiRqcLujb138KIPn80ejATwRwIbtBvn1cqv+2J78/5EI5N4cJA8qIPcmwRsKAHDF9WYP6mV7VmrgLuTpxYTcMEW0LAmoQxFsuvAI8tv/a/C5fV2ZMMiKg++FCM7RDPRu8ebWY7VG6VJi+Bzk35MI2LsAckMAgwvQ0gC5DQjd3ABg2HQLAPpEAlZ1Bu7VV7MGHDFRAbo3VKsTbAY9sPWC/uvx86gBbDK3D1eEQS8pbAeSgSwmhepnJb6uBv/o/PzHLzxWA/X7TH77De5j6AGQi6o0CUGfCOD2X7cXAlCFQABtEsGLDtxuOyQB2UTQBKZe5GUPXgkUYCUAbZJRhBDeuq8xBf+bgwbehDm+BFQi2IJksOocvA8ysIMfxluVcRsY/eB3JzH8GFDAXQO48X/dcIf9jyDHptIigDsFkEe066tBSETQUYF7ElDdYEBytN4+rk9UcBPfrKaZqFHWcw3i4J8/X4ev2//bSXqAhwTay6OEIPLD2Ipt8OtAGzxkwLw9WVFRjTc/qC6H3+YK/b1oAA0KuOizHfieCLaHHiAb5NYTIC9EMEbZrVEQt1xwhVy1UfBh8PUOquMizwaap3tQXfY5B//tea/NZdfhsvbz+PURQTDSGWB87VX/7WSd4KxjUqrIgE0IUkoKGnhIvwvawpGf6eECXJ7tv4qbA7DJgwpsKthEmmYgfaAAffYF3HLxo0vwNjJ0SwRWMG4db4eh1gPNm18vQ+us/0eGmxDemu/fnM/X4evq/8342ksGHgLY5LyT/zg0wM8lcMjgGFXwqIOVFJBQw99eCvF9oZL9Mfl3QwAvIXDsBRC9R+fz8x0FPBLB0xJEpwUobrfAkARgIAF41h3wQgP6QAmX5E/7eI43IxGwwf/moIkRyWRJQIPgt9CA9b39nzt4bYUWjAlCjWDPgv8IEjgLJfzuaAsrv9VdVG4OwOXW/fdoA35qAdL0BDwvf6AAUVHd8LIEu94A3K+Q+2YxaB84MOH62P//qoo38fCRDERE2zf0JfmDa+MieElAjcDPKz+mRKCOtdgGtXaBjgNJ4H2owSpNeAW/rRH4CaHSpMwnBYYycjgSJwfie9CR6mPu20Uv8kABF206AvXlBMiIBPSlB9wjBW1fwEuSb94296VCqgMaGCt/G1BbExi3IG+r3a3J6P48Gv/J0YmEYoiGY7V/SxwFCwGoE/xa0AJ0CEiV9QPCJb1OJ5F1VTjEY2/MO9AEJvj1BJTQpqLfTlGwjABuzT962e4IoKnyrdh3+/6mzDVJ4PHOxj0JqGKoy20+wBMN6D1gLWi9NQHfVP5MEEPzjGYy8BMAOnTAJgEr8HUIejRo5xrA5xkR5AngmiSHs+zDDAmMgWzTg55GSJEmHE8IvWPAoYTfhWak/Wn/bQ0CGLSAjv83SUEfKp5q24LXuQICpzrjrgWoza8xVE00CQCORdhMJuTUT/rjuls0gO4Iby8BIEgK6gS7BsGuTtDrScH/fR68biUHNVGBnxjeNyHEvQe/ve3LZQqgG3rof6cEclsNflG9J4KtaQ8WHcVBHS1BtHE4QP9OBMS98mpbKTeDW7dJwRsnHpMBTFJpV4I+b0kY/NqInVFSyBLANbnMSgBM8F+Fqfxq/h657/Up+GaBnwV9hRqc9bZ/vA6vu+T9E8KPJWns94UfTeCj2QXwCHS9dNL8Xf3Ho/rfewSeFODGDV69AU0y6NFAE1DP3qK++rdB7/1HRxf86gT376zOr99T/h/ioBiXWQkgQgVeIrCC/WomhDmQK+hASI2ARQZKooHMLdCJwGEBBXC3+uERwg+VOHZ9ioAt9H80AI06wGgJ3nQA3BoCut6AhxYwgcPOFnxuFnrphk+NIKIGrWPQtgz3b0i7Y6D5rs1GKqTop0nQX52vmQC4BkjA+r4a7Kx9WLENGeegkhSETBCrNXIMdi/444Rw1n6E96ry7OPuj8UfLxtQ78NA2iSBbg7gIiIbdDLsb5agPhLC3RkYKv8NDbS2YGsatNRAG2oQwf9ZIOydgy1MAzBkAw8UwEEIDzSAqdPQ6za0PkeJAMH3Z0wXniUSZoHvBXU2mcjQgv56TedIKglCpIoQfgwCIjOytd8WgN0bfxoR8Fn9Gx0Aj5Zgq0lIZbsH/ibSJoFnS+C98g9ooHEELI3gliy25yONIiE6pb0NfBlyNEYyENoodkKwgl6I6s8kARgJ4ZoEfuYWHLEJa0LhSBXm7kImGeSfVdoJ1DO2G7WXsehAptupSOoyrCSF904k+6vt98X/ZcM98Hsd4JYIXhQAIg3/f9AAUYhsLQKAtkHVBnzjCKhOoYl2ym+iBtvzDzQ2DLXJ4PUmbJHAVnBQX4jkxfvHhNDqAdHXGQJgv0aSDGItgOseHIU+K9hXnIJzkoGlEKzNHagTdJ6VWEUH4iCKH4fd2AwDPaYBm4Wgng4gQ9V/CoGiuNmD04AQtNGMGzSAAQ2I2pzfogY9LRh7BrbOh4+D30sAencljFu2CUFrwY8UAWRfWwGvVOVfbx2uIILM0pwDv082dUTw8hYs8L+uIWiHGpWgClnAa1lMPJogovvvbePPs/q3Xr++kgCsfgB5oQF9WYKPJqEn6G+OE3i5AqouF59FQOmahQC8rlPLj38kg1c2f30vw+XaoIX24/pMGIgSBoZqoH3wo0sIIGlA9PWcCPrAtpPB8eBf6x1o6cHra+2+tpIFP4PgBfxZtZUJfo4qxELT948D9ucK8Mt9+ccjIQw6QJcEbrD/1g340ATuDgDkFfx6twSf1f9xvuBECYxq/7ythQQGm+5JDx6Brw4CkMGT3wgscCUoQ4sU2t6DR2ciBjTgtcpenQoZVX9NuL4Owc+dVaDursYVkVALX+shjSBKBuvCYDUZjE5BdNkxdHAUBexyHwB6NP7Iyw7sxUDViwge1t+mz8B/LAvVx/c3PeBBCToB8IUGOgqA3iV4yUg6UAOxaUFHDx6CYS8SorMOue0CCJGAf5YfRhoAI+A1CvwxqNkAY5yAIx2EQmkFfeWOXi+nEdSQQA0ZHMEItiagJArQxDXIrj8nCfQi4HZPAttrIahso9oPQ/2/JwV5JQU8zw+7I4D7/sBn4EO6rjw0FR+i3Z9fHtahzsFvJgM0X+tmVH5vaYiNDGAigewAz+gyNLThnjCURQFR1b9d3lZvnVqmj9mEPDKIUIC4KCCjBXywS4N+otp/Hk3QVthOkwEKlV9PQwXjT7s/zwF4Qf9toAAzFdjuaEB6S7D1//U5FIQu2MevO0rQQH8ZmoXE6B/IkgE60XCjVoq8gt2iCG0S8L5GdxkM1cGsfsCMArSCAnrr7dzAZxCEEpepvB8tqHJ/q+bmJGGts/AcAXFOMMeTwC7Pw0B6CtCtA2vWgonqBQJFSwH0JQK29OB2kvgj2HHXAoyeAIsCQO0kMNECAhFMqCBf8mElAkyBbX1tJQP2RJ/ha0gpAfS9l+/5n00CkrQpq0MZbOdAuxmMvHswog62jZj7BnYQe19b14kxNq2D/ehX/p68HEcF+x3yP7z/V/A/q/5DA3i5A/dzA5pdgbKp3v3/wQF4Bb70WkCTHGRAA6+KL0bFl6FJaFw0ImZwm6igSwbbwPn9RMBWf3sN2JgA/BVh/Rg0kQBgePf6HglAHLFQwqQQOwDjbdVxNZjR4iM6Qa3WxwvNxh0JFb3g/WzFQQS8b/ttKcDWoABtUMAd8j9hf0MB2uDXhzX4CHj03L9DBU3Qjz0C0l4mLSLQPicOOwZoVCB6P6dA7nDbGkVuxcNr8PU2JQO4wX5trEqmccZaHU4q8oCDFOpzAnOwqyMIMktNNNAHouDGxO37DgArQZzlmp/14W1QlqHTMaIIx7SCx0+5yza7AKJ3IXBrNAHVDcMZAU/BT/vgv/ULPOA+XiLggAREDF2g0ci6xNDRglegd7P7TWWH5oJfayliEg7bScQRBVgI4Ookg/F6rvpLWP29swREqA3CaG8/FpKqS8DTAV4TiBqIqtxfzaQRLys5I0XEFIFrPbZRQb+16Fgi2LvJv8EFUPW1gGfQv1T/F/d/HBnccP7rAwnIIyHI4ArgWeGbU4eHy6Tx/EeTZIb5bo/BsMBjmjBE08f/RB0PHYBd9eVRAGY7cHRwiBf8WeCPHY1bgBTa9xKTELzEkQX9CPtl0gJiqsAmCT7I8xbjivh3JGFI+D2nBcSJQJ8agDX+O9iBL7UfG4bzAkcaICrbtYHz1ycSmGmAjJfL3CMgT3tQpmrfB7gxSzC1DnvdhQMieG47u75+kTouKNkM8c/+vq/Q7ZYjO/hhVvRq8F/9gGfhP8aqE9EIdR6LTwJ1h0BItyDqB8iFwuNqASscRnYioxOg9ApvnYA35f8e9Ohbfe8J4rknoFkO0lmA2gmAG0YK0DkB4ieEjiLoMD8wBzom27ANZkzIoU8EMHk/uo1mzeVoEoRWKn8L/62EYAX/lsB7D/LXg74uAMr9oGivJ0CNJCGD6i9DhZdQF+gtOp4S+NODRzsDVbhdgv4BqTMNyIL9SCKwL9/FGPp5oQKxIf8A/UX6r231H7YIqLML0Ae2GtrADOvRQH5b/MPE9dt9BGLNG8jVTAQvIaK5TtvvvWQgDvyXIClUA78S9Nfg7VtIBlO7cbsEYkQDMot+ygQ7QwmOawTHnAM2XUSnJvPIYRYMmYPS+sv3J+cfP3d04JYIXsF/EwMbBKB9Q9AY+BiSwFj9mzrSXmcJhFPVHySTbgHJCPvRQ/z7G/SVUETsg0ZF+i3CRoCjhf7y1A9mOiDD7TwdwEoEXjLwAv+avLE2B7Jnb+OqDpBoAchoQJskxKnss0vu7Q2YhcDv4ySeLOg9GsCKiUIihP7yfW7zbTsBh0TQfN0iAWn9f72Z56/Ax9P7j5OAH/Qvv3/QxKfk0DgDuP+R3USg3bzBC7bO/QT9Eeh9QvDPG7glBQzJwK740lAFFgFk8P88CqDGAa223YckWYhr+c0BPdwetl2ocnsfzePAWcVnnAIp6gDVhDLyfV4nqFEDPxHsbWD3k4BDkN+pARqKMLYBPzYEvxp9xmCHQQdgWH/9EtH2TIFpu3AH/cdGydv1j0TQbRrq+D/mLcX3ZACZ15bF378CG0My6Kq/zoGOQwhASDFwFbxyNGBuSxbCEhQ/uEPe/6gAERWQObCVVfjPpQX+rexxYhYFxIkgpgX7Y/vPs+Pvxf9vwt8kAs7i32t3QCP+3SPaTwIytQXP38u0PESm+YER+o9B3vr8mETAUfDrEkPI80ck0FZ0dXh9U+HRbhey0cAc2H7A4y4egoD6y8JfkBiigLdFP8v2W00E8deT2IeAKujZ/QAVKpAtKI20gLWksHedfgPcb+0+NEHefd9vB9rayi8h7J91gBbaw20MsnWAF5xHkyDUCOoXp+yrOwwxcKj0aL6fFppaaKDv6OpHR5sgx5BAlK/+fYhuP1D196o8e7lFBaKqv5YIMnFQpd0FGVR35RJCnCDaABaXBtgbiSwtICMtalKC+1JQ6bx/PLcDPQL91QFodQNKpwOgF/9eqcBxBBqRcKAAVk+ArQOMx1RYGgB6naDhlK+uQQwJYx4meQbxtNnYQwMjt/d4f3M9ZE4UOld1LAh99fbfzOxiEkKFCkTJIUIMUeVnJ/9sDt8/e1NEJOi9oVHDGYhgnSLss9DX2IAqw1zALUncKcDr0FB5NP+0cBQNrEezDiyiADPkt9qGpwoPdL0AGPx/NOKeyf3b9WJNdfcFv6bKd2cLMJVfJ6Y3B6wB9WFUfWWEwKMfGiQL+3bz9XGQz2EHKhF41GCtZyDi/gUCsNhYoAr3UNJ58YidHKqnMb/6AB5J4N73/4L+t7mAkeeP3P+1LNSB/l0SkMEd8DcEuUlguEw6t2AU/PCE/q++Akw6QFf1u6SBrj1ZnnhG50AfkoGIdf7gJv1KcSfgzWWkQ9U33Z3tHXYASKJ9e/YhU90rvD+q9Ej69/wxYJVs506Eg/r3DkMDzEdDBRGgcZay49XihLA30P+l8N+hf1f57/0AoxbQbwYaan/rBMirE9Dk+sBzTkC8JNDEUlv5McB8PP19Y01Gayep+hC/2zvQ/2HGLAurowsNGlA1cnqGGzeH5weiYLZm7h3QQC4O2tXdhvMMk1ZS5ebpgI8eMrPvPGkwaxayk8Yc6PMOBPEdC1XZ+2UfbfOPtxLMQQAG9BcZFoF0gp/RKjxe7+oAw9T7ZPWhgedodgz0gf5KBtrtIZhQAZpAV1Bi36w6t98qVfH7hqGI318lLCjLCUFlxRHwqYEH9a2qb4XjWvDT7kBwfbZA5P0+PNuRuW1yf4yNQH3zzwv6b70QOJ0G9OT/dhoYRUGT15uQH/71MjQLtQlxfDuiCXrtM+SkA+icQdH6sU/xz7Ze7FlubV4TpoTQ2osdpaEjtqADmEU7OkBEFoLeC3IWFFeswJXKXzkboNL+wzcFHU8hTGKIboO7CLi1/P+5F+gydQhuvRbwEgxvtACmANikhLTbj0gCYk8KdlYgmj+4Ymaod7TwahwadICuX0Cm2fE5iNHPK0x/CDV66Kyg1MnqjNFBnhBoLQCgUULfaVe5nq/6EQWY67bXCszUb+7232fVPz51iGB12owK9peyP1T4raMFF/OEYJP792mgXYfZ04GHMAhBkCSmSj+dKqRPgVFGHbpLEGMiGFeQWfSgrY52VxaeDUPSNJI0P7NoisG729HHl78z6hxfs9rV3m4JjgM/lsui2qmThjCfDFSb+I9vwUqG5wwL55U7C+6ot8B+7N2o6r3q37T9trfpjgmTvv7PSQATLLeRAOZhIJHBQfDQQJPBdUwEbVW3+L08EcEE/9G4ANrCeWcnPKRHDupbNynMx5AA9IRYLmrc/YLSiD5EaEBS/s/TgnU9ILcH19n+CpHwegLejx7Mn/d25fdN+e9U/1vgb7bqf08MOtf8EXxaoh+GY8L6gDfhvs4i6HQ7seYI2sv1GchdMsBIG3xlvxcCRzdgCPTn+6q/TW00VE8Q9FaFv+R2VlOM1vm/hhjhDCdgNflVKME5B47I9xT8z0YgPAJ8myb/LqHy36j/Mwqw9AALxuO1JVjiuQAYLcFzIhiEPe05fk8tRjGw7yWQbsfuLAT2VqOId1osnr0F49VM8INACPHDoBz4B5mqqSnUgyh3ArjXxfQH5BbgUS8gP7aU+w0zHD9GGD0CGHf+P1p/DeivlhU4BbxR9a2kYFR58YaDZCUR2P0DMmgED2eg77puegy6PgDphEB0CwlG/i9d+/Hs34pBEQrBn0W51mqGnJAk3ACCHeiqkQ1XFQA5AlKH7Lk8yJKWY3/nym14h2C3JvxeMwD9ZVMz0BPMi1n1RbKl1cYhIVblF3G0ATsRiCMUvoK9//OgcwYMoe+ZKOLlC6/Xk50br9NFz9fanqA8UIYSpCwlBO4kHc4WLLBfBHVaKwKgLQjmP4Un61Vq+3s7Bsyi0WztmLjJwJwFeE0I2vD/1Q6MVwefxfUf32skCPbCnxQqf+QMPEUDHZ7vGeyj020JgkPXXwsldA7SYR1RE3h94NvNtugswcgxXEkIcBPCGZ1rmrgDC0A4K88nm2fn/eTnpQtWyZfybRoK8Dro4zYDIMGsf7saTBzvX0SMbkAD6o9CYbsfMK38cJKD9l2FJt9/VGs0h5Gib33pxMKWNsigFUh3G2un+/N1WUglI/EEx8fq27vUNnwsiOoKecL7kQS8VnWAGCFUgn6dBtQhv40CmIYggwK0uwDHRGAuBXVdfwzHUjZzATLMAoyJ4FmBhzaWBlrHld9CCWpPHRqofBqMReMGTJ78q9rDes1Tv7/0m0v0AFHXNR6P6g30SHivin7V1BOhh3iWPwvps/yE836L2XiwnUT8x2iHgfqhnwn667QHEE8oLQjEvtEW7GYBZDrDVkwNIO4G5GiBDf9fGoFM6n+vbEtzXwP6u9AduaWnGYSLAlVdl/AU+ikrSeEIKgwdaZ4AACAASURBVKj4/wtgHcHtdO2nWKcBkPfxcvnNQvsj2Me9f02r76T8q0IBn9OLKfz1HX8yVXQYGoAB/2UeBQ5/5kCL6+H/OGGoRnLSwdd3oH8r7KkGTbgIxEwVWvnF8KOpHnyzfF9Jod5Px+IF1h8owyitDw/XEgRb5bPqbt1uvn7qBIQ16vtS/u+DP3cR7CH0WWJgd5mTJKYgNzoGjQrfvu99NDBC+bnyW1x/qhTatv2OaMKgJWPvv5kwnMgxHYGFRtJW8VMl3uP+MgoqSZyWFKr7+KIDw1d6+IiOgZI4+d5iYL3imzbgyO+tph9t2oSBxOM3ugHtPoFZ1LM0hF4kXNEBssvVgPdjdXZWK7uKvyS3q1Xb1WQwtVDqSUggq+Vw3t56JA2cz7PXOwGNW1ecwxPhfe3QEUsDsFaAz8jg0nf+iZMAHNg/XSazDuC18Iq1HBRrOsAQ8NLB+16g614jmuSgs3bROxE55D+WDDQNA4ivdMJ9M1b309UqknaDU8ObV9/PwmMPATvTMAxpABLBzugUtV9bLdhNDQA+7B9tQJ06/7QNDHGSwtgZOCIA47InIoDdROQGtt0U1HI3GaoUnCnC/rzBMQJteN17+VaAzYNA7e+PFqHQUyXPUYB7iQYa5ZFjq1Zqpx8Uqu/XT7+6BWC1Xaj0GlBIwMoHu7UzcI/6/Acb8KIq+hzmGWmAYnADrIpvKP7TZeLaf0LAeQkGgebbq9FToI44p654F47tekKkI0L5PQNZPsDwPBpy/ni+wKMN76Vav4+2cFZFf8+JwAraMt0DFB7beA/u4Zz/a+RXx0M/ct4/jwaNAS8G17eSwmta0Fhx0VRxJkHMivso+onMXr+YwdWKbgioy1jp4x4AzIKg5lEA7wvHEYCRmdx11TAuT6lDLVl4KvXkAET9P4RT8H2u+lg9EPQIpw+/NpJ7RwE8HaDv/Mu4f3OdNkq/EfAiEiOANjEALvcWL9gfFV4NZbgbQc6qPky4Pm35QZxtH1f4j+P/jXuaYPcWwIEH/fmEPBoAO4m4LGxV3txOQqDU+dXgey+UwSzuqP++uImO/u/6ogCb7wTc1n61sL+vZi87rxnrNas+giTg6QLzaUCjIp6JfhwtGI7AjBBB9JjDY4ePYVR6ZPgN4owVv6Q2N5hhVHwNeYrM+w6dN6K1sMHZm/Ce7bHe3dzKr1xw1w4JrSQMZtgnoQHlr18fzunAszD4qurNUg/TDqzx/lfCaO6t4tACMUQ6P6htWjDPC1hCoZ8kpODzJ70MUR9AODcgwyqyPhmE+wfHYB/hvSqt6qeXUShhXH+d9SR8DzrDaZZdpSp/HxqLMQuATgDU/qDPRgOIeT8cvz/h/XC6BtE7ACLOWPE0KIS4UUjmZaJ2grBphiWgT41BUVWZfP3AnEIT6OrfoF122l2rMycBoU5i/OXoUZ4/aglsXwLzHNU++FVF3qikOj5HXm2PBitT1WuvJRAB+6O//W0/PY8vQH5IrAsMs/WuVmAdHBrQgrbOxJShXwRSsu08h8JMBpo0+aDTALwV4tbswgzHrftG/dJKIAQb5h9KCssWIMeto+GYqG12/HWGjx8kzqNJaa0noMWOr2KwW01AMwJoNvhMQda2/RKQP/3ecABM3g9uD6BY68Ntz9+nDOMb5iV+hIE+dP/Zs/wwJhJ9mgBnohBuStABUXjugF3hkXF9ZZJAjefKdHZCc389LoStKvIl7QIEb1d9RyciQgFDI9Cjyccc/23Aam7/PZJBhgDgin5CtQvbCzX8ip9YgIFtOAt+w0owp/hOiCWgEGbVHuYjRigPGR/YOnEoqPDoV5z5YqB3mRq2ox5ICmSSgAP1Ne+XV2NE+/vuFbCTRADxtS70VRBCjgBk2OyDUQiUgfl77b7DwaHm2rAZ7osRSOOUoHgKfNBSLI767+oDYrfwZvqChSpGfj3pFwZFsCJg2jeIQQBUiyI4WgD68ww4qO8khuWkkIuDrxWv2nv+UTBpJYiPd0KemTA8qqFiuUF1jWS3BoG6pADJq751JqBI0wvAVPyMQvjcX1zbELltKK+zBiXRFiRxG+b7q3M9xuLdzR8g0gCGNzSM5gNYfqGO9CBT8OHct6oB3KsSDBisUnwsFuISQaRHxDSv0vptt2oeLHMERfRn/FG/Cx01EpgIQG8LP+/i37PKw53xn6sYCM4/JwSRrCnIeB1ZkLsawDhaPKv/njU3wnZ/dBdGE8+YTHSG8+ofGgIjsC19YnwdM/KAnTSsqj6ig7uGgIPw3nYFzhhIIvriAxFP9CQd4HSlnzgxONIdrE7A8ZDPx9fjib8ifgegNIliRgdx95+E1T7+3nQVNNhEzDgGA3T2rEDLduwtPpuuouPcs8swwXFjdTaMKt+jA5gUAQPcf95KJQxYU0cYxEDvsBSmYuukp7AwnqniC9Afa5z8vboI68ImT0t26CvwBzSggkj447r9IojvCn7U92J/Hw0QSdwZKNNjxPCfSxRqnATkdwpOwh88oc4J8KTSm/wdbZjrc+4iFP8YO0/5JJDCfaijK5xVXevqfg6zGRrQf83chvX4aRfAE//6vv5+6490U4ADdO7QgM/5bcHP/n4OtCQhBEFeDWSvos8DPq8/IwzLzjpa8/U6MMSkBklDm8e0mn3QIY7XG1Om8wzN48y7HwhOK3P0/ZwUQHHv4psbdoVeb9VlAjChBCdtDDpOKTh9ZfcagOYq31RFjN4/gwBYzp8lAwYNwBELhZoxECeZxMlAzWGdCRV0fQWGHo8+8Kx+AAxnCIzowAxy9KvNepWfsfp4RR9kUrD88CPVTuXRybhqqTHcnxEGndsgub1Gdug8yz9fHt3Hpl57x/mfCOC29FOSQ7/noAZR5W3Ob24UMpuPYAYiQrQgk1gnFoUIKr4vKFpV15pHUJO3Y5rfH3UFHU4bGkU+NKJ9f2hJyOMxDBDpjAgwiYqvk5TqNl9EH2Arb6fA3yaA4cBtPWewhkEcIQJBlGzYp6zRmr1v+e3Fv27xpzvyI44NGDkCIi7CGNV9Dw0M8NtHC2vUwHINumCGNG8erxOwtQINsW88Tlwdoc+F85nI559ngEDpt2F/Uu3hiXYrkN/pBFS26hYDAkFgErMK67y9mGBA3L5ore5izf8b3n805MOq/t7XU4WHv1DUF/5gugCSOAIW/59uMwl6CHWAib8bvfxWl9/rBGEMTTwDfG+ezEYG4yk6FvRPuPwE+wvc39IRjENWM+/cm5b0W4Pf4WuKUnw/vD6eDbB1ETs5vl77Dhnm/51g6wPWwQAqxnivgQaeS3gy/u/1H4hpTPrIgHAN0mSgXUX13YP5PMIuQAfBr/f70cdeE+QoCX3i8nFMLcAjInBoAIYqt1LhC1WdtvmSab28AYffaeivCB+ohdYQgfUa/WS4ToMsNLHLc9nnvPZLwn1/EefPVf+U/xvnCVSEQEkEQEnEQJO7S7RvYDxNeNYKrG7DKMhtsQ8cMmhgPKKKj+F7CiHYFR5KIIPxOmg5IVAtu3ACQSPh7CzUQOgAej5CWEkIe3vgxz0ROGO//qYfz/dnLT+ZxDr4QW0eNCJBorCFOVC312Ec2TiY5Bk0cAaQmiA1VH1MOwDHQ0kHdEDDf+2UTWhS4Z8diQMicLx8MLBfverLcP/jQzF0P8EJj5+NGK9RCz755S6F/f1+X/gxeP+Wsedv+vF8/54aSPJYFjIQd624MDz/UDLQnr8HU3ztKHRf8Qeno1vyAQJBaLcMtTV3cvgP56COCqd/QP9xLgBkH4BxO13n4hNUDtACC6G1S3zqooZ6Ba4lp/zcAFb7iERKQwQcF39IFJjdXECGADw0IE4gg674pYAnk4HoHPx54tD5daO5vxrugSkMjgiiqc7TVKAT6AT8R4ckbHEQCYR/IZBxJgA+XZjsR7vaoRpIxWqeqfXuGC2CxwudicwePEB1kNkaZCuwyF0DuKv/4sz9mzP/Qxdg3BDkBTMC8Q+loD6UGBzx0Kz6eAX/KArOQTlPHFoI4vVtf4rNuLrca9edRn4xBP7k8w+9AgZCgBfEUZWfEs8iFNZ3UO7TqmkjCO/rWdgco/yIqHcQWaC2EGTzgz5y/iXQAvyx3riyxxV/JeBriaGB9OrTA5g9/eokM+37GszqfA/UZk9iW5UnCtBqBl3XoNN6Ag/+zy6A5evPAp+TIFDn15gQw9rjrOzFX0s2JBVAxa/nP1a6AsNWYGjPNGPLTQgBsNUFvOA3Ht9o/rGDN0tWOCcxJGp+f7++kkP7PxcGv1+GjkaLt/fawpwwerQxBJNW4b+PJsYEgiAYYdEAGIlDNaAbRkIgK3ut0jKByp+8yz23X6GttmBmjwDvChgiYLP5V/zhH6/110sGcKo5CkggCngxnIPoPja0j2B+1BRkiYJiviaLJqghDI63G2nAgAxMCuDdnoD0wIQm+urMB3VuAwbBrFGgGgnhAFqg9+ujKsLxB3qGCQNEEtPinIQlAj4WgIw7/iXc9V/x/yUWFs2KH504bAh4aYWf4TrTLGTy9YbftyLeVOWNfYNyt/ji29mQnqMAltU3ioTtbX343yv/1u0YPUBz6zB702tQucnX0gWaFh6DgPdmhXaapGotw0SFz1qDiTMdd8h45HfcqCPRUhA3+NmKz1l9teCPaMd4urGaewRitNBDdahR5c3AfQmDCFT9vmtQEwqAYXX4XI2n23Z9B/Yb1FL+LWox6wHGbZSo6FR1LzyG+3hriSZvWT6jfXhl2cmQZJDrAbuYAqAHo1GA/EOgD8eGcU7A8eDvH4fQBuAhBL/Zp/vamPTrRENDGLTV/7E1WEPLDlP/PwzU4YhusIMUgfIPAr6Dhv5R4y2r8ldFwiFoYHnmr8TAHbhRQSZOctH598ZYhqt6wP7q/ouqe77RJxvzFYaji/z4vna4v5cUMDXqDAJ5ytktqtBDckyjvJg04hl16LB0xFfyMfD77PZjErGQRRjYIfSvoAXntks0ok8MsUC4KARWnYPlJBeIgLeFrUgDOHYCag0/XNAbWgRwQuLAsaQwIhC1g7+jCNKuT38JfnYSyTi+QQEwwHeT4/dWHYxJPxfOj5oAnRQqgU3YgGZSOaDyK3n/qkDYBKptzR3oD6B4fyRKjp2AzSl80YR/3P+/1vBjX18Jbu+YsrMRgbqPP8zrDLTAaupphfeZtyPs9BPztpLSBZjowF3woYRwBwOWaqbev15b7X4RWsiqYiY6ZkFEIoUwUA2OrkeEQE8HYNyD/rl3m88jCGgO/nPW3xy8x4Q/HBcM1dYg5q8N+B/SBSYhtD0EY1PRGLDoKIBHF3yLz4H/gSYQJRETgqeB2d4vC8L2NVnQn4PoVJJAcP0inahAfdXVI8CFszjRagCTtRdV7Sr895NBpRKXIT64RMFw/iw5eChhEvmmyUIH+k+Qu3cLzOAN6ILlFvgWnx3YWFDz0f38ze9GlfP6UQ3ojEY0gtqRIEbA5/WgQFhsEuIeL75uTzvqHktAWfj/OD6sQXssROcGiRgFn0QVkld7OznMDT7CJKzhMIqxW9B+LCOQdH4uyxIcE49VTSeLj0wKjzcp2oDXQA8YoDEGBLMW0BJw+eAxXejPV/IXd59/tp5rVyYXDw5BlRetSpQAcvgfOwVM8ObzBq/AQ2wX4lwkQV3vNhYFfn2LFgaoDU1ogqsfqGkJYmrj9Tr22KQwBLzbLuzDeA9yzyJjVRfwegWq0H+FThDPA6ZhZwX2M2Kh4waovCzAWJTzD/qY00c+6PM8coz08VNqglzx54LfHuTJK7z2rwX35ABLg1DzsZ7Qv7l/f2yXDlbf4C/irg0MJ0aCuD0wP74MrxfdFlX7tq+vtRdCpvt599EG9Yz3V+P+Oj/n4zLruZHcJ7oMt/MNp9eD6HEeFb6/TMfbWo85Pb79HJo8t3371/PuIAZqMvjPC34nVV6ZB4hEuA7AzA5cfU0y2n6ux89D/35/n2/vWY5Bf0qwf3tPLISO1Tap9qzFB6eap/beqI94NCCbGwgqOItY3CGl446CaQ8i2Q9g0AvmgJOnBoAA0gu17tsKtKS7D4udgCYERy2QIceCX/P7mBW+g/7D9S6Mn50CS0eAoQPDcBjopIA5+EcxEjLweRjXq0UbLIjcBxsGx2IZvlf0ATjz/6qypAmY7bhrk4ahsIis6ccXKHdueAfUgk+RWPCLh42c6zEeKyJpRTdRAOqBbl/Wq/uT+q+Fx3FoTIuCzc6+hN8j4veGjuAnhSE5gKnco3A3XwYlq2sq+lmP4yEOpqEoG0M+mGDYuYT0pKCFHgLHKt3T7T9p8GcWH+n1UwGa8X6kQt2x4CeqPexegT6o/Z4Cr313PHdgrsS2ZReLfpKIf+IMFnmVmwxQ9AhithYT73+p2s+JIVfrjwiHnpAZrSsr9CMstQXP1+1+510N/q8E/YoekMN9OMFvi5LvkRDsy9rgFCOoPdpgaQIWBZjf5KCSQszZJ1ivTvLokpen6tsJAVND0NFqb6GUGg2Im4Dyx9Pn7/0dm4pADAslJzTv+dKNrAPQ0wyySm7bj1RQgbAXsRa4R+mBJzpaQmHLmy0BLoL+Nh2ZRca8uUc6P37k97n451fvTieAE8BdZ2ItqFEK6oOJIYPsiU4woo140Oh+H/UC++gatHYcOFT+2y3AYvD1rM/fpxdUcsAi70c0OxAEP45X/hymE9XeoC0zfYhbcqfbhs09HpwnKMDR6g0mmYyKth/UcLl9ITGQ8N1S6s+gA1HvQCc2pluPvN2Br8SyZyfyxPP/VhCi1L1HWX2CQCuAE8TIq/sBYdANZmTIwqq0sb0HIzhhugBeUpBZLFyA8y+EErsBUYDZHYN9QAAooQwOws+uQlhdESSSqk5Qsh8LSYI6LDS1AbmOvLlRBqQIeITvM36+TP63VfE5hFClCTr9zEyVFwS3STQBy66DMHB+PJWIrfgGnYBx2dTboPa2X49GaBVlePA7CFx4iaGi4ns0aLVjMGvtPTDtmO4XEE8E5Kb/8qYai+NHl60LgAICcUCoJPVeiYG6Pxw/X9VFNVbFn9FNPzXoIRDTyzcpREYB5Fm1EQQn3KRi9wKApR8Tz48SwxnV3qM0q7ZhpdKvr0zfY+gO4oQf+EGPFYW/Xf5hwWsUgxiBbShGoGIx+D2eH1h2EeR3UQMH4zMaUKr4033nzkSkfQADelFbLOQCalxdxvN8mInhPas9bxtGJw29Fx3Y8429MAS0fL33Oeo7qFZeiToCC3B/VSNYuU0fgDnkhxGgMFdxiYEY7MYel+OHPH30IMeVFK1C79l+QdXVpFqHlMAXEf3EYDyfkkGdNvJ8f3RAXU0jpgM7jMNA5yCrtfzOicKG/M9bgEkEjqqPPDEcDfqVwGZv6zcO9avDfOhf4OmLFd9OLBHHdxp51HvOBlnAoQksYjASA1xnIhPsapTCPjbsGB2YevpPpgM73EYeSYIftgPgte6CWesVBB9QEgfnWYMgoeC8ql69bWoRIqYHvSIv/u26bj/jdqZ9KSGk74JRo6QS9PuTiSHm6Z62kLUGH0UO4rwWrhtRETkR4iKRdI8giJ2D2nUCMjsA0TXiVDb98NAf/rCMlajA9wesWHZrAe1dlwRyVI2jx4KkyUHSx7YDe6YD4tOC6XW01puEdAJwaEJzf1uATHi6ZlSCpBQscsh6C1xRcWEG4bCFeKcAVhVlDu54JQIkTT21hptIT/Afk0kMcS9BKfjBJozcDXCrtgbWXxbMAw3INQIxtQJPAGwXmYaBbYh4SCsuKwLOAQ5awKskCMmRg8P3xwlBfbosQaDqyZqBkyQe1CLQACoTgN4qbyHsPwkTiF2pYaj6MAXBmUosQHnUEYCsBL3MW39SNKMJ5PfoBsT33DVJCEbFnBCMOkHfvj6Xq8uw+dgRIhGgAiUqf5QgKDFyhe8nnYrlqn9sG1GoAfirubygX4H+8IM1CmQrMFAJ5ExzKIp54nPoVU2Auh6eBShDlTV4u5c4HE/fVvjFrsII0Ik6QX+Iq68jB19ziLoKC27FYe0gC+j1RSS+BgB7AvAM3m8HLdy5fV60C8RMVuhD1ieQB32MCCq0QPJuvuw5IHF/geMKwOPdpmsxBwVEfGEOgeincJqNmuSFIPhPq/xM81CWIIi+gCFBqDX3QPYd2OcCRo6GZBoA3AM+00aesAOQ7/2Pe/vBCXoguD4OBD1WfPwClzcui12AuH+gC0gEwW72KfjBCQRBr05D0IQc7N8PzOCMehPWK384MPVDJQim7yDdoiRTItzzFV/ZOX9sYFetP0fsQzb6O7wOoFjxk89YoQXv+BmSN+yYHYO+BsDRAXHhuJXsEFbdIEGZQWUkNVNzGA9NZUVBIQL7jASR0AclE4Pb7JN3BO72mG92+o8UG3nybj+mASh0FsLKn9GPxDrEcS2Au35BzHO1BksriIJdpqWjKR1wlpR4fN977rZqI+XbYjYDgVDpcYQalOYKMiuQbB3G6Pu/HlMbi9a0EMkksXtjvvXTfgMKAEZRN/i/O7yD8Da2S2Bdh3ICWfp8yuMkYl5a4df4vVWt4UF0yyqEnaT6swYyWB8/j111Y1ERS9oB0SLMtBGDEBD1PEHwtdjUEAHnqmoHU4wCDAoAS+lHwtu9eQLUAgmxVvAuMB9cELMV3m8EUtcBYYI9nkNIEEJYrQeUHfnzzRyC39j8CgSkir/E0P2odnAmAqDnDIhqrtV9BDNS2POjv/0pwKr6z1h/PMz3uf9ykFYq9TtoAXSwpz0HljdvBCVAPY6t7osv6gFhMpkX13rcfXQMIpuTsfTibkfOPRAC2meLRipI4mDPwMD5x+v3+Ey+qEfACwoUEkKQSMZxYJDz9R68PyP43yvo2aYf881rNQbZgRU/jp80QnW/hdXqJxMvCFxXQSNHpE8QiF4XI+wFfQcw7VL2Md7RRajsKgh2D+6SLAKPF356+/7yXYBTUgFy/38StUjFHweD+iiHh8/LV/i/TSvGk4L5x7F6AsIKbgb4C0YjgdGRIToGUx7cgS3JKP8pRcgak95BJGQbjaJdBYQ1qHYnYHL8F45QgHx2gLMQ2cDxBD/4SeR0LSDi5XzPQNjM4ySE/HGG6g+ugltLNSARn281BPtNO72eJLjdX4ITSEgpQvJYFEUg24f1qAYQNQdxx6Q/RcB85j9f+03zf2QV33IDPHegNgPABTfqFR8cZK9TA7/ll0EQbUUHW8Gr1d+MSadia+LRHwhunv87yWoJ3h/pRDwJAbDNQQFd2P2mH4kP/wDT/ZeN3CK3+ZjvgVpw4r20AMafb58j4N1UMknuj6iCx883PU9g2VHVH5JX2eEcPghSgRBCKPzK0Q3fknwPN0Hk0CyC0zBkz//7duEetgFjVtypASDI4CsknYJgYDhqsBxxy29+eyxrAZX75EEf8f+CkOcijMDDHx4ASYGGu8WHgPwpHJc0qOG8FgFTuVk0cRZVePFwHEIUEu8xSHoL5qWg4I7/HgOKXe2dcnu2SSdCGIDTA+AcxY1zYL6Q6AAFu+/1GvjKPSeEoJV3NiM4Dz9C6oWkEav+NWjPWXNOIkKgNTi2I8LeBgaZHJxqrC4oNXoB9pzzMws/OW3ghSyQJgjbygOVEDhoj4nHLld8HPD6UUMFVLIgKrTL7cFoBRLQgEdXIseZ2/HhFPKbk4d5tYWwwR0nIFQSD2P5gQhs6meVfB+Bkyz2fOIvX/zxqsSODuAGIOLtPNnmIPCrv6Kqvgz3q4tCwNl9lWYfnsdHj2HTgQw5IBHwULmfSu1jEV3gDFSxTBmqSEVqiYK2IkWcRiAkwV/cyW9YhqHXDw9dkNQAcO6HFNJT7oChfrPUYc3KY17zAd+evAwF2w5SCKLV4EuCEKsKfjBVWHu9Q9Arh4CoBqEMWYBsNX7YgKP/69uC3M7/mOOz232QT+ox4iCyJGEFP4oBHd+GVvXBwX35nqp7qeIbV6L6tdZub3ueJ+gBIKgC6S5gOQFxDoGr+Bv2nzqbknd7ph/EmXzO0o+kZdc/wqvQkAOUffVMzKtYgx5Vob1/+HAfCdzHSiXHenX35/2JTr3KZ9Ruj2lYiMhLIFoNyMq9hFroeYMTE0bSLbhb4l3YlFPa6hMd2jk8dmrDgdQCnC4/+ANFlYTB6ATlx2GDGXP1rvL+SnWHw+cJes5/rRWt4H2pw9GklD4uSMpwasIQiaYR92gIyFX5S8dtRZt/nCAH48VXW3hRE/HKOsGquj8EM85Q9cfeAV4XwNGAlmIFIwPYrfLKuxV476RRetzcdeAsRSZhiHizCKEIOHn3EMOWy5X4uIJnXX6sFiBFLaBm/THOQAkVJK9j6TKwiSDTBWpwHkSPQJX7U959uAkoaTUuug6oQCBz1Zlxm0OJSIoIw04M+7zCGuYiznCfHww9AN6Ir+HXA7lfn2oBSJ2FOOh8SzINfmcAyITq8JX/sOMPx6A9LeYtVfwgCBZhdu25OB9/XmWWNPUEPD5dUuJ68wd1AqD2+w1PI9KxE9BW5t3z/igdYGWiL7L+wPv9jgVY8f0ZcbCKCuLAHN+c5wa69Zpr0J9t2KnpAGzyiAIPiFalJ8/xXrrA6Y+/8NoDnWCPNwFJzf5DpVkHte8hx76P+HU1+HEytEeSEIzAsu5r6wPJGu6oLz8VrKofXLce+ywIHhNa/Dmw8LrptWXZ4NKZm4pr/QQ7Qk8ehMrPtAF7PQCD309QgRgRZMKgAbFREAfBBXNalbHA9cEHMo4IgIUuPjjBWEUFEQpYTkhVO43eRiynJw9Jjj8TOUIlJExK+0wA4gWgQvcFBHAc7P4/u78/Ff4CC5ATB3P3oUwFClYgcALcxzp/B9Ez4DUV8RjBbsCBrMH4dLNwIDaCGhA6o3pXksdBvYBsktrXDgNJKAFy1Z+ZGIy5NXgXoBT8a3ZgVSPIUAMV6DjLxhsV8wX4n4ibbONObHNyCr8Z4FinNFjg8ziiF5zSV8A99u7Zdf5OisvVaAAAG3VJREFU/kIPAJLWX3hUIFD6o7MD4WkHIMXBk4IftSrPNBJVk0OoC7ice8HGS8XBKDoz/YFBLaQi392lGpCMJfhD9xVkx5Xbj73P9V4m1j0v73x9FjDDPlYvATkgFAVWcdNvJBamliOjAwRV0EpeRymAe717kMYRyy/j5FwFBX0fP7Dyx8gq8wn2ZXi8GfGYR+lFcGJSxa3Y84WgzBHetlU4cvKY44Ps4iP9fsgsPGEhQTAcHqwwGCj61SoPexKwasXFqtxq8qhD9SixoBBYcJEDNzmIoi3J7QkoJActVHocTVpPBCDhElAvMDK1PT/Sq3DwB/ygmyB9GNhYDH4so4Foy48kkPtZfZEv1PQTxYpyX0EI3Bu+/5krcN8fgwVdwWu2JNVNWAk+PcOOPMNdGFyAZ5Aj6gicgzNfwuHZg0HrLxBWfjSRl88fVCo/apX/IBrIvf65ZxtEoK9Bec4KZIPLe76osQns46NwW0pUPCPAyMc4A/KXOwZzFLGbAqD5xhhbgBcWfoJBAlarcCSQgdQJ+Movnih4gjZQTw51rz588y/ZgxVUEAQ8soCfX8OR26JwujCLGFAMsOjnwGrlPuQw9D/PPv8BYVR7pG/eeFtQpsLzR2KFI8SwKj9KlX++HeLOPuSBKrKeHBi7L4b+Kx184+ptAp4Trcscv69oARVYzWgaK01H1X0K3zNSmARKtxXYHvwJuT+8gLGGWgpHcWOmBeljFB2Ckg6wiAYOqfxEK3GMCAj6kIiTWdCBCXhkjUKMgJcLk271N9uLSbtvvK0S69OXAvoA5z94VsFubbmZvx4QAnXgBnJxENyQjy38wef81uPhxMpPJIQzr5ckuUTKe0wZyN57iFTWga8GvCwlh5UqvYgmaNV9XSxEVWs40kkosFwA70RgNOu8mLZfR6wDiwRa35y7j08NksqPQhcfkRBK/J8R75Iz+9C8gJpqzwiIeZII3QnYOkJWbVEI5jNuA+o2BwK82ifwnpSgHwaC+GNAdmW2VXfC+vPu6wR6lBj84C9WfvivZyUhZMJlJhjSukDlFJ3g4AvGJfC1iEpQJ/CaEd7G9wds7p71+odruKrHip/C7RdsxeVjzIxhoNkFGOW/+sk/YVAGtltfzZAIfzix8gcHhZCXpcGN2u69qWqD9OlRFAy7x2fQBhHUiETB+DocqvArYt98f+AEAXApsEmEcNLC0t2uPHCqPQIXwHYDfI4/9+8LMpchqr5HK39MJSrBXwnutNqjovjHFdq+fcHLp7YLR4mGgduW5hFpAXUoL4cTTuW5HJSkB5PC0S7A+8c+837DyoM1J9iv/po/o3BunlDqPjOSO/YbLFd+FGy9sxKFeT8b+nLNPrkAyD53FtT27yUS32yqUaEGTMBiASGcZ0FmK8nWxbvjC1q6WQC4VdWdAcBY8eFoAzIrC0b7Wt8wlPcIdE1FhUWeKU1Igv8Q/0dl4k/NnYSxdlDon8diUDeuQB4c8XVzcahRgyyZmNC+LAgeCfSVALde8/t1DCYawNoePGT83wlOpFUdOZKwxn89OsMEf0X8CxJCBN/dwKbFwkSMgx0ACJJDJD4iC1JEYh6XcEqVHpx4+J4I4UiAl26r5x64sttvSlAn3LBuQCz6edU8C+J5epBrC4YP52EFDgHrCw1B0eU9bOaTgh3wmYvQV3Oqqcf53XnVNXUBELX1xtSgFrirlII5d3HFulxBCNEfZx0h7K2f34XwdHpuYQcguN189Ow/nPXclaUcqMH5leCXjKOjbv3F0a7i2ZaRHmBe5zwnhA9S736ZC8AH8LHkg/T5znYgmES1dtuzGo92qwHIquiWX+4KgVLd8utv9Ml1BQNhEJW/FOgweiTguCUoQHkEwYhjfQIgm8eAzPKzHqAG5xGiiPyxeGRRaYetUpDVpHVC1T9bHGyaknb/TQTnuG7rDYwYCUT7/cMjtILzA+Go/FPw581F/mWeTkDuBsBCAK8ki+A29nMzPn4Rzjv6QV7xWW4fzQFUxb9jQQ1qc28kMi4mDl1NBr4usIsz5ltZqNm7AeJXfuTHd7nioLEyPBISU+8/tP1AC4Il/n+YGmjg2NiBRdl6yCw//zG5ph7bqaBuz8B4VMU/TqSsNPbwCeZA1cdxyG9SgKzRZPL+GXFOiH1/SFZ9wX8M3zUgvH8a4rMBjZj/h1W9MrwTiN6MlsCKiI4gycBzgV/xUaQGjGDHwHiYi0VIzeEAasCpNuL76AC7BIEl7i4AIxnAfoMxk35eJbZ68wWEUChs8IPz/EEE9BkUoNA4RCWSLJkY1h0Y/dG9bVCtUVPe7QRhtStXG4nOECDfUxc4Uw/Ik8JkA9o9+a83IrfHH11EdFUWc4phNgVFWkPsIHBnCvCCYBSgqEN9qtoXuwHhByYoJJA7BxIkkRwpDGgAHo+vQ3ZGOwCFJCJKUAx4MBpFZWvReeLgtBBkDDQu2OJxXa7SE/P4ZiUPHABjY1DsFIhPAaygWewiXK72hHjow/k8gCL6gKES8qcDZ7A+EhYlWCPGCX1wXIwzkQEKt8cP6iqkC0FEhFj/ZYtvXCtwuBLcDT5wXN+9H6ZEIkTwV/x/s78fXFX3siWHEKrC3tw7EFZ31Ll7ttknQyEMGgAqCaVe1bGk8r8nFWCQQR0h7CY0dsU/mIeIuA1AGCo02Q0YVXxub36sG1Qgfo0CBBUXxap+ECFEycQVyViBEBFPt14TK9rZHB9EwMG7DPXOv0OVHkdtx7OSCXfb3av4CFZGTwQBwT7/hKPHE4PzpJ4L4+FM9r1n8B+B+9R9I4Fu9brYUZgCunZWNxdQgIs8mASBQ4F8hJpEiaf4GPihk8FdAxin/kybjZjTj+mAQy6ihZ9whDvHAWB6BKrBXQr+5SBfqPaINwiz12UIwoTmbPACZY/fshBBBKNlW8ZCHwH/cVKSOZMm4Mxk4OwE9JeB+EFkn1IzcPQoiSB4vGgNeJSoik1A7m0TCmE/HrggB+/1M12C1Z18ACGoIeH1pH2IhAqFWgBq+kDFEWAvA3X8tpW0cnSD5WAOriOHhnYraF1eLTkS8P/QsHUBdtMPnOrMaANJE9AZiaKWII5Ue/8PTHn/UcCSTgIF2xN4zdmAQYIAKeBFl6FiO0aKfq5jcImHfPwTxcEdRmD3LcFoAva1Hdjm9UgGggI9YOoPkOBYLsT8HlG3nucMDGkOOJ8CkNOELdSO7D5qqAeJYBb2GpABgRi2gxLITgrOQ9C937HgB+0i7MeRx3gfPWCXLtgbLJAu/gCFBPzRX8eADJqCvA3FViC/BlOQC4LZyrBq8BdQAOUKoKjqR7v7EFfVFMojPgEoSlJesNIePyLHwW9NRgq7E6HvUN8A0yj0wyWDHRZ3J2A1jHdMyu3hCGwSDwdRir7h9VP7AKLgPoMCgKziOFLtrUm8aIFHlgxYfz8WBYUU55iAXauo+evJaIK/NTgRJM9sUcZRzcCnMdNKMJc7usnAyrpxHYkTRHK+n1HxS01LheAHqRWwKIDqLvQC0+PupHZgBawfVGsiniTVHwZHRqbUI/D4Cd+ftgyLAR1ehkIiqaKFw7MJEwUIuK5zsu4svoFYCFKgBJZACBuppOId2RDkPZas8H9kULcA9a0KTCQDGtpnzT+RMJiOGseHl4BQ1C29AWUXIIf/OIwwqoNEK3SCuA7FRiBrE9B4/PcrGJ1OQNj83F4Xbol/TgVHfMiIZLAdcaVkgh8sLrd+liNQH/FqsNTfj15m1J0X+ffZuq/gTY7QnvIfJz6UzBJLs83ItQpt3RfZz5iuGfNPajpngUm0R8DoA5jDlzsOTAwZjzsC3Jjxg7H914PjlcskGdghgx9HG4OOQH34uwQyzz61/0qiYNQjXxECuWYbGM/DrjtPH/Mw/K+gBLLSA+cEfPr4MroArzcDuybbr8Zc72i2UnzeHnTgzD4Ug78SzIvCoARVOQxaFFR3TzWnkkHUVFShEuqKxZnKz4p4YYcf8ZhYhuu8wFgSHcuuwCJagI4bgchJQK/qe9c/RT6nGcg6KGREJpb+MI0EY/b0jcsni3AJBeCQNsBOFVYoApcM2Aom4VFgIRdHpeIG8D3YaxBD+qCiQ+rBOSVnci8hzkAG1t/pgHA4uwDzmu8xFKkkkIqCfkIRs204r/hiDgutoAAcowBMZ9+KS0CcXVBOHCvJw2jMQSJyeoeExF2DuTuRcuWAo9sefyUQ6/oBaIjPtiRH1KvQKvygAHb171d+vc4GRMDPoxN/kL5pwlVh1mBQ1quQJAJ5j0TgOAis+h8d3mnC8xTKE34+8sDNjyVXE6nFMN+H39TQDmocHScENvN74LoGScGU4f7g6IG3n3C3qnG6JBS+Z5tHOOzRYQx+u7MZmAl0OSsRLAS/VIKfRAWU92+12aaVPksGDBWQuCMvgNy2M2Mt8EwqbjosZAec5xLEAmXmcFTHiOWARWglpNpjdEtBQRxJJU5VL5/7F1X86XntXgUK4q+KggsUoIIK8oA+kgy4+zLaACqQGTVOX6MBWdehL6BxHn+tlyBMDGAqufd7WOX5WTJwKYDfXJJP2GXDPk7Tj5Ed7BOG7DMFaBRAJgI/+H2Ngeb2SKb0zkoGlQBHkefDr7xMA5HZeJPtKIzyApI9gmnPgf1c3mulfhe0gFekDCdNFnrOwi4Gs6eTACNjB+Uegcgojog4V25P8bctRYY6RL8AJklE9ACFAGZdBEahd4d4CmghFhbzcwaXYH5qTlS6DY+KfNH5Avzjo2JJ0poDkSCMxLn73H/eB+ifvgvyIFCWAji7BWC8hd0qj0FziMdrS70BlVbgamIgcmotGZDNPwm0L9l5iHv7WRoAFx57ScFS2r2iwot8oKu8l+TOCOg2mZ2nFdjTgOFQENzKkJ8OjEnsE8f6AzyXwT6MNF3RDRnuj0Lwo6wTlBMDIyqaz6G+RiLJMg/KUrQV/rh9uH0tWduwoxmky0kSMQ+rnXxZsGadgnxfgk1pCnsIsGYltvfdzTOBIclIsN8MLAGcz5gBwj94AE8DuC9Molip/JGwB57nRyJiyD3pyk6q5ij+3TzRLohcqyqCEQBTepF15+WVmW8SEr5jMUUkx3oMIsrH3ndwAQganKzyMpOJNxMQooGBYwcByw7axIhgPRGEr6GSGJhkAELoQ1YRg+dPeD5IIRDIqq5PA2Jh0Rq0YcS8XBi0ghGRFpCtWTdum5+yLOsQf2EuYY8AfnbQZDgCjHxBSKwTGpt8QCIDVH3/4H5OwEvldhliINwAFLsEyyIfGKV+vm3eEehVqKTdNxtDiPoLHCRiuwTJxCECxMDqDjTvZ63KaPKvRgV2i/F3ohm88V8LN8hgJcXD5pVGIPPNn9EBqSQC0I4AMxBUcQNCkarkFgSn/oCs9GCVep4eUG5BRAOcQOCWlGSc3If0IFqRfURQGRrKewPKEJ9sLnIowKCcw+f48N6UHjqYtgInaCCkBbPSj8VEkCr2g8U43wY1xX/BNkwreQrzg+oaJghOCGTU8RBxuIp6VFOGoEXgEsBLIgV6gBgxoLSI5CgiYNT+GBHsU01GthrceiMUtv9KgAYktgVNeGrBbtiOQVi9x8WjiAW7UNUnm4Vet7WtsFgDCDYEwQ/EVL1PnQf/xCDLTowTh4c4HPRDoQaiwhKIAae4B7xgCBydI/CDPOrevK0FR4p6w3VfoXgQiB3T1N8Y1PCD0X19JqcHGfzB5WkQE4p/kdeXBcEVUXEIFqSij82lMyrWq/7c+LFHA7z5/dwOHHg8s/Y8C2CmhbmALtare+4UWLfb25BmXABKABTniC8gRAP2yvDAiUAsElnrxFzITQa/sAFecAOY7zPV/8jMQHSbWAiUPGkQNABhw85xrSCv+mMSzFR8+7mjw01A8f4F8S/td4jnDHYxpT8/OEyV3gz2+GTfdAeAszswfJNGlQhEIjB0Bls0BKn4Iw7WKu9f1gmSagmvqleEwJwnZwjO7npz1HdCJ1hS/mlBcRXyF3i/M7NxqJFoeH27z7nnJaBmpUZKHsTbGUc1ALEoIGsGYl9ixS50gjAT/VhB8IzvGTrBVfWEz1MzAkRFTtecW731VdjNQPukVdhdn0Y8d/a7WYH6i/TBPBzUFwAlHwtGHOQISrgb1AMUgDETTA3+THAdeRJhg59V/Ektofa9I8wxVICkC7QQSAd2O3cftzPzdMK6aA4iZI4ILfYRbb9RgqICt2AxVnYZ4kkBvHOBxT/zN9ybHx/f5Ql2fkGCX6ANm6F8WCfqAS+Eq5AGcHJd2IFHagTMHAAj+mWBnDXuc81CjhsAi5dL2K8QCYI1aJ/PJtSSxEFXASv7C2I3ZB9/a0j/7nDn/j1pHsz9Jr8fNpxPBUAUUYD4wz5GBlmyAiORjtAIGDFwzSUwqiNZ1d1tPiB7/Q9VeI9KeJU16/knkEeQJEALjY4rkp74fCZiMDSA/PgvT/aT2gYgp5E/P29AKBQAo6TRth5T4VesQFb0i4K7RA2MZpgyFXCEQHCOixuYMPgy2L7+45ezSSKt2oUkURlpXkEMOLSiXPuDQZjk63N5bmzOSxQdLHX7AhwUEA0BAeQPJIQzkAuFlOK/GtyLdiGDKEBdllQ7YouxV2Xdwza9So4Kp5Z0yAgUhTlJgFzSFrznIHYIwKcCu2/L3LsCg6UI1b1/CA+ApIV5/32HqOIjdQusE4azip5Wc1b0q/QGIAlaWEJbXP3r/L+AEipw/+BtkQVY9fIM2i/ZhgVEgJO6DZ1ksVtlYdoQAPhVO0oKmYBmnAYco4DRCRB3TwCziptaE0auER9/VzRqKNOEYINOQg2m1l9GpGNQAhh1v6UmxNQh2M4+LmlUzll0OTjYQOaGlZAEMCrdhmBphaMBwBADrSQQc3//He8KgFETT7p6BHnjj2X9EXsDjrgBS6ihoAmcSQVYmE4JgYWFpp1waAQRoqDzxDhU+HxSnZHz/9JEY6Y5MJA+cwoWrt99+U3Mc/9g/NQTFaigAEtwB1yBzwzucZSX7RZEILhR1d5GDCsBLVUdIQvsldZfEJt5i/MHx2hGJZFkVVyK242iFeh58oBUFqIQbkfp2DV2X0CkAYgv1sU+P+I/HmBu8nErugdRnUWhfp+A/ddlbEH3uQlBsNobUEMHasK1HOYn8BEEvCUaiuigXRIKj+sGOPA4KAWz9/s7WxcgB4+a6/fI2osEwv4yOENAiPf+wQhbc/5f0gGisWuQaRFmGoIqguARWsBQgTTocDLMT5OJUQnhqdCEig+/EShKSEgTVV0MBMnz04BcshPnLk/+OaV0/dwKzB4QUt1NB6uTDfGOP+cNm9mEsBAFiM7AQh9AKVEU75vy68jeOxrUC4mDEuYO0oLqoSdHaEF2eXYYSm0V+oEOwpLmYFOF3Z4CmAeBTIGueiIw2xoKPzDBJVBXQ5g5O8/twwA+QguIjJt3+g0NQEcDfUXgO5gsqlTBLkQLdl86K3CWneitQ8sg/5oWAUJP2C3V3RoEyji5n4b9lB4t9pz2CA+cAFn1Z9I/uzYsU/ELtEBOCHYQQqGcFejV+yeuRJX31zsKV5IGjway9z6PLDxKwNEPsBuOEiqw57jGgOtZ1Y++T50AuMFl7hPIbhskiOwsATtRoc7rS7dXrpcgrMCGJca6ELJo+Y0be0BW5ZKGcFz4y8W9BduwcDnK9iO5fagsKpp9ANnvDPxeP8THNyIVFo1AMas8Qk5v2Ytm0LCCYAXqn+wQsPTBh/5Bcnne14Os3uCQt28vsK1WUESJFviBgAW//3u9PLxusXchcCR2WsNzv/ImvgZzzkUByDUAIrjTvmSHAowpJBQE4SUlxMxnARlQbIqkArVAJ6pBBvELCCKlkyCDAP45BYfEPfcUpfMch3Vn4bheYK4E66BxAxHSVd5INgEPgU/NBCDfNQ8Ho1CoINAPQAW/QT8OCIZlNFCB84XhoDChFByHGjx35v9BLgyhmojqHYb5QYXnuAecvua0hZe6BV9f7v4ibvgvamrmAc1TmaEir0LQ9h97eYAYVoM/nWA60i8Q3Ifezha9BqaaL3zvqd6IAuwwLSCCuCLuJWch4h30giPtyiAphKEBcCu9BV5wwzkMxID8rhMwdwMhcSFgrBT3RUTQboAUg3+p+Qe1IGarOioVnazmefV3lHpwA0AcLWCahUiXwePHWJsP+GH1gnp/we5KfOhJAbsj0H/BIEb04TbrTPsAyb2LLu93KwfCvn5PLAwrOXAa72eEQRo1CNdw5IprsAZ3hApy9zlcITG2vpCihsRSYxNS+J4vdBZ6B52eqRcQ/QXmSjAWSfa/5GA5qEg4iJFtm624AqXLrSA2gx8p1Mdqcghv41S0lSp/xAYs9gakQc4Ie2RTUYwYgt748mV+FU1Xgp14eW3XYZ6cdqGTNHwHICTwEeTPl0jEZwIgP9gDEaogeg5IHWCF+1eoAhvEKPB/EAeTRsM/pSAP5wjWEUMM1/NJRhwJbpJSgK7S7zF3EOsI5jBQBK9DV80Z8Y0COzvmWzJXgDl40KEC6cqvqgi4OB5cpgLFYK/1CvDiItXqC6/S87wfAUfPtxqfGNzlYaOjlf1IsHPPvffHgDAoEeEST4ZLZUd/RSo91/BjXY5ggWgQ4In3fyj4mUqPrInHOCLKO3wUwRsfyXpt1nEIRLrqcWeTuk7bigsbid1zD4iDRQtnIdQsyIXnFCn1I9D7ADgxEhOvR5AJosoUbu1FkJyYCi9OhQERoIx+4AX/YqUXQhtYEwKN4Cy1HntLMmtaAQpqfrT/UCoLSxeswjA5UWPPi0mjajUWxMTdVusNvt/ChMdmILK5IRMFu90BMEzFYHdg2GAgeYVHMMJIBTA7EFTx/5fpgTFXz9w/en0ZjD8kCDoKPNGwlB01BmoWQbh+AxR689mBponGJOr9OwmMu3dtJ/ylW1Tik4ElUPmR9RqII+pVhD9ychABMQ51gOIZg+/G+5mGIzLB1JJC5WhzYjhJ7IWmLDpA8jzsAafUPkB2WnFBF4iSxkq1ty7f25rv/+EQLOxs2oUdTSA9HIR9swdBlCcFe9owPC3XWDDC0ISVzsEVbSCF/sWdA5Fu4HJqankp2SeQCYYrImNalfmhpVxYrGkUS4LeSUjg8dD7+D7w/ybIfy7vlB9/HJ978zr7/45Qgajzj+4EjIK/ULHPRAOlKr/aG0AFcqCyu0GcW45Igh6JMJmhA49/U+cEssHNJhtXDC1MOya3j/sAiAGcrEtqtgjBD6wEzSDc7D8o6C8rIqAZyPk+NQoNLAZ1hR64Yl1FBY648smUYKnSg1Xwk/0DyRyArByMUobyByhCcPnOaPyoegREFS4jNfYAw+IHCjdC1J2WDZBke/OyN85J24WiXwDYPoJyYuCD238ulvuzwt6KgHf0shWKsqCFFGjB/w8HU8eeTED9wAAAAABJRU5ErkJggg==";let VH=0;const kS=n=>{if(!n.environmentBRDFTexture){const e=n.useDelayedTextureLoading;n.useDelayedTextureLoading=!1;const t=n._blockEntityCollection;n._blockEntityCollection=!1;const i=re.CreateFromBase64String(zH,"EnvironmentBRDFTexture"+VH++,n,!0,!1,re.BILINEAR_SAMPLINGMODE);n._blockEntityCollection=t;const r=n.getEngine().getLoadedTexturesCache(),s=r.indexOf(i.getInternalTexture());s!==-1&&r.splice(s,1),i.isRGBD=!0,i.wrapU=re.CLAMP_ADDRESSMODE,i.wrapV=re.CLAMP_ADDRESSMODE,n.environmentBRDFTexture=i,n.useDelayedTextureLoading=e,DT.ExpandRGBDTexture(i);const a=n.getEngine().onContextRestoredObservable.add(()=>{i.isRGBD=!0;const l=n.onBeforeRenderObservable.add(()=>{i.isReady()&&(n.onBeforeRenderObservable.remove(l),DT.ExpandRGBDTexture(i))})});n.onDisposeObservable.add(()=>{n.getEngine().onContextRestoredObservable.remove(a)})}return n.environmentBRDFTexture};class GH extends Ws{constructor(){super(...arguments),this.BRDF_V_HEIGHT_CORRELATED=!1,this.MS_BRDF_ENERGY_CONSERVATION=!1,this.SPHERICAL_HARMONICS=!1,this.SPECULAR_GLOSSINESS_ENERGY_CONSERVATION=!1}}class ar extends Gn{_markAllSubMeshesAsMiscDirty(){this._internalMarkAllSubMeshesAsMiscDirty()}constructor(e,t=!0){super(e,"PBRBRDF",90,new GH,t),this._useEnergyConservation=ar.DEFAULT_USE_ENERGY_CONSERVATION,this.useEnergyConservation=ar.DEFAULT_USE_ENERGY_CONSERVATION,this._useSmithVisibilityHeightCorrelated=ar.DEFAULT_USE_SMITH_VISIBILITY_HEIGHT_CORRELATED,this.useSmithVisibilityHeightCorrelated=ar.DEFAULT_USE_SMITH_VISIBILITY_HEIGHT_CORRELATED,this._useSphericalHarmonics=ar.DEFAULT_USE_SPHERICAL_HARMONICS,this.useSphericalHarmonics=ar.DEFAULT_USE_SPHERICAL_HARMONICS,this._useSpecularGlossinessInputEnergyConservation=ar.DEFAULT_USE_SPECULAR_GLOSSINESS_INPUT_ENERGY_CONSERVATION,this.useSpecularGlossinessInputEnergyConservation=ar.DEFAULT_USE_SPECULAR_GLOSSINESS_INPUT_ENERGY_CONSERVATION,this._internalMarkAllSubMeshesAsMiscDirty=e._dirtyCallbacks[16],this._enable(!0)}prepareDefines(e){e.BRDF_V_HEIGHT_CORRELATED=this._useSmithVisibilityHeightCorrelated,e.MS_BRDF_ENERGY_CONSERVATION=this._useEnergyConservation&&this._useSmithVisibilityHeightCorrelated,e.SPHERICAL_HARMONICS=this._useSphericalHarmonics,e.SPECULAR_GLOSSINESS_ENERGY_CONSERVATION=this._useSpecularGlossinessInputEnergyConservation}getClassName(){return"PBRBRDFConfiguration"}}ar.DEFAULT_USE_ENERGY_CONSERVATION=!0;ar.DEFAULT_USE_SMITH_VISIBILITY_HEIGHT_CORRELATED=!0;ar.DEFAULT_USE_SPHERICAL_HARMONICS=!0;ar.DEFAULT_USE_SPECULAR_GLOSSINESS_INPUT_ENERGY_CONSERVATION=!0;R([I(),ie("_markAllSubMeshesAsMiscDirty")],ar.prototype,"useEnergyConservation",void 0);R([I(),ie("_markAllSubMeshesAsMiscDirty")],ar.prototype,"useSmithVisibilityHeightCorrelated",void 0);R([I(),ie("_markAllSubMeshesAsMiscDirty")],ar.prototype,"useSphericalHarmonics",void 0);R([I(),ie("_markAllSubMeshesAsMiscDirty")],ar.prototype,"useSpecularGlossinessInputEnergyConservation",void 0);class al{constructor(e,t,i,r){this.name=e,this.worldAxisForNormal=t,this.worldAxisForFileX=i,this.worldAxisForFileY=r}}class C_{static ConvertCubeMapTextureToSphericalPolynomial(e){var d;if(!e.isCube)return null;(d=e.getScene())==null||d.getEngine().flushFramebuffer();const t=e.getSize().width,i=e.readPixels(0,void 0,void 0,!1),r=e.readPixels(1,void 0,void 0,!1);let s,a;e.isRenderTarget?(s=e.readPixels(3,void 0,void 0,!1),a=e.readPixels(2,void 0,void 0,!1)):(s=e.readPixels(2,void 0,void 0,!1),a=e.readPixels(3,void 0,void 0,!1));const l=e.readPixels(4,void 0,void 0,!1),o=e.readPixels(5,void 0,void 0,!1),c=e.gammaSpace,u=5;let h=0;return(e.textureType==1||e.textureType==2)&&(h=1),new Promise(f=>{Promise.all([r,i,s,a,l,o]).then(([_,p,v,E,g,m])=>{const y={size:t,right:p,left:_,up:v,down:E,front:g,back:m,format:u,type:h,gammaSpace:c};f(this.ConvertCubeMapToSphericalPolynomial(y))})})}static _AreaElement(e,t){return Math.atan2(e*t,Math.sqrt(e*e+t*t+1))}static ConvertCubeMapToSphericalPolynomial(e){const t=new Pu;let i=0;const r=2/e.size,s=r,a=.5*r,l=a-1;for(let d=0;d<6;d++){const f=this._FileFaces[d],_=e[f.name];let p=l;const v=e.format===5?4:3;for(let E=0;E<e.size;E++){let g=l;for(let m=0;m<e.size;m++){const y=f.worldAxisForFileX.scale(g).add(f.worldAxisForFileY.scale(p)).add(f.worldAxisForNormal);y.normalize();const T=this._AreaElement(g-a,p-a)-this._AreaElement(g-a,p+a)-this._AreaElement(g+a,p-a)+this._AreaElement(g+a,p+a);let b=_[E*e.size*v+m*v+0],C=_[E*e.size*v+m*v+1],M=_[E*e.size*v+m*v+2];isNaN(b)&&(b=0),isNaN(C)&&(C=0),isNaN(M)&&(M=0),e.type===0&&(b/=255,C/=255,M/=255),e.gammaSpace&&(b=Math.pow(dt.Clamp(b),Lh),C=Math.pow(dt.Clamp(C),Lh),M=Math.pow(dt.Clamp(M),Lh));const F=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const U=Math.max(b,C,M);if(U>F){const G=F/U;b*=G,C*=G,M*=G}}else b=dt.Clamp(b,0,F),C=dt.Clamp(C,0,F),M=dt.Clamp(M,0,F);const P=new Pe(b,C,M);t.addLight(y,P,T),i+=T,g+=r}p+=s}}const h=4*Math.PI*6/6/i;return t.scaleInPlace(h),t.convertIncidentRadianceToIrradiance(),t.convertIrradianceToLambertianRadiance(),zd.FromHarmonics(t)}}C_._FileFaces=[new al("right",new A(1,0,0),new A(0,0,-1),new A(0,-1,0)),new al("left",new A(-1,0,0),new A(0,0,1),new A(0,-1,0)),new al("up",new A(0,1,0),new A(1,0,0),new A(0,0,1)),new al("down",new A(0,-1,0),new A(1,0,0),new A(0,0,-1)),new al("front",new A(0,0,1),new A(1,0,0),new A(0,-1,0)),new al("back",new A(0,0,-1),new A(-1,0,0),new A(0,-1,0))];C_.MAX_HDRI_VALUE=4096;C_.PRESERVE_CLAMPED_COLORS=!1;zt.prototype.forceSphericalPolynomialsRecompute=function(){this._texture&&(this._texture._sphericalPolynomial=null,this._texture._sphericalPolynomialPromise=null,this._texture._sphericalPolynomialComputed=!1)};Object.defineProperty(zt.prototype,"sphericalPolynomial",{get:function(){if(this._texture){if(this._texture._sphericalPolynomial||this._texture._sphericalPolynomialComputed)return this._texture._sphericalPolynomial;if(this._texture.isReady)return this._texture._sphericalPolynomialPromise||(this._texture._sphericalPolynomialPromise=C_.ConvertCubeMapTextureToSphericalPolynomial(this),this._texture._sphericalPolynomialPromise===null?this._texture._sphericalPolynomialComputed=!0:this._texture._sphericalPolynomialPromise.then(n=>{this._texture._sphericalPolynomial=n,this._texture._sphericalPolynomialComputed=!0})),null}return null},set:function(n){this._texture&&(this._texture._sphericalPolynomial=n)},enumerable:!0,configurable:!0});const WH="pbrFragmentDeclaration",HH=`uniform vec4 vEyePosition;uniform vec3 vReflectionColor;uniform vec4 vAlbedoColor;uniform vec4 vLightingIntensity;uniform vec4 vReflectivityColor;uniform vec4 vMetallicReflectanceFactors;uniform vec3 vEmissiveColor;uniform float visibility;uniform vec3 vAmbientColor;
#ifdef ALBEDO
uniform vec2 vAlbedoInfos;
#endif
#ifdef AMBIENT
uniform vec4 vAmbientInfos;
#endif
#ifdef BUMP
uniform vec3 vBumpInfos;uniform vec2 vTangentSpaceParams;
#endif
#ifdef OPACITY
uniform vec2 vOpacityInfos;
#endif
#ifdef EMISSIVE
uniform vec2 vEmissiveInfos;
#endif
#ifdef LIGHTMAP
uniform vec2 vLightmapInfos;
#endif
#ifdef REFLECTIVITY
uniform vec3 vReflectivityInfos;
#endif
#ifdef MICROSURFACEMAP
uniform vec2 vMicroSurfaceSamplerInfos;
#endif
#if defined(REFLECTIONMAP_SPHERICAL) || defined(REFLECTIONMAP_PROJECTION) || defined(SS_REFRACTION) || defined(PREPASS)
uniform mat4 view;
#endif
#ifdef REFLECTION
uniform vec2 vReflectionInfos;
#ifdef REALTIME_FILTERING
uniform vec2 vReflectionFilteringInfo;
#endif
uniform mat4 reflectionMatrix;uniform vec3 vReflectionMicrosurfaceInfos;
#if defined(USE_LOCAL_REFLECTIONMAP_CUBIC) && defined(REFLECTIONMAP_CUBIC)
uniform vec3 vReflectionPosition;uniform vec3 vReflectionSize; 
#endif
#endif
#if defined(SS_REFRACTION) && defined(SS_USE_LOCAL_REFRACTIONMAP_CUBIC)
uniform vec3 vRefractionPosition;uniform vec3 vRefractionSize; 
#endif
#ifdef CLEARCOAT
uniform vec2 vClearCoatParams;uniform vec4 vClearCoatRefractionParams;
#if defined(CLEARCOAT_TEXTURE) || defined(CLEARCOAT_TEXTURE_ROUGHNESS)
uniform vec4 vClearCoatInfos;
#endif
#ifdef CLEARCOAT_TEXTURE
uniform mat4 clearCoatMatrix;
#endif
#ifdef CLEARCOAT_TEXTURE_ROUGHNESS
uniform mat4 clearCoatRoughnessMatrix;
#endif
#ifdef CLEARCOAT_BUMP
uniform vec2 vClearCoatBumpInfos;uniform vec2 vClearCoatTangentSpaceParams;uniform mat4 clearCoatBumpMatrix;
#endif
#ifdef CLEARCOAT_TINT
uniform vec4 vClearCoatTintParams;uniform float clearCoatColorAtDistance;
#ifdef CLEARCOAT_TINT_TEXTURE
uniform vec2 vClearCoatTintInfos;uniform mat4 clearCoatTintMatrix;
#endif
#endif
#endif
#ifdef IRIDESCENCE
uniform vec4 vIridescenceParams;
#if defined(IRIDESCENCE_TEXTURE) || defined(IRIDESCENCE_THICKNESS_TEXTURE)
uniform vec4 vIridescenceInfos;
#endif
#ifdef IRIDESCENCE_TEXTURE
uniform mat4 iridescenceMatrix;
#endif
#ifdef IRIDESCENCE_THICKNESS_TEXTURE
uniform mat4 iridescenceThicknessMatrix;
#endif
#endif
#ifdef ANISOTROPIC
uniform vec3 vAnisotropy;
#ifdef ANISOTROPIC_TEXTURE
uniform vec2 vAnisotropyInfos;uniform mat4 anisotropyMatrix;
#endif
#endif
#ifdef SHEEN
uniform vec4 vSheenColor;
#ifdef SHEEN_ROUGHNESS
uniform float vSheenRoughness;
#endif
#if defined(SHEEN_TEXTURE) || defined(SHEEN_TEXTURE_ROUGHNESS)
uniform vec4 vSheenInfos;
#endif
#ifdef SHEEN_TEXTURE
uniform mat4 sheenMatrix;
#endif
#ifdef SHEEN_TEXTURE_ROUGHNESS
uniform mat4 sheenRoughnessMatrix;
#endif
#endif
#ifdef SUBSURFACE
#ifdef SS_REFRACTION
uniform vec4 vRefractionMicrosurfaceInfos;uniform vec4 vRefractionInfos;uniform mat4 refractionMatrix;
#ifdef REALTIME_FILTERING
uniform vec2 vRefractionFilteringInfo;
#endif
#ifdef SS_DISPERSION
uniform float dispersion;
#endif
#endif
#ifdef SS_THICKNESSANDMASK_TEXTURE
uniform vec2 vThicknessInfos;uniform mat4 thicknessMatrix;
#endif
#ifdef SS_REFRACTIONINTENSITY_TEXTURE
uniform vec2 vRefractionIntensityInfos;uniform mat4 refractionIntensityMatrix;
#endif
#ifdef SS_TRANSLUCENCYINTENSITY_TEXTURE
uniform vec2 vTranslucencyIntensityInfos;uniform mat4 translucencyIntensityMatrix;
#endif
uniform vec2 vThicknessParam;uniform vec3 vDiffusionDistance;uniform vec4 vTintColor;uniform vec3 vSubSurfaceIntensity;
#endif
#ifdef PREPASS
#ifdef SS_SCATTERING
uniform float scatteringDiffusionProfile;
#endif
#endif
#if DEBUGMODE>0
uniform vec2 vDebugMode;
#endif
#ifdef DETAIL
uniform vec4 vDetailInfos;
#endif
#include<decalFragmentDeclaration>
#ifdef USESPHERICALFROMREFLECTIONMAP
#ifdef SPHERICAL_HARMONICS
uniform vec3 vSphericalL00;uniform vec3 vSphericalL1_1;uniform vec3 vSphericalL10;uniform vec3 vSphericalL11;uniform vec3 vSphericalL2_2;uniform vec3 vSphericalL2_1;uniform vec3 vSphericalL20;uniform vec3 vSphericalL21;uniform vec3 vSphericalL22;
#else
uniform vec3 vSphericalX;uniform vec3 vSphericalY;uniform vec3 vSphericalZ;uniform vec3 vSphericalXX_ZZ;uniform vec3 vSphericalYY_ZZ;uniform vec3 vSphericalZZ;uniform vec3 vSphericalXY;uniform vec3 vSphericalYZ;uniform vec3 vSphericalZX;
#endif
#endif
#define ADDITIONAL_FRAGMENT_DECLARATION
`;ne.IncludesShadersStore[WH]=HH;const jH="pbrUboDeclaration",XH=`layout(std140,column_major) uniform;uniform Material {vec2 vAlbedoInfos;vec4 vAmbientInfos;vec2 vOpacityInfos;vec2 vEmissiveInfos;vec2 vLightmapInfos;vec3 vReflectivityInfos;vec2 vMicroSurfaceSamplerInfos;vec2 vReflectionInfos;vec2 vReflectionFilteringInfo;vec3 vReflectionPosition;vec3 vReflectionSize;vec3 vBumpInfos;mat4 albedoMatrix;mat4 ambientMatrix;mat4 opacityMatrix;mat4 emissiveMatrix;mat4 lightmapMatrix;mat4 reflectivityMatrix;mat4 microSurfaceSamplerMatrix;mat4 bumpMatrix;vec2 vTangentSpaceParams;mat4 reflectionMatrix;vec3 vReflectionColor;vec4 vAlbedoColor;vec4 vLightingIntensity;vec3 vReflectionMicrosurfaceInfos;float pointSize;vec4 vReflectivityColor;vec3 vEmissiveColor;vec3 vAmbientColor;vec2 vDebugMode;vec4 vMetallicReflectanceFactors;vec2 vMetallicReflectanceInfos;mat4 metallicReflectanceMatrix;vec2 vReflectanceInfos;mat4 reflectanceMatrix;vec3 vSphericalL00;vec3 vSphericalL1_1;vec3 vSphericalL10;vec3 vSphericalL11;vec3 vSphericalL2_2;vec3 vSphericalL2_1;vec3 vSphericalL20;vec3 vSphericalL21;vec3 vSphericalL22;vec3 vSphericalX;vec3 vSphericalY;vec3 vSphericalZ;vec3 vSphericalXX_ZZ;vec3 vSphericalYY_ZZ;vec3 vSphericalZZ;vec3 vSphericalXY;vec3 vSphericalYZ;vec3 vSphericalZX;
#define ADDITIONAL_UBO_DECLARATION
};
#include<sceneUboDeclaration>
#include<meshUboDeclaration>
`;ne.IncludesShadersStore[jH]=XH;const YH="pbrFragmentExtraDeclaration",KH=`varying vec3 vPositionW;
#if DEBUGMODE>0
varying vec4 vClipSpacePosition;
#endif
#include<mainUVVaryingDeclaration>[1..7]
#ifdef NORMAL
varying vec3 vNormalW;
#if defined(USESPHERICALFROMREFLECTIONMAP) && defined(USESPHERICALINVERTEX)
varying vec3 vEnvironmentIrradiance;
#endif
#endif
#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)
varying vec4 vColor;
#endif
`;ne.IncludesShadersStore[YH]=KH;const qH="samplerFragmentAlternateDeclaration",$H=`#ifdef _DEFINENAME_
#if _DEFINENAME_DIRECTUV==1
#define v_VARYINGNAME_UV vMainUV1
#elif _DEFINENAME_DIRECTUV==2
#define v_VARYINGNAME_UV vMainUV2
#elif _DEFINENAME_DIRECTUV==3
#define v_VARYINGNAME_UV vMainUV3
#elif _DEFINENAME_DIRECTUV==4
#define v_VARYINGNAME_UV vMainUV4
#elif _DEFINENAME_DIRECTUV==5
#define v_VARYINGNAME_UV vMainUV5
#elif _DEFINENAME_DIRECTUV==6
#define v_VARYINGNAME_UV vMainUV6
#else
varying vec2 v_VARYINGNAME_UV;
#endif
#endif
`;ne.IncludesShadersStore[qH]=$H;const QH="pbrFragmentSamplersDeclaration",ZH=`#include<samplerFragmentDeclaration>(_DEFINENAME_,ALBEDO,_VARYINGNAME_,Albedo,_SAMPLERNAME_,albedo)
#include<samplerFragmentDeclaration>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient,_SAMPLERNAME_,ambient)
#include<samplerFragmentDeclaration>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity,_SAMPLERNAME_,opacity)
#include<samplerFragmentDeclaration>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive,_SAMPLERNAME_,emissive)
#include<samplerFragmentDeclaration>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap,_SAMPLERNAME_,lightmap)
#include<samplerFragmentDeclaration>(_DEFINENAME_,REFLECTIVITY,_VARYINGNAME_,Reflectivity,_SAMPLERNAME_,reflectivity)
#include<samplerFragmentDeclaration>(_DEFINENAME_,MICROSURFACEMAP,_VARYINGNAME_,MicroSurfaceSampler,_SAMPLERNAME_,microSurface)
#include<samplerFragmentDeclaration>(_DEFINENAME_,METALLIC_REFLECTANCE,_VARYINGNAME_,MetallicReflectance,_SAMPLERNAME_,metallicReflectance)
#include<samplerFragmentDeclaration>(_DEFINENAME_,REFLECTANCE,_VARYINGNAME_,Reflectance,_SAMPLERNAME_,reflectance)
#include<samplerFragmentDeclaration>(_DEFINENAME_,DECAL,_VARYINGNAME_,Decal,_SAMPLERNAME_,decal)
#ifdef CLEARCOAT
#include<samplerFragmentDeclaration>(_DEFINENAME_,CLEARCOAT_TEXTURE,_VARYINGNAME_,ClearCoat,_SAMPLERNAME_,clearCoat)
#include<samplerFragmentAlternateDeclaration>(_DEFINENAME_,CLEARCOAT_TEXTURE_ROUGHNESS,_VARYINGNAME_,ClearCoatRoughness)
#if defined(CLEARCOAT_TEXTURE_ROUGHNESS) && !defined(CLEARCOAT_TEXTURE_ROUGHNESS_IDENTICAL)
uniform sampler2D clearCoatRoughnessSampler;
#endif
#include<samplerFragmentDeclaration>(_DEFINENAME_,CLEARCOAT_BUMP,_VARYINGNAME_,ClearCoatBump,_SAMPLERNAME_,clearCoatBump)
#include<samplerFragmentDeclaration>(_DEFINENAME_,CLEARCOAT_TINT_TEXTURE,_VARYINGNAME_,ClearCoatTint,_SAMPLERNAME_,clearCoatTint)
#endif
#ifdef IRIDESCENCE
#include<samplerFragmentDeclaration>(_DEFINENAME_,IRIDESCENCE_TEXTURE,_VARYINGNAME_,Iridescence,_SAMPLERNAME_,iridescence)
#include<samplerFragmentDeclaration>(_DEFINENAME_,IRIDESCENCE_THICKNESS_TEXTURE,_VARYINGNAME_,IridescenceThickness,_SAMPLERNAME_,iridescenceThickness)
#endif
#ifdef SHEEN
#include<samplerFragmentDeclaration>(_DEFINENAME_,SHEEN_TEXTURE,_VARYINGNAME_,Sheen,_SAMPLERNAME_,sheen)
#include<samplerFragmentAlternateDeclaration>(_DEFINENAME_,SHEEN_TEXTURE_ROUGHNESS,_VARYINGNAME_,SheenRoughness)
#if defined(SHEEN_ROUGHNESS) && defined(SHEEN_TEXTURE_ROUGHNESS) && !defined(SHEEN_TEXTURE_ROUGHNESS_IDENTICAL)
uniform sampler2D sheenRoughnessSampler;
#endif
#endif
#ifdef ANISOTROPIC
#include<samplerFragmentDeclaration>(_DEFINENAME_,ANISOTROPIC_TEXTURE,_VARYINGNAME_,Anisotropy,_SAMPLERNAME_,anisotropy)
#endif
#ifdef REFLECTION
#ifdef REFLECTIONMAP_3D
#define sampleReflection(s,c) textureCube(s,c)
uniform samplerCube reflectionSampler;
#ifdef LODBASEDMICROSFURACE
#define sampleReflectionLod(s,c,l) textureCubeLodEXT(s,c,l)
#else
uniform samplerCube reflectionSamplerLow;uniform samplerCube reflectionSamplerHigh;
#endif
#ifdef USEIRRADIANCEMAP
uniform samplerCube irradianceSampler;
#endif
#else
#define sampleReflection(s,c) texture2D(s,c)
uniform sampler2D reflectionSampler;
#ifdef LODBASEDMICROSFURACE
#define sampleReflectionLod(s,c,l) texture2DLodEXT(s,c,l)
#else
uniform sampler2D reflectionSamplerLow;uniform sampler2D reflectionSamplerHigh;
#endif
#ifdef USEIRRADIANCEMAP
uniform sampler2D irradianceSampler;
#endif
#endif
#ifdef REFLECTIONMAP_SKYBOX
varying vec3 vPositionUVW;
#else
#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)
varying vec3 vDirectionW;
#endif
#endif
#endif
#ifdef ENVIRONMENTBRDF
uniform sampler2D environmentBrdfSampler;
#endif
#ifdef SUBSURFACE
#ifdef SS_REFRACTION
#ifdef SS_REFRACTIONMAP_3D
#define sampleRefraction(s,c) textureCube(s,c)
uniform samplerCube refractionSampler;
#ifdef LODBASEDMICROSFURACE
#define sampleRefractionLod(s,c,l) textureCubeLodEXT(s,c,l)
#else
uniform samplerCube refractionSamplerLow;uniform samplerCube refractionSamplerHigh;
#endif
#else
#define sampleRefraction(s,c) texture2D(s,c)
uniform sampler2D refractionSampler;
#ifdef LODBASEDMICROSFURACE
#define sampleRefractionLod(s,c,l) texture2DLodEXT(s,c,l)
#else
uniform sampler2D refractionSamplerLow;uniform sampler2D refractionSamplerHigh;
#endif
#endif
#endif
#include<samplerFragmentDeclaration>(_DEFINENAME_,SS_THICKNESSANDMASK_TEXTURE,_VARYINGNAME_,Thickness,_SAMPLERNAME_,thickness)
#include<samplerFragmentDeclaration>(_DEFINENAME_,SS_REFRACTIONINTENSITY_TEXTURE,_VARYINGNAME_,RefractionIntensity,_SAMPLERNAME_,refractionIntensity)
#include<samplerFragmentDeclaration>(_DEFINENAME_,SS_TRANSLUCENCYINTENSITY_TEXTURE,_VARYINGNAME_,TranslucencyIntensity,_SAMPLERNAME_,translucencyIntensity)
#endif
`;ne.IncludesShadersStore[QH]=ZH;const JH="subSurfaceScatteringFunctions",ej=`bool testLightingForSSS(float diffusionProfile)
{return diffusionProfile<1.;}`;ne.IncludesShadersStore[JH]=ej;const tj="importanceSampling",ij=`vec3 hemisphereCosSample(vec2 u) {float phi=2.*PI*u.x;float cosTheta2=1.-u.y;float cosTheta=sqrt(cosTheta2);float sinTheta=sqrt(1.-cosTheta2);return vec3(sinTheta*cos(phi),sinTheta*sin(phi),cosTheta);}
vec3 hemisphereImportanceSampleDggx(vec2 u,float a) {float phi=2.*PI*u.x;float cosTheta2=(1.-u.y)/(1.+(a+1.)*((a-1.)*u.y));float cosTheta=sqrt(cosTheta2);float sinTheta=sqrt(1.-cosTheta2);return vec3(sinTheta*cos(phi),sinTheta*sin(phi),cosTheta);}
vec3 hemisphereImportanceSampleDCharlie(vec2 u,float a) { 
float phi=2.*PI*u.x;float sinTheta=pow(u.y,a/(2.*a+1.));float cosTheta=sqrt(1.-sinTheta*sinTheta);return vec3(sinTheta*cos(phi),sinTheta*sin(phi),cosTheta);}`;ne.IncludesShadersStore[tj]=ij;const rj="pbrHelperFunctions",nj=`#define MINIMUMVARIANCE 0.0005
float convertRoughnessToAverageSlope(float roughness)
{return square(roughness)+MINIMUMVARIANCE;}
float fresnelGrazingReflectance(float reflectance0) {float reflectance90=saturate(reflectance0*25.0);return reflectance90;}
vec2 getAARoughnessFactors(vec3 normalVector) {
#ifdef SPECULARAA
vec3 nDfdx=dFdx(normalVector.xyz);vec3 nDfdy=dFdy(normalVector.xyz);float slopeSquare=max(dot(nDfdx,nDfdx),dot(nDfdy,nDfdy));float geometricRoughnessFactor=pow(saturate(slopeSquare),0.333);float geometricAlphaGFactor=sqrt(slopeSquare);geometricAlphaGFactor*=0.75;return vec2(geometricRoughnessFactor,geometricAlphaGFactor);
#else
return vec2(0.);
#endif
}
#ifdef ANISOTROPIC
#ifdef ANISOTROPIC_LEGACY
vec2 getAnisotropicRoughness(float alphaG,float anisotropy) {float alphaT=max(alphaG*(1.0+anisotropy),MINIMUMVARIANCE);float alphaB=max(alphaG*(1.0-anisotropy),MINIMUMVARIANCE);return vec2(alphaT,alphaB);}
vec3 getAnisotropicBentNormals(const vec3 T,const vec3 B,const vec3 N,const vec3 V,float anisotropy,float roughness) {vec3 anisotropicFrameDirection=anisotropy>=0.0 ? B : T;vec3 anisotropicFrameTangent=cross(normalize(anisotropicFrameDirection),V);vec3 anisotropicFrameNormal=cross(anisotropicFrameTangent,anisotropicFrameDirection);vec3 anisotropicNormal=normalize(mix(N,anisotropicFrameNormal,abs(anisotropy)));return anisotropicNormal;}
#else
vec2 getAnisotropicRoughness(float alphaG,float anisotropy) {float alphaT=max(mix(alphaG,1.0,anisotropy*anisotropy),MINIMUMVARIANCE);float alphaB=max(alphaG,MINIMUMVARIANCE);return vec2(alphaT,alphaB);}
vec3 getAnisotropicBentNormals(const vec3 T,const vec3 B,const vec3 N,const vec3 V,float anisotropy,float roughness) {vec3 bentNormal=cross(B,V);bentNormal=normalize(cross(bentNormal,B));float a=square(square(1.0-anisotropy*(1.0-roughness)));bentNormal=normalize(mix(bentNormal,N,a));return bentNormal;}
#endif
#endif
#if defined(CLEARCOAT) || defined(SS_REFRACTION)
vec3 cocaLambert(vec3 alpha,float distance) {return exp(-alpha*distance);}
vec3 cocaLambert(float NdotVRefract,float NdotLRefract,vec3 alpha,float thickness) {return cocaLambert(alpha,(thickness*((NdotLRefract+NdotVRefract)/(NdotLRefract*NdotVRefract))));}
vec3 computeColorAtDistanceInMedia(vec3 color,float distance) {return -log(color)/distance;}
vec3 computeClearCoatAbsorption(float NdotVRefract,float NdotLRefract,vec3 clearCoatColor,float clearCoatThickness,float clearCoatIntensity) {vec3 clearCoatAbsorption=mix(vec3(1.0),
cocaLambert(NdotVRefract,NdotLRefract,clearCoatColor,clearCoatThickness),
clearCoatIntensity);return clearCoatAbsorption;}
#endif
#ifdef MICROSURFACEAUTOMATIC
float computeDefaultMicroSurface(float microSurface,vec3 reflectivityColor)
{const float kReflectivityNoAlphaWorkflow_SmoothnessMax=0.95;float reflectivityLuminance=getLuminance(reflectivityColor);float reflectivityLuma=sqrt(reflectivityLuminance);microSurface=reflectivityLuma*kReflectivityNoAlphaWorkflow_SmoothnessMax;return microSurface;}
#endif
`;ne.IncludesShadersStore[rj]=nj;const sj="harmonicsFunctions",aj=`#ifdef USESPHERICALFROMREFLECTIONMAP
#ifdef SPHERICAL_HARMONICS
vec3 computeEnvironmentIrradiance(vec3 normal) {return vSphericalL00
+ vSphericalL1_1*(normal.y)
+ vSphericalL10*(normal.z)
+ vSphericalL11*(normal.x)
+ vSphericalL2_2*(normal.y*normal.x)
+ vSphericalL2_1*(normal.y*normal.z)
+ vSphericalL20*((3.0*normal.z*normal.z)-1.0)
+ vSphericalL21*(normal.z*normal.x)
+ vSphericalL22*(normal.x*normal.x-(normal.y*normal.y));}
#else
vec3 computeEnvironmentIrradiance(vec3 normal) {float Nx=normal.x;float Ny=normal.y;float Nz=normal.z;vec3 C1=vSphericalZZ.rgb;vec3 Cx=vSphericalX.rgb;vec3 Cy=vSphericalY.rgb;vec3 Cz=vSphericalZ.rgb;vec3 Cxx_zz=vSphericalXX_ZZ.rgb;vec3 Cyy_zz=vSphericalYY_ZZ.rgb;vec3 Cxy=vSphericalXY.rgb;vec3 Cyz=vSphericalYZ.rgb;vec3 Czx=vSphericalZX.rgb;vec3 a1=Cyy_zz*Ny+Cy;vec3 a2=Cyz*Nz+a1;vec3 b1=Czx*Nz+Cx;vec3 b2=Cxy*Ny+b1;vec3 b3=Cxx_zz*Nx+b2;vec3 t1=Cz *Nz+C1;vec3 t2=a2 *Ny+t1;vec3 t3=b3 *Nx+t2;return t3;}
#endif
#endif
`;ne.IncludesShadersStore[sj]=aj;const oj="pbrDirectLightingSetupFunctions",lj=`struct preLightingInfo
{vec3 lightOffset;float lightDistanceSquared;float lightDistance;float attenuation;vec3 L;vec3 H;float NdotV;float NdotLUnclamped;float NdotL;float VdotH;float roughness;
#ifdef IRIDESCENCE
float iridescenceIntensity;
#endif
};preLightingInfo computePointAndSpotPreLightingInfo(vec4 lightData,vec3 V,vec3 N) {preLightingInfo result;result.lightOffset=lightData.xyz-vPositionW;result.lightDistanceSquared=dot(result.lightOffset,result.lightOffset);result.lightDistance=sqrt(result.lightDistanceSquared);result.L=normalize(result.lightOffset);result.H=normalize(V+result.L);result.VdotH=saturate(dot(V,result.H));result.NdotLUnclamped=dot(N,result.L);result.NdotL=saturateEps(result.NdotLUnclamped);return result;}
preLightingInfo computeDirectionalPreLightingInfo(vec4 lightData,vec3 V,vec3 N) {preLightingInfo result;result.lightDistance=length(-lightData.xyz);result.L=normalize(-lightData.xyz);result.H=normalize(V+result.L);result.VdotH=saturate(dot(V,result.H));result.NdotLUnclamped=dot(N,result.L);result.NdotL=saturateEps(result.NdotLUnclamped);return result;}
preLightingInfo computeHemisphericPreLightingInfo(vec4 lightData,vec3 V,vec3 N) {preLightingInfo result;result.NdotL=dot(N,lightData.xyz)*0.5+0.5;result.NdotL=saturateEps(result.NdotL);result.NdotLUnclamped=result.NdotL;
#ifdef SPECULARTERM
result.L=normalize(lightData.xyz);result.H=normalize(V+result.L);result.VdotH=saturate(dot(V,result.H));
#endif
return result;}`;ne.IncludesShadersStore[oj]=lj;const cj="pbrDirectLightingFalloffFunctions",uj=`float computeDistanceLightFalloff_Standard(vec3 lightOffset,float range)
{return max(0.,1.0-length(lightOffset)/range);}
float computeDistanceLightFalloff_Physical(float lightDistanceSquared)
{return 1.0/maxEps(lightDistanceSquared);}
float computeDistanceLightFalloff_GLTF(float lightDistanceSquared,float inverseSquaredRange)
{float lightDistanceFalloff=1.0/maxEps(lightDistanceSquared);float factor=lightDistanceSquared*inverseSquaredRange;float attenuation=saturate(1.0-factor*factor);attenuation*=attenuation;lightDistanceFalloff*=attenuation;return lightDistanceFalloff;}
float computeDistanceLightFalloff(vec3 lightOffset,float lightDistanceSquared,float range,float inverseSquaredRange)
{
#ifdef USEPHYSICALLIGHTFALLOFF
return computeDistanceLightFalloff_Physical(lightDistanceSquared);
#elif defined(USEGLTFLIGHTFALLOFF)
return computeDistanceLightFalloff_GLTF(lightDistanceSquared,inverseSquaredRange);
#else
return computeDistanceLightFalloff_Standard(lightOffset,range);
#endif
}
float computeDirectionalLightFalloff_Standard(vec3 lightDirection,vec3 directionToLightCenterW,float cosHalfAngle,float exponent)
{float falloff=0.0;float cosAngle=maxEps(dot(-lightDirection,directionToLightCenterW));if (cosAngle>=cosHalfAngle)
{falloff=max(0.,pow(cosAngle,exponent));}
return falloff;}
float computeDirectionalLightFalloff_Physical(vec3 lightDirection,vec3 directionToLightCenterW,float cosHalfAngle)
{const float kMinusLog2ConeAngleIntensityRatio=6.64385618977; 
float concentrationKappa=kMinusLog2ConeAngleIntensityRatio/(1.0-cosHalfAngle);vec4 lightDirectionSpreadSG=vec4(-lightDirection*concentrationKappa,-concentrationKappa);float falloff=exp2(dot(vec4(directionToLightCenterW,1.0),lightDirectionSpreadSG));return falloff;}
float computeDirectionalLightFalloff_GLTF(vec3 lightDirection,vec3 directionToLightCenterW,float lightAngleScale,float lightAngleOffset)
{float cd=dot(-lightDirection,directionToLightCenterW);float falloff=saturate(cd*lightAngleScale+lightAngleOffset);falloff*=falloff;return falloff;}
float computeDirectionalLightFalloff(vec3 lightDirection,vec3 directionToLightCenterW,float cosHalfAngle,float exponent,float lightAngleScale,float lightAngleOffset)
{
#ifdef USEPHYSICALLIGHTFALLOFF
return computeDirectionalLightFalloff_Physical(lightDirection,directionToLightCenterW,cosHalfAngle);
#elif defined(USEGLTFLIGHTFALLOFF)
return computeDirectionalLightFalloff_GLTF(lightDirection,directionToLightCenterW,lightAngleScale,lightAngleOffset);
#else
return computeDirectionalLightFalloff_Standard(lightDirection,directionToLightCenterW,cosHalfAngle,exponent);
#endif
}`;ne.IncludesShadersStore[cj]=uj;const hj="pbrBRDFFunctions",dj=`#define FRESNEL_MAXIMUM_ON_ROUGH 0.25
#ifdef MS_BRDF_ENERGY_CONSERVATION
vec3 getEnergyConservationFactor(const vec3 specularEnvironmentR0,const vec3 environmentBrdf) {return 1.0+specularEnvironmentR0*(1.0/environmentBrdf.y-1.0);}
#endif
#ifdef ENVIRONMENTBRDF
vec3 getBRDFLookup(float NdotV,float perceptualRoughness) {vec2 UV=vec2(NdotV,perceptualRoughness);vec4 brdfLookup=texture2D(environmentBrdfSampler,UV);
#ifdef ENVIRONMENTBRDF_RGBD
brdfLookup.rgb=fromRGBD(brdfLookup.rgba);
#endif
return brdfLookup.rgb;}
vec3 getReflectanceFromBRDFLookup(const vec3 specularEnvironmentR0,const vec3 specularEnvironmentR90,const vec3 environmentBrdf) {
#ifdef BRDF_V_HEIGHT_CORRELATED
vec3 reflectance=(specularEnvironmentR90-specularEnvironmentR0)*environmentBrdf.x+specularEnvironmentR0*environmentBrdf.y;
#else
vec3 reflectance=specularEnvironmentR0*environmentBrdf.x+specularEnvironmentR90*environmentBrdf.y;
#endif
return reflectance;}
vec3 getReflectanceFromBRDFLookup(const vec3 specularEnvironmentR0,const vec3 environmentBrdf) {
#ifdef BRDF_V_HEIGHT_CORRELATED
vec3 reflectance=mix(environmentBrdf.xxx,environmentBrdf.yyy,specularEnvironmentR0);
#else
vec3 reflectance=specularEnvironmentR0*environmentBrdf.x+environmentBrdf.y;
#endif
return reflectance;}
#endif
/* NOT USED
#if defined(SHEEN) && defined(SHEEN_SOFTER)
float getBRDFLookupCharlieSheen(float NdotV,float perceptualRoughness)
{float c=1.0-NdotV;float c3=c*c*c;return 0.65584461*c3+1.0/(4.16526551+exp(-7.97291361*perceptualRoughness+6.33516894));}
#endif
*/
#if !defined(ENVIRONMENTBRDF) || defined(REFLECTIONMAP_SKYBOX) || defined(ALPHAFRESNEL)
vec3 getReflectanceFromAnalyticalBRDFLookup_Jones(float VdotN,vec3 reflectance0,vec3 reflectance90,float smoothness)
{float weight=mix(FRESNEL_MAXIMUM_ON_ROUGH,1.0,smoothness);return reflectance0+weight*(reflectance90-reflectance0)*pow5(saturate(1.0-VdotN));}
#endif
#if defined(SHEEN) && defined(ENVIRONMENTBRDF)
/**
* The sheen BRDF not containing F can be easily stored in the blue channel of the BRDF texture.
* The blue channel contains DCharlie*VAshikhmin*NdotL as a lokkup table
*/
vec3 getSheenReflectanceFromBRDFLookup(const vec3 reflectance0,const vec3 environmentBrdf) {vec3 sheenEnvironmentReflectance=reflectance0*environmentBrdf.b;return sheenEnvironmentReflectance;}
#endif
vec3 fresnelSchlickGGX(float VdotH,vec3 reflectance0,vec3 reflectance90)
{return reflectance0+(reflectance90-reflectance0)*pow5(1.0-VdotH);}
float fresnelSchlickGGX(float VdotH,float reflectance0,float reflectance90)
{return reflectance0+(reflectance90-reflectance0)*pow5(1.0-VdotH);}
#ifdef CLEARCOAT
vec3 getR0RemappedForClearCoat(vec3 f0) {
#ifdef CLEARCOAT_DEFAULTIOR
#ifdef MOBILE
return saturate(f0*(f0*0.526868+0.529324)-0.0482256);
#else
return saturate(f0*(f0*(0.941892-0.263008*f0)+0.346479)-0.0285998);
#endif
#else
vec3 s=sqrt(f0);vec3 t=(vClearCoatRefractionParams.z+vClearCoatRefractionParams.w*s)/(vClearCoatRefractionParams.w+vClearCoatRefractionParams.z*s);return square(t);
#endif
}
#endif
#ifdef IRIDESCENCE
const mat3 XYZ_TO_REC709=mat3(
3.2404542,-0.9692660, 0.0556434,
-1.5371385, 1.8760108,-0.2040259,
-0.4985314, 0.0415560, 1.0572252
);vec3 getIORTfromAirToSurfaceR0(vec3 f0) {vec3 sqrtF0=sqrt(f0);return (1.+sqrtF0)/(1.-sqrtF0);}
vec3 getR0fromIORs(vec3 iorT,float iorI) {return square((iorT-vec3(iorI))/(iorT+vec3(iorI)));}
float getR0fromIORs(float iorT,float iorI) {return square((iorT-iorI)/(iorT+iorI));}
vec3 evalSensitivity(float opd,vec3 shift) {float phase=2.0*PI*opd*1.0e-9;const vec3 val=vec3(5.4856e-13,4.4201e-13,5.2481e-13);const vec3 pos=vec3(1.6810e+06,1.7953e+06,2.2084e+06);const vec3 var=vec3(4.3278e+09,9.3046e+09,6.6121e+09);vec3 xyz=val*sqrt(2.0*PI*var)*cos(pos*phase+shift)*exp(-square(phase)*var);xyz.x+=9.7470e-14*sqrt(2.0*PI*4.5282e+09)*cos(2.2399e+06*phase+shift[0])*exp(-4.5282e+09*square(phase));xyz/=1.0685e-7;vec3 srgb=XYZ_TO_REC709*xyz;return srgb;}
vec3 evalIridescence(float outsideIOR,float eta2,float cosTheta1,float thinFilmThickness,vec3 baseF0) {vec3 I=vec3(1.0);float iridescenceIOR=mix(outsideIOR,eta2,smoothstep(0.0,0.03,thinFilmThickness));float sinTheta2Sq=square(outsideIOR/iridescenceIOR)*(1.0-square(cosTheta1));float cosTheta2Sq=1.0-sinTheta2Sq;if (cosTheta2Sq<0.0) {return I;}
float cosTheta2=sqrt(cosTheta2Sq);float R0=getR0fromIORs(iridescenceIOR,outsideIOR);float R12=fresnelSchlickGGX(cosTheta1,R0,1.);float R21=R12;float T121=1.0-R12;float phi12=0.0;if (iridescenceIOR<outsideIOR) phi12=PI;float phi21=PI-phi12;vec3 baseIOR=getIORTfromAirToSurfaceR0(clamp(baseF0,0.0,0.9999)); 
vec3 R1=getR0fromIORs(baseIOR,iridescenceIOR);vec3 R23=fresnelSchlickGGX(cosTheta2,R1,vec3(1.));vec3 phi23=vec3(0.0);if (baseIOR[0]<iridescenceIOR) phi23[0]=PI;if (baseIOR[1]<iridescenceIOR) phi23[1]=PI;if (baseIOR[2]<iridescenceIOR) phi23[2]=PI;float opd=2.0*iridescenceIOR*thinFilmThickness*cosTheta2;vec3 phi=vec3(phi21)+phi23;vec3 R123=clamp(R12*R23,1e-5,0.9999);vec3 r123=sqrt(R123);vec3 Rs=square(T121)*R23/(vec3(1.0)-R123);vec3 C0=R12+Rs;I=C0;vec3 Cm=Rs-T121;for (int m=1; m<=2; ++m)
{Cm*=r123;vec3 Sm=2.0*evalSensitivity(float(m)*opd,float(m)*phi);I+=Cm*Sm;}
return max(I,vec3(0.0));}
#endif
float normalDistributionFunction_TrowbridgeReitzGGX(float NdotH,float alphaG)
{float a2=square(alphaG);float d=NdotH*NdotH*(a2-1.0)+1.0;return a2/(PI*d*d);}
#ifdef SHEEN
float normalDistributionFunction_CharlieSheen(float NdotH,float alphaG)
{float invR=1./alphaG;float cos2h=NdotH*NdotH;float sin2h=1.-cos2h;return (2.+invR)*pow(sin2h,invR*.5)/(2.*PI);}
#endif
#ifdef ANISOTROPIC
float normalDistributionFunction_BurleyGGX_Anisotropic(float NdotH,float TdotH,float BdotH,const vec2 alphaTB) {float a2=alphaTB.x*alphaTB.y;vec3 v=vec3(alphaTB.y*TdotH,alphaTB.x *BdotH,a2*NdotH);float v2=dot(v,v);float w2=a2/v2;return a2*w2*w2*RECIPROCAL_PI;}
#endif
#ifdef BRDF_V_HEIGHT_CORRELATED
float smithVisibility_GGXCorrelated(float NdotL,float NdotV,float alphaG) {
#ifdef MOBILE
float GGXV=NdotL*(NdotV*(1.0-alphaG)+alphaG);float GGXL=NdotV*(NdotL*(1.0-alphaG)+alphaG);return 0.5/(GGXV+GGXL);
#else
float a2=alphaG*alphaG;float GGXV=NdotL*sqrt(NdotV*(NdotV-a2*NdotV)+a2);float GGXL=NdotV*sqrt(NdotL*(NdotL-a2*NdotL)+a2);return 0.5/(GGXV+GGXL);
#endif
}
#else
float smithVisibilityG1_TrowbridgeReitzGGXFast(float dot,float alphaG)
{
#ifdef MOBILE
return 1.0/(dot+alphaG+(1.0-alphaG)*dot ));
#else
float alphaSquared=alphaG*alphaG;return 1.0/(dot+sqrt(alphaSquared+(1.0-alphaSquared)*dot*dot));
#endif
}
float smithVisibility_TrowbridgeReitzGGXFast(float NdotL,float NdotV,float alphaG)
{float visibility=smithVisibilityG1_TrowbridgeReitzGGXFast(NdotL,alphaG)*smithVisibilityG1_TrowbridgeReitzGGXFast(NdotV,alphaG);return visibility;}
#endif
#ifdef ANISOTROPIC
float smithVisibility_GGXCorrelated_Anisotropic(float NdotL,float NdotV,float TdotV,float BdotV,float TdotL,float BdotL,const vec2 alphaTB) {float lambdaV=NdotL*length(vec3(alphaTB.x*TdotV,alphaTB.y*BdotV,NdotV));float lambdaL=NdotV*length(vec3(alphaTB.x*TdotL,alphaTB.y*BdotL,NdotL));float v=0.5/(lambdaV+lambdaL);return v;}
#endif
#ifdef CLEARCOAT
float visibility_Kelemen(float VdotH) {return 0.25/(VdotH*VdotH); }
#endif
#ifdef SHEEN
float visibility_Ashikhmin(float NdotL,float NdotV)
{return 1./(4.*(NdotL+NdotV-NdotL*NdotV));}
/* NOT USED
#ifdef SHEEN_SOFTER
float l(float x,float alphaG)
{float oneMinusAlphaSq=(1.0-alphaG)*(1.0-alphaG);float a=mix(21.5473,25.3245,oneMinusAlphaSq);float b=mix(3.82987,3.32435,oneMinusAlphaSq);float c=mix(0.19823,0.16801,oneMinusAlphaSq);float d=mix(-1.97760,-1.27393,oneMinusAlphaSq);float e=mix(-4.32054,-4.85967,oneMinusAlphaSq);return a/(1.0+b*pow(x,c))+d*x+e;}
float lambdaSheen(float cosTheta,float alphaG)
{return abs(cosTheta)<0.5 ? exp(l(cosTheta,alphaG)) : exp(2.0*l(0.5,alphaG)-l(1.0-cosTheta,alphaG));}
float visibility_CharlieSheen(float NdotL,float NdotV,float alphaG)
{float G=1.0/(1.0+lambdaSheen(NdotV,alphaG)+lambdaSheen(NdotL,alphaG));return G/(4.0*NdotV*NdotL);}
#endif
*/
#endif
float diffuseBRDF_Burley(float NdotL,float NdotV,float VdotH,float roughness) {float diffuseFresnelNV=pow5(saturateEps(1.0-NdotL));float diffuseFresnelNL=pow5(saturateEps(1.0-NdotV));float diffuseFresnel90=0.5+2.0*VdotH*VdotH*roughness;float fresnel =
(1.0+(diffuseFresnel90-1.0)*diffuseFresnelNL) *
(1.0+(diffuseFresnel90-1.0)*diffuseFresnelNV);return fresnel/PI;}
#ifdef SS_TRANSLUCENCY
vec3 transmittanceBRDF_Burley(const vec3 tintColor,const vec3 diffusionDistance,float thickness) {vec3 S=1./maxEps(diffusionDistance);vec3 temp=exp((-0.333333333*thickness)*S);return tintColor.rgb*0.25*(temp*temp*temp+3.0*temp);}
float computeWrappedDiffuseNdotL(float NdotL,float w) {float t=1.0+w;float invt2=1.0/square(t);return saturate((NdotL+w)*invt2);}
#endif
`;ne.IncludesShadersStore[hj]=dj;const fj="hdrFilteringFunctions",_j=`#ifdef NUM_SAMPLES
#if NUM_SAMPLES>0
#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)
float radicalInverse_VdC(uint bits) 
{bits=(bits<<16u) | (bits>>16u);bits=((bits & 0x55555555u)<<1u) | ((bits & 0xAAAAAAAAu)>>1u);bits=((bits & 0x33333333u)<<2u) | ((bits & 0xCCCCCCCCu)>>2u);bits=((bits & 0x0F0F0F0Fu)<<4u) | ((bits & 0xF0F0F0F0u)>>4u);bits=((bits & 0x00FF00FFu)<<8u) | ((bits & 0xFF00FF00u)>>8u);return float(bits)*2.3283064365386963e-10; }
vec2 hammersley(uint i,uint N)
{return vec2(float(i)/float(N),radicalInverse_VdC(i));}
#else
float vanDerCorpus(int n,int base)
{float invBase=1.0/float(base);float denom =1.0;float result =0.0;for(int i=0; i<32; ++i)
{if(n>0)
{denom =mod(float(n),2.0);result+=denom*invBase;invBase=invBase/2.0;n =int(float(n)/2.0);}}
return result;}
vec2 hammersley(int i,int N)
{return vec2(float(i)/float(N),vanDerCorpus(i,2));}
#endif
float log4(float x) {return log2(x)/2.;}
const float NUM_SAMPLES_FLOAT=float(NUM_SAMPLES);const float NUM_SAMPLES_FLOAT_INVERSED=1./NUM_SAMPLES_FLOAT;const float K=4.;
#define inline
vec3 irradiance(samplerCube inputTexture,vec3 inputN,vec2 filteringInfo)
{vec3 n=normalize(inputN);vec3 result=vec3(0.0);vec3 tangent=abs(n.z)<0.999 ? vec3(0.,0.,1.) : vec3(1.,0.,0.);tangent=normalize(cross(tangent,n));vec3 bitangent=cross(n,tangent);mat3 tbn=mat3(tangent,bitangent,n);float maxLevel=filteringInfo.y;float dim0=filteringInfo.x;float omegaP=(4.*PI)/(6.*dim0*dim0);
#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)
for(uint i=0u; i<NUM_SAMPLES; ++i)
#else
for(int i=0; i<NUM_SAMPLES; ++i)
#endif
{vec2 Xi=hammersley(i,NUM_SAMPLES);vec3 Ls=hemisphereCosSample(Xi);Ls=normalize(Ls);vec3 Ns=vec3(0.,0.,1.);float NoL=dot(Ns,Ls);if (NoL>0.) {float pdf_inversed=PI/NoL;float omegaS=NUM_SAMPLES_FLOAT_INVERSED*pdf_inversed;float l=log4(omegaS)-log4(omegaP)+log4(K);float mipLevel=clamp(l,0.0,maxLevel);vec3 c=textureCubeLodEXT(inputTexture,tbn*Ls,mipLevel).rgb;
#ifdef GAMMA_INPUT
c=toLinearSpace(c);
#endif
result+=c;}}
result=result*NUM_SAMPLES_FLOAT_INVERSED;return result;}
#define inline
vec3 radiance(float alphaG,samplerCube inputTexture,vec3 inputN,vec2 filteringInfo)
{vec3 n=normalize(inputN);vec3 c=textureCube(inputTexture,n).rgb; 
if (alphaG==0.) {
#ifdef GAMMA_INPUT
c=toLinearSpace(c);
#endif
return c;} else {vec3 result=vec3(0.);vec3 tangent=abs(n.z)<0.999 ? vec3(0.,0.,1.) : vec3(1.,0.,0.);tangent=normalize(cross(tangent,n));vec3 bitangent=cross(n,tangent);mat3 tbn=mat3(tangent,bitangent,n);float maxLevel=filteringInfo.y;float dim0=filteringInfo.x;float omegaP=(4.*PI)/(6.*dim0*dim0);float weight=0.;
#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)
for(uint i=0u; i<NUM_SAMPLES; ++i)
#else
for(int i=0; i<NUM_SAMPLES; ++i)
#endif
{vec2 Xi=hammersley(i,NUM_SAMPLES);vec3 H=hemisphereImportanceSampleDggx(Xi,alphaG);float NoV=1.;float NoH=H.z;float NoH2=H.z*H.z;float NoL=2.*NoH2-1.;vec3 L=vec3(2.*NoH*H.x,2.*NoH*H.y,NoL);L=normalize(L);if (NoL>0.) {float pdf_inversed=4./normalDistributionFunction_TrowbridgeReitzGGX(NoH,alphaG);float omegaS=NUM_SAMPLES_FLOAT_INVERSED*pdf_inversed;float l=log4(omegaS)-log4(omegaP)+log4(K);float mipLevel=clamp(float(l),0.0,maxLevel);weight+=NoL;vec3 c=textureCubeLodEXT(inputTexture,tbn*L,mipLevel).rgb;
#ifdef GAMMA_INPUT
c=toLinearSpace(c);
#endif
result+=c*NoL;}}
result=result/weight;return result;}}
#endif
#endif
`;ne.IncludesShadersStore[fj]=_j;const pj="pbrDirectLightingFunctions",gj=`#define CLEARCOATREFLECTANCE90 1.0
struct lightingInfo
{vec3 diffuse;
#ifdef SPECULARTERM
vec3 specular;
#endif
#ifdef CLEARCOAT
vec4 clearCoat;
#endif
#ifdef SHEEN
vec3 sheen;
#endif
};float adjustRoughnessFromLightProperties(float roughness,float lightRadius,float lightDistance) {
#if defined(USEPHYSICALLIGHTFALLOFF) || defined(USEGLTFLIGHTFALLOFF)
float lightRoughness=lightRadius/lightDistance;float totalRoughness=saturate(lightRoughness+roughness);return totalRoughness;
#else
return roughness;
#endif
}
vec3 computeHemisphericDiffuseLighting(preLightingInfo info,vec3 lightColor,vec3 groundColor) {return mix(groundColor,lightColor,info.NdotL);}
vec3 computeDiffuseLighting(preLightingInfo info,vec3 lightColor) {float diffuseTerm=diffuseBRDF_Burley(info.NdotL,info.NdotV,info.VdotH,info.roughness);return diffuseTerm*info.attenuation*info.NdotL*lightColor;}
#define inline
vec3 computeProjectionTextureDiffuseLighting(sampler2D projectionLightSampler,mat4 textureProjectionMatrix){vec4 strq=textureProjectionMatrix*vec4(vPositionW,1.0);strq/=strq.w;vec3 textureColor=texture2D(projectionLightSampler,strq.xy).rgb;return toLinearSpace(textureColor);}
#ifdef SS_TRANSLUCENCY
vec3 computeDiffuseAndTransmittedLighting(preLightingInfo info,vec3 lightColor,vec3 transmittance) {float NdotL=absEps(info.NdotLUnclamped);float wrapNdotL=computeWrappedDiffuseNdotL(NdotL,0.02);float trAdapt=step(0.,info.NdotLUnclamped);vec3 transmittanceNdotL=mix(transmittance*wrapNdotL,vec3(wrapNdotL),trAdapt);float diffuseTerm=diffuseBRDF_Burley(NdotL,info.NdotV,info.VdotH,info.roughness);return diffuseTerm*transmittanceNdotL*info.attenuation*lightColor;}
#endif
#ifdef SPECULARTERM
vec3 computeSpecularLighting(preLightingInfo info,vec3 N,vec3 reflectance0,vec3 reflectance90,float geometricRoughnessFactor,vec3 lightColor) {float NdotH=saturateEps(dot(N,info.H));float roughness=max(info.roughness,geometricRoughnessFactor);float alphaG=convertRoughnessToAverageSlope(roughness);vec3 fresnel=fresnelSchlickGGX(info.VdotH,reflectance0,reflectance90);
#ifdef IRIDESCENCE
fresnel=mix(fresnel,reflectance0,info.iridescenceIntensity);
#endif
float distribution=normalDistributionFunction_TrowbridgeReitzGGX(NdotH,alphaG);
#ifdef BRDF_V_HEIGHT_CORRELATED
float smithVisibility=smithVisibility_GGXCorrelated(info.NdotL,info.NdotV,alphaG);
#else
float smithVisibility=smithVisibility_TrowbridgeReitzGGXFast(info.NdotL,info.NdotV,alphaG);
#endif
vec3 specTerm=fresnel*distribution*smithVisibility;return specTerm*info.attenuation*info.NdotL*lightColor;}
#endif
#ifdef ANISOTROPIC
vec3 computeAnisotropicSpecularLighting(preLightingInfo info,vec3 V,vec3 N,vec3 T,vec3 B,float anisotropy,vec3 reflectance0,vec3 reflectance90,float geometricRoughnessFactor,vec3 lightColor) {float NdotH=saturateEps(dot(N,info.H));float TdotH=dot(T,info.H);float BdotH=dot(B,info.H);float TdotV=dot(T,V);float BdotV=dot(B,V);float TdotL=dot(T,info.L);float BdotL=dot(B,info.L);float alphaG=convertRoughnessToAverageSlope(info.roughness);vec2 alphaTB=getAnisotropicRoughness(alphaG,anisotropy);alphaTB=max(alphaTB,square(geometricRoughnessFactor));vec3 fresnel=fresnelSchlickGGX(info.VdotH,reflectance0,reflectance90);
#ifdef IRIDESCENCE
fresnel=mix(fresnel,reflectance0,info.iridescenceIntensity);
#endif
float distribution=normalDistributionFunction_BurleyGGX_Anisotropic(NdotH,TdotH,BdotH,alphaTB);float smithVisibility=smithVisibility_GGXCorrelated_Anisotropic(info.NdotL,info.NdotV,TdotV,BdotV,TdotL,BdotL,alphaTB);vec3 specTerm=fresnel*distribution*smithVisibility;return specTerm*info.attenuation*info.NdotL*lightColor;}
#endif
#ifdef CLEARCOAT
vec4 computeClearCoatLighting(preLightingInfo info,vec3 Ncc,float geometricRoughnessFactor,float clearCoatIntensity,vec3 lightColor) {float NccdotL=saturateEps(dot(Ncc,info.L));float NccdotH=saturateEps(dot(Ncc,info.H));float clearCoatRoughness=max(info.roughness,geometricRoughnessFactor);float alphaG=convertRoughnessToAverageSlope(clearCoatRoughness);float fresnel=fresnelSchlickGGX(info.VdotH,vClearCoatRefractionParams.x,CLEARCOATREFLECTANCE90);fresnel*=clearCoatIntensity;float distribution=normalDistributionFunction_TrowbridgeReitzGGX(NccdotH,alphaG);float kelemenVisibility=visibility_Kelemen(info.VdotH);float clearCoatTerm=fresnel*distribution*kelemenVisibility;return vec4(
clearCoatTerm*info.attenuation*NccdotL*lightColor,
1.0-fresnel
);}
vec3 computeClearCoatLightingAbsorption(float NdotVRefract,vec3 L,vec3 Ncc,vec3 clearCoatColor,float clearCoatThickness,float clearCoatIntensity) {vec3 LRefract=-refract(L,Ncc,vClearCoatRefractionParams.y);float NdotLRefract=saturateEps(dot(Ncc,LRefract));vec3 absorption=computeClearCoatAbsorption(NdotVRefract,NdotLRefract,clearCoatColor,clearCoatThickness,clearCoatIntensity);return absorption;}
#endif
#ifdef SHEEN
vec3 computeSheenLighting(preLightingInfo info,vec3 N,vec3 reflectance0,vec3 reflectance90,float geometricRoughnessFactor,vec3 lightColor) {float NdotH=saturateEps(dot(N,info.H));float roughness=max(info.roughness,geometricRoughnessFactor);float alphaG=convertRoughnessToAverageSlope(roughness);float fresnel=1.;float distribution=normalDistributionFunction_CharlieSheen(NdotH,alphaG);/*#ifdef SHEEN_SOFTER
float visibility=visibility_CharlieSheen(info.NdotL,info.NdotV,alphaG);
#else */
float visibility=visibility_Ashikhmin(info.NdotL,info.NdotV);/* #endif */
float sheenTerm=fresnel*distribution*visibility;return sheenTerm*info.attenuation*info.NdotL*lightColor;}
#endif
`;ne.IncludesShadersStore[pj]=gj;const mj="pbrIBLFunctions",vj=`#if defined(REFLECTION) || defined(SS_REFRACTION)
float getLodFromAlphaG(float cubeMapDimensionPixels,float microsurfaceAverageSlope) {float microsurfaceAverageSlopeTexels=cubeMapDimensionPixels*microsurfaceAverageSlope;float lod=log2(microsurfaceAverageSlopeTexels);return lod;}
float getLinearLodFromRoughness(float cubeMapDimensionPixels,float roughness) {float lod=log2(cubeMapDimensionPixels)*roughness;return lod;}
#endif
#if defined(ENVIRONMENTBRDF) && defined(RADIANCEOCCLUSION)
float environmentRadianceOcclusion(float ambientOcclusion,float NdotVUnclamped) {float temp=NdotVUnclamped+ambientOcclusion;return saturate(square(temp)-1.0+ambientOcclusion);}
#endif
#if defined(ENVIRONMENTBRDF) && defined(HORIZONOCCLUSION)
float environmentHorizonOcclusion(vec3 view,vec3 normal,vec3 geometricNormal) {vec3 reflection=reflect(view,normal);float temp=saturate(1.0+1.1*dot(reflection,geometricNormal));return square(temp);}
#endif
#if defined(LODINREFLECTIONALPHA) || defined(SS_LODINREFRACTIONALPHA)
#define UNPACK_LOD(x) (1.0-x)*255.0
float getLodFromAlphaG(float cubeMapDimensionPixels,float alphaG,float NdotV) {float microsurfaceAverageSlope=alphaG;microsurfaceAverageSlope*=sqrt(abs(NdotV));return getLodFromAlphaG(cubeMapDimensionPixels,microsurfaceAverageSlope);}
#endif
`;ne.IncludesShadersStore[mj]=vj;const Ej="pbrBlockAlbedoOpacity",yj=`struct albedoOpacityOutParams
{vec3 surfaceAlbedo;float alpha;};
#define pbr_inline
void albedoOpacityBlock(
in vec4 vAlbedoColor,
#ifdef ALBEDO
in vec4 albedoTexture,
in vec2 albedoInfos,
#endif
#ifdef OPACITY
in vec4 opacityMap,
in vec2 vOpacityInfos,
#endif
#ifdef DETAIL
in vec4 detailColor,
in vec4 vDetailInfos,
#endif
#ifdef DECAL
in vec4 decalColor,
in vec4 vDecalInfos,
#endif
out albedoOpacityOutParams outParams
)
{vec3 surfaceAlbedo=vAlbedoColor.rgb;float alpha=vAlbedoColor.a;
#ifdef ALBEDO
#if defined(ALPHAFROMALBEDO) || defined(ALPHATEST)
alpha*=albedoTexture.a;
#endif
#ifdef GAMMAALBEDO
surfaceAlbedo*=toLinearSpace(albedoTexture.rgb);
#else
surfaceAlbedo*=albedoTexture.rgb;
#endif
surfaceAlbedo*=albedoInfos.y;
#endif
#ifndef DECAL_AFTER_DETAIL
#include<decalFragment>
#endif
#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)
surfaceAlbedo*=vColor.rgb;
#endif
#ifdef DETAIL
float detailAlbedo=2.0*mix(0.5,detailColor.r,vDetailInfos.y);surfaceAlbedo.rgb=surfaceAlbedo.rgb*detailAlbedo*detailAlbedo; 
#endif
#ifdef DECAL_AFTER_DETAIL
#include<decalFragment>
#endif
#define CUSTOM_FRAGMENT_UPDATE_ALBEDO
#ifdef OPACITY
#ifdef OPACITYRGB
alpha=getLuminance(opacityMap.rgb);
#else
alpha*=opacityMap.a;
#endif
alpha*=vOpacityInfos.y;
#endif
#if defined(VERTEXALPHA) || defined(INSTANCESCOLOR) && defined(INSTANCES)
alpha*=vColor.a;
#endif
#if !defined(SS_LINKREFRACTIONTOTRANSPARENCY) && !defined(ALPHAFRESNEL)
#ifdef ALPHATEST 
#if DEBUGMODE != 88
if (alpha<ALPHATESTVALUE)
discard;
#endif
#ifndef ALPHABLEND
alpha=1.0;
#endif
#endif
#endif
outParams.surfaceAlbedo=surfaceAlbedo;outParams.alpha=alpha;}
`;ne.IncludesShadersStore[Ej]=yj;const Tj="pbrBlockReflectivity",bj=`struct reflectivityOutParams
{float microSurface;float roughness;vec3 surfaceReflectivityColor;
#ifdef METALLICWORKFLOW
vec3 surfaceAlbedo;
#endif
#if defined(METALLICWORKFLOW) && defined(REFLECTIVITY) && defined(AOSTOREINMETALMAPRED)
vec3 ambientOcclusionColor;
#endif
#if DEBUGMODE>0
#ifdef METALLICWORKFLOW
vec2 metallicRoughness;
#ifdef REFLECTIVITY
vec4 surfaceMetallicColorMap;
#endif
#ifndef FROSTBITE_REFLECTANCE
vec3 metallicF0;
#endif
#else
#ifdef REFLECTIVITY
vec4 surfaceReflectivityColorMap;
#endif
#endif
#endif
};
#define pbr_inline
void reflectivityBlock(
in vec4 vReflectivityColor,
#ifdef METALLICWORKFLOW
in vec3 surfaceAlbedo,
in vec4 metallicReflectanceFactors,
#endif
#ifdef REFLECTIVITY
in vec3 reflectivityInfos,
in vec4 surfaceMetallicOrReflectivityColorMap,
#endif
#if defined(METALLICWORKFLOW) && defined(REFLECTIVITY) && defined(AOSTOREINMETALMAPRED)
in vec3 ambientOcclusionColorIn,
#endif
#ifdef MICROSURFACEMAP
in vec4 microSurfaceTexel,
#endif
#ifdef DETAIL
in vec4 detailColor,
in vec4 vDetailInfos,
#endif
out reflectivityOutParams outParams
)
{float microSurface=vReflectivityColor.a;vec3 surfaceReflectivityColor=vReflectivityColor.rgb;
#ifdef METALLICWORKFLOW
vec2 metallicRoughness=surfaceReflectivityColor.rg;
#ifdef REFLECTIVITY
#if DEBUGMODE>0
outParams.surfaceMetallicColorMap=surfaceMetallicOrReflectivityColorMap;
#endif
#ifdef AOSTOREINMETALMAPRED
vec3 aoStoreInMetalMap=vec3(surfaceMetallicOrReflectivityColorMap.r,surfaceMetallicOrReflectivityColorMap.r,surfaceMetallicOrReflectivityColorMap.r);outParams.ambientOcclusionColor=mix(ambientOcclusionColorIn,aoStoreInMetalMap,reflectivityInfos.z);
#endif
#ifdef METALLNESSSTOREINMETALMAPBLUE
metallicRoughness.r*=surfaceMetallicOrReflectivityColorMap.b;
#else
metallicRoughness.r*=surfaceMetallicOrReflectivityColorMap.r;
#endif
#ifdef ROUGHNESSSTOREINMETALMAPALPHA
metallicRoughness.g*=surfaceMetallicOrReflectivityColorMap.a;
#else
#ifdef ROUGHNESSSTOREINMETALMAPGREEN
metallicRoughness.g*=surfaceMetallicOrReflectivityColorMap.g;
#endif
#endif
#endif
#ifdef DETAIL
float detailRoughness=mix(0.5,detailColor.b,vDetailInfos.w);float loLerp=mix(0.,metallicRoughness.g,detailRoughness*2.);float hiLerp=mix(metallicRoughness.g,1.,(detailRoughness-0.5)*2.);metallicRoughness.g=mix(loLerp,hiLerp,step(detailRoughness,0.5));
#endif
#ifdef MICROSURFACEMAP
metallicRoughness.g*=microSurfaceTexel.r;
#endif
#if DEBUGMODE>0
outParams.metallicRoughness=metallicRoughness;
#endif
#define CUSTOM_FRAGMENT_UPDATE_METALLICROUGHNESS
microSurface=1.0-metallicRoughness.g;vec3 baseColor=surfaceAlbedo;
#ifdef FROSTBITE_REFLECTANCE
outParams.surfaceAlbedo=baseColor.rgb*(1.0-metallicRoughness.r);surfaceReflectivityColor=mix(0.16*reflectance*reflectance,baseColor,metallicRoughness.r);
#else
vec3 metallicF0=metallicReflectanceFactors.rgb;
#if DEBUGMODE>0
outParams.metallicF0=metallicF0;
#endif
outParams.surfaceAlbedo=mix(baseColor.rgb*(1.0-metallicF0),vec3(0.,0.,0.),metallicRoughness.r);surfaceReflectivityColor=mix(metallicF0,baseColor,metallicRoughness.r);
#endif
#else
#ifdef REFLECTIVITY
surfaceReflectivityColor*=surfaceMetallicOrReflectivityColorMap.rgb;
#if DEBUGMODE>0
outParams.surfaceReflectivityColorMap=surfaceMetallicOrReflectivityColorMap;
#endif
#ifdef MICROSURFACEFROMREFLECTIVITYMAP
microSurface*=surfaceMetallicOrReflectivityColorMap.a;microSurface*=reflectivityInfos.z;
#else
#ifdef MICROSURFACEAUTOMATIC
microSurface*=computeDefaultMicroSurface(microSurface,surfaceReflectivityColor);
#endif
#ifdef MICROSURFACEMAP
microSurface*=microSurfaceTexel.r;
#endif
#define CUSTOM_FRAGMENT_UPDATE_MICROSURFACE
#endif
#endif
#endif
microSurface=saturate(microSurface);float roughness=1.-microSurface;outParams.microSurface=microSurface;outParams.roughness=roughness;outParams.surfaceReflectivityColor=surfaceReflectivityColor;}
`;ne.IncludesShadersStore[Tj]=bj;const Cj="pbrBlockAmbientOcclusion",Aj=`struct ambientOcclusionOutParams
{vec3 ambientOcclusionColor;
#if DEBUGMODE>0 && defined(AMBIENT)
vec3 ambientOcclusionColorMap;
#endif
};
#define pbr_inline
void ambientOcclusionBlock(
#ifdef AMBIENT
in vec3 ambientOcclusionColorMap_,
in vec4 vAmbientInfos,
#endif
out ambientOcclusionOutParams outParams
)
{vec3 ambientOcclusionColor=vec3(1.,1.,1.);
#ifdef AMBIENT
vec3 ambientOcclusionColorMap=ambientOcclusionColorMap_*vAmbientInfos.y;
#ifdef AMBIENTINGRAYSCALE
ambientOcclusionColorMap=vec3(ambientOcclusionColorMap.r,ambientOcclusionColorMap.r,ambientOcclusionColorMap.r);
#endif
ambientOcclusionColor=mix(ambientOcclusionColor,ambientOcclusionColorMap,vAmbientInfos.z);
#if DEBUGMODE>0
outParams.ambientOcclusionColorMap=ambientOcclusionColorMap;
#endif
#endif
outParams.ambientOcclusionColor=ambientOcclusionColor;}
`;ne.IncludesShadersStore[Cj]=Aj;const Sj="pbrBlockAlphaFresnel",Rj=`#ifdef ALPHAFRESNEL
#if defined(ALPHATEST) || defined(ALPHABLEND)
struct alphaFresnelOutParams
{float alpha;};
#define pbr_inline
void alphaFresnelBlock(
in vec3 normalW,
in vec3 viewDirectionW,
in float alpha,
in float microSurface,
out alphaFresnelOutParams outParams
)
{float opacityPerceptual=alpha;
#ifdef LINEARALPHAFRESNEL
float opacity0=opacityPerceptual;
#else
float opacity0=opacityPerceptual*opacityPerceptual;
#endif
float opacity90=fresnelGrazingReflectance(opacity0);vec3 normalForward=faceforward(normalW,-viewDirectionW,normalW);outParams.alpha=getReflectanceFromAnalyticalBRDFLookup_Jones(saturate(dot(viewDirectionW,normalForward)),vec3(opacity0),vec3(opacity90),sqrt(microSurface)).x;
#ifdef ALPHATEST
if (outParams.alpha<ALPHATESTVALUE)
discard;
#ifndef ALPHABLEND
outParams.alpha=1.0;
#endif
#endif
}
#endif
#endif
`;ne.IncludesShadersStore[Sj]=Rj;const xj="pbrBlockAnisotropic",Mj=`#ifdef ANISOTROPIC
struct anisotropicOutParams
{float anisotropy;vec3 anisotropicTangent;vec3 anisotropicBitangent;vec3 anisotropicNormal;
#if DEBUGMODE>0 && defined(ANISOTROPIC_TEXTURE)
vec3 anisotropyMapData;
#endif
};
#define pbr_inline
void anisotropicBlock(
in vec3 vAnisotropy,
in float roughness,
#ifdef ANISOTROPIC_TEXTURE
in vec3 anisotropyMapData,
#endif
in mat3 TBN,
in vec3 normalW,
in vec3 viewDirectionW,
out anisotropicOutParams outParams
)
{float anisotropy=vAnisotropy.b;vec3 anisotropyDirection=vec3(vAnisotropy.xy,0.);
#ifdef ANISOTROPIC_TEXTURE
anisotropy*=anisotropyMapData.b;
#if DEBUGMODE>0
outParams.anisotropyMapData=anisotropyMapData;
#endif
anisotropyMapData.rg=anisotropyMapData.rg*2.0-1.0;
#ifdef ANISOTROPIC_LEGACY
anisotropyDirection.rg*=anisotropyMapData.rg;
#else
anisotropyDirection.xy=mat2(anisotropyDirection.x,anisotropyDirection.y,-anisotropyDirection.y,anisotropyDirection.x)*normalize(anisotropyMapData.rg);
#endif
#endif
mat3 anisoTBN=mat3(normalize(TBN[0]),normalize(TBN[1]),normalize(TBN[2]));vec3 anisotropicTangent=normalize(anisoTBN*anisotropyDirection);vec3 anisotropicBitangent=normalize(cross(anisoTBN[2],anisotropicTangent));outParams.anisotropy=anisotropy;outParams.anisotropicTangent=anisotropicTangent;outParams.anisotropicBitangent=anisotropicBitangent;outParams.anisotropicNormal=getAnisotropicBentNormals(anisotropicTangent,anisotropicBitangent,normalW,viewDirectionW,anisotropy,roughness);}
#endif
`;ne.IncludesShadersStore[xj]=Mj;const Ij="pbrBlockReflection",Pj=`#ifdef REFLECTION
struct reflectionOutParams
{vec4 environmentRadiance;vec3 environmentIrradiance;
#ifdef REFLECTIONMAP_3D
vec3 reflectionCoords;
#else
vec2 reflectionCoords;
#endif
#ifdef SS_TRANSLUCENCY
#ifdef USESPHERICALFROMREFLECTIONMAP
#if !defined(NORMAL) || !defined(USESPHERICALINVERTEX)
vec3 irradianceVector;
#endif
#endif
#endif
};
#define pbr_inline
void createReflectionCoords(
in vec3 vPositionW,
in vec3 normalW,
#ifdef ANISOTROPIC
in anisotropicOutParams anisotropicOut,
#endif
#ifdef REFLECTIONMAP_3D
out vec3 reflectionCoords
#else
out vec2 reflectionCoords
#endif
)
{
#ifdef ANISOTROPIC
vec3 reflectionVector=computeReflectionCoords(vec4(vPositionW,1.0),anisotropicOut.anisotropicNormal);
#else
vec3 reflectionVector=computeReflectionCoords(vec4(vPositionW,1.0),normalW);
#endif
#ifdef REFLECTIONMAP_OPPOSITEZ
reflectionVector.z*=-1.0;
#endif
#ifdef REFLECTIONMAP_3D
reflectionCoords=reflectionVector;
#else
reflectionCoords=reflectionVector.xy;
#ifdef REFLECTIONMAP_PROJECTION
reflectionCoords/=reflectionVector.z;
#endif
reflectionCoords.y=1.0-reflectionCoords.y;
#endif
}
#define pbr_inline
#define inline
void sampleReflectionTexture(
in float alphaG,
in vec3 vReflectionMicrosurfaceInfos,
in vec2 vReflectionInfos,
in vec3 vReflectionColor,
#if defined(LODINREFLECTIONALPHA) && !defined(REFLECTIONMAP_SKYBOX)
in float NdotVUnclamped,
#endif
#ifdef LINEARSPECULARREFLECTION
in float roughness,
#endif
#ifdef REFLECTIONMAP_3D
in samplerCube reflectionSampler,
const vec3 reflectionCoords,
#else
in sampler2D reflectionSampler,
const vec2 reflectionCoords,
#endif
#ifndef LODBASEDMICROSFURACE
#ifdef REFLECTIONMAP_3D
in samplerCube reflectionSamplerLow,
in samplerCube reflectionSamplerHigh,
#else
in sampler2D reflectionSamplerLow,
in sampler2D reflectionSamplerHigh,
#endif
#endif
#ifdef REALTIME_FILTERING
in vec2 vReflectionFilteringInfo,
#endif
out vec4 environmentRadiance
)
{
#if defined(LODINREFLECTIONALPHA) && !defined(REFLECTIONMAP_SKYBOX)
float reflectionLOD=getLodFromAlphaG(vReflectionMicrosurfaceInfos.x,alphaG,NdotVUnclamped);
#elif defined(LINEARSPECULARREFLECTION)
float reflectionLOD=getLinearLodFromRoughness(vReflectionMicrosurfaceInfos.x,roughness);
#else
float reflectionLOD=getLodFromAlphaG(vReflectionMicrosurfaceInfos.x,alphaG);
#endif
#ifdef LODBASEDMICROSFURACE
reflectionLOD=reflectionLOD*vReflectionMicrosurfaceInfos.y+vReflectionMicrosurfaceInfos.z;
#ifdef LODINREFLECTIONALPHA
float automaticReflectionLOD=UNPACK_LOD(sampleReflection(reflectionSampler,reflectionCoords).a);float requestedReflectionLOD=max(automaticReflectionLOD,reflectionLOD);
#else
float requestedReflectionLOD=reflectionLOD;
#endif
#ifdef REALTIME_FILTERING
environmentRadiance=vec4(radiance(alphaG,reflectionSampler,reflectionCoords,vReflectionFilteringInfo),1.0);
#else
environmentRadiance=sampleReflectionLod(reflectionSampler,reflectionCoords,reflectionLOD);
#endif
#else
float lodReflectionNormalized=saturate(reflectionLOD/log2(vReflectionMicrosurfaceInfos.x));float lodReflectionNormalizedDoubled=lodReflectionNormalized*2.0;vec4 environmentMid=sampleReflection(reflectionSampler,reflectionCoords);if (lodReflectionNormalizedDoubled<1.0){environmentRadiance=mix(
sampleReflection(reflectionSamplerHigh,reflectionCoords),
environmentMid,
lodReflectionNormalizedDoubled
);} else {environmentRadiance=mix(
environmentMid,
sampleReflection(reflectionSamplerLow,reflectionCoords),
lodReflectionNormalizedDoubled-1.0
);}
#endif
#ifdef RGBDREFLECTION
environmentRadiance.rgb=fromRGBD(environmentRadiance);
#endif
#ifdef GAMMAREFLECTION
environmentRadiance.rgb=toLinearSpace(environmentRadiance.rgb);
#endif
environmentRadiance.rgb*=vReflectionInfos.x;environmentRadiance.rgb*=vReflectionColor.rgb;}
#define pbr_inline
#define inline
void reflectionBlock(
in vec3 vPositionW,
in vec3 normalW,
in float alphaG,
in vec3 vReflectionMicrosurfaceInfos,
in vec2 vReflectionInfos,
in vec3 vReflectionColor,
#ifdef ANISOTROPIC
in anisotropicOutParams anisotropicOut,
#endif
#if defined(LODINREFLECTIONALPHA) && !defined(REFLECTIONMAP_SKYBOX)
in float NdotVUnclamped,
#endif
#ifdef LINEARSPECULARREFLECTION
in float roughness,
#endif
#ifdef REFLECTIONMAP_3D
in samplerCube reflectionSampler,
#else
in sampler2D reflectionSampler,
#endif
#if defined(NORMAL) && defined(USESPHERICALINVERTEX)
in vec3 vEnvironmentIrradiance,
#endif
#ifdef USESPHERICALFROMREFLECTIONMAP
#if !defined(NORMAL) || !defined(USESPHERICALINVERTEX)
in mat4 reflectionMatrix,
#endif
#endif
#ifdef USEIRRADIANCEMAP
#ifdef REFLECTIONMAP_3D
in samplerCube irradianceSampler,
#else
in sampler2D irradianceSampler,
#endif
#endif
#ifndef LODBASEDMICROSFURACE
#ifdef REFLECTIONMAP_3D
in samplerCube reflectionSamplerLow,
in samplerCube reflectionSamplerHigh,
#else
in sampler2D reflectionSamplerLow,
in sampler2D reflectionSamplerHigh,
#endif
#endif
#ifdef REALTIME_FILTERING
in vec2 vReflectionFilteringInfo,
#endif
out reflectionOutParams outParams
)
{vec4 environmentRadiance=vec4(0.,0.,0.,0.);
#ifdef REFLECTIONMAP_3D
vec3 reflectionCoords=vec3(0.);
#else
vec2 reflectionCoords=vec2(0.);
#endif
createReflectionCoords(
vPositionW,
normalW,
#ifdef ANISOTROPIC
anisotropicOut,
#endif
reflectionCoords
);sampleReflectionTexture(
alphaG,
vReflectionMicrosurfaceInfos,
vReflectionInfos,
vReflectionColor,
#if defined(LODINREFLECTIONALPHA) && !defined(REFLECTIONMAP_SKYBOX)
NdotVUnclamped,
#endif
#ifdef LINEARSPECULARREFLECTION
roughness,
#endif
#ifdef REFLECTIONMAP_3D
reflectionSampler,
reflectionCoords,
#else
reflectionSampler,
reflectionCoords,
#endif
#ifndef LODBASEDMICROSFURACE
reflectionSamplerLow,
reflectionSamplerHigh,
#endif
#ifdef REALTIME_FILTERING
vReflectionFilteringInfo,
#endif
environmentRadiance
);vec3 environmentIrradiance=vec3(0.,0.,0.);
#ifdef USESPHERICALFROMREFLECTIONMAP
#if defined(NORMAL) && defined(USESPHERICALINVERTEX)
environmentIrradiance=vEnvironmentIrradiance;
#else
#ifdef ANISOTROPIC
vec3 irradianceVector=vec3(reflectionMatrix*vec4(anisotropicOut.anisotropicNormal,0)).xyz;
#else
vec3 irradianceVector=vec3(reflectionMatrix*vec4(normalW,0)).xyz;
#endif
#ifdef REFLECTIONMAP_OPPOSITEZ
irradianceVector.z*=-1.0;
#endif
#ifdef INVERTCUBICMAP
irradianceVector.y*=-1.0;
#endif
#if defined(REALTIME_FILTERING)
environmentIrradiance=irradiance(reflectionSampler,irradianceVector,vReflectionFilteringInfo);
#else
environmentIrradiance=computeEnvironmentIrradiance(irradianceVector);
#endif
#ifdef SS_TRANSLUCENCY
outParams.irradianceVector=irradianceVector;
#endif
#endif
#elif defined(USEIRRADIANCEMAP)
vec4 environmentIrradiance4=sampleReflection(irradianceSampler,reflectionCoords);environmentIrradiance=environmentIrradiance4.rgb;
#ifdef RGBDREFLECTION
environmentIrradiance.rgb=fromRGBD(environmentIrradiance4);
#endif
#ifdef GAMMAREFLECTION
environmentIrradiance.rgb=toLinearSpace(environmentIrradiance.rgb);
#endif
#endif
environmentIrradiance*=vReflectionColor.rgb;outParams.environmentRadiance=environmentRadiance;outParams.environmentIrradiance=environmentIrradiance;outParams.reflectionCoords=reflectionCoords;}
#endif
`;ne.IncludesShadersStore[Ij]=Pj;const wj="pbrBlockSheen",Oj=`#ifdef SHEEN
struct sheenOutParams
{float sheenIntensity;vec3 sheenColor;float sheenRoughness;
#ifdef SHEEN_LINKWITHALBEDO
vec3 surfaceAlbedo;
#endif
#if defined(ENVIRONMENTBRDF) && defined(SHEEN_ALBEDOSCALING)
float sheenAlbedoScaling;
#endif
#if defined(REFLECTION) && defined(ENVIRONMENTBRDF)
vec3 finalSheenRadianceScaled;
#endif
#if DEBUGMODE>0
#ifdef SHEEN_TEXTURE
vec4 sheenMapData;
#endif
#if defined(REFLECTION) && defined(ENVIRONMENTBRDF)
vec3 sheenEnvironmentReflectance;
#endif
#endif
};
#define pbr_inline
#define inline
void sheenBlock(
in vec4 vSheenColor,
#ifdef SHEEN_ROUGHNESS
in float vSheenRoughness,
#if defined(SHEEN_TEXTURE_ROUGHNESS) && !defined(SHEEN_TEXTURE_ROUGHNESS_IDENTICAL) && !defined(SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE)
in vec4 sheenMapRoughnessData,
#endif
#endif
in float roughness,
#ifdef SHEEN_TEXTURE
in vec4 sheenMapData,
in float sheenMapLevel,
#endif
in float reflectance,
#ifdef SHEEN_LINKWITHALBEDO
in vec3 baseColor,
in vec3 surfaceAlbedo,
#endif
#ifdef ENVIRONMENTBRDF
in float NdotV,
in vec3 environmentBrdf,
#endif
#if defined(REFLECTION) && defined(ENVIRONMENTBRDF)
in vec2 AARoughnessFactors,
in vec3 vReflectionMicrosurfaceInfos,
in vec2 vReflectionInfos,
in vec3 vReflectionColor,
in vec4 vLightingIntensity,
#ifdef REFLECTIONMAP_3D
in samplerCube reflectionSampler,
in vec3 reflectionCoords,
#else
in sampler2D reflectionSampler,
in vec2 reflectionCoords,
#endif
in float NdotVUnclamped,
#ifndef LODBASEDMICROSFURACE
#ifdef REFLECTIONMAP_3D
in samplerCube reflectionSamplerLow,
in samplerCube reflectionSamplerHigh,
#else
in sampler2D reflectionSamplerLow,
in sampler2D reflectionSamplerHigh,
#endif
#endif
#ifdef REALTIME_FILTERING
in vec2 vReflectionFilteringInfo,
#endif
#if !defined(REFLECTIONMAP_SKYBOX) && defined(RADIANCEOCCLUSION)
in float seo,
#endif
#if !defined(REFLECTIONMAP_SKYBOX) && defined(HORIZONOCCLUSION) && defined(BUMP) && defined(REFLECTIONMAP_3D)
in float eho,
#endif
#endif
out sheenOutParams outParams
)
{float sheenIntensity=vSheenColor.a;
#ifdef SHEEN_TEXTURE
#if DEBUGMODE>0
outParams.sheenMapData=sheenMapData;
#endif
#endif
#ifdef SHEEN_LINKWITHALBEDO
float sheenFactor=pow5(1.0-sheenIntensity);vec3 sheenColor=baseColor.rgb*(1.0-sheenFactor);float sheenRoughness=sheenIntensity;outParams.surfaceAlbedo=surfaceAlbedo*sheenFactor;
#ifdef SHEEN_TEXTURE
sheenIntensity*=sheenMapData.a;
#endif
#else
vec3 sheenColor=vSheenColor.rgb;
#ifdef SHEEN_TEXTURE
#ifdef SHEEN_GAMMATEXTURE
sheenColor.rgb*=toLinearSpace(sheenMapData.rgb);
#else
sheenColor.rgb*=sheenMapData.rgb;
#endif
sheenColor.rgb*=sheenMapLevel;
#endif
#ifdef SHEEN_ROUGHNESS
float sheenRoughness=vSheenRoughness;
#ifdef SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE
#if defined(SHEEN_TEXTURE)
sheenRoughness*=sheenMapData.a;
#endif
#elif defined(SHEEN_TEXTURE_ROUGHNESS)
#ifdef SHEEN_TEXTURE_ROUGHNESS_IDENTICAL
sheenRoughness*=sheenMapData.a;
#else
sheenRoughness*=sheenMapRoughnessData.a;
#endif
#endif
#else
float sheenRoughness=roughness;
#ifdef SHEEN_TEXTURE
sheenIntensity*=sheenMapData.a;
#endif
#endif
#if !defined(SHEEN_ALBEDOSCALING)
sheenIntensity*=(1.-reflectance);
#endif
sheenColor*=sheenIntensity;
#endif
#ifdef ENVIRONMENTBRDF
/*#ifdef SHEEN_SOFTER
vec3 environmentSheenBrdf=vec3(0.,0.,getBRDFLookupCharlieSheen(NdotV,sheenRoughness));
#else*/
#ifdef SHEEN_ROUGHNESS
vec3 environmentSheenBrdf=getBRDFLookup(NdotV,sheenRoughness);
#else
vec3 environmentSheenBrdf=environmentBrdf;
#endif
/*#endif*/
#endif
#if defined(REFLECTION) && defined(ENVIRONMENTBRDF)
float sheenAlphaG=convertRoughnessToAverageSlope(sheenRoughness);
#ifdef SPECULARAA
sheenAlphaG+=AARoughnessFactors.y;
#endif
vec4 environmentSheenRadiance=vec4(0.,0.,0.,0.);sampleReflectionTexture(
sheenAlphaG,
vReflectionMicrosurfaceInfos,
vReflectionInfos,
vReflectionColor,
#if defined(LODINREFLECTIONALPHA) && !defined(REFLECTIONMAP_SKYBOX)
NdotVUnclamped,
#endif
#ifdef LINEARSPECULARREFLECTION
sheenRoughness,
#endif
reflectionSampler,
reflectionCoords,
#ifndef LODBASEDMICROSFURACE
reflectionSamplerLow,
reflectionSamplerHigh,
#endif
#ifdef REALTIME_FILTERING
vReflectionFilteringInfo,
#endif
environmentSheenRadiance
);vec3 sheenEnvironmentReflectance=getSheenReflectanceFromBRDFLookup(sheenColor,environmentSheenBrdf);
#if !defined(REFLECTIONMAP_SKYBOX) && defined(RADIANCEOCCLUSION)
sheenEnvironmentReflectance*=seo;
#endif
#if !defined(REFLECTIONMAP_SKYBOX) && defined(HORIZONOCCLUSION) && defined(BUMP) && defined(REFLECTIONMAP_3D)
sheenEnvironmentReflectance*=eho;
#endif
#if DEBUGMODE>0
outParams.sheenEnvironmentReflectance=sheenEnvironmentReflectance;
#endif
outParams.finalSheenRadianceScaled=
environmentSheenRadiance.rgb *
sheenEnvironmentReflectance *
vLightingIntensity.z;
#endif
#if defined(ENVIRONMENTBRDF) && defined(SHEEN_ALBEDOSCALING)
outParams.sheenAlbedoScaling=1.0-sheenIntensity*max(max(sheenColor.r,sheenColor.g),sheenColor.b)*environmentSheenBrdf.b;
#endif
outParams.sheenIntensity=sheenIntensity;outParams.sheenColor=sheenColor;outParams.sheenRoughness=sheenRoughness;}
#endif
`;ne.IncludesShadersStore[wj]=Oj;const Dj="pbrBlockClearcoat",Lj=`struct clearcoatOutParams
{vec3 specularEnvironmentR0;float conservationFactor;vec3 clearCoatNormalW;vec2 clearCoatAARoughnessFactors;float clearCoatIntensity;float clearCoatRoughness;
#ifdef REFLECTION
vec3 finalClearCoatRadianceScaled;
#endif
#ifdef CLEARCOAT_TINT
vec3 absorption;float clearCoatNdotVRefract;vec3 clearCoatColor;float clearCoatThickness;
#endif
#if defined(ENVIRONMENTBRDF) && defined(MS_BRDF_ENERGY_CONSERVATION)
vec3 energyConservationFactorClearCoat;
#endif
#if DEBUGMODE>0
#ifdef CLEARCOAT_BUMP
mat3 TBNClearCoat;
#endif
#ifdef CLEARCOAT_TEXTURE
vec2 clearCoatMapData;
#endif
#if defined(CLEARCOAT_TINT) && defined(CLEARCOAT_TINT_TEXTURE)
vec4 clearCoatTintMapData;
#endif
#ifdef REFLECTION
vec4 environmentClearCoatRadiance;vec3 clearCoatEnvironmentReflectance;
#endif
float clearCoatNdotV;
#endif
};
#ifdef CLEARCOAT
#define pbr_inline
#define inline
void clearcoatBlock(
in vec3 vPositionW,
in vec3 geometricNormalW,
in vec3 viewDirectionW,
in vec2 vClearCoatParams,
#if defined(CLEARCOAT_TEXTURE_ROUGHNESS) && !defined(CLEARCOAT_TEXTURE_ROUGHNESS_IDENTICAL) && !defined(CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE)
in vec4 clearCoatMapRoughnessData,
#endif
in vec3 specularEnvironmentR0,
#ifdef CLEARCOAT_TEXTURE
in vec2 clearCoatMapData,
#endif
#ifdef CLEARCOAT_TINT
in vec4 vClearCoatTintParams,
in float clearCoatColorAtDistance,
in vec4 vClearCoatRefractionParams,
#ifdef CLEARCOAT_TINT_TEXTURE
in vec4 clearCoatTintMapData,
#endif
#endif
#ifdef CLEARCOAT_BUMP
in vec2 vClearCoatBumpInfos,
in vec4 clearCoatBumpMapData,
in vec2 vClearCoatBumpUV,
#if defined(TANGENT) && defined(NORMAL)
in mat3 vTBN,
#else
in vec2 vClearCoatTangentSpaceParams,
#endif
#ifdef OBJECTSPACE_NORMALMAP
in mat4 normalMatrix,
#endif
#endif
#if defined(FORCENORMALFORWARD) && defined(NORMAL)
in vec3 faceNormal,
#endif
#ifdef REFLECTION
in vec3 vReflectionMicrosurfaceInfos,
in vec2 vReflectionInfos,
in vec3 vReflectionColor,
in vec4 vLightingIntensity,
#ifdef REFLECTIONMAP_3D
in samplerCube reflectionSampler,
#else
in sampler2D reflectionSampler,
#endif
#ifndef LODBASEDMICROSFURACE
#ifdef REFLECTIONMAP_3D
in samplerCube reflectionSamplerLow,
in samplerCube reflectionSamplerHigh,
#else
in sampler2D reflectionSamplerLow,
in sampler2D reflectionSamplerHigh,
#endif
#endif
#ifdef REALTIME_FILTERING
in vec2 vReflectionFilteringInfo,
#endif
#endif
#if defined(ENVIRONMENTBRDF) && !defined(REFLECTIONMAP_SKYBOX)
#ifdef RADIANCEOCCLUSION
in float ambientMonochrome,
#endif
#endif
#if defined(CLEARCOAT_BUMP) || defined(TWOSIDEDLIGHTING)
in float frontFacingMultiplier,
#endif
out clearcoatOutParams outParams
)
{float clearCoatIntensity=vClearCoatParams.x;float clearCoatRoughness=vClearCoatParams.y;
#ifdef CLEARCOAT_TEXTURE
clearCoatIntensity*=clearCoatMapData.x;
#ifdef CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE
clearCoatRoughness*=clearCoatMapData.y;
#endif
#if DEBUGMODE>0
outParams.clearCoatMapData=clearCoatMapData;
#endif
#endif
#if defined(CLEARCOAT_TEXTURE_ROUGHNESS) && !defined(CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE)
#ifdef CLEARCOAT_TEXTURE_ROUGHNESS_IDENTICAL
clearCoatRoughness*=clearCoatMapData.y;
#else
clearCoatRoughness*=clearCoatMapRoughnessData.y;
#endif
#endif
outParams.clearCoatIntensity=clearCoatIntensity;outParams.clearCoatRoughness=clearCoatRoughness;
#ifdef CLEARCOAT_TINT
vec3 clearCoatColor=vClearCoatTintParams.rgb;float clearCoatThickness=vClearCoatTintParams.a;
#ifdef CLEARCOAT_TINT_TEXTURE
#ifdef CLEARCOAT_TINT_GAMMATEXTURE
clearCoatColor*=toLinearSpace(clearCoatTintMapData.rgb);
#else
clearCoatColor*=clearCoatTintMapData.rgb;
#endif
clearCoatThickness*=clearCoatTintMapData.a;
#if DEBUGMODE>0
outParams.clearCoatTintMapData=clearCoatTintMapData;
#endif
#endif
outParams.clearCoatColor=computeColorAtDistanceInMedia(clearCoatColor,clearCoatColorAtDistance);outParams.clearCoatThickness=clearCoatThickness;
#endif
#ifdef CLEARCOAT_REMAP_F0
vec3 specularEnvironmentR0Updated=getR0RemappedForClearCoat(specularEnvironmentR0);
#else
vec3 specularEnvironmentR0Updated=specularEnvironmentR0;
#endif
outParams.specularEnvironmentR0=mix(specularEnvironmentR0,specularEnvironmentR0Updated,clearCoatIntensity);vec3 clearCoatNormalW=geometricNormalW;
#ifdef CLEARCOAT_BUMP
#ifdef NORMALXYSCALE
float clearCoatNormalScale=1.0;
#else
float clearCoatNormalScale=vClearCoatBumpInfos.y;
#endif
#if defined(TANGENT) && defined(NORMAL)
mat3 TBNClearCoat=vTBN;
#else
vec2 TBNClearCoatUV=vClearCoatBumpUV*frontFacingMultiplier;mat3 TBNClearCoat=cotangent_frame(clearCoatNormalW*clearCoatNormalScale,vPositionW,TBNClearCoatUV,vClearCoatTangentSpaceParams);
#endif
#if DEBUGMODE>0
outParams.TBNClearCoat=TBNClearCoat;
#endif
#ifdef OBJECTSPACE_NORMALMAP
clearCoatNormalW=normalize(clearCoatBumpMapData.xyz *2.0-1.0);clearCoatNormalW=normalize(mat3(normalMatrix)*clearCoatNormalW);
#else
clearCoatNormalW=perturbNormal(TBNClearCoat,clearCoatBumpMapData.xyz,vClearCoatBumpInfos.y);
#endif
#endif
#if defined(FORCENORMALFORWARD) && defined(NORMAL)
clearCoatNormalW*=sign(dot(clearCoatNormalW,faceNormal));
#endif
#if defined(TWOSIDEDLIGHTING) && defined(NORMAL)
clearCoatNormalW=clearCoatNormalW*frontFacingMultiplier;
#endif
outParams.clearCoatNormalW=clearCoatNormalW;outParams.clearCoatAARoughnessFactors=getAARoughnessFactors(clearCoatNormalW.xyz);float clearCoatNdotVUnclamped=dot(clearCoatNormalW,viewDirectionW);float clearCoatNdotV=absEps(clearCoatNdotVUnclamped);
#if DEBUGMODE>0
outParams.clearCoatNdotV=clearCoatNdotV;
#endif
#ifdef CLEARCOAT_TINT
vec3 clearCoatVRefract=refract(-viewDirectionW,clearCoatNormalW,vClearCoatRefractionParams.y);outParams.clearCoatNdotVRefract=absEps(dot(clearCoatNormalW,clearCoatVRefract));
#endif
#if defined(ENVIRONMENTBRDF) && (!defined(REFLECTIONMAP_SKYBOX) || defined(MS_BRDF_ENERGY_CONSERVATION))
vec3 environmentClearCoatBrdf=getBRDFLookup(clearCoatNdotV,clearCoatRoughness);
#endif
#if defined(REFLECTION)
float clearCoatAlphaG=convertRoughnessToAverageSlope(clearCoatRoughness);
#ifdef SPECULARAA
clearCoatAlphaG+=outParams.clearCoatAARoughnessFactors.y;
#endif
vec4 environmentClearCoatRadiance=vec4(0.,0.,0.,0.);vec3 clearCoatReflectionVector=computeReflectionCoords(vec4(vPositionW,1.0),clearCoatNormalW);
#ifdef REFLECTIONMAP_OPPOSITEZ
clearCoatReflectionVector.z*=-1.0;
#endif
#ifdef REFLECTIONMAP_3D
vec3 clearCoatReflectionCoords=clearCoatReflectionVector;
#else
vec2 clearCoatReflectionCoords=clearCoatReflectionVector.xy;
#ifdef REFLECTIONMAP_PROJECTION
clearCoatReflectionCoords/=clearCoatReflectionVector.z;
#endif
clearCoatReflectionCoords.y=1.0-clearCoatReflectionCoords.y;
#endif
sampleReflectionTexture(
clearCoatAlphaG,
vReflectionMicrosurfaceInfos,
vReflectionInfos,
vReflectionColor,
#if defined(LODINREFLECTIONALPHA) && !defined(REFLECTIONMAP_SKYBOX)
clearCoatNdotVUnclamped,
#endif
#ifdef LINEARSPECULARREFLECTION
clearCoatRoughness,
#endif
reflectionSampler,
clearCoatReflectionCoords,
#ifndef LODBASEDMICROSFURACE
reflectionSamplerLow,
reflectionSamplerHigh,
#endif
#ifdef REALTIME_FILTERING
vReflectionFilteringInfo,
#endif
environmentClearCoatRadiance
);
#if DEBUGMODE>0
outParams.environmentClearCoatRadiance=environmentClearCoatRadiance;
#endif
#if defined(ENVIRONMENTBRDF) && !defined(REFLECTIONMAP_SKYBOX)
vec3 clearCoatEnvironmentReflectance=getReflectanceFromBRDFLookup(vec3(vClearCoatRefractionParams.x),environmentClearCoatBrdf);
#ifdef HORIZONOCCLUSION
#ifdef BUMP
#ifdef REFLECTIONMAP_3D
float clearCoatEho=environmentHorizonOcclusion(-viewDirectionW,clearCoatNormalW,geometricNormalW);clearCoatEnvironmentReflectance*=clearCoatEho;
#endif
#endif
#endif
#else
vec3 clearCoatEnvironmentReflectance=getReflectanceFromAnalyticalBRDFLookup_Jones(clearCoatNdotV,vec3(1.),vec3(1.),sqrt(1.-clearCoatRoughness));
#endif
clearCoatEnvironmentReflectance*=clearCoatIntensity;
#if DEBUGMODE>0
outParams.clearCoatEnvironmentReflectance=clearCoatEnvironmentReflectance;
#endif
outParams.finalClearCoatRadianceScaled=
environmentClearCoatRadiance.rgb *
clearCoatEnvironmentReflectance *
vLightingIntensity.z;
#endif
#if defined(CLEARCOAT_TINT)
outParams.absorption=computeClearCoatAbsorption(outParams.clearCoatNdotVRefract,outParams.clearCoatNdotVRefract,outParams.clearCoatColor,clearCoatThickness,clearCoatIntensity);
#endif
float fresnelIBLClearCoat=fresnelSchlickGGX(clearCoatNdotV,vClearCoatRefractionParams.x,CLEARCOATREFLECTANCE90);fresnelIBLClearCoat*=clearCoatIntensity;outParams.conservationFactor=(1.-fresnelIBLClearCoat);
#if defined(ENVIRONMENTBRDF) && defined(MS_BRDF_ENERGY_CONSERVATION)
outParams.energyConservationFactorClearCoat=getEnergyConservationFactor(outParams.specularEnvironmentR0,environmentClearCoatBrdf);
#endif
}
#endif
`;ne.IncludesShadersStore[Dj]=Lj;const Nj="pbrBlockIridescence",Fj=`struct iridescenceOutParams
{float iridescenceIntensity;float iridescenceIOR;float iridescenceThickness;vec3 specularEnvironmentR0;};
#ifdef IRIDESCENCE
#define pbr_inline
#define inline
void iridescenceBlock(
in vec4 vIridescenceParams,
in float viewAngle,
in vec3 specularEnvironmentR0,
#ifdef IRIDESCENCE_TEXTURE
in vec2 iridescenceMapData,
#endif
#ifdef IRIDESCENCE_THICKNESS_TEXTURE
in vec2 iridescenceThicknessMapData,
#endif
#ifdef CLEARCOAT
in float NdotVUnclamped,
#ifdef CLEARCOAT_TEXTURE
in vec2 clearCoatMapData,
#endif
#endif
out iridescenceOutParams outParams
)
{float iridescenceIntensity=vIridescenceParams.x;float iridescenceIOR=vIridescenceParams.y;float iridescenceThicknessMin=vIridescenceParams.z;float iridescenceThicknessMax=vIridescenceParams.w;float iridescenceThicknessWeight=1.;
#ifdef IRIDESCENCE_TEXTURE
iridescenceIntensity*=iridescenceMapData.x;
#ifdef IRIDESCENCE_USE_THICKNESS_FROM_MAINTEXTURE
iridescenceThicknessWeight=iridescenceMapData.g;
#endif
#endif
#if defined(IRIDESCENCE_THICKNESS_TEXTURE)
iridescenceThicknessWeight=iridescenceThicknessMapData.g;
#endif
float iridescenceThickness=mix(iridescenceThicknessMin,iridescenceThicknessMax,iridescenceThicknessWeight);float topIor=1.; 
#ifdef CLEARCOAT
float clearCoatIntensity=vClearCoatParams.x;
#ifdef CLEARCOAT_TEXTURE
clearCoatIntensity*=clearCoatMapData.x;
#endif
topIor=mix(1.0,vClearCoatRefractionParams.w-1.,clearCoatIntensity);viewAngle=sqrt(1.0+square(1.0/topIor)*(square(NdotVUnclamped)-1.0));
#endif
vec3 iridescenceFresnel=evalIridescence(topIor,iridescenceIOR,viewAngle,iridescenceThickness,specularEnvironmentR0);outParams.specularEnvironmentR0=mix(specularEnvironmentR0,iridescenceFresnel,iridescenceIntensity);outParams.iridescenceIntensity=iridescenceIntensity;outParams.iridescenceThickness=iridescenceThickness;outParams.iridescenceIOR=iridescenceIOR;}
#endif
`;ne.IncludesShadersStore[Nj]=Fj;const kj="pbrBlockSubSurface",Bj=`struct subSurfaceOutParams
{vec3 specularEnvironmentReflectance;
#ifdef SS_REFRACTION
vec3 finalRefraction;vec3 surfaceAlbedo;
#ifdef SS_LINKREFRACTIONTOTRANSPARENCY
float alpha;
#endif
#ifdef REFLECTION
float refractionFactorForIrradiance;
#endif
#endif
#ifdef SS_TRANSLUCENCY
vec3 transmittance;float translucencyIntensity;
#ifdef REFLECTION
vec3 refractionIrradiance;
#endif
#endif
#if DEBUGMODE>0
#ifdef SS_THICKNESSANDMASK_TEXTURE
vec4 thicknessMap;
#endif
#ifdef SS_REFRACTION
vec4 environmentRefraction;vec3 refractionTransmittance;
#endif
#endif
};
#ifdef SUBSURFACE
#ifdef SS_REFRACTION
#define pbr_inline
#define inline
vec4 sampleEnvironmentRefraction(
in float ior
,in float thickness
,in float refractionLOD
,in vec3 normalW
,in vec3 vPositionW
,in vec3 viewDirectionW
,in mat4 view
,in vec4 vRefractionInfos
,in mat4 refractionMatrix
,in vec4 vRefractionMicrosurfaceInfos
,in float alphaG
#ifdef SS_REFRACTIONMAP_3D
,in samplerCube refractionSampler
#ifndef LODBASEDMICROSFURACE
,in samplerCube refractionSamplerLow
,in samplerCube refractionSamplerHigh
#endif
#else
,in sampler2D refractionSampler
#ifndef LODBASEDMICROSFURACE
,in sampler2D refractionSamplerLow
,in sampler2D refractionSamplerHigh
#endif
#endif
#ifdef ANISOTROPIC
,in anisotropicOutParams anisotropicOut
#endif
#ifdef REALTIME_FILTERING
,in vec2 vRefractionFilteringInfo
#endif
#ifdef SS_USE_LOCAL_REFRACTIONMAP_CUBIC
,in vec3 refractionPosition
,in vec3 refractionSize
#endif
) {vec4 environmentRefraction=vec4(0.,0.,0.,0.);
#ifdef ANISOTROPIC
vec3 refractionVector=refract(-viewDirectionW,anisotropicOut.anisotropicNormal,ior);
#else
vec3 refractionVector=refract(-viewDirectionW,normalW,ior);
#endif
#ifdef SS_REFRACTIONMAP_OPPOSITEZ
refractionVector.z*=-1.0;
#endif
#ifdef SS_REFRACTIONMAP_3D
#ifdef SS_USE_LOCAL_REFRACTIONMAP_CUBIC
refractionVector=parallaxCorrectNormal(vPositionW,refractionVector,refractionSize,refractionPosition);
#endif
refractionVector.y=refractionVector.y*vRefractionInfos.w;vec3 refractionCoords=refractionVector;refractionCoords=vec3(refractionMatrix*vec4(refractionCoords,0));
#else
#ifdef SS_USE_THICKNESS_AS_DEPTH
vec3 vRefractionUVW=vec3(refractionMatrix*(view*vec4(vPositionW+refractionVector*thickness,1.0)));
#else
vec3 vRefractionUVW=vec3(refractionMatrix*(view*vec4(vPositionW+refractionVector*vRefractionInfos.z,1.0)));
#endif
vec2 refractionCoords=vRefractionUVW.xy/vRefractionUVW.z;refractionCoords.y=1.0-refractionCoords.y;
#endif
#ifdef LODBASEDMICROSFURACE
refractionLOD=refractionLOD*vRefractionMicrosurfaceInfos.y+vRefractionMicrosurfaceInfos.z;
#ifdef SS_LODINREFRACTIONALPHA
float automaticRefractionLOD=UNPACK_LOD(sampleRefraction(refractionSampler,refractionCoords).a);float requestedRefractionLOD=max(automaticRefractionLOD,refractionLOD);
#else
float requestedRefractionLOD=refractionLOD;
#endif
#if defined(REALTIME_FILTERING) && defined(SS_REFRACTIONMAP_3D)
environmentRefraction=vec4(radiance(alphaG,refractionSampler,refractionCoords,vRefractionFilteringInfo),1.0);
#else
environmentRefraction=sampleRefractionLod(refractionSampler,refractionCoords,requestedRefractionLOD);
#endif
#else
float lodRefractionNormalized=saturate(refractionLOD/log2(vRefractionMicrosurfaceInfos.x));float lodRefractionNormalizedDoubled=lodRefractionNormalized*2.0;vec4 environmentRefractionMid=sampleRefraction(refractionSampler,refractionCoords);if (lodRefractionNormalizedDoubled<1.0){environmentRefraction=mix(
sampleRefraction(refractionSamplerHigh,refractionCoords),
environmentRefractionMid,
lodRefractionNormalizedDoubled
);} else {environmentRefraction=mix(
environmentRefractionMid,
sampleRefraction(refractionSamplerLow,refractionCoords),
lodRefractionNormalizedDoubled-1.0
);}
#endif
#ifdef SS_RGBDREFRACTION
environmentRefraction.rgb=fromRGBD(environmentRefraction);
#endif
#ifdef SS_GAMMAREFRACTION
environmentRefraction.rgb=toLinearSpace(environmentRefraction.rgb);
#endif
return environmentRefraction;}
#endif
#define pbr_inline
#define inline
void subSurfaceBlock(
in vec3 vSubSurfaceIntensity,
in vec2 vThicknessParam,
in vec4 vTintColor,
in vec3 normalW,
in vec3 specularEnvironmentReflectance,
#ifdef SS_THICKNESSANDMASK_TEXTURE
in vec4 thicknessMap,
#endif
#ifdef SS_REFRACTIONINTENSITY_TEXTURE
in vec4 refractionIntensityMap,
#endif
#ifdef SS_TRANSLUCENCYINTENSITY_TEXTURE
in vec4 translucencyIntensityMap,
#endif
#ifdef REFLECTION
#ifdef SS_TRANSLUCENCY
in mat4 reflectionMatrix,
#ifdef USESPHERICALFROMREFLECTIONMAP
#if !defined(NORMAL) || !defined(USESPHERICALINVERTEX)
in vec3 irradianceVector_,
#endif
#if defined(REALTIME_FILTERING)
in samplerCube reflectionSampler,
in vec2 vReflectionFilteringInfo,
#endif
#endif
#ifdef USEIRRADIANCEMAP
#ifdef REFLECTIONMAP_3D
in samplerCube irradianceSampler,
#else
in sampler2D irradianceSampler,
#endif
#endif
#endif
#endif
#if defined(SS_REFRACTION) || defined(SS_TRANSLUCENCY)
in vec3 surfaceAlbedo,
#endif
#ifdef SS_REFRACTION
in vec3 vPositionW,
in vec3 viewDirectionW,
in mat4 view,
in vec4 vRefractionInfos,
in mat4 refractionMatrix,
in vec4 vRefractionMicrosurfaceInfos,
in vec4 vLightingIntensity,
#ifdef SS_LINKREFRACTIONTOTRANSPARENCY
in float alpha,
#endif
#ifdef SS_LODINREFRACTIONALPHA
in float NdotVUnclamped,
#endif
#ifdef SS_LINEARSPECULARREFRACTION
in float roughness,
#endif
in float alphaG,
#ifdef SS_REFRACTIONMAP_3D
in samplerCube refractionSampler,
#ifndef LODBASEDMICROSFURACE
in samplerCube refractionSamplerLow,
in samplerCube refractionSamplerHigh,
#endif
#else
in sampler2D refractionSampler,
#ifndef LODBASEDMICROSFURACE
in sampler2D refractionSamplerLow,
in sampler2D refractionSamplerHigh,
#endif
#endif
#ifdef ANISOTROPIC
in anisotropicOutParams anisotropicOut,
#endif
#ifdef REALTIME_FILTERING
in vec2 vRefractionFilteringInfo,
#endif
#ifdef SS_USE_LOCAL_REFRACTIONMAP_CUBIC
in vec3 refractionPosition,
in vec3 refractionSize,
#endif
#ifdef SS_DISPERSION
in float dispersion,
#endif
#endif
#ifdef SS_TRANSLUCENCY
in vec3 vDiffusionDistance,
#endif
out subSurfaceOutParams outParams
)
{outParams.specularEnvironmentReflectance=specularEnvironmentReflectance;
#ifdef SS_REFRACTION
float refractionIntensity=vSubSurfaceIntensity.x;
#ifdef SS_LINKREFRACTIONTOTRANSPARENCY
refractionIntensity*=(1.0-alpha);outParams.alpha=1.0;
#endif
#endif
#ifdef SS_TRANSLUCENCY
float translucencyIntensity=vSubSurfaceIntensity.y;
#endif
#ifdef SS_THICKNESSANDMASK_TEXTURE
#if defined(SS_USE_GLTF_TEXTURES)
float thickness=thicknessMap.g*vThicknessParam.y+vThicknessParam.x;
#else
float thickness=thicknessMap.r*vThicknessParam.y+vThicknessParam.x;
#endif
#if DEBUGMODE>0
outParams.thicknessMap=thicknessMap;
#endif
#ifdef SS_MASK_FROM_THICKNESS_TEXTURE
#if defined(SS_REFRACTION) && defined(SS_REFRACTION_USE_INTENSITY_FROM_TEXTURE)
#if defined(SS_USE_GLTF_TEXTURES)
refractionIntensity*=thicknessMap.r;
#else
refractionIntensity*=thicknessMap.g;
#endif
#endif
#if defined(SS_TRANSLUCENCY) && defined(SS_TRANSLUCENCY_USE_INTENSITY_FROM_TEXTURE)
translucencyIntensity*=thicknessMap.b;
#endif
#endif
#else
float thickness=vThicknessParam.y;
#endif
#ifdef SS_REFRACTIONINTENSITY_TEXTURE
#ifdef SS_USE_GLTF_TEXTURES
refractionIntensity*=refractionIntensityMap.r;
#else
refractionIntensity*=refractionIntensityMap.g;
#endif
#endif
#ifdef SS_TRANSLUCENCYINTENSITY_TEXTURE
translucencyIntensity*=translucencyIntensityMap.b;
#endif
#ifdef SS_TRANSLUCENCY
thickness=maxEps(thickness);vec3 transmittance=transmittanceBRDF_Burley(vTintColor.rgb,vDiffusionDistance,thickness);transmittance*=translucencyIntensity;outParams.transmittance=transmittance;outParams.translucencyIntensity=translucencyIntensity;
#endif
#ifdef SS_REFRACTION
vec4 environmentRefraction=vec4(0.,0.,0.,0.);
#ifdef SS_HAS_THICKNESS
float ior=vRefractionInfos.y;
#else
float ior=vRefractionMicrosurfaceInfos.w;
#endif
#ifdef SS_LODINREFRACTIONALPHA
float refractionAlphaG=alphaG;refractionAlphaG=mix(alphaG,0.0,clamp(ior*3.0-2.0,0.0,1.0));float refractionLOD=getLodFromAlphaG(vRefractionMicrosurfaceInfos.x,refractionAlphaG,NdotVUnclamped);
#elif defined(SS_LINEARSPECULARREFRACTION)
float refractionRoughness=alphaG;refractionRoughness=mix(alphaG,0.0,clamp(ior*3.0-2.0,0.0,1.0));float refractionLOD=getLinearLodFromRoughness(vRefractionMicrosurfaceInfos.x,refractionRoughness);
#else
float refractionAlphaG=alphaG;refractionAlphaG=mix(alphaG,0.0,clamp(ior*3.0-2.0,0.0,1.0));float refractionLOD=getLodFromAlphaG(vRefractionMicrosurfaceInfos.x,refractionAlphaG);
#endif
float refraction_ior=vRefractionInfos.y;
#ifdef SS_DISPERSION
float realIOR=1.0/refraction_ior;float iorDispersionSpread=0.04*dispersion*(realIOR-1.0);vec3 iors=vec3(1.0/(realIOR-iorDispersionSpread),refraction_ior,1.0/(realIOR+iorDispersionSpread));for (int i=0; i<3; i++) {refraction_ior=iors[i];
#endif
vec4 envSample=sampleEnvironmentRefraction(refraction_ior,thickness,refractionLOD,normalW,vPositionW,viewDirectionW,view,vRefractionInfos,refractionMatrix,vRefractionMicrosurfaceInfos,alphaG
#ifdef SS_REFRACTIONMAP_3D
,refractionSampler
#ifndef LODBASEDMICROSFURACE
,refractionSamplerLow
,refractionSamplerHigh
#endif
#else
,refractionSampler
#ifndef LODBASEDMICROSFURACE
,refractionSamplerLow
,refractionSamplerHigh
#endif
#endif
#ifdef ANISOTROPIC
,anisotropicOut
#endif
#ifdef REALTIME_FILTERING
,vRefractionFilteringInfo
#endif
#ifdef SS_USE_LOCAL_REFRACTIONMAP_CUBIC
,refractionPosition
,refractionSize
#endif
);
#ifdef SS_DISPERSION
environmentRefraction[i]=envSample[i];}
#else
environmentRefraction=envSample;
#endif
environmentRefraction.rgb*=vRefractionInfos.x;
#endif
#ifdef SS_REFRACTION
vec3 refractionTransmittance=vec3(refractionIntensity);
#ifdef SS_THICKNESSANDMASK_TEXTURE
vec3 volumeAlbedo=computeColorAtDistanceInMedia(vTintColor.rgb,vTintColor.w);refractionTransmittance*=cocaLambert(volumeAlbedo,thickness);
#elif defined(SS_LINKREFRACTIONTOTRANSPARENCY)
float maxChannel=max(max(surfaceAlbedo.r,surfaceAlbedo.g),surfaceAlbedo.b);vec3 volumeAlbedo=saturate(maxChannel*surfaceAlbedo);environmentRefraction.rgb*=volumeAlbedo;
#else
vec3 volumeAlbedo=computeColorAtDistanceInMedia(vTintColor.rgb,vTintColor.w);refractionTransmittance*=cocaLambert(volumeAlbedo,vThicknessParam.y);
#endif
#ifdef SS_ALBEDOFORREFRACTIONTINT
environmentRefraction.rgb*=surfaceAlbedo.rgb;
#endif
outParams.surfaceAlbedo=surfaceAlbedo*(1.-refractionIntensity);
#ifdef REFLECTION
outParams.refractionFactorForIrradiance=(1.-refractionIntensity);
#endif
#ifdef UNUSED_MULTIPLEBOUNCES
vec3 bounceSpecularEnvironmentReflectance=(2.0*specularEnvironmentReflectance)/(1.0+specularEnvironmentReflectance);outParams.specularEnvironmentReflectance=mix(bounceSpecularEnvironmentReflectance,specularEnvironmentReflectance,refractionIntensity);
#endif
refractionTransmittance*=1.0-outParams.specularEnvironmentReflectance;
#if DEBUGMODE>0
outParams.refractionTransmittance=refractionTransmittance;
#endif
outParams.finalRefraction=environmentRefraction.rgb*refractionTransmittance*vLightingIntensity.z;
#if DEBUGMODE>0
outParams.environmentRefraction=environmentRefraction;
#endif
#endif
#if defined(REFLECTION) && defined(SS_TRANSLUCENCY)
#if defined(NORMAL) && defined(USESPHERICALINVERTEX) || !defined(USESPHERICALFROMREFLECTIONMAP)
vec3 irradianceVector=vec3(reflectionMatrix*vec4(normalW,0)).xyz;
#ifdef REFLECTIONMAP_OPPOSITEZ
irradianceVector.z*=-1.0;
#endif
#ifdef INVERTCUBICMAP
irradianceVector.y*=-1.0;
#endif
#else
vec3 irradianceVector=irradianceVector_;
#endif
#if defined(USESPHERICALFROMREFLECTIONMAP)
#if defined(REALTIME_FILTERING)
vec3 refractionIrradiance=irradiance(reflectionSampler,-irradianceVector,vReflectionFilteringInfo);
#else
vec3 refractionIrradiance=computeEnvironmentIrradiance(-irradianceVector);
#endif
#elif defined(USEIRRADIANCEMAP)
#ifdef REFLECTIONMAP_3D
vec3 irradianceCoords=irradianceVector;
#else
vec2 irradianceCoords=irradianceVector.xy;
#ifdef REFLECTIONMAP_PROJECTION
irradianceCoords/=irradianceVector.z;
#endif
irradianceCoords.y=1.0-irradianceCoords.y;
#endif
vec4 refractionIrradiance=sampleReflection(irradianceSampler,-irradianceCoords);
#ifdef RGBDREFLECTION
refractionIrradiance.rgb=fromRGBD(refractionIrradiance);
#endif
#ifdef GAMMAREFLECTION
refractionIrradiance.rgb=toLinearSpace(refractionIrradiance.rgb);
#endif
#else
vec4 refractionIrradiance=vec4(0.);
#endif
refractionIrradiance.rgb*=transmittance;
#ifdef SS_ALBEDOFORTRANSLUCENCYTINT
refractionIrradiance.rgb*=surfaceAlbedo.rgb;
#endif
outParams.refractionIrradiance=refractionIrradiance.rgb;
#endif
}
#endif
`;ne.IncludesShadersStore[kj]=Bj;const Uj="pbrBlockNormalGeometric",zj=`vec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);
#ifdef NORMAL
vec3 normalW=normalize(vNormalW);
#else
vec3 normalW=normalize(cross(dFdx(vPositionW),dFdy(vPositionW)))*vEyePosition.w;
#endif
vec3 geometricNormalW=normalW;
#if defined(TWOSIDEDLIGHTING) && defined(NORMAL)
geometricNormalW=gl_FrontFacing ? geometricNormalW : -geometricNormalW;
#endif
`;ne.IncludesShadersStore[Uj]=zj;const Vj="pbrBlockNormalFinal",Gj=`#if defined(FORCENORMALFORWARD) && defined(NORMAL)
vec3 faceNormal=normalize(cross(dFdx(vPositionW),dFdy(vPositionW)))*vEyePosition.w;
#if defined(TWOSIDEDLIGHTING)
faceNormal=gl_FrontFacing ? faceNormal : -faceNormal;
#endif
normalW*=sign(dot(normalW,faceNormal));
#endif
#if defined(TWOSIDEDLIGHTING) && defined(NORMAL)
normalW=gl_FrontFacing ? normalW : -normalW;
#endif
`;ne.IncludesShadersStore[Vj]=Gj;const Wj="pbrBlockLightmapInit",Hj=`#ifdef LIGHTMAP
vec4 lightmapColor=texture2D(lightmapSampler,vLightmapUV+uvOffset);
#ifdef RGBDLIGHTMAP
lightmapColor.rgb=fromRGBD(lightmapColor);
#endif
#ifdef GAMMALIGHTMAP
lightmapColor.rgb=toLinearSpace(lightmapColor.rgb);
#endif
lightmapColor.rgb*=vLightmapInfos.y;
#endif
`;ne.IncludesShadersStore[Wj]=Hj;const jj="pbrBlockGeometryInfo",Xj=`float NdotVUnclamped=dot(normalW,viewDirectionW);float NdotV=absEps(NdotVUnclamped);float alphaG=convertRoughnessToAverageSlope(roughness);vec2 AARoughnessFactors=getAARoughnessFactors(normalW.xyz);
#ifdef SPECULARAA
alphaG+=AARoughnessFactors.y;
#endif
#if defined(ENVIRONMENTBRDF)
vec3 environmentBrdf=getBRDFLookup(NdotV,roughness);
#endif
#if defined(ENVIRONMENTBRDF) && !defined(REFLECTIONMAP_SKYBOX)
#ifdef RADIANCEOCCLUSION
#ifdef AMBIENTINGRAYSCALE
float ambientMonochrome=aoOut.ambientOcclusionColor.r;
#else
float ambientMonochrome=getLuminance(aoOut.ambientOcclusionColor);
#endif
float seo=environmentRadianceOcclusion(ambientMonochrome,NdotVUnclamped);
#endif
#ifdef HORIZONOCCLUSION
#ifdef BUMP
#ifdef REFLECTIONMAP_3D
float eho=environmentHorizonOcclusion(-viewDirectionW,normalW,geometricNormalW);
#endif
#endif
#endif
#endif
`;ne.IncludesShadersStore[jj]=Xj;const Yj="pbrBlockReflectance0",Kj=`float reflectance=max(max(reflectivityOut.surfaceReflectivityColor.r,reflectivityOut.surfaceReflectivityColor.g),reflectivityOut.surfaceReflectivityColor.b);vec3 specularEnvironmentR0=reflectivityOut.surfaceReflectivityColor.rgb;
#ifdef METALLICWORKFLOW
vec3 specularEnvironmentR90=vec3(metallicReflectanceFactors.a);
#else 
vec3 specularEnvironmentR90=vec3(1.0,1.0,1.0);
#endif
#ifdef ALPHAFRESNEL
float reflectance90=fresnelGrazingReflectance(reflectance);specularEnvironmentR90=specularEnvironmentR90*reflectance90;
#endif
`;ne.IncludesShadersStore[Yj]=Kj;const qj="pbrBlockReflectance",$j=`#if defined(ENVIRONMENTBRDF) && !defined(REFLECTIONMAP_SKYBOX)
vec3 specularEnvironmentReflectance=getReflectanceFromBRDFLookup(clearcoatOut.specularEnvironmentR0,specularEnvironmentR90,environmentBrdf);
#ifdef RADIANCEOCCLUSION
specularEnvironmentReflectance*=seo;
#endif
#ifdef HORIZONOCCLUSION
#ifdef BUMP
#ifdef REFLECTIONMAP_3D
specularEnvironmentReflectance*=eho;
#endif
#endif
#endif
#else
vec3 specularEnvironmentReflectance=getReflectanceFromAnalyticalBRDFLookup_Jones(NdotV,clearcoatOut.specularEnvironmentR0,specularEnvironmentR90,sqrt(microSurface));
#endif
#ifdef CLEARCOAT
specularEnvironmentReflectance*=clearcoatOut.conservationFactor;
#if defined(CLEARCOAT_TINT)
specularEnvironmentReflectance*=clearcoatOut.absorption;
#endif
#endif
`;ne.IncludesShadersStore[qj]=$j;const Qj="pbrBlockDirectLighting",Zj=`vec3 diffuseBase=vec3(0.,0.,0.);
#ifdef SPECULARTERM
vec3 specularBase=vec3(0.,0.,0.);
#endif
#ifdef CLEARCOAT
vec3 clearCoatBase=vec3(0.,0.,0.);
#endif
#ifdef SHEEN
vec3 sheenBase=vec3(0.,0.,0.);
#endif
preLightingInfo preInfo;lightingInfo info;float shadow=1.; 
float aggShadow=0.;float numLights=0.;
#if defined(CLEARCOAT) && defined(CLEARCOAT_TINT)
vec3 absorption=vec3(0.);
#endif
`;ne.IncludesShadersStore[Qj]=Zj;const Jj="pbrBlockFinalLitComponents",eX=`aggShadow=aggShadow/numLights;
#if defined(ENVIRONMENTBRDF)
#ifdef MS_BRDF_ENERGY_CONSERVATION
vec3 energyConservationFactor=getEnergyConservationFactor(clearcoatOut.specularEnvironmentR0,environmentBrdf);
#endif
#endif
#ifndef METALLICWORKFLOW
#ifdef SPECULAR_GLOSSINESS_ENERGY_CONSERVATION
surfaceAlbedo.rgb=(1.-reflectance)*surfaceAlbedo.rgb;
#endif
#endif
#if defined(SHEEN) && defined(SHEEN_ALBEDOSCALING) && defined(ENVIRONMENTBRDF)
surfaceAlbedo.rgb=sheenOut.sheenAlbedoScaling*surfaceAlbedo.rgb;
#endif
#ifdef REFLECTION
vec3 finalIrradiance=reflectionOut.environmentIrradiance;
#if defined(CLEARCOAT)
finalIrradiance*=clearcoatOut.conservationFactor;
#if defined(CLEARCOAT_TINT)
finalIrradiance*=clearcoatOut.absorption;
#endif
#endif
#if defined(SS_REFRACTION)
finalIrradiance*=subSurfaceOut.refractionFactorForIrradiance;
#endif
#if defined(SS_TRANSLUCENCY)
finalIrradiance*=(1.0-subSurfaceOut.translucencyIntensity);finalIrradiance+=subSurfaceOut.refractionIrradiance;
#endif
finalIrradiance*=surfaceAlbedo.rgb;finalIrradiance*=vLightingIntensity.z;finalIrradiance*=aoOut.ambientOcclusionColor;
#endif
#ifdef SPECULARTERM
vec3 finalSpecular=specularBase;finalSpecular=max(finalSpecular,0.0);vec3 finalSpecularScaled=finalSpecular*vLightingIntensity.x*vLightingIntensity.w;
#if defined(ENVIRONMENTBRDF) && defined(MS_BRDF_ENERGY_CONSERVATION)
finalSpecularScaled*=energyConservationFactor;
#endif
#if defined(SHEEN) && defined(ENVIRONMENTBRDF) && defined(SHEEN_ALBEDOSCALING)
finalSpecularScaled*=sheenOut.sheenAlbedoScaling;
#endif
#endif
#ifdef REFLECTION
vec3 finalRadiance=reflectionOut.environmentRadiance.rgb;finalRadiance*=subSurfaceOut.specularEnvironmentReflectance;vec3 finalRadianceScaled=finalRadiance*vLightingIntensity.z;
#if defined(ENVIRONMENTBRDF) && defined(MS_BRDF_ENERGY_CONSERVATION)
finalRadianceScaled*=energyConservationFactor;
#endif
#if defined(SHEEN) && defined(ENVIRONMENTBRDF) && defined(SHEEN_ALBEDOSCALING)
finalRadianceScaled*=sheenOut.sheenAlbedoScaling;
#endif
#endif
#ifdef SHEEN
vec3 finalSheen=sheenBase*sheenOut.sheenColor;finalSheen=max(finalSheen,0.0);vec3 finalSheenScaled=finalSheen*vLightingIntensity.x*vLightingIntensity.w;
#if defined(CLEARCOAT) && defined(REFLECTION) && defined(ENVIRONMENTBRDF)
sheenOut.finalSheenRadianceScaled*=clearcoatOut.conservationFactor;
#if defined(CLEARCOAT_TINT)
sheenOut.finalSheenRadianceScaled*=clearcoatOut.absorption;
#endif
#endif
#endif
#ifdef CLEARCOAT
vec3 finalClearCoat=clearCoatBase;finalClearCoat=max(finalClearCoat,0.0);vec3 finalClearCoatScaled=finalClearCoat*vLightingIntensity.x*vLightingIntensity.w;
#if defined(ENVIRONMENTBRDF) && defined(MS_BRDF_ENERGY_CONSERVATION)
finalClearCoatScaled*=clearcoatOut.energyConservationFactorClearCoat;
#endif
#ifdef SS_REFRACTION
subSurfaceOut.finalRefraction*=clearcoatOut.conservationFactor;
#ifdef CLEARCOAT_TINT
subSurfaceOut.finalRefraction*=clearcoatOut.absorption;
#endif
#endif
#endif
#ifdef ALPHABLEND
float luminanceOverAlpha=0.0;
#if defined(REFLECTION) && defined(RADIANCEOVERALPHA)
luminanceOverAlpha+=getLuminance(finalRadianceScaled);
#if defined(CLEARCOAT)
luminanceOverAlpha+=getLuminance(clearcoatOut.finalClearCoatRadianceScaled);
#endif
#endif
#if defined(SPECULARTERM) && defined(SPECULAROVERALPHA)
luminanceOverAlpha+=getLuminance(finalSpecularScaled);
#endif
#if defined(CLEARCOAT) && defined(CLEARCOATOVERALPHA)
luminanceOverAlpha+=getLuminance(finalClearCoatScaled);
#endif
#if defined(RADIANCEOVERALPHA) || defined(SPECULAROVERALPHA) || defined(CLEARCOATOVERALPHA)
alpha=saturate(alpha+luminanceOverAlpha*luminanceOverAlpha);
#endif
#endif
`;ne.IncludesShadersStore[Jj]=eX;const tX="pbrBlockFinalUnlitComponents",iX=`vec3 finalDiffuse=diffuseBase;finalDiffuse*=surfaceAlbedo.rgb;finalDiffuse=max(finalDiffuse,0.0);finalDiffuse*=vLightingIntensity.x;vec3 finalAmbient=vAmbientColor;finalAmbient*=surfaceAlbedo.rgb;vec3 finalEmissive=vEmissiveColor;
#ifdef EMISSIVE
vec3 emissiveColorTex=texture2D(emissiveSampler,vEmissiveUV+uvOffset).rgb;
#ifdef GAMMAEMISSIVE
finalEmissive*=toLinearSpace(emissiveColorTex.rgb);
#else
finalEmissive*=emissiveColorTex.rgb;
#endif
finalEmissive*= vEmissiveInfos.y;
#endif
finalEmissive*=vLightingIntensity.y;
#ifdef AMBIENT
vec3 ambientOcclusionForDirectDiffuse=mix(vec3(1.),aoOut.ambientOcclusionColor,vAmbientInfos.w);
#else
vec3 ambientOcclusionForDirectDiffuse=aoOut.ambientOcclusionColor;
#endif
finalAmbient*=aoOut.ambientOcclusionColor;finalDiffuse*=ambientOcclusionForDirectDiffuse;
`;ne.IncludesShadersStore[tX]=iX;const rX="pbrBlockFinalColorComposition",nX=`vec4 finalColor=vec4(
#ifndef UNLIT
#ifdef REFLECTION
finalIrradiance +
#endif
#ifdef SPECULARTERM
finalSpecularScaled +
#endif
#ifdef SHEEN
finalSheenScaled +
#endif
#ifdef CLEARCOAT
finalClearCoatScaled +
#endif
#ifdef REFLECTION
finalRadianceScaled +
#if defined(SHEEN) && defined(ENVIRONMENTBRDF)
sheenOut.finalSheenRadianceScaled +
#endif
#ifdef CLEARCOAT
clearcoatOut.finalClearCoatRadianceScaled +
#endif
#endif
#ifdef SS_REFRACTION
subSurfaceOut.finalRefraction +
#endif
#endif
finalAmbient +
finalDiffuse,
alpha);
#ifdef LIGHTMAP
#ifndef LIGHTMAPEXCLUDED
#ifdef USELIGHTMAPASSHADOWMAP
finalColor.rgb*=lightmapColor.rgb;
#else
finalColor.rgb+=lightmapColor.rgb;
#endif
#endif
#endif
finalColor.rgb+=finalEmissive;
#define CUSTOM_FRAGMENT_BEFORE_FOG
finalColor=max(finalColor,0.0);
`;ne.IncludesShadersStore[rX]=nX;const sX="pbrBlockImageProcessing",aX=`#if defined(IMAGEPROCESSINGPOSTPROCESS) || defined(SS_SCATTERING)
#if !defined(SKIPFINALCOLORCLAMP)
finalColor.rgb=clamp(finalColor.rgb,0.,30.0);
#endif
#else
finalColor=applyImageProcessing(finalColor);
#endif
finalColor.a*=visibility;
#ifdef PREMULTIPLYALPHA
finalColor.rgb*=finalColor.a;
#endif
`;ne.IncludesShadersStore[sX]=aX;const oX="pbrDebug",lX=`#if DEBUGMODE>0
if (vClipSpacePosition.x/vClipSpacePosition.w>=vDebugMode.x) {
#if DEBUGMODE==1
gl_FragColor.rgb=vPositionW.rgb;
#define DEBUGMODE_NORMALIZE
#elif DEBUGMODE==2 && defined(NORMAL)
gl_FragColor.rgb=vNormalW.rgb;
#define DEBUGMODE_NORMALIZE
#elif DEBUGMODE==3 && defined(BUMP) || DEBUGMODE==3 && defined(PARALLAX) || DEBUGMODE==3 && defined(ANISOTROPIC)
gl_FragColor.rgb=TBN[0];
#define DEBUGMODE_NORMALIZE
#elif DEBUGMODE==4 && defined(BUMP) || DEBUGMODE==4 && defined(PARALLAX) || DEBUGMODE==4 && defined(ANISOTROPIC)
gl_FragColor.rgb=TBN[1];
#define DEBUGMODE_NORMALIZE
#elif DEBUGMODE==5
gl_FragColor.rgb=normalW;
#define DEBUGMODE_NORMALIZE
#elif DEBUGMODE==6 && defined(MAINUV1)
gl_FragColor.rgb=vec3(vMainUV1,0.0);
#elif DEBUGMODE==7 && defined(MAINUV2)
gl_FragColor.rgb=vec3(vMainUV2,0.0);
#elif DEBUGMODE==8 && defined(CLEARCOAT) && defined(CLEARCOAT_BUMP)
gl_FragColor.rgb=clearcoatOut.TBNClearCoat[0];
#define DEBUGMODE_NORMALIZE
#elif DEBUGMODE==9 && defined(CLEARCOAT) && defined(CLEARCOAT_BUMP)
gl_FragColor.rgb=clearcoatOut.TBNClearCoat[1];
#define DEBUGMODE_NORMALIZE
#elif DEBUGMODE==10 && defined(CLEARCOAT)
gl_FragColor.rgb=clearcoatOut.clearCoatNormalW;
#define DEBUGMODE_NORMALIZE
#elif DEBUGMODE==11 && defined(ANISOTROPIC)
gl_FragColor.rgb=anisotropicOut.anisotropicNormal;
#define DEBUGMODE_NORMALIZE
#elif DEBUGMODE==12 && defined(ANISOTROPIC)
gl_FragColor.rgb=anisotropicOut.anisotropicTangent;
#define DEBUGMODE_NORMALIZE
#elif DEBUGMODE==13 && defined(ANISOTROPIC)
gl_FragColor.rgb=anisotropicOut.anisotropicBitangent;
#define DEBUGMODE_NORMALIZE
#elif DEBUGMODE==20 && defined(ALBEDO)
gl_FragColor.rgb=albedoTexture.rgb;
#ifndef GAMMAALBEDO
#define DEBUGMODE_GAMMA
#endif
#elif DEBUGMODE==21 && defined(AMBIENT)
gl_FragColor.rgb=aoOut.ambientOcclusionColorMap.rgb;
#elif DEBUGMODE==22 && defined(OPACITY)
gl_FragColor.rgb=opacityMap.rgb;
#elif DEBUGMODE==23 && defined(EMISSIVE)
gl_FragColor.rgb=emissiveColorTex.rgb;
#ifndef GAMMAEMISSIVE
#define DEBUGMODE_GAMMA
#endif
#elif DEBUGMODE==24 && defined(LIGHTMAP)
gl_FragColor.rgb=lightmapColor.rgb;
#ifndef GAMMALIGHTMAP
#define DEBUGMODE_GAMMA
#endif
#elif DEBUGMODE==25 && defined(REFLECTIVITY) && defined(METALLICWORKFLOW)
gl_FragColor.rgb=reflectivityOut.surfaceMetallicColorMap.rgb;
#elif DEBUGMODE==26 && defined(REFLECTIVITY) && !defined(METALLICWORKFLOW)
gl_FragColor.rgb=reflectivityOut.surfaceReflectivityColorMap.rgb;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==27 && defined(CLEARCOAT) && defined(CLEARCOAT_TEXTURE)
gl_FragColor.rgb=vec3(clearcoatOut.clearCoatMapData.rg,0.0);
#elif DEBUGMODE==28 && defined(CLEARCOAT) && defined(CLEARCOAT_TINT) && defined(CLEARCOAT_TINT_TEXTURE)
gl_FragColor.rgb=clearcoatOut.clearCoatTintMapData.rgb;
#elif DEBUGMODE==29 && defined(SHEEN) && defined(SHEEN_TEXTURE)
gl_FragColor.rgb=sheenOut.sheenMapData.rgb;
#elif DEBUGMODE==30 && defined(ANISOTROPIC) && defined(ANISOTROPIC_TEXTURE)
gl_FragColor.rgb=anisotropicOut.anisotropyMapData.rgb;
#elif DEBUGMODE==31 && defined(SUBSURFACE) && defined(SS_THICKNESSANDMASK_TEXTURE)
gl_FragColor.rgb=subSurfaceOut.thicknessMap.rgb;
#elif DEBUGMODE==32 && defined(BUMP)
gl_FragColor.rgb=texture2D(bumpSampler,vBumpUV).rgb;
#elif DEBUGMODE==40 && defined(SS_REFRACTION)
gl_FragColor.rgb=subSurfaceOut.environmentRefraction.rgb;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==41 && defined(REFLECTION)
gl_FragColor.rgb=reflectionOut.environmentRadiance.rgb;
#ifndef GAMMAREFLECTION
#define DEBUGMODE_GAMMA
#endif
#elif DEBUGMODE==42 && defined(CLEARCOAT) && defined(REFLECTION)
gl_FragColor.rgb=clearcoatOut.environmentClearCoatRadiance.rgb;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==50
gl_FragColor.rgb=diffuseBase.rgb;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==51 && defined(SPECULARTERM)
gl_FragColor.rgb=specularBase.rgb;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==52 && defined(CLEARCOAT)
gl_FragColor.rgb=clearCoatBase.rgb;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==53 && defined(SHEEN)
gl_FragColor.rgb=sheenBase.rgb;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==54 && defined(REFLECTION)
gl_FragColor.rgb=reflectionOut.environmentIrradiance.rgb;
#ifndef GAMMAREFLECTION
#define DEBUGMODE_GAMMA
#endif
#elif DEBUGMODE==60
gl_FragColor.rgb=surfaceAlbedo.rgb;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==61
gl_FragColor.rgb=clearcoatOut.specularEnvironmentR0;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==62 && defined(METALLICWORKFLOW)
gl_FragColor.rgb=vec3(reflectivityOut.metallicRoughness.r);
#elif DEBUGMODE==71 && defined(METALLICWORKFLOW)
gl_FragColor.rgb=reflectivityOut.metallicF0;
#elif DEBUGMODE==63
gl_FragColor.rgb=vec3(roughness);
#elif DEBUGMODE==64
gl_FragColor.rgb=vec3(alphaG);
#elif DEBUGMODE==65
gl_FragColor.rgb=vec3(NdotV);
#elif DEBUGMODE==66 && defined(CLEARCOAT) && defined(CLEARCOAT_TINT)
gl_FragColor.rgb=clearcoatOut.clearCoatColor.rgb;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==67 && defined(CLEARCOAT)
gl_FragColor.rgb=vec3(clearcoatOut.clearCoatRoughness);
#elif DEBUGMODE==68 && defined(CLEARCOAT)
gl_FragColor.rgb=vec3(clearcoatOut.clearCoatNdotV);
#elif DEBUGMODE==69 && defined(SUBSURFACE) && defined(SS_TRANSLUCENCY)
gl_FragColor.rgb=subSurfaceOut.transmittance;
#elif DEBUGMODE==70 && defined(SUBSURFACE) && defined(SS_REFRACTION)
gl_FragColor.rgb=subSurfaceOut.refractionTransmittance;
#elif DEBUGMODE==72
gl_FragColor.rgb=vec3(microSurface);
#elif DEBUGMODE==73
gl_FragColor.rgb=vAlbedoColor.rgb;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==74 && !defined(METALLICWORKFLOW)
gl_FragColor.rgb=vReflectivityColor.rgb;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==75
gl_FragColor.rgb=vEmissiveColor.rgb;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==80 && defined(RADIANCEOCCLUSION)
gl_FragColor.rgb=vec3(seo);
#elif DEBUGMODE==81 && defined(HORIZONOCCLUSION) && defined(BUMP) && defined(REFLECTIONMAP_3D)
gl_FragColor.rgb=vec3(eho);
#elif DEBUGMODE==82 && defined(MS_BRDF_ENERGY_CONSERVATION)
gl_FragColor.rgb=vec3(energyConservationFactor);
#elif DEBUGMODE==83 && defined(ENVIRONMENTBRDF) && !defined(REFLECTIONMAP_SKYBOX)
gl_FragColor.rgb=specularEnvironmentReflectance;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==84 && defined(CLEARCOAT) && defined(ENVIRONMENTBRDF) && !defined(REFLECTIONMAP_SKYBOX)
gl_FragColor.rgb=clearcoatOut.clearCoatEnvironmentReflectance;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==85 && defined(SHEEN) && defined(REFLECTION)
gl_FragColor.rgb=sheenOut.sheenEnvironmentReflectance;
#define DEBUGMODE_GAMMA
#elif DEBUGMODE==86 && defined(ALPHABLEND)
gl_FragColor.rgb=vec3(luminanceOverAlpha);
#elif DEBUGMODE==87
gl_FragColor.rgb=vec3(alpha);
#elif DEBUGMODE==88 && defined(ALBEDO)
gl_FragColor.rgb=vec3(albedoTexture.a);
#else
float stripeWidth=30.;float stripePos=floor((gl_FragCoord.x+gl_FragCoord.y)/stripeWidth);float whichColor=mod(stripePos,2.);vec3 color1=vec3(.6,.2,.2);vec3 color2=vec3(.3,.1,.1);gl_FragColor.rgb=mix(color1,color2,whichColor);
#endif
gl_FragColor.rgb*=vDebugMode.y;
#ifdef DEBUGMODE_NORMALIZE
gl_FragColor.rgb=normalize(gl_FragColor.rgb)*0.5+0.5;
#endif
#ifdef DEBUGMODE_GAMMA
gl_FragColor.rgb=toGammaSpace(gl_FragColor.rgb);
#endif
gl_FragColor.a=1.0;
#ifdef PREPASS
gl_FragData[0]=toLinearSpace(gl_FragColor); 
gl_FragData[1]=vec4(0.,0.,0.,0.); 
#endif
#ifdef DEBUGMODE_FORCERETURN
return;
#endif
}
#endif
`;ne.IncludesShadersStore[oX]=lX;const cX="pbrPixelShader",uX=`#if defined(BUMP) || !defined(NORMAL) || defined(FORCENORMALFORWARD) || defined(SPECULARAA) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC)
#extension GL_OES_standard_derivatives : enable
#endif
#ifdef LODBASEDMICROSFURACE
#extension GL_EXT_shader_texture_lod : enable
#endif
#define CUSTOM_FRAGMENT_BEGIN
#ifdef LOGARITHMICDEPTH
#extension GL_EXT_frag_depth : enable
#endif
#include<prePassDeclaration>[SCENE_MRT_COUNT]
precision highp float;
#include<oitDeclaration>
#ifndef FROMLINEARSPACE
#define FROMLINEARSPACE
#endif
#include<__decl__pbrFragment>
#include<pbrFragmentExtraDeclaration>
#include<__decl__lightFragment>[0..maxSimultaneousLights]
#include<pbrFragmentSamplersDeclaration>
#include<imageProcessingDeclaration>
#include<clipPlaneFragmentDeclaration>
#include<logDepthDeclaration>
#include<fogFragmentDeclaration>
#include<helperFunctions>
#include<subSurfaceScatteringFunctions>
#include<importanceSampling>
#include<pbrHelperFunctions>
#include<imageProcessingFunctions>
#include<shadowsFragmentFunctions>
#include<harmonicsFunctions>
#include<pbrDirectLightingSetupFunctions>
#include<pbrDirectLightingFalloffFunctions>
#include<pbrBRDFFunctions>
#include<hdrFilteringFunctions>
#include<pbrDirectLightingFunctions>
#include<pbrIBLFunctions>
#include<bumpFragmentMainFunctions>
#include<bumpFragmentFunctions>
#ifdef REFLECTION
#include<reflectionFunction>
#endif
#define CUSTOM_FRAGMENT_DEFINITIONS
#include<pbrBlockAlbedoOpacity>
#include<pbrBlockReflectivity>
#include<pbrBlockAmbientOcclusion>
#include<pbrBlockAlphaFresnel>
#include<pbrBlockAnisotropic>
#include<pbrBlockReflection>
#include<pbrBlockSheen>
#include<pbrBlockClearcoat>
#include<pbrBlockIridescence>
#include<pbrBlockSubSurface>
void main(void) {
#define CUSTOM_FRAGMENT_MAIN_BEGIN
#include<clipPlaneFragment>
#include<pbrBlockNormalGeometric>
#include<bumpFragment>
#include<pbrBlockNormalFinal>
albedoOpacityOutParams albedoOpacityOut;
#ifdef ALBEDO
vec4 albedoTexture=texture2D(albedoSampler,vAlbedoUV+uvOffset);
#endif
#ifdef OPACITY
vec4 opacityMap=texture2D(opacitySampler,vOpacityUV+uvOffset);
#endif
#ifdef DECAL
vec4 decalColor=texture2D(decalSampler,vDecalUV+uvOffset);
#endif
albedoOpacityBlock(
vAlbedoColor,
#ifdef ALBEDO
albedoTexture,
vAlbedoInfos,
#endif
#ifdef OPACITY
opacityMap,
vOpacityInfos,
#endif
#ifdef DETAIL
detailColor,
vDetailInfos,
#endif
#ifdef DECAL
decalColor,
vDecalInfos,
#endif
albedoOpacityOut
);vec3 surfaceAlbedo=albedoOpacityOut.surfaceAlbedo;float alpha=albedoOpacityOut.alpha;
#define CUSTOM_FRAGMENT_UPDATE_ALPHA
#include<depthPrePass>
#define CUSTOM_FRAGMENT_BEFORE_LIGHTS
ambientOcclusionOutParams aoOut;
#ifdef AMBIENT
vec3 ambientOcclusionColorMap=texture2D(ambientSampler,vAmbientUV+uvOffset).rgb;
#endif
ambientOcclusionBlock(
#ifdef AMBIENT
ambientOcclusionColorMap,
vAmbientInfos,
#endif
aoOut
);
#include<pbrBlockLightmapInit>
#ifdef UNLIT
vec3 diffuseBase=vec3(1.,1.,1.);
#else
vec3 baseColor=surfaceAlbedo;reflectivityOutParams reflectivityOut;
#if defined(REFLECTIVITY)
vec4 surfaceMetallicOrReflectivityColorMap=texture2D(reflectivitySampler,vReflectivityUV+uvOffset);vec4 baseReflectivity=surfaceMetallicOrReflectivityColorMap;
#ifndef METALLICWORKFLOW
#ifdef REFLECTIVITY_GAMMA
surfaceMetallicOrReflectivityColorMap=toLinearSpace(surfaceMetallicOrReflectivityColorMap);
#endif
surfaceMetallicOrReflectivityColorMap.rgb*=vReflectivityInfos.y;
#endif
#endif
#if defined(MICROSURFACEMAP)
vec4 microSurfaceTexel=texture2D(microSurfaceSampler,vMicroSurfaceSamplerUV+uvOffset)*vMicroSurfaceSamplerInfos.y;
#endif
#ifdef METALLICWORKFLOW
vec4 metallicReflectanceFactors=vMetallicReflectanceFactors;
#ifdef REFLECTANCE
vec4 reflectanceFactorsMap=texture2D(reflectanceSampler,vReflectanceUV+uvOffset);
#ifdef REFLECTANCE_GAMMA
reflectanceFactorsMap=toLinearSpace(reflectanceFactorsMap);
#endif
metallicReflectanceFactors.rgb*=reflectanceFactorsMap.rgb;
#endif
#ifdef METALLIC_REFLECTANCE
vec4 metallicReflectanceFactorsMap=texture2D(metallicReflectanceSampler,vMetallicReflectanceUV+uvOffset);
#ifdef METALLIC_REFLECTANCE_GAMMA
metallicReflectanceFactorsMap=toLinearSpace(metallicReflectanceFactorsMap);
#endif
#ifndef METALLIC_REFLECTANCE_USE_ALPHA_ONLY
metallicReflectanceFactors.rgb*=metallicReflectanceFactorsMap.rgb;
#endif
metallicReflectanceFactors*=metallicReflectanceFactorsMap.a;
#endif
#endif
reflectivityBlock(
vReflectivityColor,
#ifdef METALLICWORKFLOW
surfaceAlbedo,
metallicReflectanceFactors,
#endif
#ifdef REFLECTIVITY
vReflectivityInfos,
surfaceMetallicOrReflectivityColorMap,
#endif
#if defined(METALLICWORKFLOW) && defined(REFLECTIVITY) && defined(AOSTOREINMETALMAPRED)
aoOut.ambientOcclusionColor,
#endif
#ifdef MICROSURFACEMAP
microSurfaceTexel,
#endif
#ifdef DETAIL
detailColor,
vDetailInfos,
#endif
reflectivityOut
);float microSurface=reflectivityOut.microSurface;float roughness=reflectivityOut.roughness;
#ifdef METALLICWORKFLOW
surfaceAlbedo=reflectivityOut.surfaceAlbedo;
#endif
#if defined(METALLICWORKFLOW) && defined(REFLECTIVITY) && defined(AOSTOREINMETALMAPRED)
aoOut.ambientOcclusionColor=reflectivityOut.ambientOcclusionColor;
#endif
#ifdef ALPHAFRESNEL
#if defined(ALPHATEST) || defined(ALPHABLEND)
alphaFresnelOutParams alphaFresnelOut;alphaFresnelBlock(
normalW,
viewDirectionW,
alpha,
microSurface,
alphaFresnelOut
);alpha=alphaFresnelOut.alpha;
#endif
#endif
#include<pbrBlockGeometryInfo>
#ifdef ANISOTROPIC
anisotropicOutParams anisotropicOut;
#ifdef ANISOTROPIC_TEXTURE
vec3 anisotropyMapData=texture2D(anisotropySampler,vAnisotropyUV+uvOffset).rgb*vAnisotropyInfos.y;
#endif
anisotropicBlock(
vAnisotropy,
roughness,
#ifdef ANISOTROPIC_TEXTURE
anisotropyMapData,
#endif
TBN,
normalW,
viewDirectionW,
anisotropicOut
);
#endif
#ifdef REFLECTION
reflectionOutParams reflectionOut;
#ifndef USE_CUSTOM_REFLECTION
reflectionBlock(
vPositionW,
normalW,
alphaG,
vReflectionMicrosurfaceInfos,
vReflectionInfos,
vReflectionColor,
#ifdef ANISOTROPIC
anisotropicOut,
#endif
#if defined(LODINREFLECTIONALPHA) && !defined(REFLECTIONMAP_SKYBOX)
NdotVUnclamped,
#endif
#ifdef LINEARSPECULARREFLECTION
roughness,
#endif
reflectionSampler,
#if defined(NORMAL) && defined(USESPHERICALINVERTEX)
vEnvironmentIrradiance,
#endif
#ifdef USESPHERICALFROMREFLECTIONMAP
#if !defined(NORMAL) || !defined(USESPHERICALINVERTEX)
reflectionMatrix,
#endif
#endif
#ifdef USEIRRADIANCEMAP
irradianceSampler,
#endif
#ifndef LODBASEDMICROSFURACE
reflectionSamplerLow,
reflectionSamplerHigh,
#endif
#ifdef REALTIME_FILTERING
vReflectionFilteringInfo,
#endif
reflectionOut
);
#else
#define CUSTOM_REFLECTION
#endif
#endif
#include<pbrBlockReflectance0>
#ifdef SHEEN
sheenOutParams sheenOut;
#ifdef SHEEN_TEXTURE
vec4 sheenMapData=texture2D(sheenSampler,vSheenUV+uvOffset);
#endif
#if defined(SHEEN_ROUGHNESS) && defined(SHEEN_TEXTURE_ROUGHNESS) && !defined(SHEEN_TEXTURE_ROUGHNESS_IDENTICAL) && !defined(SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE)
vec4 sheenMapRoughnessData=texture2D(sheenRoughnessSampler,vSheenRoughnessUV+uvOffset)*vSheenInfos.w;
#endif
sheenBlock(
vSheenColor,
#ifdef SHEEN_ROUGHNESS
vSheenRoughness,
#if defined(SHEEN_TEXTURE_ROUGHNESS) && !defined(SHEEN_TEXTURE_ROUGHNESS_IDENTICAL) && !defined(SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE)
sheenMapRoughnessData,
#endif
#endif
roughness,
#ifdef SHEEN_TEXTURE
sheenMapData,
vSheenInfos.y,
#endif
reflectance,
#ifdef SHEEN_LINKWITHALBEDO
baseColor,
surfaceAlbedo,
#endif
#ifdef ENVIRONMENTBRDF
NdotV,
environmentBrdf,
#endif
#if defined(REFLECTION) && defined(ENVIRONMENTBRDF)
AARoughnessFactors,
vReflectionMicrosurfaceInfos,
vReflectionInfos,
vReflectionColor,
vLightingIntensity,
reflectionSampler,
reflectionOut.reflectionCoords,
NdotVUnclamped,
#ifndef LODBASEDMICROSFURACE
reflectionSamplerLow,
reflectionSamplerHigh,
#endif
#ifdef REALTIME_FILTERING
vReflectionFilteringInfo,
#endif
#if !defined(REFLECTIONMAP_SKYBOX) && defined(RADIANCEOCCLUSION)
seo,
#endif
#if !defined(REFLECTIONMAP_SKYBOX) && defined(HORIZONOCCLUSION) && defined(BUMP) && defined(REFLECTIONMAP_3D)
eho,
#endif
#endif
sheenOut
);
#ifdef SHEEN_LINKWITHALBEDO
surfaceAlbedo=sheenOut.surfaceAlbedo;
#endif
#endif
#ifdef CLEARCOAT
#ifdef CLEARCOAT_TEXTURE
vec2 clearCoatMapData=texture2D(clearCoatSampler,vClearCoatUV+uvOffset).rg*vClearCoatInfos.y;
#endif
#endif
#ifdef IRIDESCENCE
iridescenceOutParams iridescenceOut;
#ifdef IRIDESCENCE_TEXTURE
vec2 iridescenceMapData=texture2D(iridescenceSampler,vIridescenceUV+uvOffset).rg*vIridescenceInfos.y;
#endif
#ifdef IRIDESCENCE_THICKNESS_TEXTURE
vec2 iridescenceThicknessMapData=texture2D(iridescenceThicknessSampler,vIridescenceThicknessUV+uvOffset).rg*vIridescenceInfos.w;
#endif
iridescenceBlock(
vIridescenceParams,
NdotV,
specularEnvironmentR0,
#ifdef IRIDESCENCE_TEXTURE
iridescenceMapData,
#endif
#ifdef IRIDESCENCE_THICKNESS_TEXTURE
iridescenceThicknessMapData,
#endif
#ifdef CLEARCOAT
NdotVUnclamped,
#ifdef CLEARCOAT_TEXTURE
clearCoatMapData,
#endif
#endif
iridescenceOut
);float iridescenceIntensity=iridescenceOut.iridescenceIntensity;specularEnvironmentR0=iridescenceOut.specularEnvironmentR0;
#endif
clearcoatOutParams clearcoatOut;
#ifdef CLEARCOAT
#if defined(CLEARCOAT_TEXTURE_ROUGHNESS) && !defined(CLEARCOAT_TEXTURE_ROUGHNESS_IDENTICAL) && !defined(CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE)
vec4 clearCoatMapRoughnessData=texture2D(clearCoatRoughnessSampler,vClearCoatRoughnessUV+uvOffset)*vClearCoatInfos.w;
#endif
#if defined(CLEARCOAT_TINT) && defined(CLEARCOAT_TINT_TEXTURE)
vec4 clearCoatTintMapData=texture2D(clearCoatTintSampler,vClearCoatTintUV+uvOffset);
#endif
#ifdef CLEARCOAT_BUMP
vec4 clearCoatBumpMapData=texture2D(clearCoatBumpSampler,vClearCoatBumpUV+uvOffset);
#endif
clearcoatBlock(
vPositionW,
geometricNormalW,
viewDirectionW,
vClearCoatParams,
#if defined(CLEARCOAT_TEXTURE_ROUGHNESS) && !defined(CLEARCOAT_TEXTURE_ROUGHNESS_IDENTICAL) && !defined(CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE)
clearCoatMapRoughnessData,
#endif
specularEnvironmentR0,
#ifdef CLEARCOAT_TEXTURE
clearCoatMapData,
#endif
#ifdef CLEARCOAT_TINT
vClearCoatTintParams,
clearCoatColorAtDistance,
vClearCoatRefractionParams,
#ifdef CLEARCOAT_TINT_TEXTURE
clearCoatTintMapData,
#endif
#endif
#ifdef CLEARCOAT_BUMP
vClearCoatBumpInfos,
clearCoatBumpMapData,
vClearCoatBumpUV,
#if defined(TANGENT) && defined(NORMAL)
vTBN,
#else
vClearCoatTangentSpaceParams,
#endif
#ifdef OBJECTSPACE_NORMALMAP
normalMatrix,
#endif
#endif
#if defined(FORCENORMALFORWARD) && defined(NORMAL)
faceNormal,
#endif
#ifdef REFLECTION
vReflectionMicrosurfaceInfos,
vReflectionInfos,
vReflectionColor,
vLightingIntensity,
reflectionSampler,
#ifndef LODBASEDMICROSFURACE
reflectionSamplerLow,
reflectionSamplerHigh,
#endif
#ifdef REALTIME_FILTERING
vReflectionFilteringInfo,
#endif
#endif
#if defined(ENVIRONMENTBRDF) && !defined(REFLECTIONMAP_SKYBOX)
#ifdef RADIANCEOCCLUSION
ambientMonochrome,
#endif
#endif
#if defined(CLEARCOAT_BUMP) || defined(TWOSIDEDLIGHTING)
(gl_FrontFacing ? 1. : -1.),
#endif
clearcoatOut
);
#else
clearcoatOut.specularEnvironmentR0=specularEnvironmentR0;
#endif
#include<pbrBlockReflectance>
subSurfaceOutParams subSurfaceOut;
#ifdef SUBSURFACE
#ifdef SS_THICKNESSANDMASK_TEXTURE
vec4 thicknessMap=texture2D(thicknessSampler,vThicknessUV+uvOffset);
#endif
#ifdef SS_REFRACTIONINTENSITY_TEXTURE
vec4 refractionIntensityMap=texture2D(refractionIntensitySampler,vRefractionIntensityUV+uvOffset);
#endif
#ifdef SS_TRANSLUCENCYINTENSITY_TEXTURE
vec4 translucencyIntensityMap=texture2D(translucencyIntensitySampler,vTranslucencyIntensityUV+uvOffset);
#endif
subSurfaceBlock(
vSubSurfaceIntensity,
vThicknessParam,
vTintColor,
normalW,
specularEnvironmentReflectance,
#ifdef SS_THICKNESSANDMASK_TEXTURE
thicknessMap,
#endif
#ifdef SS_REFRACTIONINTENSITY_TEXTURE
refractionIntensityMap,
#endif
#ifdef SS_TRANSLUCENCYINTENSITY_TEXTURE
translucencyIntensityMap,
#endif
#ifdef REFLECTION
#ifdef SS_TRANSLUCENCY
reflectionMatrix,
#ifdef USESPHERICALFROMREFLECTIONMAP
#if !defined(NORMAL) || !defined(USESPHERICALINVERTEX)
reflectionOut.irradianceVector,
#endif
#if defined(REALTIME_FILTERING)
reflectionSampler,
vReflectionFilteringInfo,
#endif
#endif
#ifdef USEIRRADIANCEMAP
irradianceSampler,
#endif
#endif
#endif
#if defined(SS_REFRACTION) || defined(SS_TRANSLUCENCY)
surfaceAlbedo,
#endif
#ifdef SS_REFRACTION
vPositionW,
viewDirectionW,
view,
vRefractionInfos,
refractionMatrix,
vRefractionMicrosurfaceInfos,
vLightingIntensity,
#ifdef SS_LINKREFRACTIONTOTRANSPARENCY
alpha,
#endif
#ifdef SS_LODINREFRACTIONALPHA
NdotVUnclamped,
#endif
#ifdef SS_LINEARSPECULARREFRACTION
roughness,
#endif
alphaG,
refractionSampler,
#ifndef LODBASEDMICROSFURACE
refractionSamplerLow,
refractionSamplerHigh,
#endif
#ifdef ANISOTROPIC
anisotropicOut,
#endif
#ifdef REALTIME_FILTERING
vRefractionFilteringInfo,
#endif
#ifdef SS_USE_LOCAL_REFRACTIONMAP_CUBIC
vRefractionPosition,
vRefractionSize,
#endif
#ifdef SS_DISPERSION
dispersion,
#endif
#endif
#ifdef SS_TRANSLUCENCY
vDiffusionDistance,
#endif
subSurfaceOut
);
#ifdef SS_REFRACTION
surfaceAlbedo=subSurfaceOut.surfaceAlbedo;
#ifdef SS_LINKREFRACTIONTOTRANSPARENCY
alpha=subSurfaceOut.alpha;
#endif
#endif
#else
subSurfaceOut.specularEnvironmentReflectance=specularEnvironmentReflectance;
#endif
#include<pbrBlockDirectLighting>
#include<lightFragment>[0..maxSimultaneousLights]
#include<pbrBlockFinalLitComponents>
#endif 
#include<pbrBlockFinalUnlitComponents>
#define CUSTOM_FRAGMENT_BEFORE_FINALCOLORCOMPOSITION
#include<pbrBlockFinalColorComposition>
#include<logDepthFragment>
#include<fogFragment>(color,finalColor)
#include<pbrBlockImageProcessing>
#define CUSTOM_FRAGMENT_BEFORE_FRAGCOLOR
#ifdef PREPASS
float writeGeometryInfo=finalColor.a>0.4 ? 1.0 : 0.0;
#ifdef PREPASS_POSITION
gl_FragData[PREPASS_POSITION_INDEX]=vec4(vPositionW,writeGeometryInfo);
#endif
#ifdef PREPASS_VELOCITY
vec2 a=(vCurrentPosition.xy/vCurrentPosition.w)*0.5+0.5;vec2 b=(vPreviousPosition.xy/vPreviousPosition.w)*0.5+0.5;vec2 velocity=abs(a-b);velocity=vec2(pow(velocity.x,1.0/3.0),pow(velocity.y,1.0/3.0))*sign(a-b)*0.5+0.5;gl_FragData[PREPASS_VELOCITY_INDEX]=vec4(velocity,0.0,writeGeometryInfo);
#endif
#ifdef PREPASS_ALBEDO_SQRT
vec3 sqAlbedo=sqrt(surfaceAlbedo); 
#endif
#ifdef PREPASS_IRRADIANCE
vec3 irradiance=finalDiffuse;
#ifndef UNLIT
#ifdef REFLECTION
irradiance+=finalIrradiance;
#endif
#endif
#ifdef SS_SCATTERING
gl_FragData[0]=vec4(finalColor.rgb-irradiance,finalColor.a); 
irradiance/=sqAlbedo;
#else
gl_FragData[0]=finalColor; 
float scatteringDiffusionProfile=255.;
#endif
gl_FragData[PREPASS_IRRADIANCE_INDEX]=vec4(clamp(irradiance,vec3(0.),vec3(1.)),writeGeometryInfo*scatteringDiffusionProfile/255.); 
#else
gl_FragData[0]=vec4(finalColor.rgb,finalColor.a);
#endif
#ifdef PREPASS_DEPTH
gl_FragData[PREPASS_DEPTH_INDEX]=vec4(vViewPos.z,0.0,0.0,writeGeometryInfo); 
#endif
#ifdef PREPASS_NORMAL
#ifdef PREPASS_NORMAL_WORLDSPACE
gl_FragData[PREPASS_NORMAL_INDEX]=vec4(normalW,writeGeometryInfo); 
#else
gl_FragData[PREPASS_NORMAL_INDEX]=vec4(normalize((view*vec4(normalW,0.0)).rgb),writeGeometryInfo); 
#endif
#endif
#ifdef PREPASS_ALBEDO_SQRT
gl_FragData[PREPASS_ALBEDO_SQRT_INDEX]=vec4(sqAlbedo,writeGeometryInfo); 
#endif
#ifdef PREPASS_REFLECTIVITY
#ifndef UNLIT
gl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(specularEnvironmentR0,microSurface)*writeGeometryInfo;
#else
gl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4( 0.0,0.0,0.0,1.0 )*writeGeometryInfo;
#endif
#endif
#endif
#if !defined(PREPASS) || defined(WEBGL2)
gl_FragColor=finalColor;
#endif
#include<oitFragment>
#if ORDER_INDEPENDENT_TRANSPARENCY
if (fragDepth==nearestDepth) {frontColor.rgb+=finalColor.rgb*finalColor.a*alphaMultiplier;frontColor.a=1.0-alphaMultiplier*(1.0-finalColor.a);} else {backColor+=finalColor;}
#endif
#include<pbrDebug>
#define CUSTOM_FRAGMENT_MAIN_END
}
`;ne.ShadersStore[cX]=uX;const hX="pbrVertexDeclaration",dX=`uniform mat4 view;uniform mat4 viewProjection;
#ifdef ALBEDO
uniform mat4 albedoMatrix;uniform vec2 vAlbedoInfos;
#endif
#ifdef AMBIENT
uniform mat4 ambientMatrix;uniform vec4 vAmbientInfos;
#endif
#ifdef OPACITY
uniform mat4 opacityMatrix;uniform vec2 vOpacityInfos;
#endif
#ifdef EMISSIVE
uniform vec2 vEmissiveInfos;uniform mat4 emissiveMatrix;
#endif
#ifdef LIGHTMAP
uniform vec2 vLightmapInfos;uniform mat4 lightmapMatrix;
#endif
#ifdef REFLECTIVITY 
uniform vec3 vReflectivityInfos;uniform mat4 reflectivityMatrix;
#endif
#ifdef METALLIC_REFLECTANCE
uniform vec2 vMetallicReflectanceInfos;uniform mat4 metallicReflectanceMatrix;
#endif
#ifdef REFLECTANCE
uniform vec2 vReflectanceInfos;uniform mat4 reflectanceMatrix;
#endif
#ifdef MICROSURFACEMAP
uniform vec2 vMicroSurfaceSamplerInfos;uniform mat4 microSurfaceSamplerMatrix;
#endif
#ifdef BUMP
uniform vec3 vBumpInfos;uniform mat4 bumpMatrix;
#endif
#ifdef POINTSIZE
uniform float pointSize;
#endif
#ifdef REFLECTION
uniform vec2 vReflectionInfos;uniform mat4 reflectionMatrix;
#endif
#ifdef CLEARCOAT
#if defined(CLEARCOAT_TEXTURE) || defined(CLEARCOAT_TEXTURE_ROUGHNESS)
uniform vec4 vClearCoatInfos;
#endif
#ifdef CLEARCOAT_TEXTURE
uniform mat4 clearCoatMatrix;
#endif
#ifdef CLEARCOAT_TEXTURE_ROUGHNESS
uniform mat4 clearCoatRoughnessMatrix;
#endif
#ifdef CLEARCOAT_BUMP
uniform vec2 vClearCoatBumpInfos;uniform mat4 clearCoatBumpMatrix;
#endif
#ifdef CLEARCOAT_TINT_TEXTURE
uniform vec2 vClearCoatTintInfos;uniform mat4 clearCoatTintMatrix;
#endif
#endif
#ifdef IRIDESCENCE
#if defined(IRIDESCENCE_TEXTURE) || defined(IRIDESCENCE_THICKNESS_TEXTURE)
uniform vec4 vIridescenceInfos;
#endif
#ifdef IRIDESCENCE_TEXTURE
uniform mat4 iridescenceMatrix;
#endif
#ifdef IRIDESCENCE_THICKNESS_TEXTURE
uniform mat4 iridescenceThicknessMatrix;
#endif
#endif
#ifdef ANISOTROPIC
#ifdef ANISOTROPIC_TEXTURE
uniform vec2 vAnisotropyInfos;uniform mat4 anisotropyMatrix;
#endif
#endif
#ifdef SHEEN
#if defined(SHEEN_TEXTURE) || defined(SHEEN_TEXTURE_ROUGHNESS)
uniform vec4 vSheenInfos;
#endif
#ifdef SHEEN_TEXTURE
uniform mat4 sheenMatrix;
#endif
#ifdef SHEEN_TEXTURE_ROUGHNESS
uniform mat4 sheenRoughnessMatrix;
#endif
#endif
#ifdef SUBSURFACE
#ifdef SS_REFRACTION
uniform vec4 vRefractionInfos;uniform mat4 refractionMatrix;
#endif
#ifdef SS_THICKNESSANDMASK_TEXTURE
uniform vec2 vThicknessInfos;uniform mat4 thicknessMatrix;
#endif
#ifdef SS_REFRACTIONINTENSITY_TEXTURE
uniform vec2 vRefractionIntensityInfos;uniform mat4 refractionIntensityMatrix;
#endif
#ifdef SS_TRANSLUCENCYINTENSITY_TEXTURE
uniform vec2 vTranslucencyIntensityInfos;uniform mat4 translucencyIntensityMatrix;
#endif
#endif
#ifdef NORMAL
#if defined(USESPHERICALFROMREFLECTIONMAP) && defined(USESPHERICALINVERTEX)
#ifdef USESPHERICALFROMREFLECTIONMAP
#ifdef SPHERICAL_HARMONICS
uniform vec3 vSphericalL00;uniform vec3 vSphericalL1_1;uniform vec3 vSphericalL10;uniform vec3 vSphericalL11;uniform vec3 vSphericalL2_2;uniform vec3 vSphericalL2_1;uniform vec3 vSphericalL20;uniform vec3 vSphericalL21;uniform vec3 vSphericalL22;
#else
uniform vec3 vSphericalX;uniform vec3 vSphericalY;uniform vec3 vSphericalZ;uniform vec3 vSphericalXX_ZZ;uniform vec3 vSphericalYY_ZZ;uniform vec3 vSphericalZZ;uniform vec3 vSphericalXY;uniform vec3 vSphericalYZ;uniform vec3 vSphericalZX;
#endif
#endif
#endif
#endif
#ifdef DETAIL
uniform vec4 vDetailInfos;uniform mat4 detailMatrix;
#endif
#include<decalVertexDeclaration>
#define ADDITIONAL_VERTEX_DECLARATION
`;ne.IncludesShadersStore[hX]=dX;const fX="pbrVertexShader",_X=`precision highp float;
#include<__decl__pbrVertex>
#define CUSTOM_VERTEX_BEGIN
attribute vec3 position;
#ifdef NORMAL
attribute vec3 normal;
#endif
#ifdef TANGENT
attribute vec4 tangent;
#endif
#ifdef UV1
attribute vec2 uv;
#endif
#include<uvAttributeDeclaration>[2..7]
#include<mainUVVaryingDeclaration>[1..7]
#ifdef VERTEXCOLOR
attribute vec4 color;
#endif
#include<helperFunctions>
#include<bonesDeclaration>
#include<bakedVertexAnimationDeclaration>
#include<instancesDeclaration>
#include<prePassVertexDeclaration>
#include<samplerVertexDeclaration>(_DEFINENAME_,ALBEDO,_VARYINGNAME_,Albedo)
#include<samplerVertexDeclaration>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail)
#include<samplerVertexDeclaration>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient)
#include<samplerVertexDeclaration>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity)
#include<samplerVertexDeclaration>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive)
#include<samplerVertexDeclaration>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap)
#include<samplerVertexDeclaration>(_DEFINENAME_,REFLECTIVITY,_VARYINGNAME_,Reflectivity)
#include<samplerVertexDeclaration>(_DEFINENAME_,MICROSURFACEMAP,_VARYINGNAME_,MicroSurfaceSampler)
#include<samplerVertexDeclaration>(_DEFINENAME_,METALLIC_REFLECTANCE,_VARYINGNAME_,MetallicReflectance)
#include<samplerVertexDeclaration>(_DEFINENAME_,REFLECTANCE,_VARYINGNAME_,Reflectance)
#include<samplerVertexDeclaration>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump)
#include<samplerVertexDeclaration>(_DEFINENAME_,DECAL,_VARYINGNAME_,Decal)
#ifdef CLEARCOAT
#include<samplerVertexDeclaration>(_DEFINENAME_,CLEARCOAT_TEXTURE,_VARYINGNAME_,ClearCoat)
#include<samplerVertexDeclaration>(_DEFINENAME_,CLEARCOAT_TEXTURE_ROUGHNESS,_VARYINGNAME_,ClearCoatRoughness)
#include<samplerVertexDeclaration>(_DEFINENAME_,CLEARCOAT_BUMP,_VARYINGNAME_,ClearCoatBump)
#include<samplerVertexDeclaration>(_DEFINENAME_,CLEARCOAT_TINT_TEXTURE,_VARYINGNAME_,ClearCoatTint)
#endif
#ifdef IRIDESCENCE
#include<samplerVertexDeclaration>(_DEFINENAME_,IRIDESCENCE_TEXTURE,_VARYINGNAME_,Iridescence)
#include<samplerVertexDeclaration>(_DEFINENAME_,IRIDESCENCE_THICKNESS_TEXTURE,_VARYINGNAME_,IridescenceThickness)
#endif
#ifdef SHEEN
#include<samplerVertexDeclaration>(_DEFINENAME_,SHEEN_TEXTURE,_VARYINGNAME_,Sheen)
#include<samplerVertexDeclaration>(_DEFINENAME_,SHEEN_TEXTURE_ROUGHNESS,_VARYINGNAME_,SheenRoughness)
#endif
#ifdef ANISOTROPIC
#include<samplerVertexDeclaration>(_DEFINENAME_,ANISOTROPIC_TEXTURE,_VARYINGNAME_,Anisotropy)
#endif
#ifdef SUBSURFACE
#include<samplerVertexDeclaration>(_DEFINENAME_,SS_THICKNESSANDMASK_TEXTURE,_VARYINGNAME_,Thickness)
#include<samplerVertexDeclaration>(_DEFINENAME_,SS_REFRACTIONINTENSITY_TEXTURE,_VARYINGNAME_,RefractionIntensity)
#include<samplerVertexDeclaration>(_DEFINENAME_,SS_TRANSLUCENCYINTENSITY_TEXTURE,_VARYINGNAME_,TranslucencyIntensity)
#endif
varying vec3 vPositionW;
#if DEBUGMODE>0
varying vec4 vClipSpacePosition;
#endif
#ifdef NORMAL
varying vec3 vNormalW;
#if defined(USESPHERICALFROMREFLECTIONMAP) && defined(USESPHERICALINVERTEX)
varying vec3 vEnvironmentIrradiance;
#include<harmonicsFunctions>
#endif
#endif
#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)
varying vec4 vColor;
#endif
#include<bumpVertexDeclaration>
#include<clipPlaneVertexDeclaration>
#include<fogVertexDeclaration>
#include<__decl__lightVxFragment>[0..maxSimultaneousLights]
#include<morphTargetsVertexGlobalDeclaration>
#include<morphTargetsVertexDeclaration>[0..maxSimultaneousMorphTargets]
#ifdef REFLECTIONMAP_SKYBOX
varying vec3 vPositionUVW;
#endif
#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)
varying vec3 vDirectionW;
#endif
#include<logDepthDeclaration>
#define CUSTOM_VERTEX_DEFINITIONS
void main(void) {
#define CUSTOM_VERTEX_MAIN_BEGIN
vec3 positionUpdated=position;
#ifdef NORMAL
vec3 normalUpdated=normal;
#endif
#ifdef TANGENT
vec4 tangentUpdated=tangent;
#endif
#ifdef UV1
vec2 uvUpdated=uv;
#endif
#include<morphTargetsVertexGlobal>
#include<morphTargetsVertex>[0..maxSimultaneousMorphTargets]
#ifdef REFLECTIONMAP_SKYBOX
vPositionUVW=positionUpdated;
#endif
#define CUSTOM_VERTEX_UPDATE_POSITION
#define CUSTOM_VERTEX_UPDATE_NORMAL
#include<instancesVertex>
#if defined(PREPASS) && defined(PREPASS_VELOCITY) && !defined(BONES_VELOCITY_ENABLED)
vCurrentPosition=viewProjection*finalWorld*vec4(positionUpdated,1.0);vPreviousPosition=previousViewProjection*finalPreviousWorld*vec4(positionUpdated,1.0);
#endif
#include<bonesVertex>
#include<bakedVertexAnimation>
vec4 worldPos=finalWorld*vec4(positionUpdated,1.0);vPositionW=vec3(worldPos);
#include<prePassVertex>
#ifdef NORMAL
mat3 normalWorld=mat3(finalWorld);
#if defined(INSTANCES) && defined(THIN_INSTANCES)
vNormalW=normalUpdated/vec3(dot(normalWorld[0],normalWorld[0]),dot(normalWorld[1],normalWorld[1]),dot(normalWorld[2],normalWorld[2]));vNormalW=normalize(normalWorld*vNormalW);
#else
#ifdef NONUNIFORMSCALING
normalWorld=transposeMat3(inverseMat3(normalWorld));
#endif
vNormalW=normalize(normalWorld*normalUpdated);
#endif
#if defined(USESPHERICALFROMREFLECTIONMAP) && defined(USESPHERICALINVERTEX)
vec3 reflectionVector=vec3(reflectionMatrix*vec4(vNormalW,0)).xyz;
#ifdef REFLECTIONMAP_OPPOSITEZ
reflectionVector.z*=-1.0;
#endif
vEnvironmentIrradiance=computeEnvironmentIrradiance(reflectionVector);
#endif
#endif
#define CUSTOM_VERTEX_UPDATE_WORLDPOS
#ifdef MULTIVIEW
if (gl_ViewID_OVR==0u) {gl_Position=viewProjection*worldPos;} else {gl_Position=viewProjectionR*worldPos;}
#else
gl_Position=viewProjection*worldPos;
#endif
#if DEBUGMODE>0
vClipSpacePosition=gl_Position;
#endif
#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)
vDirectionW=normalize(vec3(finalWorld*vec4(positionUpdated,0.0)));
#endif
#ifndef UV1
vec2 uvUpdated=vec2(0.,0.);
#endif
#ifdef MAINUV1
vMainUV1=uvUpdated;
#endif
#include<uvVariableDeclaration>[2..7]
#include<samplerVertexImplementation>(_DEFINENAME_,ALBEDO,_VARYINGNAME_,Albedo,_MATRIXNAME_,albedo,_INFONAME_,AlbedoInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail,_MATRIXNAME_,detail,_INFONAME_,DetailInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient,_MATRIXNAME_,ambient,_INFONAME_,AmbientInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity,_MATRIXNAME_,opacity,_INFONAME_,OpacityInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive,_MATRIXNAME_,emissive,_INFONAME_,EmissiveInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap,_MATRIXNAME_,lightmap,_INFONAME_,LightmapInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,REFLECTIVITY,_VARYINGNAME_,Reflectivity,_MATRIXNAME_,reflectivity,_INFONAME_,ReflectivityInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,MICROSURFACEMAP,_VARYINGNAME_,MicroSurfaceSampler,_MATRIXNAME_,microSurfaceSampler,_INFONAME_,MicroSurfaceSamplerInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,METALLIC_REFLECTANCE,_VARYINGNAME_,MetallicReflectance,_MATRIXNAME_,metallicReflectance,_INFONAME_,MetallicReflectanceInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,REFLECTANCE,_VARYINGNAME_,Reflectance,_MATRIXNAME_,reflectance,_INFONAME_,ReflectanceInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump,_MATRIXNAME_,bump,_INFONAME_,BumpInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,DECAL,_VARYINGNAME_,Decal,_MATRIXNAME_,decal,_INFONAME_,DecalInfos.x)
#ifdef CLEARCOAT
#include<samplerVertexImplementation>(_DEFINENAME_,CLEARCOAT_TEXTURE,_VARYINGNAME_,ClearCoat,_MATRIXNAME_,clearCoat,_INFONAME_,ClearCoatInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,CLEARCOAT_TEXTURE_ROUGHNESS,_VARYINGNAME_,ClearCoatRoughness,_MATRIXNAME_,clearCoatRoughness,_INFONAME_,ClearCoatInfos.z)
#include<samplerVertexImplementation>(_DEFINENAME_,CLEARCOAT_BUMP,_VARYINGNAME_,ClearCoatBump,_MATRIXNAME_,clearCoatBump,_INFONAME_,ClearCoatBumpInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,CLEARCOAT_TINT_TEXTURE,_VARYINGNAME_,ClearCoatTint,_MATRIXNAME_,clearCoatTint,_INFONAME_,ClearCoatTintInfos.x)
#endif
#ifdef IRIDESCENCE
#include<samplerVertexImplementation>(_DEFINENAME_,IRIDESCENCE_TEXTURE,_VARYINGNAME_,Iridescence,_MATRIXNAME_,iridescence,_INFONAME_,IridescenceInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,IRIDESCENCE_THICKNESS_TEXTURE,_VARYINGNAME_,IridescenceThickness,_MATRIXNAME_,iridescenceThickness,_INFONAME_,IridescenceInfos.z)
#endif
#ifdef SHEEN
#include<samplerVertexImplementation>(_DEFINENAME_,SHEEN_TEXTURE,_VARYINGNAME_,Sheen,_MATRIXNAME_,sheen,_INFONAME_,SheenInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,SHEEN_TEXTURE_ROUGHNESS,_VARYINGNAME_,SheenRoughness,_MATRIXNAME_,sheenRoughness,_INFONAME_,SheenInfos.z)
#endif
#ifdef ANISOTROPIC
#include<samplerVertexImplementation>(_DEFINENAME_,ANISOTROPIC_TEXTURE,_VARYINGNAME_,Anisotropy,_MATRIXNAME_,anisotropy,_INFONAME_,AnisotropyInfos.x)
#endif
#ifdef SUBSURFACE
#include<samplerVertexImplementation>(_DEFINENAME_,SS_THICKNESSANDMASK_TEXTURE,_VARYINGNAME_,Thickness,_MATRIXNAME_,thickness,_INFONAME_,ThicknessInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,SS_REFRACTIONINTENSITY_TEXTURE,_VARYINGNAME_,RefractionIntensity,_MATRIXNAME_,refractionIntensity,_INFONAME_,RefractionIntensityInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,SS_TRANSLUCENCYINTENSITY_TEXTURE,_VARYINGNAME_,TranslucencyIntensity,_MATRIXNAME_,translucencyIntensity,_INFONAME_,TranslucencyIntensityInfos.x)
#endif
#include<bumpVertex>
#include<clipPlaneVertex>
#include<fogVertex>
#include<shadowsVertex>[0..maxSimultaneousLights]
#include<vertexColorMixing>
#if defined(POINTSIZE) && !defined(WEBGPU)
gl_PointSize=pointSize;
#endif
#include<logDepthVertex>
#define CUSTOM_VERTEX_MAIN_END
}`;ne.ShadersStore[fX]=_X;class pX extends Ws{constructor(){super(...arguments),this.CLEARCOAT=!1,this.CLEARCOAT_DEFAULTIOR=!1,this.CLEARCOAT_TEXTURE=!1,this.CLEARCOAT_TEXTURE_ROUGHNESS=!1,this.CLEARCOAT_TEXTUREDIRECTUV=0,this.CLEARCOAT_TEXTURE_ROUGHNESSDIRECTUV=0,this.CLEARCOAT_BUMP=!1,this.CLEARCOAT_BUMPDIRECTUV=0,this.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE=!1,this.CLEARCOAT_TEXTURE_ROUGHNESS_IDENTICAL=!1,this.CLEARCOAT_REMAP_F0=!1,this.CLEARCOAT_TINT=!1,this.CLEARCOAT_TINT_TEXTURE=!1,this.CLEARCOAT_TINT_TEXTUREDIRECTUV=0,this.CLEARCOAT_TINT_GAMMATEXTURE=!1}}class Wi extends Gn{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}constructor(e,t=!0){super(e,"PBRClearCoat",100,new pX,t),this._isEnabled=!1,this.isEnabled=!1,this.intensity=1,this.roughness=0,this._indexOfRefraction=Wi._DefaultIndexOfRefraction,this.indexOfRefraction=Wi._DefaultIndexOfRefraction,this._texture=null,this.texture=null,this._useRoughnessFromMainTexture=!0,this.useRoughnessFromMainTexture=!0,this._textureRoughness=null,this.textureRoughness=null,this._remapF0OnInterfaceChange=!0,this.remapF0OnInterfaceChange=!0,this._bumpTexture=null,this.bumpTexture=null,this._isTintEnabled=!1,this.isTintEnabled=!1,this.tintColor=Pe.White(),this.tintColorAtDistance=1,this.tintThickness=1,this._tintTexture=null,this.tintTexture=null,this._internalMarkAllSubMeshesAsTexturesDirty=e._dirtyCallbacks[1]}isReadyForSubMesh(e,t,i){if(!this._isEnabled)return!0;const r=this._material._disableBumpMap;return!(e._areTexturesDirty&&t.texturesEnabled&&(this._texture&&te.ClearCoatTextureEnabled&&!this._texture.isReadyOrNotBlocking()||this._textureRoughness&&te.ClearCoatTextureEnabled&&!this._textureRoughness.isReadyOrNotBlocking()||i.getCaps().standardDerivatives&&this._bumpTexture&&te.ClearCoatBumpTextureEnabled&&!r&&!this._bumpTexture.isReady()||this._isTintEnabled&&this._tintTexture&&te.ClearCoatTintTextureEnabled&&!this._tintTexture.isReadyOrNotBlocking()))}prepareDefinesBeforeAttributes(e,t){var i;this._isEnabled?(e.CLEARCOAT=!0,e.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE=this._useRoughnessFromMainTexture,e.CLEARCOAT_TEXTURE_ROUGHNESS_IDENTICAL=this._texture!==null&&this._texture._texture===((i=this._textureRoughness)==null?void 0:i._texture)&&this._texture.checkTransformsAreIdentical(this._textureRoughness),e.CLEARCOAT_REMAP_F0=this._remapF0OnInterfaceChange,e._areTexturesDirty&&t.texturesEnabled&&(this._texture&&te.ClearCoatTextureEnabled?Bt(this._texture,e,"CLEARCOAT_TEXTURE"):e.CLEARCOAT_TEXTURE=!1,this._textureRoughness&&te.ClearCoatTextureEnabled?Bt(this._textureRoughness,e,"CLEARCOAT_TEXTURE_ROUGHNESS"):e.CLEARCOAT_TEXTURE_ROUGHNESS=!1,this._bumpTexture&&te.ClearCoatBumpTextureEnabled?Bt(this._bumpTexture,e,"CLEARCOAT_BUMP"):e.CLEARCOAT_BUMP=!1,e.CLEARCOAT_DEFAULTIOR=this._indexOfRefraction===Wi._DefaultIndexOfRefraction,this._isTintEnabled?(e.CLEARCOAT_TINT=!0,this._tintTexture&&te.ClearCoatTintTextureEnabled?(Bt(this._tintTexture,e,"CLEARCOAT_TINT_TEXTURE"),e.CLEARCOAT_TINT_GAMMATEXTURE=this._tintTexture.gammaSpace):e.CLEARCOAT_TINT_TEXTURE=!1):(e.CLEARCOAT_TINT=!1,e.CLEARCOAT_TINT_TEXTURE=!1))):(e.CLEARCOAT=!1,e.CLEARCOAT_TEXTURE=!1,e.CLEARCOAT_TEXTURE_ROUGHNESS=!1,e.CLEARCOAT_BUMP=!1,e.CLEARCOAT_TINT=!1,e.CLEARCOAT_TINT_TEXTURE=!1,e.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE=!1,e.CLEARCOAT_TEXTURE_ROUGHNESS_IDENTICAL=!1,e.CLEARCOAT_DEFAULTIOR=!1,e.CLEARCOAT_TEXTUREDIRECTUV=0,e.CLEARCOAT_TEXTURE_ROUGHNESSDIRECTUV=0,e.CLEARCOAT_BUMPDIRECTUV=0,e.CLEARCOAT_REMAP_F0=!1,e.CLEARCOAT_TINT_TEXTUREDIRECTUV=0,e.CLEARCOAT_TINT_GAMMATEXTURE=!1)}bindForSubMesh(e,t,i,r){var h,d,f,_;if(!this._isEnabled)return;const s=r.materialDefines,a=this._material.isFrozen,l=this._material._disableBumpMap,o=this._material._invertNormalMapX,c=this._material._invertNormalMapY,u=s.CLEARCOAT_TEXTURE_ROUGHNESS_IDENTICAL;if(!e.useUbo||!a||!e.isSync){u&&te.ClearCoatTextureEnabled?(e.updateFloat4("vClearCoatInfos",this._texture.coordinatesIndex,this._texture.level,-1,-1),Dt(this._texture,e,"clearCoat")):(this._texture||this._textureRoughness)&&te.ClearCoatTextureEnabled&&(e.updateFloat4("vClearCoatInfos",((h=this._texture)==null?void 0:h.coordinatesIndex)??0,((d=this._texture)==null?void 0:d.level)??0,((f=this._textureRoughness)==null?void 0:f.coordinatesIndex)??0,((_=this._textureRoughness)==null?void 0:_.level)??0),this._texture&&Dt(this._texture,e,"clearCoat"),this._textureRoughness&&!u&&!s.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE&&Dt(this._textureRoughness,e,"clearCoatRoughness")),this._bumpTexture&&i.getCaps().standardDerivatives&&te.ClearCoatTextureEnabled&&!l&&(e.updateFloat2("vClearCoatBumpInfos",this._bumpTexture.coordinatesIndex,this._bumpTexture.level),Dt(this._bumpTexture,e,"clearCoatBump"),t._mirroredCameraPosition?e.updateFloat2("vClearCoatTangentSpaceParams",o?1:-1,c?1:-1):e.updateFloat2("vClearCoatTangentSpaceParams",o?-1:1,c?-1:1)),this._tintTexture&&te.ClearCoatTintTextureEnabled&&(e.updateFloat2("vClearCoatTintInfos",this._tintTexture.coordinatesIndex,this._tintTexture.level),Dt(this._tintTexture,e,"clearCoatTint")),e.updateFloat2("vClearCoatParams",this.intensity,this.roughness);const p=1-this._indexOfRefraction,v=1+this._indexOfRefraction,E=Math.pow(-p/v,2),g=1/this._indexOfRefraction;e.updateFloat4("vClearCoatRefractionParams",E,g,p,v),this._isTintEnabled&&(e.updateFloat4("vClearCoatTintParams",this.tintColor.r,this.tintColor.g,this.tintColor.b,Math.max(1e-5,this.tintThickness)),e.updateFloat("clearCoatColorAtDistance",Math.max(1e-5,this.tintColorAtDistance)))}t.texturesEnabled&&(this._texture&&te.ClearCoatTextureEnabled&&e.setTexture("clearCoatSampler",this._texture),this._textureRoughness&&!u&&!s.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE&&te.ClearCoatTextureEnabled&&e.setTexture("clearCoatRoughnessSampler",this._textureRoughness),this._bumpTexture&&i.getCaps().standardDerivatives&&te.ClearCoatBumpTextureEnabled&&!l&&e.setTexture("clearCoatBumpSampler",this._bumpTexture),this._isTintEnabled&&this._tintTexture&&te.ClearCoatTintTextureEnabled&&e.setTexture("clearCoatTintSampler",this._tintTexture))}hasTexture(e){return this._texture===e||this._textureRoughness===e||this._bumpTexture===e||this._tintTexture===e}getActiveTextures(e){this._texture&&e.push(this._texture),this._textureRoughness&&e.push(this._textureRoughness),this._bumpTexture&&e.push(this._bumpTexture),this._tintTexture&&e.push(this._tintTexture)}getAnimatables(e){this._texture&&this._texture.animations&&this._texture.animations.length>0&&e.push(this._texture),this._textureRoughness&&this._textureRoughness.animations&&this._textureRoughness.animations.length>0&&e.push(this._textureRoughness),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&e.push(this._bumpTexture),this._tintTexture&&this._tintTexture.animations&&this._tintTexture.animations.length>0&&e.push(this._tintTexture)}dispose(e){var t,i,r,s;e&&((t=this._texture)==null||t.dispose(),(i=this._textureRoughness)==null||i.dispose(),(r=this._bumpTexture)==null||r.dispose(),(s=this._tintTexture)==null||s.dispose())}getClassName(){return"PBRClearCoatConfiguration"}addFallbacks(e,t,i){return e.CLEARCOAT_BUMP&&t.addFallback(i++,"CLEARCOAT_BUMP"),e.CLEARCOAT_TINT&&t.addFallback(i++,"CLEARCOAT_TINT"),e.CLEARCOAT&&t.addFallback(i++,"CLEARCOAT"),i}getSamplers(e){e.push("clearCoatSampler","clearCoatRoughnessSampler","clearCoatBumpSampler","clearCoatTintSampler")}getUniforms(){return{ubo:[{name:"vClearCoatParams",size:2,type:"vec2"},{name:"vClearCoatRefractionParams",size:4,type:"vec4"},{name:"vClearCoatInfos",size:4,type:"vec4"},{name:"clearCoatMatrix",size:16,type:"mat4"},{name:"clearCoatRoughnessMatrix",size:16,type:"mat4"},{name:"vClearCoatBumpInfos",size:2,type:"vec2"},{name:"vClearCoatTangentSpaceParams",size:2,type:"vec2"},{name:"clearCoatBumpMatrix",size:16,type:"mat4"},{name:"vClearCoatTintParams",size:4,type:"vec4"},{name:"clearCoatColorAtDistance",size:1,type:"float"},{name:"vClearCoatTintInfos",size:2,type:"vec2"},{name:"clearCoatTintMatrix",size:16,type:"mat4"}]}}}Wi._DefaultIndexOfRefraction=1.5;R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Wi.prototype,"isEnabled",void 0);R([I()],Wi.prototype,"intensity",void 0);R([I()],Wi.prototype,"roughness",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Wi.prototype,"indexOfRefraction",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Wi.prototype,"texture",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Wi.prototype,"useRoughnessFromMainTexture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Wi.prototype,"textureRoughness",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Wi.prototype,"remapF0OnInterfaceChange",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Wi.prototype,"bumpTexture",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Wi.prototype,"isTintEnabled",void 0);R([br()],Wi.prototype,"tintColor",void 0);R([I()],Wi.prototype,"tintColorAtDistance",void 0);R([I()],Wi.prototype,"tintThickness",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Wi.prototype,"tintTexture",void 0);class gX extends Ws{constructor(){super(...arguments),this.IRIDESCENCE=!1,this.IRIDESCENCE_TEXTURE=!1,this.IRIDESCENCE_TEXTUREDIRECTUV=0,this.IRIDESCENCE_THICKNESS_TEXTURE=!1,this.IRIDESCENCE_THICKNESS_TEXTUREDIRECTUV=0,this.IRIDESCENCE_USE_THICKNESS_FROM_MAINTEXTURE=!1}}class wr extends Gn{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}constructor(e,t=!0){super(e,"PBRIridescence",110,new gX,t),this._isEnabled=!1,this.isEnabled=!1,this.intensity=1,this.minimumThickness=wr._DefaultMinimumThickness,this.maximumThickness=wr._DefaultMaximumThickness,this.indexOfRefraction=wr._DefaultIndexOfRefraction,this._texture=null,this.texture=null,this._thicknessTexture=null,this.thicknessTexture=null,this._internalMarkAllSubMeshesAsTexturesDirty=e._dirtyCallbacks[1]}isReadyForSubMesh(e,t){return this._isEnabled?!(e._areTexturesDirty&&t.texturesEnabled&&(this._texture&&te.IridescenceTextureEnabled&&!this._texture.isReadyOrNotBlocking()||this._thicknessTexture&&te.IridescenceTextureEnabled&&!this._thicknessTexture.isReadyOrNotBlocking())):!0}prepareDefinesBeforeAttributes(e,t){var i;this._isEnabled?(e.IRIDESCENCE=!0,e.IRIDESCENCE_USE_THICKNESS_FROM_MAINTEXTURE=this._texture!==null&&this._texture._texture===((i=this._thicknessTexture)==null?void 0:i._texture)&&this._texture.checkTransformsAreIdentical(this._thicknessTexture),e._areTexturesDirty&&t.texturesEnabled&&(this._texture&&te.IridescenceTextureEnabled?Bt(this._texture,e,"IRIDESCENCE_TEXTURE"):e.IRIDESCENCE_TEXTURE=!1,!e.IRIDESCENCE_USE_THICKNESS_FROM_MAINTEXTURE&&this._thicknessTexture&&te.IridescenceTextureEnabled?Bt(this._thicknessTexture,e,"IRIDESCENCE_THICKNESS_TEXTURE"):e.IRIDESCENCE_THICKNESS_TEXTURE=!1)):(e.IRIDESCENCE=!1,e.IRIDESCENCE_TEXTURE=!1,e.IRIDESCENCE_THICKNESS_TEXTURE=!1,e.IRIDESCENCE_USE_THICKNESS_FROM_MAINTEXTURE=!1,e.IRIDESCENCE_TEXTUREDIRECTUV=0,e.IRIDESCENCE_THICKNESS_TEXTUREDIRECTUV=0)}bindForSubMesh(e,t,i,r){var o,c,u,h;if(!this._isEnabled)return;const s=r.materialDefines,a=this._material.isFrozen,l=s.IRIDESCENCE_USE_THICKNESS_FROM_MAINTEXTURE;(!e.useUbo||!a||!e.isSync)&&(l&&te.IridescenceTextureEnabled?(e.updateFloat4("vIridescenceInfos",this._texture.coordinatesIndex,this._texture.level,-1,-1),Dt(this._texture,e,"iridescence")):(this._texture||this._thicknessTexture)&&te.IridescenceTextureEnabled&&(e.updateFloat4("vIridescenceInfos",((o=this._texture)==null?void 0:o.coordinatesIndex)??0,((c=this._texture)==null?void 0:c.level)??0,((u=this._thicknessTexture)==null?void 0:u.coordinatesIndex)??0,((h=this._thicknessTexture)==null?void 0:h.level)??0),this._texture&&Dt(this._texture,e,"iridescence"),this._thicknessTexture&&!l&&!s.IRIDESCENCE_USE_THICKNESS_FROM_MAINTEXTURE&&Dt(this._thicknessTexture,e,"iridescenceThickness")),e.updateFloat4("vIridescenceParams",this.intensity,this.indexOfRefraction,this.minimumThickness,this.maximumThickness)),t.texturesEnabled&&(this._texture&&te.IridescenceTextureEnabled&&e.setTexture("iridescenceSampler",this._texture),this._thicknessTexture&&!l&&!s.IRIDESCENCE_USE_THICKNESS_FROM_MAINTEXTURE&&te.IridescenceTextureEnabled&&e.setTexture("iridescenceThicknessSampler",this._thicknessTexture))}hasTexture(e){return this._texture===e||this._thicknessTexture===e}getActiveTextures(e){this._texture&&e.push(this._texture),this._thicknessTexture&&e.push(this._thicknessTexture)}getAnimatables(e){this._texture&&this._texture.animations&&this._texture.animations.length>0&&e.push(this._texture),this._thicknessTexture&&this._thicknessTexture.animations&&this._thicknessTexture.animations.length>0&&e.push(this._thicknessTexture)}dispose(e){var t,i;e&&((t=this._texture)==null||t.dispose(),(i=this._thicknessTexture)==null||i.dispose())}getClassName(){return"PBRIridescenceConfiguration"}addFallbacks(e,t,i){return e.IRIDESCENCE&&t.addFallback(i++,"IRIDESCENCE"),i}getSamplers(e){e.push("iridescenceSampler","iridescenceThicknessSampler")}getUniforms(){return{ubo:[{name:"vIridescenceParams",size:4,type:"vec4"},{name:"vIridescenceInfos",size:4,type:"vec4"},{name:"iridescenceMatrix",size:16,type:"mat4"},{name:"iridescenceThicknessMatrix",size:16,type:"mat4"}]}}}wr._DefaultMinimumThickness=100;wr._DefaultMaximumThickness=400;wr._DefaultIndexOfRefraction=1.3;R([I(),ie("_markAllSubMeshesAsTexturesDirty")],wr.prototype,"isEnabled",void 0);R([I()],wr.prototype,"intensity",void 0);R([I()],wr.prototype,"minimumThickness",void 0);R([I()],wr.prototype,"maximumThickness",void 0);R([I()],wr.prototype,"indexOfRefraction",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],wr.prototype,"texture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],wr.prototype,"thicknessTexture",void 0);class mX extends Ws{constructor(){super(...arguments),this.ANISOTROPIC=!1,this.ANISOTROPIC_TEXTURE=!1,this.ANISOTROPIC_TEXTUREDIRECTUV=0,this.ANISOTROPIC_LEGACY=!1,this.MAINUV1=!1}}class dc extends Gn{set angle(e){this.direction.x=Math.cos(e),this.direction.y=Math.sin(e)}get angle(){return Math.atan2(this.direction.y,this.direction.x)}_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}_markAllSubMeshesAsMiscDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsMiscDirty()}constructor(e,t=!0){super(e,"PBRAnisotropic",110,new mX,t),this._isEnabled=!1,this.isEnabled=!1,this.intensity=1,this.direction=new xe(1,0),this._texture=null,this.texture=null,this._legacy=!1,this.legacy=!1,this._internalMarkAllSubMeshesAsTexturesDirty=e._dirtyCallbacks[1],this._internalMarkAllSubMeshesAsMiscDirty=e._dirtyCallbacks[16]}isReadyForSubMesh(e,t){return this._isEnabled?!(e._areTexturesDirty&&t.texturesEnabled&&this._texture&&te.AnisotropicTextureEnabled&&!this._texture.isReadyOrNotBlocking()):!0}prepareDefinesBeforeAttributes(e,t,i){this._isEnabled?(e.ANISOTROPIC=this._isEnabled,this._isEnabled&&!i.isVerticesDataPresent(x.TangentKind)&&(e._needUVs=!0,e.MAINUV1=!0),e._areTexturesDirty&&t.texturesEnabled&&(this._texture&&te.AnisotropicTextureEnabled?Bt(this._texture,e,"ANISOTROPIC_TEXTURE"):e.ANISOTROPIC_TEXTURE=!1),e._areMiscDirty&&(e.ANISOTROPIC_LEGACY=this._legacy)):(e.ANISOTROPIC=!1,e.ANISOTROPIC_TEXTURE=!1,e.ANISOTROPIC_TEXTUREDIRECTUV=0,e.ANISOTROPIC_LEGACY=!1)}bindForSubMesh(e,t){if(!this._isEnabled)return;const i=this._material.isFrozen;(!e.useUbo||!i||!e.isSync)&&(this._texture&&te.AnisotropicTextureEnabled&&(e.updateFloat2("vAnisotropyInfos",this._texture.coordinatesIndex,this._texture.level),Dt(this._texture,e,"anisotropy")),e.updateFloat3("vAnisotropy",this.direction.x,this.direction.y,this.intensity)),t.texturesEnabled&&this._texture&&te.AnisotropicTextureEnabled&&e.setTexture("anisotropySampler",this._texture)}hasTexture(e){return this._texture===e}getActiveTextures(e){this._texture&&e.push(this._texture)}getAnimatables(e){this._texture&&this._texture.animations&&this._texture.animations.length>0&&e.push(this._texture)}dispose(e){e&&this._texture&&this._texture.dispose()}getClassName(){return"PBRAnisotropicConfiguration"}addFallbacks(e,t,i){return e.ANISOTROPIC&&t.addFallback(i++,"ANISOTROPIC"),i}getSamplers(e){e.push("anisotropySampler")}getUniforms(){return{ubo:[{name:"vAnisotropy",size:3,type:"vec3"},{name:"vAnisotropyInfos",size:2,type:"vec2"},{name:"anisotropyMatrix",size:16,type:"mat4"}]}}parse(e,t,i){super.parse(e,t,i),e.legacy===void 0&&(this.legacy=!0)}}R([I(),ie("_markAllSubMeshesAsTexturesDirty")],dc.prototype,"isEnabled",void 0);R([I()],dc.prototype,"intensity",void 0);R([u1()],dc.prototype,"direction",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],dc.prototype,"texture",void 0);R([I(),ie("_markAllSubMeshesAsMiscDirty")],dc.prototype,"legacy",void 0);class vX extends Ws{constructor(){super(...arguments),this.SHEEN=!1,this.SHEEN_TEXTURE=!1,this.SHEEN_GAMMATEXTURE=!1,this.SHEEN_TEXTURE_ROUGHNESS=!1,this.SHEEN_TEXTUREDIRECTUV=0,this.SHEEN_TEXTURE_ROUGHNESSDIRECTUV=0,this.SHEEN_LINKWITHALBEDO=!1,this.SHEEN_ROUGHNESS=!1,this.SHEEN_ALBEDOSCALING=!1,this.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE=!1,this.SHEEN_TEXTURE_ROUGHNESS_IDENTICAL=!1}}class hs extends Gn{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}constructor(e,t=!0){super(e,"Sheen",120,new vX,t),this._isEnabled=!1,this.isEnabled=!1,this._linkSheenWithAlbedo=!1,this.linkSheenWithAlbedo=!1,this.intensity=1,this.color=Pe.White(),this._texture=null,this.texture=null,this._useRoughnessFromMainTexture=!0,this.useRoughnessFromMainTexture=!0,this._roughness=null,this.roughness=null,this._textureRoughness=null,this.textureRoughness=null,this._albedoScaling=!1,this.albedoScaling=!1,this._internalMarkAllSubMeshesAsTexturesDirty=e._dirtyCallbacks[1]}isReadyForSubMesh(e,t){return this._isEnabled?!(e._areTexturesDirty&&t.texturesEnabled&&(this._texture&&te.SheenTextureEnabled&&!this._texture.isReadyOrNotBlocking()||this._textureRoughness&&te.SheenTextureEnabled&&!this._textureRoughness.isReadyOrNotBlocking())):!0}prepareDefinesBeforeAttributes(e,t){var i;this._isEnabled?(e.SHEEN=!0,e.SHEEN_LINKWITHALBEDO=this._linkSheenWithAlbedo,e.SHEEN_ROUGHNESS=this._roughness!==null,e.SHEEN_ALBEDOSCALING=this._albedoScaling,e.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE=this._useRoughnessFromMainTexture,e.SHEEN_TEXTURE_ROUGHNESS_IDENTICAL=this._texture!==null&&this._texture._texture===((i=this._textureRoughness)==null?void 0:i._texture)&&this._texture.checkTransformsAreIdentical(this._textureRoughness),e._areTexturesDirty&&t.texturesEnabled&&(this._texture&&te.SheenTextureEnabled?(Bt(this._texture,e,"SHEEN_TEXTURE"),e.SHEEN_GAMMATEXTURE=this._texture.gammaSpace):e.SHEEN_TEXTURE=!1,this._textureRoughness&&te.SheenTextureEnabled?Bt(this._textureRoughness,e,"SHEEN_TEXTURE_ROUGHNESS"):e.SHEEN_TEXTURE_ROUGHNESS=!1)):(e.SHEEN=!1,e.SHEEN_TEXTURE=!1,e.SHEEN_TEXTURE_ROUGHNESS=!1,e.SHEEN_LINKWITHALBEDO=!1,e.SHEEN_ROUGHNESS=!1,e.SHEEN_ALBEDOSCALING=!1,e.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE=!1,e.SHEEN_TEXTURE_ROUGHNESS_IDENTICAL=!1,e.SHEEN_GAMMATEXTURE=!1,e.SHEEN_TEXTUREDIRECTUV=0,e.SHEEN_TEXTURE_ROUGHNESSDIRECTUV=0)}bindForSubMesh(e,t,i,r){var o,c,u,h;if(!this._isEnabled)return;const s=r.materialDefines,a=this._material.isFrozen,l=s.SHEEN_TEXTURE_ROUGHNESS_IDENTICAL;(!e.useUbo||!a||!e.isSync)&&(l&&te.SheenTextureEnabled?(e.updateFloat4("vSheenInfos",this._texture.coordinatesIndex,this._texture.level,-1,-1),Dt(this._texture,e,"sheen")):(this._texture||this._textureRoughness)&&te.SheenTextureEnabled&&(e.updateFloat4("vSheenInfos",((o=this._texture)==null?void 0:o.coordinatesIndex)??0,((c=this._texture)==null?void 0:c.level)??0,((u=this._textureRoughness)==null?void 0:u.coordinatesIndex)??0,((h=this._textureRoughness)==null?void 0:h.level)??0),this._texture&&Dt(this._texture,e,"sheen"),this._textureRoughness&&!l&&!s.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE&&Dt(this._textureRoughness,e,"sheenRoughness")),e.updateFloat4("vSheenColor",this.color.r,this.color.g,this.color.b,this.intensity),this._roughness!==null&&e.updateFloat("vSheenRoughness",this._roughness)),t.texturesEnabled&&(this._texture&&te.SheenTextureEnabled&&e.setTexture("sheenSampler",this._texture),this._textureRoughness&&!l&&!s.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE&&te.SheenTextureEnabled&&e.setTexture("sheenRoughnessSampler",this._textureRoughness))}hasTexture(e){return this._texture===e||this._textureRoughness===e}getActiveTextures(e){this._texture&&e.push(this._texture),this._textureRoughness&&e.push(this._textureRoughness)}getAnimatables(e){this._texture&&this._texture.animations&&this._texture.animations.length>0&&e.push(this._texture),this._textureRoughness&&this._textureRoughness.animations&&this._textureRoughness.animations.length>0&&e.push(this._textureRoughness)}dispose(e){var t,i;e&&((t=this._texture)==null||t.dispose(),(i=this._textureRoughness)==null||i.dispose())}getClassName(){return"PBRSheenConfiguration"}addFallbacks(e,t,i){return e.SHEEN&&t.addFallback(i++,"SHEEN"),i}getSamplers(e){e.push("sheenSampler","sheenRoughnessSampler")}getUniforms(){return{ubo:[{name:"vSheenColor",size:4,type:"vec4"},{name:"vSheenRoughness",size:1,type:"float"},{name:"vSheenInfos",size:4,type:"vec4"},{name:"sheenMatrix",size:16,type:"mat4"},{name:"sheenRoughnessMatrix",size:16,type:"mat4"}]}}}R([I(),ie("_markAllSubMeshesAsTexturesDirty")],hs.prototype,"isEnabled",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],hs.prototype,"linkSheenWithAlbedo",void 0);R([I()],hs.prototype,"intensity",void 0);R([br()],hs.prototype,"color",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],hs.prototype,"texture",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],hs.prototype,"useRoughnessFromMainTexture",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],hs.prototype,"roughness",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],hs.prototype,"textureRoughness",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],hs.prototype,"albedoScaling",void 0);class EX extends Ws{constructor(){super(...arguments),this.SUBSURFACE=!1,this.SS_REFRACTION=!1,this.SS_REFRACTION_USE_INTENSITY_FROM_TEXTURE=!1,this.SS_TRANSLUCENCY=!1,this.SS_TRANSLUCENCY_USE_INTENSITY_FROM_TEXTURE=!1,this.SS_SCATTERING=!1,this.SS_DISPERSION=!1,this.SS_THICKNESSANDMASK_TEXTURE=!1,this.SS_THICKNESSANDMASK_TEXTUREDIRECTUV=0,this.SS_HAS_THICKNESS=!1,this.SS_REFRACTIONINTENSITY_TEXTURE=!1,this.SS_REFRACTIONINTENSITY_TEXTUREDIRECTUV=0,this.SS_TRANSLUCENCYINTENSITY_TEXTURE=!1,this.SS_TRANSLUCENCYINTENSITY_TEXTUREDIRECTUV=0,this.SS_REFRACTIONMAP_3D=!1,this.SS_REFRACTIONMAP_OPPOSITEZ=!1,this.SS_LODINREFRACTIONALPHA=!1,this.SS_GAMMAREFRACTION=!1,this.SS_RGBDREFRACTION=!1,this.SS_LINEARSPECULARREFRACTION=!1,this.SS_LINKREFRACTIONTOTRANSPARENCY=!1,this.SS_ALBEDOFORREFRACTIONTINT=!1,this.SS_ALBEDOFORTRANSLUCENCYTINT=!1,this.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=!1,this.SS_USE_THICKNESS_AS_DEPTH=!1,this.SS_MASK_FROM_THICKNESS_TEXTURE=!1,this.SS_USE_GLTF_TEXTURES=!1}}class Qt extends Gn{get scatteringDiffusionProfile(){return this._scene.subSurfaceConfiguration?this._scene.subSurfaceConfiguration.ssDiffusionProfileColors[this._scatteringDiffusionProfileIndex]:null}set scatteringDiffusionProfile(e){this._scene.enableSubSurfaceForPrePass()&&e&&(this._scatteringDiffusionProfileIndex=this._scene.subSurfaceConfiguration.addDiffusionProfile(e))}get volumeIndexOfRefraction(){return this._volumeIndexOfRefraction>=1?this._volumeIndexOfRefraction:this._indexOfRefraction}set volumeIndexOfRefraction(e){e>=1?this._volumeIndexOfRefraction=e:this._volumeIndexOfRefraction=-1}_markAllSubMeshesAsTexturesDirty(){this._enable(this._isRefractionEnabled||this._isTranslucencyEnabled||this._isScatteringEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}_markScenePrePassDirty(){this._internalMarkAllSubMeshesAsTexturesDirty(),this._internalMarkScenePrePassDirty()}constructor(e,t=!0){super(e,"PBRSubSurface",130,new EX,t),this._isRefractionEnabled=!1,this.isRefractionEnabled=!1,this._isTranslucencyEnabled=!1,this.isTranslucencyEnabled=!1,this._isDispersionEnabled=!1,this.isDispersionEnabled=!1,this._isScatteringEnabled=!1,this.isScatteringEnabled=!1,this._scatteringDiffusionProfileIndex=0,this.refractionIntensity=1,this.translucencyIntensity=1,this.useAlbedoToTintRefraction=!1,this.useAlbedoToTintTranslucency=!1,this._thicknessTexture=null,this.thicknessTexture=null,this._refractionTexture=null,this.refractionTexture=null,this._indexOfRefraction=1.5,this.indexOfRefraction=1.5,this._volumeIndexOfRefraction=-1,this._invertRefractionY=!1,this.invertRefractionY=!1,this._linkRefractionWithTransparency=!1,this.linkRefractionWithTransparency=!1,this.minimumThickness=0,this.maximumThickness=1,this.useThicknessAsDepth=!1,this.tintColor=Pe.White(),this.tintColorAtDistance=1,this.dispersion=0,this.diffusionDistance=Pe.White(),this._useMaskFromThicknessTexture=!1,this.useMaskFromThicknessTexture=!1,this._refractionIntensityTexture=null,this.refractionIntensityTexture=null,this._translucencyIntensityTexture=null,this.translucencyIntensityTexture=null,this._useGltfStyleTextures=!1,this.useGltfStyleTextures=!1,this._scene=e.getScene(),this.registerForExtraEvents=!0,this._internalMarkAllSubMeshesAsTexturesDirty=e._dirtyCallbacks[1],this._internalMarkScenePrePassDirty=e._dirtyCallbacks[32]}isReadyForSubMesh(e,t){if(!this._isRefractionEnabled&&!this._isTranslucencyEnabled&&!this._isScatteringEnabled)return!0;if(e._areTexturesDirty&&t.texturesEnabled){if(this._thicknessTexture&&te.ThicknessTextureEnabled&&!this._thicknessTexture.isReadyOrNotBlocking())return!1;const i=this._getRefractionTexture(t);if(i&&te.RefractionTextureEnabled&&!i.isReadyOrNotBlocking())return!1}return!0}prepareDefinesBeforeAttributes(e,t){if(!this._isRefractionEnabled&&!this._isTranslucencyEnabled&&!this._isScatteringEnabled){e.SUBSURFACE=!1,e.SS_DISPERSION=!1,e.SS_TRANSLUCENCY=!1,e.SS_SCATTERING=!1,e.SS_REFRACTION=!1,e.SS_REFRACTION_USE_INTENSITY_FROM_TEXTURE=!1,e.SS_TRANSLUCENCY_USE_INTENSITY_FROM_TEXTURE=!1,e.SS_THICKNESSANDMASK_TEXTURE=!1,e.SS_THICKNESSANDMASK_TEXTUREDIRECTUV=0,e.SS_HAS_THICKNESS=!1,e.SS_REFRACTIONINTENSITY_TEXTURE=!1,e.SS_REFRACTIONINTENSITY_TEXTUREDIRECTUV=0,e.SS_TRANSLUCENCYINTENSITY_TEXTURE=!1,e.SS_TRANSLUCENCYINTENSITY_TEXTUREDIRECTUV=0,e.SS_REFRACTIONMAP_3D=!1,e.SS_REFRACTIONMAP_OPPOSITEZ=!1,e.SS_LODINREFRACTIONALPHA=!1,e.SS_GAMMAREFRACTION=!1,e.SS_RGBDREFRACTION=!1,e.SS_LINEARSPECULARREFRACTION=!1,e.SS_LINKREFRACTIONTOTRANSPARENCY=!1,e.SS_ALBEDOFORREFRACTIONTINT=!1,e.SS_ALBEDOFORTRANSLUCENCYTINT=!1,e.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=!1,e.SS_USE_THICKNESS_AS_DEPTH=!1,e.SS_MASK_FROM_THICKNESS_TEXTURE=!1,e.SS_USE_GLTF_TEXTURES=!1;return}if(e._areTexturesDirty){e.SUBSURFACE=!0,e.SS_DISPERSION=this._isDispersionEnabled,e.SS_TRANSLUCENCY=this._isTranslucencyEnabled,e.SS_TRANSLUCENCY_USE_INTENSITY_FROM_TEXTURE=!1,e.SS_SCATTERING=this._isScatteringEnabled,e.SS_THICKNESSANDMASK_TEXTURE=!1,e.SS_REFRACTIONINTENSITY_TEXTURE=!1,e.SS_TRANSLUCENCYINTENSITY_TEXTURE=!1,e.SS_HAS_THICKNESS=!1,e.SS_MASK_FROM_THICKNESS_TEXTURE=!1,e.SS_USE_GLTF_TEXTURES=!1,e.SS_REFRACTION=!1,e.SS_REFRACTION_USE_INTENSITY_FROM_TEXTURE=!1,e.SS_REFRACTIONMAP_3D=!1,e.SS_GAMMAREFRACTION=!1,e.SS_RGBDREFRACTION=!1,e.SS_LINEARSPECULARREFRACTION=!1,e.SS_REFRACTIONMAP_OPPOSITEZ=!1,e.SS_LODINREFRACTIONALPHA=!1,e.SS_LINKREFRACTIONTOTRANSPARENCY=!1,e.SS_ALBEDOFORREFRACTIONTINT=!1,e.SS_ALBEDOFORTRANSLUCENCYTINT=!1,e.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=!1,e.SS_USE_THICKNESS_AS_DEPTH=!1;const i=!!this._thicknessTexture&&!!this._refractionIntensityTexture&&this._refractionIntensityTexture.checkTransformsAreIdentical(this._thicknessTexture)&&this._refractionIntensityTexture._texture===this._thicknessTexture._texture,r=!!this._thicknessTexture&&!!this._translucencyIntensityTexture&&this._translucencyIntensityTexture.checkTransformsAreIdentical(this._thicknessTexture)&&this._translucencyIntensityTexture._texture===this._thicknessTexture._texture,s=(i||!this._refractionIntensityTexture)&&(r||!this._translucencyIntensityTexture);if(e._areTexturesDirty&&t.texturesEnabled&&(this._thicknessTexture&&te.ThicknessTextureEnabled&&Bt(this._thicknessTexture,e,"SS_THICKNESSANDMASK_TEXTURE"),this._refractionIntensityTexture&&te.RefractionIntensityTextureEnabled&&!s&&Bt(this._refractionIntensityTexture,e,"SS_REFRACTIONINTENSITY_TEXTURE"),this._translucencyIntensityTexture&&te.TranslucencyIntensityTextureEnabled&&!s&&Bt(this._translucencyIntensityTexture,e,"SS_TRANSLUCENCYINTENSITY_TEXTURE")),e.SS_HAS_THICKNESS=this.maximumThickness-this.minimumThickness!==0,e.SS_MASK_FROM_THICKNESS_TEXTURE=(this._useMaskFromThicknessTexture||!!this._refractionIntensityTexture||!!this._translucencyIntensityTexture)&&s,e.SS_USE_GLTF_TEXTURES=this._useGltfStyleTextures,e.SS_REFRACTION_USE_INTENSITY_FROM_TEXTURE=(this._useMaskFromThicknessTexture||!!this._refractionIntensityTexture)&&s,e.SS_TRANSLUCENCY_USE_INTENSITY_FROM_TEXTURE=(this._useMaskFromThicknessTexture||!!this._translucencyIntensityTexture)&&s,this._isRefractionEnabled&&t.texturesEnabled){const a=this._getRefractionTexture(t);a&&te.RefractionTextureEnabled&&(e.SS_REFRACTION=!0,e.SS_REFRACTIONMAP_3D=a.isCube,e.SS_GAMMAREFRACTION=a.gammaSpace,e.SS_RGBDREFRACTION=a.isRGBD,e.SS_LINEARSPECULARREFRACTION=a.linearSpecularLOD,e.SS_REFRACTIONMAP_OPPOSITEZ=this._scene.useRightHandedSystem&&a.isCube?!a.invertZ:a.invertZ,e.SS_LODINREFRACTIONALPHA=a.lodLevelInAlpha,e.SS_LINKREFRACTIONTOTRANSPARENCY=this._linkRefractionWithTransparency,e.SS_ALBEDOFORREFRACTIONTINT=this.useAlbedoToTintRefraction,e.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=a.isCube&&a.boundingBoxSize,e.SS_USE_THICKNESS_AS_DEPTH=this.useThicknessAsDepth)}this._isTranslucencyEnabled&&(e.SS_ALBEDOFORTRANSLUCENCYTINT=this.useAlbedoToTintTranslucency)}}hardBindForSubMesh(e,t,i,r){if(!this._isRefractionEnabled&&!this._isTranslucencyEnabled&&!this._isScatteringEnabled)return;r.getRenderingMesh().getWorldMatrix().decompose(V.Vector3[0]);const s=Math.max(Math.abs(V.Vector3[0].x),Math.abs(V.Vector3[0].y),Math.abs(V.Vector3[0].z));e.updateFloat2("vThicknessParam",this.minimumThickness*s,(this.maximumThickness-this.minimumThickness)*s)}bindForSubMesh(e,t,i,r){if(!this._isRefractionEnabled&&!this._isTranslucencyEnabled&&!this._isScatteringEnabled)return;const s=r.materialDefines,a=this._material.isFrozen,l=this._material.realTimeFiltering,o=s.LODBASEDMICROSFURACE,c=this._getRefractionTexture(t);if(!e.useUbo||!a||!e.isSync){if(this._thicknessTexture&&te.ThicknessTextureEnabled&&(e.updateFloat2("vThicknessInfos",this._thicknessTexture.coordinatesIndex,this._thicknessTexture.level),Dt(this._thicknessTexture,e,"thickness")),this._refractionIntensityTexture&&te.RefractionIntensityTextureEnabled&&s.SS_REFRACTIONINTENSITY_TEXTURE&&(e.updateFloat2("vRefractionIntensityInfos",this._refractionIntensityTexture.coordinatesIndex,this._refractionIntensityTexture.level),Dt(this._refractionIntensityTexture,e,"refractionIntensity")),this._translucencyIntensityTexture&&te.TranslucencyIntensityTextureEnabled&&s.SS_TRANSLUCENCYINTENSITY_TEXTURE&&(e.updateFloat2("vTranslucencyIntensityInfos",this._translucencyIntensityTexture.coordinatesIndex,this._translucencyIntensityTexture.level),Dt(this._translucencyIntensityTexture,e,"translucencyIntensity")),c&&te.RefractionTextureEnabled){e.updateMatrix("refractionMatrix",c.getRefractionTextureMatrix());let u=1;c.isCube||c.depth&&(u=c.depth);const h=c.getSize().width,d=this.volumeIndexOfRefraction;if(e.updateFloat4("vRefractionInfos",c.level,1/d,u,this._invertRefractionY?-1:1),e.updateFloat4("vRefractionMicrosurfaceInfos",h,c.lodGenerationScale,c.lodGenerationOffset,1/this.indexOfRefraction),l&&e.updateFloat2("vRefractionFilteringInfo",h,dt.Log2(h)),c.boundingBoxSize){const f=c;e.updateVector3("vRefractionPosition",f.boundingBoxPosition),e.updateVector3("vRefractionSize",f.boundingBoxSize)}}this._isScatteringEnabled&&e.updateFloat("scatteringDiffusionProfile",this._scatteringDiffusionProfileIndex),e.updateColor3("vDiffusionDistance",this.diffusionDistance),e.updateFloat4("vTintColor",this.tintColor.r,this.tintColor.g,this.tintColor.b,Math.max(1e-5,this.tintColorAtDistance)),e.updateFloat3("vSubSurfaceIntensity",this.refractionIntensity,this.translucencyIntensity,0),e.updateFloat("dispersion",this.dispersion)}t.texturesEnabled&&(this._thicknessTexture&&te.ThicknessTextureEnabled&&e.setTexture("thicknessSampler",this._thicknessTexture),this._refractionIntensityTexture&&te.RefractionIntensityTextureEnabled&&s.SS_REFRACTIONINTENSITY_TEXTURE&&e.setTexture("refractionIntensitySampler",this._refractionIntensityTexture),this._translucencyIntensityTexture&&te.TranslucencyIntensityTextureEnabled&&s.SS_TRANSLUCENCYINTENSITY_TEXTURE&&e.setTexture("translucencyIntensitySampler",this._translucencyIntensityTexture),c&&te.RefractionTextureEnabled&&(o?e.setTexture("refractionSampler",c):(e.setTexture("refractionSampler",c._lodTextureMid||c),e.setTexture("refractionSamplerLow",c._lodTextureLow||c),e.setTexture("refractionSamplerHigh",c._lodTextureHigh||c))))}_getRefractionTexture(e){return this._refractionTexture?this._refractionTexture:this._isRefractionEnabled?e.environmentTexture:null}get disableAlphaBlending(){return this._isRefractionEnabled&&this._linkRefractionWithTransparency}fillRenderTargetTextures(e){te.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget&&e.push(this._refractionTexture)}hasTexture(e){return this._thicknessTexture===e||this._refractionTexture===e||this._refractionIntensityTexture===e||this._translucencyIntensityTexture===e}hasRenderTargetTextures(){return!!(te.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget)}getActiveTextures(e){this._thicknessTexture&&e.push(this._thicknessTexture),this._refractionTexture&&e.push(this._refractionTexture)}getAnimatables(e){this._thicknessTexture&&this._thicknessTexture.animations&&this._thicknessTexture.animations.length>0&&e.push(this._thicknessTexture),this._refractionTexture&&this._refractionTexture.animations&&this._refractionTexture.animations.length>0&&e.push(this._refractionTexture)}dispose(e){e&&(this._thicknessTexture&&this._thicknessTexture.dispose(),this._refractionTexture&&this._refractionTexture.dispose())}getClassName(){return"PBRSubSurfaceConfiguration"}addFallbacks(e,t,i){return e.SS_SCATTERING&&t.addFallback(i++,"SS_SCATTERING"),e.SS_TRANSLUCENCY&&t.addFallback(i++,"SS_TRANSLUCENCY"),i}getSamplers(e){e.push("thicknessSampler","refractionIntensitySampler","translucencyIntensitySampler","refractionSampler","refractionSamplerLow","refractionSamplerHigh")}getUniforms(){return{ubo:[{name:"vRefractionMicrosurfaceInfos",size:4,type:"vec4"},{name:"vRefractionFilteringInfo",size:2,type:"vec2"},{name:"vTranslucencyIntensityInfos",size:2,type:"vec2"},{name:"vRefractionInfos",size:4,type:"vec4"},{name:"refractionMatrix",size:16,type:"mat4"},{name:"vThicknessInfos",size:2,type:"vec2"},{name:"vRefractionIntensityInfos",size:2,type:"vec2"},{name:"thicknessMatrix",size:16,type:"mat4"},{name:"refractionIntensityMatrix",size:16,type:"mat4"},{name:"translucencyIntensityMatrix",size:16,type:"mat4"},{name:"vThicknessParam",size:2,type:"vec2"},{name:"vDiffusionDistance",size:3,type:"vec3"},{name:"vTintColor",size:4,type:"vec4"},{name:"vSubSurfaceIntensity",size:3,type:"vec3"},{name:"vRefractionPosition",size:3,type:"vec3"},{name:"vRefractionSize",size:3,type:"vec3"},{name:"scatteringDiffusionProfile",size:1,type:"float"},{name:"dispersion",size:1,type:"float"}]}}}R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Qt.prototype,"isRefractionEnabled",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Qt.prototype,"isTranslucencyEnabled",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Qt.prototype,"isDispersionEnabled",void 0);R([I(),ie("_markScenePrePassDirty")],Qt.prototype,"isScatteringEnabled",void 0);R([I()],Qt.prototype,"_scatteringDiffusionProfileIndex",void 0);R([I()],Qt.prototype,"refractionIntensity",void 0);R([I()],Qt.prototype,"translucencyIntensity",void 0);R([I()],Qt.prototype,"useAlbedoToTintRefraction",void 0);R([I()],Qt.prototype,"useAlbedoToTintTranslucency",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Qt.prototype,"thicknessTexture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Qt.prototype,"refractionTexture",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Qt.prototype,"indexOfRefraction",void 0);R([I()],Qt.prototype,"_volumeIndexOfRefraction",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],Qt.prototype,"volumeIndexOfRefraction",null);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Qt.prototype,"invertRefractionY",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Qt.prototype,"linkRefractionWithTransparency",void 0);R([I()],Qt.prototype,"minimumThickness",void 0);R([I()],Qt.prototype,"maximumThickness",void 0);R([I()],Qt.prototype,"useThicknessAsDepth",void 0);R([br()],Qt.prototype,"tintColor",void 0);R([I()],Qt.prototype,"tintColorAtDistance",void 0);R([I()],Qt.prototype,"dispersion",void 0);R([br()],Qt.prototype,"diffusionDistance",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Qt.prototype,"useMaskFromThicknessTexture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Qt.prototype,"refractionIntensityTexture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Qt.prototype,"translucencyIntensityTexture",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Qt.prototype,"useGltfStyleTextures",void 0);const ol={effect:null,subMesh:null};class LT extends Ws{constructor(e){super(e),this.PBR=!0,this.NUM_SAMPLES="0",this.REALTIME_FILTERING=!1,this.MAINUV1=!1,this.MAINUV2=!1,this.MAINUV3=!1,this.MAINUV4=!1,this.MAINUV5=!1,this.MAINUV6=!1,this.UV1=!1,this.UV2=!1,this.UV3=!1,this.UV4=!1,this.UV5=!1,this.UV6=!1,this.ALBEDO=!1,this.GAMMAALBEDO=!1,this.ALBEDODIRECTUV=0,this.VERTEXCOLOR=!1,this.BAKED_VERTEX_ANIMATION_TEXTURE=!1,this.AMBIENT=!1,this.AMBIENTDIRECTUV=0,this.AMBIENTINGRAYSCALE=!1,this.OPACITY=!1,this.VERTEXALPHA=!1,this.OPACITYDIRECTUV=0,this.OPACITYRGB=!1,this.ALPHATEST=!1,this.DEPTHPREPASS=!1,this.ALPHABLEND=!1,this.ALPHAFROMALBEDO=!1,this.ALPHATESTVALUE="0.5",this.SPECULAROVERALPHA=!1,this.RADIANCEOVERALPHA=!1,this.ALPHAFRESNEL=!1,this.LINEARALPHAFRESNEL=!1,this.PREMULTIPLYALPHA=!1,this.EMISSIVE=!1,this.EMISSIVEDIRECTUV=0,this.GAMMAEMISSIVE=!1,this.REFLECTIVITY=!1,this.REFLECTIVITY_GAMMA=!1,this.REFLECTIVITYDIRECTUV=0,this.SPECULARTERM=!1,this.MICROSURFACEFROMREFLECTIVITYMAP=!1,this.MICROSURFACEAUTOMATIC=!1,this.LODBASEDMICROSFURACE=!1,this.MICROSURFACEMAP=!1,this.MICROSURFACEMAPDIRECTUV=0,this.METALLICWORKFLOW=!1,this.ROUGHNESSSTOREINMETALMAPALPHA=!1,this.ROUGHNESSSTOREINMETALMAPGREEN=!1,this.METALLNESSSTOREINMETALMAPBLUE=!1,this.AOSTOREINMETALMAPRED=!1,this.METALLIC_REFLECTANCE=!1,this.METALLIC_REFLECTANCE_GAMMA=!1,this.METALLIC_REFLECTANCEDIRECTUV=0,this.METALLIC_REFLECTANCE_USE_ALPHA_ONLY=!1,this.REFLECTANCE=!1,this.REFLECTANCE_GAMMA=!1,this.REFLECTANCEDIRECTUV=0,this.ENVIRONMENTBRDF=!1,this.ENVIRONMENTBRDF_RGBD=!1,this.NORMAL=!1,this.TANGENT=!1,this.BUMP=!1,this.BUMPDIRECTUV=0,this.OBJECTSPACE_NORMALMAP=!1,this.PARALLAX=!1,this.PARALLAX_RHS=!1,this.PARALLAXOCCLUSION=!1,this.NORMALXYSCALE=!0,this.LIGHTMAP=!1,this.LIGHTMAPDIRECTUV=0,this.USELIGHTMAPASSHADOWMAP=!1,this.GAMMALIGHTMAP=!1,this.RGBDLIGHTMAP=!1,this.REFLECTION=!1,this.REFLECTIONMAP_3D=!1,this.REFLECTIONMAP_SPHERICAL=!1,this.REFLECTIONMAP_PLANAR=!1,this.REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,this.REFLECTIONMAP_PROJECTION=!1,this.REFLECTIONMAP_SKYBOX=!1,this.REFLECTIONMAP_EXPLICIT=!1,this.REFLECTIONMAP_EQUIRECTANGULAR=!1,this.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,this.INVERTCUBICMAP=!1,this.USESPHERICALFROMREFLECTIONMAP=!1,this.USEIRRADIANCEMAP=!1,this.USESPHERICALINVERTEX=!1,this.REFLECTIONMAP_OPPOSITEZ=!1,this.LODINREFLECTIONALPHA=!1,this.GAMMAREFLECTION=!1,this.RGBDREFLECTION=!1,this.LINEARSPECULARREFLECTION=!1,this.RADIANCEOCCLUSION=!1,this.HORIZONOCCLUSION=!1,this.INSTANCES=!1,this.THIN_INSTANCES=!1,this.INSTANCESCOLOR=!1,this.PREPASS=!1,this.PREPASS_IRRADIANCE=!1,this.PREPASS_IRRADIANCE_INDEX=-1,this.PREPASS_ALBEDO_SQRT=!1,this.PREPASS_ALBEDO_SQRT_INDEX=-1,this.PREPASS_DEPTH=!1,this.PREPASS_DEPTH_INDEX=-1,this.PREPASS_NORMAL=!1,this.PREPASS_NORMAL_INDEX=-1,this.PREPASS_NORMAL_WORLDSPACE=!1,this.PREPASS_POSITION=!1,this.PREPASS_POSITION_INDEX=-1,this.PREPASS_VELOCITY=!1,this.PREPASS_VELOCITY_INDEX=-1,this.PREPASS_REFLECTIVITY=!1,this.PREPASS_REFLECTIVITY_INDEX=-1,this.SCENE_MRT_COUNT=0,this.NUM_BONE_INFLUENCERS=0,this.BonesPerMesh=0,this.BONETEXTURE=!1,this.BONES_VELOCITY_ENABLED=!1,this.NONUNIFORMSCALING=!1,this.MORPHTARGETS=!1,this.MORPHTARGETS_NORMAL=!1,this.MORPHTARGETS_TANGENT=!1,this.MORPHTARGETS_UV=!1,this.NUM_MORPH_INFLUENCERS=0,this.MORPHTARGETS_TEXTURE=!1,this.IMAGEPROCESSING=!1,this.VIGNETTE=!1,this.VIGNETTEBLENDMODEMULTIPLY=!1,this.VIGNETTEBLENDMODEOPAQUE=!1,this.TONEMAPPING=!1,this.TONEMAPPING_ACES=!1,this.CONTRAST=!1,this.COLORCURVES=!1,this.COLORGRADING=!1,this.COLORGRADING3D=!1,this.SAMPLER3DGREENDEPTH=!1,this.SAMPLER3DBGRMAP=!1,this.DITHER=!1,this.IMAGEPROCESSINGPOSTPROCESS=!1,this.SKIPFINALCOLORCLAMP=!1,this.EXPOSURE=!1,this.MULTIVIEW=!1,this.ORDER_INDEPENDENT_TRANSPARENCY=!1,this.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!1,this.USEPHYSICALLIGHTFALLOFF=!1,this.USEGLTFLIGHTFALLOFF=!1,this.TWOSIDEDLIGHTING=!1,this.SHADOWFLOAT=!1,this.CLIPPLANE=!1,this.CLIPPLANE2=!1,this.CLIPPLANE3=!1,this.CLIPPLANE4=!1,this.CLIPPLANE5=!1,this.CLIPPLANE6=!1,this.POINTSIZE=!1,this.FOG=!1,this.LOGARITHMICDEPTH=!1,this.CAMERA_ORTHOGRAPHIC=!1,this.CAMERA_PERSPECTIVE=!1,this.FORCENORMALFORWARD=!1,this.SPECULARAA=!1,this.UNLIT=!1,this.DECAL_AFTER_DETAIL=!1,this.DEBUGMODE=0,this.rebuild()}reset(){super.reset(),this.ALPHATESTVALUE="0.5",this.PBR=!0,this.NORMALXYSCALE=!0}}class vt extends Sm{get realTimeFiltering(){return this._realTimeFiltering}set realTimeFiltering(e){this._realTimeFiltering=e,this.markAsDirty(1)}get realTimeFilteringQuality(){return this._realTimeFilteringQuality}set realTimeFilteringQuality(e){this._realTimeFilteringQuality=e,this.markAsDirty(1)}get canRenderToMRT(){return!0}_attachImageProcessingConfiguration(e){e!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),e?this._imageProcessingConfiguration=e:this._imageProcessingConfiguration=this.getScene().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add(()=>{this._markAllSubMeshesAsImageProcessingDirty()})))}constructor(e,t){super(e,t),this._directIntensity=1,this._emissiveIntensity=1,this._environmentIntensity=1,this._specularIntensity=1,this._lightingInfos=new qe(this._directIntensity,this._emissiveIntensity,this._environmentIntensity,this._specularIntensity),this._disableBumpMap=!1,this._albedoTexture=null,this._ambientTexture=null,this._ambientTextureStrength=1,this._ambientTextureImpactOnAnalyticalLights=vt.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,this._opacityTexture=null,this._reflectionTexture=null,this._emissiveTexture=null,this._reflectivityTexture=null,this._metallicTexture=null,this._metallic=null,this._roughness=null,this._metallicF0Factor=1,this._metallicReflectanceColor=Pe.White(),this._useOnlyMetallicFromMetallicReflectanceTexture=!1,this._metallicReflectanceTexture=null,this._reflectanceTexture=null,this._microSurfaceTexture=null,this._bumpTexture=null,this._lightmapTexture=null,this._ambientColor=new Pe(0,0,0),this._albedoColor=new Pe(1,1,1),this._reflectivityColor=new Pe(1,1,1),this._reflectionColor=new Pe(1,1,1),this._emissiveColor=new Pe(0,0,0),this._microSurface=.9,this._useLightmapAsShadowmap=!1,this._useHorizonOcclusion=!0,this._useRadianceOcclusion=!0,this._useAlphaFromAlbedoTexture=!1,this._useSpecularOverAlpha=!0,this._useMicroSurfaceFromReflectivityMapAlpha=!1,this._useRoughnessFromMetallicTextureAlpha=!0,this._useRoughnessFromMetallicTextureGreen=!1,this._useMetallnessFromMetallicTextureBlue=!1,this._useAmbientOcclusionFromMetallicTextureRed=!1,this._useAmbientInGrayScale=!1,this._useAutoMicroSurfaceFromReflectivityMap=!1,this._lightFalloff=vt.LIGHTFALLOFF_PHYSICAL,this._useRadianceOverAlpha=!0,this._useObjectSpaceNormalMap=!1,this._useParallax=!1,this._useParallaxOcclusion=!1,this._parallaxScaleBias=.05,this._disableLighting=!1,this._maxSimultaneousLights=4,this._invertNormalMapX=!1,this._invertNormalMapY=!1,this._twoSidedLighting=!1,this._alphaCutOff=.4,this._forceAlphaTest=!1,this._useAlphaFresnel=!1,this._useLinearAlphaFresnel=!1,this._environmentBRDFTexture=null,this._forceIrradianceInFragment=!1,this._realTimeFiltering=!1,this._realTimeFilteringQuality=8,this._forceNormalForward=!1,this._enableSpecularAntiAliasing=!1,this._imageProcessingObserver=null,this._renderTargets=new or(16),this._globalAmbientColor=new Pe(0,0,0),this._unlit=!1,this._applyDecalMapAfterDetailMap=!1,this._debugMode=0,this.debugMode=0,this.debugLimit=-1,this.debugFactor=1,this._cacheHasRenderTargetTextures=!1,this.brdf=new ar(this),this.clearCoat=new Wi(this),this.iridescence=new wr(this),this.anisotropy=new dc(this),this.sheen=new hs(this),this.subSurface=new Qt(this),this.detailMap=new za(this),this._attachImageProcessingConfiguration(null),this.getRenderTargetTextures=()=>(this._renderTargets.reset(),te.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget&&this._renderTargets.push(this._reflectionTexture),this._eventInfo.renderTargets=this._renderTargets,this._callbackPluginEventFillRenderTargetTextures(this._eventInfo),this._renderTargets),this._environmentBRDFTexture=kS(this.getScene()),this.prePassConfiguration=new td}get hasRenderTargetTextures(){return te.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget?!0:this._cacheHasRenderTargetTextures}get isPrePassCapable(){return!this.disableDepthWrite}getClassName(){return"PBRBaseMaterial"}get _disableAlphaBlending(){var e;return this._transparencyMode===vt.PBRMATERIAL_OPAQUE||this._transparencyMode===vt.PBRMATERIAL_ALPHATEST||((e=this.subSurface)==null?void 0:e.disableAlphaBlending)}needAlphaBlending(){return this._disableAlphaBlending?!1:this.alpha<1||this._opacityTexture!=null||this._shouldUseAlphaFromAlbedoTexture()}needAlphaTesting(){var e;return this._forceAlphaTest?!0:(e=this.subSurface)!=null&&e.disableAlphaBlending?!1:this._hasAlphaChannel()&&(this._transparencyMode==null||this._transparencyMode===vt.PBRMATERIAL_ALPHATEST)}_shouldUseAlphaFromAlbedoTexture(){return this._albedoTexture!=null&&this._albedoTexture.hasAlpha&&this._useAlphaFromAlbedoTexture&&this._transparencyMode!==vt.PBRMATERIAL_OPAQUE}_hasAlphaChannel(){return this._albedoTexture!=null&&this._albedoTexture.hasAlpha||this._opacityTexture!=null}getAlphaTestTexture(){return this._albedoTexture}isReadyForSubMesh(e,t,i){var d;this._uniformBufferLayoutBuilt||this.buildUniformLayout();const r=t._drawWrapper;if(r.effect&&this.isFrozen&&r._wasPreviouslyReady&&r._wasPreviouslyUsingInstances===i)return!0;t.materialDefines||(this._callbackPluginEventGeneric(zi.GetDefineNames,this._eventInfo),t.materialDefines=new LT(this._eventInfo.defineNames));const s=t.materialDefines;if(this._isReadyForSubMesh(t))return!0;const a=this.getScene(),l=a.getEngine();if(s._areTexturesDirty&&(this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._cacheHasRenderTargetTextures=this._eventInfo.hasRenderTargetTextures,a.texturesEnabled)){if(this._albedoTexture&&te.DiffuseTextureEnabled&&!this._albedoTexture.isReadyOrNotBlocking()||this._ambientTexture&&te.AmbientTextureEnabled&&!this._ambientTexture.isReadyOrNotBlocking()||this._opacityTexture&&te.OpacityTextureEnabled&&!this._opacityTexture.isReadyOrNotBlocking())return!1;const f=this._getReflectionTexture();if(f&&te.ReflectionTextureEnabled){if(!f.isReadyOrNotBlocking())return!1;if(f.irradianceTexture){if(!f.irradianceTexture.isReadyOrNotBlocking())return!1}else if(!f.sphericalPolynomial&&((d=f.getInternalTexture())!=null&&d._sphericalPolynomialPromise))return!1}if(this._lightmapTexture&&te.LightmapTextureEnabled&&!this._lightmapTexture.isReadyOrNotBlocking()||this._emissiveTexture&&te.EmissiveTextureEnabled&&!this._emissiveTexture.isReadyOrNotBlocking())return!1;if(te.SpecularTextureEnabled){if(this._metallicTexture){if(!this._metallicTexture.isReadyOrNotBlocking())return!1}else if(this._reflectivityTexture&&!this._reflectivityTexture.isReadyOrNotBlocking())return!1;if(this._metallicReflectanceTexture&&!this._metallicReflectanceTexture.isReadyOrNotBlocking()||this._reflectanceTexture&&!this._reflectanceTexture.isReadyOrNotBlocking()||this._microSurfaceTexture&&!this._microSurfaceTexture.isReadyOrNotBlocking())return!1}if(l.getCaps().standardDerivatives&&this._bumpTexture&&te.BumpTextureEnabled&&!this._disableBumpMap&&!this._bumpTexture.isReady()||this._environmentBRDFTexture&&te.ReflectionTextureEnabled&&!this._environmentBRDFTexture.isReady())return!1}if(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=s,this._eventInfo.subMesh=t,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),!this._eventInfo.isReadyForSubMesh||s._areImageProcessingDirty&&this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.isReady())return!1;!l.getCaps().standardDerivatives&&!e.isVerticesDataPresent(x.NormalKind)&&(e.createNormals(!0),ee.Warn("PBRMaterial: Normals have been created for the mesh: "+e.name));const o=t.effect,c=s._areLightsDisposed;let u=this._prepareEffect(e,s,this.onCompiled,this.onError,i,null,t.getRenderingMesh().hasThinInstances),h=!1;if(u)if(this._onEffectCreatedObservable&&(ol.effect=u,ol.subMesh=t,this._onEffectCreatedObservable.notifyObservers(ol)),this.allowShaderHotSwapping&&o&&!u.isReady()){if(u=o,s.markAsUnprocessed(),h=this.isFrozen,c)return s._areLightsDisposed=!0,!1}else a.resetCachedMaterial(),t.setEffect(u,s,this._materialContext);return!t.effect||!t.effect.isReady()?!1:(s._renderId=a.getRenderId(),r._wasPreviouslyReady=!h,r._wasPreviouslyUsingInstances=!!i,this._checkScenePerformancePriority(),!0)}isMetallicWorkflow(){return!!(this._metallic!=null||this._roughness!=null||this._metallicTexture)}_prepareEffect(e,t,i=null,r=null,s=null,a=null,l){if(this._prepareDefines(e,t,s,a,l),!t.isDirty)return null;t.markAsProcessed();const c=this.getScene().getEngine(),u=new Rm;let h=0;t.USESPHERICALINVERTEX&&u.addFallback(h++,"USESPHERICALINVERTEX"),t.FOG&&u.addFallback(h,"FOG"),t.SPECULARAA&&u.addFallback(h,"SPECULARAA"),t.POINTSIZE&&u.addFallback(h,"POINTSIZE"),t.LOGARITHMICDEPTH&&u.addFallback(h,"LOGARITHMICDEPTH"),t.PARALLAX&&u.addFallback(h,"PARALLAX"),t.PARALLAX_RHS&&u.addFallback(h,"PARALLAX_RHS"),t.PARALLAXOCCLUSION&&u.addFallback(h++,"PARALLAXOCCLUSION"),t.ENVIRONMENTBRDF&&u.addFallback(h++,"ENVIRONMENTBRDF"),t.TANGENT&&u.addFallback(h++,"TANGENT"),t.BUMP&&u.addFallback(h++,"BUMP"),h=S1(t,u,this._maxSimultaneousLights,h++),t.SPECULARTERM&&u.addFallback(h++,"SPECULARTERM"),t.USESPHERICALFROMREFLECTIONMAP&&u.addFallback(h++,"USESPHERICALFROMREFLECTIONMAP"),t.USEIRRADIANCEMAP&&u.addFallback(h++,"USEIRRADIANCEMAP"),t.LIGHTMAP&&u.addFallback(h++,"LIGHTMAP"),t.NORMAL&&u.addFallback(h++,"NORMAL"),t.AMBIENT&&u.addFallback(h++,"AMBIENT"),t.EMISSIVE&&u.addFallback(h++,"EMISSIVE"),t.VERTEXCOLOR&&u.addFallback(h++,"VERTEXCOLOR"),t.MORPHTARGETS&&u.addFallback(h++,"MORPHTARGETS"),t.MULTIVIEW&&u.addFallback(0,"MULTIVIEW");const d=[x.PositionKind];t.NORMAL&&d.push(x.NormalKind),t.TANGENT&&d.push(x.TangentKind);for(let T=1;T<=6;++T)t["UV"+T]&&d.push(`uv${T===1?"":T}`);t.VERTEXCOLOR&&d.push(x.ColorKind),C1(d,e,t,u),A1(d,t),E1(d,e,t),bm(d,e,t);let f="pbr";const _=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vAlbedoColor","vReflectivityColor","vMetallicReflectanceFactors","vEmissiveColor","visibility","vReflectionColor","vFogInfos","vFogColor","pointSize","vAlbedoInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vReflectionPosition","vReflectionSize","vEmissiveInfos","vReflectivityInfos","vReflectionFilteringInfo","vMetallicReflectanceInfos","vReflectanceInfos","vMicroSurfaceSamplerInfos","vBumpInfos","vLightmapInfos","mBones","albedoMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","reflectivityMatrix","normalMatrix","microSurfaceSamplerMatrix","bumpMatrix","lightmapMatrix","metallicReflectanceMatrix","reflectanceMatrix","vLightingIntensity","logarithmicDepthConstant","vSphericalX","vSphericalY","vSphericalZ","vSphericalXX_ZZ","vSphericalYY_ZZ","vSphericalZZ","vSphericalXY","vSphericalYZ","vSphericalZX","vSphericalL00","vSphericalL1_1","vSphericalL10","vSphericalL11","vSphericalL2_2","vSphericalL2_1","vSphericalL20","vSphericalL21","vSphericalL22","vReflectionMicrosurfaceInfos","vTangentSpaceParams","boneTextureWidth","vDebugMode","morphTargetTextureInfo","morphTargetTextureIndices"],p=["albedoSampler","reflectivitySampler","ambientSampler","emissiveSampler","bumpSampler","lightmapSampler","opacitySampler","reflectionSampler","reflectionSamplerLow","reflectionSamplerHigh","irradianceSampler","microSurfaceSampler","environmentBrdfSampler","boneSampler","metallicReflectanceSampler","reflectanceSampler","morphTargets","oitDepthSampler","oitFrontColorSampler"],v=["Material","Scene","Mesh"],E={maxSimultaneousLights:this._maxSimultaneousLights,maxSimultaneousMorphTargets:t.NUM_MORPH_INFLUENCERS};this._eventInfo.fallbacks=u,this._eventInfo.fallbackRank=h,this._eventInfo.defines=t,this._eventInfo.uniforms=_,this._eventInfo.attributes=d,this._eventInfo.samplers=p,this._eventInfo.uniformBuffersNames=v,this._eventInfo.customCode=void 0,this._eventInfo.mesh=e,this._eventInfo.indexParameters=E,this._callbackPluginEventGeneric(zi.PrepareEffect,this._eventInfo),td.AddUniforms(_),mm(_),it&&(it.PrepareUniforms(_,t),it.PrepareSamplers(p,t)),D1({uniformsNames:_,uniformBuffersNames:v,samplers:p,defines:t,maxSimultaneousLights:this._maxSimultaneousLights});const g={};this.customShaderNameResolve&&(f=this.customShaderNameResolve(f,_,v,p,t,d,g));const m=t.toString(),y=c.createEffect(f,{attributes:d,uniformsNames:_,uniformBuffersNames:v,samplers:p,defines:m,fallbacks:u,onCompiled:i,onError:r,indexParameters:E,processFinalCode:g.processFinalCode,processCodeAfterIncludes:this._eventInfo.customCode,multiTarget:t.PREPASS},c);return this._eventInfo.customCode=void 0,y}_prepareDefines(e,t,i=null,r=null,s=!1){var c;const a=this.getScene(),l=a.getEngine();x1(a,e,t,!0,this._maxSimultaneousLights,this._disableLighting),t._needNormals=!0,P1(a,t);const o=this.needAlphaBlendingForMesh(e)&&this.getScene().useOrderIndependentTransparency;if(O1(a,t,this.canRenderToMRT&&!o),w1(a,t,o),t.METALLICWORKFLOW=this.isMetallicWorkflow(),t._areTexturesDirty){t._needUVs=!1;for(let u=1;u<=6;++u)t["MAINUV"+u]=!1;if(a.texturesEnabled){t.ALBEDODIRECTUV=0,t.AMBIENTDIRECTUV=0,t.OPACITYDIRECTUV=0,t.EMISSIVEDIRECTUV=0,t.REFLECTIVITYDIRECTUV=0,t.MICROSURFACEMAPDIRECTUV=0,t.METALLIC_REFLECTANCEDIRECTUV=0,t.REFLECTANCEDIRECTUV=0,t.BUMPDIRECTUV=0,t.LIGHTMAPDIRECTUV=0,l.getCaps().textureLOD&&(t.LODBASEDMICROSFURACE=!0),this._albedoTexture&&te.DiffuseTextureEnabled?(Bt(this._albedoTexture,t,"ALBEDO"),t.GAMMAALBEDO=this._albedoTexture.gammaSpace):t.ALBEDO=!1,this._ambientTexture&&te.AmbientTextureEnabled?(Bt(this._ambientTexture,t,"AMBIENT"),t.AMBIENTINGRAYSCALE=this._useAmbientInGrayScale):t.AMBIENT=!1,this._opacityTexture&&te.OpacityTextureEnabled?(Bt(this._opacityTexture,t,"OPACITY"),t.OPACITYRGB=this._opacityTexture.getAlphaFromRGB):t.OPACITY=!1;const u=this._getReflectionTexture();if(u&&te.ReflectionTextureEnabled){switch(t.REFLECTION=!0,t.GAMMAREFLECTION=u.gammaSpace,t.RGBDREFLECTION=u.isRGBD,t.LODINREFLECTIONALPHA=u.lodLevelInAlpha,t.LINEARSPECULARREFLECTION=u.linearSpecularLOD,this.realTimeFiltering&&this.realTimeFilteringQuality>0?(t.NUM_SAMPLES=""+this.realTimeFilteringQuality,l._features.needTypeSuffixInShaderConstants&&(t.NUM_SAMPLES=t.NUM_SAMPLES+"u"),t.REALTIME_FILTERING=!0):t.REALTIME_FILTERING=!1,t.INVERTCUBICMAP=u.coordinatesMode===re.INVCUBIC_MODE,t.REFLECTIONMAP_3D=u.isCube,t.REFLECTIONMAP_OPPOSITEZ=t.REFLECTIONMAP_3D&&this.getScene().useRightHandedSystem?!u.invertZ:u.invertZ,t.REFLECTIONMAP_CUBIC=!1,t.REFLECTIONMAP_EXPLICIT=!1,t.REFLECTIONMAP_PLANAR=!1,t.REFLECTIONMAP_PROJECTION=!1,t.REFLECTIONMAP_SKYBOX=!1,t.REFLECTIONMAP_SPHERICAL=!1,t.REFLECTIONMAP_EQUIRECTANGULAR=!1,t.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,t.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,u.coordinatesMode){case re.EXPLICIT_MODE:t.REFLECTIONMAP_EXPLICIT=!0;break;case re.PLANAR_MODE:t.REFLECTIONMAP_PLANAR=!0;break;case re.PROJECTION_MODE:t.REFLECTIONMAP_PROJECTION=!0;break;case re.SKYBOX_MODE:t.REFLECTIONMAP_SKYBOX=!0;break;case re.SPHERICAL_MODE:t.REFLECTIONMAP_SPHERICAL=!0;break;case re.EQUIRECTANGULAR_MODE:t.REFLECTIONMAP_EQUIRECTANGULAR=!0;break;case re.FIXED_EQUIRECTANGULAR_MODE:t.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!0;break;case re.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:t.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!0;break;case re.CUBIC_MODE:case re.INVCUBIC_MODE:default:t.REFLECTIONMAP_CUBIC=!0,t.USE_LOCAL_REFLECTIONMAP_CUBIC=!!u.boundingBoxSize;break}u.coordinatesMode!==re.SKYBOX_MODE&&(u.irradianceTexture?(t.USEIRRADIANCEMAP=!0,t.USESPHERICALFROMREFLECTIONMAP=!1):u.isCube&&(t.USESPHERICALFROMREFLECTIONMAP=!0,t.USEIRRADIANCEMAP=!1,this._forceIrradianceInFragment||this.realTimeFiltering||this._twoSidedLighting||l.getCaps().maxVaryingVectors<=8?t.USESPHERICALINVERTEX=!1:t.USESPHERICALINVERTEX=!0))}else t.REFLECTION=!1,t.REFLECTIONMAP_3D=!1,t.REFLECTIONMAP_SPHERICAL=!1,t.REFLECTIONMAP_PLANAR=!1,t.REFLECTIONMAP_CUBIC=!1,t.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,t.REFLECTIONMAP_PROJECTION=!1,t.REFLECTIONMAP_SKYBOX=!1,t.REFLECTIONMAP_EXPLICIT=!1,t.REFLECTIONMAP_EQUIRECTANGULAR=!1,t.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,t.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,t.INVERTCUBICMAP=!1,t.USESPHERICALFROMREFLECTIONMAP=!1,t.USEIRRADIANCEMAP=!1,t.USESPHERICALINVERTEX=!1,t.REFLECTIONMAP_OPPOSITEZ=!1,t.LODINREFLECTIONALPHA=!1,t.GAMMAREFLECTION=!1,t.RGBDREFLECTION=!1,t.LINEARSPECULARREFLECTION=!1;if(this._lightmapTexture&&te.LightmapTextureEnabled?(Bt(this._lightmapTexture,t,"LIGHTMAP"),t.USELIGHTMAPASSHADOWMAP=this._useLightmapAsShadowmap,t.GAMMALIGHTMAP=this._lightmapTexture.gammaSpace,t.RGBDLIGHTMAP=this._lightmapTexture.isRGBD):t.LIGHTMAP=!1,this._emissiveTexture&&te.EmissiveTextureEnabled?(Bt(this._emissiveTexture,t,"EMISSIVE"),t.GAMMAEMISSIVE=this._emissiveTexture.gammaSpace):t.EMISSIVE=!1,te.SpecularTextureEnabled){if(this._metallicTexture?(Bt(this._metallicTexture,t,"REFLECTIVITY"),t.ROUGHNESSSTOREINMETALMAPALPHA=this._useRoughnessFromMetallicTextureAlpha,t.ROUGHNESSSTOREINMETALMAPGREEN=!this._useRoughnessFromMetallicTextureAlpha&&this._useRoughnessFromMetallicTextureGreen,t.METALLNESSSTOREINMETALMAPBLUE=this._useMetallnessFromMetallicTextureBlue,t.AOSTOREINMETALMAPRED=this._useAmbientOcclusionFromMetallicTextureRed,t.REFLECTIVITY_GAMMA=!1):this._reflectivityTexture?(Bt(this._reflectivityTexture,t,"REFLECTIVITY"),t.MICROSURFACEFROMREFLECTIVITYMAP=this._useMicroSurfaceFromReflectivityMapAlpha,t.MICROSURFACEAUTOMATIC=this._useAutoMicroSurfaceFromReflectivityMap,t.REFLECTIVITY_GAMMA=this._reflectivityTexture.gammaSpace):t.REFLECTIVITY=!1,this._metallicReflectanceTexture||this._reflectanceTexture){const h=this._metallicReflectanceTexture!==null&&this._metallicReflectanceTexture._texture===((c=this._reflectanceTexture)==null?void 0:c._texture)&&this._metallicReflectanceTexture.checkTransformsAreIdentical(this._reflectanceTexture);t.METALLIC_REFLECTANCE_USE_ALPHA_ONLY=this._useOnlyMetallicFromMetallicReflectanceTexture&&!h,this._metallicReflectanceTexture?(Bt(this._metallicReflectanceTexture,t,"METALLIC_REFLECTANCE"),t.METALLIC_REFLECTANCE_GAMMA=this._metallicReflectanceTexture.gammaSpace):t.METALLIC_REFLECTANCE=!1,this._reflectanceTexture&&!h&&(!this._metallicReflectanceTexture||this._metallicReflectanceTexture&&this._useOnlyMetallicFromMetallicReflectanceTexture)?(Bt(this._reflectanceTexture,t,"REFLECTANCE"),t.REFLECTANCE_GAMMA=this._reflectanceTexture.gammaSpace):t.REFLECTANCE=!1}else t.METALLIC_REFLECTANCE=!1,t.REFLECTANCE=!1;this._microSurfaceTexture?Bt(this._microSurfaceTexture,t,"MICROSURFACEMAP"):t.MICROSURFACEMAP=!1}else t.REFLECTIVITY=!1,t.MICROSURFACEMAP=!1;l.getCaps().standardDerivatives&&this._bumpTexture&&te.BumpTextureEnabled&&!this._disableBumpMap?(Bt(this._bumpTexture,t,"BUMP"),this._useParallax&&this._albedoTexture&&te.DiffuseTextureEnabled?(t.PARALLAX=!0,t.PARALLAX_RHS=a.useRightHandedSystem,t.PARALLAXOCCLUSION=!!this._useParallaxOcclusion):t.PARALLAX=!1,t.OBJECTSPACE_NORMALMAP=this._useObjectSpaceNormalMap):(t.BUMP=!1,t.PARALLAX=!1,t.PARALLAX_RHS=!1,t.PARALLAXOCCLUSION=!1,t.OBJECTSPACE_NORMALMAP=!1),this._environmentBRDFTexture&&te.ReflectionTextureEnabled?(t.ENVIRONMENTBRDF=!0,t.ENVIRONMENTBRDF_RGBD=this._environmentBRDFTexture.isRGBD):(t.ENVIRONMENTBRDF=!1,t.ENVIRONMENTBRDF_RGBD=!1),this._shouldUseAlphaFromAlbedoTexture()?t.ALPHAFROMALBEDO=!0:t.ALPHAFROMALBEDO=!1}t.SPECULAROVERALPHA=this._useSpecularOverAlpha,this._lightFalloff===vt.LIGHTFALLOFF_STANDARD?(t.USEPHYSICALLIGHTFALLOFF=!1,t.USEGLTFLIGHTFALLOFF=!1):this._lightFalloff===vt.LIGHTFALLOFF_GLTF?(t.USEPHYSICALLIGHTFALLOFF=!1,t.USEGLTFLIGHTFALLOFF=!0):(t.USEPHYSICALLIGHTFALLOFF=!0,t.USEGLTFLIGHTFALLOFF=!1),t.RADIANCEOVERALPHA=this._useRadianceOverAlpha,!this.backFaceCulling&&this._twoSidedLighting?t.TWOSIDEDLIGHTING=!0:t.TWOSIDEDLIGHTING=!1,t.SPECULARAA=l.getCaps().standardDerivatives&&this._enableSpecularAntiAliasing}(t._areTexturesDirty||t._areMiscDirty)&&(t.ALPHATESTVALUE=`${this._alphaCutOff}${this._alphaCutOff%1===0?".":""}`,t.PREMULTIPLYALPHA=this.alphaMode===7||this.alphaMode===8,t.ALPHABLEND=this.needAlphaBlendingForMesh(e),t.ALPHAFRESNEL=this._useAlphaFresnel||this._useLinearAlphaFresnel,t.LINEARALPHAFRESNEL=this._useLinearAlphaFresnel),t._areImageProcessingDirty&&this._imageProcessingConfiguration&&this._imageProcessingConfiguration.prepareDefines(t),t.FORCENORMALFORWARD=this._forceNormalForward,t.RADIANCEOCCLUSION=this._useRadianceOcclusion,t.HORIZONOCCLUSION=this._useHorizonOcclusion,t._areMiscDirty&&(R1(e,a,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e)||this._forceAlphaTest,t,this._applyDecalMapAfterDetailMap),t.UNLIT=this._unlit||(this.pointsCloud||this.wireframe)&&!e.isVerticesDataPresent(x.NormalKind),t.DEBUGMODE=this._debugMode),M1(a,l,this,t,!!i,r,s),this._eventInfo.defines=t,this._eventInfo.mesh=e,this._callbackPluginEventPrepareDefinesBeforeAttributes(this._eventInfo),I1(e,t,!0,!0,!0,this._transparencyMode!==vt.PBRMATERIAL_OPAQUE),this._callbackPluginEventPrepareDefines(this._eventInfo)}forceCompilation(e,t,i){const r={clipPlane:!1,useInstances:!1,...i};this._uniformBufferLayoutBuilt||this.buildUniformLayout(),this._callbackPluginEventGeneric(zi.GetDefineNames,this._eventInfo);const s=new LT(this._eventInfo.defineNames),a=this._prepareEffect(e,s,void 0,void 0,r.useInstances,r.clipPlane,e.hasThinInstances);this._onEffectCreatedObservable&&(ol.effect=a,ol.subMesh=null,this._onEffectCreatedObservable.notifyObservers(ol)),a.isReady()?t&&t(this):a.onCompileObservable.add(()=>{t&&t(this)})}buildUniformLayout(){const e=this._uniformBuffer;e.addUniform("vAlbedoInfos",2),e.addUniform("vAmbientInfos",4),e.addUniform("vOpacityInfos",2),e.addUniform("vEmissiveInfos",2),e.addUniform("vLightmapInfos",2),e.addUniform("vReflectivityInfos",3),e.addUniform("vMicroSurfaceSamplerInfos",2),e.addUniform("vReflectionInfos",2),e.addUniform("vReflectionFilteringInfo",2),e.addUniform("vReflectionPosition",3),e.addUniform("vReflectionSize",3),e.addUniform("vBumpInfos",3),e.addUniform("albedoMatrix",16),e.addUniform("ambientMatrix",16),e.addUniform("opacityMatrix",16),e.addUniform("emissiveMatrix",16),e.addUniform("lightmapMatrix",16),e.addUniform("reflectivityMatrix",16),e.addUniform("microSurfaceSamplerMatrix",16),e.addUniform("bumpMatrix",16),e.addUniform("vTangentSpaceParams",2),e.addUniform("reflectionMatrix",16),e.addUniform("vReflectionColor",3),e.addUniform("vAlbedoColor",4),e.addUniform("vLightingIntensity",4),e.addUniform("vReflectionMicrosurfaceInfos",3),e.addUniform("pointSize",1),e.addUniform("vReflectivityColor",4),e.addUniform("vEmissiveColor",3),e.addUniform("vAmbientColor",3),e.addUniform("vDebugMode",2),e.addUniform("vMetallicReflectanceFactors",4),e.addUniform("vMetallicReflectanceInfos",2),e.addUniform("metallicReflectanceMatrix",16),e.addUniform("vReflectanceInfos",2),e.addUniform("reflectanceMatrix",16),e.addUniform("vSphericalL00",3),e.addUniform("vSphericalL1_1",3),e.addUniform("vSphericalL10",3),e.addUniform("vSphericalL11",3),e.addUniform("vSphericalL2_2",3),e.addUniform("vSphericalL2_1",3),e.addUniform("vSphericalL20",3),e.addUniform("vSphericalL21",3),e.addUniform("vSphericalL22",3),e.addUniform("vSphericalX",3),e.addUniform("vSphericalY",3),e.addUniform("vSphericalZ",3),e.addUniform("vSphericalXX_ZZ",3),e.addUniform("vSphericalYY_ZZ",3),e.addUniform("vSphericalZZ",3),e.addUniform("vSphericalXY",3),e.addUniform("vSphericalYZ",3),e.addUniform("vSphericalZX",3),super.buildUniformLayout()}bindForSubMesh(e,t,i){var h,d,f;const r=this.getScene(),s=i.materialDefines;if(!s)return;const a=i.effect;if(!a)return;this._activeEffect=a,t.getMeshUniformBuffer().bindToEffect(a,"Mesh"),t.transferToEffect(e);const l=r.getEngine();this._uniformBuffer.bindToEffect(a,"Material"),this.prePassConfiguration.bindForSubMesh(this._activeEffect,r,t,e,this.isFrozen),this._eventInfo.subMesh=i,this._callbackPluginEventHardBindForSubMesh(this._eventInfo),s.OBJECTSPACE_NORMALMAP&&(e.toNormalMatrix(this._normalMatrix),this.bindOnlyNormalMatrix(this._normalMatrix));const o=this._mustRebind(r,a,i,t.visibility);Cm(t,this._activeEffect,this.prePassConfiguration);let c=null;const u=this._uniformBuffer;if(o){if(this.bindViewProjection(a),c=this._getReflectionTexture(),!u.useUbo||!this.isFrozen||!u.isSync||i._drawWrapper._forceRebindOnNextCall){if(r.texturesEnabled){if(this._albedoTexture&&te.DiffuseTextureEnabled&&(u.updateFloat2("vAlbedoInfos",this._albedoTexture.coordinatesIndex,this._albedoTexture.level),Dt(this._albedoTexture,u,"albedo")),this._ambientTexture&&te.AmbientTextureEnabled&&(u.updateFloat4("vAmbientInfos",this._ambientTexture.coordinatesIndex,this._ambientTexture.level,this._ambientTextureStrength,this._ambientTextureImpactOnAnalyticalLights),Dt(this._ambientTexture,u,"ambient")),this._opacityTexture&&te.OpacityTextureEnabled&&(u.updateFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,this._opacityTexture.level),Dt(this._opacityTexture,u,"opacity")),c&&te.ReflectionTextureEnabled){if(u.updateMatrix("reflectionMatrix",c.getReflectionTextureMatrix()),u.updateFloat2("vReflectionInfos",c.level,0),c.boundingBoxSize){const _=c;u.updateVector3("vReflectionPosition",_.boundingBoxPosition),u.updateVector3("vReflectionSize",_.boundingBoxSize)}if(this.realTimeFiltering){const _=c.getSize().width;u.updateFloat2("vReflectionFilteringInfo",_,dt.Log2(_))}if(!s.USEIRRADIANCEMAP){const _=c.sphericalPolynomial;if(s.USESPHERICALFROMREFLECTIONMAP&&_)if(s.SPHERICAL_HARMONICS){const p=_.preScaledHarmonics;u.updateVector3("vSphericalL00",p.l00),u.updateVector3("vSphericalL1_1",p.l1_1),u.updateVector3("vSphericalL10",p.l10),u.updateVector3("vSphericalL11",p.l11),u.updateVector3("vSphericalL2_2",p.l2_2),u.updateVector3("vSphericalL2_1",p.l2_1),u.updateVector3("vSphericalL20",p.l20),u.updateVector3("vSphericalL21",p.l21),u.updateVector3("vSphericalL22",p.l22)}else u.updateFloat3("vSphericalX",_.x.x,_.x.y,_.x.z),u.updateFloat3("vSphericalY",_.y.x,_.y.y,_.y.z),u.updateFloat3("vSphericalZ",_.z.x,_.z.y,_.z.z),u.updateFloat3("vSphericalXX_ZZ",_.xx.x-_.zz.x,_.xx.y-_.zz.y,_.xx.z-_.zz.z),u.updateFloat3("vSphericalYY_ZZ",_.yy.x-_.zz.x,_.yy.y-_.zz.y,_.yy.z-_.zz.z),u.updateFloat3("vSphericalZZ",_.zz.x,_.zz.y,_.zz.z),u.updateFloat3("vSphericalXY",_.xy.x,_.xy.y,_.xy.z),u.updateFloat3("vSphericalYZ",_.yz.x,_.yz.y,_.yz.z),u.updateFloat3("vSphericalZX",_.zx.x,_.zx.y,_.zx.z)}u.updateFloat3("vReflectionMicrosurfaceInfos",c.getSize().width,c.lodGenerationScale,c.lodGenerationOffset)}this._emissiveTexture&&te.EmissiveTextureEnabled&&(u.updateFloat2("vEmissiveInfos",this._emissiveTexture.coordinatesIndex,this._emissiveTexture.level),Dt(this._emissiveTexture,u,"emissive")),this._lightmapTexture&&te.LightmapTextureEnabled&&(u.updateFloat2("vLightmapInfos",this._lightmapTexture.coordinatesIndex,this._lightmapTexture.level),Dt(this._lightmapTexture,u,"lightmap")),te.SpecularTextureEnabled&&(this._metallicTexture?(u.updateFloat3("vReflectivityInfos",this._metallicTexture.coordinatesIndex,this._metallicTexture.level,this._ambientTextureStrength),Dt(this._metallicTexture,u,"reflectivity")):this._reflectivityTexture&&(u.updateFloat3("vReflectivityInfos",this._reflectivityTexture.coordinatesIndex,this._reflectivityTexture.level,1),Dt(this._reflectivityTexture,u,"reflectivity")),this._metallicReflectanceTexture&&(u.updateFloat2("vMetallicReflectanceInfos",this._metallicReflectanceTexture.coordinatesIndex,this._metallicReflectanceTexture.level),Dt(this._metallicReflectanceTexture,u,"metallicReflectance")),this._reflectanceTexture&&s.REFLECTANCE&&(u.updateFloat2("vReflectanceInfos",this._reflectanceTexture.coordinatesIndex,this._reflectanceTexture.level),Dt(this._reflectanceTexture,u,"reflectance")),this._microSurfaceTexture&&(u.updateFloat2("vMicroSurfaceSamplerInfos",this._microSurfaceTexture.coordinatesIndex,this._microSurfaceTexture.level),Dt(this._microSurfaceTexture,u,"microSurfaceSampler"))),this._bumpTexture&&l.getCaps().standardDerivatives&&te.BumpTextureEnabled&&!this._disableBumpMap&&(u.updateFloat3("vBumpInfos",this._bumpTexture.coordinatesIndex,this._bumpTexture.level,this._parallaxScaleBias),Dt(this._bumpTexture,u,"bump"),r._mirroredCameraPosition?u.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?1:-1,this._invertNormalMapY?1:-1):u.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?-1:1,this._invertNormalMapY?-1:1))}if(this.pointsCloud&&u.updateFloat("pointSize",this.pointSize),s.METALLICWORKFLOW){Dn.Color3[0].r=this._metallic===void 0||this._metallic===null?1:this._metallic,Dn.Color3[0].g=this._roughness===void 0||this._roughness===null?1:this._roughness,u.updateColor4("vReflectivityColor",Dn.Color3[0],1);const _=((h=this.subSurface)==null?void 0:h._indexOfRefraction)??1.5,p=1,v=Math.pow((_-p)/(_+p),2);this._metallicReflectanceColor.scaleToRef(v*this._metallicF0Factor,Dn.Color3[0]);const E=this._metallicF0Factor;u.updateColor4("vMetallicReflectanceFactors",Dn.Color3[0],E)}else u.updateColor4("vReflectivityColor",this._reflectivityColor,this._microSurface);u.updateColor3("vEmissiveColor",te.EmissiveTextureEnabled?this._emissiveColor:Pe.BlackReadOnly),u.updateColor3("vReflectionColor",this._reflectionColor),!s.SS_REFRACTION&&((d=this.subSurface)!=null&&d._linkRefractionWithTransparency)?u.updateColor4("vAlbedoColor",this._albedoColor,1):u.updateColor4("vAlbedoColor",this._albedoColor,this.alpha),this._lightingInfos.x=this._directIntensity,this._lightingInfos.y=this._emissiveIntensity,this._lightingInfos.z=this._environmentIntensity*r.environmentIntensity,this._lightingInfos.w=this._specularIntensity,u.updateVector4("vLightingIntensity",this._lightingInfos),r.ambientColor.multiplyToRef(this._ambientColor,this._globalAmbientColor),u.updateColor3("vAmbientColor",this._globalAmbientColor),u.updateFloat2("vDebugMode",this.debugLimit,this.debugFactor)}r.texturesEnabled&&(this._albedoTexture&&te.DiffuseTextureEnabled&&u.setTexture("albedoSampler",this._albedoTexture),this._ambientTexture&&te.AmbientTextureEnabled&&u.setTexture("ambientSampler",this._ambientTexture),this._opacityTexture&&te.OpacityTextureEnabled&&u.setTexture("opacitySampler",this._opacityTexture),c&&te.ReflectionTextureEnabled&&(s.LODBASEDMICROSFURACE?u.setTexture("reflectionSampler",c):(u.setTexture("reflectionSampler",c._lodTextureMid||c),u.setTexture("reflectionSamplerLow",c._lodTextureLow||c),u.setTexture("reflectionSamplerHigh",c._lodTextureHigh||c)),s.USEIRRADIANCEMAP&&u.setTexture("irradianceSampler",c.irradianceTexture)),s.ENVIRONMENTBRDF&&u.setTexture("environmentBrdfSampler",this._environmentBRDFTexture),this._emissiveTexture&&te.EmissiveTextureEnabled&&u.setTexture("emissiveSampler",this._emissiveTexture),this._lightmapTexture&&te.LightmapTextureEnabled&&u.setTexture("lightmapSampler",this._lightmapTexture),te.SpecularTextureEnabled&&(this._metallicTexture?u.setTexture("reflectivitySampler",this._metallicTexture):this._reflectivityTexture&&u.setTexture("reflectivitySampler",this._reflectivityTexture),this._metallicReflectanceTexture&&u.setTexture("metallicReflectanceSampler",this._metallicReflectanceTexture),this._reflectanceTexture&&s.REFLECTANCE&&u.setTexture("reflectanceSampler",this._reflectanceTexture),this._microSurfaceTexture&&u.setTexture("microSurfaceSampler",this._microSurfaceTexture)),this._bumpTexture&&l.getCaps().standardDerivatives&&te.BumpTextureEnabled&&!this._disableBumpMap&&u.setTexture("bumpSampler",this._bumpTexture)),this.getScene().useOrderIndependentTransparency&&this.needAlphaBlendingForMesh(t)&&this.getScene().depthPeelingRenderer.bind(a),this._eventInfo.subMesh=i,this._callbackPluginEventBindForSubMesh(this._eventInfo),vm(this._activeEffect,this,r),this.bindEyePosition(a)}else r.getEngine()._features.needToAlwaysBindUniformBuffers&&(this._needToBindSceneUbo=!0);(o||!this.isFrozen)&&(r.lightsEnabled&&!this._disableLighting&&b1(r,t,this._activeEffect,s,this._maxSimultaneousLights),(r.fogEnabled&&t.applyFog&&r.fogMode!==Pt.FOGMODE_NONE||c||this.subSurface.refractionTexture||t.receiveShadows||s.PREPASS)&&this.bindView(a),ym(r,t,this._activeEffect,!0),s.NUM_MORPH_INFLUENCERS&&Tm(t,this._activeEffect),s.BAKED_VERTEX_ANIMATION_TEXTURE&&((f=t.bakedVertexAnimationManager)==null||f.bind(a,s.INSTANCES)),this._imageProcessingConfiguration.bind(this._activeEffect),Em(s,this._activeEffect,r)),this._afterBind(t,this._activeEffect,i),u.update()}getAnimatables(){const e=super.getAnimatables();return this._albedoTexture&&this._albedoTexture.animations&&this._albedoTexture.animations.length>0&&e.push(this._albedoTexture),this._ambientTexture&&this._ambientTexture.animations&&this._ambientTexture.animations.length>0&&e.push(this._ambientTexture),this._opacityTexture&&this._opacityTexture.animations&&this._opacityTexture.animations.length>0&&e.push(this._opacityTexture),this._reflectionTexture&&this._reflectionTexture.animations&&this._reflectionTexture.animations.length>0&&e.push(this._reflectionTexture),this._emissiveTexture&&this._emissiveTexture.animations&&this._emissiveTexture.animations.length>0&&e.push(this._emissiveTexture),this._metallicTexture&&this._metallicTexture.animations&&this._metallicTexture.animations.length>0?e.push(this._metallicTexture):this._reflectivityTexture&&this._reflectivityTexture.animations&&this._reflectivityTexture.animations.length>0&&e.push(this._reflectivityTexture),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&e.push(this._bumpTexture),this._lightmapTexture&&this._lightmapTexture.animations&&this._lightmapTexture.animations.length>0&&e.push(this._lightmapTexture),this._metallicReflectanceTexture&&this._metallicReflectanceTexture.animations&&this._metallicReflectanceTexture.animations.length>0&&e.push(this._metallicReflectanceTexture),this._reflectanceTexture&&this._reflectanceTexture.animations&&this._reflectanceTexture.animations.length>0&&e.push(this._reflectanceTexture),this._microSurfaceTexture&&this._microSurfaceTexture.animations&&this._microSurfaceTexture.animations.length>0&&e.push(this._microSurfaceTexture),e}_getReflectionTexture(){return this._reflectionTexture?this._reflectionTexture:this.getScene().environmentTexture}getActiveTextures(){const e=super.getActiveTextures();return this._albedoTexture&&e.push(this._albedoTexture),this._ambientTexture&&e.push(this._ambientTexture),this._opacityTexture&&e.push(this._opacityTexture),this._reflectionTexture&&e.push(this._reflectionTexture),this._emissiveTexture&&e.push(this._emissiveTexture),this._reflectivityTexture&&e.push(this._reflectivityTexture),this._metallicTexture&&e.push(this._metallicTexture),this._metallicReflectanceTexture&&e.push(this._metallicReflectanceTexture),this._reflectanceTexture&&e.push(this._reflectanceTexture),this._microSurfaceTexture&&e.push(this._microSurfaceTexture),this._bumpTexture&&e.push(this._bumpTexture),this._lightmapTexture&&e.push(this._lightmapTexture),e}hasTexture(e){return!!(super.hasTexture(e)||this._albedoTexture===e||this._ambientTexture===e||this._opacityTexture===e||this._reflectionTexture===e||this._emissiveTexture===e||this._reflectivityTexture===e||this._metallicTexture===e||this._metallicReflectanceTexture===e||this._reflectanceTexture===e||this._microSurfaceTexture===e||this._bumpTexture===e||this._lightmapTexture===e)}setPrePassRenderer(){var t;if(!((t=this.subSurface)!=null&&t.isScatteringEnabled))return!1;const e=this.getScene().enableSubSurfaceForPrePass();return e&&(e.enabled=!0),!0}dispose(e,t){var i,r,s,a,l,o,c,u,h,d,f,_;t&&(this._environmentBRDFTexture&&this.getScene().environmentBRDFTexture!==this._environmentBRDFTexture&&this._environmentBRDFTexture.dispose(),(i=this._albedoTexture)==null||i.dispose(),(r=this._ambientTexture)==null||r.dispose(),(s=this._opacityTexture)==null||s.dispose(),(a=this._reflectionTexture)==null||a.dispose(),(l=this._emissiveTexture)==null||l.dispose(),(o=this._metallicTexture)==null||o.dispose(),(c=this._reflectivityTexture)==null||c.dispose(),(u=this._bumpTexture)==null||u.dispose(),(h=this._lightmapTexture)==null||h.dispose(),(d=this._metallicReflectanceTexture)==null||d.dispose(),(f=this._reflectanceTexture)==null||f.dispose(),(_=this._microSurfaceTexture)==null||_.dispose()),this._renderTargets.dispose(),this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),super.dispose(e,t)}}vt.PBRMATERIAL_OPAQUE=j.MATERIAL_OPAQUE;vt.PBRMATERIAL_ALPHATEST=j.MATERIAL_ALPHATEST;vt.PBRMATERIAL_ALPHABLEND=j.MATERIAL_ALPHABLEND;vt.PBRMATERIAL_ALPHATESTANDBLEND=j.MATERIAL_ALPHATESTANDBLEND;vt.DEFAULT_AO_ON_ANALYTICAL_LIGHTS=0;vt.LIGHTFALLOFF_PHYSICAL=0;vt.LIGHTFALLOFF_GLTF=1;vt.LIGHTFALLOFF_STANDARD=2;R([MN()],vt.prototype,"_imageProcessingConfiguration",void 0);R([ie("_markAllSubMeshesAsMiscDirty")],vt.prototype,"debugMode",void 0);const Xg="KHR_materials_clearcoat";class yX{constructor(e){this.name=Xg,this.enabled=!0,this.required=!1,this._wasUsed=!1,this._exporter=e}dispose(){}get wasUsed(){return this._wasUsed}postExportMaterialAdditionalTextures(e,t,i){const r=[];return i instanceof vt&&i.clearCoat.isEnabled?(i.clearCoat.texture&&r.push(i.clearCoat.texture),!i.clearCoat.useRoughnessFromMainTexture&&i.clearCoat.textureRoughness&&r.push(i.clearCoat.textureRoughness),i.clearCoat.bumpTexture&&r.push(i.clearCoat.bumpTexture),r):[]}postExportMaterialAsync(e,t,i){return new Promise(r=>{if(i instanceof vt){if(!i.clearCoat.isEnabled){r(t);return}this._wasUsed=!0,t.extensions=t.extensions||{};const s=this._exporter._glTFMaterialExporter._getTextureInfo(i.clearCoat.texture);let a;i.clearCoat.useRoughnessFromMainTexture?a=this._exporter._glTFMaterialExporter._getTextureInfo(i.clearCoat.texture):a=this._exporter._glTFMaterialExporter._getTextureInfo(i.clearCoat.textureRoughness),i.clearCoat.isTintEnabled&&X.Warn(`Clear Color tint is not supported for glTF export. Ignoring for: ${i.name}`),i.clearCoat.remapF0OnInterfaceChange&&X.Warn(`Clear Color F0 remapping is not supported for glTF export. Ignoring for: ${i.name}`);const l=this._exporter._glTFMaterialExporter._getTextureInfo(i.clearCoat.bumpTexture),o={clearcoatFactor:i.clearCoat.intensity,clearcoatTexture:s??void 0,clearcoatRoughnessFactor:i.clearCoat.roughness,clearcoatRoughnessTexture:a??void 0,clearcoatNormalTexture:l??void 0,hasTextures:()=>o.clearcoatTexture!==null||o.clearcoatRoughnessTexture!==null||o.clearcoatRoughnessTexture!==null};t.extensions[Xg]=o}r(t)})}}Ft.RegisterExtension(Xg,n=>new yX(n));const Yg="KHR_materials_iridescence";class TX{constructor(e){this.name=Yg,this.enabled=!0,this.required=!1,this._wasUsed=!1,this._exporter=e}dispose(){}get wasUsed(){return this._wasUsed}postExportMaterialAdditionalTextures(e,t,i){const r=[];return i instanceof vt&&i.iridescence.isEnabled?(i.iridescence.texture&&r.push(i.iridescence.texture),i.iridescence.thicknessTexture&&i.iridescence.thicknessTexture!==i.iridescence.texture&&r.push(i.iridescence.thicknessTexture),r):[]}postExportMaterialAsync(e,t,i){return new Promise(r=>{if(i instanceof vt){if(!i.iridescence.isEnabled){r(t);return}this._wasUsed=!0,t.extensions=t.extensions||{};const s=this._exporter._glTFMaterialExporter._getTextureInfo(i.iridescence.texture),a=this._exporter._glTFMaterialExporter._getTextureInfo(i.iridescence.thicknessTexture),l={iridescenceFactor:i.iridescence.intensity,iridescenceIor:i.iridescence.indexOfRefraction,iridescenceThicknessMinimum:i.iridescence.minimumThickness,iridescenceThicknessMaximum:i.iridescence.maximumThickness,iridescenceTexture:s??void 0,iridescenceThicknessTexture:a??void 0,hasTextures:()=>l.iridescenceTexture!==null||l.iridescenceThicknessTexture!==null};t.extensions[Yg]=l}r(t)})}}Ft.RegisterExtension(Yg,n=>new TX(n));const Kg="KHR_materials_anisotropy";class bX{constructor(e){this.name=Kg,this.enabled=!0,this.required=!1,this._wasUsed=!1,this._exporter=e}dispose(){}get wasUsed(){return this._wasUsed}postExportMaterialAdditionalTextures(e,t,i){const r=[];return i instanceof vt&&i.anisotropy.isEnabled&&!i.anisotropy.legacy?(i.anisotropy.texture&&r.push(i.anisotropy.texture),r):[]}postExportMaterialAsync(e,t,i){return new Promise(r=>{if(i instanceof vt){if(!i.anisotropy.isEnabled||i.anisotropy.legacy){r(t);return}this._wasUsed=!0,t.extensions=t.extensions||{};const s=this._exporter._glTFMaterialExporter._getTextureInfo(i.anisotropy.texture),a={anisotropyStrength:i.anisotropy.intensity,anisotropyRotation:i.anisotropy.angle,anisotropyTexture:s??void 0,hasTextures:()=>a.anisotropyTexture!==null};t.extensions[Kg]=a}r(t)})}}Ft.RegisterExtension(Kg,n=>new bX(n));class Me extends vt{get refractionTexture(){return this.subSurface.refractionTexture}set refractionTexture(e){this.subSurface.refractionTexture=e,e?this.subSurface.isRefractionEnabled=!0:this.subSurface.linkRefractionWithTransparency||(this.subSurface.isRefractionEnabled=!1)}get indexOfRefraction(){return this.subSurface.indexOfRefraction}set indexOfRefraction(e){this.subSurface.indexOfRefraction=e}get invertRefractionY(){return this.subSurface.invertRefractionY}set invertRefractionY(e){this.subSurface.invertRefractionY=e}get linkRefractionWithTransparency(){return this.subSurface.linkRefractionWithTransparency}set linkRefractionWithTransparency(e){this.subSurface.linkRefractionWithTransparency=e,e&&(this.subSurface.isRefractionEnabled=!0)}get usePhysicalLightFalloff(){return this._lightFalloff===vt.LIGHTFALLOFF_PHYSICAL}set usePhysicalLightFalloff(e){e!==this.usePhysicalLightFalloff&&(this._markAllSubMeshesAsTexturesDirty(),e?this._lightFalloff=vt.LIGHTFALLOFF_PHYSICAL:this._lightFalloff=vt.LIGHTFALLOFF_STANDARD)}get useGLTFLightFalloff(){return this._lightFalloff===vt.LIGHTFALLOFF_GLTF}set useGLTFLightFalloff(e){e!==this.useGLTFLightFalloff&&(this._markAllSubMeshesAsTexturesDirty(),e?this._lightFalloff=vt.LIGHTFALLOFF_GLTF:this._lightFalloff=vt.LIGHTFALLOFF_STANDARD)}get imageProcessingConfiguration(){return this._imageProcessingConfiguration}set imageProcessingConfiguration(e){this._attachImageProcessingConfiguration(e),this._markAllSubMeshesAsTexturesDirty()}get cameraColorCurvesEnabled(){return this.imageProcessingConfiguration.colorCurvesEnabled}set cameraColorCurvesEnabled(e){this.imageProcessingConfiguration.colorCurvesEnabled=e}get cameraColorGradingEnabled(){return this.imageProcessingConfiguration.colorGradingEnabled}set cameraColorGradingEnabled(e){this.imageProcessingConfiguration.colorGradingEnabled=e}get cameraToneMappingEnabled(){return this._imageProcessingConfiguration.toneMappingEnabled}set cameraToneMappingEnabled(e){this._imageProcessingConfiguration.toneMappingEnabled=e}get cameraExposure(){return this._imageProcessingConfiguration.exposure}set cameraExposure(e){this._imageProcessingConfiguration.exposure=e}get cameraContrast(){return this._imageProcessingConfiguration.contrast}set cameraContrast(e){this._imageProcessingConfiguration.contrast=e}get cameraColorGradingTexture(){return this._imageProcessingConfiguration.colorGradingTexture}set cameraColorGradingTexture(e){this._imageProcessingConfiguration.colorGradingTexture=e}get cameraColorCurves(){return this._imageProcessingConfiguration.colorCurves}set cameraColorCurves(e){this._imageProcessingConfiguration.colorCurves=e}constructor(e,t){super(e,t),this.directIntensity=1,this.emissiveIntensity=1,this.environmentIntensity=1,this.specularIntensity=1,this.disableBumpMap=!1,this.ambientTextureStrength=1,this.ambientTextureImpactOnAnalyticalLights=Me.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,this.metallicF0Factor=1,this.metallicReflectanceColor=Pe.White(),this.useOnlyMetallicFromMetallicReflectanceTexture=!1,this.ambientColor=new Pe(0,0,0),this.albedoColor=new Pe(1,1,1),this.reflectivityColor=new Pe(1,1,1),this.reflectionColor=new Pe(1,1,1),this.emissiveColor=new Pe(0,0,0),this.microSurface=1,this.useLightmapAsShadowmap=!1,this.useAlphaFromAlbedoTexture=!1,this.forceAlphaTest=!1,this.alphaCutOff=.4,this.useSpecularOverAlpha=!0,this.useMicroSurfaceFromReflectivityMapAlpha=!1,this.useRoughnessFromMetallicTextureAlpha=!0,this.useRoughnessFromMetallicTextureGreen=!1,this.useMetallnessFromMetallicTextureBlue=!1,this.useAmbientOcclusionFromMetallicTextureRed=!1,this.useAmbientInGrayScale=!1,this.useAutoMicroSurfaceFromReflectivityMap=!1,this.useRadianceOverAlpha=!0,this.useObjectSpaceNormalMap=!1,this.useParallax=!1,this.useParallaxOcclusion=!1,this.parallaxScaleBias=.05,this.disableLighting=!1,this.forceIrradianceInFragment=!1,this.maxSimultaneousLights=4,this.invertNormalMapX=!1,this.invertNormalMapY=!1,this.twoSidedLighting=!1,this.useAlphaFresnel=!1,this.useLinearAlphaFresnel=!1,this.environmentBRDFTexture=null,this.forceNormalForward=!1,this.enableSpecularAntiAliasing=!1,this.useHorizonOcclusion=!0,this.useRadianceOcclusion=!0,this.unlit=!1,this.applyDecalMapAfterDetailMap=!1,this._environmentBRDFTexture=kS(this.getScene())}getClassName(){return"PBRMaterial"}clone(e,t=!0,i=""){const r=Fe.Clone(()=>new Me(e,this.getScene()),this,{cloneTexturesOnlyOnce:t});return r.id=e,r.name=e,this.stencil.copyTo(r.stencil),this._clonePlugins(r,i),r}serialize(){const e=super.serialize();return e.customType="BABYLON.PBRMaterial",e}static Parse(e,t,i){const r=Fe.Parse(()=>new Me(e.name,t),e,t,i);return e.stencil&&r.stencil.parse(e.stencil,t,i),j._ParsePlugins(e,r,t,i),e.clearCoat&&r.clearCoat.parse(e.clearCoat,t,i),e.anisotropy&&r.anisotropy.parse(e.anisotropy,t,i),e.brdf&&r.brdf.parse(e.brdf,t,i),e.sheen&&r.sheen.parse(e.sheen,t,i),e.subSurface&&r.subSurface.parse(e.subSurface,t,i),e.iridescence&&r.iridescence.parse(e.iridescence,t,i),r}}Me.PBRMATERIAL_OPAQUE=vt.PBRMATERIAL_OPAQUE;Me.PBRMATERIAL_ALPHATEST=vt.PBRMATERIAL_ALPHATEST;Me.PBRMATERIAL_ALPHABLEND=vt.PBRMATERIAL_ALPHABLEND;Me.PBRMATERIAL_ALPHATESTANDBLEND=vt.PBRMATERIAL_ALPHATESTANDBLEND;Me.DEFAULT_AO_ON_ANALYTICAL_LIGHTS=vt.DEFAULT_AO_ON_ANALYTICAL_LIGHTS;R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"directIntensity",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"emissiveIntensity",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"environmentIntensity",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"specularIntensity",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"disableBumpMap",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"albedoTexture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"ambientTexture",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"ambientTextureStrength",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"ambientTextureImpactOnAnalyticalLights",void 0);R([At(),ie("_markAllSubMeshesAsTexturesAndMiscDirty")],Me.prototype,"opacityTexture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"reflectionTexture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"emissiveTexture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"reflectivityTexture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"metallicTexture",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"metallic",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"roughness",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"metallicF0Factor",void 0);R([br(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"metallicReflectanceColor",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useOnlyMetallicFromMetallicReflectanceTexture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"metallicReflectanceTexture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"reflectanceTexture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"microSurfaceTexture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"bumpTexture",void 0);R([At(),ie("_markAllSubMeshesAsTexturesDirty",null)],Me.prototype,"lightmapTexture",void 0);R([br("ambient"),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"ambientColor",void 0);R([br("albedo"),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"albedoColor",void 0);R([br("reflectivity"),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"reflectivityColor",void 0);R([br("reflection"),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"reflectionColor",void 0);R([br("emissive"),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"emissiveColor",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"microSurface",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useLightmapAsShadowmap",void 0);R([I(),ie("_markAllSubMeshesAsTexturesAndMiscDirty")],Me.prototype,"useAlphaFromAlbedoTexture",void 0);R([I(),ie("_markAllSubMeshesAsTexturesAndMiscDirty")],Me.prototype,"forceAlphaTest",void 0);R([I(),ie("_markAllSubMeshesAsTexturesAndMiscDirty")],Me.prototype,"alphaCutOff",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useSpecularOverAlpha",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useMicroSurfaceFromReflectivityMapAlpha",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useRoughnessFromMetallicTextureAlpha",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useRoughnessFromMetallicTextureGreen",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useMetallnessFromMetallicTextureBlue",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useAmbientOcclusionFromMetallicTextureRed",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useAmbientInGrayScale",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useAutoMicroSurfaceFromReflectivityMap",void 0);R([I()],Me.prototype,"usePhysicalLightFalloff",null);R([I()],Me.prototype,"useGLTFLightFalloff",null);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useRadianceOverAlpha",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useObjectSpaceNormalMap",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useParallax",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useParallaxOcclusion",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"parallaxScaleBias",void 0);R([I(),ie("_markAllSubMeshesAsLightsDirty")],Me.prototype,"disableLighting",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"forceIrradianceInFragment",void 0);R([I(),ie("_markAllSubMeshesAsLightsDirty")],Me.prototype,"maxSimultaneousLights",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"invertNormalMapX",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"invertNormalMapY",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"twoSidedLighting",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useAlphaFresnel",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useLinearAlphaFresnel",void 0);R([ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"environmentBRDFTexture",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"forceNormalForward",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"enableSpecularAntiAliasing",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useHorizonOcclusion",void 0);R([I(),ie("_markAllSubMeshesAsTexturesDirty")],Me.prototype,"useRadianceOcclusion",void 0);R([I(),ie("_markAllSubMeshesAsMiscDirty")],Me.prototype,"unlit",void 0);R([I(),ie("_markAllSubMeshesAsMiscDirty")],Me.prototype,"applyDecalMapAfterDetailMap",void 0);Ji("BABYLON.PBRMaterial",Me);const qg="KHR_materials_sheen";class CX{constructor(e){this.name=qg,this.enabled=!0,this.required=!1,this._wasUsed=!1,this._exporter=e}dispose(){}get wasUsed(){return this._wasUsed}postExportMaterialAdditionalTextures(e,t,i){return i instanceof Me&&i.sheen.isEnabled&&i.sheen.texture?[i.sheen.texture]:[]}postExportMaterialAsync(e,t,i){return new Promise(r=>{if(i instanceof Me){if(!i.sheen.isEnabled){r(t);return}this._wasUsed=!0,t.extensions==null&&(t.extensions={});const s={sheenColorFactor:i.sheen.color.asArray(),sheenRoughnessFactor:i.sheen.roughness??0,hasTextures:()=>s.sheenColorTexture!==null||s.sheenRoughnessTexture!==null};i.sheen.texture&&(s.sheenColorTexture=this._exporter._glTFMaterialExporter._getTextureInfo(i.sheen.texture)??void 0),i.sheen.textureRoughness&&!i.sheen.useRoughnessFromMainTexture?s.sheenRoughnessTexture=this._exporter._glTFMaterialExporter._getTextureInfo(i.sheen.textureRoughness)??void 0:i.sheen.texture&&i.sheen.useRoughnessFromMainTexture&&(s.sheenRoughnessTexture=this._exporter._glTFMaterialExporter._getTextureInfo(i.sheen.texture)??void 0),t.extensions[qg]=s}r(t)})}}Ft.RegisterExtension(qg,n=>new CX(n));const $g="KHR_materials_unlit";class AX{constructor(){this.name=$g,this.enabled=!0,this.required=!1,this._wasUsed=!1}get wasUsed(){return this._wasUsed}dispose(){}postExportMaterialAsync(e,t,i){return new Promise(r=>{let s=!1;i instanceof Me?s=i.unlit:i instanceof le&&(s=i.disableLighting),s&&(this._wasUsed=!0,t.extensions==null&&(t.extensions={}),t.extensions[$g]={}),r(t)})}}Ft.RegisterExtension($g,()=>new AX);const Qg="KHR_materials_ior";class SX{constructor(){this.name=Qg,this.enabled=!0,this.required=!1,this._wasUsed=!1}dispose(){}get wasUsed(){return this._wasUsed}_isExtensionEnabled(e){return e.unlit?!1:e.indexOfRefraction!=null&&e.indexOfRefraction!=1.5}postExportMaterialAsync(e,t,i){return new Promise(r=>{if(i instanceof Me&&this._isExtensionEnabled(i)){this._wasUsed=!0;const s={ior:i.indexOfRefraction};t.extensions=t.extensions||{},t.extensions[Qg]=s}r(t)})}}Ft.RegisterExtension(Qg,n=>new SX);const Zg="KHR_materials_specular";class RX{constructor(e){this.name=Zg,this.enabled=!0,this.required=!1,this._wasUsed=!1,this._exporter=e}dispose(){}get wasUsed(){return this._wasUsed}postExportMaterialAdditionalTextures(e,t,i){const r=[];return i instanceof Me&&this._isExtensionEnabled(i)&&(i.metallicReflectanceTexture&&r.push(i.metallicReflectanceTexture),i.reflectanceTexture&&r.push(i.reflectanceTexture)),r}_isExtensionEnabled(e){return e.unlit?!1:e.metallicF0Factor!=null&&e.metallicF0Factor!=1||e.metallicReflectanceColor!=null&&!e.metallicReflectanceColor.equalsFloats(1,1,1)||this._hasTexturesExtension(e)}_hasTexturesExtension(e){return e.metallicReflectanceTexture!=null||e.reflectanceTexture!=null}postExportMaterialAsync(e,t,i){return new Promise(r=>{if(i instanceof Me&&this._isExtensionEnabled(i)){this._wasUsed=!0,t.extensions=t.extensions||{};const s=this._exporter._glTFMaterialExporter._getTextureInfo(i.metallicReflectanceTexture)??void 0,a=this._exporter._glTFMaterialExporter._getTextureInfo(i.reflectanceTexture)??void 0,l=i.metallicF0Factor==1?void 0:i.metallicF0Factor,o=i.metallicReflectanceColor.equalsFloats(1,1,1)?void 0:i.metallicReflectanceColor.asArray(),c={specularFactor:l,specularTexture:s,specularColorFactor:o,specularColorTexture:a,hasTextures:()=>this._hasTexturesExtension(i)};t.extensions[Zg]=c}r(t)})}}Ft.RegisterExtension(Zg,n=>new RX(n));const Jg="KHR_materials_volume";class xX{constructor(e){this.name=Jg,this.enabled=!0,this.required=!1,this._wasUsed=!1,this._exporter=e}dispose(){}get wasUsed(){return this._wasUsed}postExportMaterialAdditionalTextures(e,t,i){const r=[];return i instanceof Me&&this._isExtensionEnabled(i)&&i.subSurface.thicknessTexture&&r.push(i.subSurface.thicknessTexture),r}_isExtensionEnabled(e){if(e.unlit)return!1;const t=e.subSurface;return!t.isRefractionEnabled&&!t.isTranslucencyEnabled?!1:t.maximumThickness!=null&&t.maximumThickness!=0||t.tintColorAtDistance!=null&&t.tintColorAtDistance!=Number.POSITIVE_INFINITY||t.tintColor!=null&&t.tintColor!=Pe.White()||this._hasTexturesExtension(e)}_hasTexturesExtension(e){return e.subSurface.thicknessTexture!=null}postExportMaterialAsync(e,t,i){return new Promise(r=>{if(i instanceof Me&&this._isExtensionEnabled(i)){this._wasUsed=!0;const s=i.subSurface,a=s.maximumThickness==0?void 0:s.maximumThickness,l=this._exporter._glTFMaterialExporter._getTextureInfo(s.thicknessTexture)??void 0,o=s.tintColorAtDistance==Number.POSITIVE_INFINITY?void 0:s.tintColorAtDistance,c=s.tintColor.equalsFloats(1,1,1)?void 0:s.tintColor.asArray(),u={thicknessFactor:a,thicknessTexture:l,attenuationDistance:o,attenuationColor:c,hasTextures:()=>this._hasTexturesExtension(i)};t.extensions=t.extensions||{},t.extensions[Jg]=u}r(t)})}}Ft.RegisterExtension(Jg,n=>new xX(n));const em="KHR_materials_dispersion";class MX{constructor(){this.name=em,this.enabled=!0,this.required=!1,this._wasUsed=!1}dispose(){}get wasUsed(){return this._wasUsed}_isExtensionEnabled(e){if(e.unlit)return!1;const t=e.subSurface;return!(!t.isRefractionEnabled&&!t.isDispersionEnabled)}postExportMaterialAsync(e,t,i){return new Promise(r=>{if(i instanceof Me&&this._isExtensionEnabled(i)){this._wasUsed=!0;const l={dispersion:i.subSurface.dispersion};t.extensions=t.extensions||{},t.extensions[em]=l}r(t)})}}Ft.RegisterExtension(em,()=>new MX);const tm="KHR_materials_transmission";class IX{constructor(e){this.name=tm,this.enabled=!0,this.required=!1,this._wasUsed=!1,this._exporter=e}dispose(){}get wasUsed(){return this._wasUsed}postExportMaterialAdditionalTextures(e,t,i){const r=[];return i instanceof Me&&this._isExtensionEnabled(i)&&i.subSurface.thicknessTexture&&r.push(i.subSurface.thicknessTexture),r}_isExtensionEnabled(e){if(e.unlit)return!1;const t=e.subSurface;return t.isRefractionEnabled&&t.refractionIntensity!=null&&t.refractionIntensity!=0||this._hasTexturesExtension(e)}_hasTexturesExtension(e){return e.subSurface.refractionIntensityTexture!=null}postExportMaterialAsync(e,t,i){return new Promise(r=>{if(i instanceof Me&&this._isExtensionEnabled(i)){this._wasUsed=!0;const s=i.subSurface,a=s.refractionIntensity===0?void 0:s.refractionIntensity,l=this._exporter._glTFMaterialExporter._getTextureInfo(s.refractionIntensityTexture)??void 0,o={transmissionFactor:a,transmissionTexture:l,hasTextures:()=>this._hasTexturesExtension(i)};t.extensions=t.extensions||{},t.extensions[tm]=o}r(t)})}}Ft.RegisterExtension(tm,n=>new IX(n));Ae.prototype.thinInstanceAdd=function(n,e=!0){if(!this.getScene().getEngine().getCaps().instancedArrays)return ee.Error("Thin Instances are not supported on this device as Instanced Array extension not supported"),-1;this._thinInstanceUpdateBufferSize("matrix",Array.isArray(n)?n.length:1);const t=this._thinInstanceDataStorage.instancesCount;if(Array.isArray(n))for(let i=0;i<n.length;++i)this.thinInstanceSetMatrixAt(this._thinInstanceDataStorage.instancesCount++,n[i],i===n.length-1&&e);else this.thinInstanceSetMatrixAt(this._thinInstanceDataStorage.instancesCount++,n,e);return t};Ae.prototype.thinInstanceAddSelf=function(n=!0){return this.thinInstanceAdd(z.IdentityReadOnly,n)};Ae.prototype.thinInstanceRegisterAttribute=function(n,e){n===x.ColorKind&&(n=x.ColorInstanceKind),this.removeVerticesData(n),this._thinInstanceInitializeUserStorage(),this._userThinInstanceBuffersStorage.strides[n]=e,this._userThinInstanceBuffersStorage.sizes[n]=e*Math.max(32,this._thinInstanceDataStorage.instancesCount),this._userThinInstanceBuffersStorage.data[n]=new Float32Array(this._userThinInstanceBuffersStorage.sizes[n]),this._userThinInstanceBuffersStorage.vertexBuffers[n]=new x(this.getEngine(),this._userThinInstanceBuffersStorage.data[n],n,!0,!1,e,!0),this.setVerticesBuffer(this._userThinInstanceBuffersStorage.vertexBuffers[n])};Ae.prototype.thinInstanceSetMatrixAt=function(n,e,t=!0){if(!this._thinInstanceDataStorage.matrixData||n>=this._thinInstanceDataStorage.instancesCount)return!1;const i=this._thinInstanceDataStorage.matrixData;return e.copyToArray(i,n*16),this._thinInstanceDataStorage.worldMatrices&&(this._thinInstanceDataStorage.worldMatrices[n]=e),t&&(this.thinInstanceBufferUpdated("matrix"),this.doNotSyncBoundingInfo||this.thinInstanceRefreshBoundingInfo(!1)),!0};Ae.prototype.thinInstanceSetAttributeAt=function(n,e,t,i=!0){return n===x.ColorKind&&(n=x.ColorInstanceKind),!this._userThinInstanceBuffersStorage||!this._userThinInstanceBuffersStorage.data[n]||e>=this._thinInstanceDataStorage.instancesCount?!1:(this._thinInstanceUpdateBufferSize(n,0),this._userThinInstanceBuffersStorage.data[n].set(t,e*this._userThinInstanceBuffersStorage.strides[n]),i&&this.thinInstanceBufferUpdated(n),!0)};Object.defineProperty(Ae.prototype,"thinInstanceCount",{get:function(){return this._thinInstanceDataStorage.instancesCount},set:function(n){var i;const e=this._thinInstanceDataStorage.matrixData??((i=this.source)==null?void 0:i._thinInstanceDataStorage.matrixData),t=e?e.length/16:0;n<=t&&(this._thinInstanceDataStorage.instancesCount=n)},enumerable:!0,configurable:!0});Ae.prototype._thinInstanceCreateMatrixBuffer=function(n,e,t=!0){const i=new ou(this.getEngine(),e,!t,16,!1,!0);for(let r=0;r<4;r++)this.setVerticesBuffer(i.createVertexBuffer(n+r,r*4,4));return i};Ae.prototype.thinInstanceSetBuffer=function(n,e,t=0,i=!0){var r,s,a;t=t||16,n==="matrix"?((r=this._thinInstanceDataStorage.matrixBuffer)==null||r.dispose(),this._thinInstanceDataStorage.matrixBuffer=null,this._thinInstanceDataStorage.matrixBufferSize=e?e.length:32*t,this._thinInstanceDataStorage.matrixData=e,this._thinInstanceDataStorage.worldMatrices=null,e!==null?(this._thinInstanceDataStorage.instancesCount=e.length/t,this._thinInstanceDataStorage.matrixBuffer=this._thinInstanceCreateMatrixBuffer("world",e,i),this.doNotSyncBoundingInfo||this.thinInstanceRefreshBoundingInfo(!1)):(this._thinInstanceDataStorage.instancesCount=0,this.doNotSyncBoundingInfo||this.refreshBoundingInfo())):n==="previousMatrix"?((s=this._thinInstanceDataStorage.previousMatrixBuffer)==null||s.dispose(),this._thinInstanceDataStorage.previousMatrixBuffer=null,this._thinInstanceDataStorage.previousMatrixData=e,e!==null&&(this._thinInstanceDataStorage.previousMatrixBuffer=this._thinInstanceCreateMatrixBuffer("previousWorld",e,i))):(n===x.ColorKind&&(n=x.ColorInstanceKind),e===null?(a=this._userThinInstanceBuffersStorage)!=null&&a.data[n]&&(this.removeVerticesData(n),delete this._userThinInstanceBuffersStorage.data[n],delete this._userThinInstanceBuffersStorage.strides[n],delete this._userThinInstanceBuffersStorage.sizes[n],delete this._userThinInstanceBuffersStorage.vertexBuffers[n]):(this._thinInstanceInitializeUserStorage(),this._userThinInstanceBuffersStorage.data[n]=e,this._userThinInstanceBuffersStorage.strides[n]=t,this._userThinInstanceBuffersStorage.sizes[n]=e.length,this._userThinInstanceBuffersStorage.vertexBuffers[n]=new x(this.getEngine(),e,n,!i,!1,t,!0),this.setVerticesBuffer(this._userThinInstanceBuffersStorage.vertexBuffers[n])))};Ae.prototype.thinInstanceBufferUpdated=function(n){var e,t,i;n==="matrix"?(this.thinInstanceAllowAutomaticStaticBufferRecreation&&this._thinInstanceDataStorage.matrixBuffer&&!this._thinInstanceDataStorage.matrixBuffer.isUpdatable()&&this._thinInstanceRecreateBuffer(n),(e=this._thinInstanceDataStorage.matrixBuffer)==null||e.updateDirectly(this._thinInstanceDataStorage.matrixData,0,this._thinInstanceDataStorage.instancesCount)):n==="previousMatrix"?(this.thinInstanceAllowAutomaticStaticBufferRecreation&&this._thinInstanceDataStorage.previousMatrixBuffer&&!this._thinInstanceDataStorage.previousMatrixBuffer.isUpdatable()&&this._thinInstanceRecreateBuffer(n),(t=this._thinInstanceDataStorage.previousMatrixBuffer)==null||t.updateDirectly(this._thinInstanceDataStorage.previousMatrixData,0,this._thinInstanceDataStorage.instancesCount)):(n===x.ColorKind&&(n=x.ColorInstanceKind),(i=this._userThinInstanceBuffersStorage)!=null&&i.vertexBuffers[n]&&(this.thinInstanceAllowAutomaticStaticBufferRecreation&&!this._userThinInstanceBuffersStorage.vertexBuffers[n].isUpdatable()&&this._thinInstanceRecreateBuffer(n),this._userThinInstanceBuffersStorage.vertexBuffers[n].updateDirectly(this._userThinInstanceBuffersStorage.data[n],0)))};Ae.prototype.thinInstancePartialBufferUpdate=function(n,e,t){var i;n==="matrix"?this._thinInstanceDataStorage.matrixBuffer&&this._thinInstanceDataStorage.matrixBuffer.updateDirectly(e,t):(n===x.ColorKind&&(n=x.ColorInstanceKind),(i=this._userThinInstanceBuffersStorage)!=null&&i.vertexBuffers[n]&&this._userThinInstanceBuffersStorage.vertexBuffers[n].updateDirectly(e,t))};Ae.prototype.thinInstanceGetWorldMatrices=function(){if(!this._thinInstanceDataStorage.matrixData||!this._thinInstanceDataStorage.matrixBuffer)return[];const n=this._thinInstanceDataStorage.matrixData;if(!this._thinInstanceDataStorage.worldMatrices){this._thinInstanceDataStorage.worldMatrices=[];for(let e=0;e<this._thinInstanceDataStorage.instancesCount;++e)this._thinInstanceDataStorage.worldMatrices[e]=z.FromArray(n,e*16)}return this._thinInstanceDataStorage.worldMatrices};Ae.prototype.thinInstanceRefreshBoundingInfo=function(n=!1,e=!1,t=!1){if(!this._thinInstanceDataStorage.matrixData||!this._thinInstanceDataStorage.matrixBuffer)return;const i=this._thinInstanceDataStorage.boundingVectors;if(n||!this.rawBoundingInfo){i.length=0,this.refreshBoundingInfo(e,t);const a=this.getBoundingInfo();this.rawBoundingInfo=new Zr(a.minimum,a.maximum)}const r=this.getBoundingInfo(),s=this._thinInstanceDataStorage.matrixData;if(i.length===0)for(let a=0;a<r.boundingBox.vectors.length;++a)i.push(r.boundingBox.vectors[a].clone());V.Vector3[0].setAll(Number.POSITIVE_INFINITY),V.Vector3[1].setAll(Number.NEGATIVE_INFINITY);for(let a=0;a<this._thinInstanceDataStorage.instancesCount;++a){z.FromArrayToRef(s,a*16,V.Matrix[0]);for(let l=0;l<i.length;++l)A.TransformCoordinatesToRef(i[l],V.Matrix[0],V.Vector3[2]),V.Vector3[0].minimizeInPlace(V.Vector3[2]),V.Vector3[1].maximizeInPlace(V.Vector3[2])}r.reConstruct(V.Vector3[0],V.Vector3[1]),this._updateBoundingInfo()};Ae.prototype._thinInstanceRecreateBuffer=function(n,e=!0){var t,i,r;n==="matrix"?((t=this._thinInstanceDataStorage.matrixBuffer)==null||t.dispose(),this._thinInstanceDataStorage.matrixBuffer=this._thinInstanceCreateMatrixBuffer("world",this._thinInstanceDataStorage.matrixData,e)):n==="previousMatrix"?this._scene.needsPreviousWorldMatrices&&((i=this._thinInstanceDataStorage.previousMatrixBuffer)==null||i.dispose(),this._thinInstanceDataStorage.previousMatrixBuffer=this._thinInstanceCreateMatrixBuffer("previousWorld",this._thinInstanceDataStorage.previousMatrixData??this._thinInstanceDataStorage.matrixData,e)):(n===x.ColorKind&&(n=x.ColorInstanceKind),(r=this._userThinInstanceBuffersStorage.vertexBuffers[n])==null||r.dispose(),this._userThinInstanceBuffersStorage.vertexBuffers[n]=new x(this.getEngine(),this._userThinInstanceBuffersStorage.data[n],n,!e,!1,this._userThinInstanceBuffersStorage.strides[n],!0),this.setVerticesBuffer(this._userThinInstanceBuffersStorage.vertexBuffers[n]))};Ae.prototype._thinInstanceUpdateBufferSize=function(n,e=1){var o,c,u;n===x.ColorKind&&(n=x.ColorInstanceKind);const t=n==="matrix";if(!t&&(!this._userThinInstanceBuffersStorage||!this._userThinInstanceBuffersStorage.strides[n]))return;const i=t?16:this._userThinInstanceBuffersStorage.strides[n],r=t?this._thinInstanceDataStorage.matrixBufferSize:this._userThinInstanceBuffersStorage.sizes[n];let s=t?this._thinInstanceDataStorage.matrixData:this._userThinInstanceBuffersStorage.data[n];const a=(this._thinInstanceDataStorage.instancesCount+e)*i;let l=r;for(;l<a;)l*=2;if(!s||r!=l){if(!s)s=new Float32Array(l);else{const h=new Float32Array(l);h.set(s,0),s=h}t?((o=this._thinInstanceDataStorage.matrixBuffer)==null||o.dispose(),this._thinInstanceDataStorage.matrixBuffer=this._thinInstanceCreateMatrixBuffer("world",s,!1),this._thinInstanceDataStorage.matrixData=s,this._thinInstanceDataStorage.matrixBufferSize=l,this._scene.needsPreviousWorldMatrices&&!this._thinInstanceDataStorage.previousMatrixData&&((c=this._thinInstanceDataStorage.previousMatrixBuffer)==null||c.dispose(),this._thinInstanceDataStorage.previousMatrixBuffer=this._thinInstanceCreateMatrixBuffer("previousWorld",s,!1))):((u=this._userThinInstanceBuffersStorage.vertexBuffers[n])==null||u.dispose(),this._userThinInstanceBuffersStorage.data[n]=s,this._userThinInstanceBuffersStorage.sizes[n]=l,this._userThinInstanceBuffersStorage.vertexBuffers[n]=new x(this.getEngine(),s,n,!0,!1,i,!0),this.setVerticesBuffer(this._userThinInstanceBuffersStorage.vertexBuffers[n]))}};Ae.prototype._thinInstanceInitializeUserStorage=function(){this._userThinInstanceBuffersStorage||(this._userThinInstanceBuffersStorage={data:{},sizes:{},vertexBuffers:{},strides:{}})};Ae.prototype._disposeThinInstanceSpecificData=function(){var n;(n=this._thinInstanceDataStorage)!=null&&n.matrixBuffer&&(this._thinInstanceDataStorage.matrixBuffer.dispose(),this._thinInstanceDataStorage.matrixBuffer=null)};const im="EXT_mesh_gpu_instancing";class PX{constructor(e){this.name=im,this.enabled=!0,this.required=!1,this._wasUsed=!1,this._exporter=e}dispose(){}get wasUsed(){return this._wasUsed}postExportNodeAsync(e,t,i,r,s){return new Promise(a=>{if(t&&i instanceof Ae&&i.hasThinInstances&&s){this._wasUsed=!0;const l=A.Zero(),o=ue.Identity(),c=A.One(),u=i.thinInstanceGetWorldMatrices(),h=V.Vector3[2],d=V.Quaternion[1],f=V.Vector3[3];let _=!1,p=!1,v=!1;const E=new Float32Array(i.thinInstanceCount*3),g=new Float32Array(i.thinInstanceCount*4),m=new Float32Array(i.thinInstanceCount*3);let y=0;for(const b of u)b.decompose(f,d,h),E.set(h.asArray(),y*3),g.set(d.normalize().asArray(),y*4),m.set(f.asArray(),y*3),_=_||!h.equalsWithEpsilon(l),p=p||!d.equalsWithEpsilon(o),v=v||!f.equalsWithEpsilon(c),y++;const T={attributes:{}};_&&(T.attributes.TRANSLATION=this._buildAccessor(E,"VEC3",i.thinInstanceCount,s,5126)),p&&(T.attributes.ROTATION=this._buildAccessor(g,"VEC4",i.thinInstanceCount,s,5126)),v&&(T.attributes.SCALE=this._buildAccessor(m,"VEC3",i.thinInstanceCount,s,5126)),t.extensions=t.extensions||{},t.extensions[im]=T}a(t)})}_buildAccessor(e,t,i,r,s){const a=r.getByteOffset();switch(s){case 5126:{for(let h=0;h!=e.length;h++)r.setFloat32(e[h]);break}case 5120:{for(let h=0;h!=e.length;h++)r.setByte(e[h]*127);break}case 5122:{for(let h=0;h!=e.length;h++)r.setInt16(e[h]*32767);break}}const l={buffer:0,byteOffset:a,byteLength:e.length*x.GetTypeByteLength(s)},o=this._exporter._bufferViews.length;this._exporter._bufferViews.push(l);const c=this._exporter._accessors.length,u={bufferView:o,componentType:s,count:i,type:t,normalized:s==5120||s==5122};return this._exporter._accessors.push(u),c}}Ft.RegisterExtension(im,n=>new PX(n));const rm="KHR_materials_emissive_strength";class wX{constructor(){this.name=rm,this.enabled=!0,this.required=!1,this._wasUsed=!1}dispose(){}get wasUsed(){return this._wasUsed}postExportMaterialAsync(e,t,i){return new Promise(r=>{if(!(i instanceof Me))return r(t);const s=i.emissiveColor.asArray(),a=Math.max(...s);if(a>1){this._wasUsed=!0,t.extensions||(t.extensions={});const l={emissiveStrength:a},o=i.emissiveColor.scale(1/l.emissiveStrength);t.emissiveFactor=o.asArray(),t.extensions[rm]=l}return r(t)})}}Ft.RegisterExtension(rm,n=>new wX);var A_={},BS={},US={exports:{}};(function(n){function e(t){return t&&t.__esModule?t:{default:t}}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(US);var D=US.exports,Cp={exports:{}},NT;function L(){return NT||(NT=1,function(n){function e(){return n.exports=e=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},n.exports.__esModule=!0,n.exports.default=n.exports,e.apply(this,arguments)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(Cp)),Cp.exports}var Ap={exports:{}},Sp={exports:{}},FT;function OX(){return FT||(FT=1,function(n){function e(t,i){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(i.indexOf(s)>=0)continue;r[s]=t[s]}return r}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(Sp)),Sp.exports}var kT;function N(){return kT||(kT=1,function(n){var e=OX();function t(i,r){if(i==null)return{};var s=e(i,r),a,l;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);for(l=0;l<o.length;l++)a=o[l],!(r.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(i,a)&&(s[a]=i[a])}return s}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(Ap)),Ap.exports}(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"}))},a=s;n.default=a})(BS);var zS={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M5 17H4a2 2 0 01-2-2V5a2 2 0 012-2h16a2 2 0 012 2v10a2 2 0 01-2 2h-1"}),r.default.createElement("path",{d:"M12 15l5 6H7l5-6z"}))},a=s;n.default=a})(zS);var VS={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10",fill:""}),r.default.createElement("path",{stroke:"",d:"M12 8v4M12 16h.01"}))},a=s;n.default=a})(VS);var GS={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10",fill:u}),r.default.createElement("path",{stroke:"var(--geist-icons-background)",d:"M12 8v4M12 16h.01"}))},a=s;n.default=a})(GS);var WS={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M7.86 2h8.28L22 7.86v8.28L16.14 22H7.86L2 16.14V7.86L7.86 2zM12 8v4M12 16h.01"}))},a=s;n.default=a})(WS);var HS={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:"",d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"}),r.default.createElement("path",{stroke:"",d:"M12 9v4M12 17h.01"}))},a=s;n.default=a})(HS);var jS={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:u,d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"}),r.default.createElement("path",{stroke:"var(--geist-icons-background)",d:"M12 9v4M12 17h.01"}))},a=s;n.default=a})(jS);var XS={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M18 10H6M21 6H3M21 14H3M18 18H6"}))},a=s;n.default=a})(XS);var YS={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 10H3M21 6H3M21 14H3M21 18H3"}))},a=s;n.default=a})(YS);var KS={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M17 10H3M21 6H3M21 14H3M17 18H3"}))},a=s;n.default=a})(KS);var qS={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 10H7M21 6H3M21 14H3M21 18H7"}))},a=s;n.default=a})(qS);var $S={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"5",r:"3"}),r.default.createElement("path",{d:"M12 22V8M5 12H2a10 10 0 0020 0h-3"}))},a=s;n.default=a})($S);var QS={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M14.31 8l5.74 9.94M9.69 8h11.48M7.38 12l5.74-9.94M9.69 16L3.95 6.06M14.31 16H2.83M16.62 12l-5.74 9.94"}))},a=s;n.default=a})(QS);var ZS={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}))},a=s;n.default=a})(ZS);var JS={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M8 12l4 4 4-4M12 8v8"}))},a=s;n.default=a})(JS);var eR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M17 7L7 17M17 17H7V7"}))},a=s;n.default=a})(eR);var tR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M7 7l10 10M17 7v10H7"}))},a=s;n.default=a})(tR);var iR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 5v14M19 12l-7 7-7-7"}))},a=s;n.default=a})(iR);var rR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M12 8l-4 4 4 4M16 12H8"}))},a=s;n.default=a})(rR);var nR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M19 12H5M12 19l-7-7 7-7"}))},a=s;n.default=a})(nR);var sR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M12 16l4-4-4-4M8 12h8"}))},a=s;n.default=a})(sR);var aR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10",fill:u}),r.default.createElement("path",{stroke:"var(--geist-icons-background)",d:"M12 16l4-4-4-4M8 12h8"}))},a=s;n.default=a})(aR);var oR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M5 12h14M12 5l7 7-7 7"}))},a=s;n.default=a})(oR);var lR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M16 12l-4-4-4 4M12 16V8"}))},a=s;n.default=a})(lR);var cR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M17 17L7 7M7 17V7h10"}))},a=s;n.default=a})(cR);var uR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M7 17L17 7M7 7h10v10"}))},a=s;n.default=a})(uR);var hR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 19V5M5 12l7-7 7 7"}))},a=s;n.default=a})(hR);var dR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"4"}),r.default.createElement("path",{d:"M16 8v5a3 3 0 006 0v-1a10 10 0 10-3.92 7.94"}))},a=s;n.default=a})(dR);var fR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"8",r:"7"}),r.default.createElement("path",{d:"M8.21 13.89L7 23l5-3 5 3-1.21-9.12"}))},a=s;n.default=a})(fR);var _R={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M18 20V10M12 20V4M6 20v-6"}))},a=s;n.default=a})(_R);var pR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 20V10M18 20V4M6 20v-4"}))},a=s;n.default=a})(pR);var gR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M5 18H3a2 2 0 01-2-2V8a2 2 0 012-2h3.19M15 6h2a2 2 0 012 2v8a2 2 0 01-2 2h-3.19M23 13v-2M11 6l-4 6h6l-4 6"}))},a=s;n.default=a})(gR);var mR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"18",height:"12",x:"1",y:"6",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M23 13v-2"}))},a=s;n.default=a})(mR);var vR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M13.73 21a2 2 0 01-3.46 0M18.63 13A17.89 17.89 0 0118 8M6.26 6.26A5.86 5.86 0 006 8c0 7-3 9-3 9h14M18 8a6 6 0 00-9.33-5M1 1l22 22"}))},a=s;n.default=a})(vR);var ER={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0"}))},a=s;n.default=a})(ER);var yR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M6.5 6.5l11 11L12 23V1l5.5 5.5-11 11"}))},a=s;n.default=a})(yR);var TR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M6 4h8a4 4 0 014 4 4 4 0 01-4 4H6zM6 12h9a4 4 0 014 4 4 4 0 01-4 4H6z"}))},a=s;n.default=a})(TR);var bR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M2 3h6a4 4 0 014 4v14a3 3 0 00-3-3H2zM22 3h-6a4 4 0 00-4 4v14a3 3 0 013-3h7z"}))},a=s;n.default=a})(bR);var CR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M4 19.5A2.5 2.5 0 016.5 17H20"}),r.default.createElement("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 014 19.5v-15A2.5 2.5 0 016.5 2z"}))},a=s;n.default=a})(CR);var AR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M19 21l-7-5-7 5V5a2 2 0 012-2h10a2 2 0 012 2z"}))},a=s;n.default=a})(AR);var SR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"}),r.default.createElement("path",{d:"M3.27 6.96L12 12.01l8.73-5.05M12 22.08V12"}))},a=s;n.default=a})(SR);var RR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M16 21V5a2 2 0 00-2-2h-4a2 2 0 00-2 2v16"}))},a=s;n.default=a})(RR);var xR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M16 2v4M8 2v4M3 10h18"}))},a=s;n.default=a})(xR);var MR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M1 1l22 22M21 21H3a2 2 0 01-2-2V8a2 2 0 012-2h3m3-3h6l2 3h4a2 2 0 012 2v9.34m-7.72-2.06a4 4 0 11-5.56-5.56"}))},a=s;n.default=a})(MR);var IR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M23 19a2 2 0 01-2 2H3a2 2 0 01-2-2V8a2 2 0 012-2h4l2-3h6l2 3h4a2 2 0 012 2z"}),r.default.createElement("circle",{cx:"12",cy:"13",r:"4"}))},a=s;n.default=a})(IR);var PR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M2 16.1A5 5 0 015.9 20M2 12.05A9 9 0 019.95 20M2 8V6a2 2 0 012-2h16a2 2 0 012 2v12a2 2 0 01-2 2h-6M2 20h.01"}))},a=s;n.default=a})(PR);var wR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M22 11.08V12a10 10 0 11-5.93-9.14"}),r.default.createElement("path",{d:"M22 4L12 14.01l-3-3"}))},a=s;n.default=a})(wR);var OR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M8 11.857l2.5 2.5L15.857 9M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10z"}))},a=s;n.default=a})(OR);var DR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:u,stroke:u,d:"M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2z"}),r.default.createElement("path",{fill:"none",stroke:"var(--geist-icons-background)",d:"M8 11.857l2.5 2.5L15.857 9"}))},a=s;n.default=a})(DR);var LR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M9 11l3 3L22 4"}),r.default.createElement("path",{d:"M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"}))},a=s;n.default=a})(LR);var NR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M20 6L9 17l-5-5"}))},a=s;n.default=a})(NR);var FR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16.09 3H7.91A4.91 4.91 0 003 7.91v8.18A4.909 4.909 0 007.91 21h8.18A4.909 4.909 0 0021 16.09V7.91A4.909 4.909 0 0016.09 3z"}))},a=s;n.default=a})(FR);var kR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:u,stroke:"none",d:"M7.91 3h8.18a4.908 4.908 0 014.31 2.554l-8.273 8.377-2.592-2.638a.75.75 0 10-1.07 1.05l3.125 3.182a.75.75 0 001.069.002l8.281-8.386c.04.25.06.507.06.768v8.182A4.909 4.909 0 0116.09 21H7.91A4.909 4.909 0 013 16.09V7.91A4.91 4.91 0 017.91 3z"}))},a=s;n.default=a})(kR);var BR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:"",d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),r.default.createElement("path",{stroke:"",d:"M8 10.679l4 4 4-4"}))},a=s;n.default=a})(BR);var UR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:u,d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),r.default.createElement("path",{fill:"none",stroke:"var(--geist-icons-background)",d:"M8 10.679l4 4 4-4"}))},a=s;n.default=a})(UR);var zR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M6 9l6 6 6-6"}))},a=s;n.default=a})(zR);var VR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:"",d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),r.default.createElement("path",{stroke:"",d:"M13 8l-4 4 4 4"}))},a=s;n.default=a})(VR);var GR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:u,d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),r.default.createElement("path",{fill:"none",stroke:"var(--geist-icons-background)",d:"M13 8l-4 4 4 4"}))},a=s;n.default=a})(GR);var WR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M15 18l-6-6 6-6"}))},a=s;n.default=a})(WR);var HR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:"",d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),r.default.createElement("path",{stroke:"",d:"M11 16l4-4-4-4"}))},a=s;n.default=a})(HR);var jR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:u,d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),r.default.createElement("path",{fill:"none",stroke:"var(--geist-icons-background)",d:"M11 16l4-4-4-4"}))},a=s;n.default=a})(jR);var XR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M9 18l6-6-6-6"}))},a=s;n.default=a})(XR);var YR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:"",d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),r.default.createElement("path",{stroke:"",d:"M16 14l-4-4-4 4"}))},a=s;n.default=a})(YR);var KR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:u,d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),r.default.createElement("path",{fill:"none",stroke:"var(--geist-icons-background)",d:"M16 14l-4-4-4 4"}))},a=s;n.default=a})(KR);var qR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M17 8.517L12 3 7 8.517m0 6.963l5 5.517 5-5.517"}))},a=s;n.default=a})(qR);var $R={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M18 15l-6-6-6 6"}))},a=s;n.default=a})($R);var QR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M7 13l5 5 5-5M7 6l5 5 5-5"}))},a=s;n.default=a})(QR);var ZR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M11 17l-5-5 5-5M18 17l-5-5 5-5"}))},a=s;n.default=a})(ZR);var JR={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M13 17l5-5-5-5M6 17l5-5-5-5"}))},a=s;n.default=a})(JR);var ex={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M17 11l-5-5-5 5M17 18l-5-5-5 5"}))},a=s;n.default=a})(ex);var tx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("circle",{cx:"12",cy:"12",r:"4"}),r.default.createElement("path",{d:"M21.17 8H12M3.95 6.06L8.54 14M10.88 21.94L15.46 14"}))},a=s;n.default=a})(tx);var ix={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}))},a=s;n.default=a})(ix);var rx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"}),r.default.createElement("rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1"}))},a=s;n.default=a})(rx);var nx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M12 6v6l4 2"}))},a=s;n.default=a})(nx);var sx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M8 19v2M8 13v2M16 19v2M16 13v2M12 21v2M12 15v2M20 16.58A5 5 0 0018 7h-1.26A8 8 0 104 15.25"}))},a=s;n.default=a})(sx);var ax={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M19 16.9A5 5 0 0018 7h-1.26a8 8 0 10-11.62 9"}),r.default.createElement("path",{d:"M13 11l-4 6h6l-4 6"}))},a=s;n.default=a})(ax);var ox={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M22.61 16.95A5 5 0 0018 10h-1.26a8 8 0 00-7.05-6M5 5a8 8 0 004 15h9a5 5 0 001.7-.3M1 1l22 22"}))},a=s;n.default=a})(ox);var lx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16 13v8M8 13v8M12 15v8M20 16.58A5 5 0 0018 7h-1.26A8 8 0 104 15.25"}))},a=s;n.default=a})(lx);var cx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M20 17.58A5 5 0 0018 8h-1.26A8 8 0 104 16.25M8 16h.01M8 20h.01M12 18h.01M12 22h.01M16 16h.01M16 20h.01"}))},a=s;n.default=a})(cx);var ux={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M18 10h-1.26A8 8 0 109 20h9a5 5 0 000-10z"}))},a=s;n.default=a})(ux);var hx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16 18l6-6-6-6M8 6l-6 6 6 6"}))},a=s;n.default=a})(hx);var dx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 2l10 6.5v7L12 22 2 15.5v-7L12 2zM12 22v-6.5"}),r.default.createElement("path",{d:"M22 8.5l-10 7-10-7"}),r.default.createElement("path",{d:"M2 15.5l10-7 10 7M12 2v6.5"}))},a=s;n.default=a})(dx);var fx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"}),r.default.createElement("path",{d:"M7.5 4.21l4.5 2.6 4.5-2.6M7.5 19.79V14.6L3 12M21 12l-4.5 2.6v5.19M3.27 6.96L12 12.01l8.73-5.05M12 22.08V12"}))},a=s;n.default=a})(fx);var _x={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M18 8h1a4 4 0 010 8h-1M2 8h16v9a4 4 0 01-4 4H6a4 4 0 01-4-4V8zM6 1v3M10 1v3M14 1v3"}))},a=s;n.default=a})(_x);var px={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 3h7a2 2 0 012 2v14a2 2 0 01-2 2h-7m0-18H5a2 2 0 00-2 2v14a2 2 0 002 2h7m0-18v18"}))},a=s;n.default=a})(px);var gx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M18 3a3 3 0 00-3 3v12a3 3 0 003 3 3 3 0 003-3 3 3 0 00-3-3H6a3 3 0 00-3 3 3 3 0 003 3 3 3 0 003-3V6a3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3h12a3 3 0 003-3 3 3 0 00-3-3z"}))},a=s;n.default=a})(gx);var mx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M16.24 7.76l-2.12 6.36-6.36 2.12 2.12-6.36 6.36-2.12z"}))},a=s;n.default=a})(mx);var vx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M8 17.929H6c-1.105 0-2-.912-2-2.036V5.036C4 3.91 4.895 3 6 3h8c1.105 0 2 .911 2 2.036v1.866m-6 .17h8c1.105 0 2 .91 2 2.035v10.857C20 21.09 19.105 22 18 22h-8c-1.105 0-2-.911-2-2.036V9.107c0-1.124.895-2.036 2-2.036z"}))},a=s;n.default=a})(vx);var Ex={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M9 10l-5 5 5 5"}),r.default.createElement("path",{d:"M20 4v7a4 4 0 01-4 4H4"}))},a=s;n.default=a})(Ex);var yx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M15 10l5 5-5 5"}),r.default.createElement("path",{d:"M4 4v7a4 4 0 004 4h12"}))},a=s;n.default=a})(yx);var Tx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M14 15l-5 5-5-5"}),r.default.createElement("path",{d:"M20 4h-7a4 4 0 00-4 4v12"}))},a=s;n.default=a})(Tx);var bx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M14 9L9 4 4 9"}),r.default.createElement("path",{d:"M20 20h-7a4 4 0 01-4-4V4"}))},a=s;n.default=a})(bx);var Cx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M10 15l5 5 5-5"}),r.default.createElement("path",{d:"M4 4h7a4 4 0 014 4v12"}))},a=s;n.default=a})(Cx);var Ax={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M10 9l5-5 5 5"}),r.default.createElement("path",{d:"M4 20h7a4 4 0 004-4V4"}))},a=s;n.default=a})(Ax);var Sx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M9 14L4 9l5-5"}),r.default.createElement("path",{d:"M20 20v-7a4 4 0 00-4-4H4"}))},a=s;n.default=a})(Sx);var Rx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M15 14l5-5-5-5"}),r.default.createElement("path",{d:"M4 20v-7a4 4 0 014-4h12"}))},a=s;n.default=a})(Rx);var xx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M9 9h6v6H9zM9 1v3M15 1v3M9 20v3M15 20v3M20 9h3M20 14h3M1 9h3M1 14h3"}))},a=s;n.default=a})(xx);var Mx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"22",height:"16",x:"1",y:"4",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M1 10h22"}))},a=s;n.default=a})(Mx);var Ix={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M6.13 1L6 16a2 2 0 002 2h15"}),r.default.createElement("path",{d:"M1 6.13L16 6a2 2 0 012 2v15"}))},a=s;n.default=a})(Ix);var Px={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M22 12h-4M6 12H2M12 6V2M12 22v-4"}))},a=s;n.default=a})(Px);var wx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),r.default.createElement("path",{d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"}),r.default.createElement("path",{d:"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"}))},a=s;n.default=a})(wx);var Ox={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 4H8l-7 8 7 8h13a2 2 0 002-2V6a2 2 0 00-2-2zM18 9l-6 6M12 9l6 6"}))},a=s;n.default=a})(Ox);var Dx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("circle",{cx:"12",cy:"12",r:"3"}))},a=s;n.default=a})(Dx);var Lx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M2 13.381h20M8.66 19.05V22m6.84-2.95V22m-8.955 0h10.932M4 19.05h16a2 2 0 002-2V4a2 2 0 00-2-2H4a2 2 0 00-2 2v13.05a2 2 0 002 2z"}))},a=s;n.default=a})(Lx);var Nx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16.88 3.549L7.12 20.451"}))},a=s;n.default=a})(Nx);var Fx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 1v22M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"}))},a=s;n.default=a})(Fx);var kx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M8 17l4 4 4-4M12 12v9"}),r.default.createElement("path",{d:"M20.88 18.09A5 5 0 0018 9h-1.26A8 8 0 103 16.29"}))},a=s;n.default=a})(kx);var Bx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"}))},a=s;n.default=a})(Bx);var Ux={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 2.69l5.66 5.66a8 8 0 11-11.31 0z"}))},a=s;n.default=a})(Ux);var zx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M17 3a2.828 2.828 0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"}))},a=s;n.default=a})(zx);var Vx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 20h9M16.5 3.5a2.121 2.121 0 013 3L7 19l-4 1 1-4L16.5 3.5z"}))},a=s;n.default=a})(Vx);var Gx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),r.default.createElement("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"}))},a=s;n.default=a})(Gx);var Wx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),r.default.createElement("path",{fill:"currentColor",d:"M7 14.5s0 4 5 4 5-4 5-4"}),r.default.createElement("path",{d:"M7 14.5s0 4 5 4 5-4 5-4H7z"}),r.default.createElement("circle",{cx:"15.5",cy:"9.5",r:".8"}),r.default.createElement("circle",{cx:"8.5",cy:"9.5",r:".8"}))},a=s;n.default=a})(Wx);var Hx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6M15 3h6v6M10 14L21 3"}))},a=s;n.default=a})(Hx);var jx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24M1 1l22 22"}))},a=s;n.default=a})(jx);var Xx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),r.default.createElement("circle",{cx:"12",cy:"12",r:"3"}))},a=s;n.default=a})(Xx);var Yx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"}))},a=s;n.default=a})(Yx);var Kx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M13 19l9-7-9-7v14zM2 19l9-7-9-7v14z"}))},a=s;n.default=a})(Kx);var qx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M20.24 12.24a6 6 0 00-8.49-8.49L5 10.5V19h8.5zM16 8L2 22M17.5 15H9"}))},a=s;n.default=a})(qx);var $x={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M5 5.5A3.5 3.5 0 018.5 2H12v7H8.5A3.5 3.5 0 015 5.5zM12 2h3.5a3.5 3.5 0 110 7H12V2z"}),r.default.createElement("path",{d:"M12 12.5a3.5 3.5 0 117 0 3.5 3.5 0 11-7 0zM5 19.5A3.5 3.5 0 018.5 16H12v3.5a3.5 3.5 0 11-7 0zM5 12.5A3.5 3.5 0 018.5 9H12v7H8.5A3.5 3.5 0 015 12.5z"}))},a=s;n.default=a})($x);var Qx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M13 2H6a2 2 0 00-2 2v16m0 0a2 2 0 002 2h12a2 2 0 002-2M4 20V9m16 11V9m0 11V4a2 2 0 00-2-2h-7"}),r.default.createElement("path",{d:"M9 11.236h2.848M9 18c1.934 0 2.848-.996 2.848-2.793v-3.97m0 0h2.813m-2.813 0V8.983c0-1.937 1.034-3.265 3.152-2.933"}))},a=s;n.default=a})(Qx);var Zx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:u,stroke:"none",d:"M4.055 2.055A2.75 2.75 0 016 1.25h12A2.75 2.75 0 0120.75 4v16A2.75 2.75 0 0118 22.75H6A2.75 2.75 0 013.25 20V4c0-.73.29-1.429.805-1.945zM15.116 5.31c-1.237-.194-2.29.086-3.02.83-.709.722-.998 1.758-.998 2.844v1.502H9a.75.75 0 100 1.5h2.098v3.22c0 .78-.197 1.257-.48 1.543-.283.284-.773.501-1.618.501a.75.75 0 000 1.5c1.088 0 2.023-.281 2.681-.944.658-.662.918-1.582.918-2.6v-3.22h2.062a.75.75 0 000-1.5h-2.063V8.984c0-.851.229-1.447.567-1.792.315-.32.838-.538 1.719-.4a.75.75 0 00.232-1.482z"}))},a=s;n.default=a})(Zx);var Jx={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M13 2H6a2 2 0 00-2 2v16m0 0a2 2 0 002 2h12a2 2 0 002-2M4 20V9m16 11V9m0 11V4a2 2 0 00-2-2h-7"}),r.default.createElement("path",{fill:"currentColor",stroke:"none",d:"M7.716 6.783c0-.433.353-.783.79-.783.679 0 1.314.056 1.878.44.532.363.893.948 1.268 1.658l.009.015 1.053 2.229 2.333 4.835.005.009.164.355c.078.17.142.31.207.44.101.204.165.296.21.345l.003.004c.022.027.086.105.575.105.436 0 .789.35.789.782a.786.786 0 01-.79.783c-.683 0-1.278-.113-1.743-.619a3.01 3.01 0 01-.459-.704c-.076-.152-.159-.334-.247-.526l-.14-.303-1.72-3.563-3.446 5.353a.794.794 0 01-1.09.239.779.779 0 01-.24-1.08l3.976-6.178-.855-1.81c-.377-.71-.583-.96-.756-1.079-.143-.097-.353-.165-.985-.165a.786.786 0 01-.79-.782z"}))},a=s;n.default=a})(Jx);var eM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:u,stroke:u,d:"M18 2a2 2 0 012 2v16a2 2 0 01-2 2H6a2 2 0 01-2-2V4a2 2 0 012-2h12z"}),r.default.createElement("path",{fill:"var(--geist-icons-background)",stroke:"none",d:"M7.716 6.783c0-.433.353-.783.79-.783.679 0 1.314.056 1.878.44.532.363.893.948 1.268 1.658l.009.015 1.053 2.229 2.333 4.835.005.009.164.355c.078.17.142.31.207.44.101.204.165.296.21.345l.003.004c.022.027.086.105.575.105.436 0 .789.35.789.782a.786.786 0 01-.79.783c-.683 0-1.278-.113-1.743-.619a3.01 3.01 0 01-.459-.704c-.076-.152-.159-.334-.247-.526l-.14-.303-1.72-3.563-3.446 5.353a.794.794 0 01-1.09.239.779.779 0 01-.24-1.08l3.976-6.178-.855-1.81c-.377-.71-.583-.96-.756-1.079-.143-.097-.353-.165-.985-.165a.786.786 0 01-.79-.782z"}))},a=s;n.default=a})(eM);var tM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),r.default.createElement("path",{d:"M14 2v6h6M9 15h6"}))},a=s;n.default=a})(tM);var iM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),r.default.createElement("path",{d:"M14 2v6h6M12 18v-6M9 15h6"}))},a=s;n.default=a})(iM);var rM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),r.default.createElement("path",{d:"M14 2v6h6M16 13H8M16 17H8M10 9H8"}))},a=s;n.default=a})(rM);var nM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M13 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V9z"}),r.default.createElement("path",{d:"M13 2v7h7"}))},a=s;n.default=a})(nM);var sM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"20",height:"20",x:"2",y:"2",rx:"2.2",ry:"2.2"}),r.default.createElement("path",{d:"M7 2v20M17 2v20M2 12h20M2 7h5M2 17h5M17 17h5M17 7h5"}))},a=s;n.default=a})(sM);var aM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M22 3H2l8 9.46V19l4 2v-8.54L22 3z"}))},a=s;n.default=a})(aM);var oM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1zM4 22v-7"}))},a=s;n.default=a})(oM);var lM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2zM9 14h6"}))},a=s;n.default=a})(lM);var cM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2zM12 11v6M9 14h6"}))},a=s;n.default=a})(cM);var uM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M2.707 7.454V5.62c0-.895.762-1.62 1.702-1.62h4.843c.451 0 .884.17 1.204.474l.49.467c.126.12.296.186.473.186h8.399c.94 0 1.55.695 1.55 1.59v.737m-18.661 0h-.354a.344.344 0 00-.353.35l.508 11.587c.015.34.31.609.668.609h17.283c.358 0 .652-.269.667-.61L22 7.805a.344.344 0 00-.353-.35h-.278m-18.662 0h18.662"}))},a=s;n.default=a})(uM);var hM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M5 16V9h14V2H5l14 14h-7m-7 0l7 7v-7m-7 0h7"}))},a=s;n.default=a})(hM);var dM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M16 16s-1.5-2-4-2-4 2-4 2M9 9h.01M15 9h.01"}))},a=s;n.default=a})(dM);var fM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M4 14h6m0 0v6m0-6l-7 7m17-11h-6m0 0V4m0 6l7-7m-7 17v-6m0 0h6m-6 0l7 7M10 4v6m0 0H4m6 0L3 3"}))},a=s;n.default=a})(fM);var _M={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M15 3h6m0 0v6m0-6l-7 7M9 21H3m0 0v-6m0 6l7-7M3 9V3m0 0h6M3 3l7 7m11 5v6m0 0h-6m6 0l-7-7"}))},a=s;n.default=a})(_M);var pM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M8 10.854h3.798M8 21c2.578 0 3.798-1.494 3.798-4.19v-5.956m0 0h3.75m-3.75 0V7.476c0-2.906 1.379-4.898 4.202-4.4"}))},a=s;n.default=a})(pM);var gM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M20 12v10H4V12M2 7h20v5H2zM12 22V7M12 7H7.5a2.5 2.5 0 010-5C11 2 12 7 12 7zM12 7h4.5a2.5 2.5 0 000-5C13 2 12 7 12 7z"}))},a=s;n.default=a})(gM);var mM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M6 3v12"}),r.default.createElement("circle",{cx:"18",cy:"6",r:"3"}),r.default.createElement("circle",{cx:"6",cy:"18",r:"3"}),r.default.createElement("path",{d:"M18 9a9 9 0 01-9 9"}))},a=s;n.default=a})(mM);var vM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"4"}),r.default.createElement("path",{d:"M1.05 12H7M17.01 12h5.95"}))},a=s;n.default=a})(vM);var EM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"18",cy:"18",r:"3"}),r.default.createElement("circle",{cx:"6",cy:"6",r:"3"}),r.default.createElement("path",{d:"M6 21V9a9 9 0 009 9"}))},a=s;n.default=a})(EM);var yM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"18",cy:"18",r:"3"}),r.default.createElement("circle",{cx:"6",cy:"6",r:"3"}),r.default.createElement("path",{d:"M13 6h3a2 2 0 012 2v7M6 9v12"}))},a=s;n.default=a})(yM);var TM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0020 4.77 5.07 5.07 0 0019.91 1S18.73.65 16 2.48a13.38 13.38 0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 005 4.77a5.44 5.44 0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 009 18.13V22"}))},a=s;n.default=a})(TM);var bM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M22.65 14.39L12 22.13 1.35 14.39a.84.84 0 01-.3-.94l1.22-3.78 2.44-7.51A.42.42 0 014.82 2a.43.43 0 01.58 0 .42.42 0 01.11.18l2.44 7.49h8.1l2.44-7.51A.42.42 0 0118.6 2a.43.43 0 01.58 0 .42.42 0 01.11.18l2.44 7.51L23 13.45a.84.84 0 01-.35.94z"}))},a=s;n.default=a})(bM);var CM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"}))},a=s;n.default=a})(CM);var AM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M3 3h7v7H3zM14 3h7v7h-7zM14 14h7v7h-7zM3 14h7v7H3z"}))},a=s;n.default=a})(AM);var SM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M22 12H2M5.45 5.11L2 12v6a2 2 0 002 2h16a2 2 0 002-2v-6l-3.45-6.89A2 2 0 0016.76 4H7.24a2 2 0 00-1.79 1.11zM6 16h.01M10 16h.01"}))},a=s;n.default=a})(SM);var RM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M4 9h16M4 15h16M10 3L8 21M16 3l-2 18"}))},a=s;n.default=a})(RM);var xM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M3 18v-6a9 9 0 0118 0v6"}),r.default.createElement("path",{d:"M21 19a2 2 0 01-2 2h-1a2 2 0 01-2-2v-3a2 2 0 012-2h3zM3 19a2 2 0 002 2h1a2 2 0 002-2v-3a2 2 0 00-2-2H3z"}))},a=s;n.default=a})(xM);var MM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:"",d:"M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"}))},a=s;n.default=a})(MM);var IM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:u,d:"M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"}))},a=s;n.default=a})(IM);var PM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3M12 17h.01"}))},a=s;n.default=a})(PM);var wM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"}))},a=s;n.default=a})(wM);var OM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"}),r.default.createElement("path",{d:"M9 22V12h6v10"}))},a=s;n.default=a})(OM);var DM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),r.default.createElement("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.default.createElement("path",{d:"M21 15l-5-5L5 21"}))},a=s;n.default=a})(DM);var LM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M22 12h-6l-2 3h-4l-2-3H2"}),r.default.createElement("path",{d:"M5.45 5.11L2 12v6a2 2 0 002 2h16a2 2 0 002-2v-6l-3.45-6.89A2 2 0 0016.76 4H7.24a2 2 0 00-1.79 1.11z"}))},a=s;n.default=a})(LM);var NM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M13.833 8.875S15.085 7 18.043 7C21 7 23 9.5 23 12s-1.784 5-4.864 5-4.914-3.124-6.136-5c-1.222-1.875-3.392-5-6.446-5S1 9.5 1 12s1.351 5 4.648 5c3.296 0 4.519-1.875 4.519-1.875"}))},a=s;n.default=a})(NM);var FM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10",fill:""}),r.default.createElement("path",{stroke:"",d:"M12 16v-4M12 8h.01"}))},a=s;n.default=a})(FM);var kM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10",fill:u}),r.default.createElement("path",{stroke:"var(--geist-icons-background)",d:"M12 16v-4M12 8h.01"}))},a=s;n.default=a})(kM);var BM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5"}),r.default.createElement("path",{d:"M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37zM17.5 6.5h.01"}))},a=s;n.default=a})(BM);var UM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M19 4h-9M14 20H5M15 4L9 20"}))},a=s;n.default=a})(UM);var zM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 11-7.778 7.778 5.5 5.5 0 017.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"}))},a=s;n.default=a})(zM);var VM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M6.998 3.5c-.216 0-.364.142-.364.314 0 .171.146.315.337.315l.228.002c.902.016 1.41.135 1.833.437.416.298.784.798 1.277 1.724l.227.44 1.591 3.543-.137.225-6.445 10.528a.299.299 0 00-.005.306c.057.1.167.164.288.166a.338.338 0 00.295-.158l6.334-10.347.392.852 3.042 6.627.496 1.126.11.236c.2.424.373.714.575.944.429.49.98.692 1.88.717l.182.004.08-.004a.321.321 0 00.286-.312c0-.17-.147-.314-.34-.314l-.193-.003c-.728-.02-1.094-.16-1.392-.501l-.06-.073a3.994 3.994 0 01-.41-.715c-.048-.1-.098-.208-.155-.336l-.447-1.017-3.696-8.052-1.662-3.698-.158-.31c-.574-1.103-1.016-1.714-1.553-2.098-.551-.396-1.19-.548-2.208-.566L6.998 3.5z"}))},a=s;n.default=a})(VM);var GM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"}))},a=s;n.default=a})(GM);var WM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M3 9h18M9 21V9"}))},a=s;n.default=a})(WM);var HM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("circle",{cx:"12",cy:"12",r:"4"}),r.default.createElement("path",{d:"M4.93 4.93l4.24 4.24M14.83 14.83l4.24 4.24M14.83 9.17l4.24-4.24M14.83 9.17l3.53-3.53M4.93 19.07l4.24-4.24"}))},a=s;n.default=a})(HM);var jM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3M8 12h8"}))},a=s;n.default=a})(jM);var XM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"}),r.default.createElement("path",{d:"M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"}))},a=s;n.default=a})(XM);var YM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6zM2 9h4v12H2z"}),r.default.createElement("circle",{cx:"4",cy:"4",r:"2"}))},a=s;n.default=a})(YM);var KM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01"}))},a=s;n.default=a})(KM);var qM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"}))},a=s;n.default=a})(qM);var $M={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M7 11V7a5 5 0 0110 0v4"}))},a=s;n.default=a})($M);var QM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M15 3h4a2 2 0 012 2v14a2 2 0 01-2 2h-4M10 17l5-5-5-5M15 12H3"}))},a=s;n.default=a})(QM);var ZM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"}))},a=s;n.default=a})(ZM);var JM={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),r.default.createElement("path",{d:"M22 6l-10 7L2 6"}))},a=s;n.default=a})(JM);var eI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"}),r.default.createElement("circle",{cx:"12",cy:"10",r:"3"}))},a=s;n.default=a})(eI);var tI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M1 6v16l7-4 8 4 7-4V2l-7 4-8-4-7 4zM8 2v16M16 6v16"}))},a=s;n.default=a})(tI);var iI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"}))},a=s;n.default=a})(iI);var rI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M8 3H5a2 2 0 00-2 2v3m18 0V5a2 2 0 00-2-2h-3m0 18h3a2 2 0 002-2v-3M3 16v3a2 2 0 002 2h3"}))},a=s;n.default=a})(rI);var nI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M8 15h8M9 9h.01M15 9h.01"}))},a=s;n.default=a})(nI);var sI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M3 12h18M3 6h18M3 18h18"}))},a=s;n.default=a})(sI);var aI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 11.5a8.38 8.38 0 01-.9 3.8 8.5 8.5 0 01-7.6 4.7 8.38 8.38 0 01-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 01-.9-3.8 8.5 8.5 0 014.7-7.6 8.38 8.38 0 013.8-.9h.5a8.48 8.48 0 018 8v.5z"}))},a=s;n.default=a})(aI);var oI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"}))},a=s;n.default=a})(oI);var lI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M1 1l22 22M9 9v3a3 3 0 005.12 2.12M15 9.34V4a3 3 0 00-5.94-.6"}),r.default.createElement("path",{d:"M17 16.95A7 7 0 015 12v-2m14 0v2a7 7 0 01-.11 1.23M12 19v4M8 23h8"}))},a=s;n.default=a})(lI);var cI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 1a3 3 0 00-3 3v8a3 3 0 006 0V4a3 3 0 00-3-3z"}),r.default.createElement("path",{d:"M19 10v2a7 7 0 01-14 0v-2M12 19v4M8 23h8"}))},a=s;n.default=a})(cI);var uI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M4 14h6v6M20 10h-6V4M14 10l7-7M3 21l7-7"}))},a=s;n.default=a})(uI);var hI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M8 3v3a2 2 0 01-2 2H3m18 0h-3a2 2 0 01-2-2V3m0 18v-3a2 2 0 012-2h3M3 16h3a2 2 0 012 2v3"}))},a=s;n.default=a})(hI);var dI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M8 12h8"}))},a=s;n.default=a})(dI);var fI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M8 12h8"}))},a=s;n.default=a})(fI);var _I={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M5 12h14"}))},a=s;n.default=a})(_I);var pI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M8 21h8M12 17v4"}))},a=s;n.default=a})(pI);var gI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"}))},a=s;n.default=a})(gI);var mI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"1",fill:"currentColor"}),r.default.createElement("circle",{cx:"19",cy:"12",r:"1",fill:"currentColor"}),r.default.createElement("circle",{cx:"5",cy:"12",r:"1",fill:"currentColor"}))},a=s;n.default=a})(mI);var vI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"1",fill:"currentColor"}),r.default.createElement("circle",{cx:"12",cy:"5",r:"1",fill:"currentColor"}),r.default.createElement("circle",{cx:"12",cy:"19",r:"1",fill:"currentColor"}))},a=s;n.default=a})(vI);var EI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3zM13 13l6 6"}))},a=s;n.default=a})(EI);var yI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M5 9l-3 3 3 3M9 5l3-3 3 3M15 19l-3 3-3-3M19 9l3 3-3 3M2 12h20M12 2v20"}))},a=s;n.default=a})(yI);var TI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M9 18V5l12-2v13"}),r.default.createElement("circle",{cx:"6",cy:"18",r:"3"}),r.default.createElement("circle",{cx:"18",cy:"16",r:"3"}))},a=s;n.default=a})(TI);var bI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 2l7 19-7-4-7 4 7-19z"}))},a=s;n.default=a})(bI);var CI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M3 11l19-9-9 19-2-8-8-2z"}))},a=s;n.default=a})(CI);var AI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M7.86 2h8.28L22 7.86v8.28L16.14 22H7.86L2 16.14V7.86L7.86 2z"}))},a=s;n.default=a})(AI);var SI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16.5 9.4l-9-5.19M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"}),r.default.createElement("path",{d:"M3.27 6.96L12 12.01l8.73-5.05M12 22.08V12"}))},a=s;n.default=a})(SI);var RI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 015.66 5.66l-9.2 9.19a2 2 0 01-2.83-2.83l8.49-8.48"}))},a=s;n.default=a})(RI);var xI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M10 15V9M14 15V9"}))},a=s;n.default=a})(xI);var MI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:"",d:"M6 4h4v16H6zM14 4h4v16h-4z"}))},a=s;n.default=a})(MI);var II={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:u,d:"M6 4h4v16H6zM14 4h4v16h-4z"}))},a=s;n.default=a})(II);var PI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 19l7-7 3 3-7 7-3-3z"}),r.default.createElement("path",{d:"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5zM2 2l7.586 7.586"}),r.default.createElement("circle",{cx:"11",cy:"11",r:"2"}))},a=s;n.default=a})(PI);var wI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M19 5L5 19"}),r.default.createElement("circle",{cx:"6.5",cy:"6.5",r:"2.5"}),r.default.createElement("circle",{cx:"17.5",cy:"17.5",r:"2.5"}))},a=s;n.default=a})(wI);var OI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M15.05 5A5 5 0 0119 8.95M15.05 1A9 9 0 0123 8.94m-1 7.98v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"}))},a=s;n.default=a})(OI);var DI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M19 1l4 4-4 4M15 5h8M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"}))},a=s;n.default=a})(DI);var LI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16 2v6h6M23 1l-7 7M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"}))},a=s;n.default=a})(LI);var NI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M23 1l-6 6M17 1l6 6M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"}))},a=s;n.default=a})(NI);var FI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M10.68 13.31a16 16 0 003.41 2.6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7 2 2 0 011.72 2v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.42 19.42 0 01-3.33-2.67m-2.67-3.34a19.79 19.79 0 01-3.07-8.63A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91M23 1L1 23"}))},a=s;n.default=a})(FI);var kI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M23 7V1h-6M16 8l7-7M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"}))},a=s;n.default=a})(kI);var BI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"}))},a=s;n.default=a})(BI);var UI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21.21 15.89A10 10 0 118 2.83M22 12A10 10 0 0012 2v10z"}))},a=s;n.default=a})(UI);var zI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M6.52 10.2l4.24 5.65m.01-9.9a2 2 0 000-2.83l-.7-.71L3 9.49l.7.7a1.998 1.998 0 002.83 0m4.24 5.66l5.66-5.66m-5.66 5.66s-1.76 2.47.71 4.95l9.89-9.9c-2.47-2.48-4.95-.7-4.95-.7m-5.65 5.65l5.65-5.65m0 0l-5.66-4.25m5.66 9.9l4.24 4.24"}))},a=s;n.default=a})(zI);var VI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M10 8l6 4-6 4V8z"}))},a=s;n.default=a})(VI);var GI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:"",d:"M5 3l14 9-14 9V3z"}))},a=s;n.default=a})(GI);var WI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{fill:u,d:"M5 3l14 9-14 9V3z"}))},a=s;n.default=a})(WI);var HI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M12 8v8M8 12h8"}))},a=s;n.default=a})(HI);var jI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M12 8v8M8 12h8"}))},a=s;n.default=a})(jI);var XI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 5v14M5 12h14"}))},a=s;n.default=a})(XI);var YI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M4 3h16a2 2 0 012 2v6a10 10 0 01-10 10A10 10 0 012 11V5a2 2 0 012-2z"}),r.default.createElement("path",{d:"M8 10l4 4 4-4"}))},a=s;n.default=a})(YI);var KI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M18.36 6.64a9 9 0 11-12.73 0M12 2v10"}))},a=s;n.default=a})(KI);var qI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M6 9V2h12v7M6 18H4a2 2 0 01-2-2v-5a2 2 0 012-2h16a2 2 0 012 2v5a2 2 0 01-2 2h-2"}),r.default.createElement("path",{d:"M6 14h12v8H6z"}))},a=s;n.default=a})(qI);var $I={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),r.default.createElement("path",{d:"M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3"}),r.default.createElement("circle",{cx:"12",cy:"17",r:".5"}))},a=s;n.default=a})($I);var QI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"2"}),r.default.createElement("path",{d:"M16.24 7.76a6 6 0 010 8.49m-8.48-.01a6 6 0 010-8.49m11.31-2.82a10 10 0 010 14.14m-14.14 0a10 10 0 010-14.14"}))},a=s;n.default=a})(QI);var ZI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M1 4v6h6M23 20v-6h-6"}),r.default.createElement("path",{d:"M20.49 9A9 9 0 005.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 013.51 15"}))},a=s;n.default=a})(ZI);var JI={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M23 4v6h-6M1 20v-6h6"}),r.default.createElement("path",{d:"M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"}))},a=s;n.default=a})(JI);var e2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M17 1l4 4-4 4"}),r.default.createElement("path",{d:"M3 11V9a4 4 0 014-4h14M7 23l-4-4 4-4"}),r.default.createElement("path",{d:"M21 13v2a4 4 0 01-4 4H3"}))},a=s;n.default=a})(e2);var t2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M11 19l-9-7 9-7v14zM22 19l-9-7 9-7v14z"}))},a=s;n.default=a})(t2);var i2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M1 4v6h6"}),r.default.createElement("path",{d:"M3.51 15a9 9 0 102.13-9.36L1 10"}))},a=s;n.default=a})(i2);var r2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M23 4v6h-6"}),r.default.createElement("path",{d:"M20.49 15a9 9 0 11-2.12-9.36L23 10"}))},a=s;n.default=a})(r2);var n2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M4 11a9 9 0 019 9M4 4a16 16 0 0116 16"}),r.default.createElement("circle",{cx:"5",cy:"19",r:"1"}))},a=s;n.default=a})(n2);var s2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),r.default.createElement("path",{d:"M17 21v-8H7v8M7 3v5h8"}))},a=s;n.default=a})(s2);var a2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"6",cy:"6",r:"3"}),r.default.createElement("circle",{cx:"6",cy:"18",r:"3"}),r.default.createElement("path",{d:"M20 4L8.12 15.88M14.47 14.48L20 20M8.12 8.12L12 12"}))},a=s;n.default=a})(a2);var o2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M11 17.25a6.25 6.25 0 110-12.5 6.25 6.25 0 010 12.5zM16 16l4.5 4.5"}))},a=s;n.default=a})(o2);var l2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"}))},a=s;n.default=a})(l2);var c2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2"}),r.default.createElement("rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M6 6h.01M6 18h.01"}))},a=s;n.default=a})(c2);var u2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"3"}),r.default.createElement("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"}))},a=s;n.default=a})(u2);var h2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"18",cy:"5",r:"3"}),r.default.createElement("circle",{cx:"6",cy:"12",r:"3"}),r.default.createElement("circle",{cx:"18",cy:"19",r:"3"}),r.default.createElement("path",{d:"M8.59 13.51l6.83 3.98M15.41 6.51l-6.82 3.98"}))},a=s;n.default=a})(h2);var d2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8M16 6l-4-4-4 4M12 2v13"}))},a=s;n.default=a})(d2);var f2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M19.69 14a6.9 6.9 0 00.31-2V5l-8-3-3.16 1.18M4.73 4.73L4 5v7c0 6 8 10 8 10a20.29 20.29 0 005.62-4.38M1 1l22 22"}))},a=s;n.default=a})(f2);var _2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}))},a=s;n.default=a})(_2);var p2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4zM3 6h18M16 10a4 4 0 01-8 0"}))},a=s;n.default=a})(p2);var g2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"9",cy:"21",r:"1"}),r.default.createElement("circle",{cx:"20",cy:"21",r:"1"}),r.default.createElement("path",{d:"M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"}))},a=s;n.default=a})(g2);var m2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16 3h5v5M4 20L21 3M21 16v5h-5M15 15l6 6M4 4l5 5"}))},a=s;n.default=a})(m2);var v2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M9 3v18"}))},a=s;n.default=a})(v2);var E2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M19 20L9 12l10-8v16zM5 19V5"}))},a=s;n.default=a})(E2);var y2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M5 4l10 8-10 8V4zM19 5v14"}))},a=s;n.default=a})(y2);var T2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M14.5 10c-.83 0-1.5-.67-1.5-1.5v-5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5zM20.5 10H19V8.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM9.5 14c.83 0 1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5S8 21.33 8 20.5v-5c0-.83.67-1.5 1.5-1.5zM3.5 14H5v1.5c0 .83-.67 1.5-1.5 1.5S2 16.33 2 15.5 2.67 14 3.5 14zM14 14.5c0-.83.67-1.5 1.5-1.5h5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-5c-.83 0-1.5-.67-1.5-1.5zM15.5 19H14v1.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zM10 9.5C10 8.67 9.33 8 8.5 8h-5C2.67 8 2 8.67 2 9.5S2.67 11 3.5 11h5c.83 0 1.5-.67 1.5-1.5zM8.5 5H10V3.5C10 2.67 9.33 2 8.5 2S7 2.67 7 3.5 7.67 5 8.5 5z"}))},a=s;n.default=a})(T2);var b2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M4.93 4.93l14.14 14.14"}))},a=s;n.default=a})(b2);var C2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M4 21v-7M4 10V3M12 21v-9M12 8V3M20 21v-5M20 12V3M1 14h6M9 8h6M17 16h6"}))},a=s;n.default=a})(C2);var A2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M12 18h.01"}))},a=s;n.default=a})(A2);var S2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M8 14s1.5 2 4 2 4-2 4-2M9 9h.01M15 9h.01"}))},a=s;n.default=a})(S2);var R2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2"}),r.default.createElement("circle",{cx:"12",cy:"14",r:"4"}),r.default.createElement("path",{d:"M12 6h.01"}))},a=s;n.default=a})(R2);var x2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}))},a=s;n.default=a})(x2);var M2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"}))},a=s;n.default=a})(M2);var I2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("path",{d:"M9 9h6v6H9z"}))},a=s;n.default=a})(I2);var P2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"5"}),r.default.createElement("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"}))},a=s;n.default=a})(P2);var w2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M17 18a5 5 0 00-10 0M12 2v7M4.22 10.22l1.42 1.42M1 18h2M21 18h2M18.36 11.64l1.42-1.42M23 22H1M8 6l4-4 4 4"}))},a=s;n.default=a})(w2);var O2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M17 18a5 5 0 00-10 0M12 9V2M4.22 10.22l1.42 1.42M1 18h2M21 18h2M18.36 11.64l1.42-1.42M23 22H1M16 5l-4 4-4-4"}))},a=s;n.default=a})(O2);var D2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M12 18h.01"}))},a=s;n.default=a})(D2);var L2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82zM7 7h.01"}))},a=s;n.default=a})(L2);var N2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.default.createElement("circle",{cx:"12",cy:"12",r:"6"}),r.default.createElement("circle",{cx:"12",cy:"12",r:"2"}))},a=s;n.default=a})(N2);var F2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M4 17l6-6-6-6M12 19h8"}))},a=s;n.default=a})(F2);var k2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M14 14.76V3.5a2.5 2.5 0 00-5 0v11.26a4.5 4.5 0 105 0z"}))},a=s;n.default=a})(k2);var B2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M10 15v4a3 3 0 003 3l4-9V2H5.72a2 2 0 00-2 1.7l-1.38 9a2 2 0 002 2.3zm7-13h2.67A2.31 2.31 0 0122 4v7a2.31 2.31 0 01-2.33 2H17"}))},a=s;n.default=a})(B2);var U2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M14 9V5a3 3 0 00-3-3l-4 9v11h11.28a2 2 0 002-1.7l1.38-9a2 2 0 00-2-2.3zM7 22H4a2 2 0 01-2-2v-7a2 2 0 012-2h3"}))},a=s;n.default=a})(U2);var z2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"22",height:"14",x:"1",y:"5",rx:"7",ry:"7"}),r.default.createElement("circle",{cx:"8",cy:"12",r:"3"}))},a=s;n.default=a})(z2);var V2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"22",height:"14",x:"1",y:"5",rx:"7",ry:"7"}),r.default.createElement("circle",{cx:"16",cy:"12",r:"3"}))},a=s;n.default=a})(V2);var G2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l3.77-3.77a6 6 0 01-7.94 7.94l-6.91 6.91a2.12 2.12 0 01-3-3l6.91-6.91a6 6 0 017.94-7.94l-3.76 3.76z"}))},a=s;n.default=a})(G2);var W2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2M10 11v6M14 11v6"}))},a=s;n.default=a})(W2);var H2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"}))},a=s;n.default=a})(H2);var j2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M7 7h3v9H7zM14 7h3v5h-3z"}))},a=s;n.default=a})(j2);var X2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M23 18l-9.5-9.5-5 5L1 6"}),r.default.createElement("path",{d:"M17 18h6v-6"}))},a=s;n.default=a})(X2);var Y2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M23 6l-9.5 9.5-5-5L1 18"}),r.default.createElement("path",{d:"M17 6h6v6"}))},a=s;n.default=a})(Y2);var K2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"}))},a=s;n.default=a})(K2);var q2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M1 3h15v13H1zM16 8h4l3 3v5h-7V8z"}),r.default.createElement("circle",{cx:"5.5",cy:"18.5",r:"2.5"}),r.default.createElement("circle",{cx:"18.5",cy:"18.5",r:"2.5"}))},a=s;n.default=a})(q2);var $2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"20",height:"15",x:"2",y:"7",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M17 2l-5 5-5-5"}))},a=s;n.default=a})($2);var Q2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 2H3v16h5v4l4-4h5l4-4V2zm-10 9V7m5 4V7"}))},a=s;n.default=a})(Q2);var Z2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"}))},a=s;n.default=a})(Z2);var J2={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M4 7V4h16v3M9 20h6M12 4v16"}))},a=s;n.default=a})(J2);var eP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M23 12a11.05 11.05 0 00-22 0zm-5 7a3 3 0 01-6 0v-7"}))},a=s;n.default=a})(eP);var tP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M6 3v7a6 6 0 006 6 6 6 0 006-6V3M4 21h16"}))},a=s;n.default=a})(tP);var iP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M7 11V7a5 5 0 019.9-1"}))},a=s;n.default=a})(iP);var rP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16 16l-4-4-4 4M12 12v9"}),r.default.createElement("path",{d:"M20.39 18.39A5 5 0 0018 9h-1.26A8 8 0 103 16.3"}),r.default.createElement("path",{d:"M16 16l-4-4-4 4"}))},a=s;n.default=a})(rP);var nP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12"}))},a=s;n.default=a})(nP);var sP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),r.default.createElement("circle",{cx:"8.5",cy:"7",r:"4"}),r.default.createElement("path",{d:"M17 11l2 2 4-4"}))},a=s;n.default=a})(sP);var aP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),r.default.createElement("circle",{cx:"8.5",cy:"7",r:"4"}),r.default.createElement("path",{d:"M23 11h-6"}))},a=s;n.default=a})(aP);var oP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),r.default.createElement("circle",{cx:"8.5",cy:"7",r:"4"}),r.default.createElement("path",{d:"M20 8v6M23 11h-6"}))},a=s;n.default=a})(oP);var lP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),r.default.createElement("circle",{cx:"8.5",cy:"7",r:"4"}),r.default.createElement("path",{d:"M18 8l5 5M23 8l-5 5"}))},a=s;n.default=a})(lP);var cP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"}),r.default.createElement("circle",{cx:"12",cy:"7",r:"4"}))},a=s;n.default=a})(cP);var uP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),r.default.createElement("circle",{cx:"9",cy:"7",r:"4"}),r.default.createElement("path",{d:"M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"}))},a=s;n.default=a})(uP);var hP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M16 16v1a2 2 0 01-2 2H3a2 2 0 01-2-2V7a2 2 0 012-2h2m5.66 0H14a2 2 0 012 2v3.34l1 1L23 7v10M1 1l22 22"}))},a=s;n.default=a})(hP);var dP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M23 7l-7 5 7 5V7z"}),r.default.createElement("rect",{width:"15",height:"14",x:"1",y:"5",rx:"2",ry:"2"}))},a=s;n.default=a})(dP);var fP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"5.5",cy:"11.5",r:"4.5"}),r.default.createElement("circle",{cx:"18.5",cy:"11.5",r:"4.5"}),r.default.createElement("path",{d:"M5.5 16h13"}))},a=s;n.default=a})(fP);var _P={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M11 5L6 9H2v6h4l5 4V5zM15.54 8.46a5 5 0 010 7.07"}))},a=s;n.default=a})(_P);var pP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M11 5L6 9H2v6h4l5 4V5zM19.07 4.93a10 10 0 010 14.14M15.54 8.46a5 5 0 010 7.07"}))},a=s;n.default=a})(pP);var gP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M11 5L6 9H2v6h4l5 4V5zM23 9l-6 6M17 9l6 6"}))},a=s;n.default=a})(gP);var mP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M11 5L6 9H2v6h4l5 4V5z"}))},a=s;n.default=a})(mP);var vP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"7"}),r.default.createElement("path",{d:"M12 9v3l1.5 1.5M16.51 17.35l-.35 3.83a2 2 0 01-2 1.82H9.83a2 2 0 01-2-1.82l-.35-3.83m.01-10.7l.35-3.83A2 2 0 019.83 1h4.35a2 2 0 012 1.82l.35 3.83"}))},a=s;n.default=a})(vP);var EP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M1 1l22 22M16.72 11.06A10.94 10.94 0 0119 12.55M5 12.55a10.94 10.94 0 015.17-2.39M10.71 5.05A16 16 0 0122.58 9M1.42 9a15.91 15.91 0 014.7-2.88M8.53 16.11a6 6 0 016.95 0M12 20h.01"}))},a=s;n.default=a})(EP);var yP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M5 12.55a11 11 0 0114.08 0M1.42 9a16 16 0 0121.16 0M8.53 16.11a6 6 0 016.95 0M12 20h.01"}))},a=s;n.default=a})(yP);var TP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M9.59 4.59A2 2 0 1111 8H2m10.59 11.41A2 2 0 1014 16H2m15.73-8.27A2.5 2.5 0 1119.5 12H2"}))},a=s;n.default=a})(TP);var bP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10",fill:""}),r.default.createElement("path",{stroke:"",d:"M15 9l-6 6M9 9l6 6"}))},a=s;n.default=a})(bP);var CP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"12",cy:"12",r:"10",fill:u}),r.default.createElement("path",{stroke:"var(--geist-icons-background)",d:"M15 9l-6 6M9 9l6 6"}))},a=s;n.default=a})(CP);var AP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M7.86 2h8.28L22 7.86v8.28L16.14 22H7.86L2 16.14V7.86L7.86 2zM15 9l-6 6M9 9l6 6"}))},a=s;n.default=a})(AP);var SP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),r.default.createElement("path",{d:"M9 9l6 6M15 9l-6 6"}))},a=s;n.default=a})(SP);var RP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M18 6L6 18M6 6l12 12"}))},a=s;n.default=a})(RP);var xP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M22.54 6.42a2.78 2.78 0 00-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 00-1.94 2A29 29 0 001 11.75a29 29 0 00.46 5.33A2.78 2.78 0 003.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 001.94-2 29 29 0 00.46-5.25 29 29 0 00-.46-5.33z"}),r.default.createElement("path",{d:"M9.75 15.02l5.75-3.27-5.75-3.27v6.54z"}))},a=s;n.default=a})(xP);var MP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M12.41 6.75L13 2l-2.43 2.92M18.57 12.91L21 10h-5.34M8 8l-5 6h9l-1 8 5-6M1 1l22 22"}))},a=s;n.default=a})(MP);var IP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"}))},a=s;n.default=a})(IP);var PP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("path",{d:"M2.625 21.3L21.299 2.624M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10z"}))},a=s;n.default=a})(PP);var wP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"11",cy:"11",r:"8"}),r.default.createElement("path",{d:"M21 21l-4.35-4.35M11 8v6M8 11h6"}))},a=s;n.default=a})(wP);var OP={};(function(n){var e=D;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(L()),i=e(N()),r=e(S),s=function(o){var c=o.color,u=c===void 0?"currentColor":c,h=o.size,d=h===void 0?24:h,f=(0,i.default)(o,["color","size"]);return r.default.createElement("svg",(0,t.default)({fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",shapeRendering:"geometricPrecision",viewBox:"0 0 24 24"},f,{height:d,width:d,style:{color:u}}),r.default.createElement("circle",{cx:"11",cy:"11",r:"8"}),r.default.createElement("path",{d:"M21 21l-4.35-4.35M8 11h6"}))},a=s;n.default=a})(OP);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Activity",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"Airplay",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"AlertCircle",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"AlertCircleFill",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"AlertOctagon",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"AlertTriangle",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"AlertTriangleFill",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(n,"AlignCenter",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"AlignJustify",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(n,"AlignLeft",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(n,"AlignRight",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(n,"Anchor",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(n,"Aperture",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(n,"Archive",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(n,"ArrowDownCircle",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(n,"ArrowDownLeft",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(n,"ArrowDownRight",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(n,"ArrowDown",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(n,"ArrowLeftCircle",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(n,"ArrowLeft",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(n,"ArrowRightCircle",{enumerable:!0,get:function(){return T.default}}),Object.defineProperty(n,"ArrowRightCircleFill",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(n,"ArrowRight",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(n,"ArrowUpCircle",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(n,"ArrowUpLeft",{enumerable:!0,get:function(){return F.default}}),Object.defineProperty(n,"ArrowUpRight",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(n,"ArrowUp",{enumerable:!0,get:function(){return U.default}}),Object.defineProperty(n,"AtSign",{enumerable:!0,get:function(){return G.default}}),Object.defineProperty(n,"Award",{enumerable:!0,get:function(){return K.default}}),Object.defineProperty(n,"BarChart2",{enumerable:!0,get:function(){return q.default}}),Object.defineProperty(n,"BarChart",{enumerable:!0,get:function(){return se.default}}),Object.defineProperty(n,"BatteryCharging",{enumerable:!0,get:function(){return Ee.default}}),Object.defineProperty(n,"Battery",{enumerable:!0,get:function(){return Se.default}}),Object.defineProperty(n,"BellOff",{enumerable:!0,get:function(){return $.default}}),Object.defineProperty(n,"Bell",{enumerable:!0,get:function(){return _e.default}}),Object.defineProperty(n,"Bluetooth",{enumerable:!0,get:function(){return ae.default}}),Object.defineProperty(n,"Bold",{enumerable:!0,get:function(){return ce.default}}),Object.defineProperty(n,"BookOpen",{enumerable:!0,get:function(){return he.default}}),Object.defineProperty(n,"Book",{enumerable:!0,get:function(){return je.default}}),Object.defineProperty(n,"Bookmark",{enumerable:!0,get:function(){return Xe.default}}),Object.defineProperty(n,"Box",{enumerable:!0,get:function(){return Tt.default}}),Object.defineProperty(n,"Briefcase",{enumerable:!0,get:function(){return Ze.default}}),Object.defineProperty(n,"Calendar",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(n,"CameraOff",{enumerable:!0,get:function(){return pe.default}}),Object.defineProperty(n,"Camera",{enumerable:!0,get:function(){return De.default}}),Object.defineProperty(n,"Cast",{enumerable:!0,get:function(){return ft.default}}),Object.defineProperty(n,"CheckCircle",{enumerable:!0,get:function(){return st.default}}),Object.defineProperty(n,"CheckInCircle",{enumerable:!0,get:function(){return $e.default}}),Object.defineProperty(n,"CheckInCircleFill",{enumerable:!0,get:function(){return bt.default}}),Object.defineProperty(n,"CheckSquare",{enumerable:!0,get:function(){return Wt.default}}),Object.defineProperty(n,"Check",{enumerable:!0,get:function(){return rt.default}}),Object.defineProperty(n,"Checkbox",{enumerable:!0,get:function(){return Ht.default}}),Object.defineProperty(n,"CheckboxFill",{enumerable:!0,get:function(){return Ni.default}}),Object.defineProperty(n,"ChevronDownCircle",{enumerable:!0,get:function(){return Ar.default}}),Object.defineProperty(n,"ChevronDownCircleFill",{enumerable:!0,get:function(){return $s.default}}),Object.defineProperty(n,"ChevronDown",{enumerable:!0,get:function(){return jo.default}}),Object.defineProperty(n,"ChevronLeftCircle",{enumerable:!0,get:function(){return ds.default}}),Object.defineProperty(n,"ChevronLeftCircleFill",{enumerable:!0,get:function(){return Hr.default}}),Object.defineProperty(n,"ChevronLeft",{enumerable:!0,get:function(){return jr.default}}),Object.defineProperty(n,"ChevronRightCircle",{enumerable:!0,get:function(){return Yn.default}}),Object.defineProperty(n,"ChevronRightCircleFill",{enumerable:!0,get:function(){return fs.default}}),Object.defineProperty(n,"ChevronRight",{enumerable:!0,get:function(){return Fr.default}}),Object.defineProperty(n,"ChevronUpCircle",{enumerable:!0,get:function(){return _s.default}}),Object.defineProperty(n,"ChevronUpCircleFill",{enumerable:!0,get:function(){return Xo.default}}),Object.defineProperty(n,"ChevronUpDown",{enumerable:!0,get:function(){return Qs.default}}),Object.defineProperty(n,"ChevronUp",{enumerable:!0,get:function(){return Kn.default}}),Object.defineProperty(n,"ChevronsDown",{enumerable:!0,get:function(){return ur.default}}),Object.defineProperty(n,"ChevronsLeft",{enumerable:!0,get:function(){return $a.default}}),Object.defineProperty(n,"ChevronsRight",{enumerable:!0,get:function(){return Zs.default}}),Object.defineProperty(n,"ChevronsUp",{enumerable:!0,get:function(){return Qa.default}}),Object.defineProperty(n,"Chrome",{enumerable:!0,get:function(){return fc.default}}),Object.defineProperty(n,"Circle",{enumerable:!0,get:function(){return Yo.default}}),Object.defineProperty(n,"Clipboard",{enumerable:!0,get:function(){return Ai.default}}),Object.defineProperty(n,"Clock",{enumerable:!0,get:function(){return Ko.default}}),Object.defineProperty(n,"CloudDrizzle",{enumerable:!0,get:function(){return qo.default}}),Object.defineProperty(n,"CloudLightning",{enumerable:!0,get:function(){return Js.default}}),Object.defineProperty(n,"CloudOff",{enumerable:!0,get:function(){return ea.default}}),Object.defineProperty(n,"CloudRain",{enumerable:!0,get:function(){return ta.default}}),Object.defineProperty(n,"CloudSnow",{enumerable:!0,get:function(){return Za.default}}),Object.defineProperty(n,"Cloud",{enumerable:!0,get:function(){return _c.default}}),Object.defineProperty(n,"Code",{enumerable:!0,get:function(){return H.default}}),Object.defineProperty(n,"Codepen",{enumerable:!0,get:function(){return J.default}}),Object.defineProperty(n,"Codesandbox",{enumerable:!0,get:function(){return oe.default}}),Object.defineProperty(n,"Coffee",{enumerable:!0,get:function(){return Ce.default}}),Object.defineProperty(n,"Columns",{enumerable:!0,get:function(){return Be.default}}),Object.defineProperty(n,"Command",{enumerable:!0,get:function(){return nt.default}}),Object.defineProperty(n,"Compass",{enumerable:!0,get:function(){return Ke.default}}),Object.defineProperty(n,"Copy",{enumerable:!0,get:function(){return Ve.default}}),Object.defineProperty(n,"CornerDownLeft",{enumerable:!0,get:function(){return at.default}}),Object.defineProperty(n,"CornerDownRight",{enumerable:!0,get:function(){return Je.default}}),Object.defineProperty(n,"CornerLeftDown",{enumerable:!0,get:function(){return Hi.default}}),Object.defineProperty(n,"CornerLeftUp",{enumerable:!0,get:function(){return ji.default}}),Object.defineProperty(n,"CornerRightDown",{enumerable:!0,get:function(){return Qe.default}}),Object.defineProperty(n,"CornerRightUp",{enumerable:!0,get:function(){return ii.default}}),Object.defineProperty(n,"CornerUpLeft",{enumerable:!0,get:function(){return Fi.default}}),Object.defineProperty(n,"CornerUpRight",{enumerable:!0,get:function(){return Ja.default}}),Object.defineProperty(n,"Cpu",{enumerable:!0,get:function(){return qn.default}}),Object.defineProperty(n,"CreditCard",{enumerable:!0,get:function(){return ia.default}}),Object.defineProperty(n,"Crop",{enumerable:!0,get:function(){return ra.default}}),Object.defineProperty(n,"Crosshair",{enumerable:!0,get:function(){return na.default}}),Object.defineProperty(n,"Database",{enumerable:!0,get:function(){return sn.default}}),Object.defineProperty(n,"Delete",{enumerable:!0,get:function(){return $o.default}}),Object.defineProperty(n,"Disc",{enumerable:!0,get:function(){return Qo.default}}),Object.defineProperty(n,"Display",{enumerable:!0,get:function(){return Zo.default}}),Object.defineProperty(n,"Divider",{enumerable:!0,get:function(){return St.default}}),Object.defineProperty(n,"DollarSign",{enumerable:!0,get:function(){return hr.default}}),Object.defineProperty(n,"DownloadCloud",{enumerable:!0,get:function(){return kr.default}}),Object.defineProperty(n,"Download",{enumerable:!0,get:function(){return Xi.default}}),Object.defineProperty(n,"Droplet",{enumerable:!0,get:function(){return eo.default}}),Object.defineProperty(n,"Edit2",{enumerable:!0,get:function(){return rh.default}}),Object.defineProperty(n,"Edit3",{enumerable:!0,get:function(){return S_.default}}),Object.defineProperty(n,"Edit",{enumerable:!0,get:function(){return DP.default}}),Object.defineProperty(n,"Emoji",{enumerable:!0,get:function(){return LP.default}}),Object.defineProperty(n,"ExternalLink",{enumerable:!0,get:function(){return NP.default}}),Object.defineProperty(n,"EyeOff",{enumerable:!0,get:function(){return FP.default}}),Object.defineProperty(n,"Eye",{enumerable:!0,get:function(){return kP.default}}),Object.defineProperty(n,"Facebook",{enumerable:!0,get:function(){return BP.default}}),Object.defineProperty(n,"FastForward",{enumerable:!0,get:function(){return UP.default}}),Object.defineProperty(n,"Feather",{enumerable:!0,get:function(){return zP.default}}),Object.defineProperty(n,"Figma",{enumerable:!0,get:function(){return VP.default}}),Object.defineProperty(n,"FileFunction",{enumerable:!0,get:function(){return GP.default}}),Object.defineProperty(n,"FileFunctionFill",{enumerable:!0,get:function(){return WP.default}}),Object.defineProperty(n,"FileLambda",{enumerable:!0,get:function(){return HP.default}}),Object.defineProperty(n,"FileLambdaFill",{enumerable:!0,get:function(){return jP.default}}),Object.defineProperty(n,"FileMinus",{enumerable:!0,get:function(){return XP.default}}),Object.defineProperty(n,"FilePlus",{enumerable:!0,get:function(){return YP.default}}),Object.defineProperty(n,"FileText",{enumerable:!0,get:function(){return KP.default}}),Object.defineProperty(n,"File",{enumerable:!0,get:function(){return qP.default}}),Object.defineProperty(n,"Film",{enumerable:!0,get:function(){return $P.default}}),Object.defineProperty(n,"Filter",{enumerable:!0,get:function(){return QP.default}}),Object.defineProperty(n,"Flag",{enumerable:!0,get:function(){return ZP.default}}),Object.defineProperty(n,"FolderMinus",{enumerable:!0,get:function(){return JP.default}}),Object.defineProperty(n,"FolderPlus",{enumerable:!0,get:function(){return ew.default}}),Object.defineProperty(n,"Folder",{enumerable:!0,get:function(){return tw.default}}),Object.defineProperty(n,"Framer",{enumerable:!0,get:function(){return iw.default}}),Object.defineProperty(n,"Frown",{enumerable:!0,get:function(){return rw.default}}),Object.defineProperty(n,"FullScreenClose",{enumerable:!0,get:function(){return nw.default}}),Object.defineProperty(n,"FullScreen",{enumerable:!0,get:function(){return sw.default}}),Object.defineProperty(n,"Function",{enumerable:!0,get:function(){return aw.default}}),Object.defineProperty(n,"Gift",{enumerable:!0,get:function(){return ow.default}}),Object.defineProperty(n,"GitBranch",{enumerable:!0,get:function(){return lw.default}}),Object.defineProperty(n,"GitCommit",{enumerable:!0,get:function(){return cw.default}}),Object.defineProperty(n,"GitMerge",{enumerable:!0,get:function(){return uw.default}}),Object.defineProperty(n,"GitPullRequest",{enumerable:!0,get:function(){return hw.default}}),Object.defineProperty(n,"Github",{enumerable:!0,get:function(){return dw.default}}),Object.defineProperty(n,"Gitlab",{enumerable:!0,get:function(){return fw.default}}),Object.defineProperty(n,"Globe",{enumerable:!0,get:function(){return _w.default}}),Object.defineProperty(n,"Grid",{enumerable:!0,get:function(){return pw.default}}),Object.defineProperty(n,"HardDrive",{enumerable:!0,get:function(){return gw.default}}),Object.defineProperty(n,"Hash",{enumerable:!0,get:function(){return mw.default}}),Object.defineProperty(n,"Headphones",{enumerable:!0,get:function(){return vw.default}}),Object.defineProperty(n,"Heart",{enumerable:!0,get:function(){return Ew.default}}),Object.defineProperty(n,"HeartFill",{enumerable:!0,get:function(){return yw.default}}),Object.defineProperty(n,"HelpCircle",{enumerable:!0,get:function(){return Tw.default}}),Object.defineProperty(n,"Hexagon",{enumerable:!0,get:function(){return bw.default}}),Object.defineProperty(n,"Home",{enumerable:!0,get:function(){return Cw.default}}),Object.defineProperty(n,"Image",{enumerable:!0,get:function(){return Aw.default}}),Object.defineProperty(n,"Inbox",{enumerable:!0,get:function(){return Sw.default}}),Object.defineProperty(n,"Infinity",{enumerable:!0,get:function(){return Rw.default}}),Object.defineProperty(n,"Info",{enumerable:!0,get:function(){return xw.default}}),Object.defineProperty(n,"InfoFill",{enumerable:!0,get:function(){return Mw.default}}),Object.defineProperty(n,"Instagram",{enumerable:!0,get:function(){return Iw.default}}),Object.defineProperty(n,"Italic",{enumerable:!0,get:function(){return Pw.default}}),Object.defineProperty(n,"Key",{enumerable:!0,get:function(){return ww.default}}),Object.defineProperty(n,"Lambda",{enumerable:!0,get:function(){return Ow.default}}),Object.defineProperty(n,"Layers",{enumerable:!0,get:function(){return Dw.default}}),Object.defineProperty(n,"Layout",{enumerable:!0,get:function(){return Lw.default}}),Object.defineProperty(n,"LifeBuoy",{enumerable:!0,get:function(){return Nw.default}}),Object.defineProperty(n,"Link2",{enumerable:!0,get:function(){return Fw.default}}),Object.defineProperty(n,"Link",{enumerable:!0,get:function(){return kw.default}}),Object.defineProperty(n,"Linkedin",{enumerable:!0,get:function(){return Bw.default}}),Object.defineProperty(n,"List",{enumerable:!0,get:function(){return Uw.default}}),Object.defineProperty(n,"Loader",{enumerable:!0,get:function(){return zw.default}}),Object.defineProperty(n,"Lock",{enumerable:!0,get:function(){return Vw.default}}),Object.defineProperty(n,"LogIn",{enumerable:!0,get:function(){return Gw.default}}),Object.defineProperty(n,"LogOut",{enumerable:!0,get:function(){return Ww.default}}),Object.defineProperty(n,"Mail",{enumerable:!0,get:function(){return Hw.default}}),Object.defineProperty(n,"MapPin",{enumerable:!0,get:function(){return jw.default}}),Object.defineProperty(n,"Map",{enumerable:!0,get:function(){return Xw.default}}),Object.defineProperty(n,"Maximize2",{enumerable:!0,get:function(){return Yw.default}}),Object.defineProperty(n,"Maximize",{enumerable:!0,get:function(){return Kw.default}}),Object.defineProperty(n,"Meh",{enumerable:!0,get:function(){return qw.default}}),Object.defineProperty(n,"Menu",{enumerable:!0,get:function(){return $w.default}}),Object.defineProperty(n,"MessageCircle",{enumerable:!0,get:function(){return Qw.default}}),Object.defineProperty(n,"MessageSquare",{enumerable:!0,get:function(){return Zw.default}}),Object.defineProperty(n,"MicOff",{enumerable:!0,get:function(){return Jw.default}}),Object.defineProperty(n,"Mic",{enumerable:!0,get:function(){return eO.default}}),Object.defineProperty(n,"Minimize2",{enumerable:!0,get:function(){return tO.default}}),Object.defineProperty(n,"Minimize",{enumerable:!0,get:function(){return iO.default}}),Object.defineProperty(n,"MinusCircle",{enumerable:!0,get:function(){return rO.default}}),Object.defineProperty(n,"MinusSquare",{enumerable:!0,get:function(){return nO.default}}),Object.defineProperty(n,"Minus",{enumerable:!0,get:function(){return sO.default}}),Object.defineProperty(n,"Monitor",{enumerable:!0,get:function(){return aO.default}}),Object.defineProperty(n,"Moon",{enumerable:!0,get:function(){return oO.default}}),Object.defineProperty(n,"MoreHorizontal",{enumerable:!0,get:function(){return lO.default}}),Object.defineProperty(n,"MoreVertical",{enumerable:!0,get:function(){return cO.default}}),Object.defineProperty(n,"MousePointer",{enumerable:!0,get:function(){return uO.default}}),Object.defineProperty(n,"Move",{enumerable:!0,get:function(){return hO.default}}),Object.defineProperty(n,"Music",{enumerable:!0,get:function(){return dO.default}}),Object.defineProperty(n,"Navigation2",{enumerable:!0,get:function(){return fO.default}}),Object.defineProperty(n,"Navigation",{enumerable:!0,get:function(){return _O.default}}),Object.defineProperty(n,"Octagon",{enumerable:!0,get:function(){return pO.default}}),Object.defineProperty(n,"Package",{enumerable:!0,get:function(){return gO.default}}),Object.defineProperty(n,"Paperclip",{enumerable:!0,get:function(){return mO.default}}),Object.defineProperty(n,"PauseCircle",{enumerable:!0,get:function(){return vO.default}}),Object.defineProperty(n,"Pause",{enumerable:!0,get:function(){return EO.default}}),Object.defineProperty(n,"PauseFill",{enumerable:!0,get:function(){return yO.default}}),Object.defineProperty(n,"PenTool",{enumerable:!0,get:function(){return TO.default}}),Object.defineProperty(n,"Percent",{enumerable:!0,get:function(){return bO.default}}),Object.defineProperty(n,"PhoneCall",{enumerable:!0,get:function(){return CO.default}}),Object.defineProperty(n,"PhoneForwarded",{enumerable:!0,get:function(){return AO.default}}),Object.defineProperty(n,"PhoneIncoming",{enumerable:!0,get:function(){return SO.default}}),Object.defineProperty(n,"PhoneMissed",{enumerable:!0,get:function(){return RO.default}}),Object.defineProperty(n,"PhoneOff",{enumerable:!0,get:function(){return xO.default}}),Object.defineProperty(n,"PhoneOutgoing",{enumerable:!0,get:function(){return MO.default}}),Object.defineProperty(n,"Phone",{enumerable:!0,get:function(){return IO.default}}),Object.defineProperty(n,"PieChart",{enumerable:!0,get:function(){return PO.default}}),Object.defineProperty(n,"Pin",{enumerable:!0,get:function(){return wO.default}}),Object.defineProperty(n,"PlayCircle",{enumerable:!0,get:function(){return OO.default}}),Object.defineProperty(n,"Play",{enumerable:!0,get:function(){return DO.default}}),Object.defineProperty(n,"PlayFill",{enumerable:!0,get:function(){return LO.default}}),Object.defineProperty(n,"PlusCircle",{enumerable:!0,get:function(){return NO.default}}),Object.defineProperty(n,"PlusSquare",{enumerable:!0,get:function(){return FO.default}}),Object.defineProperty(n,"Plus",{enumerable:!0,get:function(){return kO.default}}),Object.defineProperty(n,"Pocket",{enumerable:!0,get:function(){return BO.default}}),Object.defineProperty(n,"Power",{enumerable:!0,get:function(){return UO.default}}),Object.defineProperty(n,"Printer",{enumerable:!0,get:function(){return zO.default}}),Object.defineProperty(n,"QuestionCircle",{enumerable:!0,get:function(){return VO.default}}),Object.defineProperty(n,"Radio",{enumerable:!0,get:function(){return GO.default}}),Object.defineProperty(n,"RefreshCcw",{enumerable:!0,get:function(){return WO.default}}),Object.defineProperty(n,"RefreshCw",{enumerable:!0,get:function(){return HO.default}}),Object.defineProperty(n,"Repeat",{enumerable:!0,get:function(){return jO.default}}),Object.defineProperty(n,"Rewind",{enumerable:!0,get:function(){return XO.default}}),Object.defineProperty(n,"RotateCcw",{enumerable:!0,get:function(){return YO.default}}),Object.defineProperty(n,"RotateCw",{enumerable:!0,get:function(){return KO.default}}),Object.defineProperty(n,"Rss",{enumerable:!0,get:function(){return qO.default}}),Object.defineProperty(n,"Save",{enumerable:!0,get:function(){return $O.default}}),Object.defineProperty(n,"Scissors",{enumerable:!0,get:function(){return QO.default}}),Object.defineProperty(n,"Search",{enumerable:!0,get:function(){return ZO.default}}),Object.defineProperty(n,"Send",{enumerable:!0,get:function(){return JO.default}}),Object.defineProperty(n,"Server",{enumerable:!0,get:function(){return eD.default}}),Object.defineProperty(n,"Settings",{enumerable:!0,get:function(){return tD.default}}),Object.defineProperty(n,"Share2",{enumerable:!0,get:function(){return iD.default}}),Object.defineProperty(n,"Share",{enumerable:!0,get:function(){return rD.default}}),Object.defineProperty(n,"ShieldOff",{enumerable:!0,get:function(){return nD.default}}),Object.defineProperty(n,"Shield",{enumerable:!0,get:function(){return sD.default}}),Object.defineProperty(n,"ShoppingBag",{enumerable:!0,get:function(){return aD.default}}),Object.defineProperty(n,"ShoppingCart",{enumerable:!0,get:function(){return oD.default}}),Object.defineProperty(n,"Shuffle",{enumerable:!0,get:function(){return lD.default}}),Object.defineProperty(n,"Sidebar",{enumerable:!0,get:function(){return cD.default}}),Object.defineProperty(n,"SkipBack",{enumerable:!0,get:function(){return uD.default}}),Object.defineProperty(n,"SkipForward",{enumerable:!0,get:function(){return hD.default}}),Object.defineProperty(n,"Slack",{enumerable:!0,get:function(){return dD.default}}),Object.defineProperty(n,"Slash",{enumerable:!0,get:function(){return fD.default}}),Object.defineProperty(n,"Sliders",{enumerable:!0,get:function(){return _D.default}}),Object.defineProperty(n,"Smartphone",{enumerable:!0,get:function(){return pD.default}}),Object.defineProperty(n,"Smile",{enumerable:!0,get:function(){return gD.default}}),Object.defineProperty(n,"Speaker",{enumerable:!0,get:function(){return mD.default}}),Object.defineProperty(n,"Square",{enumerable:!0,get:function(){return vD.default}}),Object.defineProperty(n,"Star",{enumerable:!0,get:function(){return ED.default}}),Object.defineProperty(n,"StopCircle",{enumerable:!0,get:function(){return yD.default}}),Object.defineProperty(n,"Sun",{enumerable:!0,get:function(){return TD.default}}),Object.defineProperty(n,"Sunrise",{enumerable:!0,get:function(){return bD.default}}),Object.defineProperty(n,"Sunset",{enumerable:!0,get:function(){return CD.default}}),Object.defineProperty(n,"Tablet",{enumerable:!0,get:function(){return AD.default}}),Object.defineProperty(n,"Tag",{enumerable:!0,get:function(){return SD.default}}),Object.defineProperty(n,"Target",{enumerable:!0,get:function(){return RD.default}}),Object.defineProperty(n,"Terminal",{enumerable:!0,get:function(){return xD.default}}),Object.defineProperty(n,"Thermometer",{enumerable:!0,get:function(){return MD.default}}),Object.defineProperty(n,"ThumbsDown",{enumerable:!0,get:function(){return ID.default}}),Object.defineProperty(n,"ThumbsUp",{enumerable:!0,get:function(){return PD.default}}),Object.defineProperty(n,"ToggleLeft",{enumerable:!0,get:function(){return wD.default}}),Object.defineProperty(n,"ToggleRight",{enumerable:!0,get:function(){return OD.default}}),Object.defineProperty(n,"Tool",{enumerable:!0,get:function(){return DD.default}}),Object.defineProperty(n,"Trash2",{enumerable:!0,get:function(){return LD.default}}),Object.defineProperty(n,"Trash",{enumerable:!0,get:function(){return ND.default}}),Object.defineProperty(n,"Trello",{enumerable:!0,get:function(){return FD.default}}),Object.defineProperty(n,"TrendingDown",{enumerable:!0,get:function(){return kD.default}}),Object.defineProperty(n,"TrendingUp",{enumerable:!0,get:function(){return BD.default}}),Object.defineProperty(n,"Triangle",{enumerable:!0,get:function(){return UD.default}}),Object.defineProperty(n,"Truck",{enumerable:!0,get:function(){return zD.default}}),Object.defineProperty(n,"Tv",{enumerable:!0,get:function(){return VD.default}}),Object.defineProperty(n,"Twitch",{enumerable:!0,get:function(){return GD.default}}),Object.defineProperty(n,"Twitter",{enumerable:!0,get:function(){return WD.default}}),Object.defineProperty(n,"Type",{enumerable:!0,get:function(){return HD.default}}),Object.defineProperty(n,"Umbrella",{enumerable:!0,get:function(){return jD.default}}),Object.defineProperty(n,"Underline",{enumerable:!0,get:function(){return XD.default}}),Object.defineProperty(n,"Unlock",{enumerable:!0,get:function(){return YD.default}}),Object.defineProperty(n,"UploadCloud",{enumerable:!0,get:function(){return KD.default}}),Object.defineProperty(n,"Upload",{enumerable:!0,get:function(){return qD.default}}),Object.defineProperty(n,"UserCheck",{enumerable:!0,get:function(){return $D.default}}),Object.defineProperty(n,"UserMinus",{enumerable:!0,get:function(){return QD.default}}),Object.defineProperty(n,"UserPlus",{enumerable:!0,get:function(){return ZD.default}}),Object.defineProperty(n,"UserX",{enumerable:!0,get:function(){return JD.default}}),Object.defineProperty(n,"User",{enumerable:!0,get:function(){return eL.default}}),Object.defineProperty(n,"Users",{enumerable:!0,get:function(){return tL.default}}),Object.defineProperty(n,"VideoOff",{enumerable:!0,get:function(){return iL.default}}),Object.defineProperty(n,"Video",{enumerable:!0,get:function(){return rL.default}}),Object.defineProperty(n,"Voicemail",{enumerable:!0,get:function(){return nL.default}}),Object.defineProperty(n,"Volume1",{enumerable:!0,get:function(){return sL.default}}),Object.defineProperty(n,"Volume2",{enumerable:!0,get:function(){return aL.default}}),Object.defineProperty(n,"VolumeX",{enumerable:!0,get:function(){return oL.default}}),Object.defineProperty(n,"Volume",{enumerable:!0,get:function(){return lL.default}}),Object.defineProperty(n,"Watch",{enumerable:!0,get:function(){return cL.default}}),Object.defineProperty(n,"WifiOff",{enumerable:!0,get:function(){return uL.default}}),Object.defineProperty(n,"Wifi",{enumerable:!0,get:function(){return hL.default}}),Object.defineProperty(n,"Wind",{enumerable:!0,get:function(){return dL.default}}),Object.defineProperty(n,"XCircle",{enumerable:!0,get:function(){return fL.default}}),Object.defineProperty(n,"XCircleFill",{enumerable:!0,get:function(){return _L.default}}),Object.defineProperty(n,"XOctagon",{enumerable:!0,get:function(){return pL.default}}),Object.defineProperty(n,"XSquare",{enumerable:!0,get:function(){return gL.default}}),Object.defineProperty(n,"X",{enumerable:!0,get:function(){return mL.default}}),Object.defineProperty(n,"Youtube",{enumerable:!0,get:function(){return vL.default}}),Object.defineProperty(n,"ZapOff",{enumerable:!0,get:function(){return EL.default}}),Object.defineProperty(n,"Zap",{enumerable:!0,get:function(){return yL.default}}),Object.defineProperty(n,"ZeroConfig",{enumerable:!0,get:function(){return TL.default}}),Object.defineProperty(n,"ZoomIn",{enumerable:!0,get:function(){return bL.default}}),Object.defineProperty(n,"ZoomOut",{enumerable:!0,get:function(){return CL.default}});var e=O(BS),t=O(zS),i=O(VS),r=O(GS),s=O(WS),a=O(HS),l=O(jS),o=O(XS),c=O(YS),u=O(KS),h=O(qS),d=O($S),f=O(QS),_=O(ZS),p=O(JS),v=O(eR),E=O(tR),g=O(iR),m=O(rR),y=O(nR),T=O(sR),b=O(aR),C=O(oR),M=O(lR),F=O(cR),P=O(uR),U=O(hR),G=O(dR),K=O(fR),q=O(_R),se=O(pR),Ee=O(gR),Se=O(mR),$=O(vR),_e=O(ER),ae=O(yR),ce=O(TR),he=O(bR),je=O(CR),Xe=O(AR),Tt=O(SR),Ze=O(RR),W=O(xR),pe=O(MR),De=O(IR),ft=O(PR),st=O(wR),$e=O(OR),bt=O(DR),Wt=O(LR),rt=O(NR),Ht=O(FR),Ni=O(kR),Ar=O(BR),$s=O(UR),jo=O(zR),ds=O(VR),Hr=O(GR),jr=O(WR),Yn=O(HR),fs=O(jR),Fr=O(XR),_s=O(YR),Xo=O(KR),Qs=O(qR),Kn=O($R),ur=O(QR),$a=O(ZR),Zs=O(JR),Qa=O(ex),fc=O(tx),Yo=O(ix),Ai=O(rx),Ko=O(nx),qo=O(sx),Js=O(ax),ea=O(ox),ta=O(lx),Za=O(cx),_c=O(ux),H=O(hx),J=O(dx),oe=O(fx),Ce=O(_x),Be=O(px),nt=O(gx),Ke=O(mx),Ve=O(vx),at=O(Ex),Je=O(yx),Hi=O(Tx),ji=O(bx),Qe=O(Cx),ii=O(Ax),Fi=O(Sx),Ja=O(Rx),qn=O(xx),ia=O(Mx),ra=O(Ix),na=O(Px),sn=O(wx),$o=O(Ox),Qo=O(Dx),Zo=O(Lx),St=O(Nx),hr=O(Fx),kr=O(kx),Xi=O(Bx),eo=O(Ux),rh=O(zx),S_=O(Vx),DP=O(Gx),LP=O(Wx),NP=O(Hx),FP=O(jx),kP=O(Xx),BP=O(Yx),UP=O(Kx),zP=O(qx),VP=O($x),GP=O(Qx),WP=O(Zx),HP=O(Jx),jP=O(eM),XP=O(tM),YP=O(iM),KP=O(rM),qP=O(nM),$P=O(sM),QP=O(aM),ZP=O(oM),JP=O(lM),ew=O(cM),tw=O(uM),iw=O(hM),rw=O(dM),nw=O(fM),sw=O(_M),aw=O(pM),ow=O(gM),lw=O(mM),cw=O(vM),uw=O(EM),hw=O(yM),dw=O(TM),fw=O(bM),_w=O(CM),pw=O(AM),gw=O(SM),mw=O(RM),vw=O(xM),Ew=O(MM),yw=O(IM),Tw=O(PM),bw=O(wM),Cw=O(OM),Aw=O(DM),Sw=O(LM),Rw=O(NM),xw=O(FM),Mw=O(kM),Iw=O(BM),Pw=O(UM),ww=O(zM),Ow=O(VM),Dw=O(GM),Lw=O(WM),Nw=O(HM),Fw=O(jM),kw=O(XM),Bw=O(YM),Uw=O(KM),zw=O(qM),Vw=O($M),Gw=O(QM),Ww=O(ZM),Hw=O(JM),jw=O(eI),Xw=O(tI),Yw=O(iI),Kw=O(rI),qw=O(nI),$w=O(sI),Qw=O(aI),Zw=O(oI),Jw=O(lI),eO=O(cI),tO=O(uI),iO=O(hI),rO=O(dI),nO=O(fI),sO=O(_I),aO=O(pI),oO=O(gI),lO=O(mI),cO=O(vI),uO=O(EI),hO=O(yI),dO=O(TI),fO=O(bI),_O=O(CI),pO=O(AI),gO=O(SI),mO=O(RI),vO=O(xI),EO=O(MI),yO=O(II),TO=O(PI),bO=O(wI),CO=O(OI),AO=O(DI),SO=O(LI),RO=O(NI),xO=O(FI),MO=O(kI),IO=O(BI),PO=O(UI),wO=O(zI),OO=O(VI),DO=O(GI),LO=O(WI),NO=O(HI),FO=O(jI),kO=O(XI),BO=O(YI),UO=O(KI),zO=O(qI),VO=O($I),GO=O(QI),WO=O(ZI),HO=O(JI),jO=O(e2),XO=O(t2),YO=O(i2),KO=O(r2),qO=O(n2),$O=O(s2),QO=O(a2),ZO=O(o2),JO=O(l2),eD=O(c2),tD=O(u2),iD=O(h2),rD=O(d2),nD=O(f2),sD=O(_2),aD=O(p2),oD=O(g2),lD=O(m2),cD=O(v2),uD=O(E2),hD=O(y2),dD=O(T2),fD=O(b2),_D=O(C2),pD=O(A2),gD=O(S2),mD=O(R2),vD=O(x2),ED=O(M2),yD=O(I2),TD=O(P2),bD=O(w2),CD=O(O2),AD=O(D2),SD=O(L2),RD=O(N2),xD=O(F2),MD=O(k2),ID=O(B2),PD=O(U2),wD=O(z2),OD=O(V2),DD=O(G2),LD=O(W2),ND=O(H2),FD=O(j2),kD=O(X2),BD=O(Y2),UD=O(K2),zD=O(q2),VD=O($2),GD=O(Q2),WD=O(Z2),HD=O(J2),jD=O(eP),XD=O(tP),YD=O(iP),KD=O(rP),qD=O(nP),$D=O(sP),QD=O(aP),ZD=O(oP),JD=O(lP),eL=O(cP),tL=O(uP),iL=O(hP),rL=O(dP),nL=O(fP),sL=O(_P),aL=O(pP),oL=O(gP),lL=O(mP),cL=O(vP),uL=O(EP),hL=O(yP),dL=O(TP),fL=O(bP),_L=O(CP),pL=O(AP),gL=O(SP),mL=O(RP),vL=O(xP),EL=O(MP),yL=O(IP),TL=O(PP),bL=O(wP),CL=O(OP);function O(w){return w&&w.__esModule?w:{default:w}}})(A_);function DX({defaultState:n,onToggle:e}){const[t,i]=S.useState(n||!1);return fe.jsx(Jv,{text:"Backface culling",scale:2/3,children:fe.jsx(Af,{auto:!0,scale:2/3,icon:fe.jsx(A_.Triangle,{fill:t?void 0:"white"}),onClick:()=>{e(!t),i(!t)}})})}function LX({onClick:n}){return fe.jsx(Jv,{text:"Center on model",scale:2/3,children:fe.jsx(Af,{auto:!0,scale:2/3,icon:fe.jsx(A_.Target,{}),onClick:()=>n()})})}var kl=(n=>(n[n.GLB=0]="GLB",n[n.GLTF=1]="GLTF",n[n.OBJ=2]="OBJ",n))(kl||{});function NX({onExport:n}){return fe.jsx(Jv,{text:"Export",scale:2/3,children:fe.jsxs(Uc,{className:"download-button",scale:2/3,auto:!0,children:[fe.jsxs(Uc.Item,{main:!0,onClick:()=>n(kl.GLB),children:[fe.jsx(A_.Download,{size:16}),fe.jsx(n8,{width:.5}),"GLB"]}),fe.jsx(Uc.Item,{onClick:()=>n(kl.GLTF),children:"glTF"}),fe.jsx(Uc.Item,{onClick:()=>n(kl.OBJ),children:"OBJ"})]})})}function FX({model:n}){const e=S.useRef(null),t=S.useRef(),{setToast:i}=t8();S.useEffect(()=>{if(!e.current||!n)return;const a=new Z(e.current,!1),l=new Vd(a,{controllableCamera:!0,highlightHoveredFace:!0,logClickedFace:!0,showFPSCounter:!1});return t.current=l,l.setModel(n),a.runRenderLoop(function(){l.render()}),()=>{t.current=void 0,l.destroy(),a.dispose()}},[n]);const r=S.useCallback(async a=>{if(!t.current){i({text:"Could not download model",type:"error"});return}let l;const o=`vc2-${n.parent.name.replace(".BIN","")}-${n.id}`;switch(a){case kl.GLB:l=OT.GLBAsync(t.current.scene,o);break;case kl.GLTF:l=OT.GLTFAsync(t.current.scene,o);break;default:i({text:"Unsupported format",type:"warning"});return}i({text:"Preparing model"}),(await l).downloadFiles()},[n,i]),s=S.useCallback(a=>{t.current&&(t.current.backfaceCulling=a)},[]);return fe.jsx(fe.Fragment,{children:fe.jsxs("div",{className:"model-viewer",children:[fe.jsxs(lr.Container,{className:"viewer-actions",margin:.5,children:[fe.jsx(lr,{alignContent:"center",children:fe.jsx(LX,{onClick:()=>{var a;return(a=t.current)==null?void 0:a.center()}})}),fe.jsx(lr,{alignContent:"center",children:fe.jsx(DX,{onToggle:s})}),fe.jsx(lr,{children:fe.jsx(NX,{onExport:r})})]}),fe.jsx("canvas",{ref:e})]})})}function kX(n){const e=n.getBoundingClientRect();return e.left<=window.innerWidth&&e.right>=0&&e.top<=window.innerHeight&&e.bottom>=0}function BX({engine:n,model:e}){const t=S.useRef(null),[i,r]=S.useState(!1),[s,a]=S.useState(!1),l=S.useCallback(()=>{if(!t.current)return;const o=kX(t.current);a(o)},[t]);return S.useEffect(()=>(l(),window.addEventListener("scroll",l),()=>{window.removeEventListener("scroll",l)}),[l]),S.useEffect(()=>{var h;if(!t||i||!s)return;console.debug(`Loading: model ${e.id}`);const o=new Vd(n,{controllableCamera:!1,highlightHoveredFace:!1,logClickedFace:!1,showFPSCounter:!1});o.setModel(e),o.render();const c=n.getRenderingCanvas();if(!c){console.warn("Could not get engine canvas!");return}const u=(h=t.current)==null?void 0:h.getContext("2d");if(!u){console.warn("Could not get static view canvas context!");return}u.drawImage(c,0,0),r(!0)},[n,t,i,s,e]),S.useEffect(()=>{r(!1)},[e]),fe.jsxs(fe.Fragment,{children:[!i&&fe.jsx("div",{className:"model-static-viewer-loader",children:fe.jsx(bv,{})}),fe.jsx("div",{style:{visibility:i?"visible":"hidden"},className:"model-static-viewer",children:fe.jsx("canvas",{width:128,height:128,ref:t})})]})}const UX=Ez([{path:"/open",Component:Ng,loader:Ng.loader},{path:"/",Component:Lg,loader:Lg.loader,children:[{path:"/:assetType/:assetName",Component:jg,loader:jg.loader}]}]);function zX(){return fe.jsxs(fe.Fragment,{children:[fe.jsx("div",{className:"header-wrapper",children:fe.jsx("header",{className:"header",children:fe.jsx(lr.Container,{justify:"center",children:fe.jsxs(lr,{xs:18,alignItems:"center",children:[fe.jsx("img",{src:"/header.png",className:"header-img"}),fe.jsx("p",{children:"VCop2 Explorer"})]})})})}),fe.jsx(Xl,{id:"main-section",children:fe.jsx(Xl.Content,{children:fe.jsx(Mz,{router:UX})})})]})}xg.createRoot(document.getElementById("root")).render(fe.jsx(k.StrictMode,{children:fe.jsx(p6,{themeType:"dark",children:fe.jsx(o0,{children:fe.jsx(zX,{})})})}));export{B8 as c,u0 as e};
